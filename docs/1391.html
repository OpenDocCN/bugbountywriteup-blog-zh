<html>
<head>
<title>This is how I was able to see Private, Archived Posts/Stories of users on Instagram without following them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这就是为什么我能够在Instagram上看到用户的私人存档帖子/故事，而不用关注他们</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/this-is-how-i-was-able-to-see-private-archived-posts-stories-of-users-on-instagram-without-de70ca39165c?source=collection_archive---------0-----------------------#2021-06-15">https://infosecwriteups.com/this-is-how-i-was-able-to-see-private-archived-posts-stories-of-users-on-instagram-without-de70ca39165c?source=collection_archive---------0-----------------------#2021-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2d33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我是来自马哈拉施特拉邦的马约·法塔德。这是我在脸书昆虫赏金计划中的第一只昆虫。</p><h2 id="e127" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">描述</h2><p id="95a1" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">该漏洞可能允许恶意用户在Instagram上查看目标媒体。攻击者无需使用媒体ID跟踪用户，就可以看到私人/存档帖子、故事、视频、IGTV的详细信息。详细信息包括赞数/评论数/保存数、显示url、图片uri、脸书链接页面(如果有)和其他。</p><p id="4aba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">影响</strong></p><p id="c295" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户的数据可能被不正确地读取。攻击者能够重新生成存档故事和帖子的有效CDN URL。此外，通过暴力破解媒体ID，攻击者可以存储特定媒体的详细信息，并在以后过滤私有和存档的内容。</p><h2 id="c852" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">再现步骤</h2><p id="4cc8" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">步骤:</p><ol class=""><li id="94a0" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated">获取目标的帖子/卷轴/IGTV/故事媒体id(通过暴力或其他技术)</li><li id="f043" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated">向<a class="ae lx" href="https://i.instagram.com/api/v1/ads/graphql/" rel="noopener ugc nofollow" target="_blank">https://i.instagram.com/api/v1/ads/graphql/</a><br/><strong class="jp ir"><em class="ly">参数</em> </strong> : <br/> doc_id= <strong class="jp ir">【编校】</strong>&amp;query _ params = { " query _ params ":{ " access _ token ":"，" id":"[ <strong class="jp ir"> MEDIA_ID </strong> ]"}}</li><li id="be7b" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated">其中<strong class="jp ir">【媒体ID】</strong>是任何帖子/卷轴/IGTV/故事的媒体ID。<br/> doc_id被编辑。</li><li id="cf67" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated">在响应中，display_url、save_count &amp;披露了特定媒体的其他详细信息。</li></ol><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/5dc2975a9ceed97f1e02cf137043bfa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*27JjvMOFSnJGmH0q.png"/></div></div></figure><p id="9b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几天后，我发现了另一个doc_id= <strong class="jp ir">【修订】</strong>的端点，它披露了相同的信息。access_token是通过POST请求传递的，所以当我试图访问不同帐户的媒体时，我得到了<strong class="jp ir"> <em class="ly">数据:响应中的null </em> </strong>。</p><p id="6a13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤:</strong></p><p id="9539" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.向<a class="ae lx" href="https://i.instagram.com/api/v1/ads/graphql/" rel="noopener ugc nofollow" target="_blank">https://i.instagram.com/api/v1/ads/graphql/</a><br/><strong class="jp ir"><em class="ly">参数</em></strong>:<br/>access _ token =<strong class="jp ir">【编校】</strong>&amp;variables = { " query _ params ":{ " access _ token ":"，" ID ":"<strong class="jp ir">【MEDIA _ ID】</strong>" }，" fetch _ actor _ ID ":false }&amp;server _ timestamps = true&amp;doc _ ID =<strong class="jp ir">【编校】</strong></p><p id="c50c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中<strong class="jp ir">【媒体ID】</strong>是任何帖子/卷轴/IGTV/故事的媒体ID。<br/> doc_id被编辑。<br/>不包括其他参数。<br/>访问令牌是有效的脸书访问令牌。</p><p id="f68e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">反应</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/06ee72e57413aef287e23834905aa941.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/0*9hAMkero7P-Cz0uw.png"/></div></figure><p id="7a95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.然后，我将<em class="ly">访问令牌</em>更改为<em class="ly">空值</em>，这样我就可以访问信息了。<br/>同一个端点也披露了链接到Instagram账户的脸书页面，但脸书页面&amp; Instagram账户链接是公开的。这里可以看到<br/><strong class="jp ir"><em class="ly">https://www.facebook.com/ads/library/?active_status=all&amp;ad _ type = all&amp;country = US&amp;view _ all _ PAGE _ id = PAGE _ ID&amp;search _ type = PAGE</em></strong><br/>其中<strong class="jp ir"> PAGE_ID </strong>是脸书页面ID。</p><p id="0bb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ly">参数</em></strong>:<br/>access _ token = null&amp;变量= { " query _ params ":{ " access _ token ":"，" ID ":"<strong class="jp ir">【MEDIA _ ID】</strong>" }，" fetch _ actor _ ID ":false }&amp;server _ timestamps = true&amp;doc _ ID =<strong class="jp ir">【编校】</strong></p><p id="abba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/e494a36cbe0b474685306a28961cffc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/0*1QF-aY1a1S_baOr4.jpg"/></div></figure><h2 id="0eda" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">固定</h2><p id="c8e8" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">Instagram改变了上述端点。</p><h2 id="20eb" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">时间表</h2><p id="fec9" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">2021年4月16日:发送报告<br/>2021年4月19日:来自脸书安全团队的回复—需要更多信息<br/>2021年4月19日:发送信息<br/>2021年4月22日:报告已分类<br/>2021年4月23日:发现另一个终端泄露相同信息<br/>2021年4月29日:已修复<br/>2021年4月29日:漏洞未完全修补。将信息发送给FB安全团队<br/> …2021年6月15日:获得30000美元奖金。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mn"><img src="../Images/b6eea3a9d5dfc9dee07c5e6b09ab9cea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MmhLuA2vCn-iTSP5MCbl3g.jpeg"/></div></div></figure></div></div>    
</body>
</html>