<html>
<head>
<title>OTP bypass and Account takeover using response manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用响应操作的OTP旁路和帐户接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/otp-bypass-and-account-takeover-using-response-manipulation-685ad4e1ea76?source=collection_archive---------0-----------------------#2021-07-20">https://infosecwriteups.com/otp-bypass-and-account-takeover-using-response-manipulation-685ad4e1ea76?source=collection_archive---------0-----------------------#2021-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0ce1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谁是克里希纳德夫·P·梅勒维拉？</p><blockquote class="kl km kn"><p id="667f" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">Krishnadev P Melevila是一名企业家、网络安全专家、谷歌认证数字营销人员和全栈开发人员。我也是Nodeista Infotech的创始人。要了解更多细节，只需谷歌我的名字。</p></blockquote><p id="2bba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，伙计们，这是我的第一笔虫子奖金(这意味着我第一次因为虫子而得到报酬)。</p><p id="f7d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据网站政策，我不能透露网站名称，所以我提到它是example.com。</p><p id="a78c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个网站是一个考试软件，在这里我们可以添加考试，添加学生，生成考试报告，给学生发邮件等…</p><p id="2cec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个网站在订阅的基础上运行，一个机构可以在这个网站上注册并添加考试，每个学生将获得一个用户id并通过考试。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/d49a40c16c959cb0809b6f5c60a6234d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E1BhHySLxKtThD067wyq2g.jpeg"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">米卡·鲍梅斯特在<a class="ae li" href="https://unsplash.com/s/photos/hacking?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="3473" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看看漏洞。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="lj lk l"/></div></figure><p id="39c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该站点有两个漏洞。一个是P1人，另一个是P3人。</p><p id="295a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">example.com(P3)的第一大弱点</p><p id="db5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于漏洞的❖:用户可以在example.com上成功注册，无需OTP验证</p><p id="5d2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">❖漏洞原因:响应确认OTP请求的OTP传递</p><p id="d29a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">❖如何再现:</p><p id="073e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向https://example.com/createaccount.aspx?plan=1的<a class="ae li" href="https://admin.speedexam.net/createaccount.aspx?plan=1" rel="noopener ugc nofollow" target="_blank">发出请求，输入任何邮件和密码(邮件可以是blabla@gmail.com、blabla@yahoo.com等任何东西)，然后点击创建账户。</a></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/b18ad25ed839e69c1e7aa073053cac0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*_SOAUUgBA2O0mFZb7pxA1Q.png"/></div></figure><p id="f1b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">完成表格的下一部分，打开打嗝，打开拦截，然后点击完成按钮。</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/825c2e85a82a3eebba8f76f8436ae3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*5s3gwaXnUWRHSlQk1bRddw.png"/></div></figure><p id="b3c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">一旦您发送请求，您将收到带有“hdverifycode”参数的回复，该参数与发送到我们已经给出的邮件的动态口令相同。这里我得到的OTP是:10822 </strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/b54622864a16ff71e8102bd604976313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*fWFBeIHtou2mKmSBZ4lkPQ.png"/></div></figure><p id="00b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">一旦您转发请求，您将看到一个如下所示的输入动态口令的屏幕。在这里输入我们从响应中收到的OTP(这里是10822) </strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/690452454ac687c1af8888948d732e55.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*PebmWF11L3-y0jMFteNNxw.png"/></div></figure><p id="ceac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点击确认并完成</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/ad5db202512c945cfb63cde03078af59.png" data-original-src="https://miro.medium.com/v2/resize:fit:810/format:webp/1*UhMWFYj3zskL3zzpvlTLqw.png"/></div></figure><p id="e72f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在，我们已经准备好了一个完全激活的帐户，无需任何OTP验证和电子邮件验证。</strong></p><p id="d665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我在example.com网站上绕过OTP的方法。</p><p id="0823" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们来看看P1的弱点。</p><p id="0b1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">example . com(P1)上的2号漏洞</strong></p><p id="ec88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">关于漏洞:攻击者用户无需任何认证就可以更改目标用户的所有设置。</strong></p><p id="71aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">漏洞原因:1。序列化容易暴力破解的Userid和admin id以及响应和请求操作漏洞。</strong></p><p id="a729" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">如何繁殖:</strong></p><ul class=""><li id="01fc" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated"><strong class="jp ir">利用之前的漏洞，用一个假的邮件id制作一个攻击者账号。</strong></li><li id="8a34" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">也建立一个目标客户</li><li id="62b8" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">现在我们知道，服务器以相同的注册顺序给出所有管理员id和用户id，也就是说，如果一个用户在网站上注册，他将获得用户id 1104和管理员id 2231，当另一个用户注册时，他将分别获得2232和1104作为用户id和管理员id。</li><li id="7276" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">所以我们要利用这个漏洞。通过拦截来自攻击者登录站点的任何请求，我们将获得攻击者的用户id和管理员id，比如分别为2231和1104。这意味着2231和1104之前的所有数字分别是随机用户的有效用户id和管理员id。</li><li id="8237" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">因此，我所做的只是进入攻击者帐户的帐户设置，更改邮件并将其发送给入侵者。在那里，我将管理员id和用户id更改为目标的id，并转发请求。</li></ul><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi me"><img src="../Images/d60486b20869371ad36a5afa4b0319a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*AYP1_UgvVFwjMFPX38DTeA.png"/></div></figure><ul class=""><li id="bf8f" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">我一转发它，就打开了一个新的匿名窗口，并试图用旧邮件登录，但我无法登录，因为我们改变了邮件。是的，它成功了！！！！！！</li><li id="d64d" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">现在全款已经拿下来了。这是P1的一个弱点。</li></ul><p id="8e2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">通过这种方式，攻击者可以窃取考试数据，更改考试，添加讲师，更改地址，更改电子邮件，即:该漏洞的范围是完全账户接管。</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/f9ba92418306c79b1d7fb5460ffa9832.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*pqdki6Og56lfo767.gif"/></div></figure><p id="92aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">披露概要</strong></p><p id="b05a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">错误报告时间:20–07–2021时间:IST时间上午11:07</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mg"><img src="../Images/435bb76b361e91858ec4c9e2177a0066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YHCsO0WZ_SeIeiC3KVqzew.png"/></div></div></figure><p id="fcdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">首次回应:2021年7月20日时间:IST时间上午11:30</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mh"><img src="../Images/0a5a8ed43e5d7e1100cdd0817e653432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H1jmEXrfOdGDKU7fb4uEVA.png"/></div></div></figure><p id="6453" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">漏洞报告提交时间:2021年7月20日IST时间:下午12:41</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mi"><img src="../Images/e8d0df21533e112add5df3b61687637c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WeSgnVZkm7iw81Kk3k1DoQ.png"/></div></div></figure><p id="c076" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">IST时间下午01:36分，对其进行分类并奖励167美元的赏金</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mj"><img src="../Images/8aa84796c1d2bcd8a61d16259eeba129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66W9arSzsKTObQdRyFw7_g.png"/></div></div></figure><p id="11c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的社交档案:</p><p id="34e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Instagram:<a class="ae li" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank">https://instagram.com/krishnadev_p_melevila</a></p><p id="8453" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://facebook.com/krishnadevpmelevilaofficial</p></div></div>    
</body>
</html>