<html>
<head>
<title>OTP Leaking Through Cookie Leads to Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Cookie泄漏OTP会导致帐户被接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/otp-leaking-through-cookie-leads-to-account-takeover-4fb96f255e2f?source=collection_archive---------4-----------------------#2022-12-05">https://infosecwriteups.com/otp-leaking-through-cookie-leads-to-account-takeover-4fb96f255e2f?source=collection_archive---------4-----------------------#2022-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="054a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">OTP旁路</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d752840504e102a15bf731d79b08e6c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C7u38dHetvUxV6Ln7R2QTA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://smilyhomes.com/wp-content/uploads/2022/04/roof-leakage.jpeg" rel="noopener ugc nofollow" target="_blank">泄漏</a></figcaption></figure><p id="67dc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你好黑客们，</p><p id="5d14" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这次我要讨论的是一个电子商务网站中导致账户被接管的OTP泄露漏洞。</p><p id="fe68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们开始吧</p><blockquote class="ls lt lu"><p id="569e" class="kw kx lv ky b kz la jr lb lc ld ju le lw lg lh li lx lk ll lm ly lo lp lq lr ij bi translated">什么是OTP？<br/>一次性密码，也称为一次性PIN、一次性授权码或动态密码，是在计算机系统或其他数字设备上仅在一次登录会话或交易中有效的密码<br/>(来源:<a class="ae kv" href="https://en.wikipedia.org/wiki/One-time_password" rel="noopener ugc nofollow" target="_blank">维基百科</a>)</p></blockquote><p id="d616" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在谷歌上搜索一个bug bounty程序的时候，我得到了一个电子商务网站。我开始检查网站的注册和登录页面，我拦截了这些请求，并开始搜索任何敏感数据，但我什么也没找到。</p><p id="a0f3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在我注册了一个账户并试图登录的时候，我发现了那个网站上有趣的事情。我应该发现注册页面本身的漏洞。</p><p id="09c4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们讨论一下</p><p id="71a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注册后，有两种登录方式:使用密码或OTP</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/7139fbb98ce938a0baed884d5e08301b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*NfoV4MOAVKnwIXTckjiROg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">登录页面</figcaption></figure><p id="81f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我用OTP登录，输入注册号，点击OTP登录</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/f30000d6ddbad4d3f115e05e3a480727.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*hlwapeltnnXktoNDx-OOYw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">验证动态口令</figcaption></figure><p id="22a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我检查了cookie，有一个新的cookie出现了“otpcookies”和OTP值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/84b9111bf74ab78bb01f3678bcdbc8fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:258/format:webp/1*a1KG0NgBGPCvxy5k7x0g7Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">动态口令（One-time Password的缩写）</figcaption></figure><p id="b9e8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我输入了动态口令并验证了它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/530bcf6a2c4e2f43d15bd4dc5062ced2.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*zH1_4-E768VMsJJAyhD8GA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">成功登录</figcaption></figure><p id="9e18" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们已成功登录帐户。</p><p id="95d2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只要知道他们的手机号码，我们就可以接管任何账户。我们可以使用相同的方法注册帐户，最有趣的部分是没有验证手机号码和电子邮件id，这意味着我们甚至可以注册不存在的号码和电子邮件。这些都发生在一个电子商务网站上:(</p><p id="5397" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我向管理员报告了这个问题，他们在几个小时内做出了回应，并接受了这个错误。从那以后，他们没有任何回应，直到现在也没有更新。我们等等吧。</p><p id="eb22" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读…</p><h1 id="9018" class="md me iq bd mf mg mh mi mj mk ml mm mn jw mo jx mp jz mq ka mr kc ms kd mt mu bi translated">跟我来:</h1><p id="d01e" class="pw-post-body-paragraph kw kx iq ky b kz mv jr lb lc mw ju le lf mx lh li lj my ll lm ln mz lp lq lr ij bi translated">推特:<a class="ae kv" href="https://twitter.com/ag3n7apk" rel="noopener ugc nofollow" target="_blank">https://twitter.com/ag3n7apk</a></p><p id="a4c5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">领英:<a class="ae kv" href="https://www.linkedin.com/in/abhijith-pk-ag3n7/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/abhijith-pk-ag3n7/</a></p></div></div>    
</body>
</html>