<html>
<head>
<title>Meepwn CTF Quals 2018 Writeup — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Meepwn CTF质量2018年综述—第1部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/meepwn-ctf-quals-2018-writeup-part-1-ab216bbf0b35?source=collection_archive---------0-----------------------#2018-07-16">https://infosecwriteups.com/meepwn-ctf-quals-2018-writeup-part-1-ab216bbf0b35?source=collection_archive---------0-----------------------#2018-07-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e69d8a3afc6dcf5ece85e48a6905ed1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m91P92vsV-f230mQFWkiDw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Meepwn CTF质量2018年综述—第1部分</figcaption></figure><p id="7f77" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">本周，我刚刚决定与<a class="ae la" href="https://www.facebook.com/HackXore/" rel="noopener ugc nofollow" target="_blank"> HackXore </a>团队一起参加Meepwn CTF Quals 2018，因为我们去年在mee pwn 2017年第一届CTF中获得了前10名(第10名)，这是一个非常好的挑战。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/ef6f7ee72c3c1ee9042666ae32d1e09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uFOFXwaPHKeYMOL-mzKs0w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">MeePwn第一届CTF 2017决赛记分牌(TOP10)</figcaption></figure><p id="8925" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi">13/07/2018</p><p id="edcc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">CTF在世界协调时下午19:00开始，我在世界协调时下午20:00醒来，在世界协调时下午21:00去参加一个会议，在世界协调时下午23:00结束会议，然后我在世界协调时下午23:30加入团队参加Meepwn CTF Quals 2018，并享受与这样一个酷家伙解决挑战。</p><p id="b843" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当我加入这些家伙时，我发现他们解决了一个任务(MISC [Welcome — 100pts])。杂项类别中有两个挑战，一个任务的解决率为0(白雪、黑影-1000分)。</p><ol class=""><li id="03ab" class="lg lh iq ke b kf kg kj kk kn li kr lj kv lk kz ll lm ln lo bi translated"><strong class="ke ir">白雪，黑影</strong></li></ol><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/57d8b9530c2d65fd80413920fcb1f1a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ejoax3Q0JMpuVkdEs66ygQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">白色的雪，黑色的影子(杂项-1000分)</figcaption></figure><p id="b333" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是T4的附件T5。</p><p id="114d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">第一次，在我发现这是JPEG图像后，我尝试了一些隐写工具，如exiftool，binwalk，foremost …等等，但我不能从这张图像中提取任何有趣的东西。</p><p id="7583" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我试着把它串起来，然后我注意到一些有趣的事情:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/bf3b5df876ccd729c05db2a75e47d8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*HW_JHL6MuN4YyxBdyjaGvQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">给定图像的字符串</figcaption></figure><p id="38b3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我发现这张图片中有一个PDF文件，我必须用另一种不同的方法提取它。</p><p id="0f7f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">过了一会，队友(@rls1004)给我发消息，告诉我她在十六进制字节中间发现了一个Eof。</p><p id="f7bb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好的，在我检查之后，我发现了这些有趣的字节(FF D9)，这是Eof(JPEG图像的结尾):</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/2abb57ee6cb0a97b26e51111420b14d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Q2hxjUVdpDmIXV0Ox2xRA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Eof JPEG图像</figcaption></figure><p id="920a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这意味着在JPEG图像之后还有另一个文件。正如你所看到的，有一个有趣的事情是(PK)；这是PK签名！</p><p id="817e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我在谷歌上搜索了一下，然后我发现了这篇有趣的维基百科文章，它给了我们一个文件签名列表。</p><p id="9fa0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从这篇文章中，我了解到PK签名可以支持ZIP文件，这意味着签名可以是ZIP文件签名，这意味着:</p><blockquote class="ls lt lu"><p id="3010" class="kc kd lv ke b kf kg kh ki kj kk kl km lw ko kp kq lx ks kt ku ly kw kx ky kz ij bi translated">图像=图像+ ZIP文件</p></blockquote><p id="7b19" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们有了图像，需要检查ZIP文件，所以我们只提取ZIP文件:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/c41bd81dc621f2ea4621b4a4e62ff9a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fgjmjh6pfZXCC-fkV7A3w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">选择图像字节直到Eof</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/4dbe8d531dbf9bd93f7963489976d151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xwTlqyGnsZ2R2WcPqAPk-Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">删除选定的字节</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/3e912ef8ace6f2dc7ae3b00e34fc0a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRVvxnCtsGCoPRUXPI7hGw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">将其保存为ZIP文件</figcaption></figure><p id="0532" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过使用两行python代码，还有另一种非常简单快捷的方法:</p><pre class="lc ld le lf gt mc md me mf aw mg bi"><span id="e808" class="mh mi iq md b gy mj mk l ml mm">#!/usr/bin/env python<br/>#MeePwn CTF Quals 2018 | MISC [White Snow, Black Shadow - 1000pts]<br/>#@Abdelkader<br/>#@rls1004</span><span id="8fbc" class="mh mi iq md b gy mn mk l ml mm">msg = open("evidence.jpg","rb").read()[0x21f5A:]<br/>open("message.zip","wb").write(msg)</span></pre><p id="ac76" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但我们无法打开这个ZIP文件，这是一个问题，过了一会儿，我的队友告诉我，我们必须修复这个ZIP文件的头，错误在两个字节(05 06)中，用于分区压缩的信息，因此要修复它，我们必须将其从分区压缩更改为单次压缩(03 04):</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/f11419186af0840023c353a0784b5ed9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1nY8H5i1FWuShED_41d4w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">分区压缩字节</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/ab255b611033d972341bedc0c7565f66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x8C63Ue7u7NbPOxrao2vug.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">单个压缩字节</figcaption></figure><p id="efa4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我把它保存为message.zip，解压后我找到了(message.zip ),但我无法打开它，因为它是一个损坏的文件。</p><p id="ab22" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我用<a class="ae la" href="https://www.pdf-online.com/osa/repair.aspx" rel="noopener ugc nofollow" target="_blank">在线修复PDF文件工具</a>修复:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/0b3c727b3ffcbcfb93c98341f2b8a8b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LrLYgd8g1lwA8tDWZ5ExHQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在线修复PDF文件工具</figcaption></figure><p id="8d50" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我保存为(message_recovered.pdf):</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/81ffc69136115955f5e1113dce25a2dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aStLotFwi38GrEsZgKtDjw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">message_recovered.pdf文件</figcaption></figure><p id="b80a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是直到现在我还看不到旗子。所以我试着在谷歌上搜索这段引文，以便找到原文:</p><blockquote class="ms"><p id="0549" class="mt mu iq bd mv mw mx my mz na nb kz dk translated">"当你排除了不可能，剩下的，不管多么不可思议，一定是事实."</p><p id="4750" class="mt mu iq bd mv mw mx my mz na nb kz dk translated">——阿瑟·柯南·道尔爵士</p></blockquote><p id="5f5a" class="pw-post-body-paragraph kc kd iq ke b kf nc kh ki kj nd kl km kn ne kp kq kr nf kt ku kv ng kx ky kz ij bi translated">我找到了<a class="ae la" href="https://philosiblog.com/2012/05/22/when-you-have-eliminated-the-impossible-whatever-remains-however-improbable-must-be-the-truth/" rel="noopener ugc nofollow" target="_blank">的原文</a>，然后我<a class="ae la" href="https://www.diffchecker.com/" rel="noopener ugc nofollow" target="_blank">将它与我的文本</a>进行了比较，然后我得到了一些不同的字符:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/a04b7370014d54fcae08d5a41169b41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tm-C23kumSD2v3Nsyo89ug.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">原文和我在PDF文件(message.pdf)中找到的文本之间的差异[1]</figcaption></figure><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/10d827a4a44aede5192913048627b468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2zYX0H6V5sVBUbjddOSN_A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">原文和我在PDF文件(message.pdf)中找到的文本之间的差异[2]</figcaption></figure><p id="d9da" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">比较之后，我注意到这两个文本之间有一些不同的字符和单词，为了收集标志，我试着阅读文本，然后对所有离题的单词或字符进行排序，最后我也正确地收集了它。</p><blockquote class="ls lt lu"><p id="4610" class="kc kd lv ke b kf kg kh ki kj kk kl km lw ko kp kq lx ks kt ku ly kw kx ky kz ij bi translated">标志为:<strong class="ke ir"> MeePwnCTF{T3xt_Und3r_t3Xt！！！！} </strong></p></blockquote><p id="8f76" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是一个有趣的任务，我想我花了两个小时和我的队友@rls1004一起解决它，他们也帮助了我，这是我写的第一部分，还有其他我自己解决的挑战。</p><p id="a1fe" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我要感谢MeePwn团队组织了这次CTF，并创造了如此酷的任务。</p></div></div>    
</body>
</html>