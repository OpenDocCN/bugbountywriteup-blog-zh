<html>
<head>
<title>Oauth Misconfig — Leads to Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Oauth错误配置—导致帐户被接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/oauth-misconfig-leads-to-account-takeover-7a360e6d9cac?source=collection_archive---------0-----------------------#2021-02-10">https://infosecwriteups.com/oauth-misconfig-leads-to-account-takeover-7a360e6d9cac?source=collection_archive---------0-----------------------#2021-02-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="52d7" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">你好，信息安全社区，</p></blockquote><p id="208c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">这是我第一次为我报告的漏洞写文章，并获得了第一笔bug奖金。</p><p id="6c5c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">开始吧:)</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/64ec5193adf3d646f2a69bac7e33d300.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*_FSygPSBgR7-xU4_Oj4GnA.gif"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">Studiosoyuz</figcaption></figure><h2 id="46ee" class="lh li it bd lj lk ll dn lm ln lo dp lp ks lq lr ls kt lt lu lv ku lw lx ly lz bi translated">我是如何找到目标的？</h2><p id="4219" class="pw-post-body-paragraph jt ju it jw b jx ma jz ka kb mb kd ke ks mc kh ki kt md kl km ku me kp kq kr im bi translated">我是一个兼职的bug猎人，喜欢在web应用程序上寻找bug。经过大量的重复，不适用于bug搜索平台，我决定在竞争较少的RVDP程序上搜索。我报告了一些错误，收到了一些感谢邮件，也没有多少人因为保护应用程序而进入名人堂。</p><p id="6c8e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">一段时间后，我开始随机搜索网站，就像我们在日常生活中使用一些网络应用程序一样。我在那些甚至没有RVDP程序或任何安全团队的网站上练习。我向他们报告了这些Bug，但是众所周知，许多公司都没有任何回应——挣扎Bug猎人的脸。但是仍然有公司尊重bug hunters❤️</p><p id="f339" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我选择了一个这样的网站，并开始基本的扫描和侦察。我将使用example.com作为网站名称。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/bf625574c37f1549e2ea907b29e9d6f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/1*5RNyr8uasvw5VDX5ocRHlg.gif"/></div></figure><p id="deb8" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我发现example.com有一个注册方法</p><ol class=""><li id="198a" class="mg mh it jw b jx jy kb kc ks mi kt mj ku mk kr ml mm mn mo bi translated">Gmail和设置密码</li><li id="c3c7" class="mg mh it jw b jx mp kb mq ks mr kt ms ku mt kr ml mm mn mo bi translated">OAuth配置错误</li></ol><p id="afb2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我开始检查OAUTH Bug。</p><p id="864a" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu">OAUTH是什么？</strong></p><p id="fdcc" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">OAuth是一种开放标准的授权协议或框架，它描述了不相关的服务器和服务如何能够安全地允许对它们的资产进行经过身份验证的访问，而无需实际共享初始的、相关的单一登录凭证。在认证术语中，这被称为安全、第三方、用户代理、委托授权。</p><p id="9d29" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">简而言之，OAuth是一个点击式流程，所有最终用户和安全研究人员都可以轻松注册。</p><p id="2996" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">example.com使用推特、脸书、谷歌和苹果Oauth登录网站。作为受害者，我通过Google sign in注册并登录了该应用程序。</p><p id="daef" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu">重现步骤</strong></p><ol class=""><li id="fde6" class="mg mh it jw b jx jy kb kc ks mi kt mj ku mk kr ml mm mn mo bi translated">用受害者的名字、电子邮件地址注册一个账户，并设置密码。</li><li id="b743" class="mg mh it jw b jx mp kb mq ks mr kt ms ku mt kr ml mm mn mo bi translated">现在，您可以通过您设置的电子邮件id和密码访问受害者的帐户。</li><li id="feb5" class="mg mh it jw b jx mp kb mq ks mr kt ms ku mt kr ml mm mn mo bi translated">在不知情的情况下，受害者将通过Google OAuth功能创建一个帐户。</li><li id="3397" class="mg mh it jw b jx mp kb mq ks mr kt ms ku mt kr ml mm mn mo bi translated">因此，受害者不需要设置密码。</li></ol><p id="8476" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu">漏洞利用场景</strong></p><p id="a904" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">您可以通过在攻击者阶段设置的密码访问受害者帐户。攻击者可以更改任何设置，如果网站有任何溢价或支付细节，会导致敏感信息泄漏。攻击者可以随时使用受害者帐户。</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="d48c" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我做到了，并向example.com报告了同样的情况。安全团队对这一发现表示赞赏，并宣布悬赏金额为100美元。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/c12c3fdd23faca33e33b75c003e5531e.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*f5ziDGYTDk7-G-ask6FO-A.gif"/></div></figure><p id="53ae" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">有许多方法可以执行OAuth攻击。这是一个简单且非常容易利用的方法。</p><h1 id="67c9" class="nb li it bd lj nc nd ne lm nf ng nh lp ni nj nk ls nl nm nn lv no np nq ly nr bi translated"><strong class="ak">时间线</strong></h1><p id="e28a" class="pw-post-body-paragraph jt ju it jw b jx ma jz ka kb mb kd ke ks mc kh ki kt md kl km ku me kp kq kr im bi translated">1月16日—报告了错误</p><p id="0949" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">1月25日—接受了Bug</p><p id="334e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">2月9日—收到100美元奖金</p></div><div class="ab cl mu mv hx mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="im in io ip iq"><p id="63e8" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu"> <em class="jv">感谢您抽出时间</em> </strong>。问候<a class="ae ns" href="http://www.rakeshelamaran.tech" rel="noopener ugc nofollow" target="_blank">拉克什</a></p><p id="2510" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我很快会写更多我的发现，所以，请关注我的下一篇文章。</p><p id="7044" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">查看我的博客——我是如何获得<a class="ae ns" href="https://rakeshelamaran.medium.com/how-i-landed-in-cybersecurity-job-my-journey-9dca65e224ed" rel="noopener">网络安全工作</a>的</p><p id="2233" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">留个掌声<a class="ae ns" href="https://medium.com/@rakeshelamaran" rel="noopener"> <strong class="jw iu"> <em class="jv">关注</em> </strong> </a>获取更多更新。</p><p id="2714" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu"> <em class="jv">与我联系:</em> </strong></p><p id="d7f7" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">https://www.linkedin.com/in/rakeshelamaran98/</p><p id="a18d" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">https://twitter.com/rakeshoffcl</p></div></div>    
</body>
</html>