<html>
<head>
<title>[ Malware Analysis #5] — Eternity Project — Eternity Worm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[恶意软件分析#5] —永恒项目—永恒蠕虫</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/malware-analysis-5-eternity-project-eternity-worm-abd7803fcab?source=collection_archive---------0-----------------------#2022-11-20">https://infosecwriteups.com/malware-analysis-5-eternity-project-eternity-worm-abd7803fcab?source=collection_archive---------0-----------------------#2022-11-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/edfadd2c325ad839e639f001b679712b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*YpJ3KzSaEH3YNWIO1qIsWw.png"/></div></figure><p id="d0ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我们将继续分析永恒项目，这一次我们将看看永恒蠕虫，所以让我们开始…</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="b139" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">工件:</h2><p id="edb6" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><strong class="jw ir">永恒之虫第一阶段:</strong></p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/babd6fc100ea3f18a35d6180c2089465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*s5DbS9eSTS6r9p20f0hsQg.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">856 ef 7 f 611 f 594731015621 e 730d 9713 AE 59824 f 3280703 BD 3c 7 de 5ba 8884767</figcaption></figure><p id="705b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">永恒之虫第二阶段:</strong></p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/ca29b36ca9b70db12ce024bc0638c5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*F0Xz1XilheQi05bO3W-Cbw.png"/></div></figure></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="a7d1" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">静态分析:</strong></h2><h2 id="d356" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">永恒之虫第一阶段:</strong></h2><p id="cca6" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">这个永恒蠕虫的示例有一个图像图标来欺骗天真的用户，特别是在文件扩展名被隐藏的情况下，这是一个很好的技巧，因为进一步分析我们会发现，在运行假定为图像(恶意软件)的后，它会从其资源中运行一个图像来隐藏其执行:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/479902545c8f78ca1b4f70e59548dbbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*JgLgTla3Plljhqr2bijLZw.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">延伸技巧</figcaption></figure><p id="214d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">把样本扔在“简单检测”上，我们发现它是。NET混淆样本，因为它出现在从"<strong class="jw ir">。正文</strong>章节:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/da8685df339cf246817660601a08ff33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PW9m0bmHQchub8opTg_tQQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">很容易发现它</figcaption></figure><h2 id="1754" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">解包恶意软件:</strong></h2><p id="69de" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated">在“<strong class="jw ir"> dnspy </strong>中运行该示例，我们可以看到它被严重混淆，与“<a class="ae mn" href="https://0xm3h51n.medium.com/malware-analysis-4-eternity-project-eternity-stealer-682df3f0dafd" rel="noopener"> <strong class="jw ir">永恒窃取者</strong> </a>”恶意软件非常相似。所以我用“<strong class="jw ir"> de4dote </strong>”对样品进行去泡沫和清洁:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mo"><img src="../Images/fd1c2b46c1b73de0389b7879c2c1ade4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2iVkCtnT2VbH2VanTF1W_g.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">混淆的主方法</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mp"><img src="../Images/500617f45ad7cbe2ae3c22a266d5b1de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWttGb8T1fhaWJIf4ulxrA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">用于去除样品气泡的de4dote命令</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mq"><img src="../Images/c0bec82abd4dd930b92de5c50f3f34f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7YB6V5jyAlyEkcbMhzu22g.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">除氧后的主要方法</figcaption></figure><p id="df0e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从上面清理后的版本映像中，我们可以看到加载程序将获得它的资源，它将从加载加密的映像及其密钥开始，然后用一个简单的解密例程解密并运行它。此外，对worm可执行文件执行同样的操作，并在执行后退出:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/3e9e055aab6626a7bf60dbf854f2391f.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*HnrK2V623GmMrOiPn86nOg.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">装载机资源</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/1d152addfc5b95744d95fe6277ade6dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*oHaRry57fEYyLx6LpPHsiA.png"/></div></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mt"><img src="../Images/535914ccb8175499c69f21a5929fe711.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ngaI2vqCTshpareM_oZDJg.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">图像解密过程的十六进制编辑器视图</figcaption></figure><p id="9906" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了获得解密的恶意软件样本，我们在解密例程后设置一个断点，然后用正确的扩展名保存保存恶意软件的缓冲区，我们将获得一个工作样本:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mu"><img src="../Images/d79e7d5312f3980e2f0beb5af1e12b49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kDCY7dSsWHjcX-6-5sye6w.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">解密后保存</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mv"><img src="../Images/1f816a186fec89806bab3c614f9c96a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xJBo5YTEL2fn9kXHYIWGuw.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">十六进制编辑器查看wrom的解密过程</figcaption></figure><p id="5ad1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者使用python，我们可以在保存后解密资源文件:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mp"><img src="../Images/53f5f7c2df69df407b1fcc5cca2975f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XpOD6MNFZWBIZWq-zPZRsg.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">解密资源文件的Python脚本</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/efbf23f068c8fbdc55464517bc1ab98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*J4F--o28F8VDpoUulwCu-A.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">执行完蠕虫后退出</figcaption></figure></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="344b" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">永恒之虫第二阶段:</strong></h2><p id="4117" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><strong class="jw ir">地理围栏:</strong></p><p id="150a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">永恒蠕虫通过枚举机器上的语言开始，如果它发现机器有乌克兰语言，它将打印消息“<strong class="jw ir">荣耀乌克兰</strong>”并退出，否则它将继续执行:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mx"><img src="../Images/2fdec0cf625eb39347573d793bed477f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JzvZMXVgTU-bsNXqqoDW5Q.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">地理围栏法</figcaption></figure><p id="76eb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">防重复:</strong></p><p id="7d9a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这个功能不是恶意软件的核心功能，它是根据买家的选择添加的。恶意软件将检查命令行参数中是否有“- -debug”字符串，如果没有发现，它将创建一个名为“nwwqwdpozq”的命名对象/互斥体。未能创建互斥体将导致进程退出，否则执行将继续:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi my"><img src="../Images/55e5aeafb1c83d5dc1c8f18b0bbf9dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5U3rLqmA8tufJkdVcWLXJg.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">反重复方法</figcaption></figure><h2 id="97ed" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">文件抓取&amp; C2通讯:</strong></h2><p id="74eb" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><strong class="jw ir">下载的文件:</strong></p><ul class=""><li id="4d2b" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">"<strong class="jw ir"> hxxp[://]soapbeginshops[。]com/kingz[。]exe </strong>"</li><li id="719c" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">"<strong class="jw ir"> hxxp[://]soapbeginshops[。]com/ItsMe[。]zip </strong></li><li id="3582" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">"<strong class="jw ir">hxxp[://]light nogu 5 owjjllyo 4 T2 sfos 6 fchnmcidlgo 6 c 7 e 6 f z2 hgryhfhoyd[。]洋葱。宠物/共享/电报。]exe </strong>"</li></ul><p id="75a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们还可以用Wireshark和Fakenet捕获请求:</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nn"><img src="../Images/2f4a899876e1c19d43ceaf912b49c4aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uav3iH27QBbAKGee4b20lQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">获取“kingz.exe”的请求</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi no"><img src="../Images/37a31e073bd1d09e1edefe7a8fe1bafc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4F06IY1P4EFWPVRq9TyHA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">下载“ItsMe.zip”</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi np"><img src="../Images/1e48945da8c6e115e1758f4766485871.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tljpsb5eNFyaSqerNoH_dA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">正在下载“telegram.exe”</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/b81f85ae0fa09188883b1ebaf518e2b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*v98CEbXKmC5VH7s-I8bWgQ.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">获取“ItsMe.zip”的请求</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/114fdbcf6f5ed3491f3686458dfe6a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*JJ7N12j0X2PnWMJdO5oOmg.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">获取“telegram.exe”的请求</figcaption></figure><h2 id="f8ca" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated"><strong class="ak">展开技术:</strong></h2><p id="1874" class="pw-post-body-paragraph ju jv iq jw b jx ls jz ka kb lt kd ke kf lu kh ki kj lv kl km kn lw kp kq kr ij bi translated"><strong class="jw ir"> 1 -垃圾电报:</strong></p><ul class=""><li id="4206" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">下载假的“telegram.exe”并以参数“哈哈哈哈哈，你看到这个了吗？?"。论点可以这样用"<strong class="jw ir">哈哈哈哈哈，你看到这个了吗？？【有效负载_网址】</strong>”。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ns"><img src="../Images/f3a745ba931e6a647cbaa8cd4d55cdff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LRACcbBFNbsuFW9qtBPNBw.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">电报垃圾邮件方法</figcaption></figure><p id="aa06" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> 2 -感染文件:</strong></p><ul class=""><li id="55ec" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">枚举目录(桌面-图片-文档)并从中获取文件列表。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nt"><img src="../Images/fa68e0e9699760747d5a2c510749f2e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VVaU8htltQHi_tnXZ6j0SQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">文件感染方法</figcaption></figure><ul class=""><li id="33f7" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">对于每个文件，它通过哈希检查其扩展名，如果符合以下任何扩展名，它将被感染:</li></ul><p id="3263" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">(png-exe-txt-zip-xlsx-bat-MP3-MP4-py-pyw-docx-jar-pdf-pptx)</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nu"><img src="../Images/a4640c66c87e1948f6779805599ff1f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMGDufsZ6xmT25F3ucb0Og.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">扩展比较</figcaption></figure><ul class=""><li id="97dc" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">在临时目录中创建一个加载程序可执行文件，其中包含:</li></ul><p id="c5f4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">—将解密和执行资源文件的存根。</p><p id="080a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">—原始文件的加密代码。</p><p id="596b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">—“kingz . exe”的加密代码及其解密密钥。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nv"><img src="../Images/f0f4c68470aef2aadd2480d54f44085a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QHSqgs0gZ-gfsiBJmpnB5g.png"/></div></div></figure><ul class=""><li id="d69a" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">改变文件的图标来模拟原始文件图标。</li><li id="8700" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">将原始文件(创建、修改、访问)的时间和日期复制到伪造文件中。</li><li id="b524" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">将伪造文件复制到原始文件位置，并使用RTLO(从右到左覆盖)技术伪造扩展名。这将使文件出现与原始文件扩展名，而它使用“scr”扩展名，这是一个屏幕保护程序，将执行代码。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/9a65b8c6d50f5e5090ca69682624b6fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*m6PRGrAWL7PA3DIZ9NOMwQ.png"/></div></figure><ul class=""><li id="7e0e" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">结果将是一个类似于stage 1 loader的可执行文件，它将执行原始文件和“kingz.exe”可执行文件。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nx"><img src="../Images/06ba62a62e6b0ecb00d7df5cd33d76aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_bWfS_67WyVEZX01puz9vQ.png"/></div></div></figure><p id="411e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> 3 -感染驱动器文件:</strong></p><ul class=""><li id="f2ce" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">仅感染可移动驱动器，感染文件的方式与前面提到的相同。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nx"><img src="../Images/652e19ee0ab8225501f30bd4f51f9682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ig237CGoCli5KVVi6Z-UvA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">驱动感染方法</figcaption></figure><p id="947e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> 4 -感染Python解释器:</strong></p><ul class=""><li id="23a6" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">通过在文件开头或结尾添加base64代码感染Python OS模块，会下载“kingz.exe”文件。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi ny"><img src="../Images/cd206309270ebc40c89cbf047cc480a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIqM2ayHa3qY1PLyH9kEsg.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">Python感染解释器</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nz"><img src="../Images/19719485b78fdc0ccdd12ece2cf460ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flLnKyrZyl6qPtQhYX9u1g.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">“os.py”末尾的Base64代码</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/33b02b988470a98b9ec30f53755aff3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*gxn-r64jSXePP-EUdE17-g.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">解码base64</figcaption></figure><p id="5175" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> 5 -感染云目录:</strong></p><ul class=""><li id="b551" class="mz na iq jw b jx jy kb kc kf nb kj nc kn nd kr ne nf ng nh bi translated">从目录中获取文件(Dropbox - OneDrive)并以前面提到的相同方式感染它们。</li></ul><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/d80f31022a51ff2f4192f27e24c2f718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KEVYlA3FMS8Cou4XK2ZyA.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">云感染方法</figcaption></figure><p id="0e32" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> 6 -制造不和谐的垃圾邮件</strong></p><p id="2353" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">用GET请求检索用户名到"<strong class="jw ir"> hxxps[://]discord[。]com/api/users/@me </strong>，它返回一个JSON，然后从字段“username#”中检索值和字段“discriminator”的值，通过请求“<strong class="jw ir">hx XPS[://]discord]来检索通道。]com/api/users/@me/channels </strong>"。然后遍历id列表，对于每个id，它将向"<strong class="jw ir">hx XPS[://]discord[]发出POST请求。]com/API/v 9/channels/{ 0 }/messages</strong>”，使用ID和消息的内容是:“<strong class="jw ir">哈哈哈哈哈，你看到这个了吗？？【有效载荷_网址】</strong>”。</p><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nu"><img src="../Images/6931ab9afe8fd36074234787c7f26ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7umekGeJMSoAqIRZUXBmIQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">通道枚举法</figcaption></figure><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi oc"><img src="../Images/30ceed340df964e1c4cde19b8f2e4657.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olnFgaRS9T-Q6G-CVVOqvA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">发送恶意消息的方法</figcaption></figure></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="cfd0" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">特点:</h2><ul class=""><li id="1085" class="mz na iq jw b jx ls kb lt kf od kj oe kn of kr ne nf ng nh bi translated">地理围栏。</li><li id="62ff" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">反反复复。</li><li id="7a90" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">混淆视听。</li><li id="6363" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">反VM。</li><li id="5b16" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">反任务经理。</li><li id="f822" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">反调试。</li><li id="a7f2" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">设置关键流程。</li><li id="c8bb" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">提升特权。</li><li id="2e18" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">自毁。</li><li id="91ec" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">扩展欺骗</li><li id="2c50" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">图标恶搞。</li><li id="b066" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">不和谐垃圾邮件。</li><li id="6018" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">滥发电报。</li><li id="3177" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">Python解释器感染。</li><li id="b423" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">用户目录感染。</li><li id="2073" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">云目录感染。</li><li id="c050" class="mz na iq jw b jx ni kb nj kf nk kj nl kn nm kr ne nf ng nh bi translated">可移动驱动器感染。</li></ul></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="d60d" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">亚拉法则:</h2><figure class="ly lz ma mb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mp"><img src="../Images/658920866c4c175fe97a349dedc8e08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ACp6I-6GryvhwxVM1NWbLg.png"/></div></div></figure></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h2 id="c7f2" class="kz la iq bd lb lc ld dn le lf lg dp lh kf li lj lk kj ll lm ln kn lo lp lq lr bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae mn" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>