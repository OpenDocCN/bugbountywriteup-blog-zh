<html>
<head>
<title>Advent of Cyber 2022 [Day 12]-Malware Analysis Forensic McBlue to the REVscue! Write up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络2022的来临[第12天]-恶意软件分析法医麦克布鲁到REVscue！写出来</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/advent-of-cyber-2022-day-12-malware-analysis-forensic-mcblue-to-the-revscue-write-up-44fc80e95c7?source=collection_archive---------0-----------------------#2022-12-12">https://infosecwriteups.com/advent-of-cyber-2022-day-12-malware-analysis-forensic-mcblue-to-the-revscue-write-up-44fc80e95c7?source=collection_archive---------0-----------------------#2022-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="27fb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Cyber 2022来临[第12天] <strong class="ak">恶意软件分析| </strong>法医McBlue到REVscue！|任务16回答Karthikeyan Nagaraj的评论和演练</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/1433bcaa545f62df129dddeb5d073724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*62IICiud9LX3NN4GtGz_zQ.png"/></div></figure><h1 id="6591" class="kn ko iq bd kp kq kr ks kt ku kv kw kx jw ky jx kz jz la ka lb kc lc kd ld le bi translated">任务16—恶意软件分析取证McBlue到REVscue！</h1><blockquote class="lf lg lh"><p id="81fc" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">启动机器，进入状态</p></blockquote><h2 id="ba90" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">1.恶意软件示例的架构是什么？(32位/64位)</h2><p id="7d03" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated"><strong class="ll ir">让我们轻松打开文件</strong></p><blockquote class="lf lg lh"><p id="3801" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq"> Detect It Easy，简称“DIE”是一个用于确定文件类型的程序。</em></p><p id="3238" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq">“DIE”是一个跨平台的应用，除了Windows版本还有Linux和Mac OS版本。</em></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mz"><img src="../Images/9575d8a9f2f6af1fb4cf613364e7e64c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o6ycR6u1PSP7aTAz413hvg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/911b8994863b437e47eeeb240eb07d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*zbUYtLT5kOdBpE654RjRmQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ne"><img src="../Images/24abb24c1bd6108ecde00a4845d261f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-hHxTIERr89Y5c5OcwtV-Q.png"/></div></div></figure><p id="9026" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">因此它是64位架构！！！</p><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="9a9c" class="nk ko iq ng b be nl nm l nn no">Ans: 64-bit</span></pre><h2 id="7d90" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">2.恶意软件示例中使用的打包程序是什么？(格式:小写)</h2><p id="67e5" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">分析上面的图像图像！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ne"><img src="../Images/1bcacaa66e44a1e55c560695f490c843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cRdZWEVJbjebkoq7UnVOIQ.png"/></div></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="da70" class="nk ko iq ng b be nl nm l nn no">Ans: upx</span></pre><h2 id="8abc" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">3.用于构建恶意软件样本的编译器是什么？(格式:小写)</h2><p id="3016" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">让我们用capa来分析这个文件</p><blockquote class="lf lg lh"><p id="1823" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq"> capa检测可执行文件中的功能。你和一个PE，ELF，对着干。NET模块或外壳代码文件，它会告诉你它认为程序可以做什么。例如，它可能表示该文件是一个后门程序，能够安装服务，或者依赖HTTP进行通信。</em></p></blockquote><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="19e5" class="nk ko iq ng b be nl nm l nn no">capa -vv mysterygift</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/2ca01dfc6783b095e652adf232e3e8f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*bN-PLUeGDxa_jXglswl0zg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nq"><img src="../Images/a20f9aec4508611860c225da51670620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhrggkXTedjhsSe5eexB7w.png"/></div></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="e31c" class="nk ko iq ng b be nl nm l nn no">Ans: nim</span></pre><h2 id="d486" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">4.有多少米特ATT和CK技术被发现归功于发现策略？</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/94b7a40f788b010f8a0829130f4f8999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*OdNJok_0nXn7ZujfpzB9yw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/4170e0501c0a8e9292ae9641369097eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*8RN85xZ9esvUW4t7D4cySw.png"/></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="348c" class="nk ko iq ng b be nl nm l nn no">Ans: 2</span></pre><h2 id="34f2" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">5.恶意软件滥用的注册表项是什么？</h2><p id="80f9" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">这里我们想打开屏幕底部的进程监视器</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8fe41a098be8ff9a1b4db2adcb785c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/1*IYkYLD2d4OOv8uh-3_5LcA.png"/></div></figure><p id="fbc0" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">将流程名称添加为mysterygift.exe，然后单击添加</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/ef3c6e50423347fab48cfd167e0e3a2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*sxqc8I63o0BVcrqAJsiZfw.png"/></div></figure><p id="8fb5" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">将文件扩展名更改为exe</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nv"><img src="../Images/244f08529c1415e2078144cdb16befa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*fPVML-0IavR-7RED8ibdvA.png"/></div></div></figure><p id="4533" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">现在请注意进程监视器</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nw"><img src="../Images/95c252d5eae15c3e686ac8e7232cf573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sMy-YfJJ3L8kRQBSQPcig.png"/></div></div></figure><p id="ba02" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">我们只需要RegCreateKey包含操作，或者您可以排除下面列出的不必要的包，</p><ul class=""><li id="c107" class="nx ny iq ll b lm ln lp lq mk nz mn oa mq ob me oc od oe of bi translated">RegOpenKey</li><li id="c4c1" class="nx ny iq ll b lm og lp oh mk oi mn oj mq ok me oc od oe of bi translated">RegQueryValue</li><li id="29b9" class="nx ny iq ll b lm og lp oh mk oi mn oj mq ok me oc od oe of bi translated">RegQueryKey</li><li id="bb20" class="nx ny iq ll b lm og lp oh mk oi mn oj mq ok me oc od oe of bi translated">RegCloseKey</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/eeba47c7bceddd6621984a83a0b9b309.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*UCpbozFtUaw_u2RD3dpa1A.png"/></div><figcaption class="om on gj gh gi oo op bd b be z dk translated">右键单击并单击排除！！</figcaption></figure><p id="33b6" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">您可能会注意到只有一个注册表项同时具有<strong class="ll ir"> RegCreateKey </strong>和<strong class="ll ir"> RegSetValue </strong>。该密钥与名为<strong class="ll ir">注册表运行密钥修改</strong>的持久性技术相关，通常被恶意软件开发者用来安装后门。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/f0bc86d7ce7e8e793e62a2e54671da51.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*nVFnxtG1X-vBMy0nvOHjQw.png"/></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="c8ec" class="nk ko iq ng b be nl nm l nn no">Ans: HKCU\Software\Microsoft\Windows\CurrentVersion\Run</span></pre><h2 id="8a9c" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">6.根据上一个问题，注册表项上写的值是什么？</h2><p id="a808" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">双击我们找到的结果</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi or"><img src="../Images/721fd2dfcd95ba39b631a8fc803be0f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhuBmFG75dSzBFlKCM8qqg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi os"><img src="../Images/a529ec66ecb6e319ab7355cec5f0691f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2rduUCH_YFaZcn0aI8jPug.png"/></div></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="fca2" class="nk ko iq ng b be nl nm l nn no">Ans: C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\wishes.bat</span></pre><h2 id="8fda" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">7.恶意软件在<strong class="ak">C:\ Users \ Administrator \</strong>目录下创建的两个文件的名称是什么？(格式:文件1、文件2按字母顺序排列)</h2><p id="93c6" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">点击下图右上角的文件夹过滤器，</p><p id="8dd4" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">仅包括CreateFile操作</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/b386fe55d66b863d9de015e08bc6cf3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*B2bbsXcgVLh9UBRJZm3TPg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/e168caaf3a9027bab9b28aae5e6b64ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*QSym4ja1bv5SYo_Uyfy96A.png"/></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="bb72" class="nk ko iq ng b be nl nm l nn no">Ans: test.jpg, wishes.bat</span></pre><h2 id="dbdc" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">8.恶意软件发起网络连接的两个域是什么？(格式:按字母顺序排列的域1、域2)</h2><p id="df84" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">添加以下过滤器并搜索域</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/80d7d7a9f8b16e25a123d61eaebadc74.png" data-original-src="https://miro.medium.com/v2/resize:fit:478/format:webp/1*QiTwERKdNOmBctGZwlQxjQ.png"/></div></figure><p id="26c5" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">这里我们可以看到，网络活动中的2个领域是</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/d1271c169f85f6b03eacc841461760c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*l5CCLzoDbfLAEWCTjA5epQ.png"/></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="1255" class="nk ko iq ng b be nl nm l nn no">Ans: bestfestivalcompany.thm, virustotal.com</span></pre><h2 id="1142" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">9.回到恶意软件示例中的字符串，用于下载恶意软件访问的第一个域中托管的文件的完整URL是什么？</h2><p id="9a5b" class="pw-post-body-paragraph li lj iq ll b lm mu jr lo lp mv ju lr mk mw lu lv mn mx ly lz mq my mc md me ij bi translated">在CMD上使用下面的命令！</p><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="4f34" class="nk ko iq ng b be nl nm l nn no">cd "Desktop\Malware Sample" <br/>floss -n 6 mysterygift.exe | grep http://</span></pre><p id="f946" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">或者你可以使用Detect很容易地找到EXE中的字符串</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ox"><img src="../Images/c83e2f6502886fe7b0a1cc9ccd557a9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SgNFiSm50C76vPOD31gnYA.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/2434d8fe3549a0dc16246400765d141f.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/format:webp/1*QipLcee1QhAFFPtDx90FQA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi oz"><img src="../Images/f19ad34b0cfa5869603dda8454d16b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBMyfYfEzQL7ZKNAzQMbAA.png"/></div></div></figure><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="7649" class="nk ko iq ng b be nl nm l nn no">Ans: http://bestfestivalcompany.thm/favicon.ico</span></pre></div><div class="ab cl pa pb hu pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="ij ik il im in"><p id="7d4b" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">感谢您的阅读！！</p><p id="4df5" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">黑客快乐~</p><pre class="kg kh ki kj gt nf ng nh bn ni nj bi"><span id="44ec" class="nk ko iq ng b be nl nm l nn no">Author : Karthikeyan Nagaraj ~ Cyberw1ng</span></pre><p id="063b" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">查询:</p><p id="7a31" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mk lt lu lv mn lx ly lz mq mb mc md me ij bi translated">THM，TryHackMe，TryHackMe 2022年网络时代的到来，TryHackMe 2022年网络时代的到来第12天，道德黑客，写，走过，TryHackMe 2022年网络时代的到来第12天答案</p></div><div class="ab cl pa pb hu pc" role="separator"><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf pg"/><span class="pd bw bk pe pf"/></div><div class="ij ik il im in"><h2 id="13ae" class="mf ko iq bd kp mg mh dn kt mi mj dp kx mk ml mm kz mn mo mp lb mq mr ms ld mt bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ph" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>