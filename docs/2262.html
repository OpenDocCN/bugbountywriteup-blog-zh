<html>
<head>
<title>Hunting webshell with NeoPI</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用NeoPI搜索webshell</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hunting-webshell-with-neopi-62b76ce10d6b?source=collection_archive---------0-----------------------#2022-08-10">https://infosecwriteups.com/hunting-webshell-with-neopi-62b76ce10d6b?source=collection_archive---------0-----------------------#2022-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/eca7fb088f3159dca496c91c68ad7e63.png" data-original-src="https://miro.medium.com/v2/resize:fit:614/format:webp/1*BU6QxMTh2ijBGxYbxd1lTQ.png"/></div></figure><p id="f17c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗨伙计们！</p><p id="8a92" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇短文中，我想展示NeoPI工具的功能，它是一个python脚本，通过统计可以检测恶意的webshells。</p><p id="e8ec" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">开始吧！</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="4a4d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要下载该文件，请克隆以下存储库。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="2653" class="li lj iq le b gy lk ll l lm ln">git clone https://github.com/Neohapsis/NeoPI.git</span></pre><p id="5fd5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要运行该工具并查看标志，请使用以下命令。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="a567" class="li lj iq le b gy lk ll l lm ln">python neopi.py -h</span></pre><figure class="kz la lb lc gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/043521b4bddf1f2084eb3c46e42cb597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*TA5gXZ0aihFqFdvt4gN5sQ.png"/></div></figure><p id="ed59" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们来看看这个工具的一个实际应用。</p><p id="7f8a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通常，web服务器中的文件存储在/var/html/www目录中。</p><p id="10f4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我将把3个php文件放在目录中，其中只有一个是恶意的，还有一个aspx shell，看看这个工具是否能检测到任何东西。</p><p id="11b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">注意:为了方便起见，我将使用Documents文件夹，而不是/var/www/html。</p><p id="dbe2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我将使用下面的命令。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="555e" class="li lj iq le b gy lk ll l lm ln">python neopi.py "Your directory" -a -A</span></pre><p id="477a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lp">注意:永远记住使用-A标志只分析扩展名可能有害的文件，否则该工具将花费很长时间来分析所有文件。</em></p><p id="0187" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是输出。</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/a4e701e60df6be8a74067837fbf559b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1244/format:webp/1*NujwFNBZrJhjjvvFNAmIug.png"/></div></figure><p id="89af" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lp">注意:还有另一个PHP文件，但是该工具识别出它没有恶意，并将其从输出中排除。</em></p><p id="50cd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如我们所看到的，该工具已经成功地实现了它的意图，请记住，数字越低，该文件是恶意的可能性就越高。还要密切注意签名计数(通常1是恶意的)。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="c022" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在结束之前，我想对这个工具的使用提出一个前提。</p><p id="dceb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">可能会发生一些模糊的webshells不容易被检测到的情况，所以我还是建议进行手动文件审查。</p><p id="b00d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">感谢您阅读我的文章。</p><p id="fc62" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">到下一篇，拜拜！</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="bcdd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lp">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae lr" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> <em class="lp">加入我们的每周简讯</em> </strong> </a> <em class="lp">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>