<html>
<head>
<title>SONY Hunting I: Discovering Hidden Parameters (5x SWAG)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">索尼狩猎I:发现隐藏参数(5x SWAG)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/sony-hunting-i-discovering-hidden-parameters-5x-swag-c3396c0064bc?source=collection_archive---------0-----------------------#2021-11-07">https://infosecwriteups.com/sony-hunting-i-discovering-hidden-parameters-5x-swag-c3396c0064bc?source=collection_archive---------0-----------------------#2021-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2421" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。</p><p id="3287" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">已经很久了。希望大家都好。我想，我应该发表一篇新的评论，我已经准备好了。<br/>今天我要讲的是几个月前我在索尼发现的一系列漏洞。好，那我们走吧！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b8aa3392b530e9a01a9675f281d857ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*peQ2U-v6afMgrAEE2HMP7Q.png"/></div></div></figure><p id="73b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所知，<strong class="jp ir">索尼</strong>是一个巨大的目标，即使我没有任何财务利润(只有赃物)，我也特别喜欢照顾它。<br/>一般来说，专注于单一的漏洞类型不是我的风格。然而，在这个广泛的范围内，我想让事情变得简单一点，只关注开放重定向漏洞。因为寻找诸如开放重定向之类的漏洞被遗忘或忽略了。所以，这篇文章的主题将是<strong class="jp ir">的开放重定向。</strong>(我打算以后用其他漏洞继续这个系列。)</p><blockquote class="kx ky kz"><p id="d0bd" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">侦查是我的生命</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/83248e088e56c413bf6e27aba94f42b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0EIKvcdz9N_BFzR8FxeCvA.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">crt.sh/?q =索尼</figcaption></figure><p id="a106" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我注意到，在范围较广的程序中，使用关键字比输入目标的域名更有用。</p><p id="70b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在某些程序中，尝试使用“Sony”“Sony typictures”这样的关键字，而不是“sony.com”或“sony.net ”,可能会产生更多输出。同时“%”之类的呆瓜。%.%.target.% "和“%.target.net”在crt.sh上还是可以有创意的</p><blockquote class="kx ky kz"><p id="7177" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">搜寻隐藏参数</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lj"><img src="../Images/77c8a0524c7c00c02367365742c5a45b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P59y4HTM0Lhix8VEuGLl6g.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">“redirectUrl”参数是一个潜在的开放重定向。</figcaption></figure><p id="cf17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这段时间里，我与GAU和FFUF一起回顾了索尼的子域名。(有时是waybackurls)一般来说，我关注的是带有登录或注册部分的域。<br/>基本上我所做的是发现接受用户输入的页面，然后尝试重定向用户，看看参数是否正常工作。<br/>此外，JS文件对于发现新参数总是很重要的。当我得到一个js文件作为任何输出的结果时，我用LinkFinder查看其中的参数。最后，Paramspider或Arjun可以帮助我们发现隐藏的参数。</p><p id="d96d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们基本上已经看到了我们能做什么，让我们继续我遇到的案例。</p><blockquote class="kx ky kz"><p id="2b78" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">案例一:使用隐藏参数的基本开放重定向</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/3fc16dee55c8e3c36a65a12b27be9e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*5Hw1HY87PV7SNsXoNWjMYQ.png"/></div></figure><p id="b35a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第一种情况下，我正在浏览SonyPictures的子域，我注意到它们中的大多数没有收到用户的输入。然而，我发现了几个例外。</p><p id="b186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我打开页面的源代码时，我通常会搜索隐藏的参数和关键字，如“重定向”或“返回”。<br/>没多久，我偶然发现了一个类似下面的参数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ll"><img src="../Images/608b18feb7c4d952495706aeec037ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EEt-bTzfCe3t2vZzHF5ecA.png"/></div></div></figure><p id="4f97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">隐藏参数在URL中不可见，所以我们必须自己添加参数。我试图通过创建一个类似下面的结构来干扰这个参数。<br/><em class="la">sonypicturessite.tld/login/?redirect_to=targetsite.com"</em></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lm"><img src="../Images/260e60bd012e0abe71a330ede7b22692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gn3wCfd0F7_4Cc5GHo2uAQ.jpeg"/></div></div></figure><p id="b79a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当尝试重定向参数时，我做的第一件事是将“. evil.com”添加到域的末尾。使目标网站成为子域，并重定向到evil.com。这是一个快捷方式，它允许我们看到参数的结尾没有被过滤。</p><blockquote class="kx ky kz"><p id="0aaf" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">情况二:复制隐藏参数</strong></p></blockquote><p id="9444" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与第一种情况类似，我在不同的登录面板中发现了一个隐藏的参数。然而，这一次它不允许开放重定向。我尝试了很多方法，但无法绕过它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ln"><img src="../Images/24888c9d567ec8735e82a144d9b76c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZEgp04dHfBmhD60CVv0XWw.jpeg"/></div></div></figure><p id="1d25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是游戏当然不会就此结束，我想到了在不同的潜在重定向区域尝试相同的参数。就像登录一样，注销屏幕也是其中之一。<br/>在这一点上，我认为我在登录屏幕上发现的参数是一个常用参数，用于注销或重定向同一个站点。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lo"><img src="../Images/65f754a096a10f5cefd7da3ee924276a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eNjh0bHN8GRv3FmCTp2s8Q.jpeg"/></div></div></figure><p id="0f22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将找到的参数添加到注销URL的末尾，并获得了另一个成功的重定向。</p><blockquote class="kx ky kz"><p id="6372" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">案例三:干扰重定向</strong></p></blockquote><p id="ea3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章的最后一个例子是关于干扰使用URL上的镜像参数进行的重定向。让我们来看看这个例子，以便更好地理解这一点。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/27fb6a178d90dbd8a5d515fe5c7d13d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*D6S96lpjiP0MODwom7b0SA.jpeg"/></div></figure><p id="b195" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在最后一个目标中，当我点击登录时，它将我重定向到通过sony.com登录。然而，中间的重定向参数没有逃过我的注意。这个URL看起来很乱，所以我决定用Burp Suite来检查它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lq"><img src="../Images/92e9e744fa43535e559be53d948e3f7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*scfZhNHBvWaMR2DKxlNXXA.jpeg"/></div></div></figure><p id="a5a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我第一次尝试就能够将“redirect_url”参数重定向到目标站点。</p><p id="489b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我有5个索尼的赠品。我发现的其他重定向与这些类似。</p><p id="8695" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这些了，谢谢你的阅读。你可以在推特上关注我。<a class="ae lr" href="https://twitter.com/canmustdie" rel="noopener ugc nofollow" target="_blank">https://twitter.com/canmustdie</a></p></div></div>    
</body>
</html>