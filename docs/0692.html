<html>
<head>
<title>Do it ASAP !!!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">尽快做！！！</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/do-it-asap-9d1847472bc8?source=collection_archive---------0-----------------------#2020-07-17">https://infosecwriteups.com/do-it-asap-9d1847472bc8?source=collection_archive---------0-----------------------#2020-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e1eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发现认证过程中的错误，导致我<strong class="jp ir">完全ATO[帐户接管] $$$ </strong></p><p id="f0ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/205e6c1bc60621f5acece9f9a3f68053.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*Vqic1SzAq09eItTV-TL8Cg.jpeg"/></div></div></figure><p id="19e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我告诉你从上一篇到这篇文章延迟的原因，我正忙于提供信息安全和BugBounty培训。我也在隔离区独自工作。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="65b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi le translated"><span class="l lf lg lh bm li lj lk ll lm di">这里有一个新的…我们将会看到通过逻辑缺陷来利用认证。当我们谈到身份验证中的逻辑缺陷时，我们包括:</span></p><ul class=""><li id="df96" class="ln lo iq jp b jq jr ju jv jy lp kc lq kg lr kk ls lt lu lv bi translated">忘记密码机制</li></ul><p id="6d1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我们将关注认证过程中的<strong class="jp ir">忘记密码</strong>。但在此之前，让我先弄清楚这个场景。</p><p id="e6c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">场景:<br/> </strong>我在一个私人程序中发现了这个bug。那个漏洞让我全盘接管了账户。</p><ol class=""><li id="2d4a" class="ln lo iq jp b jq jr ju jv jy lp kc lq kg lr kk lw lt lu lv bi translated">我确实用<br/> <strong class="jp ir">测试邮箱:</strong><em class="lx">bug@nalafx.com</em>创建了一个账户</li><li id="fe84" class="ln lo iq jp b jq ly ju lz jy ma kc mb kg mc kk lw lt lu lv bi translated">点击了忘记我的密码:</li></ol><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/7ebfa299098f1fa9a4d5c2ce18549968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m7YJGFKE0g-gC-Et96Ztyg.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#1</figcaption></figure><p id="5696" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦你点击了“<strong class="jp ir"> <em class="lx">”发送恢复链接</em> </strong>”，网络应用程序应该发送重置链接到账户。</p><p id="aa2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是等等…我们需要在burp suite中检查请求:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mi"><img src="../Images/2f385b44c0f3f3609874b860dfbddc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RzS9pDmyVx5uyaImweFd9g.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#2</figcaption></figure><p id="e590" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在请求区可以看到，有一个参数“<strong class="jp ir"> resetPasswordUrl </strong>”。该参数由web应用程序设置。我发送了这个请求，得到的回复是成功的。</p><blockquote class="mj mk ml"><p id="2a66" class="jn jo lx jp b jq jr js jt ju jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj kk ij bi translated">现在的问题是:</p></blockquote><p id="e76b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问:在上述情况下，你怎么能说应用程序的忘记密码机制是易受攻击的呢？</p><p id="c341" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我尝试修改“<strong class="jp ir"><em class="lx">resetPasswordUrl</em></strong>”参数的值，我发现我在参数中输入的值准确地反映在我的密码重置电子邮件中。这里是重置密码URL的修改值:"<strong class="jp ir">等等等等</strong>"</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/5d52aeb2e3cdebbb243c1952a2af167c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TzBa2RrcPS59lDbkF8wm3g.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#3</figcaption></figure><p id="3c2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查电子邮件收件箱，看看反映的值:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mq"><img src="../Images/e536fa2fed491c01726ea870698683b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yGlu-ZuQNjN_enAwtj8ixQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#4</figcaption></figure><p id="f74c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在resetPasswordUrl参数中添加了这个值“<strong class="jp ir"><em class="lx">https://target.com@evil.com/</em></strong>”:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/1a42876da4b699bf1210c70d0b791dc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AUDoTrhOcPB6aGz0JlmyQw.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#5</figcaption></figure><p id="b79f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我收到了一封类似这样的电子邮件:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/01c44a30b4dc285cb7b7728532095bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GCejOJHNqQI8uj3AZRbbg.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#6</figcaption></figure><blockquote class="mj mk ml"><p id="7cf6" class="jn jo lx jp b jq jr js jt ju jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj kk ij bi translated">现在的问题是:</p></blockquote><p id="d845" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">问:如何利用它接管帐户？</strong></p><p id="65cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会想这是什么造成的影响！要了解影响，我们必须先了解漏洞利用。</p><p id="86b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在web浏览器<em class="lx"> </em>中，如果<em class="lx"> </em>在完成域名之前输入<strong class="jp ir"> " <em class="lx"> @ </em> " </strong>，那么<strong class="jp ir"> " <em class="lx"> @ </em> " </strong>之前的所有值都将被视为凭证。</p><p id="b337" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">举个例子:<a class="ae mt" href="https://twitter.com@tesla.com" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="lx"/></strong></a></p><p id="d825" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以将会发生的是它将被重定向到“<strong class="jp ir"> <em class="lx">”特斯拉. com“</em>”T3。</strong></p><p id="136c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据截图#6:当用户点击那个密码重置链接时，用户会重定向到<strong class="jp ir"><em class="lx">" f 437 BFF 15 e 10 . ngrok . io "</em></strong>以及重置令牌<strong class="jp ir"><em class="lx">；)</em> </strong>一旦用户访问密码重置链接，我们就在ngrok连接上接收数据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mu"><img src="../Images/f4ea35b5f9fe85c2df1daa70d9402369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aguudq9Awrx1yi6dvWLnww.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">截图#7</figcaption></figure><p id="3785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，<strong class="jp ir"><em class="lx">“vtoken”</em></strong>参数和值对于重置密码非常重要。作为一名攻击者，我捕获了这个，这样我就可以重置其他人的密码并访问该帐户。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/18f7f6e06b03ef2e1c470e5420162ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/1*rcpVpxN1Ed_QKoG57H5J3g.gif"/></div></figure><p id="5921" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你能得到一些动力去做bug奖励，并在下一篇文章中再见。</p><p id="2282" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lx">推特简介:@ </em> <a class="ae mt" href="https://twitter.com/Dheerajmadhukar" rel="noopener ugc nofollow" target="_blank"> Dheerajmadhukar </a></p><p id="713c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lx"> Linkedin简介:@</em><a class="ae mt" href="https://www.linkedin.com/in/dheerajtechnolegends/" rel="noopener ugc nofollow" target="_blank">dheerajtechnolegends</a></p></div></div>    
</body>
</html>