<html>
<head>
<title>Why u should use burp to test Path Traversal Vulnerability and also get RXSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么您应该使用burp来测试路径遍历漏洞并获得RXSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/why-u-should-use-burp-to-test-path-traversal-vulnerability-and-also-get-rxss-2743cbb16a3c?source=collection_archive---------0-----------------------#2021-08-16">https://infosecwriteups.com/why-u-should-use-burp-to-test-path-traversal-vulnerability-and-also-get-rxss-2743cbb16a3c?source=collection_archive---------0-----------------------#2021-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ddd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我又是亚瑟(又名尼禄里)<br/>我告诉过你们我和我的兄弟(他16岁)正在做一些bugbounty，我们发现了那些很酷的bug。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><h1 id="d522" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">接近目标</h1><p id="8761" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">一如既往，我选择了一个有趣的目标，因为它有很多功能，而且很容易使用，我没有做很多侦察，所以我们只是开始瞄准主域，</p><p id="8ad8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的兄弟开始做随机动作来了解一切是如何工作的，<br/>经过一些点击现在是时候做一些疯狂的事情了XD，</p><p id="50a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始做一些目录蛮力，以获得一些端点，<br/>在这样做的同时，我的兄弟开始发送随机有效载荷的路径遍历，我也写了小脚本，采取屏幕拍摄每个网址，<br/>，但我们没有得到任何东西</p><p id="f0e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">直到我哥哥开始检查打嗝反应，</p><p id="4777" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一点上，我的兄弟尝试了这个网址:</p><p id="8a14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lv" href="https://www.mathworks.com/matlabcentral/profile/authors/23398683?s_tid=gn_comm/../../../" rel="noopener ugc nofollow" target="_blank">https://Target/material/profile/endpoint/</a>{ numeric _ id }</p><p id="f64b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以他开始将路径遍历有效负载附加到id:</p><p id="5998" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道，我们需要后退4次才能进入主目录，所以他尝试这样做:</p><p id="6e88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lv" href="https://www.mathworks.com/matlabcentral/profile/authors/23398683?s_tid=gn_comm/../../../" rel="noopener ugc nofollow" target="_blank">https://Target/material/profile/endpoint/</a>{ numeric _ id }/../../../../</p><p id="4fde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常这个请求会把我们带到主域:<a class="ae lv" href="https://target" rel="noopener ugc nofollow" target="_blank"> https://target </a> <br/>当我们在brower中加载这个url时会发生这种情况，但是在burp中我们得到了另一个响应！</p><p id="b458" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击<code class="fe lw lx ly lz b">show response in browser</code>我们得到了这个</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/5336ce00709640dd5515b040492b5f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Xy3IJdWhLOXUw3a5ltcZQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">目录列表</figcaption></figure><p id="fb09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的假设是，网站正在处理易受目录列表攻击的内部api，当浏览器发送请求时，流程如下</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ml"><img src="../Images/629e651b5c83c18c1fa910468e4dd8ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RzUdduFDvQ61NGr5BZr2Mw.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">打嗝vs浏览器</figcaption></figure><p id="9bcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是为什么我们使用打嗝时会得到不同的结果。</p><h1 id="88b7" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">查找RXSS</h1><p id="0252" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">从这里，我开始深入研究这个问题，浏览每个发现的端点，我发现了一个负责正式电子邮件模板的内部端点</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mm"><img src="../Images/2d60d901319815863272225f210759ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ZZws56OMH3NrqYcsXL4kQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">电子邮件模板预览界面</figcaption></figure><p id="d035" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择模板</p><p id="ce0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">插入一个简单的xss有效负载，并按下预览我得到和警报:)</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mn"><img src="../Images/08121a4abc97f21c4028adc530c24ba1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI7KG3vH4HRAxnuuX3KcJQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">XSS</figcaption></figure><p id="3774" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，但是你可以看到这是一个自我xss，所以我们不能做太多。</p><h1 id="cceb" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">经由CSRF的RXSS</h1><p id="d5d7" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">我截取了负责xss的请求，并创建了一个简单的csrf poc来模拟请求，只要我们打开页面，xss就被执行</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mo"><img src="../Images/94769c1937f3bdf0550964f85e24476c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WwaFvIrbW_Lre1nI4yJH0g.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">RXSS</figcaption></figure><h1 id="5286" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">接管管理员帐户</h1><p id="683a" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">如您所见，有一个<code class="fe lw lx ly lz b">Send a test Email</code>似乎从公司电子邮件向公司电子邮件发送了一封测试电子邮件，因此员工很有可能将其作为普通电子邮件打开:<br/>我发现我没有模板，我可以插入一个url，因此我插入了RXSS url，这样一旦管理员打开电子邮件并单击按钮，他将被重定向到RXSS链接，我们就可以获得他的cookies:)</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mp"><img src="../Images/be43a5b5637c5fca06a065118bdd4736.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8BtaUGtbKQajVbEBr8nqxQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">重置密码测试电子邮件</figcaption></figure><p id="f604" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，有许多模板，所以它不仅是重置密码电子邮件，我们可以发送。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/1a4ccf811d3397b136d8f2e155a188ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*gdVDjf4T9Fr3vl_BfKMvuQ.png"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">发送测试电子邮件后</figcaption></figure><p id="c4a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些bug首先像往常一样不适用XD，<br/>然后在小争论之后我展示了影响并进行分类，我们得到了<strong class="jp ir">$ 700:】</strong></p><p id="0744" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我要感谢我的朋友<a class="mr ms ep" href="https://medium.com/u/fb76f1a8b652?source=post_page-----2743cbb16a3c--------------------------------" rel="noopener" target="_blank"> Abdulrhman Adel </a>在我向他询问路径遍历问题时提供的帮助，遗憾的是我们无法提出影响，但他向我解释了路径遍历发生的原因。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mt"><img src="../Images/cc613f44a28ef5eacd234e31d7e4f1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVMbtPLzxBvMEFbiT-hJEA.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">莫尼</figcaption></figure><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mu kr l"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">我和我哥哥告诉对方我们将在fb XD工作</figcaption></figure><p id="3b7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你喜欢这篇文章，并等待我的关于新bug赏金猎人的<strong class="jp ir">提示</strong>帖子。</p></div></div>    
</body>
</html>