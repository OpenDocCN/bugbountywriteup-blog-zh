<html>
<head>
<title>Persistent Windows 10 and 11 keylogger (keylogiq)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">持久的Windows 10和11键盘记录器(keylogiq)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/persistent-windows-10-and-11-keylogger-keylogiq-eada8f2dbf9c?source=collection_archive---------0-----------------------#2022-05-08">https://infosecwriteups.com/persistent-windows-10-and-11-keylogger-keylogiq-eada8f2dbf9c?source=collection_archive---------0-----------------------#2022-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/eb47019bc3d976fae4810d397b767bed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*PQyz6Bkl0RhiBuULmXewnQ.png"/></div></figure><p id="5f42" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我将向你描述我是如何为Windows 10和11创建不可检测的键盘记录器的。首先，如果键盘记录器已经存在，为什么我决定创建我自己的工具。嗯，我找不到任何，其中包括一些额外的功能，如每隔X分钟通过电子邮件发送结果，我想。此外，最重要的是，我找不到一个有持久选择权的人。因此，只要计算机重新启动或打开，键盘记录器将再次开始记录。对我来说，创建一个工具也很重要，这个工具可以选择升级攻击，比如添加键盘抓取器、后门等。</p><p id="1790" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而，由于这个工具主要是为了教育和娱乐而设计的，所以我并不关心它在记录特殊字符方面有多准确。我找到了用C++写的源代码，并进行了测试。它工作得很好，所以我决定进一步实现其他东西。也许你会问为什么我决定使用用C++编写的键盘记录程序，而不是用python。嗯，当我们谈论文件扩展名时，我认为C++是最合适的。用C++编译的代码。exe扩展，默认在windows下可执行，而python给你扩展。py，需要在windows机器上预装python来执行。当然，也有将python代码转换成exe文件的方法，但是很多时候，效果并不好，至少对我来说是这样。</p><p id="b997" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下是键盘记录器的源代码:</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="8563" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">目前，我已经介绍了键盘记录器。下一步是实现通过电子邮件发送结果。我试图用C++在键盘记录器中实现这个功能，但不幸的是我失败了。用C++已经够令人沮丧了，所以我决定在powershell脚本上实现这个函数，无论如何我需要用它来设置persistent。下面是用powershell编写的部分代码，它每600秒发送一封带有附件(Records.txt)的电子邮件，其中键盘记录器记录击键的结果。这是重复的，直到键盘记录器的过程是积极的。</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="64da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此外，我创建了<strong class="jw ir">主批处理文件</strong>，其中包含了后续函数。它在后台powershell脚本中启动，将【keylogger.exe】、<strong class="jw ir"> Records.txt </strong>、<strong class="jw ir"> ps_mail.ps1 </strong>和<strong class="jw ir"> persistent.bat </strong>文件下载到特定的文件夹中并执行流程。所有文件都存放在<strong class="jw ir"> Users\(用户名)\AppData\Local\Temp </strong>中，只有persistent.bat文件存放在引导时自动启动的文件所在的位置<strong class="jw ir"> (Users\(用户名)\ AppData \ Roaming \ Microsoft \ Windows \ Start Menu \ Programs \ Startup)</strong>。</p><p id="dc16" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是main.bat的代码:</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="faf7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">和persistant.bat看起来是这样的:</p><figure class="ks kt ku kv gt jr"><div class="bz fp l di"><div class="kw kx l"/></div></figure><p id="d2f9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">原来如此。我做了一个不可检测的持久键盘记录器，可以在Windows 10和Windows 11中工作。有时你需要在发送邮件前重启你的Windows系统，但是不要担心，它会从头开始记录所有的按键，这样你在重启后就能收到邮件。</p><p id="6fc1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以在<a class="ae ky" href="https://github.com/pr0xy-8L4d3/keylogiq" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">我的Github库</strong> </a>中找到这个现成的键盘记录器。</p></div></div>    
</body>
</html>