<html>
<head>
<title>UUTCTF 2019 WriteUps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">UUTCTF 2019年综述</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/uutcf-2019-writeups-6c11ea3f9d22?source=collection_archive---------0-----------------------#2019-05-02">https://infosecwriteups.com/uutcf-2019-writeups-6c11ea3f9d22?source=collection_archive---------0-----------------------#2019-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1539" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将带你了解UUTCTF 2019的3个CTF挑战，2个辩论和1个杂项。我很高兴几乎完全靠自己解决这些问题。感谢安德烈亚斯·波伊亚茨！</p><h1 id="03ef" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">辩论术</h1><h2 id="878b" class="ll ko iq bd kp lm ln dn kt lo lp dp kx jy lq lr lb kc ls lt lf kg lu lv lj lw bi translated">层</h2><blockquote class="lx ly lz"><p id="339e" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">层次在这里。</p></blockquote><p id="56f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个挑战中，我们看到了下面的图像。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/b2903faf5639603ba1a473ac285c51fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfKltvq7HxHWb7i8ouA_pw.jpeg"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">Layers.jpg</figcaption></figure><p id="cfc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载图片时，我用<em class="ma"> exiftool </em>查看了图片:</p><pre class="mf mg mh mi gt mu mv mw mx aw my bi"><span id="1fe6" class="ll ko iq mv b gy mz na l nb nc">&gt;<em class="ma">exiftool</em> Layers.jpg</span></pre><p id="70d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到了图像文件的信息。稍微搜索一下，我们就可以在<em class="ma"> exiftool返回的结果中找到这个标志。</em></p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nd"><img src="../Images/3ea13ea68d57a75212c6b4c1a9efadf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KSIfkMFQluYnswWnQIm4xg.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">Exiftool结果。</figcaption></figure><blockquote class="ne"><p id="0277" class="nf ng iq bd nh ni nj nk nl nm nn kk dk translated">Flag: uutctf{can_you_see_me}</p></blockquote><h2 id="646e" class="ll ko iq bd kp lm no dn kt lo np dp kx jy nq lr lb kc nr lt lf kg ns lv lj lw bi translated">找到单词flag</h2><blockquote class="lx ly lz"><p id="f5e5" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">在空的DOCX文件中，标志可以隐藏在哪里？查找并提交！</p></blockquote><p id="17a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个挑战中，我们得到了一个Word.docx文件。打开它读下面的文字:</p><p id="606c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma">注意文档内部的空隙</em></p><p id="af83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">起初我以为它指的是文本中的空格，但显然事实并非如此。我在网上搜索了一下类似的问题，发现你可以把docx当成一个压缩文件。使用命令:</p><pre class="mf mg mh mi gt mu mv mw mx aw my bi"><span id="2f2e" class="ll ko iq mv b gy mz na l nb nc">&gt;<em class="ma">unzip Word.docx</em></span></pre><p id="cf57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以获得表示word文档的xml文件。在创建的word目录中检查生成的文件document.xml，我们可以看到几个长条的空格，因此有间隙。我的队友很快注意到这些是十六进制数字，其中每两个数字对应于ASCII表中的值。前两个数字是5，指向字母u。这是这种情况下，显然是指国旗。</p><p id="84c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在要做的就是注意文档中的空白，即删除xml文件中出现在。docx文件。这样做之后，剩下的挑战就变成了实现下面的脚本来计算空间和索引一个查找表。</p><figure class="mf mg mh mi gt mj"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="d459" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将返回以下十六进制数字字符串:</p><p id="3e05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">555544354467 b4d 65616 e 696 e 6766756 c 476158737d 11111111</p><p id="4a4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">忽略最后一串1，我们可以很容易地将它转换成文本，从而得到标志。</p><blockquote class="ne"><p id="0ad6" class="nf ng iq bd nh ni nv nw nx ny nz kk dk translated">UUTCTF{MeaningfulGaXs}</p></blockquote><h1 id="747d" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky oa la lb lc ob le lf lg oc li lj lk bi translated">混杂的</h1><h2 id="2796" class="ll ko iq bd kp lm ln dn kt lo lp dp kx jy lq lr lb kc ls lt lf kg lu lv lj lw bi translated">麻烦制造者</h2><blockquote class="lx ly lz"><p id="abfb" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">莱纳斯·托沃兹是个麻烦制造者！他做了一个隐藏旗子的网页。找到并抓住它！</p><p id="cd84" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">网页位于:<a class="ae od" href="http://188.40.189.2:8001" rel="noopener ugc nofollow" target="_blank">http://188.40.189.2:8001</a></p></blockquote><p id="0834" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将我们的浏览器指向该IP地址，我们会看到以下网站。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oe"><img src="../Images/4a7157c323240582289b67e5ac8647c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUVZk4RitVgBfkmqy7ESkQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">http://188.40.189.2:8001<a class="ae od" href="http://188.40.189.2:8001" rel="noopener ugc nofollow" target="_blank">网站</a></figcaption></figure><p id="0a08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立刻用谷歌搜索了李纳斯·托沃兹这个名字，看看他创造了什么工具。我发现他也创造了git。这让我想起了你可以访问。git目录，但是这导致了一个禁止的错误。</p><p id="9241" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该网站不提供任何功能，所以我使用git-dumper工具下载该网站的所有文件。</p><pre class="mf mg mh mi gt mu mv mw mx aw my bi"><span id="3bc5" class="ll ko iq mv b gy mz na l nb nc">&gt;<em class="ma">git-dumper.py</em> <a class="ae od" href="http://188.40.189.2:8001/" rel="noopener ugc nofollow" target="_blank">http://188.40.189.2:8001/</a> out</span></pre><p id="6399" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑到他是git的创建者，我继续检查。git目录，更具体地说是日志目录，以检查提交消息。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi oe"><img src="../Images/56d6517a5fdc087470b61829ece0b4cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JvTeCqvSkbwWypiFTaCbzQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">在主机上提交消息。</figcaption></figure><p id="a019" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们看到的，有一条提交消息说:<em class="ma">这可能有帮助。</em>我以为这应该是个线索。所以我使用下面的命令来检查提交中所做的更改。</p><pre class="mf mg mh mi gt mu mv mw mx aw my bi"><span id="b640" class="ll ko iq mv b gy mz na l nb nc">&gt;<em class="ma">git</em> show 24ad3f97738d5669e171ea4c3f280c62797dd21d</span></pre><p id="76a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这返回了以下结果:</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi of"><img src="../Images/1129fd9ddc81140add0a251f0976b026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2_5XwD4ysbVlE_wAlNjuw.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk translated">git显示结果</figcaption></figure><p id="97cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查字符串变量，我们可以推断这是base64编码，使它非常有可能成为标志的候选。</p><p id="8029" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解码字符串将返回标志。</p><blockquote class="ne"><p id="75a3" class="nf ng iq bd nh ni nv nw nx ny nz kk dk translated">标志为:UUTCTF{VVe_ |_0Ve_L！n(_)$}</p></blockquote><h1 id="ee69" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky oa la lb lc ob le lf lg oc li lj lk bi translated">结论</h1><p id="2c25" class="pw-post-body-paragraph jn jo iq jp b jq og js jt ju oh jw jx jy oi ka kb kc oj ke kf kg ok ki kj kk ij bi translated">所以你有它的人！这些都是令人兴奋的挑战，这是我第一次独自解决几个CTF挑战(几乎没有帮助)。所以一致性和坚持是持之以恒的关键技能。</p></div></div>    
</body>
</html>