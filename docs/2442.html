<html>
<head>
<title>Critical IDOR Vulnerability on Medium?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">介质上严重的IDOR漏洞？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/critical-idor-vulnerability-on-medium-f78346edbcb1?source=collection_archive---------1-----------------------#2022-10-12">https://infosecwriteups.com/critical-idor-vulnerability-on-medium-f78346edbcb1?source=collection_archive---------1-----------------------#2022-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="86c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，</p><p id="4f21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你很好。我将告诉你一个我的午餐冒险小故事，希望它能启发你。当我在查看赏金服务时，我在medium上看到了下面的列表。</p><p id="a9e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://medium.com/humans.txt" rel="noopener">-黑媒体的黑客</a> -</p><p id="71ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在吃午饭，我说为什么不在这个时候给一个机会。所以，我开始检查介质系统。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/f28f5c46cd51bdfcfb7234245bda3d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/0*jEsBlY8n9Mc0bd3V"/></div></figure><p id="06e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先我了解到几乎所有的东西都有唯一的id和大量使用graphql的请求。</p><p id="af3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我决定创建一个帐户，以检查我是否可以达到其他一些私人部分。</p><blockquote class="ku kv kw"><p id="83f3" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">这是发现不安全的直接对象引用(IDOR)漏洞的最佳方式。</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/6be4e0a8f446c27b70ea6441ee6ba628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hnmPQgf5obMfNljC9htytA.png"/></div></div></figure><p id="18b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现了介质系统的访问控制漏洞。</p><p id="af57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现了访问控制中的一个漏洞，是吗？</p><p id="1b92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我有<strong class="jp ir"> A </strong>账户和<strong class="jp ir"> B </strong>账户。正常情况下，<strong class="jp ir"> A </strong>账户不应该访问<strong class="jp ir"> B </strong>账户的汇票，对吗？因为我的草稿应该是我的。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lg"><img src="../Images/fdd90dfa763c80c227dd3b17c231a9df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HrLOIya33bOvbycM.png"/></div></div></figure><p id="0bb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">草稿故事的id是-&gt; <em class="kx"> ac274abe6d0 </em></p><p id="68a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以如果我们看一下我们的草稿，媒体会把我们重定向到</p><p id="33ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://medium.com/p/<em class="kx">AC 274 abe6d 0</em>/编辑？source=your_stories_page -</p><p id="003f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，可以找到id。假设另一个草稿id是94aa1588d3d9</p><blockquote class="ku kv kw"><p id="9208" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">它仅由12位数字组成。所以可以通过暴力找到它。</p></blockquote><p id="26c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你去-&gt; https://medium.com/p/<em class="kx">94aa 1588 d3d</em>它会自动把你重定向到</p><p id="de62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://medium.com/{{@targetnickname}}/<em class="kx">94aa 1588 d3d</em></p><p id="1c46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，我们可以找到哪个id属于哪个用户。</p><p id="1aa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至少我是这么认为的。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lh"><img src="../Images/a231a557a253cac55424e6edc76995b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MQFIJ9zGSbJv-U6tY-10RQ.png"/></div></div></figure><p id="36c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用截屏作为POC的详细说明:</p><ol class=""><li id="5a72" class="li lj iq jp b jq jr ju jv jy lk kc ll kg lm kk ln lo lp lq bi translated">测试账户B的未结汇票:</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lr"><img src="../Images/b63cc4e5f134342ad6e5d7481d836f02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AAmeNAxk3U6UAnByE_Vq3Q.png"/></div></div></figure><p id="7c71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.从测试帐户A打开汇票:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/20e53315e5385d60eee15a4ac98dec1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fy7QoHg01e1dDNZb8Q1iGQ.png"/></div></div></figure><p id="759c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.拦截来自测试帐户A的请求:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/738c262a3d8a615dbc407606a7aadac5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MzW2mS6I4OXxfUa8wPvTrg.png"/></div></div></figure><p id="8313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.用另一个草稿id更改URL，不进行编辑。我们试着看别人的草稿:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/7752a9d4f62176d3071bbf1e66f615a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fiySPZXxYux9KZ8-bLhxcg.png"/></div></div></figure><p id="8dd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我所说的，它用昵称重定向链接。</p><p id="0a12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.当我们点击链接时，我们可以看到整个草稿。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/d677ea271ac781ad4fa6c35985b5ecd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FdFM_R7xXuT4kzc2HG8iWg.png"/></div></div></figure><p id="7abe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.有了浏览器，它显示所有的草稿。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lt"><img src="../Images/9615ae7547abb7906f0a7f5d5336941b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e7RXN_fJedrJCK167Bxodg.png"/></div></div></figure><p id="c8a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在想用一个小的python脚本，我将能够下载许多人的草稿和他们的昵称，而无需他们的允许，如果有人将他的草稿用作信用卡的笔记本，黑客可以窃取它们，而且，黑客可以为自己窃取起草的博客。但我没有检查它，因为中型bug bounty有以下规则:</p><p id="e103" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">给你的规则</strong></p><ul class=""><li id="0b56" class="li lj iq jp b jq jr ju jv jy lk kc ll kg lm kk lu lo lp lq bi translated">不要试图访问其他用户的账户或数据。使用您自己的测试帐户进行跨帐户测试。</li></ul><p id="73c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一个有道德的人和有道德的黑客，我总是在攻击前检查规则。所以，我用完全属于我的交叉用户测试了它。</p><p id="60e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我跑去把它寄给了中型昆虫赏金队。我已经开始等待他们的答复。但不幸的是，结果令我失望。:(因为我漏了一点。没有速率限制，因为上面的规则，我不能测试它。即使它是经典的，这是一个功能，而不是一个错误:D</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lv"><img src="../Images/79a827cd97b674d4d413fe48cc8956fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nnc8tI6gmJ72E3Ty2CXGKA.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/59bf2f5b45596b295f93f6f2b3291c33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/0*f4l7cumXzbmoRfe8"/></div></figure><blockquote class="lx"><p id="bd01" class="ly lz iq bd ma mb mc md me mf mg kk dk translated">我决定告诉你这个故事，昆虫赏金并不总是带你到好东西，有时你可能会错过一些点，你可以认为你发现了真正的大东西。然而，你知道他们说什么。让国王称王的不是他们如何跌倒，而是他们如何爬起来。第二天你应该继续努力。</p></blockquote><figure class="mi mj mk ml mm kr gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mh"><img src="../Images/e6c44d1050158011c7a79d8d88f957d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*LjOPzImhsQm0nqMa.jpg"/></div></div></figure><p id="32b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读。希望你喜欢它，也希望它能激励你..特别感谢medium Bug bounty和支持团队的友好和快速响应。💮</p><p id="e2e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自zer0d的和平。</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h2 id="52c9" class="mu mv iq bd mw mx my dn mz na nb dp nc jy nd ne nf kc ng nh ni kg nj nk nl nm bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>