<html>
<head>
<title>Authentication bypass using root object or Empty array.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用根对象或空数组绕过身份验证。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/authentication-bypass-using-root-array-4a179242b9f7?source=collection_archive---------0-----------------------#2022-03-22">https://infosecwriteups.com/authentication-bypass-using-root-array-4a179242b9f7?source=collection_archive---------0-----------------------#2022-03-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="7974" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">最后更新:2022年5月23日</p><p id="0035" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">添加了包含更多详细信息的分析部分</p></blockquote><p id="f661" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">嘿猎人们！今天我们有一篇关于我在一个pentesting客户那里的一个发现的新报道。我们以前绕过的方法比较棘手，想分享给社区，那就开始吧。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/53cdd73a194f8877bf4db6ee4cae19d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*q-hYfrbvZ1_x1mRIR7FUiw.jpeg"/></div></figure></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="2cf6" class="lh li iq bd lj lk ll dn lm ln lo dp lp kp lq lr ls kq lt lu lv kr lw lx ly lz bi translated">概观</h2><p id="ea92" class="pw-post-body-paragraph jq jr iq jt b ju ma jw jx jy mb ka kb kp mc ke kf kq md ki kj kr me km kn ko ij bi translated">客户端通过发送您的凭证来执行他的登录过程，并接收JSON数据中的响应。诀窍是把你的凭证放在<code class="fe mf mg mh mi b">root</code>对象中，如果后端有一个同名的对象，它就能工作。</p><p id="bb27" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">请注意，目标使用Cloudflare作为服务器，因此很难专注于注入。</p></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="ef35" class="lh li iq bd lj lk ll dn lm ln lo dp lp kp lq lr ls kq lt lu lv kr lw lx ly lz bi translated">复制的步骤</h2><p id="ff63" class="pw-post-body-paragraph jq jr iq jt b ju ma jw jx jy mb ka kb kp mc ke kf kq md ki kj kr me km kn ko ij bi translated">1.尝试使用假凭证登录，以检查请求和响应。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mj"><img src="../Images/76db564e350fadbfc7899929c452afcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ALPusydVfPha0-vmTNgpcQ.png"/></div></div></figure><p id="45ba" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">您会注意到凭证是以JSON数据的形式发送的，响应也是以JSON的形式。至此，我已经尝试了多种技巧，比如:</p><pre class="kt ku kv kw gt mo mi mp mq aw mr bi"><span id="e387" class="lh li iq mi b gy ms mt l mu mv"><strong class="mi ir">Change false to true</strong> → Failed<br/><strong class="mi ir">Change the message to</strong> “Success” → Failed<br/><strong class="mi ir">Delete the whole msg </strong>→ Failed<br/><strong class="mi ir">Delete the status</strong> → Failed</span></pre><p id="1c72" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2.该是处理请求JSON数据的时候了，让我们试着把它转换成XML来测试XXE，但是运气不好，没有返回响应。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mw"><img src="../Images/f182351bdfc45880e8f085ec11853a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s80FUDR2dnirB7sehpcOaA.png"/></div></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mw"><img src="../Images/95099e72a2f9d46edbd478db64a67916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lIi3LcPoQi4TGv4aERa11Q.png"/></div></div></figure><p id="609b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.好了，让我们使用相同的扩展将它返回给JSON，并再次发送请求。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mw"><img src="../Images/812bbb5ed9133bc40013bed810974c77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpm6rCedvlUzyHiKkehHQg.png"/></div></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mx"><img src="../Images/64f8e086fb71fefbead8ac73e7a01f07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJAJiwg6UlZQRCezQ5GVfA.png"/></div></div></figure><p id="815f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在使用扩展转换之后，找出发生的变化，这就是为什么响应返回与默认用户相关的数据。</p><p id="71d1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.尝试拦截登录请求，并像我们之前尝试的那样更改JSON数据，然后转发请求。</p><pre class="kt ku kv kw gt mo mi mp mq aw mr bi"><span id="6b27" class="lh li iq mi b gy ms mt l mu mv">Change the data from <br/><strong class="mi ir">{"email":"test@aykalam.com","password":"test"}</strong></span><span id="30cc" class="lh li iq mi b gy my mt l mu mv">to be like that<br/><strong class="mi ir">{"root": {<br/>  "password": "test",<br/>  "email": "test@aykalam.com"<br/>}}</strong></span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi mz"><img src="../Images/31613a82ccb5e4e027d8f823fc396f36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CUmXL28SlUxVIsVHPwHZIQ.png"/></div></div></figure><p id="9109" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.您会发现自己以管理员身份登录。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi na"><img src="../Images/9020fd8757a7c3dec40c1eee4809ccfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QKGxuaFswtZGTpvuu85RYw.png"/></div></div></figure></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h2 id="2f18" class="lh li iq bd lj lk ll dn lm ln lo dp lp kp lq lr ls kq lt lu lv kr lw lx ly lz bi translated">分析</h2><p id="a277" class="pw-post-body-paragraph jq jr iq jt b ju ma jw jx jy mb ka kb kp mc ke kf kq md ki kj kr me km kn ko ij bi translated">经过多方尝试和深挖，随着<a class="ae nb" href="https://twitter.com/LiveOverflow" rel="noopener ugc nofollow" target="_blank"><strong class="jt ir"/></a>和我的队友<a class="ae nb" href="https://twitter.com/justAhmed96" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">艾哈迈德</strong></a><strong class="jt ir"/><a class="ae nb" href="https://twitter.com/akenofu" rel="noopener ugc nofollow" target="_blank"><strong class="jt ir">【卡里姆·阿尼】</strong> </a> <strong class="jt ir">和</strong> <a class="ae nb" href="https://twitter.com/MohamedSaleh428" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">穆罕默德</strong> </a>我们发现了这个问题。</p><p id="85ab" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">目标使用自定义框架和处理登录过程的自定义函数的默认情况。我会给你一个简单的例子来清除弱点，这只是JS代码，而不是确切使用的。</p><p id="80a3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果你检查下面的代码。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nc"><img src="../Images/947cbe3236a35bf95023c6be6466fdcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jl0h_02yEtX5jtmF-spZCA.jpeg"/></div></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk translated">由卡里姆·阿尼编码</figcaption></figure><p id="03dc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">您会注意到，所使用的if语句没有配置好，如果IF语句的条件为false，则流程不会终止，而是会继续。这个问题可以让您绕过身份验证。</p><p id="3495" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">所以，如果你试图把登录帖子的数据替换为空，它会得到同样的结果</p><pre class="kt ku kv kw gt mo mi mp mq aw mr bi"><span id="5d62" class="lh li iq mi b gy ms mt l mu mv">Replace the following <br/><strong class="mi ir">{"email":"test@aykalam.com","password":"test"}</strong></span><span id="7403" class="lh li iq mi b gy my mt l mu mv">With <br/><strong class="mi ir">{"":""}</strong></span></pre><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nh"><img src="../Images/a39cbc38e7abf96e3809d0396886473d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uKfo-aLnOiuP7nxIDIKYog.png"/></div></div></figure></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><p id="754a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">感谢阅读，并希望你得到它好❤</p><h2 id="f44c" class="lh li iq bd lj lk ll dn lm ln lo dp lp kp lq lr ls kq lt lu lv kr lw lx ly lz bi translated">由于</h2><p id="e7b1" class="pw-post-body-paragraph jq jr iq jt b ju ma jw jx jy mb ka kb kp mc ke kf kq md ki kj kr me km kn ko ij bi translated"><strong class="jt ir">现场溢出，艾哈迈德·希沙姆，卡里姆·阿尼</strong>和<strong class="jt ir">穆罕默德·萨利赫</strong></p><h2 id="822f" class="lh li iq bd lj lk ll dn lm ln lo dp lp kp lq lr ls kq lt lu lv kr lw lx ly lz bi translated">保持联系</h2><p id="c60d" class="pw-post-body-paragraph jq jr iq jt b ju ma jw jx jy mb ka kb kp mc ke kf kq md ki kj kr me km kn ko ij bi translated"><a class="ae nb" href="https://www.linkedin.com/in/eslam3kl/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae nb" href="https://github.com/eslam3kl" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae nb" href="https://twitter.com/eslam3kll" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>