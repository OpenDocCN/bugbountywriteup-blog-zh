<html>
<head>
<title>Exposing millions of critical data on Kerala Civil Supplies Website!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在喀拉拉邦民用物资网站上曝光数百万关键数据！</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/exposing-millions-of-critical-data-on-kerala-civil-supplies-website-cc3a4bed5d07?source=collection_archive---------1-----------------------#2021-10-12">https://infosecwriteups.com/exposing-millions-of-critical-data-on-kerala-civil-supplies-website-cc3a4bed5d07?source=collection_archive---------1-----------------------#2021-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="51df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我叫Krishnadev P Melevila，我是一名自学成才的网络安全研究员和web应用程序渗透测试员。</p><p id="6a76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我开始测试一些随机的网站，然后我的想法是这样的</p><p id="10d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">“为什么只有私企？拥有数百万敏感数据的政府网站安全吗？”</em>T3】</strong></p><p id="72df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我想到的第一个网站是http://ecitizen.civilsupplieskerala.gov.in/的<a class="ae km" href="http://ecitizen.civilsupplieskerala.gov.in/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a>，我也不知道为什么会想到这个网站。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/7f41761bb6859fdf29f89a2f8c2f1191.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*1s6YlMjJy7FMh7aK-dAyaQ.png"/></div></div></figure><blockquote class="kz la lb"><p id="4534" class="jn jo kl jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">什么是喀拉拉邦民用物资？</p><p id="fc09" class="jn jo kl jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">这是一个处理国家配额的政府部门。每个家庭都有一张卡，叫做配给卡，所有家庭的配给都登记在这张卡上。有一项补贴计划，根据这项计划，政府按个人购买口粮时所付金额的一定百分比返还。</p><p id="5907" class="jn jo kl jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">此外，民用物资部门有一个由印度国家信息中心开发和维护的网站(我在上面提到过),该网站处理非常敏感的数据，如个人的个人详细信息、家庭详细信息、收入详细信息、银行详细信息(所有补贴金额都在银行转账)、配额卡所有权的变更、电话号码电子邮件的变更等</p></blockquote><p id="95ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们开始吧，</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="8276" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在攻击者视点中重现的步骤:</p><p id="1cd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.只需使用攻击者的aadhar(印度唯一的身份证)和配给卡详细信息在<a class="ae km" href="https://ecitizen.civilsupplieskerala.gov.in/" rel="noopener ugc nofollow" target="_blank">https://ecitizen.civilsupplieskerala.gov.in/</a>注册为公民，然后点击电子服务，我们就会看到这样的窗口。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/14804877029dded0edcd9eeb20c5d6d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/0*S1lprlR2QK6kmmrH"/></div></figure><p id="f5c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.打开一个类似burpsuite的网页拦截工具。</p><p id="583b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.单击服务部分的任何选项(比如一般详细信息)并拦截其请求。然后你会得到一个如下的请求。</p><pre class="ko kp kq kr gt li lj lk ll aw lm bi"><span id="01cd" class="ln lo iq lj b gy lp lq l lr ls">POST /index.php/c_card_family_details/view_card_details HTTP/1.1 Host: ecitizen.civilsupplieskerala.gov.in</span><span id="c82e" class="ln lo iq lj b gy lt lq l lr ls">Cookie: csrf_cookie_name=d69c461e86fdd31525ff79598906748a; marakkaruth=jvqvladjefe1i08552cq8emt6m0v8bs4</span><span id="e1d4" class="ln lo iq lj b gy lt lq l lr ls">Content-Length: 94</span><span id="fa32" class="ln lo iq lj b gy lt lq l lr ls">Sec-Ch-Ua: “Chromium”;v=”94", “Google Chrome”;v=”94", “;Not A Brand”;v=”99" Accept: application/json, text/javascript, */*; q=0.01</span><span id="1d02" class="ln lo iq lj b gy lt lq l lr ls">Content-Type: application/x-www-form-urlencoded; charset=UTF-8 X-Requested-With: XMLHttpRequest</span><span id="02ed" class="ln lo iq lj b gy lt lq l lr ls">Sec-Ch-Ua-Mobile: ?0</span><span id="9303" class="ln lo iq lj b gy lt lq l lr ls">User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36</span><span id="1196" class="ln lo iq lj b gy lt lq l lr ls">Sec-Ch-Ua-Platform: “Linux”</span><span id="6376" class="ln lo iq lj b gy lt lq l lr ls">Origin: <a class="ae km" href="https://ecitizen.civilsupplieskerala.gov.in" rel="noopener ugc nofollow" target="_blank">https://ecitizen.civilsupplieskerala.gov.in</a></span><span id="1cc4" class="ln lo iq lj b gy lt lq l lr ls">Sec-Fetch-Site: same-origin</span><span id="981f" class="ln lo iq lj b gy lt lq l lr ls">Sec-Fetch-Mode: cors</span><span id="303f" class="ln lo iq lj b gy lt lq l lr ls">Sec-Fetch-Dest: empty</span><span id="a36a" class="ln lo iq lj b gy lt lq l lr ls">Referer:</span><span id="2ffe" class="ln lo iq lj b gy lt lq l lr ls"><a class="ae km" href="https://ecitizen.civilsupplieskerala.gov.in/index.php/c_generaldetails_chan" rel="noopener ugc nofollow" target="_blank">https://ecitizen.civilsupplieskerala.gov.in/index.php/c_generaldetails_chan</a> ge</span><span id="f060" class="ln lo iq lj b gy lt lq l lr ls">Accept-Encoding: gzip, deflate</span><span id="bf8b" class="ln lo iq lj b gy lt lq l lr ls">Accept-Language: en-US,en;q=0.9,ml;q=0.8,hi;q=0.7</span><span id="333f" class="ln lo iq lj b gy lt lq l lr ls">Connection: close</span><span id="de6b" class="ln lo iq lj b gy lt lq l lr ls">fun_type=19&amp;rationcardno=64419&amp;csrf_test_name=d69c461e86fdd31525ff795989067 48a&amp;appl_frontdesk=</span></pre><p id="f58e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.在这里我们可以看到配给卡的号码是64419。那个参数很脆弱。因此，如果我们将rationcardno参数更改为任何其他类似的值(比如64420)，我们将获得配给卡号为64420的其他用户的详细信息，而无需任何身份验证。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/d2bc95db2b2aeef8c224ee50c423f0fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1234/format:webp/1*1qMhHPoWspyWL7t_VX6qVw.png"/></div></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lv"><img src="../Images/dba36185284e3a20df3035848a3db621.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jWvFS57Q-4dMV1ds0M7Q4A.jpeg"/></div></div></figure><p id="f8d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.同样，通过使用服务菜单上的更改银行选项，攻击者可以将补贴成员的所有银行帐户详细信息更改为攻击者的银行详细信息。</p><p id="b198" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.为了使这一过程更容易，攻击者还可以使用自动化工具，如burp intruder，并在几秒钟内获得用户的数十万条数据。</p><p id="ed39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">风险因素:</p><p id="8824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 1。攻击者可以查看/编辑/修改用户详细信息</strong></p><p id="9de7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。攻击者可以改变其他用户的银行账户信息，窃取补贴7。攻击者能够更改地址/配给存储/添加或删除新的家庭成员等… </strong></p><p id="1876" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。攻击者可以改变牌的所有权。</strong></p><p id="bda9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样结束了。于是我向Cert-In、NCIIPC、NIC报告，结果现在已经打了补丁！</p><p id="039f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">期待你的掌声，别忘了在媒体和其他社交媒体上关注我。T3】</p><p id="a77b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【我的Instagram手柄:<a class="ae km" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://instagram.com/krishnadev_p_melevila</em></a></p><p id="70c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我的推特句柄:</em><a class="ae km" href="https://twitter.com/Krishnadev_P_M" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://twitter.com/Krishnadev_P_M</em></a></p><p id="a17e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我的LinkedIn句柄:</em><a class="ae km" href="https://www.linkedin.com/in/krishnadevpmelevila/" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://www.linkedin.com/in/krishnadevpmelevila/</em></a></p><p id="eeb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我的网络安全课程售卖网站:</em><a class="ae km" href="https://learn.nodeista.com/" rel="noopener ugc nofollow" target="_blank"><em class="kl">https://learn.nodeista.com/</em></a></p><p id="e8d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我的人事网站:</em><a class="ae km" href="http://krishnadevpmelevila.com/" rel="noopener ugc nofollow" target="_blank"><em class="kl">http://krishnadevpmelevila.com/</em></a></p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="2a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">推特—<a class="ae km" href="https://twitter.com/InfoSecComm" rel="noopener ugc nofollow" target="_blank">https://twitter.com/InfoSecComm</a></p><p id="8e46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">中型-<a class="ae km" href="https://infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">https://infosecwriteups.com/</a></p></div></div>    
</body>
</html>