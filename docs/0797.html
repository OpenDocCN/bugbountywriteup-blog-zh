<html>
<head>
<title>A Short Story of IDOR To Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个关于IDOR To Account Takeover的小故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/a-short-story-of-idor-to-account-takeover-b36f3983ecba?source=collection_archive---------2-----------------------#2020-08-30">https://infosecwriteups.com/a-short-story-of-idor-to-account-takeover-b36f3983ecba?source=collection_archive---------2-----------------------#2020-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/86c177af732b01a0dc1c424d286d61be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtQTM5ecf6Rv4OeKbHpvdw.png"/></div></div></figure><p id="7c35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好。我是Jeya Seelan，一名安全研究员和一名Bug猎人。这是我的第一篇关于昆虫赏金的文章。我们将看到一个关于伊多尔的小故事，以及我是如何通过它接管你的账户的。</p><p id="67af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在进入细节之前，让我们看看什么是IDOR。</p><h2 id="c9e4" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">什么是IDOR？</h2><p id="a19a" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">IDOR代表不安全的直接对象引用，它是一种访问控制漏洞。根据OWASP，IDOR发生..</p><blockquote class="lu lv lw"><p id="350a" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><em class="iq"/>当应用程序基于用户提供的输入提供对对象的直接访问时，就会出现不安全的直接对象引用<em class="iq">。由于此漏洞，攻击者可以绕过授权，直接访问系统中的资源，例如数据库记录或文件。不安全的直接对象引用允许攻击者通过修改用于直接指向对象的参数值来绕过授权并直接访问资源。这样的资源可以是属于其他用户的数据库条目、系统中的文件等等。”</em></p></blockquote></div><div class="ab cl mb mc hu md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="ij ik il im in"><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/4b795e6acce8ab09205c87d64d4af3a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0J07Kg4gzpURlo9HwuNvmw.png"/></div></div></figure><p id="b984" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们看一个例子，考虑两个用户用户A和用户B。用户A有一个ID为1000的文档，用户B有一个ID为1002的文档。</p><p id="64f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在正常情况下，用户A只能访问ID为1000的文档，用户B只能访问ID为1002的文档。但是在这里，如果用户A将文档ID更改为用户B的ID -1002，用户A就能够访问用户B的文档。这是由于破坏了访问控制和不安全的直接对象引用。</p><h2 id="358b" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">我是如何接管受害者账户的</h2><p id="f58a" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">让我们把这个网站想象成REDACTED.COM。我已经开始在网站上搜索，并开始测试诸如XSS和其他错误，但我没有成功，因为输入的内容已经过消毒，处理得当。有时我检查了配置文件更新页面，发现了一个API端点<strong class="ka ir"> POST /updateprofiledata </strong></p><p id="4572" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请求体包含一个JSON请求，其ID参数的值为用户ID号。所以我决定使用Repeater来处理这个请求，我将值改为受害者ID Boom，响应为200 OK，受害者帐户上的详细信息得到了更新。但是仍然没有严重的影响，因为我们只能更改姓名和地址等详细信息。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/3419f41761e01a3f4df215ba605dced9.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*L3rxEsRsGgx1-7kM-Ml4Zw.png"/></div></figure><p id="81c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">过了一段时间，我想增加IDOR的影响力。所以我决定寻找其他的终点，但是我没有运气。所以我使用同一个端点，并在JSON请求Boom中添加了一个包含攻击者电子邮件的电子邮件参数。我的请求成功了，电子邮件被更改为攻击者电子邮件。现在，我转到密码重置页面来重置用户密码。最后，由于IDOR的存在，我已经接管了受害者帐户。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="e33f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢您的阅读。如果你喜欢读我的文章，请鼓掌并关注社交媒体手柄:-)。</p><p id="7f3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">领英:<a class="ae mq" href="https://www.linkedin.com/in/jeyaseelans" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jeyaseelans</a></p><p id="8752" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">推特:<a class="ae mq" href="https://twitter.com/jeyaseelans86" rel="noopener ugc nofollow" target="_blank">T3【https://twitter.com/jeyaseelans86】T5</a></p><p id="2185" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">中:<a class="ae mq" href="https://medium.com/@jeyaseelans" rel="noopener">https://medium.com/@jeyaseelans</a></p></div></div>    
</body>
</html>