<html>
<head>
<title>Disk Imaging and Data Recovery</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">磁盘映像和数据恢复</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/disk-imaging-and-data-recovery-cd68118e64b4?source=collection_archive---------2-----------------------#2020-10-15">https://infosecwriteups.com/disk-imaging-and-data-recovery-cd68118e64b4?source=collection_archive---------2-----------------------#2020-10-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="b64d" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">数字取证调查</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/ab4dec2c7a4fbc7d9a46539b7afcc016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hjgY1Ic3SLNZt9F7"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@glencarrie?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">格伦·凯莉</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><h1 id="4ed7" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">Linux文件系统</h1><p id="5186" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在本文中，我们将特别关注从Linux中的<strong class="lt iu">硬件设备</strong>恢复数据<strong class="lt iu">。</strong></p><p id="9153" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在我们开始之前，我们需要了解一些缩写。</p><p id="ac9d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu">在Linux文件系统中，下面的意思是:</strong></p><p id="a4e4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev</strong></code> - <strong class="lt iu">设备，</strong>代表<strong class="lt iu">硬件设备</strong>。这是所有设备文件所在的位置。</p><p id="cb1d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sda</strong></code> -主硬盘(主)文件系统</p><p id="7eec" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb</strong></code> -辅助硬盘<em class="mw"> </em>文件系统<em class="mw">等等……</em></p><p id="2959" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sda1</strong></code> -代表系统中第一个SCSI磁盘驱动器的第一个分区。</p><p id="3759" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sda2</strong></code> -代表系统中第一个SCSI磁盘驱动器的第二个分区<em class="mw">，依此类推……</em></p><p id="b456" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb1</strong></code> -代表您系统中辅助磁盘驱动器的第一个分区<em class="mw">，依此类推……</em></p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="af67" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><strong class="lt iu"> <em class="mw">注:</em> </strong> <em class="mw">以下示例场景摘自hackthebox“Mirai未来组合”机器。</em></p><h1 id="139f" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">方案</h1><p id="cfe0" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">对于此磁盘映像和数据恢复，u盘中的数据被意外删除，需要重新获取。</p><p id="0b43" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">该设备仍然与其Linux主机相连。如果您看到<strong class="lt iu">文件系统</strong> <code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb</strong></code> <strong class="lt iu"> </strong>的存在，您就会猜到这一点，它表示当前正在使用辅助硬盘。如果u盘被移除，那么<strong class="lt iu"> </strong> <code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb</strong></code>将从主机上消失。</p><blockquote class="ne nf ng"><p id="71c4" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated">当u盘连接到linux主机时，设备的物理目录将是<code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb</strong></code>，因为它是一个辅助硬盘</p><p id="9be9" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated"><strong class="lt iu">或</strong></p><p id="979b" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated">它将创建一个分区磁盘，即<strong class="lt iu"> </strong> /dev/sdb1、/dev/sdb2等，具体取决于连接到该主机的外部设备数量。</p><p id="5107" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated">设备<strong class="lt iu">挂载点</strong> <em class="it">又名</em> <strong class="lt iu">逻辑节点</strong>将位于<code class="fe ms mt mu mv b"><strong class="lt iu">/media/&lt;someUSB&gt; </strong></code>或<code class="fe ms mt mu mv b"><strong class="lt iu">/mnt/</strong></code> <strong class="lt iu">文件夹。</strong></p></blockquote></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="beb6" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated">设备物理和逻辑位置</h2><p id="e5ce" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要检查USB的物理和逻辑位置，只需运行<code class="fe ms mt mu mv b">df -h</code></p><p id="01a4" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">df</code> -列出磁盘/分区使用统计</p><p id="9d99" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">-h</code> -d以人类可读的格式显示文件大小。即字节、MB、GB等。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nw"><img src="../Images/a63e7ae262199113b05515610670fc6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*St7GnakG4fxYczdD9qAjLQ.png"/></div></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="6d3a" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated">装载和卸载</h2><blockquote class="ne nf ng"><p id="127b" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated">假设您想要在其他地方手动创建一个挂载点，您可以通过运行:<code class="fe ms mt mu mv b">sudo mount /dev/sdb /mnt/folderName</code>来实现</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nx"><img src="../Images/55983edc31dd954480a07177853d69a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2G3D9vvDKMYffvzgWdsTPw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ny"><img src="../Images/3b19de6b51680b4b42e6966bc327fcdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVSj1P08XVPwRm52t0SQdA.png"/></div></div></figure><blockquote class="ne nf ng"><p id="355d" class="lr ls mw lt b lu mn ju lw lx mo jx lz nh mp mc md ni mq mg mh nj mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">umount</code>命令可用于<strong class="lt iu">卸载</strong>设备文件。</p></blockquote></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="6efe" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">数据检索方法</h1><p id="4f10" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这个场景中，我们可以看到逻辑路径是在文件夹<strong class="lt iu"> /media/usbstick </strong>中为这个USB自动创建的</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oe"><img src="../Images/38f50164104307902462b455b66f6b0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rpLAtHsiwNrH9QhyM9uXLg.png"/></div></div></figure><p id="7696" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最初，您会希望首先通过基本方法恢复丢失的数据。</p><h2 id="95a0" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated"><strong class="ak">丢失+找到的文件夹</strong></h2><p id="b6c6" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">顾名思义，这个文件夹可能包含损坏文件的恢复位。但是，在这个场景中，这个文件夹是空的。</p><h2 id="339f" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated">字符串搜索</h2><p id="c535" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在linux中运行<code class="fe ms mt mu mv b">strings</code>命令将显示在<code class="fe ms mt mu mv b"><strong class="lt iu">/dev/sdb</strong></code>连接的物理设备中丢失的数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi of"><img src="../Images/f0a05c55ff63fe0bf1243cc43560873c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5njTrR3DwpbjZ7JntWvIg.png"/></div></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="f178" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">**************** * *磁盘映像* * * * * * * * * * * * * * * *</h1><p id="077b" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">要创建丢失内容的精确副本，使用以下命令将创建设备(USBstick)的映像，并将其保存到Pi的主目录。</p><p id="de65" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">sudo dcfldd if=/dev/sdb of=/home/pi/myusb.dd​</code></p><p id="6e90" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mw">以下摘录摘自</em> <code class="fe ms mt mu mv b"><em class="mw">man dcfldd</em></code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/5e5dabecb126d63578cd722f4bf06f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zw1CxI11hC-G_ZlPmmFM3Q.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3a2a38844ffe1de7cad944d82330d378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*RwLkFepFb3jnVkbwT7CYQQ.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/7f0f1d7b45f9d78784f8a963fddfa0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*sA9ehjfBdny98kjNrbbDDA.png"/></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oj"><img src="../Images/66972497c471b82c61ad51446bb095d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alykf1ZFo39mA3rOYjt5KQ.png"/></div></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="da02" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated">文件传输</h2><p id="eae4" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">使用下面的命令，<strong class="lt iu"> usb.dd </strong>文件可以安全地复制到我的本地机器上。</p><p id="00f6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">sudo scp pi@10.10.10.48:/home/pi/usb.dd .</code></p><p id="5877" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><code class="fe ms mt mu mv b">scp</code> - OpenSSH安全文件复制</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="2c12" class="nk la it bd lb nl nm dn lf nn no dp lj ma np nq ll me nr ns ln mi nt nu lp nv bi translated">充当故障检修员</h2><p id="b2bc" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">出于某种原因，我无法将<strong class="lt iu"> usb.dd </strong>文件传输到我的本地机器上。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ok"><img src="../Images/353e45a1d160f481690768b1a5ef56f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NjyQlHlZcL1yov0qRWn2hw.png"/></div></div></figure><p id="be43" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">所以我将<strong class="lt iu"> usb.dd </strong>重命名为<strong class="lt iu"> usb.txt </strong>，然后使用<code class="fe ms mt mu mv b">scp</code>命令将文件安全地复制到我本地机器的工作目录中。</p><p id="94f7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，将文件重新命名为<strong class="lt iu"> usb.dd </strong></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ol"><img src="../Images/5ac1a162266908b597fc38301ca01d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NViAYQNEFiyEyjAGql25Wg.png"/></div></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="75b9" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">****************数据恢复**************</h1><p id="b561" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">命令<code class="fe ms mt mu mv b">testdisk</code>用于扫描和修复磁盘分区。使用此命令，您可以从目录中查看已删除的USB文件。</p><p id="784b" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated"><em class="mw">注意:红色的</em> <strong class="lt iu"> <em class="mw"> root.txt </em> </strong> <em class="mw">是被删除的文件。文件大小为0，但之前对其运行strings命令时，确实显示了此文件内容。</em></p><p id="3c90" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">除了对图像运行<code class="fe ms mt mu mv b">strings</code>之外，您还可以使用像nano、vim这样的文本编辑器来显示数据。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi om"><img src="../Images/5ed3b5487bf2b8914e51bc335472598e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/1*NhUGQ2AiCUhp6nXanWwuLQ.gif"/></div></figure></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h1 id="778c" class="kz la it bd lb lc nz le lf lg oa li lj jz ob ka ll kc oc kd ln kf od kg lp lq bi translated">参考</h1><ul class=""><li id="964e" class="on oo it lt b lu lv lx ly ma op me oq mi or mm os ot ou ov bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Disk_image" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Disk_image</a></li><li id="e1f1" class="on oo it lt b lu ow lx ox ma oy me oz mi pa mm os ot ou ov bi translated"><a class="ae ky" href="https://www.whatisfileextension.com/dd/" rel="noopener ugc nofollow" target="_blank">https://www.whatisfileextension.com/dd/</a></li><li id="a49e" class="on oo it lt b lu ow lx ox ma oy me oz mi pa mm os ot ou ov bi translated"><a class="ae ky" href="https://help.ubuntu.com/lts/installation-guide/armhf/apcs04.html" rel="noopener ugc nofollow" target="_blank">https://help . Ubuntu . com/lts/installation-guide/arm HF/APCs 04 . html</a></li><li id="844f" class="on oo it lt b lu ow lx ox ma oy me oz mi pa mm os ot ou ov bi translated"><a class="ae ky" href="https://www.howtogeek.com/184659/beginner-geek-hard-disk-partitions-explained/" rel="noopener ugc nofollow" target="_blank">https://www . how togeek . com/184659/beginner-geek-hard-disk-partitions-explained/</a></li><li id="cbad" class="on oo it lt b lu ow lx ox ma oy me oz mi pa mm os ot ou ov bi translated"><a class="ae ky" href="https://linux.die.net/man/1/scp" rel="noopener ugc nofollow" target="_blank">https://linux.die.net/man/1/scp</a></li></ul></div></div>    
</body>
</html>