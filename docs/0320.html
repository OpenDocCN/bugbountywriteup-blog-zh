<html>
<head>
<title>Account takeover using IDOR and the misleading case of error 403.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用IDOR的帐户接管和错误403的误导情况。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/account-takeover-using-idor-and-the-misleading-case-of-error-403-cb42c96ea310?source=collection_archive---------1-----------------------#2019-06-11">https://infosecwriteups.com/account-takeover-using-idor-and-the-misleading-case-of-error-403-cb42c96ea310?source=collection_archive---------1-----------------------#2019-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="217e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">再次欢迎大家，今天我想和大家分享一个故事，我是如何在45分钟内发现一个非常简单的bug的。这个bug存在了很长时间，在一个公共项目中被顶级猎人遗漏了，有100多个已解决的报告。这就是为什么你不应该相信状态代码。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi ku"><img src="../Images/34b244e3e62c7f131b23d85dc811163d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bBBNztADSkMQgO9y"/></div></div></figure><p id="9c22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当时已经很晚了，我也没有那么大的动力，所以我去检查新的程序，看到了这个程序，它看起来很快，功能简单，没有什么花哨的东西，非常适合轻松的狩猎活动。该应用程序看起来非常简单，用户可以与其他账户互动，发表评论和评级的东西。</p><p id="a886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不管怎样，一旦我创建了一个帐户，我立即去检查我的个人资料，以了解该应用程序是如何工作的，并回答一些非常基本的问题，如:</p><ul class=""><li id="1115" class="lg lh iq jp b jq jr ju jv jy li kc lj kg lk kk ll lm ln lo bi translated">应用程序是否从api获取信息，它位于哪里(子域，根域上的路径)？</li><li id="98d7" class="lg lh iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">有哪种身份认证，它是如何工作的？</li><li id="3db4" class="lg lh iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">是否有任何id来识别当前用户？</li><li id="fcc8" class="lg lh iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">这个id是否会在任何地方公开披露？</li></ul><p id="6279" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开始了解应用程序，然后刷新页面，但这一次我保持代理打开并手动转发所有请求，这是我注意到一些有趣的事情的地方，在应用程序中，你可以链接你的facebook帐户，连接按钮单独加载在iframe中。然而，引起我注意的是它是一个get请求，看起来像这样</p><p id="ab68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://www.redacted.com/connect/facebook_login? T2】id=[ID] &amp;令牌=[令牌] </p><p id="e710" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有签名没有哈希:D</p><p id="55dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该响应包含facebook重定向链接，其中包含启动oauth流的必要信息，包括帐户id，因此我立即创建了一个新帐户，并开始使用这两个帐户。想法是，如果我可以控制iframe响应，就有可能接管该帐户。</p><p id="6412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从帐户A获取id，然后转到帐户B，修改iframe请求并转发请求，然后点击帐户B上的连接facebook按钮，一切都按计划进行，但在从facebook重定向后，我得到错误403，刷新了两个帐户的页面，按钮仍然显示，但后来我有了一个想法，让我们从帐户A注销，然后单击连接facebook，果然我在帐户A内使用facebook 所以我在没有通知用户的情况下接管了帐户，用户甚至不知道他已经连接了facebook，因为按钮一直在显示。</p><p id="c671" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">id不是一个秘密，我可以通过访问受害者的个人资料得到它，更糟糕的是，即使受害者连接了他们的facebook，你也可以用这种方法覆盖它。</p><p id="ade9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这不是我第一次得到一个错误，并最终发现攻击有效，你应该总是仔细检查。</p></div></div>    
</body>
</html>