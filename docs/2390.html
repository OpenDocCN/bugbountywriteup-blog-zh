<html>
<head>
<title>HTML Injection inside Email body- The First BUG I hunted down in a Bug Bounty Platform!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电子邮件正文中的HTML注入——我在Bug Bounty平台上追捕到的第一个BUG！</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/html-injection-inside-email-body-the-first-bug-i-hunted-in-a-bug-bounty-platform-3c96b1e0ae9f?source=collection_archive---------0-----------------------#2022-09-26">https://infosecwriteups.com/html-injection-inside-email-body-the-first-bug-i-hunted-in-a-bug-bounty-platform-3c96b1e0ae9f?source=collection_archive---------0-----------------------#2022-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3ad9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，朋友！！</p><p id="6823" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，我在Hackerone上发现了我的第一个Bug，这对我来说很有趣，希望你也一样！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/2b52a6399a3e0dbf07a653c5dbc3268a.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*b_mMpynncuWVqSdc.gif"/></div></figure><p id="1e94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在工作场所的一次接触(Web应用渗透测试)中观察并利用了这个Bug，并想到在我在Hackerone中测试的一个应用程序中寻找它，从标题中可以明显看出它确实有效。</p><p id="adee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在谈论这个漏洞之前，我想让你知道这个程序不允许暴露这个漏洞，所以让这个域成为<strong class="jp ir"><em class="kt">【target.com】</em></strong>。</p><h1 id="ad42" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">易受攻击特征:</strong></h1><p id="799f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated"><em class="kt">target.com</em>有一个功能，允许用户<strong class="jp ir">出售二手电子产品</strong>，包括手机、游戏机、键盘、耳机等。</p><p id="48f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序提示用户输入一些关于他们有兴趣销售的产品的详细信息，并使用这些信息来估计用户可能获得的金额，如果他们准备在附近的商店销售该产品的话。</p><p id="3f7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">漏洞出现在应用程序计算和<strong class="jp ir">通过电子邮件</strong>将估算发送给用户的地方。</p><h1 id="0fe6" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">功能的实际问题:</strong></h1><p id="832f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">此功能有两个问题<strong class="jp ir">允许成功利用漏洞，它们是</strong></p><blockquote class="lx ly lz"><p id="b6f8" class="jn jo kt jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">网络应用程序无法控制发送估价的电子邮件，允许用户输入他/她想要的任何电子邮件id，并接收来自<em class="iq">target.com</em>的电子邮件。</p><p id="b197" class="jn jo kt jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">另一个问题是，应用程序从用户那里获取产品信息，并且在将其嵌入到电子邮件正文之前没有进行任何清理，从而导致HTML注入。</p></blockquote><h1 id="1eb4" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">开采和影响:</strong></h1><p id="e98a" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">综上所述，攻击者有可能编制一封恶意电子邮件，用于<strong class="jp ir">社会工程攻击</strong>，并使用<em class="kt">target.com</em>邮件服务器和他们的官方电子邮件ID发送邮件。</p><p id="0273" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我输入了一些关于要销售的产品的随机信息，并使用负责生成电子邮件的Burp代理来捕获请求，然后<strong class="jp ir">将HTML标签</strong>注入到参数中，使<strong class="jp ir">反映在电子邮件正文</strong>中。</p><p id="3314" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">瞧啊。！！！注入的HTML标签在发送给受害者的邮件正文中得到渲染(在这种情况下，这是我的个人邮件)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/df26440c9f3e0503b7893d503406224d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rweq3NYFUNGsxrOgRwYkUQ.png"/></div></div></figure><blockquote class="lx ly lz"><p id="4839" class="jn jo kt jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">我精心制作了一封带有锚标签的电子邮件，并使用Burp Collaborator URL来演示这次攻击。</p><p id="ab8b" class="jn jo kt jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">但是恶意攻击者可以使用相同的技巧在受害者的机器上钓鱼或安装任何恶意软件，也可以使用<strong class="jp ir"> target.com的邮件服务器</strong>。</p></blockquote><p id="939f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能会给公司造成巨大的声誉损失，如果他们使用任何付费服务来生成此类电子邮件，那么在大规模进行时甚至会造成财务损失。</p><p id="2257" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我的朋友，如果你曾经在应用程序中遇到过这样的特性，一定要寻找这个问题，并享受狩猎！</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h2 id="6224" class="mp kv iq bd kw mq mr dn la ms mt dp le jy mu mv li kc mw mx lm kg my mz lq na bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae nb" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>