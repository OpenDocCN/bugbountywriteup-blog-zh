<html>
<head>
<title>[Bug Bounty] 600$ Info Disclosure: obtain any user’s backup data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">【Bug赏金】600$信息泄露:获取任何用户的备份数据</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bug-bounty-600-info-disclosure-a-token-is-not-the-same-on-all-endpoints-febf5b7ea745?source=collection_archive---------0-----------------------#2021-01-19">https://infosecwriteups.com/bug-bounty-600-info-disclosure-a-token-is-not-the-same-on-all-endpoints-febf5b7ea745?source=collection_archive---------0-----------------------#2021-01-19</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ab78" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">[朋友链接]通过备份端点中处理不当的令牌获取任何用户的备份数据</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/f11bea9cdc77e4915a321eb427e51810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gTCwey7qOJKXutZw"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@daanmooij?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">金奎大·穆伊吉</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="9577" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">没有中等付费订阅的朋友链接:<a class="ae ky" href="https://medium.com/@tdpdev/febf5b7ea745?source=friends_link&amp;sk=7994ed9c8ead5b580054463f37cca804" rel="noopener">https://medium.com/@tdpdev/febf5b7ea745?source=friends_link&amp;sk = 7994 ed 9 c 8 EAD 5b 580054463 f 37 CCA 804</a></p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><p id="b3fa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">大家好，我已经很久没有写东西了，因为我更关注奖金。我想和你分享我在H1的一个公共项目中发现的一个漏洞。然而，他们没有公开披露，所以我会编辑目标。</p><p id="b03c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">此外，这给出了一个重要的提示，我们稍后会看到。</p><p id="0ff9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以，接近目标。每次我登录该应用程序时，都会有一个呼叫发送到备份端点。返回用户的备份数据。没有使用cookies，只有POST数据中的一个令牌。看起来是这样的:<code class="fe mc md me mf b">1234-randomletters.</code></p><p id="6545" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我没有想到任何有趣的攻击面，我尝试了另一个令牌，同样的长度，等等。跳过端点，直接使用应用程序。值得注意的是，我刚刚决定开始搜索那个程序，在我的过程中，我没有直接利用它，所以我没有花时间试图劫持令牌，或者使用任何其他技术来绕过它。</p><p id="f7cb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在使用该应用程序一段时间并通过Burp的目标窗口观察流程后，我注意到令牌用于执行任何操作，这是唯一需要的身份验证。但是，这毫无意义。所以我决定创建另一个帐户，看看有什么变化。</p><p id="33d1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">首先看到的是令牌长这样:<code class="fe mc md me mf b">2323-randomletters</code>。而我之前用过的另一个用户是这样的:<code class="fe mc md me mf b">2323-otherrandomletters</code>。注意到什么了吗？那个<code class="fe mc md me mf b">2323</code>也是一样，看起来很有趣。为什么会一样？</p><p id="9df4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我所做的是向中继器发送请求，然后在令牌中，我只放了<code class="fe mc md me mf b">2323</code>，令我惊讶的是，我能够在没有令牌的情况下获得两个用户的备份数据，只有一个随机数。</p><p id="c943" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然而，那不是一个4位数，而是一个6位数。这意味着暴力是一种选择，但并不实际。因此，为了产生更大的影响，我需要了解那是什么以及如何获得它。幸运的是，我有burp pro:)，它使我能够在HTTP流量历史中搜索一个特定的单词，所以我搜索了<code class="fe mc md me mf b">2323</code>它，发现它出现在一个get请求的响应中，该请求要求给定帐户的<code class="fe mc md me mf b">machineID</code>。它返回了我用来泄露任何用户备份数据的数字。</p><p id="c9de" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">然后，我想我可以使用它作为应用程序范围的认证旁路，因为所有的端点都使用该令牌。那应该是P1。不幸的是，对我来说，唯一易受攻击的端点只有这一个。所以我以P3的名义提交了报告，报告在16个小时内得到了审核+奖励+解决。</p><p id="83b9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我真的很想公开这个程序的名字，因为如果能提到那些高效且真正关心其安全性的程序就更好了。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/98f72fc43492313318b948e111d542db.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*Y7l20ERXUjwEn2PCgMj-mw.png"/></div></figure><h2 id="9a71" class="mh mi it bd mj mk ml dn mm mn mo dp mp li mq mr ms lm mt mu mv lq mw mx my mz bi translated">时间表</h2><p id="4453" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">11月8日报道</p><p id="23ac" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">11月9日审判和奖励</p><p id="7534" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">11月9日解决</p><h1 id="fa72" class="nf mi it bd mj ng nh ni mm nj nk nl mp jz nm ka ms kc nn kd mv kf no kg my np bi translated">外卖食品</h1><p id="d004" class="pw-post-body-paragraph kz la it lb b lc na ju le lf nb jx lh li nc lk ll lm nd lo lp lq ne ls lt lu im bi translated">如果您在许多不同的端点上看到一个参数，测试其中一个并发现该参数不容易受到攻击，也测试其他端点，您永远不知道一个端点是否由另一个开发人员编码，或者存在最小的语法问题，等等。一定要全部测试！</p><p id="b512" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读，如果你发现这有帮助，请与其他猎人分享。我最近开了一个推特账号:【https://twitter.com/_hensis_<a class="ae ky" href="https://twitter.com/_hensis_" rel="noopener ugc nofollow" target="_blank">，让我们连线吧！</a></p></div></div>    
</body>
</html>