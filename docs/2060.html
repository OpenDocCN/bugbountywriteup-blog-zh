<html>
<head>
<title>PWN101 Walkthrough | TryHackMe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PWN101演练| TryHackMe</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/pwn101-walkthrough-tryhackme-d34b4236b2a0?source=collection_archive---------1-----------------------#2022-05-10">https://infosecwriteups.com/pwn101-walkthrough-tryhackme-d34b4236b2a0?source=collection_archive---------1-----------------------#2022-05-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/50708de92009d81813b423466ed1802c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uceq2-OI6-KNk72ROk_PGQ.jpeg"/></div></div></figure><p id="3e5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你好，信息安全👋</p><p id="6e69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">短暂休息后，我又带着另一个回来了。我跳出框框去结交新的朋友、社交关系，并照顾好自己的心理健康。但是今天，我计划解决一些二进制开发挑战&amp;我写了这个来自<strong class="ka ir"><em class="kw">pwn 101-TryHackMe的3个挑战</em></strong> <em class="kw">的<strong class="ka ir">演练。</strong></em> </p><p id="871a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"><em class="kw">【pwn 101】是TryHackMe上</em></strong><a class="ae kx" href="https://twitter.com/jopraveen18" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kw">Jopraveen</em></strong></a><strong class="ka ir"><em class="kw">创建的一个免费房间，意思是任何人都可以在房间里部署虚拟机(无需订阅)！</em> </strong></p><blockquote class="ky kz la"><p id="079a" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">你可以看到这是二进制开发的挑战。我被触发了！</p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/165b0f4ba409c4af8b95e924b7352708.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z-ka3IEu26J2QqJoT2aSQQ.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">那么我们开始吧，好吗…？</figcaption></figure><h2 id="d1ce" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated"><strong class="ak">挑战1: </strong>缓冲区溢出</h2><ul class=""><li id="1ec3" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">滥用对易受攻击的函数(gets)的调用来实现缓冲区溢出并覆盖存储在堆栈中的变量值。通过覆盖，我们可以生成一个外壳</li></ul><p id="7ea9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我下载了附件并分析了文件。结果显示在下面。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/aebadb5484fd160ab305ff1063b7a907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3V93iVfjEnVFYWW0tF30uw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">我们开始吧</figcaption></figure><p id="ede7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">运行二进制文件后，我发现它查询客户机输入作为配料。嗯……酷！:)</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/7de9dc6caf94e1a7ac7c439802ccf7c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_iwNhMZnTpHvqDZ2I1Bq5Q.jpeg"/></div></div></figure><blockquote class="ky kz la"><p id="394a" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">奇怪的是，当我提供一些批量输入时，我得到了外壳</p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/05976e0886124998a95ac44c87a29599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9HpUY58o6JbCt3DgJCzRQ.png"/></div></div></figure><p id="3574" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是分析二进制文件的时候了，此时此刻，我能够理解这个缺陷了。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/2e1e6268fc1f6d4a340dbe5ddb0c810d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NRMW3ir7O7mXZQWqm04oxw.png"/></div></div></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/ebbd924bc85990dd16262085af34d8e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jD6k-RDBch1WpJ63iPGR-w.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">获取()函数</figcaption></figure><p id="c04a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在的问题只是找出偏移和公平地确认分段故障。检查“A”* 80(80 A)返回分段故障。此外，在所有情况下都相同&gt; 72 A。通过逐步检查这个过程，我发现合适的偏移量是60！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/349daa735973851a83750a20e9da7bdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Brb7GqUwiXBhU7xOCWHvg.png"/></div></div></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/55b00097c6b76425ea07540e80e30250.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DhCI2gtOw5oS7XMdEFXVKg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">小于60:无变化，如果输入大于60，则提供gift (shell)</figcaption></figure><h2 id="4535" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">剥削</h2><p id="697c" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mx kl km kn my kp kq kr mz kt ku kv ij bi translated">滥用是直接的。我们应该将批量值发送到给定的服务器&amp;分配的端口。这样，来自服务器的外壳将返回给我们。我创建了一个简单的python脚本来完成这项任务&amp;它的功能与预期一致；)</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">利用. py</figcaption></figure><p id="5e1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">说对了！成功破解挑战1 </em></p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/95a963d99a0870b561a0603a5ac0eb73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eg_nRTGWm5Q1WwyeHNAgHw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">;)</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="94ef" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">挑战2:修改变量值</h2><ul class=""><li id="75b9" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">为了解决第二个挑战，我颠倒了二进制&amp;确定它打算如何解决！在这里，我们将在典型的地址上改变特定的值&amp;此时，我们可以生成shell:)</li></ul><blockquote class="ky kz la"><p id="314c" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">0x 0000000000000091 a:mov DWORD PTR[RBP-0x 4]，0x badf 00d<br/>0x 00000000000921&lt;+35&gt;:mov DWORD PTR[RBP-0x 8]，0xfee1dead</p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/28c6f0b092adc18f8b770bb739f879fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XtDqg2Te8GslZdfdlkNCOA.png"/></div></div></figure><p id="1160" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们知道当前的价值</p><ul class=""><li id="1048" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">[rbp-0x4]是0xbadf00d</li><li id="532a" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">[rbp-0x8]是0xfee1dead</li></ul><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/fb053b45744946d9d3915b898e2e8b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qO7LNxhPhbhUKR2HTxZ6cg.png"/></div></div></figure><blockquote class="ky kz la"><p id="8c82" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">0x 00000000000000959:CMP双字指针[rbp-0x4]，0x c0ff 33<br/>0x 000000000000960&lt;+98&gt;:jne 0x 992&lt;main+148&gt;<br/>0x 0000000000000962&lt;+100&gt;:CMP双字指针[rbp</p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/54e05f778998ffd49908384c4879b3a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQDcg79Oq_4nZ8KHuTuPig.png"/></div></div></figure><ul class=""><li id="1156" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">在地址“0x0000000000000959”处，它检查[rbp-0x4]是否为0xc0ff33</li><li id="dfbd" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">在“0x0000000000000962”时，它检查[rbp-0x8]是否为0xc0d3</li><li id="f095" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">如果条件满足，它将继续在→0x 00000000000096 b执行</li><li id="c75a" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">否则它会跳到<main>不返回外壳。</main></li></ul><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/2eaebd48c408a54cf1b84397b9fdfb31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_ZsyDlymkj215MuG3SFmg.png"/></div></div></figure><p id="3f82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">原因:我已经提到，价值观仍然是</p><ul class=""><li id="3af1" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">[rbp-0x4]: 0xbadf00d</li><li id="a767" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">[rbp-0x8]: 0xfee1dead</li></ul><h2 id="4884" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">解决办法</h2><ul class=""><li id="d002" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">我们必须改变执行方向来解决这个挑战。一旦需求得到满足，我们就可以弹出外壳了。我们只需要在地址“0x 5555540096 b<main>”进行可能的执行</main></li><li id="9315" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">我通过倒车破解了它。但是在二进制开发方面，我们需要做更多的辅助工作。</li></ul><p id="2de8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">证明:</strong></p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/5d5c63fd3ea841c2bfef56457514f8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hAl3b44LzKdb_-ygmIdYxQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">弹壳；)</figcaption></figure><p id="dd22" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我为这个挑战编造了一个简单的漏洞，因为我们知道服务运行在端口:9002上</p><p id="5294" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">反向过程中计算的偏移量。这很简单！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/6a6e4f5053e272b175ddecd299e2fe76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X6n8NylXG04dLnQKa5fTQA.png"/></div></div></figure><ul class=""><li id="7c90" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">以这种方式溢出缓冲区并覆盖内存，我们可以修改弹出shell的值。</li></ul><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="na nb l"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">剥削</figcaption></figure><p id="90ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">搞定了！成功破解挑战2 </em></p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/d909442f7c47d20bd60c8df26fa537d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zNrQ7qlWtEkiM5HO5cRj7Q.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">;)</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="ebca" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">挑战三:回归胜利</h2><ul class=""><li id="9f1d" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">为了解决第三个挑战，我执行了二进制代码并理解了它的功能。我颠倒了思维导图的二进制(我同样的方法)。这里我们将指针返回到弹出外壳的一个不同的地址。</li></ul><p id="e4f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一，我执行程序，理解流程。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/380b31074bbbce1a2f2b82d9188a3b40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SaEjAZy7F1ff8XInL_TUEg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">遵守用户输入</figcaption></figure><p id="4530" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我检查了每个选项，有趣的是第三个</p><ul class=""><li id="0f12" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">常规:</li></ul><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/53186d8828547e613ce48b39f360a3b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwbSYgB21VbkAh1igC-HaA.png"/></div></div></figure><p id="4684" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它承载着用户输入，同时也有一丝脆弱。我检查了大量输入，我是正确的！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/ccfae732feaf029897122b9e72144262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tdk-eH6fo0QIMckhAunOJw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">分段故障(核心转储)</figcaption></figure><h2 id="2574" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated"><strong class="ak">逆向工程</strong></h2><p id="5abb" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mx kl km kn my kp kq kr mz kt ku kv ij bi translated">对于这个目标，我不得不去理解和深入检查。因此，我颠倒了二进制来理解预谋的解决方案。我在澄清我注意到的步骤！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/4abc87e55bb6363ee8369f8b9eb2dfe6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uzn3NvyN4b5SfoPYF5Z5gw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated"><general/></figcaption></figure><p id="3eee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">溢出确认，我们可以看到“_isoc99_scanf”，这可能是我们的scanf调用。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/3ad1fbc294ceda019d296ab470fc5310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fxjjd6Uo9JQwqtGelsbGUA.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">_isoc99_scanf</figcaption></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/5c4e693f715ee69a4d9437d224f88265.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8M8Aua47p4ZJozfY8On-g.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">泛滥</figcaption></figure><h2 id="d27a" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated"><strong class="ak">解决方案</strong></h2><ul class=""><li id="f1a6" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">覆盖内存并将执行转换到一个不同的位置。因此，下面的目标是指定返回执行的不同位置。</li><li id="cf53" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">通过逆转自身，我们可以发现我们的终点。</li></ul><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/3374f75274d58533788c82faf08bacbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r5YZ6rHFyzUH6Cs8Ib2j1A.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">仅限管理员</figcaption></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/0f601ec594e080245517f96833eb1a8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPsW1RRz3NSoS6FC4FPldg.png"/></div></div></figure><blockquote class="ky kz la"><p id="7247" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">一旦我们执行了这个函数，shell就会弹出。我用gdb证明了这个场景</p></blockquote><ul class=""><li id="729c" class="mg mh iq ka b kb kc kf kg kj nl kn nm kr nn kv mn mo mp mq bi translated">我放置了断点&amp;重定向流程以确保案例。我的决定是对的。弹壳弹出；)</li></ul><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/64a8d3b024e2859b80c9313e4e6aaad5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dEKDqLIRdrSM7ieiWzVPqQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">耶！我们拿到壳了</figcaption></figure><h2 id="5f16" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">剥削</h2><p id="5e25" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mx kl km kn my kp kq kr mz kt ku kv ij bi translated">所有积累的信息都得到了很好的处理(在倒车时)。我在本地机器上实现了这个漏洞&amp;它正在蓬勃发展。</p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><p id="e399" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成功转移了执行流…！</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/0506e104553c5ba3c4010001eefc24d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AdZDXMsm_T0bkOOw5OSk5Q.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">local.py</figcaption></figure><h2 id="88e6" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">最终利用</h2><ul class=""><li id="b02e" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">开发过程中存在一些困难，但我找到了解决办法。为了建立稳定的shell，我多次插入了返回地址。因此，在触发“<strong class="ka ir"> admins_only </strong>”函数后，执行strike &amp; Shell。</li></ul><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="na nb l"/></div></figure><blockquote class="of"><p id="221f" class="og oh iq bd oi oj ok ol om on oo kv dk translated">这个策略同样成功！<br/>成功破解挑战3</p></blockquote><figure class="op oq or os ot jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/003ecdc2fc736d4d2ae9446858841f4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*onjGK9ohLEpNm-QO8YrsJQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">工作完成:)</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="de0e" class="ln lo iq bd lp lq lr dn ls lt lu dp lv kj lw lx ly kn lz ma mb kr mc md me mf bi translated">最后的想法</h2><ul class=""><li id="ee1a" class="mg mh iq ka b kb mi kf mj kj mk kn ml kr mm kv mn mo mp mq bi translated">还有很多挑战要做。但很遗憾，我坚持不下去了。我的大学内部评估正在进行&amp;这学期很忙。而且，我在户外还有很多可以探索的地方。</li><li id="deb9" class="mg mh iq ka b kb no kf np kj nq kn nr kr ns kv mn mo mp mq bi translated">我很高兴知道休息一段时间后我就可以迎接挑战了。我将很快访问infosec &amp;继续我的开发系列。</li></ul><div class="ou ov gp gr ow ox"><a href="https://github.com/7h3h4ckv157/Binary-exploitation-series" rel="noopener  ugc nofollow" target="_blank"><div class="oy ab fo"><div class="oz ab pa cl cj pb"><h2 class="bd ir gy z fp pc fr fs pd fu fw ip bi translated">GitHub-7h 3 H4 ckv 157/Binary-Exploitation-series:关于“二进制剥削”的系列写作。</h2><div class="pe l"><h3 class="bd b gy z fp pc fr fs pd fu fw dk translated">一系列关于“二进制剥削”的写作。。通过…为7h 3 H4 ckv 157/二进制开发系列开发做出贡献</h3></div><div class="pf l"><p class="bd b dl z fp pc fr fs pd fu fw dk translated">github.com</p></div></div><div class="pg l"><div class="ph l pi pj pk pg pl jw ox"/></div></div></a></div><blockquote class="ky kz la"><p id="3fa2" class="jy jz kw ka b kb kc kd ke kf kg kh ki lb kk kl km lc ko kp kq ld ks kt ku kv ij bi translated">我希望你喜欢我的文章。请随时与我联系并分享您的观点。你可以在这里找到我@<a class="ae kx" href="https://twitter.com/7h3h4ckv157" rel="noopener ugc nofollow" target="_blank">7h 3 H4 ckv 157</a></p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi pm"><img src="../Images/0d19696ce785667860b2784446050fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*qMPbJM1llcMtV-504McVZA.jpeg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">再见！</figcaption></figure></div></div>    
</body>
</html>