<html>
<head>
<title>How to make our own CTF Challenge with ease.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何轻松制作我们自己的CTF挑战赛？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-to-make-our-own-ctf-challenge-with-ease-6b15f76865b5?source=collection_archive---------0-----------------------#2022-01-17">https://infosecwriteups.com/how-to-make-our-own-ctf-challenge-with-ease-6b15f76865b5?source=collection_archive---------0-----------------------#2022-01-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d996" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨，信息安全的人们，希望你们健康！我刚刚有足够的时间来写一个关于我真正想写的主题的博客，“你也可以创建自己的CTF挑战赛”，但我把这个名字改成了现在的名字，因为它听起来没有现在的博客名字那么有趣/酷。到目前为止，这将是我迄今为止最好的博客，如果你真的想在创造挑战时看到创造者的心态，我鼓励你阅读博客直到结束，以学习如何创造…</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/e648932b5a45b19853efbf5873acf114.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*t4bMUTsSd0AUGp6-.gif"/></div></figure><p id="6924" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，根据我在类似<strong class="jp ir"> TryHackMe </strong>、<strong class="jp ir"> HackTheBox </strong>、<strong class="jp ir"> VulnHub </strong>的平台上玩CTF的个人经验，我真的很喜欢玩它们，但我的心态是破解/破坏它们，然后继续前进，直到我在<strong class="jp ir">Linux</strong>/<strong class="jp ir">windows</strong>box中获得<strong class="jp ir"> root </strong> / <strong class="jp ir">管理员</strong>权限。但是这种突破性的东西是令人兴奋的，直到我开始做一个我自己的盒子，相信我，当你自己创造东西时，你的视角会改变。当你试图分解事物时，你倾向于用新的眼光、新的大脑看待事物，并有更广阔的思维方式。</p><p id="a201" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直在想，创造者是如何创造盒子的？他们如何知道什么样的配置使一个盒子容易受到攻击？我怎么才能做出我的呢？流程是怎样的？所以我开始研究这个。到目前为止，我一直在做这个盒子，所以我不介意和你们分享这个方法。虽然，这个博客不会专注于创建一个有<strong class="jp ir"> X </strong>漏洞的盒子，但只是给出一个关于盒子创建的想法。如果你对制作盒子更感兴趣，做你的研究，了解你要做什么，然后开始制作。而且在这篇博客的最后，我还会给你提供笔记(以防后面有人忘记步骤，就像我每次都忘记一样)！</p><p id="2af7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们快速看一下这篇博客的内容:</p><ul class=""><li id="6c80" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">在VirtualBox中创建虚拟机</li><li id="455a" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">Ubuntu服务器安装</li><li id="1c28" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">盒子创建</li><li id="c313" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">出口设备</li><li id="2c62" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">笔记</li></ul><p id="8671" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，在开始创建一个盒子之前，我们需要一个kali linux和一个我们将要使用的ubuntu server 20.04。</p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="7151" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对box的见解已经够多了，让我们开始制作一个吧(我真心希望你会感到兴奋)。</p><p id="ae48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">注意:我将在虚拟盒子上制作这个盒子，因为。虚拟盒支持ova文件。如果你们愿意，可以在VMWare上做一个盒子(我已经做好了)。</strong></p><p id="816b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">先从访问<a class="ae lo" href="https://ubuntu.com/download/server" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>网站下载Ubuntu Server 20.04镜像开始，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lp"><img src="../Images/856df7418765c8172dd8b324280db7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4raMKmvkm-WiSoEKOtBgQ.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk translated">点击绿色按钮下载Ubuntu Server 20.04镜像</figcaption></figure><p id="f65d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载完成后，我们必须在虚拟箱中创建新的虚拟机。我将展示如何创建新的虚拟机(以防有人不知道如何创建新的虚拟机)。</p><h1 id="8546" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">创建虚拟机</h1><ul class=""><li id="6c4b" class="kt ku iq jp b jq mw ju mx jy my kc mz kg na kk ky kz la lb bi translated">单击“新建”按钮打开一个对话框。键入新虚拟机的名称。由于我打算安装Ubuntu Server 20.04，所以我将它命名为<strong class="jp ir"> Ubuntu Server </strong>，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/95e682d969972dab59680d8604ebac40.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*Mm31T8aaf5kemvzrgIrHkw.png"/></div></figure><ul class=""><li id="6906" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击<strong class="jp ir">下一个</strong>。我们看到了一个<strong class="jp ir">内存大小</strong>窗口。内存大小取决于您的主机内存大小(我已将其设置为1gb，如果您想要更多，您可以根据您的系统规格自由添加)，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a3e0fe9804c1026185990c920fe23124.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*uS7XRRQxY19c3tdE1dj4dg.png"/></div></figure><ul class=""><li id="b676" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击<strong class="jp ir">下一个</strong>。接受默认的“立即创建虚拟硬盘”，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/2e6a2f4c1ec568bc6bb4f2e7f96b3708.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*d8F3L-BLUYtAuH5Z5U5Dsw.png"/></div></figure><ul class=""><li id="a5b9" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击<strong class="jp ir">创建</strong>。继续接受默认的“VDI”驱动器文件类型，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/601165dc5faa9dda79c1f4d93354f9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*rT0IMUF25QvmOp7gcAcptw.png"/></div></figure><ul class=""><li id="bc3c" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击<strong class="jp ir">下一个</strong>。动态分配物理硬盘，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/a17dd7b4fc7932a4dc5f6dc3ed86b3c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*_i-aBWXfayScnjBZpcGyWQ.png"/></div></figure><ul class=""><li id="48dd" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击下一个的<strong class="jp ir">。这将为我们创建新的虚拟机。现在，选择我们新创建的机器并点击虚拟框上的<strong class="jp ir">设置</strong>图标。</strong></li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/bc645c545c33d2276687f1022ab4e78a.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*kVPctFc40wSiN8z1gyUhvg.png"/></div></figure><ul class=""><li id="bcf5" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">将打开虚拟机设置。从那里，导航到<strong class="jp ir">网络</strong>选项卡并选择<strong class="jp ir"> NAT网络</strong>(如果你不知道如何创建，请参考这篇关于<a class="ae lo" href="https://www.techbeatly.com/how-to-create-and-use-natnetwork-in-virtualbox/" rel="noopener ugc nofollow" target="_blank">如何在VirtualBox </a>中创建和使用NAT网络的文章)。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/635feaee8b784960a92c1dbb82331c4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*KoEo1-RABuWqIgRuuxULGQ.png"/></div></figure><ul class=""><li id="172c" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">点击<strong class="jp ir">确定</strong>。我们的虚拟机现在已经创建好了。让我们点击绿色箭头<strong class="jp ir">开始</strong>按钮开始。然后它会要求选择iso，导航到您下载iso文件的文件夹/目录并选择它。然后点击<strong class="jp ir">选择</strong>按钮。这样，我们的Ubuntu服务器就可以启动了。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/bc3faae8a981082f5fb7c227e99cddf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*ghjJlbDpImyrFcPPHUpaSw.png"/></div></figure></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><h1 id="6b3a" class="ly lz iq bd ma mb ni md me mf nj mh mi mj nk ml mm mn nl mp mq mr nm mt mu mv bi translated">Ubuntu服务器安装</h1><p id="3226" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy nn ka kb kc no ke kf kg np ki kj kk ij bi translated">现在，我们将继续安装Ubuntu服务器。因此，当服务器启动时，我们将首先看到这个窗口，其中需要选择一种语言。让我们从英语开始。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/4ccac6d450b9531e0d9156220f4f1e10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8sJnq6B6vm7z4koN0ZO-Q.png"/></div></div></figure><ul class=""><li id="48ad" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">按下回车键，我们将看到安装程序更新可用。但是让我们继续不更新它，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/f7f898b5b4f0318f54ab9b3a0a562b30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CBYrTAyI6xndYrxyGeM3YQ.png"/></div></div></figure><ul class=""><li id="c5d4" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">按回车键，下一步将是键盘配置。让它保持原样，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/adda8cbf4608f7b0948fcbfddf221078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFVOwGmmaPM_YNGsVlcUsA.png"/></div></div></figure><ul class=""><li id="4585" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">按回车键，我们将看到网络连接窗口。所以让服务器使用DHCP为机器自动分配IP地址，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/da619103f1f5e169f0ad9c7f1dd1ba49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bvf6sEiVwFdEWRCb_ywo3g.png"/></div></div></figure><ul class=""><li id="0606" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">按回车键，现在我们将看到配置代理，但我们将按回车键跳过它。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/bd932939d41e77cc2d8220b886ce9d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-JMkAE6aeGod0w4riBOLYw.png"/></div></div></figure><ul class=""><li id="5160" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">现在，我们将看到存储配置。我们将为我们的盒子使用整个磁盘，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/0ee4cb7e6763a9c91321bea07f182d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RNMCJi1nJAHksl7_Oced7w.png"/></div></div></figure><ul class=""><li id="9822" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">选择存储布局后，按enter键，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/77294ec7f5059d927701a42cd16b4b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*blJjFJyUnoZsqMI6VlcIqw.png"/></div></div></figure><ul class=""><li id="8214" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">我们不必在这里进行更改，所以再次按enter键，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/70db83c3f70f0ee361dda10347df7a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHVzoTsUVc_kbmDPPVvx6A.png"/></div></div></figure><ul class=""><li id="6f60" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">它将提示一个确认框并开始安装。开始<strong class="jp ir">继续</strong>。然后，它会要求输入设备名称和用户名及其对应的密码，所以让我们创建一个，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/47256f9454cd85103b819a2a0e0b3f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5mwRYw9GZ_cZD71vmw9ozg.png"/></div></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk translated">我已经输入了<strong class="bd ma">主机名</strong>(服务器名称)作为<strong class="bd ma">测试</strong>和<strong class="bd ma">用户名</strong> &amp; <strong class="bd ma">密码</strong>作为<strong class="bd ma">地狱火</strong>。</figcaption></figure><ul class=""><li id="6095" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">输入名称、用户名和密码后，按回车键。然后它会问我们是否要安装<strong class="jp ir"> OpenSSH服务器</strong>，既然我们想安装，那么我们将通过将光标移到该区域并按下<strong class="jp ir"> <em class="nr">空格键</em> </strong>来选择它。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/2bd3acd567e6f169ade88330491fccfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHhOuPblGpZ1edXLfmSRpQ.png"/></div></div></figure><ul class=""><li id="38a0" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">按回车键，它会要求我们安装快照功能，让我们跳过这些，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/6ecea800eeb59b9955ae31534df2b9e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fmx7yv9Gjd59FvFk-ICdxw.png"/></div></div></figure><ul class=""><li id="74ed" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">最后一次按回车键完成配置，ubuntu将开始安装过程，</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/cc21d460c94c60a5e67363b12cbd4a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z45Irow6WBsSMJTyCTB1zg.png"/></div></div></figure><p id="e42a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">达到这一点后，您将会看到一个选项<strong class="jp ir">现在重启</strong>。继续重新启动这台机器，现在我们的机器准备好了。</p><h1 id="5453" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">盒子创建</h1><p id="3c38" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy nn ka kb kc no ke kf kg np ki kj kk ij bi translated">现在我们已经完成了ubuntu服务器的安装，让我们快速开始创建盒子的过程(我知道你们中的一些人已经很兴奋了，我也是)。我们现在可以使用我们拥有的凭证(在我的例子中是hellfire:hellfire)登录到服务器。让我们看看信息，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="5b7c" class="nx lz iq nt b gy ny nz l oa ob">id<br/>whoami<br/>hostname</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi nq"><img src="../Images/06c86b75da3ee11d2ad2f66b32a334c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hQ8FEJ_uKjL72RYkJ8UvA.png"/></div></div></figure><p id="20a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe oc od oe nt b">id</code>命令会显示地狱火用户的ID，<code class="fe oc od oe nt b">whoami</code>命令会显示我们当前的身份，<code class="fe oc od oe nt b">hostname</code>命令会显示系统的名称。发出<code class="fe oc od oe nt b">ls -la</code>命令，我们可以看到目录内容(目前没有什么有用的)。</p><p id="6d22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了执行一些主要任务，我们需要root用户访问权限，为此，我们首先启用root用户登录，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="dab1" class="nx lz iq nt b gy ny nz l oa ob">sudo -i passwd root<br/>su root<br/>id</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi of"><img src="../Images/2d4186fee75933814308978ae1655835.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*oWBEDbtpSQ_DL4qXGCDcEQ.png"/></div></figure><p id="f061" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令<code class="fe oc od oe nt b">sudo -i passwd root</code>通过要求我们设置root用户密码来启用root用户登录。第二个命令<code class="fe oc od oe nt b">su root</code>帮助我们切换到root用户，而<code class="fe oc od oe nt b">id</code>命令检查root用户的ID。</p><p id="3786" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们在根用户目录中，让我们创建根用户标志，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="2f99" class="nx lz iq nt b gy ny nz l oa ob">echo 'root_flag' | md5sum &gt; root.txt<br/>ls -la <br/>chmod 600 root.txt<br/>ls -la</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi og"><img src="../Images/d976f18e939dc65693c0f188eeee51ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*K-LAH5vtY4ZefhPCy0n-kQ.png"/></div></figure><p id="d5ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令<code class="fe oc od oe nt b">echo ‘root_flag’ | md5sum &gt; root.txt</code>回显<strong class="jp ir"> root_flag </strong>字符串，并且<a class="ae lo" href="https://www.geeksforgeeks.org/piping-in-unix-or-linux/" rel="noopener ugc nofollow" target="_blank">将其管道</a>到<a class="ae lo" href="https://www.geeksforgeeks.org/md5sum-linux-command/" rel="noopener ugc nofollow" target="_blank"> md5sum </a>命令中，以生成一个字母数字值，该值被直接导入到<strong class="jp ir"> root.txt </strong>文件中。发出<code class="fe oc od oe nt b">ls -la</code>，我们可以看到我们的root.txt文件已创建，但对<strong class="jp ir"> others </strong>和<strong class="jp ir"> groups </strong>也有读取权限(我们需要取消这些权限，因为您不希望低级用户读取root用户文件的信息)。因此，为了取消其他人和组的读取权限，第三个命令<code class="fe oc od oe nt b">chmod 600 root.txt</code>帮助我们(文件分别具有值为<strong class="jp ir">4–2–1</strong>的<strong class="jp ir"> r-w-x </strong>权限)，并确保除了根用户之外没有其他人可以读取该标志。再次发出<code class="fe oc od oe nt b">ls -la</code>，我们可以清楚地看到文件权限发生了变化。</p><p id="c4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要验证低级别用户是否可以读取该标志，只需键入<code class="fe oc od oe nt b">exit</code>命令，并尝试以低级别用户(在我的例子中是地狱火)的身份读取root.txt文件，我们可以看到<strong class="jp ir">权限被拒绝</strong>消息，该消息验证除了root用户之外没有人可以读取root.txt文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/71455f05d6419d01d7c5053c6e12071c.png" data-original-src="https://miro.medium.com/v2/resize:fit:630/format:webp/1*5H-YJOP9WZNbCDoAeo_atg.png"/></div></figure><p id="7fd9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里很好。(:</p><p id="3a87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们使用<code class="fe oc od oe nt b">su root</code>命令再次切换回root用户，并为低级用户创建标志。</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="efe9" class="nx lz iq nt b gy ny nz l oa ob">echo 'user_flag' | md5sum &gt; /home/hellfire/user.txt<br/>ls -la<br/>chown hellfire:hellfire user.txt &amp;&amp; chmod 660 user.txt<br/>ls -la</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/1a963d46203ce5735f982d8e431e43e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*gPIZI9dFG9o-NKIuc7RCaA.png"/></div></figure><p id="2dee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令<code class="fe oc od oe nt b">echo ‘user_flag’ | md5sum &gt; /home/user/user.txt</code>帮助我们创建了用户标志。发出<code class="fe oc od oe nt b">ls -la</code>命令查看user.txt文件的权限，我们可以看到<strong class="jp ir">组</strong>和<strong class="jp ir">组</strong>可以读取user.txt文件。所以在这里，我们可以做的是，我们可以让这个文件归hellfire用户所有，并更改其权限，以便只有所有者和组成员可以读取这个user.txt文件。我们可以通过组合两个命令<code class="fe oc od oe nt b">chown hellfire:hellfire user.txt &amp;&amp; chmod 600 user.txt</code>来完成这两个任务，因为该命令只有在第一个命令正确时才有效(这是因为<strong class="jp ir"> &amp; &amp; </strong>操作符)。再次发出<code class="fe oc od oe nt b">ls -la</code>，我们可以看到我们的文件现在归地狱火所有，并且拥有合适的权限。</p><p id="68c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续进行有趣的事情，比如配置FTP服务器、apache2服务器、openssh服务器等。现在我们已经完成了创建标志的工作，让我们开始真正的工作。要通过此服务器上的任何端口启用流量，我们需要ufw ( <a class="ae lo" href="https://www.linux.com/training-tutorials/introduction-uncomplicated-firewall-ufw/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">简单防火墙</strong> </a>)工具。让我们把它安装在我们的服务器上，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="4873" class="nx lz iq nt b gy ny nz l oa ob">apt install ufw<br/>ufw status<br/>ufw enable<br/>ufw status</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/63f43af33966f0364b6e17a4f84082c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:782/format:webp/1*AoalcqKZzFGPj3bDfkHAkg.png"/></div></figure><p id="cff6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个<code class="fe oc od oe nt b">apt install ufw</code>命令在我们的服务器上安装简单的防火墙。第二个<code class="fe oc od oe nt b">ufw status</code>命令检查防火墙的状态，看它是活动的还是不活动的。第三个<code class="fe oc od oe nt b">ufw enable</code>命令启用/启动防火墙，第四个命令再次检查防火墙的状态(现在是活动的)。</p><p id="5355" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载并设置了简单的防火墙后，让我们安装FTP服务器，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="3d16" class="nx lz iq nt b gy ny nz l oa ob">apt install vsftpd<br/>cp /etc/vsftpd.conf /etc/vsftpd.conf.orig<br/>nano /etc/vsftpd.conf</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ok"><img src="../Images/32d7c7d880c3ef132d0abc55036653fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2tqTM_XBcdVvrCdG0g8lTg.png"/></div></div></figure><p id="2242" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个<code class="fe oc od oe nt b">apt install vsftpd</code>命令在我们的机器上安装vsftpd服务器。第二个<code class="fe oc od oe nt b">cp /etc/vsftpd.conf /etc/vsftpd.conf.orig</code>命令对vsftpd.conf文件的配置进行备份。第三个<code class="fe oc od oe nt b">nano /etc/vsftpd.conf</code>命令打开文本编辑器来编辑vsftpd.conf文件。</p><p id="50d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们都喜欢在解决CTFs时启用匿名用户登录，因为它使我们的工作更容易，对吗？我们将配置相同的匿名用户访问我们的FTP服务器(耶！).由于我们的配置文件已经在运行，我们必须对这个文件进行修改。要让匿名用户登录ftp，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/be512bff5f4809c513ec99db1ca87368.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*4qv_Jx1evDfQKVN5dOoX-g.png"/></div></figure><p id="ebc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将匿名登录从<strong class="jp ir">否</strong>更改为<strong class="jp ir">是</strong>，因为这将允许匿名用户登录FTP。接下来，我们为<code class="fe oc od oe nt b">/var/ftp</code>中的<strong class="jp ir"> ftp </strong>定义了一个目录。最后，我们禁用了匿名用户的登录密码；这将做的是，当一个匿名用户试图登录，ftp不会要求密码，而认证。</p><p id="33f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经完成了vsftpd.conf配置，让我们也在终端上烘焙一些东西，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="5c92" class="nx lz iq nt b gy ny nz l oa ob">cd /var<br/>mkdir ftp<br/>chown nobody:nogroup ftp/<br/>cd ftp &amp;&amp; echo 'Hello Hellfire' &gt; file.txt &amp;&amp; chown nobody:nogroup file.txt</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi om"><img src="../Images/53919c515d6cc2865c048d0c0d8281bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLdLtGsMyLyGqHn4SS43eg.png"/></div></div></figure><p id="fce3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们将使用第一个命令导航到<code class="fe oc od oe nt b">/var</code>目录，然后使用第二个命令，我们将创建一个名为<strong class="jp ir"> ftp </strong>的目录。创建目录后，让我们变点魔法，好吗？首先，让我们使用<code class="fe oc od oe nt b">chown nobody:nogroup ftp</code>命令将这个ftp目录的名称改为<code class="fe oc od oe nt b">nobody:nogroup</code>。阅读更多关于<a class="ae lo" href="https://askubuntu.com/questions/329714/what-is-the-purpose-of-the-nobody-user" rel="noopener ugc nofollow" target="_blank">无名小卒</a>群。唉，我们首先导航到我们创建的目录，创建一个名为<strong class="jp ir"> file.txt </strong>的文件，内容为“Hello Hellfire”，然后更改文件<strong class="jp ir"> file.txt </strong>的所有权。发出<code class="fe oc od oe nt b">ls -la</code>命令后，我们可以看到文件权限是按照我们想要的方式设置的。</p><p id="b92e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们完成了这项工作，现在剩下的就是为ftp启用流量，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="08af" class="nx lz iq nt b gy ny nz l oa ob">ufw allow 20/tcp<br/>ufw allow 21/tcp<br/>ufw status</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi on"><img src="../Images/484d9928d57b2519ba70992ebd86f14a.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*P-l-hIObU7pQD6wOIC6uFA.png"/></div></figure><p id="da51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述两个命令<code class="fe oc od oe nt b">ufw allow 20/tcp</code>和<code class="fe oc od oe nt b">ufw allow 21/tcp</code>将允许流量从这两个端口流出。阅读更多关于<a class="ae lo" href="https://stackoverflow.com/questions/626823/in-protocol-design-why-would-you-ever-use-2-ports" rel="noopener ugc nofollow" target="_blank">为什么FTP使用2个端口</a>的信息。再次检查防火墙状态以验证防火墙是否允许这些端口。</p><p id="b3ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们现在将使用kali机器来访问ftp服务，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="cdac" class="nx lz iq nt b gy ny nz l oa ob">ftp 10.0.2.27<br/>get file.txt</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/a0c13959f5a575ed0be82f756119c332.png" data-original-src="https://miro.medium.com/v2/resize:fit:1314/format:webp/1*hV_AxeNMMdsUi3_6Ws5VmA.png"/></div></figure><p id="6ed5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，使用第一个<code class="fe oc od oe nt b">ftp 10.0.2.27</code>命令，我们使用安装在kali机器上的ftp客户端连接到ftp服务，向它提供ubuntu服务器的IP地址。然后它会提示我们登录，所以提供<strong class="jp ir">匿名</strong>用户名并按回车键，但它不会提示我们输入密码(还记得我们在<strong class="jp ir"> vsftpd.conf </strong>文件中禁用密码提示吗？)我们将直接登录。我们可以列出目录内容，看到有一个名为<strong class="jp ir"> file.txt </strong>的文件(我们之前创建的)。然后，我们将使用<code class="fe oc od oe nt b">get file.txt</code>命令下载这个文件到我们的本地系统，然后从这个服务器下载<code class="fe oc od oe nt b">exit</code>。读取<strong class="jp ir"> file.txt </strong>的内容会显示我们的FTP服务工作正常！！</p><p id="0c1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，来到Webserver部分，apache2没有安装在ubuntu server 20.04中，所以我必须手动安装，但这真的很容易。我们只需要输入下面的命令，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="1bee" class="nx lz iq nt b gy ny nz l oa ob">sudo apt update<br/>sudo apt install apache2</span></pre><p id="0594" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令更新系统中已安装的包，第二个命令将在我们的ubuntu上实际安装apache2服务器。</p><p id="6ccd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果我们在浏览器中访问<a class="ae lo" href="http://10.0.2.27" rel="noopener ugc nofollow" target="_blank"> http://10.0.2.27 </a>，我们将看到Ubuntu的默认网页(这意味着我们的web服务器已经启动并运行)，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi op"><img src="../Images/1b166a99f0af59a7d5dd6b531df73778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*in37z__PnmPwQ83R5bc67Q.png"/></div></div></figure><p id="70e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们知道我们的web服务器已经启动并运行了，让我们在我们的系统上安装PHP语言，让它变得更有趣！要在我们的系统上安装PHP，我们首先需要在我们的ubuntu系统上添加存储库，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="f613" class="nx lz iq nt b gy ny nz l oa ob">apt install software-properties-common<br/>add-apt-repository ppa:ondrej/php</span></pre><p id="a6e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令允许轻松管理分布。你可以在<a class="ae lo" href="https://askubuntu.com/questions/1000118/what-is-software-properties-common" rel="noopener ugc nofollow" target="_blank">软件-通用-属性</a>上阅读更多信息。第二个命令实际上是在ubuntu系统上添加了<strong class="jp ir"> ondrej PHP </strong>库。如果你现在想知道ondrej是什么？下面是截图的样子，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/70adb234a23a25aa69a90db973eb5e93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*anYGeDEMUeh7o-w41D_Pmg.png"/></div><figcaption class="lu lv gj gh gi lw lx bd b be z dk translated">截图来自谷歌</figcaption></figure><p id="ca58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们需要再发出两个命令来在我们的系统上安装php，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="b08f" class="nx lz iq nt b gy ny nz l oa ob">apt update<br/>apt install -y php7.4</span></pre><p id="7f4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，第一个命令将更新我们系统中的包，第二个命令将在我们的系统上安装PHP7.4。</p><p id="edcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你现在还在跟踪我。正如你现在所想的，我要打多少字，记录多少东西，因为在组织它们之前，它们只是分散的，让我的思维模式写一篇关于这个主题的文章(我知道这将是一篇很长的文章)，并不容易，但我真的很喜欢它，所以对我来说很重要！！此外，如果你需要休息，你可以喝水，通过向后滚动来放松你的肩膀，放松你的脖子和脊柱，并再次开始创作过程！((:</p><p id="07d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，现在我们已经在系统上安装了PHP7.4，我们将首先创建一个测试PHP文件，看看它是否工作。我将继续讲述php最基本的代码，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="4eab" class="nx lz iq nt b gy ny nz l oa ob">echo '&lt;?php phpinfo(); ?&gt;' &gt; test.php<br/>ls -la<br/>chown -R www-data:www-data /var/www/html<br/>ls -la</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi or"><img src="../Images/0dff0e71719e232eff222ff0cd16ca4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*jakuUCDOAzLsGXVkFQGuLQ.png"/></div></figure><p id="44d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过第一条命令，我们将把基本的php代码(包含一个<strong class="jp ir"> phpinfo() </strong>函数，用于输出大量关于PHP安装的信息，并可用于识别安装和配置问题)重定向到test.php文件中。然后查看目录的内容，我们看到这两个文件都拥有根用户所有权，因为我们知道webserver中的文件应该拥有<a class="ae lo" href="https://askubuntu.com/questions/873839/what-is-the-www-data-user" rel="noopener ugc nofollow" target="_blank"> www-data user </a>的所有权(想象一下这样一种情况:webserver受到威胁，拥有根用户所有权的文件将导致整个系统受到威胁)。所以我们会将<code class="fe oc od oe nt b">/var/www/html</code>目录中所有文件的所有权都更改为www-data用户(webserver的根目录！).再次查看目录的内容，现在我们可以看到文件拥有www-data用户所有权！</p><p id="5437" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们都准备好了！让我们导航到<a class="ae lo" href="http://10.0.2.27/test.php," rel="noopener ugc nofollow" target="_blank"> http://10.0.2.27/test.php，</a>我们可以看到php信息页面，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi os"><img src="../Images/1faa9a7aec373c5ec82557c21759c796.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XbCFPZKsi2ekwRBa9tolw.png"/></div></div></figure><p id="6eb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到这个页面，因为这个test.php文件存在于<code class="fe oc od oe nt b">/var/www/html</code>目录中，我们不能从浏览动作中看到这个目录之外的任何文件。所以我们都准备好了！！我不会在这台机器上实现<a class="ae lo" href="https://www.imperva.com/learn/application-security/command-injection/" rel="noopener ugc nofollow" target="_blank">命令注入</a>漏洞或者<a class="ae lo" href="https://www.acunetix.com/blog/articles/local-file-inclusion-lfi/" rel="noopener ugc nofollow" target="_blank"> LFI </a>漏洞。正如我已经提到的，这个博客只是每个想开发/创建一个盒子但不知道如何开始的人的一个基础，你明白我的意思。但是，我强烈建议您到此为止，至少尝试对那些提到的漏洞做一些研究(这两个只是其中的一小部分！！)并尝试自己实现。玩它，直到它开始工作，然后<em class="nr">你会看到奇迹</em>。</p><p id="2e05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们已经完成了FTP服务器和Web服务器的设置，现在剩下的就是设置SSH服务器了。首先检查系统上安装的ssh版本，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="ea1d" class="nx lz iq nt b gy ny nz l oa ob">sshd --version</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/e61a27b96e2af7b96ffdc0b495a1f091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*aj28e5M0-hxrcA3LbzXbVg.png"/></div></figure><p id="3aac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个命令检查系统上安装的ssh的版本，或者检查它是否安装在系统上。阅读更多关于SSHD的信息。</p><p id="b803" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然已经安装了，让我们继续从端口22(SSH服务的默认端口)启用流量，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="3be1" class="nx lz iq nt b gy ny nz l oa ob">ufw allow ssh<br/>ufw status</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/35730db05742a2fb796da924123801f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*15UefzZvOGwaBf3UWsbYNw.png"/></div></figure><p id="b780" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个命令将允许来自端口22的流量，第二个命令将检查防火墙的状态，我们可以看到我们的规则被正确添加。我们配置SSH服务器的工作已经完成。</p><p id="3cfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们尝试在kali box上使用ssh客户端访问<strong class="jp ir"> hellfire </strong>用户，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="196e" class="nx lz iq nt b gy ny nz l oa ob">ssh kali@10.0.2.27</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ov"><img src="../Images/235d30dbf314b39515075f23f08bf8f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZkUu2_C4c1IT5ru53ala8w.png"/></div></div></figure><p id="329c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SSH客户端将提示我们输入用户密码，提供密码，我们就可以登录了！所以这意味着我们的用户也可以通过ssh登录(HURRAYYY)。现在，我鼓励你尝试创建2-3个用户，并尝试自己登录，以获得开发者的感觉(即使是一点点！)或者您甚至可以为您的用户配置<strong class="jp ir"> SSH基于密钥的认证</strong>(试试吧！这真的很有趣，相信我！).</p><h1 id="ec18" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">出口设备</h1><p id="860d" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy nn ka kb kc no ke kf kg np ki kj kk ij bi translated">现在，这将是一个简单的过程，因为你只需要将你的系统导出到一个. ova文件，你可以通过互联网或者你的黑客朋友发送到pwn。现在关闭你的ubuntu系统，因为我们需要导出它。现在，按照下面的步骤导出系统，</p><ul class=""><li id="5702" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">文件→导出设备→要导出的虚拟机(选择您刚配置的ubuntu机器)→设备设置(格式应为Open Virtualization Format 1.0，然后用所需的名称和位置保存文件。让复选框保持原样)→完成！！！！</li></ul><h1 id="cd22" class="ly lz iq bd ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv bi translated">笔记</h1><p id="b06b" class="pw-post-body-paragraph jn jo iq jp b jq mw js jt ju mx jw jx jy nn ka kb kc no ke kf kg np ki kj kk ij bi translated">附注:这里是我忘记附在博客末尾的注释，</p><pre class="km kn ko kp gt ns nt nu nv aw nw bi"><span id="aa90" class="nx lz iq nt b gy ny nz l oa ob">## Change root user password<br/>- sudo -i passwd root</span><span id="50de" class="nx lz iq nt b gy ow nz l oa ob">## Switch to root user<br/>- su root</span><span id="a9dd" class="nx lz iq nt b gy ow nz l oa ob">## add root user flag<br/>- echo 'root_flag' | md5sum &gt; /root/root.txt<br/>- chmod 600 /root/root.txt</span><span id="578e" class="nx lz iq nt b gy ow nz l oa ob">## add user flag<br/>- echo 'user_flag' | md5sum &gt; /home/user/user.txt<br/>- chmod 660 /home/user/user.txt</span><span id="9eb7" class="nx lz iq nt b gy ow nz l oa ob">### You can create other users like testuser1, testuser2<br/>- adduser testuser1<br/>- adduser testuser2</span><span id="4018" class="nx lz iq nt b gy ow nz l oa ob">## Install uncomplicated firewall (ufw)<br/>- apt install ufw<br/>- ufw enable<br/>- ufw status</span><span id="6452" class="nx lz iq nt b gy ow nz l oa ob">## Install FTP server<br/>- apt install vsftpd<br/>- cp /etc/vsftpd.conf /etc/vsftpd.conf.orig  #(use sudo before the command if not root)</span><span id="4d78" class="nx lz iq nt b gy ow nz l oa ob">### add these lines in the /etc/vsftpd.conf file:<br/>- anonymous_enable=YES         #Allow anonymous login FTP (Disabled by Default)                                             <br/>- anon_root=/var/ftp           #Directory for FTP                                             <br/>- no_anon_password=YES         #Stop prompting password</span><span id="d735" class="nx lz iq nt b gy ow nz l oa ob">-&gt; save file and exit.</span><span id="5bd4" class="nx lz iq nt b gy ow nz l oa ob">- mkdir /var/ftp          #Now make a ftp directory in /var                                                  <br/>- chown nobody:nogroup ftp/ #changing owner of ftp dirctory to nobody:nogroup                                                <br/>- cd ftp; touch file.txt; chown nobody:nogroup file.txt   #change directory; create a new file; assign new permissions<br/>- ufw allow 20/tcp; ufw allow 21/tcp     #allow ftp traffic for tcp port 20,21</span><span id="74f1" class="nx lz iq nt b gy ow nz l oa ob">### enable vsftpd service<br/>- sudo service vsftp start     #enable vsftp service                                              <br/>- service vsftpd start         #if running as root</span><span id="16d7" class="nx lz iq nt b gy ow nz l oa ob">-&gt; Now login as anonymous user on ftp user and see that there will be a file named file.txt present.</span><span id="9ea0" class="nx lz iq nt b gy ow nz l oa ob">## Configure Apache HTTP server<br/>- ufw allow http (or)<br/>- ufw allow 80/tcp       #allow ftp traffic for tcp port 80                                                   <br/>- ufw status             #check status of firewall                                                   <br/>- apt update             #update packages before installing apache2                                                  <br/>- apt install apache2    #install apache2 on server</span><span id="be92" class="nx lz iq nt b gy ow nz l oa ob">### install PHP<br/>- apt install software-properties-common    #configure repository on system                                <br/>- add-apt-repository ppa:ondrej/ppa         #adding ondrej php repo on ubuntu system                                <br/>- apt update                                #update packages before installing                                <br/>- apt install -y php7.4                     #install php7.4 on ubuntu system</span><span id="fbee" class="nx lz iq nt b gy ow nz l oa ob">-&gt; Navigate to <a class="ae lo" rel="noopener ugc nofollow" target="_blank" href="/$IP">http://$IP</a> and you will be presented with Apache2 Ubuntu Default Page. Now to create a test.php page, do:</span><span id="2466" class="nx lz iq nt b gy ow nz l oa ob">- echo '&lt;?php phpinfo(); ?&gt;' &gt; test.php         #simple php page to run on web pages                                <br/>- chown -R www-data:www-data /var/www/html      #webserver files must belong to user and group www-data:www-data not the root:root user</span><span id="ae92" class="nx lz iq nt b gy ow nz l oa ob">-&gt; Now visit <a class="ae lo" href="http://$IP/test.php" rel="noopener ugc nofollow" target="_blank">http://$IP/test.php</a> and you'll presented with PHP info page. From there you can set RCE if you want.</span><span id="6997" class="nx lz iq nt b gy ow nz l oa ob">## Configure SSH<br/>- sshd --version        #check if openssh is installed by checking it's version                                                    <br/>- ufw allow ssh (or)<br/>- ufw allow 22/tcp      #allow ftp traffic for tcp port 22</span><span id="420a" class="nx lz iq nt b gy ow nz l oa ob">-&gt; Now test if you can login as testuser1/testuser2/root user via ssh service.</span><span id="880a" class="nx lz iq nt b gy ow nz l oa ob">## Export the VM to an OVA format</span><span id="628d" class="nx lz iq nt b gy ow nz l oa ob">- Now after machine is tested and working as intented we can export it into OVA format in Virtual Box.<br/>- Go into:<br/>---- File &gt; Export Appliance<br/>---- Then select your vulnerable machine in this case mine is Ubuntu 20.04 Server <br/>---- Choose Open Virtualization Format 1.0<br/>---- Name the file you want to save<br/>---- Click 'Export'</span><span id="c768" class="nx lz iq nt b gy ow nz l oa ob">=&gt; You just made your first CTF box.</span></pre></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="f6b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，你现在感觉如何，你这个了不起的<strong class="jp ir">黑客+创造者</strong>？写这篇博客花了我很多时间，老实说，花了我大约9-10个小时。我希望这个博客将成为你们中一些正在尝试/思考创造一个盒子的人的一个起点。随着你在玩CTF时获得经验，你最终会开始知道如何在机器上实现X漏洞，但这并不意味着你会成为在机器上实现它们的专家，但事实是，在机器上实现需要耐心和研究。就像我做研究一样，我从来没有认真想过有一天我会做一个盒子(这是我过去的梦想)，但你知道，就是这样。我(和我的朋友)花了两个半月的时间来创造这个盒子。我所有的压力，研究各种事情的困难，这个博客是所有的总结。</p><p id="e1f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我写这篇博客的时候，这里的时间是凌晨3点33分，我真的很累，所以我现在要放下笔了。好了，朋友们，好好照顾自己，保持水分，保持健康，我们很快会再见的。再见。日安。(:</p></div></div>    
</body>
</html>