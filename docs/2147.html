<html>
<head>
<title>Telangana, Andhra Pradesh, Karnataka, Himachal Pradesh &amp; Kerala — All Government bus services were hacked</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">特伦甘纳邦、安得拉邦、卡纳塔克邦、喜马偕尔邦和喀拉拉邦——所有政府公共汽车服务都遭到黑客攻击</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/telangana-andhra-pradesh-karnataka-himachal-pradesh-kerala-all-government-bus-services-were-885b44c21a?source=collection_archive---------2-----------------------#2022-06-21">https://infosecwriteups.com/telangana-andhra-pradesh-karnataka-himachal-pradesh-kerala-all-government-bus-services-were-885b44c21a?source=collection_archive---------2-----------------------#2022-06-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="621a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨黑客们！欢迎回到我的新报道。我的名字是克里希纳德夫·P·梅勒维拉。我是一个20岁自学成才的道德黑客。</p><p id="5784" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要了解我更多，请在谷歌上搜索我的名字。</p><p id="79af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天的报道是关于印度5个邦政府为其公路运输公司使用的订票软件。</p><p id="4147" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以不浪费时间，让我们开始吧。</p><blockquote class="kl km kn"><p id="65fb" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">漏洞:IDOR和敏感信息泄露</p><p id="2fc2" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">影响:关键</p><p id="577b" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">风险:数据泄露和不正确的身份验证</p><p id="3cad" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">优先级:P0</p><p id="70be" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">范围:电子邮件、电话、PNR、预订ID等..泄露，取消其他用户的票，获取其他用户的票等…</p></blockquote><p id="7b18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在攻击者视点中复制的步骤:<br/> 1。在ksr TC(<a class="ae ks" href="https://online.keralartc.com/" rel="noopener ugc nofollow" target="_blank">https://online.keralartc.com/</a>)<br/>上注册一个账号2。然后用新创建的id登录并访问https://online.keralartc.com/oprs-web/print/tickets.do?的链接<br/>id=5545107 </p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/18a1e517536b8c6d698ff90e9a79f9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/0*MViK0BX__vafQBqc"/></div></figure><p id="5c47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。无需任何身份验证，您就可以看到票证详细信息。通过更改URL上的“Id”参数，我们还可以看到其他用户的票证。(也就是说id是</strong><a class="ae ks" href="https://online.keralartc.com/oprs-web/print/tickets.do?id=5545107" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">5545107</strong></a><strong class="jp ir">通过改变到任何一个数字附近我们都可以看到那个用户的票。).id为5545109的车票如下图为证。</strong></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/5b3aeb54c746eda89a25a98a79196bbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/format:webp/1*caDYupx_uihu_XBHbv8_Ig.png"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="a5a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在是下一个环节——取消机票</strong></p><ol class=""><li id="240f" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated"><strong class="jp ir">首先，获取攻击者要取消其机票的所有受害者详细信息。细节如PNR号，Txn。密码、手机号码(这三个只有注销才需要)</strong></li><li id="72db" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated"><strong class="jp ir">此处Txn。密码和PNR可直接从第一部分漏洞获得。现在我们只需要受害者的手机号码。</strong></li><li id="950e" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated"><strong class="jp ir">按照以下步骤获取受害者的手机号码。</strong></li><li id="852c" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated">在票证的最后一页(我们从第一部分中提取了受害者票证)，有一个名为“发送短信/电子邮件”的选项。点击它，在一个像burp suite 这样的网络拦截工具上拦截请求</li></ol><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/c1cb7385897ab17cd6d12a002515fcd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*TM-VbUaa7Dz41XuyIHIibQ.png"/></div></figure><pre class="ku kv kw kx gt ly lz ma mb aw mc bi"><span id="550a" class="md me iq lz b gy mf mg l mh mi"><strong class="lz ir">GET /oprs-web/booking/ticket/sendSMS.do?id=&lt;REDACTED&gt;&amp;mobileNo=&lt;REDACTED&gt; HTTP/2<br/>Host: online.keralartc.com<br/>Cookie: &lt;REDACTED&gt;<br/>Upgrade-Insecure-Requests: 1<br/>User-Agent: &lt;REDACTED&gt;<br/>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br/>Sec-Gpc: 1<br/>Sec-Fetch-Site: same-origin<br/>Sec-Fetch-Mode: navigate<br/>Sec-Fetch-User: ?1<br/>Sec-Fetch-Dest: document<br/>Referer: https://online.keralartc.com/oprs-web/print/tickets.do?id=&lt;REDACTED&gt;<br/>Accept-Encoding: gzip, deflate<br/>Accept-Language: en-GB,en;q=0.9</strong></span></pre><p id="06aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。在这个请求中，我们可以看到名为“mobileNo”的参数，它显示了受害者的手机号码。(出于安全原因，本文中的&lt;被编辑为&gt;。)</strong></p><p id="a63f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6。现在我们有了取消受害者机票的所有证据。</p><p id="97d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 7。现在访问</strong><a class="ae ks" href="https://online.keralartc.com/oprs-web/guest/ticket/cancel.do" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://online . keralartc . com/oprs-web/guest/ticket/cancel . do</strong></a><strong class="jp ir">并输入我们所有的三个详细信息(PNR、TXN密码、手机号码)并点击搜索。</strong></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/5669bd059fd655f7bbad79c3a3b04ec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*7o_0FwlW2wKbdrOdLDRteg.png"/></div></figure><p id="990c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在我们可以看到受害者的全部细节。还有一个取消的选项...如果我们点击，受害者的机票将被取消。</strong></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="0f88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这款网络应用在印度的5个邦的公路运输公司中很常见——特伦甘纳邦、安得拉邦、卡纳塔克邦、喜马偕尔邦和喀拉拉邦。所以漏洞也很普遍。</p><p id="7851" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">报告并修补漏洞。</p><p id="da02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想知道更多关于我的信息，只需在谷歌上搜索:“克里希纳德夫·梅莱维拉”</p><p id="ab7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有，</p><p id="51d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ko">别忘了在medium等社交媒体上关注我。也请为这篇文章鼓掌50次，这是我写更多的灵感！！</em>T13】</strong></p><p id="43cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我需要你的支持来写更多，请给我买杯咖啡吧:<a class="ae ks" href="https://www.buymeacoffee.com/krishnadevpm" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/krishnadevpm</a></p><p id="46ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的Instagram手柄:</em><a class="ae ks" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://instagram.com/krishnadev_p_melevila</em></a></p><p id="5b17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的推特手柄:</em><a class="ae ks" href="https://twitter.com/Krishnadev_P_M" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://twitter.com/Krishnadev_P_M</em></a></p><p id="76f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的LinkedIn手柄:</em><a class="ae ks" href="https://www.linkedin.com/in/krishnadevpmelevila/" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://www.linkedin.com/in/krishnadevpmelevila/</em></a></p><p id="31c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的人事网站:</em><a class="ae ks" href="http://krishnadevpmelevila.com/" rel="noopener ugc nofollow" target="_blank"><em class="ko">http://krishnadevpmelevila.com/</em></a></p></div></div>    
</body>
</html>