<html>
<head>
<title>Illegal Rendered at Download Feature in Several Apps (including Opera Mini) that Lead to Extension Manipulation (with RTLO)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">几个应用程序(包括Opera Mini)的下载功能非法渲染，导致扩展操作(与RTLO)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/illegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51?source=collection_archive---------0-----------------------#2019-10-26">https://infosecwriteups.com/illegal-rendered-at-download-feature-in-opera-mini-that-lead-to-extension-manipulation-with-rtlo-685bf2d77d51?source=collection_archive---------0-----------------------#2019-10-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2172" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当你下载一个看起来“合法”的文件，但是当你运行这个文件时，它却改变了。</h2></div><p id="db56" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">بسم الله الرحمن الرحيم</p><p id="0d4e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">更新一(2020年1月21日):</strong> Opera已回复邮件并确认报告的问题。那一次，Opera也为他们的延迟回应道歉。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/dad0630aa8758e10e42e570c2d31205b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YdvEQth-JQjOpkFM_82z6Q.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">歌剧的回应</figcaption></figure><p id="a9b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">更新二(2020年2月27日):</strong> Opera通知是否Opera Mini 47已经发布，正在铺开50%。他们也提供很好的HoF(我还没有提供需要的信息)。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><pre class="lc ld le lf gt ly lz ma mb aw mc bi"><span id="bca4" class="md me iq lz b gy mf mg l mh mi">S<em class="mj">o, let say you download the .png file. But when you try to open it, the file will be executed as a malicious .apk file. </em> <em class="mj">Yes, this happens at least in Opera Mini and few applications that have download feature.</em></span><span id="d305" class="md me iq lz b gy mk mg l mh mi"><em class="mj">As a little note, we also added few simple bug hunting tips related this RTLO things at the end of article.</em></span></pre></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="3a0a" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">I. TL速度三角形定位法(dead reckoning)</h2><p id="a81e" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">将文件名改为:恶意<rtlo_char> <fake_ext>。<real_ext> <br/>例如:<strong class="kh ir">恶意%E2%80%AEtxt.apk </strong></real_ext></fake_ext></rtlo_char></p><p id="c483" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当浏览器下载功能无法完美解析字符时，文件名将更改为<strong class="kh ir"> maliciouskpa.txt </strong></p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nh ni l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">在Opera Mini(Android版)下载功能中非法渲染RTLO角色</figcaption></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="190f" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">二。介绍</h2><p id="b9a3" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">正如我们所知，大多数已开发的浏览器都具有可供用户下载任何文件的功能。但有时当浏览器无法解析用作文件名(在下载功能上)或URL的字符时，会出现问题。</p><p id="07f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们发现有些浏览器无法完美呈现RTLO字符，攻击者可以利用这个问题来自动操纵文件名。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="2b96" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2.1。关于RTLO的几个字</strong> <br/>老实说，我们无法从技术角度或处理字符的标准上很好地解释这一点。但是，一般我们知道，这个世界的人物分为两种模式，分别是<strong class="kh ir">从左到右</strong>和<strong class="kh ir">从右到左</strong>人物。我们在这个世界上知道的著名的<strong class="kh ir">从右到左</strong>读法是阿拉伯文字。</p><p id="6ae8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于一些参考资料，有一个标准的方法被用来处理从右向左书写的文本。基本上，这允许计算机交换信息，不管使用什么语言。</p><p id="77e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，简而言之，通过使用这种方法，计算机将识别已经输入的字符。</p><p id="de89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参考资料:<br/><a class="ae nj" href="https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/https://krebsonsecurity.com/2011/09/right-to-left-override-aids-email-attacks/" rel="noopener ugc nofollow" target="_blank">https://krebsonsecurity . com/2011/09/right-to-left-override-AIDS-email-attacks/https://krebsonsecurity . com/2011/09/right-to-left-override-AIDS-email-attacks/</a><br/><a class="ae nj" href="https://blog.malwarebytes.com/cybercrime/2014/01/the-rtlo-method/" rel="noopener ugc nofollow" target="_blank">https://blog . malware bytes . com/cyber crime/2014/01/the-rtlo-method/</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="e6ac" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated"><strong class="ak">三。测试环境</strong></h2><p id="5645" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">比如我们以Opera为例(因为有些节目要求不发布全披露)。</p><p id="e675" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们用来重现这个问题的环境:</p><ul class=""><li id="5486" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated"><strong class="kh ir">用过的设备</strong>:华硕Max Pro M1 (4/64GB)</li><li id="8847" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">操作系统</strong>:Android 9(2019年5月1日更新)</li><li id="e1ef" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">【Android版Opera Mini:44 . 1 . 2254 . 142553(2019年8月29日构建)——我们报道的版本(因为我们超过一个月没有得到回应——<em class="mj">让我们假设如果从他们的角度来看它没有触及安全栏</em>——那么我们认为这将有利于发布文章)。<br/>最新版本(2019年9月19日- 44.1.2254.143214)也仍然存在漏洞。</li><li id="fde8" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">更新III(2020年06月06日)</strong>:此问题触及安全栏，Opera已修复此问题，如本文第一部分所提供的信息。</li></ul></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="1558" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">四。复制步骤</h2><p id="2065" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">例如，攻击者想要将此场景“发送”给受害者:</p><ul class=""><li id="7813" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated">攻击者的<strong class="kh ir">原</strong>文件类型为:. txt。</li><li id="6eda" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">攻击者的<strong class="kh ir">文件名</strong>为:恶意</li><li id="9c4e" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">在这种情况下，攻击者<strong class="kh ir">想要操纵</strong>扩展名，因此受害者会将文件视为图像格式(扩展名为. png)。在这种情况下，攻击者会给文件名加上:<strong class="kh ir">恶意%E2%80%AEgnp.txt </strong>。</li><li id="1369" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">当该文件被易受攻击的浏览器(在这种情况下，Opera Mini)下载时，该文件将在受害者的设备上保存为:<strong class="kh ir">malicioustxt.png</strong>。</li><li id="e4d2" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">即使这个文件保存为. png格式，Android仍然会以。txt(因为<strong class="kh ir">原来的格式是</strong>。txt，不是。png)。</li><li id="8259" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">当然，我们也可以对其他影响不好的人这样做。比方说，最初的扩展名是。apk，所以我们用。txt或其他正常扩展名。</li></ul><p id="67ba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，<strong class="kh ir"> %E2%80%AE </strong>字符是用作<strong class="kh ir"> RTL覆盖</strong><a class="ae nj" href="https://www.charbase.com/202e-unicode-right-to-left-override" rel="noopener ugc nofollow" target="_blank">https://www . char base . com/202 e-unicode-right-to-left-Override</a>的<strong class="kh ir"> unicode U+202E </strong></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="42af" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">动词 （verb的缩写）PoC视频</h2><p id="32b5" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">为了补充说明，我们添加了一个简单的PoC视频来展示这种情况:</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="nh ni l"/></div></figure><ul class=""><li id="8253" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated">GDrive上有2个文件，即。txt文件(在左边)和。右边是apk(文件)；</li><li id="a3d4" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">在这种情况下，我们采取了直接下载链接。所以当用户想下载文件时，他们会看到被RTLO字符操纵过的扩展名；</li><li id="22ca" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">视频中的<strong class="kh ir">第一种情况</strong>，用户将下载。txt文件，但该文件将被保存为png。当<strong class="kh ir">用户想要打开</strong>下载的文件时，文件<strong class="kh ir">将被执行为。txt </strong>(原格式)；</li><li id="a383" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">视频中的<strong class="kh ir">第二种情况</strong>，用户将下载。apk文件，但该文件将被保存为txt。同样，当<strong class="kh ir">用户想要打开</strong>下载的文件时，<strong class="kh ir">文件将作为。apk </strong>并尝试安装程序(原始格式)。</li></ul></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="8111" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">不及物动词截图详情</h2><p id="1923" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">在下面的截图中，我们可以看到Opera Mini是否将扩展渲染为。png为原。txt文件(左边的文件)并将扩展名呈现为。txt为真实。apk文件(右图)。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ny"><img src="../Images/3cc0bf3b2f33d27bebe98d45c54e29b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xWhzcUqeHpKipZD0Qc25QA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">下载为。png(左一)并下载为。txt(右一)</figcaption></figure><p id="b37b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们试图打开一个名字为<strong class="kh ir">malicioustxt.png</strong>的文件时(上图左边的)，Android会将其识别为一个. txt文件(原始格式)。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/8664a870c5da71b0fc925d93ee50ed75.png" data-original-src="https://miro.medium.com/v2/resize:fit:508/format:webp/1*2_MRekAPFWCzIRxOMhVoPA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">Android将该文件识别为。即使名字是。png</figcaption></figure><p id="fc33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而对于文件名为<strong class="kh ir"> OMkpa.txt </strong>的文件，那么Android会执行为。apk格式。从Opera想装程序的行为就可以看出来。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/ce89cca49c6889f6dd950eabc572abbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:500/format:webp/1*CMRbewbY5R-IrQtkv_fi_w.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">Opera Mini正在尝试安装软件</figcaption></figure></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="b7ac" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">七。报告时间表</h2><p id="975e" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">Android版Opera Mini浏览器:</p><ul class=""><li id="ec26" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated"><strong class="kh ir">2019年9月10日:</strong>经<a class="ae nj" href="https://security.opera.com/report-security-issue/" rel="noopener ugc nofollow" target="_blank">https://security.opera.com/report-security-issue/</a>到达歌剧院。通过这条线报告可能是一个错误，因为你不会收到任何确认。我们建议您通过应用程序中的“报告问题功能”进行报告:</li></ul><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/aa7acbd4f9d08729aa7e5227d7ef9ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*9cqpZ-XNdNgJ_vz9WeFg5Q.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">应用内的“报告问题”功能</figcaption></figure><p id="ef9a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使你仍然没有收到反馈，那么至少你知道你的邮件已经到达他们那里(因为他们的自动回复)。</p><ul class=""><li id="1014" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated"><strong class="kh ir">2019年9月10日:</strong> Opera看了几次PoC视频。</li><li id="05b5" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">2019年9月23日:</strong>试图联系他们询问情况，仍未得到任何信息。(也许他们现在真的很忙，或者从他们的角度来看，这没有触及安全栏)。</li><li id="e4d6" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">注意:</strong>之前我们以为在最新发布版本(2019 . 9 . 19)中是否修复了这个问题。但当我们几天前试图再次重现该问题时，我们发现它仍然容易受到攻击。不知道为什么它能工作，但不知何故却不能。</li><li id="030f" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">2019年10月30日:</strong>指定为CVE-2019–18624。</li><li id="f9c5" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">更新一:</strong>2020年1月21日:Opera已回复邮件并确认报告的问题。那一次，Opera也为他们的延迟回应道歉。</li><li id="5774" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">更新二:</strong>2020年2月27日:Opera通知Opera Mini 47是否已经发布，正在铺开50%。他们也提供很好的HoF(我还没有提供需要的信息)。</li></ul></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="f650" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简单地说，我们也向一个知名平台上我们最喜欢的bug bounty程序报告了这个类似的问题。和往常一样，他们不需要询问他们的状态，就能非常迅速地回应和解决问题(并给予丰厚的回报)。到目前为止，他们总是1天回应，5天改善。</p><ul class=""><li id="9b59" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated"><strong class="kh ir">2019年7月22日:</strong>某知名平台报道</li><li id="2329" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated"><strong class="kh ir">2019年7月24日:</strong>为迟到的回复道歉(因为通常他们只需要1天，而这次需要2天——很酷，不是吗？).</li></ul><p id="7c1d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们很快就解决了问题(在接下来的几天里)，并给了一笔可观的奖金(像往常一样)。</p><p id="7c70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，我们也向其他计划报告此事，并在9天内获得有良好积分的回应。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="ef4e" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">八。闭幕</h2><p id="fcbc" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">在这篇文章中，我想感谢Rafay Baloch 。<a class="ae nj" href="https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html" rel="noopener ugc nofollow" target="_blank">从他在2016年写的一篇</a>(涉及谷歌Chrome和Firefox for Android通过使用IP+RTL的组合进行地址栏欺骗)中，我可以了解到这个RTLO的事情。</p><p id="1628" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个学分:</p><ul class=""><li id="b06d" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated">HackerOne的文件上传功能中的RTLO:<a class="ae nj" href="https://hackerone.com/reports/298" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/298</a></li><li id="2e77" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">在HackerOne的重定向功能中使用RTLO进行域名欺骗:<a class="ae nj" href="https://hackerone.com/reports/299403" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/299403</a></li></ul><p id="f164" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一个附加信息，如果你想尝试重现这个问题，那么这里是Android的Opera Mini的受影响版本:</p><ul class=""><li id="f53f" class="nk nl iq kh b ki kj kl km ko nm ks nn kw no la np nq nr ns bi translated">版本44 . 1 . 2254 . 143214(2019年9月19日发布):<a class="ae nj" href="https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.143214-APK" rel="noopener ugc nofollow" target="_blank">https://apk pure . com/opera-mini-fast-we B- browser/com . opera . mini . native/variant/44 . 1 . 2254 . 143214-APK</a></li><li id="2aa1" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">版本44 . 1 . 2254 . 142659(2019年9月3日发布):<a class="ae nj" href="https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142659-APK" rel="noopener ugc nofollow" target="_blank">https://apk pure . com/opera-mini-fast-we B- browser/com . opera . mini . native/variant/44 . 1 . 2254 . 142659-APK</a></li><li id="66f2" class="nk nl iq kh b ki nt kl nu ko nv ks nw kw nx la np nq nr ns bi translated">版本44 . 1 . 2254 . 142553(2019年8月29日发布)<a class="ae nj" href="https://apkpure.com/opera-mini-fast-web-browser/com.opera.mini.native/variant/44.1.2254.142553-APK" rel="noopener ugc nofollow" target="_blank">https://apk pure . com/opera-mini-fast-we B- browser/com . opera . mini . native/variant/44 . 1 . 2254 . 142553-APK</a></li></ul></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><h2 id="f0ec" class="md me iq bd ml mm mn dn mo mp mq dp mr ko ms mt mu ks mv mw mx kw my mz na nb bi translated">九。与RTLO事物相关的捕虫技巧</h2><p id="c8d7" class="pw-post-body-paragraph kf kg iq kh b ki nc jr kk kl nd ju kn ko ne kq kr ks nf ku kv kw ng ky kz la ij bi translated">从这篇非常简单文章中，我们可以得出结论，如果RTLO的东西可能成为各种特性的安全问题(甚至不是每个程序都这样认为，但值得一试)。此时我们能想到的是:</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="359d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.1。在这种情况下，我们可以测试应用程序的上传功能是否容易受到扩展操作的攻击。<br/>此外，当我们谈论“文件名”和“上传功能”时，它不仅限于一个web应用程序，因为它也可能“用于”信息、电子邮件和其他具有上传功能的类似应用程序。<br/> <strong class="kh ir">参考(hacker one)</strong>:<a class="ae nj" href="https://hackerone.com/reports/298" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/298</a><br/><strong class="kh ir">参考(电报)</strong>:<a class="ae nj" href="https://securelist.com/zero-day-vulnerability-in-telegram/83800/" rel="noopener ugc nofollow" target="_blank">https://securelist . com/zero-day-vulnerability-in-Telegram/83800/</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="636c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 9.2。RTLO在filename via cloud drive storage</strong><br/>与前一个类似，只是尝试将包含RTLO名字的文件上传到cloud drive storage，然后看看会发生什么。<br/> <strong class="kh ir">参考(黄牛App套件)</strong>:<a class="ae nj" href="https://hackerone.com/reports/210354" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/210354</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="a478" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.3。聊天功能中的RTLO<br/>它也可以在每个有聊天功能的应用程序中测试(不仅仅是一个本地聊天应用程序)。在它的实现中，它可以用来切换扩展或者创建一个假的URL，例如:<em class="mj">https://evil.com/RTLO/moc.rettiwt</em>。如果脆弱，不知何故它会切换到<em class="mj">twitter.com/moc.live//:sptth</em>。(这件事发生在脸书bug报告聊天会上)。</p><p id="12ea" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在其他情况下，它也只是将后面的东西切换到前面(就像Chrome和Firefox上的<a class="ae nj" href="https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html" rel="noopener ugc nofollow" target="_blank">地址栏通过IP+RTL欺骗</a>)。<br/> <strong class="kh ir">参考(Snapchat)</strong>:<a class="ae nj" href="https://hackerone.com/reports/196222" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/196222</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="45a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.4。除了聊天功能之外，我们还可以在一个有帖子功能的应用程序中测试这一点。在GitLab的例子中，RTLO问题适用于描述领域。从这里，我们还可以得出结论，如果这个RTLO问题可以在每一个有能力张贴诸如“网站地址”信息、张贴回复等内容的应用程序中工作。<br/> <strong class="kh ir">参考(git lab)</strong>:<a class="ae nj" href="https://gitlab.com/gitlab-org/gitlab-foss/issues/29365" rel="noopener ugc nofollow" target="_blank">https://gitlab.com/gitlab-org/gitlab-foss/issues/29365</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="8428" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 9.5。RTLO在《警告》中的重定向功能</strong> <br/>这个RTLO的东西也可能被用来试图恶搞域名与普通拉丁文(LTR)和RTLO字符的结合。<br/> <strong class="kh ir">参考(hacker one)</strong>:<a class="ae nj" href="https://hackerone.com/reports/299403" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/299403</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="5cd2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 9.6。RTLO在浏览器的地址栏</strong> <br/>从Rafay的一篇文章中，我们可以看出他是否成功地通过IP地址和RTLO字符的组合盗用了域名。例如:<em class="mj">https://evil _ IP _ Address/RTLO/Google . com/log in</em>成为【google.com/login/RTLO/evil_IP_Address.】<br/><strong class="kh ir">参考(谷歌Chrome和火狐for Android)</strong>:<a class="ae nj" href="https://www.rafaybaloch.com/2017/06/google-chrome-firefox-address-bar.html" rel="noopener ugc nofollow" target="_blank">https://www . rafaybaloch . com/2017/06/Google-Chrome-Firefox-Address-bar . html</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="6cd6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">9.7。RTLO在浏览器的下载功能 <br/>这个例子已经在这篇简单的文章中解释过了。作为一个注意，<strong class="kh ir">对于“浏览器”的东西，它并不局限于</strong>只有原生浏览器的下载功能。还有<strong class="kh ir">应用内浏览器</strong>(例如，存在于<strong class="kh ir">消息应用</strong>的浏览器)以及<strong class="kh ir">少数密码管理器应用</strong>(也就是说，它们大多也有应用内浏览器)。<br/> <strong class="kh ir">参考(Opera Mini for Android) </strong>:本文或<a class="ae nj" href="http://firstsight.me/2019/10/illegal-rendered-at-download-feature-in-several-apps-including-opera-mini-that-lead-to-extension-manipulation-with-rtlo/" rel="noopener ugc nofollow" target="_blank">http://first sight . me/2019/10/launch-rendered-at-download-feature-in-number-apps-including-Opera-Mini-tha-lead-to-extension-manipulation-with-rtlo/</a></p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="c662" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mj">关注</em> <a class="ae nj" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mj"> Infosec报道</em> </a> <em class="mj">获取更多此类精彩报道。</em></p><div class="oc od gp gr oe of"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd ir gy z fp ok fr fs ol fu fw ip bi translated">信息安全报道</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">medium.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot ll of"/></div></div></a></div></div></div>    
</body>
</html>