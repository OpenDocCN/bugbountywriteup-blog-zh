# OTP 登录速率限制旁路——初学者能找到的最简单的 bug。

> 原文：<https://infosecwriteups.com/otp-login-rate-limit-bypass-the-easiest-bug-beginners-could-find-638681bed95e?source=collection_archive---------0----------------------->

朋友们好，

今天我要写的是一个漏洞，它可能会激励一些正在努力寻找第一个 bug 的初学者。这就是“OTP 登录速率限制旁路”。如果你是 bug bounty 的初学者，我建议你测试一下这种问题，与其他技术 bug 相比，这种问题更容易发现。搜索允许用户使用 OTP 登录的 web 应用程序或移动应用程序。

我搜索了印度的创业网络应用程序，幸运的是我能够找到一些允许以这种方式登录的应用程序。这篇文章是关于这样一个发现和我遵循的方法。

因此，我选择了这个特定的 web 应用程序，在登录页面上，我输入了我的手机号码并请求了一次性密码。我在手机上收到了一个 6 位数的号码，但在打开 Firefox 浏览器的网络选项卡以监控 web 请求后，我试图在应用程序中输入错误的 6 位数。我收到一条错误消息，上面写着“无效的动态口令”。我将同一个无效的 OTP 重新发送了几次，以检查是否有任何速率限制。不出所料，在尝试了 8 次之后，我开始收到“超过尝试次数”的消息。然后，我将请求转发到打嗝中继器，并开始篡改每个参数。我注意到一个名为 udid 的头，它的值是随机数。我确信标题是用户的某种标识。我在该值上添加了一些随机数，并发出了请求。就是这样！！

![](img/4b584f2930ab35252ae96134068d59dc.png)

我再次收到错误信息，显示“无效的动态口令”，而不是“超过尝试次数”的信息。在每个请求中给 udid 头的值赋予任意一个随机数都绕过了速率限制。因此，利用这个漏洞，我可以为受害者的帐户请求一个 OTP，并不断输入完整的 6 位数字，直到我找到正确的一个。使用打嗝入侵工具很容易做到这一点。

我马上上报了。

**修复和旁路**

该公司很快修复了该漏洞，因此更改 udid 将不再有效。他们让我再测试一次。然后我试着切换我的 IP 地址，检查速率限制是否基于 IP 地址。但是没有用。然后我又开始篡改参数。我在手机号码里编码了国家代码，没用。我在手机号码之间加了空格，但也没用。后来，我在手机号码的末尾加了空格，结果成功了。因此，在手机号码末尾为每个请求添加一个空格将绕过速率限制。我再次报告了这个问题，后来问题得到了解决。因为发现了这个安全问题，我收到了公司的奖励。