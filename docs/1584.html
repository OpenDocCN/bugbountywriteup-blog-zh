<html>
<head>
<title>HactivityCon 2021 CTF Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HactivityCon 2021 CTF报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hactivitycon-2021-ctf-writeup-23ae1f6f06e1?source=collection_archive---------1-----------------------#2021-09-19">https://infosecwriteups.com/hactivitycon-2021-ctf-writeup-23ae1f6f06e1?source=collection_archive---------1-----------------------#2021-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="059b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OPA秘密挑战(类别:网页，级别:硬)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/a77857a47e2fa1bbba1f77e8b3d15432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHnr4crCgkCwmm_A8aQzTw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">OPA秘密挑战赛</figcaption></figure><p id="9eef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤1: </strong>打开挑战，会出现一个登录屏幕。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lb"><img src="../Images/09301ac383c01b4c966ec203f721df24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oDL6cB_30hPBgGgrycSxIA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">登录屏幕</figcaption></figure><p id="b5ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:</strong>我们首先需要建立一个账户，以便访问OPA Secrets门户网站。所以，用任意的用户名和密码注册。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/eeec0e11fbbdb6680e9ea7c6129c0505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*NzqxsNKrQyg9Ij5fC1qZiA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">注册屏幕</figcaption></figure><p id="6ed9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:</strong>现在使用创建新账户时使用的凭证登录。</p><p id="25ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:</strong>登录后，会出现OPA Secrets仪表盘。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/4f44cacc836af6213130d342cfec5f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hm-EfxNnw9WxtqlpU34oMA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">OPA机密仪表板</figcaption></figure><p id="b1c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤5: </strong>仪表板上有两个选项卡，在“机密”选项卡中，它提供了创建和保存机密的功能。在访问Security选项卡时，它为我们提供了用于保护这个秘密的算法的信息。还提到了一个Github链接，在那里我们可以看到这个开源OPA Secrets算法的源代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/f74d8c34d19da793a4f968e916e300fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GGy9w5EYPhKshyQj03fRg.png"/></div></div></figure><p id="e573" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:</strong>打开github链接(<a class="ae le" href="https://github.com/congon4tor/opa_secrets" rel="noopener ugc nofollow" target="_blank">congon tor/opa _ secrets:Secret manager using Open Policy Agent(github.com</a>)打开<em class="lf"> app.py </em>脚本(opa_secrets/app/app.py)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/3a36b0f149ada169b04d1b892fa212db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G6_166jGC4ZOBMS9AqcpCw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">app.py脚本</figcaption></figure><p id="3d2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第七步:</strong>现在仔细观察剧本。我们可以看到已经创建了3个不同的用户(congon4tor、jellytalk、pinkykoala)。每个人都有自己唯一的id和指定的角色。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/b28b128c385aa0cd507e290357131f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QhPPod_UAK-K-tuyNoagqg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">创建的用户</figcaption></figure><p id="78d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到用户名为<em class="lf">congon tor</em>的用户是管理员，而其余2个用户是普通用户。我们还可以看到所有三个用户的密码(qwerty123，test，test)。但是解决这个挑战并不需要它。</p><p id="b018" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第八步:</strong>进一步观察代码，我们可以看到3个不同的秘密也被添加到各自的用户帐户。每个秘密都有唯一的id。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/386d12712cb86172139389287aec7ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fIJ6CZG4bGyNHPXL90UFqQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">具有唯一秘密id的秘密</figcaption></figure><p id="3c75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以注意到第一个秘密的名字是Flag，这表明它与我们的目标<em class="lf">即</em> flag{}有关。还要注意，与其他两个秘密不同，第一个秘密的值没有在明文中直接提及。</p><p id="7a96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第9步:</strong>现在，让我们转到我们创建的帐户的仪表板，创建一个密码并保存它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/724dd548552bdae1aa3bcc168b3fa945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BqbGk8SsxcJSfZ_47CBxOQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">秘密创作</figcaption></figure><p id="c4d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第10步:一旦创建了密码，它就会显示在我们的仪表盘中。还要记住，我们的秘密会像其他秘密一样被赋予一个唯一的id(参考步骤8)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lj"><img src="../Images/4ef95ed64bf2b63397f703f487a245c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Owt2uNEXSVym1nyLcB5QBw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">成功秘密创建后</figcaption></figure><p id="3411" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤11: </strong>可以看到，我们的秘密值被屏蔽了，为了以明文形式看到秘密，我们需要点击那个<em class="lf">眼</em>按钮。点击它，它将发送包括我们的秘密的唯一id的请求，并且作为响应，它将接收我们的秘密的值。</p><p id="abf3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第12步:我们需要启动Burpsuite来拦截这个请求。一旦设置好打嗝，点击<em class="lf">眼</em>按钮并拦截该请求。在拦截的请求中，我们可以看到我们的秘密的唯一id被发送。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lk"><img src="../Images/cbbb3de303d9d2d5433e49311723ffe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7DziyYwJfqWxGTc8Udd2gQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">用我们的秘密的唯一id拦截请求</figcaption></figure><p id="a622" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤13: </strong>现在只需用我们在<em class="lf"> app.py </em>脚本(我们在步骤8中看到的那个)<em class="lf">中找到的名称标志替换id值，即afce 78 a 8–23d 6–4f 07–81 F2–47 c 96 DDB 10 cf</em>并转发修改后的请求</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ll"><img src="../Images/bec3cdf3f47dc693d1058aa687e778b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hRISoBHijwXj-2lbP0Fauw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">id被替换的已编辑请求</figcaption></figure><p id="229a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第14步:</strong>在响应中，我们将在仪表板上获得标志。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lm"><img src="../Images/a6476ddcf38c8b409588e846aa83bc10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9SabSUCD9xi3OinwDC0s7w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">旗</figcaption></figure><p id="dd70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">flag { 589882d 62d 1c 899d 8 b 85 db 1 af 2076 b 39 }</p><p id="ce01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我寻找旗帜的方法。希望你觉得有用。</p><p id="991d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读。知识就是力量，所以不断获取！😈</p><p id="570a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae le" href="https://github.com/gandhidevansh" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上关注我！</p></div></div>    
</body>
</html>