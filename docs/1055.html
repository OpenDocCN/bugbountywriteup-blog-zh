<html>
<head>
<title>Finding bugs on Chess.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Chess.com发现漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/finding-bugs-on-chess-com-739a71fbdb31?source=collection_archive---------0-----------------------#2021-01-07">https://infosecwriteups.com/finding-bugs-on-chess-com-739a71fbdb31?source=collection_archive---------0-----------------------#2021-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/3db46042d2262fb431f8b663c0231a82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kQ8JhEGEFBQ-DseXpH0H5g.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">寻找Chess.com的弱点</figcaption></figure><p id="c023" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨猎人和乡亲，我是一个象棋爱好者，几乎每天使用chess，但我不是专业的😉</p><p id="6690" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">chess是排名第一的在线国际象棋网站，并且有一个<a class="ae kw" href="https://www.chess.com/news/view/chess-com-bug-bounty-policy" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">内部bug赏金程序</strong> </a> <strong class="ka ir"> </strong>，但是我认为他们应该更加明确他们政策中的一些要点，并且每月更新。如果他们使用像<a class="ae kw" href="https://www.hackerone.com/" rel="noopener ugc nofollow" target="_blank"> HackerOne </a>这样的bug bounty平台就更好了。</p><p id="af5c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">他们在交流中真的很友好，但在接受错误和支付赏金方面比H1·特里格斯更严格。</p><h1 id="0efc" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">不要依赖一种工具</h1><p id="4887" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">狩猎的故事开始于登录页面的一天，Chess.com将我重定向到另一个解决Cloudflare hCaptcha的页面。我认为，这是因为通过代理在登录页面上使用我的VPS IP，而Cloudflare已将我的IP放在灰名单中。<br/>我有时会使用<a class="ae kw" href="https://addons.mozilla.org/en-US/firefox/addon/http-header-live/" rel="noopener ugc nofollow" target="_blank"> HTTP Header Live </a>，在这种情况下也会使用它。登录后，服务器会将用户重定向到以下链接以解决验证码问题:</p><blockquote class="ma mb mc"><p id="85a3" class="jy jz md ka b kb kc kd ke kf kg kh ki me kk kl km mf ko kp kq mg ks kt ku kv ij bi translated"><a class="ae kw" href="https://www.chess.com/login_check" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://www.chess.com/login_check</strong></a></p></blockquote><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/49398bc123677ff3505d0d8ec049d1db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDlCOKBfSvg2Wu1Zy6Zbzg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae kw" href="https://www.chess.com/login_check" rel="noopener ugc nofollow" target="_blank"><strong class="bd kz">https://www.chess.com/login_check</strong></a></figcaption></figure><p id="2a91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">HTTP Header Live 拦截像打嗝这样的请求。如果您点击一个请求，屏幕上将出现一个窗口，您可以更改或重新发送请求。</p><p id="91d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，请求是POST，我的用户名和密码在正文中。我刚刚重发了一遍，下面的页面已经加载了！</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mq"><img src="../Images/dee824a6be7a1f3ea8f611de5b016f5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nj5q9WozFQRcVcUHMSfcDA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">通过<strong class="bd kz"> HTTP Header Live </strong>发送发布请求</figcaption></figure><p id="4510" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击<strong class="ka ir">主页</strong>按钮后，hCAPTCHA会绕过，您可以在不解析验证码的情况下登录，因为hCAPTCHA在服务器上配置错误。你不能通过打嗝来重现这些步骤，因为<strong class="ka ir"> HTTP Header Live </strong>使用blob URL(请看上图中的地址栏)。<br/> <strong class="ka ir">所以不要依赖一个工具！！！</strong></p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="71f8" class="kx ky iq bd kz la my lc ld le mz lg lh li na lk ll lm nb lo lp lq nc ls lt lu bi translated"><strong class="ak">测试应用程序中的所有功能</strong></h1><p id="dadc" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">登录Chess.com有两种方法。第一种是通过用户名，第二种是通过电子邮件。如果你输入错误的密码超过10次，你必须解决验证码。但是有什么问题呢？</p><p id="1fb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">事实上，通过电子邮件登录页面上有一个错误配置，在输入10次错误的登录尝试后，验证码不会出现，攻击者可以对每个用户进行暴力攻击，导致受害者的帐户锁定。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9dd48943634d4da0230791d66a31c4b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*lgwB4fbsU9PbC-0dYAENlQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">登录页面</figcaption></figure><p id="7da0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果用户使用手机app会看到以下错误:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ne"><img src="../Images/aebd90fb8428b19c20d887b56817b4f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aXeVC-SpaapTBxQBMouxtA.jpeg"/></div></div></figure><p id="836f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用户应该登录Chess.com网站，并解决解锁帐户的验证码。</p><p id="50bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以作为一个bug猎人，你应该测试应用程序的所有功能。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="8935" class="kx ky iq bd kz la my lc ld le mz lg lh li na lk ll lm nb lo lp lq nc ls lt lu bi translated">深入检查CSRF氏症</h1><p id="94dc" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">在Chess.com有一个功能，你可以通过谷歌，脸书，…账户登录，但有一个问题。</p><p id="7ba6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以从设置菜单中断开这些帐户，错误仍然存在。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nf"><img src="../Images/093fa27b0dd060f69543415b4b229dbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BVjwdQ_toAiIC_fUk8038w.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">关联账户</figcaption></figure><p id="ef28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当用户单击disconnect按钮时，一个POST请求发送到服务器，如下图所示:</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ng"><img src="../Images/6572f4c095080d32e228fd4cfd38b400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pnRf8Xqlpfh3fIL9W_ot0g.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">发布请求</figcaption></figure><p id="e1d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是在发送这个POST请求后什么也没有发生！</p><p id="e217" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看来一切都是正确的！这类请求应该发送一个带有令牌的POST请求。逻辑为真，但答案在下一个请求中。</p><p id="be72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">事实上，POST请求什么都不做，下一个GET请求会断开用户与Google帐户的连接。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi nh"><img src="../Images/078728eac1f376205aa54596cb4e8c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZCbmwVV9IrnpGfn6no8Vw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">获取请求</figcaption></figure><p id="259f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，任何攻击者都可以向受害者发送一个链接，然后受害者将断开他们的帐户或使用以下代码来托管CSRF文件:</p><pre class="mi mj mk ml gt ni nj nk nl aw nm bi"><span id="4f7c" class="nn ky iq nj b gy no np l nq nr">&lt;html&gt;<br/>&lt;body&gt;</span><span id="555b" class="nn ky iq nj b gy ns np l nq nr">&lt;form action="https://www.chess.com/settings/google/disconnect"&gt;&lt;input type="submit" value="Submit request" /&gt;<br/>&lt;/form&gt;</span><span id="0633" class="nn ky iq nj b gy ns np l nq nr">&lt;script&gt;<br/>document.forms[0].submit();<br/>&lt;/script&gt;</span><span id="71fb" class="nn ky iq nj b gy ns np l nq nr">&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="d90d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">所以，跳出框框思考，审视所有的要求。也许会发生一件你意想不到的怪事。</strong></p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="6c84" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以通过以下链接在twitter上找到我:</p><p id="8a40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">【https://twitter.com/seqrity9 T4】</p></div></div>    
</body>
</html>