<html>
<head>
<title>TryHackMe: RootMe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe: RootMe</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/thm-rootme-94a48def69d3?source=collection_archive---------1-----------------------#2021-12-01">https://infosecwriteups.com/thm-rootme-94a48def69d3?source=collection_archive---------1-----------------------#2021-12-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7df105a0a01394930adca5604d679b32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f9LsnouQQ1OTM-QBJlSs7g.png"/></div></div></figure><h2 id="ec3d" class="jy jz iq bd ka kb kc dn kd ke kf dp kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">简介:</h2><p id="746c" class="pw-post-body-paragraph ku kv iq kw b kx ky kz la lb lc ld le kh lf lg lh kl li lj lk kp ll lm ln lo ij bi translated">你好，绅士！正如你从标题中知道的，这是关于什么的。</p><p id="338e" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated"><strong class="kw ir">所以让我们根</strong></p><h2 id="e791" class="jy jz iq bd ka kb kc dn kd ke kf dp kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">任务1:部署机器</h2><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8d40" class="jy jz iq lz b gy md me l mf mg">Q1. Deploy the machine.</span></pre></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="3e40" class="jy jz iq bd ka kb kc dn kd ke kf dp kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">任务2:侦察</h2><p id="bcfb" class="pw-post-body-paragraph ku kv iq kw b kx ky kz la lb lc ld le kh lf lg lh kl li lj lk kp ll lm ln lo ij bi translated">为了让事情变得更容易，我过去常常导出我的IP以节省时间</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="c55a" class="jy jz iq lz b gy md me l mf mg">export IP=10.10.154.15</span></pre><p id="d6ac" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">从现在开始，每次你想调用ip，就用<strong class="kw ir"> $IP </strong></p><p id="00a6" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">现在，让我们开始扫描:—</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="94b9" class="jy jz iq lz b gy md me l mf mg">nmap -sV -oN nmap $IP</span></pre><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/523d88221396ae3f1c63003c50faa4d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aUBUO1rKRBm2gjGduHqk1Q.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">nmap结果</figcaption></figure><p id="3c55" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">通过扫描，我们得到了2个打开的端口，即</p><p id="c68b" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated"><strong class="kw ir">80</strong>(<strong class="kw ir">http</strong>)&amp;T10】22(<strong class="kw ir">ssh</strong>)</p><p id="aace" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">让我们四处看看<strong class="kw ir"> HTTP ( </strong>因为我们没有任何用户名和他们的凭证为<strong class="kw ir"> SSH </strong>连接<strong class="kw ir"> ) </strong>，<strong class="kw ir"> </strong>我们得到了:</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="cd28" class="jy jz iq lz b gy md me l mf mg">http://$IP</span></pre><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/bd857c6e7499563a7dbcd9dc9a9392ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v4fQ-6MCLLiNPc_aNWwf6w.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">http (80)</figcaption></figure><p id="8de0" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">什么都没有，只是一个简单的页面。让我们做一些目录扫描，</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="6bef" class="jy jz iq lz b gy md me l mf mg">gobuster dir -u $IP -w &lt;wordlist&gt;</span><span id="b409" class="jy jz iq lz b gy mt me l mf mg">I used 'directory-list-lowercase-2.3-medium.txt'</span></pre><p id="980f" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">发现了一些有趣的页面，其中一个是:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/5024882e393841b0f35b29492d39a142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DEQJlkMu4BCcnMKxBJA0Pw.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">http://$IP/panel</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="0df7" class="jy jz iq bd ka kb kc dn kd ke kf dp kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">任务3:获得外壳</h2><p id="ca56" class="pw-post-body-paragraph ku kv iq kw b kx ky kz la lb lc ld le kh lf lg lh kl li lj lk kp ll lm ln lo ij bi translated">所以在<strong class="kw ir">/面板</strong>上有一个上传功能。</p><p id="4a6e" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">于是上传了我的<strong class="kw ir"> rev_shell.php </strong>代码，用<strong class="kw ir"> nc </strong>在后台运行，但是没有结果(没有得到rev-shell):(用diff ext即png，jpg，html，php5试了一下，成功了。它反映在网页上。</p><p id="56c9" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">随着我的rev_shell.php5上传完毕，现在是时候访问/运行它了。</p><p id="33a6" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">现在要访问/运行同一个文件该怎么办呢？</p><p id="99cc" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">我们在gobuster的结果中发现了<strong class="kw ir"> /uploads </strong>目录。</p><p id="7fc1" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">因此，通过http://$IP/uploads(并点击所需的文件)或http://$ IP/uploads/rev _ shell . PHP(通过在URL本身中指定文件)来访问文件</p><p id="81d5" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated"><strong class="kw ir">但是</strong>，在此之前不要忘记运行一个监听器&amp;，为此我们使用<strong class="kw ir"> netcat。</strong></p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="e86c" class="jy jz iq lz b gy md me l mf mg">nc -lnvp 4444</span></pre><p id="8073" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">现在你已经完成了，让我们通过之前讨论过的链接运行php脚本。</p><p id="184f" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">是的，我们得到了rev-shell B-)</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/d83f17de259dbdec46f66fee499be260.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NL-syIS0vAv3GsMX06xbRQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">反向外壳</figcaption></figure><p id="7f8f" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">在此之后，尝试了一些正常的冲浪，即在<strong class="kw ir"> /home </strong>中搜索旗帜，但没有结果。在别的什么地方。然后我记得这个命令名为'<strong class="kw ir"> find </strong>'(顾名思义，它有助于查找文件) :</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="d5b8" class="jy jz iq lz b gy md me l mf mg">find / -name user.txt 2&gt; /dev/null</span></pre><p id="9d64" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">还有躲猫猫。！</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="90c6" class="jy jz iq bd ka kb kc dn kd ke kf dp kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated">任务4:权限Esc</h2><p id="3b74" class="pw-post-body-paragraph ku kv iq kw b kx ky kz la lb lc ld le kh lf lg lh kl li lj lk kp ll lm ln lo ij bi translated">现在让我们检查一下特权Esc策略。</p><ol class=""><li id="4298" class="mu mv iq kw b kx lp lb lq kh mw kl mx kp my lo mz na nb nc bi translated">我试过<code class="fe nd ne nf lz b">sudo -l</code>命令，没有运气:(</li><li id="2bc4" class="mu mv iq kw b kx ng lb nh kh ni kl nj kp nk lo mz na nb nc bi translated">已检查<code class="fe nd ne nf lz b">SUID</code>文件:</li></ol><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="337b" class="jy jz iq lz b gy md me l mf mg">find / -type f -perm -04000 -ls 2&gt;/dev/null</span></pre><p id="7865" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">瞧啊。！我们有一份文件。有python，我们可以作为sudo运行。</p><p id="653d" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">-&gt;在<a class="ae nl" href="https://gtfobins.github.io" rel="noopener ugc nofollow" target="_blank"> GTFObins </a>上检查，</p><p id="b064" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">-&gt;运行脚本</p><pre class="lu lv lw lx gt ly lz ma mb aw mc bi"><span id="8171" class="jy jz iq lz b gy md me l mf mg">python -c 'import os; os.execl("/bin/sh", "sh", "-p")'</span></pre><p id="645a" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">-&gt;轰，我们是<strong class="kw ir">根。</strong>并得到了root.txt标志:)</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/15e2cad778a75a879c7b288cd755f042.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wdIKo9VfokysnrGC7mvXeQ.png"/></div></figure><p id="cd5e" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">就这样，我们成功地完成了这个房间。做这项挑战是一次奇妙的经历。希望你喜欢，然后考虑鼓掌:)</p><blockquote class="nm nn no"><p id="3f58" class="ku kv np kw b kx lp kz la lb lq ld le nq lr lg lh nr ls lj lk ns lt lm ln lo ij bi translated">链接:</p></blockquote><p id="6e41" class="pw-post-body-paragraph ku kv iq kw b kx lp kz la lb lq ld le kh lr lg lh kl ls lj lk kp lt lm ln lo ij bi translated">|| <a class="ae nl" href="https://tryhackme.com/room/rrootme" rel="noopener ugc nofollow" target="_blank">房间</a> || <a class="ae nl" href="https://twitter.com/namx05" rel="noopener ugc nofollow" target="_blank">推特</a> || <a class="ae nl" href="https://github.com/namx05" rel="noopener ugc nofollow" target="_blank"> GitHub </a> ||</p><div class="nt nu gp gr nv nw"><a href="https://tryhackme.com/room/rrootme" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd ir gy z fp ob fr fs oc fu fw ip bi translated">TryHackMe | RootMe</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">一个新手用的ctf，可以root我吗？</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">tryhackme.com</p></div></div><div class="of l"><div class="og l oh oi oj of ok jw nw"/></div></div></a></div></div></div>    
</body>
</html>