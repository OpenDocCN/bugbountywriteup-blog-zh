<html>
<head>
<title>What caused Psychic Signatures Vulnerability (CVE-2022–21449)?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么导致了精神签名漏洞(CVE-2022–21449)？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/what-caused-psychic-signatures-vulnerability-cve-2022-21449-60542811eac2?source=collection_archive---------4-----------------------#2022-05-07">https://infosecwriteups.com/what-caused-psychic-signatures-vulnerability-cve-2022-21449-60542811eac2?source=collection_archive---------4-----------------------#2022-05-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f803d238729c9d4b74531214403ec0b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FgNC8xUGciscl1Zp"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kf" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="0640" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">简介</strong></h1><p id="8b7d" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">在我们开始这篇博文之前，我要问你一个问题。<strong class="lg iu">0等于0 </strong>？你可能会因为我问了这个简单的问题而批评我，但这是这个弱点的基础。</p><p id="0151" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">CVE-2022–21449，也被许多人称为精神签名</strong>，是Java实现ECDSA(弹性曲线数字签名算法)中的一个漏洞，可导致使用ECDSA的TLS和JWT签名导致的通信完整性失效。</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/a01cbf428e9c782bec9fc139c1346d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*uxgFsjIdnaf2X4d6cyvOwQ.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://www.semanticscholar.org/paper/A-Subliminal-Channel-in-EdDSA%3A-Information-Leakage-Hartl-Annessi/aebec72025beda029ae9b370d33f0eac0606965c/figure/0" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="77b3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">较难的公钥密码加密算法之一是椭圆曲线数字签名算法(ECDSA)，有时也称为ECDSA。椭圆曲线加密的使用允许生成比由数字签名技术创建的典型密钥更小的密钥。它是一种基于有限域上椭圆曲线的代数结构的公钥密码学，是椭圆曲线密码分析的一个子集。采用椭圆曲线的密码学主要用于生成伪随机数、数字签名和其他应用。它是一种身份验证机制，通过使用公钥对和数字证书作为签名过程的一部分来验证信息接收方或发送方的身份。</p><p id="7537" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">该漏洞使得攻击者能够拦截浏览器和web服务器之间的通信。</strong></p><p id="fbf7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">甲骨文给这个CVE的CVSS评分是7.5分，而Java版本15、16、17和18容易受到这个CVE的攻击。如果您的应用程序在生产中使用上述任何Java版本，建议您应用2022年4月的关键补丁来缓解此漏洞。</p><h1 id="998c" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">分析</strong></h1><p id="e5d7" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">数字签名广泛应用于识别和验证目的。数字签名使用非对称加密，其中用于加密会话的密钥不同于用于解密会话的密钥。这是可能的，因为密钥在数学上是相关的，并且只有这些密钥可以一起用于加密和解密。使用任何其他键都不起作用。</p><p id="4eee" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">数字签名的实现不同于非对称加密和解密。</p><p id="8436" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在数字签名中，私钥用于查找(要发送的)消息的散列，接收方将使用发送方的公钥来验证消息确实来自声称的发送方。</p><p id="507b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">Java使用的数字签名算法是ECDSA </strong>。使用ECDSA比RSA有好处(这也很常见)。它们(就像其他非对称加密方案一样)都依赖于素数的使用。<em class="mm">质数应该很大(大约256或512位)以提供良好的安全性。在尺寸受到限制的系统中，ECDSA是一个很好的选择。它可以提供与RSA相同的安全性，但与RSA相反，RSA需要很长的数字，而它使用的数字很少。</em></p><p id="f342" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在ECDSA中，签名是由发送者生成的对(r，s ),然后在对这些和(消息的)散列进行一些复杂的计算之后，由接收者检查和验证。</p><p id="8dc2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在对我们如何尽可能简单地解释这一点进行了一些研究之后，这是用于验证签名匹配的方程的过于简化的版本。关于ECDSA如何工作的详细信息，你可以参考维基百科文章<a class="ae kf" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm#Signature_verification_algorithm" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><pre class="mi mj mk ml gt mn mo mp mq aw mr bi"><span id="944a" class="ms kh it mo b gy mt mu l mv mw">if (<strong class="mo iu">r == [complex equation] * [value derived from s]</strong>)</span><span id="99db" class="ms kh it mo b gy mx mu l mv mw">Then</span><span id="62cd" class="ms kh it mo b gy mx mu l mv mw">    valid</span><span id="477b" class="ms kh it mo b gy mx mu l mv mw">Otherwise,</span><span id="ddae" class="ms kh it mo b gy mx mu l mv mw">    invalid</span></pre><p id="1f19" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">从安全角度来看，重要的是实现一个逻辑检查，即r和s都不应该为0。这是因为上面的等式会变成如下所示</p><pre class="mi mj mk ml gt mn mo mp mq aw mr bi"><span id="001f" class="ms kh it mo b gy mt mu l mv mw"><strong class="mo iu">0 == 0 * [complex equation]</strong> which is <strong class="mo iu">0 == 0</strong></span></pre><p id="377a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">正确的实现应该是检查r，s &gt; = 1。</strong></p><p id="a2ed" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">但是ECDSA的Java实现不检查这一点。所以，把两个r，s都作为0发送是可能的。正如您从上面可以得出的结论，该等式将始终产生一个真的无关紧要的私钥，用于对消息进行签名。这造成了很大的安全风险，因为现在消息可以由声称是无辜个人的恶意第三方签署。由于库中的bug，签名将总是导致True。</p><p id="db88" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在<a class="ae kf" href="https://www.youtube.com/watch?v=S77ES52AGVg" rel="noopener ugc nofollow" target="_blank">这个</a>视频里有深入的讲解，有兴趣可以参考一下。</p><h1 id="7fc7" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">缓解</strong></h1><p id="7fcd" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">针对此漏洞的缓解措施是应用2022年4月的关键补丁，其链接可在此处找到<a class="ae kf" href="https://www.oracle.com/security-alerts/cpuapr2022.html" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>