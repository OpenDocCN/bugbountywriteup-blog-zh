<html>
<head>
<title>Account Takeover (User + Admin) Via Password Reset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过密码重置接管帐户(用户+管理员)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/account-takeover-user-admin-via-password-reset-322b8020ea6?source=collection_archive---------0-----------------------#2021-08-05">https://infosecwriteups.com/account-takeover-user-admin-via-password-reset-322b8020ea6?source=collection_archive---------0-----------------------#2021-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="674c" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">大家好！</h1><p id="da9e" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我叫赫曼特·帕蒂达尔，是钦奈理工学院土木工程专业的大四学生。</p><p id="5851" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">一个土木工程师，一个网络安全爱好者，一个夜间的Bug赏金猎人。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lo"><img src="../Images/e6652a891793feaba0c06cff4d1178f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GhKLOqMTNUBPlKSCnxjNfA.jpeg"/></div></div></figure><h1 id="16eb" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">我们开始吧...</h1><p id="7ad6" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当我和<a class="ma mb ep" href="https://medium.com/u/b437fa5664a?source=post_page-----322b8020ea6--------------------------------" rel="noopener" target="_blank"> Ritesh Gohil </a>对我们自己的帐户进行密码重置时，我们注意到发送到我们电子邮件的密码重置链接包含一个五位数的令牌。</p><p id="7177" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">后来，我们得出结论，当以连续的方式对两个不同的用户(即帐户A和B)进行密码重置时，服务器将为这两个用户分配一个连续编号的令牌。因此，如果帐户A是攻击者的帐户，那么攻击者可以将令牌ID更改为下一个连续的数字，并且可以更改帐户B(即受害者的帐户)的密码。这会导致账户被接管。</p><p id="6226" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">举例:</strong></p><p id="ed9d" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">如果<strong class="kn ir">账号A </strong>收到链接:https://dashboard.example.com/password-reset/form?token=<strong class="kn ir">28604</strong></p><p id="0d8d" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">然后<strong class="kn ir">账户B </strong>会收到:https://dashboard.example.com/password-reset/form?token=<strong class="kn ir">28605</strong></p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="c013" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">现在，让我们接管管理员帐户。</strong></p><p id="c349" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">经过一些研究，我们发现管理员用户没有单独的登录页面。这意味着管理员用户可以在同一个登录页面上预置。因此，让我们找出管理员用户的电子邮件地址，以便我们可以接管他们的帐户。我们只是进入网站的“关于我们”页面，找到了创始人的电子邮件地址。现在，让我们接管管理员帐户。</p><p id="1201" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">复制步骤:</strong></p><ol class=""><li id="dcde" class="mj mk iq kn b ko lj ks lk kw ml la mm le mn li mo mp mq mr bi translated">在两个不同的选项卡中打开URL:https://dashboard.example.com/login，并使用电子邮件地址以连续的方式为两个帐户执行密码重置。(即A -您的帐户，B -管理帐户)</li><li id="dd91" class="mj mk iq kn b ko ms ks mt kw mu la mv le mw li mo mp mq mr bi translated">现在打开记事本，在记事本中复制账户A的密码重置链接(即https://dashboard.example.com/password-reset/form?token=12345)</li><li id="c385" class="mj mk iq kn b ko ms ks mt kw mu la mv le mw li mo mp mq mr bi translated">现在将令牌ID更改为下一个连续的数字。(作为以连续方式分配的令牌ID，如果您的是12345，则管理令牌ID将是12346)</li><li id="c875" class="mj mk iq kn b ko ms ks mt kw mu la mv le mw li mo mp mq mr bi translated">现在使用修改后的链接，即https://dashboard.example.com/password-reset/form?token=12346并重置管理员密码。</li><li id="da92" class="mj mk iq kn b ko ms ks mt kw mu la mv le mw li mo mp mq mr bi translated">嘣！！管理帐户接管。</li></ol><p id="cb6b" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">影响:</strong></p><p id="9f67" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">任何人的帐户接管</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/0bb1445ac7deef8f4ed99ef0df2c057f.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*AaQKA0qAQ8gYixQsI0A8eQ.gif"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">#赏金</figcaption></figure><p id="1e7b" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">时间线:</strong></p><blockquote class="nc nd ne"><p id="9603" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated"><strong class="kn ir"> Bug报告:</strong>2021年6月2日</p><p id="a4b8" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated">2021年8月5日<strong class="kn ir"> </strong>悬赏:200美元</p></blockquote><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi nj"><img src="../Images/29b7a1f16567e02f2d3f9014bc68278f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7I-5gf5qHDbNSS98yOrtug.png"/></div></div></figure><p id="9ed8" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">感谢阅读:)</strong></p><p id="8273" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">快乐黑客；)</p><p id="05d1" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">你可以看到许多文章即将发表…</p><p id="70df" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated"><strong class="kn ir">如果你有任何关于昆虫赏金猎人的疑问，请随时给我发消息</strong></p><blockquote class="nc nd ne"><p id="9868" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated"><em class="iq">领英:</em><a class="ae nk" href="https://www.linkedin.com/in/hemantsolo" rel="noopener ugc nofollow" target="_blank"><em class="iq">linkedin.com/in/HemantSolo</em></a></p><p id="2524" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated"><em class="iq">网址:-</em><a class="ae nk" href="http://hemantpatidar.me/" rel="noopener ugc nofollow" target="_blank"><em class="iq">hemantpatidar . me</em></a></p><p id="d4fc" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated"><em class="iq">推特:-</em><a class="ae nk" href="https://twitter.com/HemantSolo" rel="noopener ugc nofollow" target="_blank"><em class="iq">twitter.com/HemantSolo</em></a></p><p id="29b6" class="kl km nf kn b ko lj kq kr ks lk ku kv ng ll ky kz nh lm lc ld ni ln lg lh li ij bi translated"><em class="iq">insta gram:-</em><a class="ae nk" href="https://www.instagram.com/hemant_solo/" rel="noopener ugc nofollow" target="_blank"><em class="iq">instagram.com/hemant_solo</em></a></p></blockquote></div></div>    
</body>
</html>