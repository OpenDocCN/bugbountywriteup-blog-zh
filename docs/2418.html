<html>
<head>
<title>Bugcrowd — Tale of multiple misconfigurations!! ❌</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">bug crowd——多种错误配置的故事！！❌</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugcrowd-tale-of-multiple-misconfigurations-cb5b98f09302?source=collection_archive---------1-----------------------#2022-10-04">https://infosecwriteups.com/bugcrowd-tale-of-multiple-misconfigurations-cb5b98f09302?source=collection_archive---------1-----------------------#2022-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">欢迎阅读这篇新文章。这篇文章是关于在一个域上发现的错误配置的故事。因为这是一个私人项目，就叫它redacted.com吧，你想知道怎么做吗？？</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/18a264e1578470cbe3c5785558b37dae.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/0*wTIs9SSLna9SDidl"/></div></figure><p id="d0a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序的范围很大，但是从正常的子域扫描和所有那些花哨的侦察开始，我决定开始测试主应用程序。这个web应用程序是一个简单的电子商务网站，有很多交易可以抢！；)</p><p id="8c6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通常会尝试检查此类网站的各种业务逻辑漏洞，但这次我的眼睛捕捉到了认证机制。</p><p id="9dcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以第一件事就是创建一个帐户！但是我注意到的是OAuth机制。完美是时候检查各种OAuth漏洞了！！</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/82560310a83cb7a50d2396fc706f975a.png" data-original-src="https://miro.medium.com/v2/resize:fit:576/format:webp/1*-Wh8vHB5G3cM6_fRfHudcg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">电子邮件注册</figcaption></figure><p id="bb56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我使用了来自<a class="ae lh" href="https://pentestbook.six2dez.com/enumeration/webservices/oauth#bugs" rel="noopener ugc nofollow" target="_blank"> Pentest Book </a>的漂亮方法和我的第二个虚拟账户，开始检查OAuth漏洞，但是没有发现任何漏洞！</p><p id="b470" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是嘿！！基本的漏洞检查被遗忘了。我立即尝试用我的第一个虚拟账户创建一个OAuth账户，然后嘣，我用同一个电子邮件ID创建了两个账户。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi li"><img src="../Images/e57109f5203a7cd8cc6beaa0950a5cba.png" data-original-src="https://miro.medium.com/v2/resize:fit:404/format:webp/1*GFcPSNAW0-uNY1Ak8o9Mhw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">使用电子邮件注册创建的帐户</figcaption></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/d6b8519f41a5628a8f98480992bbf8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*4_nsYvtnYWTz7GVfIKwd8w.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">使用同一电子邮件进行OAUTH登录</figcaption></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/9495c214221aba88c9d39764cd7ec9ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*6zjDQW1EYxWqByNWv6Cbyw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">帐户接管前的Oauth配置错误</figcaption></figure><p id="823a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了总结整个程序，执行了以下步骤:</p><ol class=""><li id="31ff" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lq lr ls lt bi translated">访问网站并点击注册。</li><li id="0e71" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">使用未注册的受害者电子邮件创建一个账户(比如test@gmail.com的<a class="ae lh" href="mailto:test@gmail.com" rel="noopener ugc nofollow" target="_blank"/></li><li id="f74f" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">使用OAuth机制和同一个OAuth帐户创建另一个帐户。</li></ol><p id="af62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">影响:</strong> <br/>使用电子邮件和密码创建的帐户应该失效，但并没有失效，这意味着攻击者仍然可以使用他在使用电子邮件创建帐户时使用的凭据登录，从而导致帐户被预接管。</p><blockquote class="lz ma mb"><p id="6e2b" class="jn jo mc jp b jq jr js jt ju jv jw jx md jz ka kb me kd ke kf mf kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">完美！我抓到一个，我们去找更多的！这一次我的眼睛捕捉到了忘记密码的功能。</em>T12】</strong></p></blockquote><p id="c59f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mc">密码重置机制如下:</em> </strong></p><ol class=""><li id="5a66" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lq lr ls lt bi translated">用户输入他的电子邮件。</li><li id="e002" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">生成一个6位数的动态口令，并发送到用户的电子邮件中</li><li id="70c7" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">用户设置新密码。</li></ol><p id="a500" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了，让我们尝试绕过认证，看看我们是否能改变受害者的密码。因此，我输入了我的电子邮件并请求了一个动态口令，输入了错误的动态口令，捕获了响应并试图操纵响应，但没有成功。</p><p id="7a00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我注意到应用程序正在使用ajax执行密码重置。</p><p id="6419" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> AJAX </strong> <strong class="jp ir">通过在后台与服务器交换少量数据，允许网页异步更新。</strong></p><p id="e024" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我是这样做的:</p><ol class=""><li id="efc5" class="ll lm iq jp b jq jr ju jv jy ln kc lo kg lp kk lq lr ls lt bi translated">转到登录页面，点击忘记密码</li><li id="70c5" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">输入攻击者的电子邮件地址(例如，我的电子邮件地址是attacker@gmail.com)</li><li id="b8c9" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">现在输入在attacker@gmail.com上收到的正确的OTP，捕获响应并保存它。</li><li id="2e6c" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">您将被重定向到设置新密码页面，但DONT再次设置密码，转到登录页面，然后单击忘记密码</li><li id="e96b" class="ll lm iq jp b jq lu ju lv jy lw kc lx kg ly kk lq lr ls lt bi translated">输入受害者的电子邮件，即victim@gmail.com(在我们的案例中是aadesh004@protonmail.com)</li></ol><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mg"><img src="../Images/d33d522ef397ee2e7cbd912d3736e85e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OLFtvmrioYcikz42oB7B-Q.png"/></div></div></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/d3e428ffed57754642344fb6f86d3e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*0i-SVEDQq4VqQD1FsJHsbg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">输入受害者电子邮件</figcaption></figure><p id="46d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.输入随机OTP，即000000，使用burp拦截请求，并对该请求执行拦截&gt;响应</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/b5f9b2f07d53c589c8eee719bc728975.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*uQNxftunUHXLLJKdf-xrmw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">输入随机OTP</figcaption></figure><p id="70a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7.在响应中，将响应操作为:{"successTextKey":"success "，" errors":null}</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mn"><img src="../Images/c91c98e82a5102e6a56881b97a0cccbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G147LIqTHdCgq9pSq0OpSw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">生成的响应</figcaption></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mo"><img src="../Images/e21872649fbda371471e3631aeb52f52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8MvNlurE7k75r73d6adqHg.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">响应操作</figcaption></figure><p id="b5fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8.转发请求，您将被重定向到设置新密码。这一次设置密码和boom帐户接管。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/24ad32f84e592bbcef29bc85455d2974.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*OErIV6wAkrc7hwEEwwLcbQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">设置新密码</figcaption></figure><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mq"><img src="../Images/1195d0c1676c8ba7225bcb4443f2e11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IutgPWVNspBCj5-4NxyHiA.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">账户接管</figcaption></figure><p id="f72c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们希望你喜欢这篇文章！一定要让我们知道你关于错误配置的故事！</p><p id="4550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">狩猎愉快！</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="6610" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">作者:</strong></p><p id="49ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">瓦伊巴夫·拉哈尼:【https://www.linkedin.com/in/vaibhav-lakhani】T4</p><p id="b081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lh" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">迪尔·帕尔马</a>:<a class="ae lh" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dhir-parmar-925b171a4</a></p><h2 id="21ed" class="my mz iq bd na nb nc dn nd ne nf dp ng jy nh ni nj kc nk nl nm kg nn no np nq bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lh" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>