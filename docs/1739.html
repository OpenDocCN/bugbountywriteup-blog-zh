<html>
<head>
<title>Massive Users Account Takeovers(Chaining Vulnerabilities to IDOR)😲</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大规模用户帐户接管(将漏洞链接到IDOR)😲</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/massive-users-account-takeovers-chaining-vulnerabilities-to-idor-ea4e1b6407d2?source=collection_archive---------0-----------------------#2021-12-25">https://infosecwriteups.com/massive-users-account-takeovers-chaining-vulnerabilities-to-idor-ea4e1b6407d2?source=collection_archive---------0-----------------------#2021-12-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="78b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">猎人们好👋✌这是我第七次写🧾 </em>，</p><p id="736c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我将展示一个有趣的案例，我能够接管应用程序的任何用户帐户，甚至是管理员/雇员帐户。</p><p id="2e6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们移动用例，</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="1974" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">考虑网站为redacted.com<strong class="jp ir"/>，现在网站使用电话号码供用户登录，现在经过观察，我发现有一些电话号码如<em class="kl">999999999999，88888888888，7777777777 …………111111111等</em>。这不需要实际的认证，我可以使用任何OTP号码登录，但使用其他电话号码(比如我的号码)，他们实际上正在进行认证。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/894b19fca2d4c5b821fc4dab63547821.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*0XZ_6kk0D3gwzHZpz8fQvw.png"/></div></figure><p id="8667" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">但是为什么上述电话号码没有实际认证呢？</strong></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="9a1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">背后的原因是，在部署到实际的生产环境之前，开发人员有时会使用一些默认的电话号码，如999999999、8888888888……。<em class="kl">。</em>用于<em class="kl">即时访问应用程序并测试内部功能</em>而无需任何实际认证，例如在这种情况下，无需正确的OTP即可访问应用程序。</p><p id="0d42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，无论何时将应用程序部署到生产环境，开发人员都有责任禁用此功能，因为这些帐户仍然包含一些开发人员或员工信息，如地址、电子邮件、银行详细信息和更多元信息。</p><p id="b8a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但有时开发人员忘记更改功能，外人可以登录这些默认电话号码。</p><p id="28d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">现在，我想报告这个问题，但我没有报告，我想如果我使用这个功能进入其他用户的帐户会怎么样。</em></p><p id="758f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在到了链接部分，</strong></p><p id="bf86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我开始分析请求和响应，它们的参数和令牌。</p><p id="b1b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注册帖子请求看起来像下面的截图，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi kw"><img src="../Images/51f212e7f47d0fb6e42824f7d1e8ec0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GiOJYBAKwUYMLop3TBHtkQ.png"/></div></div></figure><p id="b878" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以观察到有许多参数传递给定的电话号码，并且可以评估上述电话号码的任何OTP值。</p><p id="8c72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我手动检查了所有三个参数<strong class="jp ir"> <em class="kl"> mobileNo、uid和socialMediaId </em> </strong>的响应，方法是将它们更改为受害者的电话号码，</p><p id="0a1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在<strong class="jp ir"> <em class="kl"> uid </em> </strong>参数被发现易受攻击，下面是我如何查看用户信息并登录其帐户的示例截图。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lb"><img src="../Images/90a788f5d615c1d676b5291cbf97a993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*elUDf5wPZnJSp-Jig5jZcg.png"/></div></div></figure><p id="29a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">响应JSON参数"<strong class="jp ir"><em class="kl">isExistingUser "</em></strong>和消息<strong class="jp ir"> <em class="kl">“登录成功”</em> </strong>确认用户账号的存在和接管，这样我可以通过知道他们的电话号码登录任何账号。</p><p id="cdfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以通过侦察(像google，GitHub dorks，LinkedIn，contact pages)获得很多电话号码，你可以测试漏洞。</p><p id="fc46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">由于<em class="kl">注册终点没有费率限制，因此影响更大。</em>T3】</strong></p><p id="87a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于没有速率限制，我甚至可以暴力破解电话号码，并通过响应JSON参数“<strong class="jp ir"> <em class="kl"> isExistingUser=true”(这将确认现有用户)</em> </strong>使用入侵者和过滤结果，这样我可以进入任何<em class="kl">用户/员工/管理帐户</em>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lc ks l"/></div></figure><p id="0406" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">因此，这种方式的影响变得至关重要</strong>然后，我向相关组织报告了这个问题，并获得了$$$奖金(由于隐私政策原因，我不能透露目标)。</p><p id="c351" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">希望你喜欢这篇报道😁，下拉您的意见和建议👇</strong>。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lc ks l"/></div></figure><p id="b080" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">订阅我的youtube频道寻找bug相关的东西:<a class="ae ld" href="https://www.youtube.com/channel/UCq7-Qf45etdk0qc35I_n7PQ?sub_confirmation=1" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> redirect _poc </strong> </a></p><p id="4475" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在Instagram上关注我</p><p id="c66b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Linkedin上关注我:<a class="ae ld" href="http://linkedin.com/in/anurag-verma-650b771a2" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">我的_linkedin </strong> </a></p><p id="34b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">给我买杯咖啡😍:<a class="ae ld" href="https://www.buymeacoffee.com/redirectpoc" rel="noopener ugc nofollow" target="_blank">此处</a></p></div></div>    
</body>
</html>