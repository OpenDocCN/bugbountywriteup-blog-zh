<html>
<head>
<title>Hacking Microsoft Forms</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解微软表单</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hacking-microsoft-forms-d05e22fb70d7?source=collection_archive---------0-----------------------#2021-12-29">https://infosecwriteups.com/hacking-microsoft-forms-d05e22fb70d7?source=collection_archive---------0-----------------------#2021-12-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/20163695d27fc19979759f62b8e5b718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*tj0vXkPS5NPeU9sw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Microsoft表单</figcaption></figure><p id="c742" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从疫情学生在线学习的增长来看，研究人员一直在寻找针对微软表单的黑客攻击，这可能会给他们在考试、突击测验等中带来不公平的优势。</p><p id="76a9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">YouTube上有许多人声称通过检查源代码、尝试其他技巧等找到了这样的<em class="la">宝藏</em>，但这都只是吸引观众的点击诱饵。</p><p id="d97c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我今天要分享的将会改变这一切…</p><p id="387a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你们所有人可能已经从这个故事的主题中读到的，是的，我已经找到了一种破解<strong class="ke ir"><em class="la"/></strong><em class="la"/>微软表单的方法，但这并不完全是你所期望的</p><h1 id="198a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">摘要</h1><ul class=""><li id="bdca" class="lz ma iq ke b kf mb kj mc kn md kr me kv mf kz mg mh mi mj bi translated">每当提交表单时，都会向<strong class="ke ir"><em class="la">/formapi/API/$ { API _ Key }/users/$ { User _ Key }/forms($ { FormID })/responses</em></strong>端点发出API POST请求</li><li id="61f7" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">通过拦截POST请求，用户/攻击者可以输入新条目/空字符串，从而完全绕过必填字段/添加新选项。</li><li id="f6cb" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">由于缺少服务器端检查，这同样反映在表单所有者可用的表单响应中。</li></ul><h1 id="69e2" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">拦截的有效载荷</h1><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="d6d9" class="my lc iq mu b gy mz na l nb nc">{“startDate”:”2021–12–02T18:38:36.784Z”,”submitDate”:”2021–12–02T18:38:40.820Z”,”answers”:”[{\”questionId\”:\[REDACTED]},\”answer1\”:\${New Option} OR null \”}]”}</span></pre><h1 id="ae75" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">摘要—为外行翻译</h1><ul class=""><li id="ac61" class="lz ma iq ke b kf mb kj mc kn md kr me kv mf kz mg mh mi mj bi translated">当用户提交表单时，网页/表单(客户端)向服务器发送一条消息，表明该用户已经提交了“X”作为对具有<strong class="ke ir">唯一id</strong>“Y】的特定问题的响应，并且服务器将该响应保存在其数据库中，该数据库可供表单所有者查看。</li><li id="213d" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">通过充当中间人并拦截消息，攻击者可以更改网页发送的消息，说明特定用户发送了“Z”作为对基于MCQ的特定问题的响应，其中Z是<em class="la">不在可用选项</em>中/是<strong class="ke ir">无效的</strong>输入。</li><li id="ed28" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">由于没有服务器端检查来确认该选项是否是有效选项之一，所以用户可以操纵<strong class="ke ir">评级</strong>、<strong class="ke ir">净推介值</strong>，还可以在基于<strong class="ke ir"> MCQ /复选框/下拉列表</strong>的问题中添加新选项。</li><li id="97ac" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">同样的内容保存在数据库中，并作为响应集的一部分发送给表单所有者。</li><li id="7832" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">这种攻击的一个限制其影响的问题是，攻击者只能操纵他/她的响应，而不能操纵其他用户的响应。</li></ul><h1 id="73a6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">攻击场景</h1><ul class=""><li id="1c1b" class="lz ma iq ke b kf mb kj mc kn md kr me kv mf kz mg mh mi mj bi translated">当企业使用这种形式进行内部员工竞争时，任何滥用都可能给企业带来声誉问题，进而损害微软的品牌形象。</li><li id="a1a9" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">通过这些形式为公众开展特定活动的大型企业，如果存在通过所列选项之外的选项进行滥用的空间，可能会面临巨大的收入损失和声誉损害。</li><li id="d067" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">微软表单主要在学校中用于进行考试。任何潜在的攻击或误用都会给学生的生活带来巨大的破坏，并给学生及其家庭造成不可挽回的损失。</li></ul><p id="2283" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个错误既影响测验，也影响正常形式。</p><h1 id="4d2d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">重现Bug的步骤</h1><ul class=""><li id="f3a1" class="lz ma iq ke b kf mb kj mc kn md kr me kv mf kz mg mh mi mj bi translated">在MS窗体上创建新窗体。</li><li id="111a" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">打开表单。</li><li id="c80b" class="lz ma iq ke b kf mk kj ml kn mm kr mn kv mo kz mg mh mi mj bi translated">按照下面附带的POC中所示的步骤进行操作。</li></ul><h2 id="59f1" class="my lc iq bd ld nd ne dn lh nf ng dp ll kn nh ni lp kr nj nk lt kv nl nm lx nn bi translated">概念验证</h2><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="4917" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="la">免责声明</em> </strong> <em class="la">:通过阅读本文，您同意仅出于教育目的使用这些信息，并且不会在您的测试/随堂测验中作弊，作为本文的作者，我对您的任何不当行为不承担任何责任。</em></p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h1 id="c451" class="lb lc iq bd ld le nx lg lh li ny lk ll lm nz lo lp lq oa ls lt lu ob lw lx ly bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae oc" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="od oe gp gr of og"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="oh ab fo"><div class="oi ab oj cl cj ok"><h2 class="bd ir gy z fp ol fr fs om fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="on l"><h3 class="bd b gy z fp ol fr fs om fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="oo l"><p class="bd b dl z fp ol fr fs om fu fw dk translated">iwcon.live</p></div></div><div class="op l"><div class="oq l or os ot op ou jw og"/></div></div></a></div></div></div>    
</body>
</html>