<html>
<head>
<title>Critical Bug Bounty Reports: Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关键Bug奖励报告:第1部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/critical-bug-bounty-reports-part-1-6fd9aef4b486?source=collection_archive---------0-----------------------#2021-07-11">https://infosecwriteups.com/critical-bug-bounty-reports-part-1-6fd9aef4b486?source=collection_archive---------0-----------------------#2021-07-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f352" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">我提交给赏金项目的关于P1/重大错误的简短报道</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a4697e9fad59c83299ddeabcb7be0c85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Fd7ENUVc11JrQde8ibfVg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Bugcrowd的P1勇士徽章系列-2级徽章，授予在任何程序中提交5份有效P1作品的黑客</figcaption></figure><p id="5642" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这个月标志着我正式开展Bug赏金狩猎两年了，我的第一份报告于2019年7月27日提交给了Bugcrowd上的一个项目。那份报告被打上了<code class="fe lu lv lw lx b">Not Applicable</code>的标记，直到今天，我真的很困惑这家公司还没有修复它。我接着写了一份标记为<code class="fe lu lv lw lx b">P4 / Informational</code>的报告，涉及一个带有暴露的<code class="fe lu lv lw lx b">web.config</code>文件的子域。令人兴奋的东西(不尽然)。我的前10份报告的平均严重性评级为3.7，其中1份不适用，5份信息性，其余4份合格。</p><p id="a58c" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">今天，我凭借134个公认的漏洞(包括20个P1漏洞)进入了Bugcrowd有史以来排名的前200名。回顾我的第一份报告，我惊讶地发现我在发现严重漏洞和编写令人信服的报告以充分发挥影响(或为什么公司应该关注)方面取得了如此大的进步。在我相对较短的经历中，我发现影响驱动的严重性不亚于甚至有时超过脆弱性的级别。考虑到这一点，我决定分享我在过去两年中提交给Bug Bounty计划的所有关键严重性Bug的高水平文章，目的是帮助您将您的搜索提升到一个新的水平。</p><h1 id="5d65" class="ly lz it bd ma mb mc md me mf mg mh mi jz mj ka mk kc ml kd mm kf mn kg mo mp bi translated"><strong class="ak"> 1。通过未验证的安全问题重置帐户接管</strong></h1><p id="3d79" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">这是我的第一个P1，也是许多CTF教授的经典bug。很明显，当我设置一个自动暗示P1的漏洞等级时，我总是很兴奋，但我相信我可能会因为这个而紧张兴奋得发抖——这是我的第一次。这是一个刚刚开放的私人项目，是当时我受邀参加的少数几个项目之一。在此之前，我提交了17份报告，只有10份被接受——要么是P3/中等，要么是P4/低。</p><p id="0d7b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在测试身份验证、密码重置和用户配置文件流时发现了这个漏洞，它允许攻击者通过篡改参数来重置受害用户的安全问题和答案。应用程序没有依赖会话，而是在帖子中包含了用户名，类似于<code class="fe lu lv lw lx b">security_question=hacked&amp;security_answer=hacked&amp;username=victim_account</code>。这不是跨站点伪造请求(CSRF)来欺骗用户更改他们自己的问题和答案——任何用户都可以为任何其他用户提交新的安全问题和答案。更糟糕的是，密码重置流程只要求您在提示您设置新密码之前提供安全答案，这意味着一旦您完成了重置受害者问题和答案的利用，您就可以注销并重置受害者的密码，从而完成帐户接管。</p><p id="d0e2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">日期:</strong>2019年11月7日</p><p id="18ec" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">漏洞:</strong>中断认证和会话管理&gt;绕过认证</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="dccd" class="ly lz it bd ma mb nc md me mf nd mh mi jz ne ka mk kc nf kd mm kf ng kg mo mp bi translated">2.通过创建新帐户获得完全的客户帐户访问权限</h1><p id="fbb2" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">第二个P1和第一个一样是在同一个私人项目上狩猎。这个应用程序是一个企业对企业的网站，企业可以在其中建立一个帐户，并授予不同的用户访问该帐户的权限。新用户可以自助注册，但需要提供企业的账号和相关的邮政编码。利用之前在已完成订单上发现的不安全直接对象引用(IDOR)漏洞，我能够列举有效的账号和相关企业的名称，但不能列举它们的地址。</p><p id="2770" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">幸运的是，很容易在Google上找到提供所需邮政编码的企业，但我也发现缺乏速率限制，允许我使用Burp Intruder重复提交表单，最终使用大约42，000个有效的美国邮政编码强行获得答案。一旦表单成功返回，我就可以登录并访问该企业的完整帐户信息，代表他们提交订单，等等。</p><p id="1820" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">日期:</strong>2019年11月14日</p><p id="21c7" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">漏洞:</strong>中断认证和会话管理&gt;绕过认证</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="fb9b" class="ly lz it bd ma mb nc md me mf nd mh mi jz ne ka mk kc nf kd mm kf ng kg mo mp bi translated"><strong class="ak"> 3。RCE在&lt;域&gt;上通过AEM ACS工具篡改使用默认凭证</strong></h1><p id="c22e" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我对HackerOne的第一次批判！出于某种原因，我没有在那里花太多时间，但一个程序引起了我的注意，因为我使用了Adobe Experience Manager (AEM ),而0ang3el没有在那里向他们展示他们的错误。多亏了他的扫描仪，我很快发现了一个操作系统命令注入漏洞，并执行了各种概念验证命令<code class="fe lu lv lw lx b">whoami</code>和<code class="fe lu lv lw lx b">cat /etc/passwd</code>。我花了相当多的时间关注0ang3el对AEM的研究，虽然这是一个免费的程序，但它是我迄今为止报告过的最容易的错误之一。这也是我第一次看到一家公司在分类小组审查发现之前就实施修复。</p><p id="0b7e" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">日期:</strong>2020年7月31日</p><p id="d365" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">漏洞:</strong> OS命令注入</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="4232" class="ly lz it bd ma mb nc md me mf nd mh mi jz ne ka mk kc nf kd mm kf ng kg mo mp bi translated"><strong class="ak"> 4。RCE在&lt;另一个域&gt;上通过AEM ACS工具篡改使用默认凭证</strong></h1><p id="c62d" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">在大范围的程序中，有一个发现的地方通常会有更多的发现。我的扫描仪发现了第二个同样漏洞的例子。</p><p id="69fd" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">日期:</strong>2020年7月31日</p><p id="7dbc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">漏洞:</strong>操作系统命令注入</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="92f3" class="ly lz it bd ma mb nc md me mf nd mh mi jz ne ka mk kc nf kd mm kf ng kg mo mp bi translated"><strong class="ak"> 5。完整的客户信息披露</strong></h1><p id="384d" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">尽管我在2020年上半年取得了一定的成功，但从7月底到8月初，情况确实有所好转。这个bug是4p 1中的第一个，是在一家财富500强公司的大型私人项目中提交的31个项目中提交的，在这个项目中，我真正开始成为一名Bug赏金猎人。</p><p id="36e6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">该公司有各种未经验证的工作流，需要半私有的用户信息，如用户的电话号码和出生日期。我本人不是该公司的客户，但有一个好朋友同意让我使用他的信息。他的电话号码和出生日期暴露了第三条关键信息，我们称之为widgets。使用他的名、姓、电话号码、出生日期和关于小部件的信息，我可以访问一个请求表单。在后台，这个表单与一个类似于<code class="fe lu lv lw lx b"><a class="ae nh" href="https://domain.com/api/v1/widget/123456." rel="noopener ugc nofollow" target="_blank">https://domain.com/api/v1/widget/123456</a></code>的基于JSON的REST API交互。方便的是，当客户端Javascript触发请求时，它会将一个API键附加到一个自定义头中(因为用户没有经过身份验证，所以应用程序不能依赖于会话)。从那里开始，一个简单的参数篡改来增加URL暴露了IDOR——这是一个返回完整客户信息的大事件，相当于访问他们的数据库。</p><p id="9357" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">日期:</strong>2020年8月5日</p><p id="9f18" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated"><strong class="la iu">漏洞:</strong>破坏访问控制(BAC) &gt;不安全的直接对象引用(IDOR)</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><h1 id="a41a" class="ly lz it bd ma mb nc md me mf nd mh mi jz ne ka mk kc nf kd mm kf ng kg mo mp bi translated">第1部分总结</h1><p id="b758" class="pw-post-body-paragraph ky kz it la b lb mq ju ld le mr jx lg lh ms lj lk ll mt ln lo lp mu lr ls lt im bi translated">我花了一年多的时间在Bugcrowd和HackerOne上获得了5个关键的提交。虽然其中两个是通过简单地运行扫描器识别出来的，但另外两个需要链接较小的漏洞来暴露访问和完成最终利用所需的必要数据。没有一个漏洞是过度技术性的，但3个逻辑错误都需要一点测试，并最终知道去哪里找。</p><p id="aa5d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">在接下来的几周中，我会仔细阅读第2、3和4部分，这三部分将分别涵盖另外5个关键漏洞，因为我已经完成了迄今为止所有20个关键的提交。</p></div><div class="ab cl mv mw hx mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="im in io ip iq"><p id="820f" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我在社交媒体上不太活跃，但你可以在LinkedIn、T2、Bugcrowd或各种安全漏洞或不和谐的服务器上找到我！</p></div></div>    
</body>
</html>