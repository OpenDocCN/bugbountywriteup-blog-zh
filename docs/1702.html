<html>
<head>
<title>CTF Write-Up: Shiftpocalypse</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CTF报道:转移启示</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/ctf-creation-shiftpocalypse-579cb8d6c050?source=collection_archive---------0-----------------------#2021-12-08">https://infosecwriteups.com/ctf-creation-shiftpocalypse-579cb8d6c050?source=collection_archive---------0-----------------------#2021-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><ul class=""><li id="f4d3" class="jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke bi translated">ctf-mystiko.com有CTF挑战赛。</li><li id="1dad" class="jn jo iq jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">挑战名称:Shiftpocalypse</li><li id="e1f9" class="jn jo iq jp b jq kf js kg ju kh jw ki jy kj ka kb kc kd ke bi translated">类别:密码术</li></ul><p id="7f03" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi">— — — — —</p><p id="3f9f" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">我们得到了下面的数字序列:</p><p id="8925" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi">1232 1936 1840 1856 1680 1712 1776 1968 1632 816 1392 1520 1792 816 768 1792 1216 816 1520 1584 1040 1760 1520 576 1664 784 1120 1856 2000</p><p id="eea8" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">挑战的名字包含了两个暗示:“转变”和“天启”。移位表示移位操作已经被使用，或者需要被使用。天启与数字四(天启四骑士)有关。即使我们不把第二个提示与数字4联系起来，我们也可以认为移位操作被应用于标志，我们需要反转它来恢复明文。</p><p id="2c2e" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">移位操作基本上意味着向左移位(&lt;&gt;)。这样，当我们做1&lt;&lt;2时，1(二进制的001)变成4(二进制的100)(这意味着我们将第一个操作数1的位向左移动两个位置，因此001变成010，然后变成100)。注意，由于我们处理的是二进制数，左移运算和乘以2是一回事，右移等于除以2。</p><p id="a3a7" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">为了解决这个问题，我们将创建一个循环，对序列中的数字应用不同数量的位移，并打印输出，希望其中一行是明文标志:</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="13be" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">顾名思义，向右移动四次将返回与明文标志的char值相对应的数字(注意与“%c”格式一起使用的printf，因为我们需要将数字转换为char:</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lg"><img src="../Images/3f7e583eae77cbb0351e48cf61d40ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSpWazjvwkcgbjqJdF6MFw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">在将数字移位4个位置并获得相应的字符后，找到明文标志</figcaption></figure><p id="cd60" class="pw-post-body-paragraph kk kl iq jp b jq jr km kn js jt ko kp ju kq kr ks jw kt ku kv jy kw kx ky ka ij bi translated">有人可能会说，我们本可以转向左边来解决这个挑战。除了尝试两个方向并找到正确的方向之外，请注意，这将意味着获取初始数字序列的原始操作将包含向右移位的情况(因此我们可以用向左移位来撤消这一操作)。但是向右移位是危险的，因为它会将最低有效位“推到”右边，使它们消失，并且以后通过向左移位也无法恢复。如果我们左移一个非常大的数，接近其类型最大允许值的极限，当然也会发生这种情况，但对于我们给定的这些小数字，这是不可预料的。</p></div></div>    
</body>
</html>