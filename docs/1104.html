<html>
<head>
<title>TCS HackQuest Season 5 - First Round CTF Write-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TCS黑客任务第5季-第一轮CTF写</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tcs-hackquest-season-5-first-round-ctf-write-up-75c9ccbd3438?source=collection_archive---------0-----------------------#2021-02-06">https://infosecwriteups.com/tcs-hackquest-season-5-first-round-ctf-write-up-75c9ccbd3438?source=collection_archive---------0-----------------------#2021-02-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/48c88ea4197a7ccddcaea95f7f01474b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*xNpXQ1Ncx5TDmUr7JtNzrw.jpeg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">TCS黑客任务第五季</figcaption></figure><p id="59f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> TCS HackQuest第五季</strong>是由TCS公司从2021年1月23日开始举办的CTF竞赛。</p><p id="c6bd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这场竞赛与网络安全及其在当今网络世界中的重要性有关。</p><p id="a92a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我参加了这个比赛，这是我第一次参加如此大规模的CTF比赛，我习惯了在2020年做一些CTFs，pentesting和漏洞研究，这都要感谢HackTheBox.eu和TryHackMe上的锁定。</p><p id="f9e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，随着昨天结果的公布，我将分享我的想法和我在第一轮中找到这些标志的方法，因为它可能会帮助到一些人！</p><p id="2f71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我只拿到了<strong class="ka ir"> 4个挑战</strong> (3个辅修，1个主修)，加起来<strong class="ka ir"> 700分。</strong></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="96ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一项挑战:我总是…</p><p id="80e9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Flag: </strong> hq5{w1nn324v3n932}</p><p id="d7b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">点数:</strong> 100</p><p id="4cf2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">描述:</strong>将绿巨人的愤怒问题与隐藏的旗帜联系起来。</p><p id="46d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">解决方案/方法:</strong></p><ol class=""><li id="30a5" class="ld le iq ka b kb kc kf kg kj lf kn lg kr lh kv li lj lk ll bi translated">众所周知，浩克是最强的复仇者，这立刻使他的形象细节变得有意义，我还将他与其他复仇者进行了比较，以进行复查。</li></ol><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lm"><img src="../Images/1cdf6c06a6e650b28d72defb2e716cd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Xa298X7BN4R28jgO"/></div></div></figure><p id="3c8d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.我对其中的数据进行了EXIF处理，发现它有一些文件位置(目录/路径)。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/51a6589cd63e0019178e6bb9bd53e178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*M4dPYaElixxe8ArK"/></div></div></figure><p id="bda7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.然后，我只需输入主域，后跟我收到的目录url格式的路径。(tcshackquest.com/avengersassembleathackquest)</p><p id="e63c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.最后，我找到了所需的主旗。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lw"><img src="../Images/63acbe6e081f47544ab3a781907c0c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_tS-ZEUHmy-f9uo4xs-QBQ.png"/></div></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="a625" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">挑战2 : </strong>数码魔术(该挑战在一段时间后被移除)</p><p id="911b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">Flag:</strong>hq5 { s0 _ Y0u _ kn 0 whow $ $ 1 _ worKs }</p><p id="dcb6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">点数:</strong> 100</p><p id="7611" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">描述:</strong>提示就在挑战题目本身:<strong class="ka ir">数字证书</strong>是一个东西。</p><p id="11f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">解决方案/方法:</strong></p><p id="47c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.在这里，我注意到在描述中它说数字证书是必要的，并且它立即点击可能与数字证书本身有关。</p><p id="5f4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.然后通过NIKTO扫描，我获得了详细信息，并跟踪了远程IP，大约是62。XX…默认情况下，它使用HTTP(不安全)协议，并向我显示了一个提示。</p><p id="4c1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.然后，我研究了证书，发现在ISSUER部分隐藏了一个base 64字符串，以及其他详细信息，如下所示:</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/41bed4c8e65530faa10689d0dac825b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oL9aYtPilwvJqXjJ"/></div></div></figure><p id="9d6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.最后，我解码了base64字符串并获得了所需的标志，如下所示:</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lx"><img src="../Images/2850d3df9fbe24e68cba7a263e689f34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RQZk04e1O2mH6PD9"/></div></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="f0a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第三项挑战:雷吉·里奇</p><p id="9cc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">Flag:</strong>hq5 { 3n C2 yp 7 * m 45732 }</p><p id="f21e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">点数:</strong> 100</p><p id="21cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">描述:</strong>使用preg_match()匹配PHP字符串。</p><p id="95da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">解决方案/方法:</strong></p><p id="bd9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.在这里，我注意到在源代码中，通过使用inspect元素，它说它使用了一个使用php preg_match()函数的特定模式。</p><p id="0bc5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.所以我使用了，首先以前缀的方式使用初始字符串，然后是原始字符串，以后缀的方式使用字符串，就像我们通过引用下面的函数得到hackhackquestchampquestchamp作为神奇的字符串。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/6a7bd0b54eb4d67eb7e6a4e8ee39126f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qvUINbctEmT3BrCb"/></div></div></figure><p id="fe2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.所以，这里我们可以说模式1是<strong class="ka ir"> hack </strong>然后模式2是<strong class="ka ir">原声</strong>最后模式3是<strong class="ka ir"> questchamp </strong>。</p><p id="9824" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.最后，在使用了神奇的字符串后，我得到了如下的旗帜:</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/f2bfaec7074840679c4189ad89a5b1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*81IyFSNPbnbHH_9f"/></div></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="0b1a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">挑战四:</strong>疫情抑制剂</p><p id="f31b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">Flag:</strong>hq5 { hopewereturntoheldnormal }</p><p id="2293" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">积分:</strong> 400(当时我得到的唯一一个重大挑战)</p><p id="4ca3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">描述:</strong>疫苗生产厂家和帖子请求是我看完后得到的唯一线索。</p><p id="a076" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">解决方案/方法:</strong></p><p id="df7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.在这种情况下，我发现我们需要向外部转发一个API请求，所以我使用了postman，因为我对它有基本的了解。</p><p id="52aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.我使用了tcshackquest portal中给出的参数，通过定位到API参数的主目录。(下面是目录片段)</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/75bb84c2308c541cda59d3e3f01e6130.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v1SSfmfR3hZ03rrf"/></div></div></figure><p id="5cd4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.然后我意识到我需要传递几个参数，比如SQL注入模式。</p><p id="f425" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.然后，我使用了之前的cookie，我们将它用于主登录(对于hackquest portal ),如下所示:</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lv"><img src="../Images/a4df2c976658c7b3c4fde535ed95442c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*f4GJreaqPSS-heMl"/></div></div></figure><p id="7d16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.最后，在<strong class="ka ir"> Covaxin </strong>值之后，我得到了我的标志，当我使用辉瑞疫苗作为该值时，它向我显示了一个可疑的警告(它真的能治愈它吗？)<strong class="ka ir"><em class="ly"># atmanirbharbharat</em></strong></p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lz"><img src="../Images/1786e6852da62308c490271ba67051e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Wpco3tlk6QgzPja8"/></div></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ma mb mc"><p id="0f91" class="jy jz ly ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated">谢谢你读到这里，请分享这篇文章，并为它的可见性鼓掌，因为它可能也会帮助别人！</p><p id="1bad" class="jy jz ly ka b kb kc kd ke kf kg kh ki md kk kl km me ko kp kq mf ks kt ku kv ij bi translated">我希望这有所帮助，并以某种方式给你一个想法，继续学习，第二轮见！</p></blockquote><p id="035d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">注意安全！保持祝福！</p><p id="1ca2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">可能对你们有用的资源:</strong></p><p id="363d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mg" href="https://github.com/enaqx/awesome-pentest" rel="noopener ugc nofollow" target="_blank"> enaqx/awesome-pentest:一个令人敬畏的渗透测试资源、工具和其他闪亮东西的集合(github.com)</a></p><p id="850c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mg" href="https://github.com/agnaou-abdeljalil/CTF-Tools" rel="noopener ugc nofollow" target="_blank">阿格瑙-阿卜杜勒贾利勒/CTF-图尔斯(github.com)</a></p></div></div>    
</body>
</html>