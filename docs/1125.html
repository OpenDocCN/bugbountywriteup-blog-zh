<html>
<head>
<title>Story of a very lethal IDOR.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个非常致命的恶魔的故事。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/idor-that-allowed-me-to-takeover-any-users-account-129e55871d8?source=collection_archive---------0-----------------------#2021-02-17">https://infosecwriteups.com/idor-that-allowed-me-to-takeover-any-users-account-129e55871d8?source=collection_archive---------0-----------------------#2021-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2b08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好！我叫韦丹特，也叫贝吉塔(在推特上)。我是一名网络安全爱好者，计算机工程专业的学生，也是一名bug赏金猎人。今天我将与你分享我的一个最好的发现。关于目标的信息很少，它是一个target.com的RDP，我们暂且称它为。它基本上是一个有很多功能的在线购物网站。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/99dcdea6b636087856dbb68fbd172df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l3km3sNW8Que7FFz2wJ72A.jpeg"/></div></div></figure><p id="3d03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以事不宜迟，让我们开始吧:)</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="kz la l"/></div></figure><p id="fbec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一阶段:- </strong></p><p id="a614" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以当target.com有很多功能让我玩的时候，我决定在它上面创建一个账户，开始寻找一些基本的漏洞，而不做任何侦察。所以我打开打嗝，开始捕捉请求。我在注册或登录功能中没有发现任何有趣的东西，但是密码重置和其他一些功能容易受到限速攻击。在任何网站上创建帐户时，我输入自己的名字<strong class="jp ir">&lt;h1&gt;tester&lt;/h1&gt;</strong>来检查HTML注入和XSS，因此在target.com上创建帐户时，我也这样做，登录并访问我的仪表板，但不幸的是h1标签没有执行。我继续在我的个人资料部分寻找存储的XSS，但这些字段都不容易受到攻击。然后我转到地址簿部分，在那里我也在所有字段中输入了相同的有效载荷，这次它对名字和姓氏字段有效:)然后我迅速将有效载荷更改为一个简单的XSS有效载荷(<strong class="jp ir">&lt;【SVG onload = alert(document . cookie)&gt;</strong>)，单击保存更改，是的，存储的XSS成功触发了！但是我想到了一个问题，我该如何利用这一点？然后我想起来我以前遇到过这种情况(如果你看过我以前的博客，你就会知道我在想什么)我试图通过将我的名字和姓氏字段改为一个盲XSS有效载荷来利用它，我等了2天，希望管理员会访问我的个人资料，但是没有，似乎管理员并不关心它。然后，我试图利用CSRF攻击存储的XSS，但它也没有工作。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="kz la l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">那时的我😂</figcaption></figure><p id="cbf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二阶段:- </strong></p><p id="7375" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在尝试了所有可能的东西后，我几乎放弃了存储XSS，并开始寻找其他漏洞。我几乎测试了我通常在任何目标中寻找的每个漏洞，但是没有一个有效:(在这一点上，我真的很沮丧。然后，我再次访问了地址簿部分，自我存储的XSS再次触发，所以我点击编辑地址删除XSS有效载荷(它是一次又一次地触发，这真的很烦我😂😂)然后我观察了一下它跟的网址，</p><p id="6649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.target.com/my/addressbook/30913" rel="noopener ugc nofollow" target="_blank">https://www.target.com/my/addressbook/3091</a>6</p><p id="8053" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看完之后，你可能知道该怎么做了，我把那个号码从30916改成了30915，希望能看到别人的地址簿，但是没有，出现了一条信息说，“<em class="km">你不允许做这个动作”。</em>然后我再次编辑地址部分，删除XSS有效载荷，这次我拦截了这个请求，然后我观察到请求中有以下参数:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lf"><img src="../Images/d5839ef02170eb1693f0e0353281dae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ooqqNva7lt4KcCXlDsJrfg.png"/></div></div></figure><p id="2145" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一次，我将Id参数从30916更改为30915，并转发请求，消息显示地址更改成功，但存储的XSS再次触发😂但这一次我知道到底发生了什么，我改变了别人的地址簿:)为了确认这一点，我创建了另一个帐户，并获得了它的地址Id和我的第一个帐户，我去编辑地址部分，只是点击保存更改(保持XSS有效载荷是这样的)， 拦截了这个请求，把我的第一个账户Id改成了第二个账户Id，转发了这个请求，这一次非常成功！ 由于Id很容易被猜到，并且在任何端点上都没有速率限制，所以我可以很容易地接管任何用户的帐户:)</p><p id="4621" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是我从<strong class="jp ir">自存XSS→IDOR→账号接管</strong>。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lg"><img src="../Images/26e1c663ae9462a8f3f2e5484bc54e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YzSjrWVlmq9EmRJbd56uyw.jpeg"/></div></div></figure><p id="d5f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为这是一个RDP，很遗憾我没有因此得到任何奖励，但是我从这个发现中学到了宝贵的一课。我们必须走出舒适区，才能成就大事。如果我甚至没有试图找到那个IDOR漏洞，我就不可能实现这个帐户接管。</p><p id="4e40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢读这篇文章，请鼓掌:)如果你对这篇文章有任何疑问，你可以在这里给我发短信<a class="ae kl" href="https://twitter.com/_justYnot" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="bce8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下次见，再见，黑客快乐！</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="kz la l"/></div></figure></div></div>    
</body>
</html>