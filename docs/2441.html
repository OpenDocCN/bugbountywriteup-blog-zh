<html>
<head>
<title>$6000 with Microsoft Hall of Fame | Microsoft Firewall Bypass | CRLF to XSS | Microsoft Bug Bounty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">微软名人堂6000美元|绕过微软防火墙|从CRLF到XSS |微软Bug赏金</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/6000-with-microsoft-hall-of-fame-microsoft-firewall-bypass-crlf-to-xss-microsoft-bug-bounty-8f6615c47922?source=collection_archive---------0-----------------------#2022-10-12">https://infosecwriteups.com/6000-with-microsoft-hall-of-fame-microsoft-firewall-bypass-crlf-to-xss-microsoft-bug-bounty-8f6615c47922?source=collection_archive---------0-----------------------#2022-10-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3567" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Microsoft防火墙旁路</p><p id="9d30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好黑客，希望你做得很好。我是奈·帕特尔，又名<a class="ae kl" href="https://www.linkedin.com/in/thecyberneh/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">赛博内</strong> </a>，我是一名来自印度的安全研究员。今天我要分享的是我从我们最喜欢的“#微软”和每个bug猎人的梦想“#微软名人堂”获得第一笔4位数赏金的经历为<strong class="jp ir"> P2漏洞</strong><strong class="jp ir"/>S<strong class="jp ir">everity:</strong><strong class="jp ir">重要</strong><strong class="jp ir"/></p><p id="4fa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">Bug:——CRLF到XSS，进一步剥削(你知道怎么处理它)</strong></p><p id="6032" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始旅程吧</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="8cb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我花了两三周时间在微软上寻找有效的bug，但只找到了一些P4和P5。</p><p id="29fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的主要方法是手动检查所有子域，所以我测试了所有子域和每个子域上的大部分功能。</p><p id="649c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在测试了50到70个子域名后，我得到了一种不同的子域(据我所知，这个子域只包括高级客户的功能)。</p><blockquote class="kt ku kv"><p id="cc26" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated"><strong class="jp ir">我想“让我们把重点放在这个子域上，因为它的功能大多是付费的，所以其他安全团队很少探索这些功能”</strong></p></blockquote><p id="7a85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我主要检查了所有不付费的功能(测试不需要任何额外费用)，但没有得到任何东西。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="49b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一番提神之后，我想“还是从非功能测试或者服务器端测试开始吧”。我从最流行的“主机头注入”和其他一些非功能性测试开始。</p><p id="5eb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在花了一些时间在网络应用上之后，我就像“<strong class="jp ir"> <em class="kw">让我们测试一下最容易被忽视的漏洞CRLF注入</em>”</strong></p><h1 id="47f3" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">什么是CRLF？</h1><p id="d1a2" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">CRLF引用了特殊字符元素“CR:回车”和“LF:换行”这些元素嵌入在HTTP报头中，以表示行尾(EOL)标记。</p><p id="e9eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，每当服务器获得CRLF，它就认为这是一个特性，而不是一个错误。</p><h1 id="135f" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">什么是CRLF注射液？</h1><p id="1543" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">当web服务器直接呈现这些特殊字符而不对它们进行编码，并将它们传递给Location、Set-Cookie等响应头时，就会发生CRLF注入。</p><p id="1772" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，基本上，当web应用程序易受CRLF注入攻击时，我们可以将这些特殊字符作为有效载荷发送，服务器会将其解析为行尾，</p><p id="fd42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此之后，CRLF，如果我们发送任何文本，服务器会将它们设置为<strong class="jp ir">响应头</strong></p><p id="ed98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置任意标题，就像我们可以在受害者的浏览器中设置一个cookie，或者我们可以设置“位置:”标题来迫使受害者重定向到恶意站点等等。</p><h1 id="48cf" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">回到故事…</h1><p id="0533" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">所以带着CRLF的意图，我发射了我的第一个有效载荷如下</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="6204" class="mi lb iq me b gy mj mk l ml mm">/%0D%0A%20Set-Cookie:whoami=thecyberneh</span><span id="094f" class="mi lb iq me b gy mn mk l ml mm">so main URL :-  <a class="ae kl" href="https://subD.microsoft.com/%0D%0A%20Set-Cookie:whoami=thecyberneh" rel="noopener ugc nofollow" target="_blank">https://</a><a class="ae kl" href="https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:crlfinjection=thecyberneh" rel="noopener ugc nofollow" target="_blank">subDomain</a><a class="ae kl" href="https://subD.microsoft.com/%0D%0A%20Set-Cookie:whoami=thecyberneh" rel="noopener ugc nofollow" target="_blank">.microsoft.com/%0D%0A%20Set-Cookie:whoami=thecyberneh</a></span></pre><p id="38fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我没有注射任何CRLF。</p><p id="ea75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是回应是<strong class="jp ir">“400错误请求”</strong>，HTML是<strong class="jp ir">“HTTP错误400。请求的URL无效。</strong></p><p id="a5f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我观察到一些不同的情况，主要是当CRLF是不可能的或者当服务器受到很好的保护时，web服务器应该返回<strong class="jp ir">“404 Not Found”</strong>，因为如果服务器受到很好的保护并且我们输入CRLF有效负载，服务器会将该有效负载解析为URL的一部分，在这种情况下，服务器实际上会将<strong class="jp ir">" % 0D % 0A % 20 set-Cookie:whoami = the cyberneh "</strong>解析为与有效负载不同的路径。</p><p id="e214" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而如果没有类似<strong class="jp ir">" % 0D % 0A % 20 set-Cookie:whoami = the cyberneh "</strong>的路径或目录，服务器应该返回<strong class="jp ir">“404 Not Found”</strong>而不是<strong class="jp ir">“400 Bad Request”</strong></p><p id="3378" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我认为服务器没有得到很好的保护，或者防火墙很弱。</p><p id="1732" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了确认，我尝试了这样的随机网址</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="cd09" class="mi lb iq me b gy mj mk l ml mm">https://<a class="ae kl" href="https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:crlfinjection=thecyberneh" rel="noopener ugc nofollow" target="_blank">subDomain</a>.microsoft.com/abcxyzabcxyz</span></pre><p id="f8f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照服务器之前预期的行为，服务器返回了<strong class="jp ir">“404 Not Found”</strong>和HTML响应<strong class="jp ir">“很抱歉，找不到您请求的页面。URL可能拼写错误，或者您要查找的页面不再可用"</strong></p><p id="0df7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以从整体情况来看</p><blockquote class="kt ku kv"><p id="a849" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">如果路径不存在，服务器返回“<strong class="jp ir"> 404未找到”</strong></p><p id="240a" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">当我尝试使用有效负载时，服务器返回“<strong class="jp ir"> 400错误请求</strong></p></blockquote><p id="fabf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这之后，我确信服务器没有受到保护或者防火墙很弱。所以我必须绕过防火墙或者发射正确的载荷</p><p id="8b52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了一些不同的有效载荷，比如:</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="908c" class="mi lb iq me b gy mj mk l ml mm">%0D%0A%20Set-Cookie:whoami=thecyberneh<br/>%20%0D%0ASet-Cookie:whoami=thecyberneh<br/>%0A%20Set-Cookie:whoami=thecyberneh<br/>%2F%2E%2E%0D%0ASet-Cookie:whoami=thecyberneh</span></pre><p id="bf28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在尝试了这个有效负载后，我只得到<strong class="jp ir">“400错误请求”</strong>所以我想我需要一些不同的东西，因为大多数防火墙会阻止正常和基本的有效负载。</p><p id="999e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做了一些研究，得到了一些独特的编码，叫做“GBK编码”。</p><h1 id="bbc8" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">了解编码和#防火墙旁路</h1><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="3437" class="mi lb iq me b gy mj mk l ml mm">Payload responsible for CRLF injection is :- 嘍嘊</span></pre><p id="d914" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在得到这个有效载荷后，我为CRLF注入制作了一个新的有效载荷和新的URL，这次是用<strong class="jp ir">“防火墙旁路”</strong></p><p id="8cf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我还使用了<strong class="jp ir"> URL编码</strong>来避免类似的进一步错误</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="4816" class="mi lb iq me b gy mj mk l ml mm"><strong class="me ir">BeforeURL Encoding</strong></span><span id="80fc" class="mi lb iq me b gy mn mk l ml mm">Main Payload:- 嘍嘊</span><span id="834e" class="mi lb iq me b gy mn mk l ml mm"><strong class="me ir">After URL Encoding</strong></span><span id="9933" class="mi lb iq me b gy mn mk l ml mm">嘍 :- %E5%98%8D</span><span id="23b7" class="mi lb iq me b gy mn mk l ml mm">嘊 :- %E5%98%8A</span></pre><p id="eba8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在URL编码之后，我制作了一个新的有效载荷，就像这样</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="51d3" class="mi lb iq me b gy mj mk l ml mm"><a class="ae kl" href="https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:crlfinjection=thecyberneh" rel="noopener ugc nofollow" target="_blank">https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:crlfinjection=thecyberneh</a></span></pre><p id="27d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用这个网址试了试，然后嘣！！！</p><p id="1d16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得到了一个响应，标题是:<strong class="jp ir">Set-Cookie:crlfinject = the cyberneh</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/e5b119d6bd102476b23e7894772444ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BO8ScjUEWF_38E2AXJCsww.jpeg"/></div></div></figure><p id="659a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那个特别的时刻，我非常开心</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="d710" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我知道我可以用这个CRLF注射做很多事情，所以我没有报告，并试图与其他一些错误联系起来。</p><h1 id="7c8d" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">绕过防火墙从CRLF到XSS</h1><p id="cbea" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">如您所知，在请求和响应标头的末尾有一个空行，如下所示:-(请求中的第13行和响应中的第20行)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/5e8397d6076ec41a94964cbe0020eac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3b531xS114IZ7lsvxxnjAw.jpeg"/></div></div></figure><p id="ceb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在那个时候，服务器正在发送这样的响应:-(默认情况下，作为功能)</p><p id="14e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我得到的回应的结构:- </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/630c327a9808d79c0f659ae630965232.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*s6RuNicYTQ_5N8mvlFWYpA.png"/></div></figure><p id="ec56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">真实影像:- </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/d50918d1d08b2cadd3290f5e48f9e20e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YD6ItT4l1BDLC7Twr65Raw.png"/></div></div></figure><blockquote class="kt ku kv"><p id="c917" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">所以现在，如果我想要XSS，我必须在响应的主体部分插入一个Javascript有效载荷，因为Javascript可以在主体中呈现，为此，<strong class="jp ir">我必须强制服务器发送这样的响应</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/133c9433d716dbb411d493db71f32542.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*R4BOzzVUvSxNegAfVgu1xw.png"/></div></figure><p id="5165" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，</p><ol class=""><li id="5ecc" class="mx my iq jp b jq jr ju jv jy mz kc na kg nb kk nc nd ne nf bi translated"><strong class="jp ir"> #HEADERS </strong>意味着我们必须精心制作有效载荷，迫使服务器在有效载荷结束后发送一个空行，这样有效载荷后面的头将被解析为垃圾或忽略它们</li><li id="5876" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk nc nd ne nf bi translated">#有效载荷_XSS 是指我们在XSS的有效载荷</li></ol><p id="834c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我处于其中一个困难的部分，因为我必须手动强制服务器发送这样的恶意响应，</p><p id="3b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">I inserted a single CRLF payload like “嘍嘊” ( with URL encoding <a class="ae kl" href="https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:crlfinjection=thecyberneh" rel="noopener ugc nofollow" target="_blank">%E5%98%8D%E5%98%8A</a> ), but did not get the single blank line as expected,</p><p id="5bef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我插入了这个有效载荷两次，之后，我成功地迫使服务器发送一个空行作为响应。</p><p id="bb61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即制作了一个有效载荷(绕过防火墙)，用它来获得XSS和HTML注入。</p><p id="dd71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我想要的响应结构:- </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/133c9433d716dbb411d493db71f32542.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*R4BOzzVUvSxNegAfVgu1xw.png"/></div></figure><p id="9123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">真实图像:- </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/c4411a84335969d224a8fea06f7b484d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwyoyD4HDJ6Zl6mYsqIZ-Q.png"/></div></div></figure><p id="b5d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我要和你分享这些有效载荷。</p><h1 id="0b27" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">通过防火墙旁路了解新的有效负载</h1><p id="7c95" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">我创建了以下有效载荷来获取XSS</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/7f4bffcff637f3e7b7f3e4980c99c9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6V1F6eEBmE6GMDGaDUQpXA.png"/></div></div></figure><p id="d58d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我将正常的有效载荷编码如下，以绕过防火墙</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="b7ce" class="mi lb iq me b gy mj mk l ml mm">“&lt;” as 嘼</span><span id="9685" class="mi lb iq me b gy mn mk l ml mm">“&gt;” as 嘾</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nm"><img src="../Images/1d93581170d572c97051390f59313646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5-Q0T5eneXO2qMqxZKmlCQ.png"/></div></div></figure><p id="79b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我从CRLF到XSS的有效载荷是</p><p id="9178" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我执行了URL编码以避免错误，我的最终有效负载是:-</p><pre class="km kn ko kp gt md me mf mg aw mh bi"><span id="49fc" class="mi lb iq me b gy mj mk l ml mm">#ENCODING</span><span id="3563" class="mi lb iq me b gy mn mk l ml mm">“&lt;” --&gt; 嘼 --&gt; %E5%98%BC</span><span id="91b1" class="mi lb iq me b gy mn mk l ml mm">“&gt;” --&gt; 嘾 --&gt; %E5%98%BE</span><span id="ce44" class="mi lb iq me b gy mn mk l ml mm"><a class="ae kl" href="https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:whoami=thecyberneh%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%BCscript%E5%98%BEalert(1);%E5%98%BC/script%E5%98%BE" rel="noopener ugc nofollow" target="_blank">https://subDomain.microsoft.com/%E5%98%8D%E5%98%8ASet-Cookie:whoami=thecyberneh%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%8D%E5%98%8A%E5%98%BCscript%E5%98%BEalert(1);%E5%98%BC/script%E5%98%BE</a></span></pre><p id="e16c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">插入有效载荷后，我得到了最漂亮的结果</p><p id="3f0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我正在分享一些美丽的截图</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nn"><img src="../Images/6f5e836da0f00dc832d793234575f417.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYf2MEd81bUZv_x3b77L_w.jpeg"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi no"><img src="../Images/efd5dab27a9ee49ac95e12476f302547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FYHlS25Bf20NniYwSpR_nQ.png"/></div></div></figure><p id="c07c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我提交了这个bug，然后我用shell脚本创建了一个自动化工具来检查子域列表中的CRLF，</p><p id="3f06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行该工具后，我从微软获得了另一个领域的另一个CRLF。</p><blockquote class="kt ku kv"><p id="ea90" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated">注意:-我没有提到CRLF的进一步开发，因为这已经是一篇很长的文章了，现在很容易与一些更有影响的错误联系起来</p></blockquote><h1 id="74e2" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">影响:-</h1><ul class=""><li id="30ab" class="mx my iq jp b jq ly ju lz jy np kc nq kg nr kk ns nd ne nf bi translated">任意头部注射</li><li id="a1f5" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">任意Cookie注入</li><li id="3ad3" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">Javascript注入(XSS)</li><li id="dced" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">HTML注入</li><li id="608e" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">HTTP请求拆分</li><li id="de88" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">绕过基于Cookie的CSRF保护</li><li id="2b66" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">使用过长Cookies的应用程序拒绝服务</li><li id="4751" class="mx my iq jp b jq ng ju nh jy ni kc nj kg nk kk ns nd ne nf bi translated">攻击者可以设置新的报头</li></ul><p id="f92c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我报告了他们两个，并在3周内得到了关于赏金的回复。</p><blockquote class="kt ku kv"><p id="bc1b" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated"><strong class="jp ir">优先:P2 </strong></p><p id="3910" class="jn jo kw jp b jq jr js jt ju jv jw jx kx jz ka kb ky kd ke kf kz kh ki kj kk ij bi translated"><strong class="jp ir">严重性:重要</strong></p></blockquote><p id="ec49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样，我得到了总共6000美元的奖金和微软名人堂。</p><h2 id="a69e" class="mi lb iq bd lc nt nu dn lg nv nw dp lk jy nx ny lo kc nz oa ls kg ob oc lw od bi translated">给读者的信息:-</h2><p id="8aca" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">如果你喜欢这篇文章，你可以在Twitter、Instagram和Linkedin上联系我，获取我所有的文章。</p><p id="a168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我错过了什么，请告诉我</p><h2 id="c816" class="mi lb iq bd lc nt nu dn lg nv nw dp lk jy nx ny lo kc nz oa ls kg ob oc lw od bi translated">让我们连接…</h2><p id="ca9c" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">推特:-<a class="ae kl" href="https://twitter.com/thecyberneh" rel="noopener ugc nofollow" target="_blank">https://twitter.com/thecyberneh</a>[<a class="ae kl" href="https://twitter.com/thecyberneh" rel="noopener ugc nofollow" target="_blank">the cyberneh</a></p><p id="f641" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">LinkedIn:-<a class="ae kl" href="https://www.linkedin.com/in/thecyberneh" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/thecyberneh</a>[<a class="ae kl" href="https://www.linkedin.com/in/thecyberneh" rel="noopener ugc nofollow" target="_blank">the cybernet</a></p><p id="89a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">insta gram:-【https://www.instagram.com/thecyberneh/】T4[<a class="ae kl" href="https://www.instagram.com/thecyberneh/" rel="noopener ugc nofollow" target="_blank">the cyberneh</a>]</p><p id="7c6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读…</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><h2 id="ea03" class="mi lb iq bd lc nt nu dn lg nv nw dp lk jy nx ny lo kc nz oa ls kg ob oc lw od bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>