<html>
<head>
<title>Red Teaming Engagement</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">红队交战</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/red-teaming-engagement-71bae2b48f76?source=collection_archive---------1-----------------------#2020-11-27">https://infosecwriteups.com/red-teaming-engagement-71bae2b48f76?source=collection_archive---------1-----------------------#2020-11-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e334" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">终极道德黑客的最深潜水</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/8b3d75382f6f3d1b65de6733d00fed99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_Chfjh9ZK5pxkhtVXDRjg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.fireeye.com/mandiant/red-team-assessment.html" rel="noopener ugc nofollow" target="_blank">https://www.fireeye.com/mandiant/red-team-assessment.html</a></figcaption></figure><p id="4a1b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Red Teaming是一个目标导向的多层攻击模拟练习。此练习基于对组织资产面临的威胁风险级别的识别。Red Teaming还通过模拟真实世界的场景来挑战事件响应团队的能力，扮演不同类型的威胁参与者角色，如黑客行动主义者、网络恐怖分子、间谍等，从而定义组织的整体安全态势。</p><blockquote class="lv"><p id="8cdc" class="lw lx it bd ly lz ma mb mc md me lu dk translated">红色团队的最终目标是获取敏感的公司资产。</p></blockquote></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="3f2e" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">渗透测试与红队合作</h1><ul class=""><li id="32cf" class="ne nf it lb b lc ng lf nh li ni lm nj lq nk lu nl nm nn no bi translated">渗透测试侧重于发现漏洞并加以利用，而Red Teamer则更进一步，执行一种利用后方法来访问组织的关键资产。</li><li id="9d93" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">渗透测试更侧重于项目，而红队是基于客观/场景的测试。</li><li id="78b4" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">渗透测试人员在规定的范围内工作；红队的范围很广，对不应该做的事情没有什么限制。</li><li id="8fc7" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">渗透测试是一种短期项目测试，需要一天到两周的渗透测试；而在红队训练中，持续时间在2周到几个月之间。</li><li id="d327" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">渗透测试仪与CSOC一起工作，并预先通知他们有关测试活动的细节；相比之下，红色团队将避免CSOC检测，因为他们模仿真实世界的网络罪犯。他们复制真实世界对手的技术、战术和程序(TTP)。CSOC通常直到最后才知道他们正在进行的测试。这是CSOC和红队之间的一场猫捉老鼠的游戏，他们互相挑战以增强组织的安全态势。</li><li id="3186" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">渗透测试人员通常使用现成的工具来利用已知的漏洞；而红队队员则需要创造自己的工具/漏洞来实施攻击。</li></ul></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><p id="259e" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">常见红色组队要求</strong></p><ul class=""><li id="523e" class="ne nf it lb b lc ld lf lg li nu lm nv lq nw lu nl nm nn no bi translated">忠诚调查</li><li id="5ea2" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">行业认可的pentest资格:OSCE OSCP，CREST CCSAS</li><li id="7595" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">需要时，必须能灵活适应非正常工作时间。</li><li id="c756" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">对通用C2框架、TTP、网络杀伤链、风险等有深入的了解。</li></ul><h1 id="687d" class="mm mn it bd mo mp nx mr ms mt ny mv mw jz nz ka my kc oa kd na kf ob kg nc nd bi translated">红队方法论</h1><h2 id="ed5a" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">第一步。</strong>红色团队的目标和范围</h2><p id="d0db" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">红队的“交战规则”将列出允许实施的网络攻击的目标和类型。</p><p id="21e7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">该范围还将确定不会成为目标的任何异常。</p><p id="e3aa" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">红色团队的持续时间将由客户确认。</p><p id="8418" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">需要客户签署的“授权书”LoA信，以授予对其托管基础设施进行网络攻击的许可。</p><blockquote class="or os ot"><p id="eea8" class="kz la ou lb b lc ld ju le lf lg jx lh ov lj lk ll ow ln lo lp ox lr ls lt lu im bi translated"><em class="it">在我的一篇文章— </em> <a class="ae ky" href="https://medium.com/bugbountywriteup/baseline-security-check-i-61ce01cfcaf9" rel="noopener"> <em class="it">基线安全检查</em> </a> <em class="it">中，我提到了几个可以用于执行red团队练习的领域。</em></p></blockquote><p id="069d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">红色团队合作的类型有:</strong> <strong class="lb iu">主动</strong>、<strong class="lb iu">被动、</strong>或<strong class="lb iu">物理</strong></p><p id="97d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">举几个例子，以下是攻击途径:</p><h2 id="c5eb" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated">活跃的</h2><ul class=""><li id="002a" class="ne nf it lb b lc ng lf nh li ni lm nj lq nk lu nl nm nn no bi translated">网络VA和PT</li><li id="bfb0" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">Web应用程序和移动PT</li><li id="94c9" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">水坑攻击</li><li id="85a9" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">Kerberoasting</li><li id="7780" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">活动目录数据泄漏</li><li id="43e9" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">AV规避</li><li id="7078" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">NFS文件共享枚举</li><li id="56ad" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">弱密码枚举</li></ul><h2 id="fcad" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated">消极的</h2><ul class=""><li id="88e9" class="ne nf it lb b lc ng lf nh li ni lm nj lq nk lu nl nm nn no bi translated">网络钓鱼</li><li id="1dda" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">视觉</li><li id="bf7f" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">勒索软件</li><li id="fc31" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">嗅</li></ul><h2 id="0591" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated">身体的</h2><ul class=""><li id="f4bf" class="ne nf it lb b lc ng lf nh li ni lm nj lq nk lu nl nm nn no bi translated">尾部门控</li><li id="5e20" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">战争驾驶</li><li id="ce4c" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">流氓接入点</li><li id="84b0" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">现场社会工程</li><li id="1e6b" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">路过式下载</li></ul><p id="4a36" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ou">假设红色团队合作目标是</em> <strong class="lb iu"> <em class="ou">文件服务器分类。</em> </strong></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="9c07" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">第二步。</strong>信息收集</h2><p id="e12e" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">这是一次被动侦察，收集范围内约定目标的数据。</p><p id="da92" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ou">即在没有任何适当控制的情况下，探究有多少文件共享暴露给网络上的每个人。这项任务通常由初级渗透测试人员执行。</em></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="74dc" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">第三步。</strong>攻击映射和规划</h2><p id="16ee" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">发布信息收集—然后由Red Teamers和juniors执行攻击路径方法，以识别多个漏洞并了解资产的风险级别。网络攻击的类型以及它们将如何被执行被绘制出来。</p><p id="69b7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ou">即列举暴露的NFS文件共享并寻找进一步渗透的方法以获得立足点&gt;权限提升&gt;横向移动以最终获得系统访问权。</em></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="6064" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">步骤四。</strong>执行攻击和渗透</h2><p id="fda5" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated"><strong class="lb iu">指挥和控制(C2)开发后框架</strong></p><p id="148a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">一旦红队利用漏洞并获得系统访问权，C2框架将被用于进行后期利用，例如:</p><ul class=""><li id="1cdd" class="ne nf it lb b lc ld lf lg li nu lm nv lq nw lu nl nm nn no bi translated">权限提升</li><li id="fff4" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">绕轴旋转</li><li id="0d57" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">横向运动</li><li id="5130" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">数据泄漏</li><li id="eff1" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">加密密钥下载(勒索软件攻击)等。</li></ul><p id="89a5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">常见的C2框架包括:</strong></p><ul class=""><li id="94d4" class="ne nf it lb b lc ld lf lg li nu lm nv lq nw lu nl nm nn no bi translated">钴罢工</li><li id="d544" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">PoshC2</li><li id="5ea1" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">Powershell帝国</li><li id="391e" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">米特ATT和CK</li></ul></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="1815" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">步骤五。</strong>报告和补救建议</h2><p id="fada" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">报告重现此攻击的关键发现和步骤。</p><p id="e524" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">以下是一些常规补救措施。</strong></p><ul class=""><li id="9fc9" class="ne nf it lb b lc ld lf lg li nu lm nv lq nw lu nl nm nn no bi translated">外围防火墙或外围日志将威胁智能数据收集到中央日志服务器或CSOC，以识别恶意URL和IP地址。</li><li id="a1f3" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">使用Splunk和ELK Stack等工具可以识别恶意C2流量。</li><li id="06a1" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">入侵检测系统和入侵防御系统可监控匿名网络流量行为，并将日志发送到威胁情报工具(即Splunk)进行进一步分析。</li><li id="6375" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">适当的网络分段。</li><li id="bc5f" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu nl nm nn no bi translated">实施网络访问控制(NAC ),将访问控制限制在私有网络之外的未授权用户和设备。</li></ul></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h2 id="291d" class="oc mn it bd mo od oe dn ms of og dp mw li oh oi my lm oj ok na lq ol om nc on bi translated"><strong class="ak">第六步。</strong>重新测试</h2><p id="c306" class="pw-post-body-paragraph kz la it lb b lc ng ju le lf nh jx lh li oo lk ll lm op lo lp lq oq ls lt lu im bi translated">根据安全架构师制定的补救措施，重新测试最初的测试结果。此文档将包括哪些调查结果是固定的，哪些不是或已授予风险例外。然后，红队队员将重新进行攻击，以查看所应用的控制是否有效，问题现在是否已得到缓解。</p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="237b" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">参考</h1><ol class=""><li id="7f0e" class="ne nf it lb b lc ng lf nh li ni lm nj lq nk lu oy nm nn no bi translated"><a class="ae ky" href="https://www.foregenix.com/blog/a-first-look-at-todays-command-and-control-frameworks" rel="noopener ugc nofollow" target="_blank">https://www . foregenix . com/blog/a-first-look-at-todays-command-control-frameworks</a></li><li id="4d10" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu oy nm nn no bi translated">【https://en.wikipedia.org/wiki/Network_Access_Control T4】</li><li id="2165" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu oy nm nn no bi translated"><a class="ae ky" href="https://www.synopsys.com/glossary/what-is-red-teaming.html" rel="noopener ugc nofollow" target="_blank">https://www.synopsys.com/glossary/what-is-red-teaming.html</a></li><li id="9311" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu oy nm nn no bi translated"><a class="ae ky" href="https://www.harmj0y.net/blog/redteaming/file-server-triage-on-red-team-engagements/" rel="noopener ugc nofollow" target="_blank">https://www . harmj 0y . net/blog/red teaming/file-server-triage-on-red-team-engagements/</a></li><li id="ae4b" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu oy nm nn no bi translated"><a class="ae ky" href="https://www.tripwire.com/state-of-security/mitre-framework/the-mitre-attck-framework-command-and-control/" rel="noopener ugc nofollow" target="_blank">https://www . tripwire . com/state-of-security/mitre-framework/the-mitre-attck-framework-command-and-control/</a></li><li id="b8ca" class="ne nf it lb b lc np lf nq li nr lm ns lq nt lu oy nm nn no bi translated"><a class="ae ky" href="https://resources.infosecinstitute.com/topic/red-teaming-overview-assessment-methodology/" rel="noopener ugc nofollow" target="_blank">https://resources . infosec institute . com/topic/red-teaming-overview-assessment-methodology/</a></li></ol></div></div>    
</body>
</html>