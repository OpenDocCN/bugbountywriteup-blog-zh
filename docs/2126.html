<html>
<head>
<title>How I found a Critical Bug in Instagram and Got 49500$ Bounty From Facebook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何在Instagram中发现一个关键漏洞，并从脸书那里获得49500美元奖金的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-found-a-critical-bug-in-instagram-and-got-49500-bounty-from-facebook-626ff2c6a853?source=collection_archive---------0-----------------------#2022-06-12">https://infosecwriteups.com/how-i-found-a-critical-bug-in-instagram-and-got-49500-bounty-from-facebook-626ff2c6a853?source=collection_archive---------0-----------------------#2022-06-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="27b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我是Neeraj Sharma，一个来自印度的20岁的安全爱好者。</p><h2 id="edc4" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">描述</h2><p id="5a01" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">利用该漏洞，攻击者可以通过了解任何Instagram用户的clips_media_id(卷的媒体id)来更改该用户的卷缩略图。</p><h2 id="282b" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">所以我是如何发现这个Bug的——故事情节(没有技术细节)</h2><p id="bbb1" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">我从2021年12月开始在Instagram应用上打猎。最初，我在Instagram Ads GraphQL API上测试，但经过长时间的搜索，当我在那里找不到任何错误时，我开始在Instagram reels部分搜索。在花了一些时间与目标，我来到了用户可以编辑他们的卷轴封面照片(缩略图)的点。为了测试，我改变了我的卷轴。我使用burp拦截了所有的HTTP请求，在转发了一些请求后，我看到了下面的HTTP请求。</p><h2 id="8ea8" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">易受攻击的端点:</h2><blockquote class="lj lk ll"><p id="c04a" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated">POST/API/v1/media/configure _ to _ clips _ cover _ image/HTTP/2<br/>主机:i.instagram.com<br/>X-Ig-App-Locale:en _ US<br/>X-Ig-Device-Locale:en _ US<br/>X-Ig-Mapped-Locale:en _ US<br/>X-Pigeon-Session-Id:UFS-76e 15775–9d 76-xxxx-a9ff-9e 773 f 1434 f 3–0<br/>X-Pigeon-raw client time:16320dpi720x1184未知/安卓；vbox86pvbox86en _ US356747126) <br/>接受-语言:en-US <br/>授权:无记名IGT:2:&lt;base 64 _ Encoded _ Token&gt;<br/>X-Mid:ynja 7 aabaafbawyzna 1j 4 pu-Mf2e<br/>Ig-U-Ig-Direct-Region-Hint:ASH，446 xxxxxxxxx，168 xxxxxxxx:01 f7b 979 c 4246 d13 c 5918 e 1c 108d 4700charset = UTF-8<br/>Content-Length:100<br/>Accept-Encoding:gzip，deflate<br/>X-f b-Http-Engine:Liger<br/>X-f b-Client-Ip:True<br/>X-f b-Server-Cluster:True</p><p id="33e3" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated">clips _ media _ id = 2763122193610 xxxxxxxx &amp; _ uuid = 8893 c680–7663–48 a4–95dc-DD 91 b 9 XXXXXX &amp; upload _ id = 326264 xxxxx</p></blockquote><p id="ce99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">这里有两个主要参数:</strong></p><blockquote class="lj lk ll"><p id="2ade" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">剪辑_媒体_id </em></p><p id="0e24" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">上传_id </em></p></blockquote><p id="8cb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">剪辑媒体id是卷轴ID。</p><p id="3d56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Upload_id是我想在缩略图上插入的照片的id。</p><p id="82da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将此请求发送到中继器，然后用我的测试卷的<em class="lm"> media_id </em>替换我的<em class="lm"> clips_media_id </em>，并将请求转发到浏览器。令我惊讶的是，未经授权的测试卷轴，用户将永远无法控制其缩略图被改变。</p><p id="3048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用我的不同帐户再次尝试，并用我的第二个帐户卷轴媒体id替换了<em class="lm"> clips_media_id </em>。而不是我的第一个帐户卷轴，第二个帐户的缩略图改变了。</p><p id="0f4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我很惊讶，因为我没有想到像META这样的巨头的子公司会如此脆弱。我立即向Meta安全团队报告了此事。</strong></p><h2 id="f9a8" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated"><strong class="ak">冲击</strong>:</h2><p id="2e6e" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">这个bug允许恶意演员更改Instagram上任何卷轴的缩略图。要执行此攻击，只需要目标用户卷的媒体ID。</p><p id="64f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在C-I-A三元组中，完整性被破坏，攻击者的行为完全无视受害者的可及性。从而考虑0交互和元安全操作的最终影响分析。元团队决定了这$$$$$的巨额奖励。换句话说，恶意行为者能够在没有任何授权或受害者互动的情况下，在任何档案中伪造缩略图。这种影响在Instagram用户中广泛传播。</p><h2 id="2188" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">概念证明:</h2><p id="fff1" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">PS:所有测试都是在我的测试账户上进行的:)</p><p id="3304" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lq" href="https://youtu.be/1X7I25-rSqE" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">视频</strong> </a></p><figure class="lr ls lt lu gt lv"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="8b27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">圣人</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ly"><img src="../Images/bd7e51677f74ddb933bdfd67934a2ec9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cyV_h7KRWN0s9VmLylwVqQ.png"/></div></div></figure><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mf"><img src="../Images/de8865dc820a49f1d835738fab25cae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEw_3ig5p4U9fTiB6pdAHA.png"/></div></div></figure><p id="248c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我要感谢元安全团队给予我的巨额奖金😊</strong></p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mg"><img src="../Images/c3ace5feb24bbcb848f6772b15adfb7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eMfezZaGjtqPzLv0b25NLg.png"/></div></div></figure><p id="82db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也非常感谢我的朋友<a class="ae lq" href="https://in.linkedin.com/in/vatsal-vaishy-479503141" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">vats al vaish</strong></a>在这篇文章中帮助了我:)</p><h2 id="71af" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">时间线:</h2><p id="b70e" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">2022年1月31日:报告已发送</p><p id="e243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">03-Feb-2022:收到元安全团队的回复以了解更多信息</p><p id="8f9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2022年2月8日:报告已分类</p><p id="fa11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2022年5月11日:获得49500美元奖金(45000美元奖金+ 4500美元红利)🥳</p></div></div>    
</body>
</html>