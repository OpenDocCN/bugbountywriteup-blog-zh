<html>
<head>
<title>Finding Data Leaks In Online Formatters</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在联机格式化程序中查找数据泄漏</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/finding-data-leaks-in-online-formatters-404503b9fcb0?source=collection_archive---------0-----------------------#2020-12-27">https://infosecwriteups.com/finding-data-leaks-in-online-formatters-404503b9fcb0?source=collection_archive---------0-----------------------#2020-12-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="2ae9" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">使用Postman和Newman查找保存在在线格式化工具中的有用数据</h2></div><p id="a312" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您是web开发人员，您可能使用过任何在线代码格式化程序。网上有上百种不同用途的代码格式化器，比如格式化<em class="le"> HTML </em>、<em class="le"> XML </em>、<em class="le"> JSON </em>等。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/426fd1dae761b0850f32c415d5d472ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eShP9pgf0QvFR1Jh3UG-_w.jpeg"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">格式良好的代码通过<a class="ae lv" href="https://unsplash.com/photos/zE007SNgcdE" rel="noopener ugc nofollow" target="_blank">去毛刺</a>来提高代码的可读性</figcaption></figure><p id="aa38" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些格式化程序的一个共同特点是，您可以保存格式化数据的在线版本。<strong class="kk iu">需要注意的是，这使得任何知道生成的<em class="le"> URL </em> </strong>的人都可以公开使用您的代码。</p><p id="19b1" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这个故事中，我将重点介绍<a class="ae lv" href="https://jsonformatter.org" rel="noopener ugc nofollow" target="_blank"> <em class="le"> JSON格式化程序</em> </a>，这是一个验证和格式化<em class="le"> JSON </em>内容的在线工具。通过进行一个简单的测试，并借助于<em class="le"> Chrome开发工具</em>，我可以很容易地识别出保存和获取已保存的<em class="le"> JSON </em>内容的<em class="le"> API </em>端点，以及生成的<em class="le"> URL </em>的种类。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lw"><img src="../Images/27c75a560760ad1ab074c770174cacf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADSMSc7rupqrxPKhQOrYMw.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">保存内容的id是一个增量数字，而生成的URL是一个6位十六进制数字</figcaption></figure><p id="5626" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="kk iu">保存内容的id</strong><strong class="kk iu">和<em class="le"> URL </em> </strong>中使用的生成id没有直接的关联。这是一种增加提取保存数据难度的方法，这对于增量生成的<em class="le">URL</em>来说是微不足道的。</p><figure class="lg lh li lj gt lk"><div class="bz fp l di"><div class="lx ly l"/></div></figure><p id="37a0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">提取所有已保存信息的一种方法是用6个十六进制字符探索id的全部范围，从<em class="le">‘000000’</em>到<em class="le">‘ffffff’</em>。<strong class="kk iu">这将需要16^6尝试</strong> <strong class="kk iu">来检查该范围</strong>中的每个数字，这相当于16，777，216个请求。</p><p id="cc8e" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了避免产生如此大量的请求，我们可以使用一个随机算法——<a class="ae lv" href="https://en.wikipedia.org/wiki/Las_Vegas_algorithm" rel="noopener ugc nofollow" target="_blank"><em class="le">【拉斯维加斯】</em></a><em class="le">——</em>，在这个范围内生成一个随机id。多次运行这种概率算法会降低没有结果的概率。</p><h1 id="3fbb" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">提取保存的数据</h1><p id="6bb2" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">为了提取保存在<em class="le"> JSON格式化程序</em>上的数据，我们将使用<a class="ae lv" href="https://www.postman.com" rel="noopener ugc nofollow" target="_blank"> <em class="le"> Postman </em> </a>和<a class="ae lv" href="https://github.com/postmanlabs/newman" rel="noopener ugc nofollow" target="_blank"> <em class="le"> Newman </em> </a>，这是我最喜欢的使用<em class="le">API</em>的工具。</p><p id="5f41" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le"> Postman </em>的导入特性使得复制请求以获取保存的<em class="le"> JSON </em>的内容变得很简单。只需在<em class="le"> Chrome开发者工具</em>中将请求复制为<em class="le"> cURL </em>，并在<em class="le"> Postman </em>中将其导入为<em class="le"> Raw text </em>。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mw"><img src="../Images/d81dcf9ad4d250639d177b4114d5ed74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1_r_8P0su5roxA6TShLi_w.png"/></div></div></figure><p id="a9e9" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一旦导入了请求，我们将添加一个<em class="le">预请求脚本</em>来生成一个6个十六进制数字的随机id，并将其存储在一个环境变量中。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mx"><img src="../Images/8cca91f9c953ee4f150f133b7e55c4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QcPMrXkFl4A56xwI2_m6MQ.png"/></div></div></figure><p id="357a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们可以用生成的id替换请求体中的<em class="le">‘urlid’</em>参数。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi my"><img src="../Images/3d724b29e3fdaacc1d6ff163f1ff372f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eqjU6DtXdq3fZy81Ur_2Qg.png"/></div></div></figure><p id="253f" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在<em class="le">测试</em>部分，我们可以检查是否得到了非空响应，以及内容是否包含任何关键字。在任何情况下，我们都将把响应发送给一个本地的<em class="le"> ExpressJS API </em>，它将把响应存储在一个<em class="le"> MongoDB </em>集合中，供以后分析。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi mz"><img src="../Images/684ef25d246356ac66c0c1028c1d1931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vfcun_2D6H0Evm71lkpjhw.png"/></div></div></figure><p id="797d" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">最后，通过将下一个请求设置为这个相同的请求，我们创建了一个无限循环来使用<em class="le"> Newman </em>运行这个集合，延迟两秒钟以避免<em class="le"> JSON格式化程序API </em>过载。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi na"><img src="../Images/ea1cf67f5f98222335890c3f595a1a49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULsnSpnAFqyqfM_OLnr0pA.png"/></div></div></figure><p id="2141" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">而<em class="le">就这些，乡亲们！</em>。我们只需要让这个集合运行一段时间来收集一些结果。</p><h1 id="3390" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">深入收集的数据集</h1><p id="18ef" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">在收集运行期间，我收集了515个结果。这个过程中最无聊的部分就是在检索到的<em class="le">JSON</em>列表中搜索有用的数据。虽然我加了一个关键词来减少这个工作，但是还是一个手工的过程。</p><p id="7074" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在查看数据集后，我发现<strong class="kk iu">绝大多数获得的结果都是哑数据或完全无用的数据</strong>。</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="51af" class="ng ma it nc b gy nh ni l nj nk"><em class="le">// Example of dummy data</em><br/>{<br/>  "employees": {<br/>    "employee": [<br/>      {<br/>        "id": "1",<br/>        "firstName": "Tom",<br/>        "lastName": "Cruise",<br/>        "photo": "<a class="ae lv" href="https://jsonformatter.org/img/tom-cruise.jpg" rel="noopener ugc nofollow" target="_blank">https://jsonformatter.org/img/tom-cruise.jpg</a>"<br/>      },<br/>      {<br/>        "id": "2",<br/>        "firstName": "Maria",<br/>        "lastName": "Sharapova",<br/>        "photo": "<a class="ae lv" href="https://jsonformatter.org/img/Maria-Sharapova.jpg" rel="noopener ugc nofollow" target="_blank">https://jsonformatter.org/img/Maria-Sharapova.jpg</a>"<br/>      },<br/>      {<br/>        "id": "3",<br/>        "firstName": "Robert",<br/>        "lastName": "Downey Jr.",<br/>        "photo": "<a class="ae lv" href="https://jsonformatter.org/img/Robert-Downey-Jr.jpg" rel="noopener ugc nofollow" target="_blank">https://jsonformatter.org/img/Robert-Downey-Jr.jpg</a>"<br/>      }<br/>    ]<br/>  }<br/>}</span></pre><p id="17b4" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">也有一些奇怪的结果，比如一个小游戏的问题列表，一个聊天机器人的答案，一次南极旅行的促销代码，一些发票，或者一辆卡车在美国的路线。</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="3002" class="ng ma it nc b gy nh ni l nj nk">// Example of one of the questions of the <em class="le">Trivia</em><br/>{<br/>  "id": 42592,<br/>  "answer": "Aries",<br/>  "question": "It's the zodiac sign symbolized by a ram",<br/>  "value": 300,<br/>  "airdate": "2001-05-11T12:00:00.000Z",<br/>  "created_at": "2014-02-11T23:11:27.461Z",<br/>  "updated_at": "2014-02-11T23:11:27.461Z",<br/>  "category_id": 139,<br/>  "game_id": null,<br/>  "invalid_count": null,<br/>  "category": {<br/>    "id": 139,<br/>    "title": "5-letter words",<br/>    "created_at": "2014-02-11T22:47:42.519Z",<br/>    "updated_at": "2014-02-11T22:47:42.519Z",<br/>    "clues_count": 110<br/>  }<br/>}</span></pre><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nl"><img src="../Images/0505f32998824aec306522b7203e2303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCGqZHmatV-yhDuYnKbMpw.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">路易斯安那州的一个卡车司机停下来休息——夜幕降临后，他可疑地靠近杰克🙄</figcaption></figure><p id="7090" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是<strong class="kk iu">在检索到的数据</strong>中也有一些 <strong class="kk iu">真的</strong> <strong class="kk iu">有趣的发现。例如，我发现了一个位于科威特的兽医数据库的摘录，其中有私人数据，如姓名、电子邮件和电话号码。</strong></p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="bbcc" class="ng ma it nc b gy nh ni l nj nk">// One of the anonimized clients with her pet<br/>{<br/>  "id": 274,<br/>  "<strong class="nc iu">firstname</strong>": "XXXXXX",<br/>  "<strong class="nc iu">middlename</strong>": "XXXXX",<br/>  "<strong class="nc iu">lastname</strong>": "XXXXX",<br/>  "<strong class="nc iu">email</strong>": "<a class="ae lv" href="mailto:XXXXXX@gmail.com" rel="noopener ugc nofollow" target="_blank">XXXXXX@gmail.com</a>",<br/>  "gender": "0",<br/>  "<strong class="nc iu">api_token</strong>": "XXXXXXXXXXXX",<br/>  "dob": "10/08/1975",<br/>  "photo": "",<br/>  "<strong class="nc iu">mobile</strong>": "XXXXXXX",<br/>  "<strong class="nc iu">latitude</strong>": "XX.XXXXXXXXX",<br/>  "<strong class="nc iu">longitude</strong>": "XX.XXXXXXXXX",<br/>  "<strong class="nc iu">block</strong>": "XXXXXX",<br/>  "<strong class="nc iu">street</strong>": "XXXXXX",<br/>  "judda": "none",<br/>  "<strong class="nc iu">house</strong>": "XXXXXX",<br/>  "apartment": "none",<br/>  "address": "",<br/>  "<strong class="nc iu">area_id</strong>": "XXXXXX",<br/>  "status": "1",<br/>  "code": "",<br/>  "pet": [<br/>    {<br/>      "id": 148,<br/>      "name": "Moe",<br/>      "dob": "11-05-2011",<br/>      "breed": "1",<br/>      "gender": "0",<br/>      "height": "",<br/>      "photo": "",<br/>      "provider_id": "0",<br/>      "temperament": "",<br/>      "origin": "Persian",<br/>      "size": "1",<br/>      "<strong class="nc iu">chipno</strong>": "XXXXXXXXXXXX",<br/>      "weight": "3.5",<br/>      "grooming": "12 Week",<br/>      "isadopted": "0",<br/>      "likes": "0",<br/>      "cough": "0000-00-00",<br/>      "missyou": "0",<br/>      "status": "1",<br/>      "neutered": "1",<br/>      "spayed": "1",<br/>      "adopt_comments": "",<br/>      "disabled_comments": "",<br/>      "disabled_question": "",<br/>      "last_groom_appointment": "0000-00-00",<br/>      "next_groom_appointment": "0000-00-00",<br/>      "veternary": "",<br/>      "groom": "",<br/>      "breedname": "Cat"<br/>    }<br/>  ]<br/>}</span></pre><p id="43f0" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我还找到了一些用于在线服务的<strong class="kk iu">私钥、凭证和API令牌</strong>。</p><pre class="lg lh li lj gt nb nc nd ne aw nf bi"><span id="4038" class="ng ma it nc b gy nh ni l nj nk">// Anonimized credentials<br/>{<br/>  "id": 2038953,<br/>  "<strong class="nc iu">contact_details</strong>": {<br/>    "company_org": "XXX",<br/>    "email": "<a class="ae lv" href="mailto:XXXX@XXXXXX.com" rel="noopener ugc nofollow" target="_blank">XXXX@XXXXXX.com</a>"<br/>  },<br/>  "<strong class="nc iu">username</strong>": "<a class="ae lv" href="mailto:XXXX@XXXXXX.com" rel="noopener ugc nofollow" target="_blank">XXXX@XXXXXX.com</a>",<br/>  "<strong class="nc iu">password</strong>": "XXXXXXXXXXXX",<br/>  "<strong class="nc iu">api_2</strong>": [<br/>    {<br/>      "<strong class="nc iu">api_key</strong>": "XXXXXXXXXXX",<br/>      "<strong class="nc iu">api_key_name</strong>": "N°2"<br/>    }<br/>  ],<br/>  "<strong class="nc iu">api_keys</strong>": {<br/>    "v3": [<br/>      {<br/>        "<strong class="nc iu">key</strong>": "xkeyXXX-XXXXXXX-XXXXXXX",<br/>        "name": "XXXXXX",<br/>        "partner": "ObjectID()"<br/>      }<br/>    ]<br/>  },<br/>  "<strong class="nc iu">db_key</strong>": "XXXXXXXXX",<br/>  "status": "enabled",<br/>  "active": "1",<br/>  "m_sms_disabled": true,<br/>  "t_sms_disabled": true,<br/>  "language": "en",<br/>  "timezone": "Asia/Kolkata",<br/>  "locked": false,<br/>  "archived": false,<br/>  "forms_disabled": false,<br/>  "created_date": "2020-08-11 11:41:16",<br/>  "chargebee": {<br/>    "localization": "german",<br/>    "subscriptions": {},<br/>    "payment_auto_collected": false<br/>  },<br/>  "feature_toggle": {<br/>    "new-frontend-graph-stats": "enabled",<br/>    "new-graph-stats": "new",<br/>    "new-user-history-writings": "new",<br/>    "new-user-history-readings": "enabled",<br/>    "new-pricing": "enabled"<br/>  },<br/>  "onboarded": true,<br/>  "new_forms": "enabled",<br/>  "sso": {},<br/>  "paid_plan": false,<br/>  "dbs_country": "DE",<br/>  "lastseen": "2020-08-11",<br/>  "activated_applications": [<br/>    "email-campaigns",<br/>    "transactional-emails"<br/>  ]<br/>}</span></pre><p id="5b0a" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是最有趣的发现是一个加密货币钱包的密钥库T2。对于那些不熟悉加密货币世界的人来说，一个<em class="le">密钥库</em>是你需要访问钱包的两个东西之一。如果你有足够的计算能力，可以使用<em class="le">密钥库</em>用<a class="ae lv" href="https://hashcat.net/hashcat/" rel="noopener ugc nofollow" target="_blank"> <em class="le"> Hashcat </em> </a>破解密码——你需要的另一个东西。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nm"><img src="../Images/f3f510591f92ad267a26314b3b8bdb9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bNZkikxQhN05PS79UNRj6Q.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">在写这篇文章的时候，发现的钱包里有超过16，000美元🤑🤑🤑</figcaption></figure><h1 id="1ac6" class="lz ma it bd mb mc md me mf mg mh mi mj jz mk ka ml kc mm kd mn kf mo kg mp mq bi translated">结论</h1><p id="ab45" class="pw-post-body-paragraph ki kj it kk b kl mr ju kn ko ms jx kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">如果说我们可以从这里学到一个教训的话，那就是互联网上所有暴露的信息都可能最终落入他人手中，所以我们必须非常小心，不要公布任何私人数据。</p><p id="6520" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">正如您所看到的，从这个在线格式化工具中提取保存的数据非常简单，您可以将相同的技术用于其他类似的格式化工具。</p><p id="e9b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如果您不小心发布了任何私有数据，您可以联系JSON formatter人员来删除对这些信息的公共访问。无论如何，根据经验，<strong class="kk iu">您应该总是使任何暴露的凭证或令牌无效</strong>。</p></div><div class="ab cl nn no hx np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="im in io ip iq"><blockquote class="nu nv nw"><p id="fbf2" class="ki kj le kk b kl km ju kn ko kp jx kq nx ks kt ku ny kw kx ky nz la lb lc ld im bi translated">如果你喜欢这个故事，并想阅读更多，请在<a class="ae lv" href="https://medium.com/@h_martos" rel="noopener">媒体</a>、<a class="ae lv" href="https://twitter.com/h_martos" rel="noopener ugc nofollow" target="_blank">推特</a>或<a class="ae lv" href="https://www.linkedin.com/in/h%C3%A9ctor-martos-g%C3%B3mez-99838776/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上关注我。</p><p id="a1ff" class="ki kj le kk b kl km ju kn ko kp jx kq nx ks kt ku ny kw kx ky nz la lb lc ld im bi translated">感谢阅读！</p></blockquote></div></div>    
</body>
</html>