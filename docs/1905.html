<html>
<head>
<title>CryptoWall Ransomware — Malware Traffic Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CryptoWall勒索软件—恶意软件流量分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cryptowall-ransomware-malware-traffic-analysis-c2c1f5847b28?source=collection_archive---------2-----------------------#2022-02-21">https://infosecwriteups.com/cryptowall-ransomware-malware-traffic-analysis-c2c1f5847b28?source=collection_archive---------2-----------------------#2022-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/8b13634b26b684f2a4f1a79cc1178c1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*OSO7Ij4G3aF3s0UTuH8kRA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://www.computersquad.ca/CryptoWall_Ransomware_Removal.htm" rel="noopener ugc nofollow" target="_blank"> CryptoWall勒索短信。</a></figcaption></figure><p id="2d99" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在本文中，我使用NetworkMiner、Wireshark和OLETOOLS来分析与CrytoWall勒索病毒感染相关的网络流量和钓鱼电子邮件。PCAP和电子邮件文件属于蓝队专注挑战<a class="ae jy" href="https://cyberdefenders.org/blueteam-ctf-challenges/21" rel="noopener ugc nofollow" target="_blank">网络卫士</a>网站，名为“<em class="kx">恶意软件流量分析6 </em>”，由<a class="ae jy" href="https://twitter.com/malware_traffic" rel="noopener ugc nofollow" target="_blank"> Brad Duncan </a>创建。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="3c47" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">放弃</h1><p id="98a6" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">我喜欢在文章之前添加一个简短的免责声明，以鼓励人们在阅读本文之前尝试挑战，因为在这篇文章中显然会有<strong class="kb ir">剧透</strong><strong class="kb ir"/>。我相信，如果你先自己尝试，然后在遇到困难或需要提示时再回来写这篇文章，你会更喜欢这个挑战。因此，没有任何进一步的拖延，让我们开始吧！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="5304" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">挑战场景</h1><blockquote class="mi mj mk"><p id="785e" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">你是一家加拿大公司的分析师，这家公司名为“桥太远企业”。在2015年9月11日星期五，您在公司的安全运营中心(SOC)工作时看到以下警报:</p></blockquote><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mo"><img src="../Images/edda66d56bb05eba47cb4e7dd173a096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cBkBpEcCRkNth7yJ.jpg"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://cyberdefenders.org/blueteam-ctf-challenges/59" rel="noopener ugc nofollow" target="_blank">警报</a></figcaption></figure><blockquote class="mi mj mk"><p id="5a92" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">您的IDS设备出现了一些问题，因此在这段时间内，网络上可能会发出其他警报。你只是看不到他们。警报出现后不久，您的帮助台就接到了一个投诉感染勒索软件的电话。打电话的人是格雷格里·弗兰克林(发音为“弗兰克·莱昂”)。</p><p id="3cab" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">你的一个法医专家检查了Greggory被感染的Windows电脑。结果呢？Greggory的电脑被CryptoWall 3.0感染了两次。两次感染相隔几分钟就发生了。取证人员从受感染的主机上恢复了两个CryptoWall 3.0恶意软件样本。</p></blockquote><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/5f4960db383308e491c2b359458c41cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/0*XQmF2y-mKa0lyG2R.jpg"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://cyberdefenders.org/blueteam-ctf-challenges/59" rel="noopener ugc nofollow" target="_blank">密码墙</a></figcaption></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi my"><img src="../Images/26405f050a50571641bbe64b8f27ad47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4Kzn_EuEwpPQwi_O.jpg"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://cyberdefenders.org/blueteam-ctf-challenges/59" rel="noopener ugc nofollow" target="_blank">密码墙注释</a></figcaption></figure><blockquote class="mi mj mk"><p id="160e" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">您检索适当时间段的pcap流量。另一名分析师搜索了公司的邮件服务器，并检索出Greggory当天早些时候收到的四封恶意邮件。他们设法通过了垃圾邮件过滤器。</p></blockquote></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="e4c6" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">挑战问题</h1><blockquote class="mi mj mk"><p id="dce2" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">1.c42-mt a6–1022-UTC:附件文件名是什么？</p></blockquote><p id="747b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">为了找到附件文件名，我们可以从电子邮件“<em class="kx">c42-mt a6–1022-UTC</em>”中提取附件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi mz"><img src="../Images/dc118213728e5b0dde56b6ed75144674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*8HGFBfucH9nc6LopOIFQMQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">附件文件名。</figcaption></figure><blockquote class="mi mj mk"><p id="f882" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">2.c42-mt a6–1022-UTC:附件包含恶意软件。恶意软件第一次提交给virustotal是什么时候？</p></blockquote><p id="29a0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果我们上传zip文件，我们可以在relations选项卡下看到捆绑的恶意软件文件的名称。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi na"><img src="../Images/10d8d3f7e23ed399f6592302639757ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x_-YZCAOBg4mqOpMwjV2BQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">病毒总压缩附件。</figcaption></figure><p id="2f77" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果我们选择并查看捆绑的恶意软件文件的VirusTotal详细信息，我们可以看到恶意软件首次提交给VirusTotal的时间。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/cccd7b82d8d1aa279a317a076c54387a.png" data-original-src="https://miro.medium.com/v2/resize:fit:628/format:webp/1*PPzhsr7Xgs8lS_eZCjTalA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">VirusTotal恶意软件首次提交。</figcaption></figure><blockquote class="mi mj mk"><p id="e789" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">3.c42-mt a6–1022-UTC:恶意软件正在与多个外部服务器通信。提供恶意软件联系的唯一URL的数量？(VirusTotal graph是你的朋友)。</p></blockquote><p id="7520" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们可以将附件中存储的可执行文件上传到VirusTotal并查看其详细信息。我可以看到它已经联系了五十个网址。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/72588ffede7dbd8dab8b0d72f7ca666e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*JSpLpuTx8oXJ6YhJmzsCIA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">VirusTotal联系了个URL。</figcaption></figure><p id="7539" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">挑战的答案是48，但我不确定这是否仍然准确，因为这个挑战是几年前创建的。即使使用了VirusTotal Graphs，我也不确定如何得出答案48。</p><blockquote class="mi mj mk"><p id="7283" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">4.c42-mt a6–1022-UTC:提供恶意软件联系的FQDN？</p></blockquote><p id="ae14" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">查看VirusTotal的详细信息，我们可以看到恶意软件联系的FQDN。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/13d11e799e181716904c9e3466d68fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:302/format:webp/1*S8WhHxoHPYr2T-Y6Rc_Www.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">病毒总FQDN。</figcaption></figure><blockquote class="mi mj mk"><p id="605d" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">5.c42-mt a6–1422-UTC:恶意文档的创建时间是什么时候？(日期和时间之间有一个空格)。</p></blockquote><p id="81b0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我从电子邮件中提取了恶意文档，并将其上传到VirusTotal，在那里我可以看到创建时间。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/8cc54c867e1b328b77b45ef632357713.png" data-original-src="https://miro.medium.com/v2/resize:fit:594/format:webp/1*H6EHhvBh-Myw7hQWD1phEA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">病毒总计恶意文档的创建时间。</figcaption></figure><blockquote class="mi mj mk"><p id="1026" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">6.c42-mt a6–1422-UTC:哪个流包含宏？(提供流号)。</p></blockquote><p id="aee5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我用<a class="ae jy" href="https://github.com/decalage2/oletools" rel="noopener ugc nofollow" target="_blank"> OLETOOLS </a>分析了恶意文档文件。如果你想了解更多关于OLETOOLS的知识，我发表了一篇文章，在这篇文章中我使用OLETOOLS分析了恶意的Microsoft word文档。</p><div class="nf ng gp gr nh ni"><a rel="noopener  ugc nofollow" target="_blank" href="/maldoc101-malicious-macros-analysis-with-oletools-8be3cda84544"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">MalDoc101 —使用OLETOOLS进行恶意宏分析</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">这篇文章提供了我的方法来解决由Josh Stroschein在CyberDefenders上创建的maldoc 101 CTF…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">infosecwriteups.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw js ni"/></div></div></a></div><p id="cc0c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我开始使用OLEID来分析文件，我可以看到文件包含可疑的VBA宏。</p><pre class="mp mq mr ms gt nx ny nz oa aw ob bi"><span id="8221" class="oc lg iq ny b gy od oe l of og">oleid Patricia_Daniel_resume.doc</span></pre><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oh"><img src="../Images/1f3129a416fc90ed8212959b2c5505f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRs_cAmmVqCWnIc0QlFNdA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">OLEID识别可疑的VBA宏。</figcaption></figure><p id="5fc9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">接下来，我使用OLEDUMP来分析流并识别包含宏的流(即流3):</p><pre class="mp mq mr ms gt nx ny nz oa aw ob bi"><span id="7f8a" class="oc lg iq ny b gy od oe l of og">python oledump.py Patricia_Daniel_resume.doc</span></pre><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/6f580e12f69702466556ae52ccd7dcc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*F796Cfa1wQ8YMR2FyS4ELA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">包含宏的流。</figcaption></figure><blockquote class="mi mj mk"><p id="137e" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">7.c42-mt a6–1422-UTC:隐藏实际VBA代码的技术是什么？(两个单词中间有一个空格)。</p></blockquote><p id="6641" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">为了识别用于隐藏实际VBA代码的技术，我们可以使用OLEVBA来分析恶意文档中的VBA宏代码。我们可以在下表中看到，检测到了<a class="ae jy" href="https://dmcxblue.gitbook.io/red-team-notes-2-0/red-team-techniques/defense-evasion/t1564-hide-artifacts/vba-stomping" rel="noopener ugc nofollow" target="_blank"> VBA跺脚</a>，这是一种通过用良性数据替换VBA源代码来隐藏嵌入MS Office文档中的恶意VBA有效载荷的技术。</p><pre class="mp mq mr ms gt nx ny nz oa aw ob bi"><span id="d9ff" class="oc lg iq ny b gy od oe l of og">olevba Patricia_Daniel_resume.doc</span></pre><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi oj"><img src="../Images/587a81880c29c5dbbbd7c4dc19e330f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*za0iUfvGFXmzSNzpLLRmyQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">OLEVBA分析确定VBA跺脚。</figcaption></figure><blockquote class="mi mj mk"><p id="6162" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">8.c42-mt a6–1422-UTC:可执行恶意软件的sha256哈希是什么？</p></blockquote><p id="98a7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">作为挑战的一部分，我们提供了CryptoWall恶意软件可执行文件。如果我们上传“<em class="kx">CryptoWall-3.0-from-infected-host-2-of-2.exe</em>”到VirusTotal，我们可以看到可执行文件的sha256哈希。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/4ac84226006496497e0307b1ac7803fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*AyHFwLiz_bQDFIDbRjxsXQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">可执行恶意软件的哈希</figcaption></figure><blockquote class="mi mj mk"><p id="a94d" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">9.c42-mt a6–1557-UTC:假登录页面的完整网址是什么？</p></blockquote><p id="9979" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果我们查看电子邮件中的字符串，我们可以看到虚假登录页面的完整URL。</p><pre class="mp mq mr ms gt nx ny nz oa aw ob bi"><span id="ac16" class="oc lg iq ny b gy od oe l of og">strings c42-MTA6-1557-UTC.eml</span></pre><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ol"><img src="../Images/572a580aa6eef553442d31025dbba271.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XYNn458AHNdWSMvTbF7vIw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">虚假登录页面的完整URL。</figcaption></figure><blockquote class="mi mj mk"><p id="118f" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">10.c42-mt a6–1839-UTC:JS文件中有多少个域？</p><p id="d815" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">11.c42-mt a6–1839-UTC:JS代码正在检查特定的HTTP响应代码。正在检查的响应代码是什么？</p></blockquote><p id="aacc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">为了找到JS文件中的域名数量，我们可以从邮件中提取附件，然后将JS文件的内容上传到<a class="ae jy" href="https://lelinhtinh.github.io/de4js/" rel="noopener ugc nofollow" target="_blank"> de4js </a>进行解码。查看输出，我可以看到三个FQDN。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi om"><img src="../Images/024d9c81113e01e518449fa5d2bdfb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etJM5HQ_zOunu2j53mbysg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">JS文件中存在的域的数量。</figcaption></figure><p id="362b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在JS代码中，我们还可以看到代码正在检查200 HTTP响应代码。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/4bf952ebfdef39c09b56fd8b354b0059.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*xYK-wGIFPsIjwA0zW9swIA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">JS代码检查HTTP响应代码200。</figcaption></figure><blockquote class="mi mj mk"><p id="c091" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">12.受害者收到多封邮件，只打开了其中一封。他打开了哪一个？(提供完整的eml文件名)。</p></blockquote><p id="a794" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">根据我们到目前为止的调查，我们注意到电子邮件“<em class="kx">c42-mt a6–1422-utc . EML</em>”包含一个恶意文档，该文档被用于下载和安装CryptoWall勒索软件(<em class="kx">请参考Q的5、6、7 &amp; 8以上的</em>)。由于主机感染了这个勒索病毒，我们知道受害者打开了标题为“<em class="kx">c42-mt a6–1422-utc . EML</em>”的邮件。</p><blockquote class="mi mj mk"><p id="dcb8" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">13.受害机器的IP地址是什么？</p><p id="bf9c" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">14.受害者机器的主机名是什么？</p></blockquote><p id="538e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在NetworkMiner的“hosts”选项卡下，我可以看到组织的内部专用网络中有一台Windows计算机，根据目前从PCAP检索到的信息，这很可能是受感染的Windows虚拟机。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/2a515f8ec1bb448aad1ba16726e8f4e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*lk4tsGpuWr92GzNgzjkT_g.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">NetworkMiner受害者计算机详细信息。</figcaption></figure><blockquote class="mi mj mk"><p id="5dc6" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">15.用于传播恶意软件的漏洞利用工具包的名称是什么？(一个字)。</p></blockquote><p id="a3b8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们可以将整个PCAP上传到VirusTotal并查看snort/suricata警报，从中可以看到检测到的漏洞利用工具包是Angler EK。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/461486cdea17cfc2a6265fecaf8218ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*YKiaoM9UAwghr3E_mXdIJg.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">病毒总Angler EK。</figcaption></figure><blockquote class="mi mj mk"><p id="c2fb" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">16.哪个IP地址利用了该漏洞？</p><p id="de18" class="jz ka kx kb b kc kd ke kf kg kh ki kj ml kl km kn mm kp kq kr mn kt ku kv kw ij bi translated">17.将受害者重定向到攻击者托管利用工具包的服务器的被入侵网站的FQDN是什么？</p></blockquote><p id="85ad" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在Wireshark中，我导航到“<em class="kx">文件&gt;导出对象&gt; HTTP </em>”并按内容类型排序。我可以看到有几个从下面突出显示的FQDN下载的shockwave flash文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/8c6cf117a8a62c53a79d072c9697d527.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*Bf_WZodiICQPTJNGAZrP4w.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">Wireshark HTTP冲击波对象。</figcaption></figure><p id="7adf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我将从“<em class="kx">smittysautomart</em>”FQDN中检索到的第一个flash文件上传到VirusTotal，该文件被标记为恶意文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi or"><img src="../Images/1ab075a8745f8969b3f2fd4d85dc5112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*GJaXbF72xtTu_XWqAxdN6A.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">病毒总数闪存文件。</figcaption></figure><p id="c4eb" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在Wireshark中，我过滤了与“<em class="kx">smittysautomart</em>”FQDN相关的HTTP对象。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi os"><img src="../Images/cea48bd726eda22f2fe54b634f137240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*-M5_xARwebIyRaOX2XGZ2Q.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">与“<em class="ot">smittysautomart</em>”FQDN相关的HTTP对象。</figcaption></figure><p id="8667" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">上传大小为171 kb的HTML文件，我们还可以看到该文件包含嵌入的JS。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/90a1b646c6bd0235b8ec01c113cf8764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*MHeskNBsJU5gOGR6FL-WMw.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">嵌入JS的VirusTotal HTML文件。</figcaption></figure><p id="7aac" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在Wireshark中查看数据包8239并跟踪HTTP流，我可以看到referrer包含被入侵网站的FQDN，该网站将受害者重定向到攻击者托管利用工具包的服务器。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/e223934a51c8a644c06203466bbd31b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*S6OKWcBVykxc0r-L3EP4eA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">受损网站的FQDN。</figcaption></figure></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="35b5" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结束语</h1><p id="3d7e" class="pw-post-body-paragraph jz ka iq kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ij bi translated">我发现这个挑战对于使用NetworkMiner、Wireshark和OLETOOLS来说非常棒。我也非常喜欢研究电子邮件和PCAP挑战，以了解Windows虚拟机是如何感染CryptoWall勒索软件的。谢谢你一直读到最后，继续黑下去😄！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="d893" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae jy" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nf ng gp gr nh ni"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">iwcon.live</p></div></div><div class="nr l"><div class="ow l nt nu nv nr nw js ni"/></div></div></a></div></div></div>    
</body>
</html>