<html>
<head>
<title>InCTF pro finals 2021: Look deeper writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">InCTF职业总决赛2021:看更深入的报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/inctf-pro-finals-2021-look-deeper-writeup-8f2333576f48?source=collection_archive---------3-----------------------#2022-01-09">https://infosecwriteups.com/inctf-pro-finals-2021-look-deeper-writeup-8f2333576f48?source=collection_archive---------3-----------------------#2022-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0fa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好黑客们！！！这次我带来了另一份法医报告。InCTF职业选手总决赛2021于本周举行。挑战非常好，也很难解决。但不知何故，我们今年设法拿到了第一名。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/0d9b692be281cf50bcb841cd9f894467.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWd0fqfITsFY1cj8FF3MpQ.png"/></div></div></figure><p id="8c55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，让我们来解决这个法医难题</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/9f15dd67c6cc2068e304c604d55f3fde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RqKYy2yM5AZuJ3_n8E3Jjw.png"/></div></div></figure><blockquote class="ky kz la"><p id="136d" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><strong class="jp ir">挑战文件:</strong>【https://github.com/UVvirus/ctf_files-inctf-pro-finals-2021】T2</p></blockquote><p id="3c3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们打开给定的pdf，有一些base64编码的数据和一个密钥</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/ee59923c5412a0eb0e504a56ee4b5be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0e9bmkun2zs7xWZ_OsYpxw.png"/></div></div></figure><p id="02b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解码后得到这个</p><blockquote class="ky kz la"><p id="c276" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><strong class="jp ir">e3yn _ 7kd _ v 0 _ sn4z _ gc7 _ Hu 3yzt</strong></p></blockquote><p id="f8a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯……仍然不是可读的形式</p><p id="e39f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，我们之后再谈这个。</p><p id="9272" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们试试pdfid。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/84daba6dea163446dd41b075ec090d5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I1_xrizeUAhutGQH9Gjltw.png"/></div></div></figure><p id="d217" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看输出，我们没有得到任何有趣的东西。所以让我们试试pdf-parser</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/fe14610551c8577bda1fe3a87c4e56c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R1Orin-miDhpMbI7V_uMCQ.png"/></div></div></figure><p id="0422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哇！！！我们有发现了。<br/>在对象1中，我们可以看到名为chall_dsound.wav的名称，但是根据引用，它在对象7中<br/>,所以让我们导航到对象7</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lj"><img src="../Images/f01af24fd488a41dec0fd2919c33caf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vhlhiJWyLdNIKL6lS9pBmQ.png"/></div></div></figure><p id="ecfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它引用对象8</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lk"><img src="../Images/cea3a96d3131d5aafc85cb84c639a4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SYwdFdDSWBUNOCnHu0zdcw.png"/></div></div></figure><p id="d219" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好的，通过查看/Length和/Type，我们可以得出结论，这里有一些数据。</p><p id="e1d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们扔掉这个物体</p><blockquote class="ky kz la"><p id="468f" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><strong class="jp ir">。/pdf-parser . py-o 8—filter—raw-d dump _ obj _ filename chall _ file . pdf</strong></p></blockquote><p id="f1c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们使用file命令来检查转储文件</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lk"><img src="../Images/4468664bc4621e3effd77bd470a622f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N6I4JY2MXnTgJJT7qsTF1g.png"/></div></div></figure><p id="2e41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当使用文件命令时，它说这是一个wavfile。</p><p id="77e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">到目前为止，我们从pdf文件中提取了一个音频文件。</strong></p><p id="07f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，现在我们还没有拿到旗子</p><p id="8514" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在那个wavfile上尝试了一些东西，比如strings，binwalk，morse code，sonic visualizer，但是还是一无所获。<br/>似乎是条死胡同……</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/42d78cd12beae6403407ad3dc7a4a843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1020/format:webp/1*ObiUwwqzKpFSzOZA1OabXA.jpeg"/></div></figure><p id="3d8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是经过几个小时的研究，我发现了这篇很好的文章。</p><blockquote class="ky kz la"><p id="8c27" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><a class="ae lf" href="https://ctftime.org/writeup/9638" rel="noopener ugc nofollow" target="_blank">https://ctftime.org/writeup/9638</a></p></blockquote><p id="4b2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据这篇文章，我下载了这个工具并在其中打开了文件。</p><p id="7e1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是这里有另一个转折。该标志受密码保护</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lm"><img src="../Images/bdc31cbd4253f9051be1a5bb5c170893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8zwX6P9n7faReArG6IhSkg.png"/></div></div></figure><p id="d71f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要找到密码，回想第一步，pdf文件中存在一些base64编码的文本。</p><p id="4d8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解码后用密钥INCTF放入维格纳密码中</p><blockquote class="ky kz la"><p id="b603" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><strong class="jp ir">密码:w3ll _ 7ry _ n0 _ fl4g _ bu7 _ us3 ful</strong></p></blockquote><p id="8426" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会得到密码的</p><p id="1807" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在在deepsound工具中打开wavfile，你会得到flag.zip</p><p id="021d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过解压zip文件，我们将得到flag.png</p><p id="a088" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是！！！！该文件已损坏</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/e30ad6086198e11a76b7a24b55a33c4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*tRkauHn7LqNgv7ip_ldfAA.png"/></div></figure><p id="2c9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过查看十六进制文件，我们可以看到它包含jpeg头和png头</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/78de9e4e74d304973aed779bf6b0b7a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*bQ1vwcXHXr1fZGVv_wg0pA.png"/></div></figure><p id="d990" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">删除jpeg头会给我们一个标志。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lp"><img src="../Images/f6375a57aa0731cc60a01054f0fd91e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c9UtletklFW1KYu0b82YSA.png"/></div></div></figure><p id="e5f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">片尾字幕:</strong></p><p id="4123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢我出色的队友</p><div class="lq lr gp gr ls lt"><a href="https://www.linkedin.com/in/s-yuvarajan/" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd ir gy z fp ly fr fs lz fu fw ip bi translated">安全工程师- DeTaSECURE | LinkedIn</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">在世界上最大的职业社区LinkedIn上查看yuvarajan的个人资料。yuvarajan有一个工作列在他们的…</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">www.linkedin.com</p></div></div><div class="mc l"><div class="md l me mf mg mc mh kv lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a href="https://www.linkedin.com/in/ajay-sk-33ab591b0/" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd ir gy z fp ly fr fs lz fu fw ip bi translated">AJAY SK -学生- Panimalar工程学院| LinkedIn</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">在全球最大的职业社区LinkedIn上查看AJAY SK的个人资料。AJAY的个人资料中列出了1份工作…</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">www.linkedin.com</p></div></div><div class="mc l"><div class="mi l me mf mg mc mh kv lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a href="https://www.linkedin.com/in/aidenmonish/" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd ir gy z fp ly fr fs lz fu fw ip bi translated">monish Kumar——专业程序员——Infosys | LinkedIn</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">查看世界上最大的职业社区LinkedIn上Monish Kumar的个人资料。莫尼什有3个工作列在他们的…</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">www.linkedin.com</p></div></div><div class="mc l"><div class="mj l me mf mg mc mh kv lt"/></div></div></a></div><div class="lq lr gp gr ls lt"><a href="https://www.linkedin.com/in/nagendrangs/" rel="noopener  ugc nofollow" target="_blank"><div class="lu ab fo"><div class="lv ab lw cl cj lx"><h2 class="bd ir gy z fp ly fr fs lz fu fw ip bi translated">Nagendran G S -系统工程师-塔塔咨询服务| LinkedIn</h2><div class="ma l"><h3 class="bd b gy z fp ly fr fs lz fu fw dk translated">在世界上最大的职业社区LinkedIn上查看Nagendran G S的个人资料。内根德兰有2份工作列在…</h3></div><div class="mb l"><p class="bd b dl z fp ly fr fs lz fu fw dk translated">www.linkedin.com</p></div></div></div></a></div><p id="3d14" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lf" href="https://www.linkedin.com/in/gokulavasan-p-ba24a0211/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/gokulavasan-p-ba24a0211/</a></p></div></div>    
</body>
</html>