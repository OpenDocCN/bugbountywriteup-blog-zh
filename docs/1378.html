<html>
<head>
<title>Behind the Scene : HTTP Parameter Pollution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">幕后:HTTP参数污染</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/behind-the-scene-http-parameter-pollution-534b4fa2449c?source=collection_archive---------1-----------------------#2021-06-11">https://infosecwriteups.com/behind-the-scene-http-parameter-pollution-534b4fa2449c?source=collection_archive---------1-----------------------#2021-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f4d3b05a37313b3b89b7cb2c0cdd7841.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SM8mhUpNIVVOItz-0DVQMw.png"/></div></div></figure><p id="2b9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘿，赛博朋克们，我希望你们的生活过得很好。因为你已经知道我们将要谈论的话题。所以，<strong class="ka ir">坐好，</strong> <strong class="ka ir">放松</strong>和<strong class="ka ir">我保证</strong>你一定能<strong class="ka ir">掌握这个<strong class="ka ir">漏洞</strong>的每一个方面</strong>。不浪费任何时间，让我们直接进入HPP。</p><blockquote class="kw kx ky"><p id="7b8e" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><strong class="ka ir">注:</strong>我会尽量保持题目简单，尽量用通俗易懂的语言解释。因此，您将能够抓住漏洞的根源，并在您的目标中找到这些漏洞，使它们更加安全，并获得奖金。</p><p id="e120" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">我将<strong class="ka ir">缩写</strong>用于<strong class="ka ir"> HTTP参数污染</strong>作为<strong class="ka ir"> HPP </strong></p></blockquote></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="5a55" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">HPP到底是什么？</h1><p id="ae18" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">让我们举个例子，这样你就永远不会忘记这个概念。假设，我给了你一个难题，同时也给了你一个解决的方法。但是作为一名黑客你告诉我，听着<a class="mn mo ep" href="https://medium.com/u/b8b1b3ca3831?source=post_page-----534b4fa2449c--------------------------------" rel="noopener" target="_blank">道德kap</a>我不会走你的路。我选一个我的来解决。类似的情况还有这个漏洞，这里你告诉应用程序，我不会走你的路。相反，我会选择我自己的路。(<strong class="ka ir">这个我们自己选择路径的过程，基本上指的是参数污染</strong>中的污染)。你们中的一些人可能不理解这一点，但是不要担心，请继续关注！！！！！</p><p id="9f75" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看这个实际的例子可以更清楚的理解这个概念。</p><p id="6325" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在这里做的是，简单地在我的目标中找到的一个参数(<strong class="ka ir"> prodID </strong>)中提供SQL查询:</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/e612d1a7512cb7e572e38c2de3f5fbc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AqmW8EXDF7CyIrI42LlAYQ.png"/></div></div></figure><p id="df27" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是现在<strong class="ka ir">作为一个黑客</strong>我会用<strong class="ka ir">黑客的方式</strong>来做。所以我做的是:</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/4003c42dfb1b62ee13e0422a3255046d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3V73PUX6NTO-9DGVkKS-DQ.png"/></div></div></figure><p id="008a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我基本上，<strong class="ka ir">把简单的查询</strong>分解成多个部分<strong class="ka ir"> &amp; </strong> <strong class="ka ir">被我的参数污染了HTTP请求</strong>。我们构建自己的HTTP请求来操作信息或检索数据的这种规避技术被称为HTTP参数污染。</p><h1 id="683f" class="lk ll iq bd lm ln mv lp lq lr mw lt lu lv mx lx ly lz my mb mc md mz mf mg mh bi translated">开发HPP之前你需要知道的事情？</h1><p id="364b" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">首先，您需要确定哪些参数反映在目标应用程序上，哪些没有。你怎么知道呢？为此，我将这个问题分为两种情况。你会遇到这些<strong class="ka ir">两种情况:- </strong></p><h2 id="591a" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated">场景1</h2><h2 id="d074" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated">当你已经知道:-</h2><ol class=""><li id="0619" class="nm nn iq ka b kb mi kf mj kj no kn np kr nq kv nr ns nt nu bi translated">应用程序用哪种语言编码<strong class="ka ir">。</strong></li><li id="6653" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated">它运行在哪个服务器上。</li></ol><p id="c2cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您知道这一点，那么您就已经找到了这个漏洞的一半。参考下面的<strong class="ka ir">图。</strong>识别应用程序将接受哪个注入参数将变得非常容易。</p><p id="0648" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请看一下这张图表。<strong class="ka ir">(你不需要学这个。随便过一遍，大致了解一下)</strong></p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/a5af6b83d2ba8832c359489027493992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m852Iw-W925ADCZ4zHRhdA.png"/></div></div><figcaption class="ob oc gj gh gi od oe bd b be z dk translated">参考:-<a class="ae of" href="https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf" rel="noopener ugc nofollow" target="_blank">https://owasp . org/www-pdf-archive/appseceu 09 _ CarettoniDiPaola _ v 0.8 . pdf</a></figcaption></figure><h2 id="4e7d" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated"><strong class="ak">场景2 </strong></h2><h2 id="d7fb" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated"><strong class="ak">当你不太了解目标:- </strong></h2><p id="fab9" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">这是您在寻找这种类型的漏洞时可能面临的另一个明显的情况，您不知道哪个参数将被执行？<strong class="ka ir">这个问题<strong class="ka ir">的明确答案</strong>是手动测试</strong>，你需要做的是找出哪个参数以有趣的方式起作用。</p><h2 id="68f5" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated"><strong class="ak">但是有一个暗示，y </strong>我们的参数可能反映在:-</h2><ol class=""><li id="1d56" class="nm nn iq ka b kb mi kf mj kj no kn np kr nq kv nr ns nt nu bi translated">URI-使用GET参数。</li><li id="34cf" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated">请求体-使用POST参数。</li><li id="51d9" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated">HTTP头-使用Cookie头。</li></ol><p id="59cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要根据情况采取行动，并找出易受攻击的参数。</p><h1 id="ce3d" class="lk ll iq bd lm ln mv lp lq lr mw lt lu lv mx lx ly lz my mb mc md mz mf mg mh bi translated"><strong class="ak">如何利用？</strong></h1><p id="810b" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">让我们直接进入它。</p><p id="001f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是澄清所有理论的时候了。抱歉，我解释得太深了，但是清晰应该是我们的目标。无论如何，保持你的高动力我们就要冲过终点线了！</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c693238f4a1a8be67da3506ab9da66fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/0*mJU0IpSU35IKHYmq.gif"/></div></figure><p id="3789" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设，你的目标是<strong class="ka ir">(https://ethicalkaps.com)</strong>的网络应用是<strong class="ka ir">使用PHP </strong>作为技术，并且在后端有<strong class="ka ir"> Apache服务器</strong>。<strong class="ka ir">参考图表的第3点</strong> ( <strong class="ka ir"> PHP/Apache </strong>)，它说将执行最后出现的参数。</p><p id="8ca9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我访问了这个URL并注意到一个参数(<strong class="ka ir"> par1) </strong>，它有一个与之相关联的值(<strong class="ka ir"> value1) </strong>。这只是一个示例性的观点。在real target中，您可能会发现不同的参数(如uid=，id=，price=，name=，to=，amount=，from=，url=，uri=等..)可以是任何东西。你只需要操纵和检查到底是什么污染了网址。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/80d1091fcc104d667373685a6ab356ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Gt4nsLN4NVBowtmaq2wIw.png"/></div></div></figure><p id="c6a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在下图中，你可以说我污染了参数或者注入了<strong class="ka ir">par 2 = "&gt;&lt;SVG/onload = alert(" ethical kap shere ")&gt;作为</strong>我的有效载荷来执行。据我所知<strong class="ka ir">(根据上面的图表)</strong>最后一个参数将被执行。</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oi"><img src="../Images/da597eb7fdd6489f71996df05e645c35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HWIAorNpVQ0Kthj8UCg1eA.png"/></div></div></figure><p id="98cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，当我运行这个特定的URL时，我将得到如下输出</p><figure class="mq mr ms mt gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/55b1d4b2e0895733a39a5840dbc67df4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*XL91-V1gaN19yZhUx8YY6w.png"/></div></figure><p id="797c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以在这种情况下<strong class="ka ir"> par2= </strong>是脆弱的<strong class="ka ir">导致XSS </strong>在这里。</p><p id="8370" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">注:- </strong>我想在这里再引用一句<strong class="ka ir">这不是唯一的方法。</strong>你也可以<strong class="ka ir">使用字符和符号的编码来绕过任何限制。</strong>而且，如果你<strong class="ka ir">密切关注</strong>这个漏洞，你就可以进行<strong class="ka ir">许多其他攻击</strong>。这由你决定，因为这是你所有的创造力和逻辑。我不会<strong class="ka ir">把你限制在</strong>某个特定的列表里。</p><h1 id="e9a4" class="lk ll iq bd lm ln mv lp lq lr mw lt lu lv mx lx ly lz my mb mc md mz mf mg mh bi translated">可以用于HPP的工具</h1><p id="15f8" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">如果您需要找出应用程序中隐藏的参数，并希望节省时间，那么您可以选择自动化。我个人比较喜欢<a class="ae of" href="https://github.com/s0md3v/Arjun" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Arjun </strong> </a>。</p><p id="dd36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">原因是什么？</strong></p><ol class=""><li id="7642" class="nm nn iq ka b kb kc kf kg kj ok kn ol kr om kv nr ns nt nu bi translated">它可以<strong class="ka ir">处理不同的请求</strong>，比如GET/POST/POST-JSON等等。</li><li id="9de5" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated">它可以<strong class="ka ir">自动处理速率限制。</strong></li><li id="082c" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated">您可以直接<strong class="ka ir">将结果</strong>导出到BurpSuite/text文件，它还有许多其他的优点，您在使用它时就会知道。</li></ol><h1 id="7546" class="lk ll iq bd lm ln mv lp lq lr mw lt lu lv mx lx ly lz my mb mc md mz mf mg mh bi translated">你可以和HPP一起做一些专业的事情</h1><p id="29fd" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">你可以通过HPP实现许多不同的目标。例如:-</p><ol class=""><li id="bce0" class="nm nn iq ka b kb kc kf kg kj ok kn ol kr om kv nr ns nt nu bi translated"><strong class="ka ir">绕过Web应用防火墙。</strong></li><li id="dee2" class="nm nn iq ka b kb nv kf nw kj nx kn ny kr nz kv nr ns nt nu bi translated"><strong class="ka ir">执行客户端和服务器端攻击</strong>等..</li></ol><p id="011b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">如需进一步参考</strong>您可以参考以下链接。可能是互联网上最好的链接</p><p id="c164" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae of" href="https://owasp.org/www-pdf-archive/AppsecEU09_CarettoniDiPaola_v0.8.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://owasp . org/www-pdf-archive/appseceu 09 _ CarettoniDiPaola _ v 0.8 . PD</strong></a><strong class="ka ir">f</strong></p><div class="on oo gp gr op oq"><a href="https://www.acunetix.com/blog/whitepaper-http-parameter-pollution/" rel="noopener  ugc nofollow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd ir gy z fp ov fr fs ow fu fw ip bi translated">如何检测HTTP参数污染攻击| Acunetix</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">如今，web应用程序的许多组件通常运行在用户的计算机上(如Javascript ),而不是…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">www.acunetix.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe jw oq"/></div></div></a></div><p id="eb4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，这就是这篇文章的内容，希望你喜欢。我会带着另一个<strong class="ka ir">#回到你身边。在那之前，保重，T42继续寻找。</strong> <strong class="ka ir">不断挖掘和学习新东西。</strong></p><p id="4447" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢这些内容，你可以在这里支持我:-<strong class="ka ir">@</strong><a class="ae of" href="http://buymeacoffee.com/ethicalkaps" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">buymeacoffee.com/ethicalkaps</strong></a></p><p id="724e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一篇文章再见。在那之前珍惜你的生命。和平！</p><blockquote class="kw kx ky"><p id="7c30" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">你可以在</em><a class="ae of" href="https://twitter.com/EthicalKaps" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="iq">Twitter</em></strong></a><em class="iq">上关注我，在</em><a class="ae of" href="https://open.spotify.com/show/49AHAyFgIy7E2NDjuGRaMm?si=lVPL_DBGRkGIC8DzfTXNbw" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="iq">Spotify</em></strong><em class="iq"/></a><em class="iq">上收听我的评论，在</em><a class="ae of" href="https://www.instagram.com/iam_kapilchoudhary/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="iq">insta gram</em></strong></a><em class="iq">上关注我。</em></p></blockquote></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h2 id="9970" class="na ll iq bd lm nb nc dn lq nd ne dp lu kj nf ng ly kn nh ni mc kr nj nk mg nl bi translated">如果你喜欢这个故事，请点击👏想按多少次就按多少次，并分享来帮助其他人找到它！欢迎在下方留言评论。</h2></div></div>    
</body>
</html>