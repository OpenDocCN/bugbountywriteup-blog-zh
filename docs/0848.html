<html>
<head>
<title>PII Leakage via IDOR + Weak PasswordReset = Full Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过IDOR +弱密码Reset =完全帐户接管的PII泄漏</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/pii-leakage-via-idor-weak-passwordreset-full-account-takeover-58d159f88d73?source=collection_archive---------0-----------------------#2020-09-25">https://infosecwriteups.com/pii-leakage-via-idor-weak-passwordreset-full-account-takeover-58d159f88d73?source=collection_archive---------0-----------------------#2020-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="735e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，猎人们，这是一篇关于我最近在一个昆虫赏金项目上的发现的快速报道。在进入漏洞之前，让我们熟悉一些术语。</p><h2 id="c663" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated"><strong class="ak">什么是PII泄漏？</strong></h2><p id="9f43" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">个人身份信息(<strong class="jp ir"> PII </strong>)是可能识别特定个人的任何数据，如用户名、用户ID或任何其他个人信息。PII泄露就是这种数据的暴露。</p><h2 id="b779" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated"><strong class="ak">什么是账户盗用漏洞？</strong></h2><p id="9672" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">这是一种允许黑客通过利用应用程序逻辑中的缺陷来完全控制用户帐户的漏洞。</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="lo lp l"/></div></figure></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><p id="e563" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然程序不允许披露，让我们把程序看作redacted.com。它始于我开始测试目标的重置密码功能。就像其他任何网站一样，https://redacted.com/forgotpassword网站上的“忘记密码”也向注册邮箱发送了一封更改密码的邮件。重置密码链接如下:</p><blockquote class="lx ly lz"><p id="05e2" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated"><a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">https://redated . com/forget _ password/5 F12 cc 7079 f 273.12051864/</a>1597479504<a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">/</a>ntg 4 ntg 4 a2 lsbgvyqgdtywlslmnvbwfzzgznagprbdkxodi 3 mzc 0 nju wmda = +++ ntg 4 ntg 4 a2 lsbgvy ++ ntg 4</p></blockquote><p id="5b8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使更改了密码，链接也没有过期。怪异的权利！！。再次请求重置密码时，出现以下链接:</p><blockquote class="lx ly lz"><p id="4e75" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated"><a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">https://redacted.com/forgot_password/8ac79ccf2a33.12057854/</a>1597486704<a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">/</a>ntg 4 nt G4 a2 lsbgvyqgdtywlslmnvbwfzzgznagprbdkxodi 3 mzc 0 nju wmda = +++ntg 4 nt G4 a2 lsbgvy ++ ntg 4</p></blockquote><p id="d789" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要注意的是，两个链接的URL的最后一部分是相同的。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi mf"><img src="../Images/53de62cec018a4eb3a1e068f9d3cd690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40rDm57vXA3QM_75pSY0qQ.png"/></div></div></figure><p id="1eec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">分析完上面的链接:</strong></p><blockquote class="lx ly lz"><p id="df86" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">1597486704 → Unix时间戳</p></blockquote><p id="9bff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">url的最后一部分是base64，解码后给出了以下内容:</p><blockquote class="lx ly lz"><p id="5784" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">588588 killer @ Gmail . comasdfghjkl 9182737465000 ++ 588588 killer ++ 588588</p></blockquote><p id="4c0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，588588是我的用户ID，killer@gmail.com是我的电子邮件地址。但是等等，那个看起来像胡言乱语的东西是什么[asdfghjkl9156837463000]？</p><p id="b94d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没关系，在玩了一段时间后，我发现只有URL的最后一部分，也就是userID，被服务器验证为密码重置。</p><blockquote class="lx ly lz"><p id="7f8a" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated"><a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">https://redated . com/forget _ password/5 F12 cc 7079 f 273.12051864/</a>1597479504<a class="ae me" href="https://droomcredit.com/forgot_password/5f12cc7079f273.12051864/1595067504/MTQ4NzQ5dGFudWpiYXdhcmVAZ21haWwuY29tYXNkZmdoamtsOTE4MjczNzQ2NTAwMA==+++MTQ4NzQ5dGFudWpi+++MTQ4NzQ5" rel="noopener ugc nofollow" target="_blank">/</a>ntg 4g 4a 2 lsbgvyqgdtywlslmnvbwfzzgznagprbdkxodi 3 mzc 0 nju wmda = +++ ntg 4 ntg 4a 2 lsbgvy++[VALIDATED _ PART]</p></blockquote><p id="0bbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在，如果我知道任何用户的userID，我就可以轻松地更改他的密码。赢？不要。！</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><p id="137b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在的目标是找到用户的UserID暴露或泄露的地方。经过几天的调查，我能够在一个javascript文件中的一个端点上找到一个IDOR。端点只需要userID参数，这会泄露许多敏感信息，如用户名、电子邮件地址，甚至是属于该userID的居住地址。</p><p id="478b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> IDOR链接:</strong></p><blockquote class="lx ly lz"><p id="adc1" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated"><a class="ae me" href="https://droomcredit.com/verify_email/148573" rel="noopener ugc nofollow" target="_blank">https://redacted.com/razor/verify_email</a>？rand =<strong class="jp ir">588588</strong>&amp;request = wcq</p></blockquote><p id="1b97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我所要做的就是通过蛮力枚举每个用户ID的电子邮件地址。[PS: UserID 1属于管理员；)]</p><p id="e2e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简而言之:</strong></p><blockquote class="lx ly lz"><p id="efdb" class="jn jo ma jp b jq jr js jt ju jv jw jx mb jz ka kb mc kd ke kf md kh ki kj kk ij bi translated">从端点枚举用户ID和电子邮件地址→重置密码→使用新密码登录→完全帐户接管</p></blockquote><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="mm lp l"/></div></figure><p id="e44d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PS: </strong>该网站存储了银行账号、PAN、Adhar卡等个人信息和其他敏感数据，登录受害者账户后即可访问。</p><p id="5bcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你的阅读！！</p><p id="93a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与<a class="ae me" href="https://twitter.com/tanujbaware" rel="noopener ugc nofollow" target="_blank"> Spyder </a>合作</p><p id="025e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">在Twitter上关注我</strong></p><p id="d01f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae me" href="https://twitter.com/killer007p" rel="noopener ugc nofollow" target="_blank"> <em class="ma">杀手007 </em> </a></p><p id="bb41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">支持</strong></p><p id="d97b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae me" href="https://www.buymeacoffee.com/killer007" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/killer007</a></p></div></div>    
</body>
</html>