<html>
<head>
<title>How I Made $16,500 Hacking CDN Caching Servers — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何通过入侵CDN缓存服务器赚到16500美元——第三部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-3-91f9d836e046?source=collection_archive---------2-----------------------#2022-01-29">https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-3-91f9d836e046?source=collection_archive---------2-----------------------#2022-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1e7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">@bxmbn</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/0e9c917ff9ee765e0488c6c45b3afa3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*pyZEcnS5fLESc8yUS4wbdA.png"/></div></figure></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="4fa8" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">通过X-Forwarded-Scheme标头的缓存中毒拒绝服务</h1><blockquote class="lm ln lo"><p id="2476" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated"><em class="iq">赏金:3000</em></p></blockquote><p id="4c25" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">我不知道这是一件事，直到我看到@iustinBB的一篇关于缓存中毒研究的博客<a class="ae mp" href="https://youst.in/posts/cache-poisoning-at-scale/" rel="noopener ugc nofollow" target="_blank">大规模缓存中毒</a></p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="f82b" class="mv kv iq mr b gy mw mx l my mz">Sending the <!-- -->x-forwarded-scheme: http<!-- --> header would result  into a 301 redirect to the same location. If the response was cached by a CDN, it would cause a redirect loop, inherently denying access to the  file.</span></pre><p id="6af9" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">我很快想起了一个使用缓存服务器和Ruby on Rails的私有程序资产</p><h2 id="ba91" class="mv kv iq bd kw na nb dn la nc nd dp le mm ne nf lg mn ng nh li mo ni nj lk nk bi translated">请求:</h2><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="44f2" class="mv kv iq mr b gy mw mx l my mz">GET /?xxx HTTP/2 <br/>Host: Redacted<br/>X-Forwarded-Scheme: http <br/>...</span></pre><p id="9b6e" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated"><em class="lr">如果你要测试这个，你应该总是使用“缓存破坏者”(？anything=x)在这种情况下，我用(？xxx)这样我就不会误毒其他用户了。</em></p><h2 id="97ce" class="mv kv iq bd kw na nb dn la nc nd dp le mm ne nf lg mn ng nh li mo ni nj lk nk bi translated">回应:</h2><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="9c62" class="mv kv iq mr b gy mw mx l my mz">HTTP/2 301 Moved Permanently <br/>Date: Wed, 19 Jan 2022 17:16:13 GMT <br/>Content-Type: text/html <br/>Location: Redacted<br/>Via: 1.1 vegur <br/>Cf-Cache-Status: HIT <br/>Age: 3</span></pre><p id="f10f" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">如果攻击者对缓存服务器计时并毒害https://redacted/</p><p id="b6fb" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">当请求https://redated/时，用户的响应将是</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="f339" class="mv kv iq mr b gy mw mx l my mz">HTTP/2 301 Moved Permanently<br/>Cf-Cache-Status: HIT </span></pre><p id="a079" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">他们将无法访问<a class="ae mp" href="https://redacted/" rel="noopener ugc nofollow" target="_blank">https://redated/</a>，因为攻击者保存了301重定向，并且不会加载，直到缓存刷新。</p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="9fef" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">时间线:</h1><blockquote class="lm ln lo"><p id="2701" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">报道→2022年1月19日</p><p id="7870" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">待定计划审核→2022年1月25日</p><p id="da0a" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">分流→2022年1月25日</p><p id="a693" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">奖金发放→2022年1月26日</p></blockquote></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><p id="7ad1" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">这三份报告的总费用为11，300美元</p><p id="4342" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">我只选择了这三份报告，因为它们是获奖最多的。</p><p id="1bdd" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">我对其他程序应用了相同的方法，这包括缓存欺骗问题，如<a class="ae mp" href="https://hackerone.com/reports/1343086" rel="noopener ugc nofollow" target="_blank"> #1343086 </a></p><p id="956f" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">在<a class="ae mp" href="https://hackerone.com/" rel="noopener ugc nofollow" target="_blank"> HackerOne </a>和<a class="ae mp" href="https://www.bugcrowd.com/" rel="noopener ugc nofollow" target="_blank"> BugCrowd </a>上总共赚了15400美元</p><p id="777a" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">感谢阅读！</p><p id="acf6" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">确保在Twitter上关注我；)</p><p id="00ee" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated"><a class="ae mp" href="https://twitter.com/bxmbn" rel="noopener ugc nofollow" target="_blank"> @bxmbn </a></p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="2734" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae mp" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nl nm gp gr nn no"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="np ab fo"><div class="nq ab nr cl cj ns"><h2 class="bd ir gy z fp nt fr fs nu fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="nv l"><h3 class="bd b gy z fp nt fr fs nu fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="nw l"><p class="bd b dl z fp nt fr fs nu fu fw dk translated">iwcon.live</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kl no"/></div></div></a></div></div></div>    
</body>
</html>