<html>
<head>
<title>When automating wayback machine and ffuf is not the answer, or manual analysis ftw</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当自动化wayback机和ffuf不是答案时，或手动分析ftw</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/when-automating-wayback-machine-and-ffuf-is-not-the-answer-or-manual-analysis-ftw-d100e8f39d77?source=collection_archive---------0-----------------------#2021-09-02">https://infosecwriteups.com/when-automating-wayback-machine-and-ffuf-is-not-the-answer-or-manual-analysis-ftw-d100e8f39d77?source=collection_archive---------0-----------------------#2021-09-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="18f9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">返程机器是快速侦察的绝佳资源。它有助于找到有时模糊的路径和端点，具体到该公司命名的方式，不在任何公共单词列表中的单词和路径。当有太多的端点需要手动分析时，快速分析这些端点的方法是使用ffuf或等效方法。但是，如果那些根据ffuf不符合200的端点实际上仍然有用呢？</p><p id="f4c6" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">破碎的拼图<br/></strong>wayback machine中有一些没有任何意义的端点，通常是因为它们似乎属于js文件或html源代码(即html.onmouseover、innerHTML.onfocus等。)并且从不或者很少是正确链接的一部分(除非它是xss有效负载)。这些都没用。但也有“坏”的，有意义的，如果你想把它全部留给自动化，这可能意味着你会错过一些很酷的东西。</p><p id="d17d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">拼凑<br/> </strong>有一次，我发现自己有一个看似有趣的端点列表。它有标记，这些端点的命名暗示了一个非常有趣的IDOR。我使用ffuf快速验证了什么值得一看，ffuf确实找到了一些有效的端点。尽管如此，由于列表很大，而且它有参数，我想，让我们看看在攻击参数时是否能得到更多的东西，比如xss/ssrf/sqli/rce。<br/>查看列表，我注意到端点之间有相似之处，比如，一些端点缺少令牌参数，而另一对端点却有令牌参数。然后一些端点暗示连接到总的api，但是给出403，因为它们需要令牌param。</p><p id="10b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下面是两种302重定向的示例，具体取决于令牌是否存在:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/c5c5655b08887284206529a0970560c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLfnRRYa-7aTveQYOExysQ.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">我不得不屏蔽一堆东西，但下一个截图会让这个更有意义</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/89d524e8e5e9ac82e245c747c7ed31f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x2V1Isx7YagDICS_T5oNww.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">注意位置头和相当大的Set-Cookie值</figcaption></figure><p id="c966" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里是一个没有api令牌的端点的示例，然后它如何使用在wayback机器中找到的有效api令牌进行响应:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi le"><img src="../Images/9aae7706779b3a3444b5801aab4e8aed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1i71IMp3WYATzdXfbD1utg.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">如您所见，只有一个参数，响应是400错误请求</figcaption></figure><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lf"><img src="../Images/145e52097161c426b083682d34f44ced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GFP2FFpqTEQ0VC0hsx7x4g.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">这里您可以看到一个额外的参数apiToken，响应是200 OK</figcaption></figure><p id="3282" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">两种类型的断开链接<br/> </strong>现在，我几乎可以看到有两种类型的断开链接:<br/> 1 —一些api密钥不适用于一个端点，但另一个端点具有有效的api密钥，这意味着我们刚刚获得了一个额外的api端点。<br/>2-某些端点需要额外的路径或参数，或者两者都需要。它不必是一个特殊的键，它可以是请求有效并给出有效响应所必需的，否则，它将给出404或400，甚至301/302/500，这取决于配置。</p></div><div class="ab cl lg lh hx li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="im in io ip iq"><p id="2dc8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">另一个教训/风险提醒是，当依赖自动化验证时，即使是像wayback machine的存档端点这样简单的事情。换句话说，有时是手动分析规则。:)</p></div></div>    
</body>
</html>