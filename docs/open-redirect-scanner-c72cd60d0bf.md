# 带 Uber.com 的开放式重定向扫描仪

> 原文：<https://infosecwriteups.com/open-redirect-scanner-c72cd60d0bf?source=collection_archive---------0----------------------->

搜索假人重定向:)

WTF 是一个开放的重定向扫描器？

当 web 应用程序接受不受信任的输入时，未经验证的重定向和转发是可能的，这可能导致 web 应用程序将请求重定向到不受信任的输入中包含的 URL。通过修改恶意站点的不可信 URL 输入，攻击者可以成功发起网络钓鱼诈骗并窃取用户凭据。因为修改后的链接中的服务器名称与原始站点相同，所以网络钓鱼企图可能看起来更可信。未经验证的重定向和转发攻击也可用于恶意创建 URL，通过应用程序的访问控制检查，然后将攻击者转发到他们通常无法访问的特权功能。

参考:[https://www.owasp.org/index.php/Open_redirect](https://www.owasp.org/index.php/Open_redirect)

扫描仪:

在对 uber 的研究中，我需要一个工具来扫描查看跳转到最终 url 目的地的请求的跟踪，并查看是否有一个 uber 域列表可以强制重定向到其他外部站点。有几行代码的 python 是最好的解决方案。为什么危险是一个开放的重定向？因为攻击者可以发送 url 并强制将用户重定向到恶意站点，执行恶意脚本或网络钓鱼敏感数据。

以下是使用打开重定向扫描仪工具的示例视频:

扫描仪发现一个开放的超级子域名重定向，并显示如何被迫加载 www.yahoo.com 的[网站:](http://www.yahoo.com)

报告了该问题，但优步决定不修复，因为不认为这对其用户有风险

工作怎么样？

当域是 vuln 时，扫描仪显示 303 错误代码(参见其它代码)

攻击:

比如这个域名在优步是 vuln 打开重定向->【https://trip.uber.com/ 

我们可以向用户发送这个邪恶的 url，它带有一个有效负载->[https://trip.uber.com//yahoo.com/%2F..](https://trip.uber.com//yahoo.com/%2F..)，然后用户被重定向到 yahoo.com 站点..我们可以使用任何可用的编码来欺骗用户

代码:

下面是我编写的 python 代码，用来跟随请求到达最终目的地，并查看开放重定向是否有效。基本上，扫描仪加载一个子域列表，并添加一个有效载荷到最终的 url，看他去哪里

享受快乐的黑客生涯！:)

问候，

[Ak1T4](https://medium.com/u/c5b622272cd5?source=post_page-----c72cd60d0bf--------------------------------)