<html>
<head>
<title>[Write-up] Programming 01 &amp; Blockchain — WhiteHat Grand Prix 06 — Quals 2020</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[撰写]编程01 &amp;区块链—怀特哈特大奖赛06 — Quals 2020</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/write-up-programming-01-blockchain-whitehat-grand-prix-06-quals-2020-d36527cabe8d?source=collection_archive---------0-----------------------#2020-01-10">https://infosecwriteups.com/write-up-programming-01-blockchain-whitehat-grand-prix-06-quals-2020-d36527cabe8d?source=collection_archive---------0-----------------------#2020-01-10</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="eb95" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">编程01</h1><p id="1710" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq iu">问题</strong></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="b4b7" class="lv jr it lr b gy lw lx l ly lz">nc 15.164.75.32 1999</span></pre><p id="cf6b" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated"><strong class="kq iu">回答</strong></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="c8bc" class="lv jr it lr b gy lw lx l ly lz">PROGRAMING - WHITEHAT GRANDPRIX 06:<br/><br/>--&gt; COUNT THE NUMBER OF POSSIBLE TRIANGLES &lt;--<br/><br/>HOW MANY TRIANGLES ARE CREATED BY N (1..N) NUMBER. N &lt; 10^6<br/><br/>Example:  N = 5<br/>OUTPUT : 3 <br/><br/>(2,3,4),(3,4,5),(2,4,5)<br/>................/\...................|\...................<br/>.............../  \..................| \..................<br/>............../    \.................|  \.................<br/>............./      \................|   \................<br/>............/        \...............|    \...............<br/>.........../          \..............|     \..............<br/>........../____________\.............|______\.............<br/><br/>n = 11<br/>Answer: %</span></pre><p id="3489" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">所以问题要求求边长为整数的三角形的个数，可以用1到N的自然数创建，因为N很大(&gt; 99999)，所以极有可能会有答案的数学公式，我们可以google或者sit，分析算法。但是我很无知，所以我会谷歌:((。快速代码1程序为问题的目的寻找直角三角形:</p><figure class="lm ln lo lp gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="1a74" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">然后尝试用小N (4，5，6，7，…)运行，我们得到如下序列:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="79d2" class="lv jr it lr b gy lw lx l ly lz">➜  whqual2020 python brute_triangle.py<br/>1<br/>3<br/>7<br/>13<br/>22<br/>34</span></pre><p id="7844" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">谷歌一下，找到https://oeis.org/A173196</p><blockquote class="mj mk ml"><p id="7a19" class="ko kp mm kq b kr ma kt ku kv mb kx ky mn mc lb lc mo md lf lg mp me lj lk ll im bi translated">a(n-1)是边长最大的整数边不等边三角形的个数&lt;= n, including degenerate (i.e., collinear) triangles. a(n-2) is the number of non-degenerate integer-sided scalene triangles. — Alexander Evnin, Oct 12 2010</p></blockquote><p id="4341" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">OK, so the remaining job is to implement the calculation formula, connect and get the flag (note the offset of N in question against n of the sequence):</p><figure class="lm ln lo lp gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="e9fc" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">Run and get the flag</p><figure class="lm ln lo lp gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="6e0a" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">So the flag is  【T0】 </p><h1 id="cd29" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">Blockchain — Misc</h1><p id="ac93" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated"><strong class="kq iu">问题</strong></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="c071" class="lv jr it lr b gy lw lx l ly lz">Blockchain application in IOT system.<br/>Using vulnerable chipset to generate public keys.<br/><br/>http://52.78.210.118/Blockchain.zip</span></pre><p id="5a3e" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated"><strong class="kq iu">回答</strong></p><p id="11de" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">乍一看标题，我以为会有一些与区块链有关的东西，包括哈希、时间戳、块等等，但一旦完成，它只是一个伪装的加密帖子😧。解压缩我们的文件:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="94ec" class="lv jr it lr b gy lw lx l ly lz">.<br/>├── 34a7370734caff5d129ad355f78f3ccf.pem<br/>├── 8a95963d7bedd2b81ad09cd1838c7a4d.pem<br/>├── block1.json<br/>├── block2.json<br/>├── block3.json<br/>└── flag.zip</span></pre><p id="f09e" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">这个<code class="fe mq mr ms lr b">flag.zip</code>文件里面有一个带密码的<code class="fe mq mr ms lr b">flag.txt</code>文件，我们的任务就是找到密码来解码这个文件。回顾2 pem文件，公钥很短，给文章<code class="fe mq mr ms lr b">Using vulnerable chipset to generate public keys</code>加个提示。因子可能是，或者这两个公钥具有相同的因子。而且确实问题在第二个方向。我们很快找到了两个键对应的p和q:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="b85d" class="lv jr it lr b gy lw lx l ly lz"># 8a95963d7bedd2b81ad09cd1838c7a4d<br/><br/>p1 = 1091951834898382993408357240646061116416467734213916798265279491274843400183<br/>q1 = 968357930958770928862265655524254201820039464684491130864944605493368598601<br/><br/># 34a7370734caff5d129ad355f78f3ccf<br/>p2 = 1091951834898382993408357240646061116416467734213916798265279491274843400183<br/>q2 = 3602083547017910155331521957638413821351348404017103506647493207187611603783</span></pre><p id="dd0f" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">看看这个<code class="fe mq mr ms lr b">block1.json</code></p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="2b68" class="lv jr it lr b gy lw lx l ly lz">{<br/>  "data_block": [<br/>    {<br/>      "34a7370734caff5d129ad355f78f3ccf": {<br/>        "messger": "864826346328927043007924641380681736981324987926997370887020532699182309378599192043216478265476219278213123962074508284028662403643532629433329761492"<br/>      }<br/>    },<br/>    {<br/>      "8a95963d7bedd2b81ad09cd1838c7a4d": {<br/>        "messger": "259242051785557714557594066190019826465030870294179284671916925100489488841761299528416294893049464518482888070747927907550583942630013791833474340284"<br/>      }<br/>    }<br/>  ]<br/>}</span></pre><p id="2d9e" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">我们尝试用相应的私钥对2条消息进行解密，会产生一个明文，令人惊讶的是，块2和块3都可以做到这一点(不考虑前面的块？！！似乎是由于检查被移除，仅留下内部的数据)。快速代码解码文件:</p><figure class="lm ln lo lp gt mf"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="ef2c" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">并运行代码:</p><pre class="lm ln lo lp gt lq lr ls lt aw lu bi"><span id="9ee4" class="lv jr it lr b gy lw lx l ly lz">➜  whqual2020 python blockchain.py <br/>Password using open flag.zip<br/>Do you understand the blockchain?<br/>Password = Password1+Password2<br/>flag in flag.txt<br/>Password2:'D@V!4P##Ij'<br/>Password1:'irVOwoJR7d'</span></pre><p id="38f2" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">使用密码<code class="fe mq mr ms lr b">irVOwoJR7dD@V!4P##Ij</code>解压文件<code class="fe mq mr ms lr b">flag.zip</code>我们得到一个新文件，内容是base64，<em class="mm">解码</em>得到一个二维码图像。扫描二维码，然后我们捕捉旗帜:</p><figure class="lm ln lo lp gt mf gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/57caee5239b94566351a306988e6a6e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*oeqb-6nHJhA9DctgnTbYDw.png"/></div></figure><p id="2222" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">标志:<code class="fe mq mr ms lr b">Whitehat{the_ flag_blockchain_ iot}</code></p><p id="5fb0" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated">好好享受吧伙计们。</p></div><div class="ab cl mw mx hx my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="im in io ip iq"><p id="3de1" class="pw-post-body-paragraph ko kp it kq b kr ma kt ku kv mb kx ky kz mc lb lc ld md lf lg lh me lj lk ll im bi translated"><em class="mm">关注</em> <a class="ae mi" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mm"> Infosec报道</em> </a> <em class="mm">获取更多此类精彩报道。</em></p><div class="nd ne gp gr nf ng"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd iu gy z fp nl fr fs nm fu fw is bi translated">信息安全报道</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu mu ng"/></div></div></a></div></div></div>    
</body>
</html>