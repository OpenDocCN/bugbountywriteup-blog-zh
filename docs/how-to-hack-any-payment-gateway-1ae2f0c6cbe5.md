# 如何黑掉任何一个支付网关？

> 原文：<https://infosecwriteups.com/how-to-hack-any-payment-gateway-1ae2f0c6cbe5?source=collection_archive---------1----------------------->

在网上购买免费的东西并不是当今一代人的梦想。我知道那是因为我是那个在网上买东西的人，我公寓里的每样东西都是在电子商务网站上买的，相信我。我们正处于电子商务飞速发展的时代，没有人能阻止它。阿里巴巴在短短 24 小时内创造了超过 308 亿美元销售额的新纪录，让我们冷静一下。

![](img/260b5a30b3c7722d76cfc9f1c5d80344.png)

然而，所有这些交易背后的机制只是在我们称之为互联网的巨大互联设备网络上流动的少量信息。任何了解这些交易背后的科学原理的人都可以找到一种永远在线购物的方法，而且是免费的。

# 让我们开始吃吧！

大多数阅读这篇文章的安全人员可能会认为这只是一个点击诱饵，但我希望你保持开放的思维，并按照我向你解释的三个层次的困难，你可以侵入一个电子商务品牌的支付网关。

![](img/22a1b46ec49936d8567d991dffbf7237.png)

1.  简单的方法
2.  棘手的方法
3.  几乎不可能的方法

这三点是入侵和操纵任何支付网关的垫脚石。

## 1.简单的方法

这是最简单的方法来控制你购买的产品数量。这就是产品的成本/金额出现在 HTML 页面中表单的隐藏元素中的时候。因此，当我们选择一个我们打算购买的商品时，该商品的价格被加到产品的总金额中，该价格取自填充到表单中的隐藏字段，然后显示为总计。

```
<input type=”hidden” name=”business” value=”[abc@xyz.com](mailto:herschelgomez@xyzzyu.com)”>
<input type=”hidden” name=”cmd” value=”_xclick”>
<input type=”hidden” name=”item_name” value=”Classmate_Notebook”>
<input type=”hidden” name=”amount” value=”550">
<input type=”hidden” name=”currency_code” value=”INR”>
```

**如何绕过它-**

要更改产品的价格，您只需在将产品添加到购物车之前，在提到价格的隐藏表单字段中进行更改。通过这种方式，实际价格永远不会添加到购物车中，你可以免费购买产品。

## 2.棘手的方法

这是第二种方法来控制你在网上购买的产品数量，并根据你的喜好改变价格。所以，在这个过程中我们使用了一个拦截工具，比如 Burp Suite。价格不在表单的隐藏字段中，所以我们不能像以前那样更改价格，而是将产品添加到购物车中。

![](img/7e4d8fa6184ecc57f30c4a9b471fcf33.png)

打嗝套件拦截

**如何绕过它-**

因此，一旦我们到达支付网关，我们就打开拦截，并在刚刚拦截的数据包中手动操作费用。在 intercepter 中编辑价格后，我们转发数据包，这样我们就有了自己的另一个免费产品。

![](img/84db24de27c772f4304f93036a33271c.png)

修改的价格

## 3.几乎不可能的方法

一直从事支付网关和在线交易的人，可能对之前的步骤很熟悉，他们必须有适当的安全措施，可能已经解决了我上面提到的漏洞。防止这些漏洞的最广为人知的方法是使用散列。

散列被用作检查从电子商务网站发送到支付网关的消息的完整性的方法。散列和包括产品价格的其他值随后被发送用于验证，并且如果支付网关之前和之后的散列匹配，则交易被允许。

![](img/e370f922f1c03660864b78948edde50e.png)

**如何绕过它-**

这是大多数安全供应商认为安全的方法，当你开始深入研究并开始一次只关注一个电子商务网站时，问题就出现了。

作为一名黑客，你学到第一件事就是永远不要放弃，找到一个解决方案，不管它有多疯狂。所以，我开始挖掘关于哈希和他们如何制定它。为了让开发者更容易将他们的电子商务网站与支付网关集成，这些公司在公共领域发表文章，介绍他们如何制定散列和其他细节。

稍微调查一下，您就可以找到这些文档，即在创建哈希时所涉及的参数和使用的哈希技术。现在，一旦你有了所需的参数，它们中的大多数都出现在你拦截的数据包中，其中一个参数是密码，这也是利用，只有电子商务管理员知道。

因此，下一步是将参数放在一起，通过暴力或使用字典攻击来找到密码，一旦找到密码，您就可以根据产品的修改价格创建自己的哈希，并从该供应商那里购买无限量的免费产品，只要他们不更改密码。

这一步确实很难，但是一些开发人员只是用与文档中相同的密码复制代码，从而导致了这个安全漏洞，并允许购买免费的在线产品。

# 道德的

我刚才暴露和展示的每个安全漏洞都是由于开发人员缺乏意识造成的，他们没有意识到他们代码的安全风险，以及它如何会给公司带来数千甚至数百万美元的损失。

如果开发人员更多地关注事物的安全角度，并牢记安全编码，90%以上的错误可以立即解决，并且不会出现安全风险。

**如果你喜欢，请鼓掌&让我们合作吧。获取、设置、破解！**

网址:[aditya12anand.com](https://www.aditya12anand.com/)|捐赠:[paypal.me/aditya12anand](https://paypal.me/aditya12anand)

电报:【https://t.me/aditya12anand 

推特:[twitter.com/aditya12anand](https://twitter.com/aditya12anand?source=post_page---------------------------)

领英:[linkedin.com/in/aditya12anand/](https://www.linkedin.com/in/aditya12anand/?source=post_page---------------------------)

电子邮件:aditya12anand@protonmail.com

*关注* [*Infosec 报道*](https://medium.com/bugbountywriteup) *获取更多此类精彩报道。*

[](https://medium.com/bugbountywriteup) [## 信息安全报道

### 收集了世界上最好的黑客的文章，主题从 bug 奖金和 CTF 到 vulnhub…

medium.com](https://medium.com/bugbountywriteup)