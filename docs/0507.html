<html>
<head>
<title>How I bypassed the OTP verification process? Part - 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何绕过OTP验证过程的？第三部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-bypassed-the-otp-verification-process-part-3-1bd49f8d76b9?source=collection_archive---------0-----------------------#2020-03-07">https://infosecwriteups.com/how-i-bypassed-the-otp-verification-process-part-3-1bd49f8d76b9?source=collection_archive---------0-----------------------#2020-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2e16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">涡轮入侵者-我爱上了打嗝扩展！</h2></div><p id="ca9a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗨，伙计们，在我完成Docker系列后，我还没能写好上个月的文章。对于所有最近开始关注我的人，我欢迎你们所有人。我一直忙于编写超级有用的脚本来监控ubuntu系统，以及如何从数百万行日志中获取最细微的安全细节，你们不会相信我，我从这些日志中剔除了机器的正常行为，只关注异常情况，从而将12GB的日志压缩到40Kb。我以此为荣，并将无耻地向你们所有人提起。</p><p id="a7eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，我已经说得够多了，让我们深入到OTP旁路这个主题，以及为什么这篇文章与我写的前两篇不同。你可以看看我的另外两篇文章，链接就在下面。</p><ol class=""><li id="b77a" class="lb lc iq kh b ki kj kl km ko ld ks le kw lf la lg lh li lj bi translated"><a class="ae lk" href="https://medium.com/bugbountywriteup/how-i-bypassed-the-otp-verification-process-part-1-e5b333274ae9" rel="noopener">我是如何绕过OTP验证过程的？第一部分</a></li><li id="08ea" class="lb lc iq kh b ki ll kl lm ko ln ks lo kw lp la lg lh li lj bi translated"><a class="ae lk" href="https://medium.com/bugbountywriteup/how-i-bypassed-the-otp-verification-process-part-2-c69f067216d" rel="noopener">我是如何绕过OTP验证过程的？第二部分</a></li></ol><p id="1cb9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这两篇文章非常值得一读，给你这些文章的摘要是，我发现了一个电影预订网站，他们保存了用户的数量，然后将动态口令发送到用户的手机上，用户可以进入并登录网站。</p><p id="294f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个网站的缺陷是没有检查一个人在OTP领域进行尝试的次数，并且OTP不会过期很长时间(不记得具体细节)。这使我能够证明暴力攻击可以在这样的网站上进行，以绕过登录。</p><h1 id="8e3b" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">让我们开始吧！</h1><p id="845c" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">我进行攻击的网站也有同样的缺陷。让我解释一下整个场景。</p><h2 id="9fa5" class="mn lr iq bd ls mo mp dn lw mq mr dp ma ko ms mt mc ks mu mv me kw mw mx mg my bi translated">第一阶段</h2><p id="2417" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">在这一部分，一位客户找到我，他想测试网站的安全性，如果攻击者知道用户的凭据，他们就可以发起攻击，绕过OTP验证过程，直接登录网站。</p><p id="38e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，为了检查这种攻击是否可能，我对这种攻击尝试了不同的尝试，我想在最后尝试蛮力技术。我被提供了一个测试用户凭证来继续攻击。</p><p id="8439" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我尝试的第一件事是测试他们对网站上的cookie、它们的过期时间、这些cookie的唯一性实施的安全性如何，检查即使用户已经退出网站，cookie是否仍然有效，用户在不同浏览器上登录的cookie是否可以用于登录另一个系统。该网站在所有这些测试中都屹立不倒，表现出了应有的水平。</p><p id="0d3f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我也尝试了一些不同的方法，但都不起作用。那些攻击可能起了作用，只是在加入我的工作后，我没有正确地关注红队和成为攻击者，这在这样的时刻真正表现出来。对不起，我不会再生气了，让我们开始第二部分的攻击。</p><h2 id="c766" class="mn lr iq bd ls mo mp dn lw mq mr dp ma ko ms mt mc ks mu mv me kw mw mx mg my bi translated">第二阶段</h2><p id="4b3e" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">现在，我几乎要放弃了，我尝试了我在以前的OTP验证旁路文章中所做的暴力攻击，作为我的最后一次尝试。如果失败了，我会向客户报告攻击失败，OTP无法被脚本kiddy类型的攻击者绕过，但比我更有才华的人可能会找到这样做的方法。</p><p id="c6d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我从强力攻击开始，首先我获得了有效的动态口令，并在最后制作了一个包含30个数字的单词表，有效的动态口令在单词表的最后。只是为了检查它在理论上是否容易受到暴力攻击。</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/8a3151090da7d4a87dc865fb5e92cb2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*lrY8caGcO_agTHD-1bY17g.png"/></div></figure><p id="c4bd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是网站发送动态口令时给出的通知。现在是时候开始使用BurpSuite了。所以，当我拦截流量时，这是弹出的请求，在最后是OTP部分。</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/c8e2834a6b0f6c90c958674cbf4b5b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1m0_G46I_mKASZ9yIaWLxg.png"/></div></div></figure><p id="992e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然30个单词的单词表已经准备好了，我就在OTP旁路上运行了一次暴力攻击，正如我所希望的那样完美地工作了。即使正确的OTP在第31位，它仍然工作，但它给出了以下输出。</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/c5b74c8f4ab8298178d3c9815d706391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*bV0dgO1fmU__Nk9rko8FHA.png"/></div></figure><p id="eeca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我心灰意冷，我输入了动态口令，网站一直弹出同样的“动态口令已过期”的消息。我回到页面，再次用同一个OTP登录，它工作了！</p><p id="1610" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我非常高兴，我一次又一次地这样做，同一个OTP继续工作。这就是我如何意识到每个帐户的OTP在一整天后过期的，是的，开发团队中有人认为将OTP的过期时间保留一整天是个好主意。</p><p id="b08b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了这个结果，我让我的客户知道该网站很容易受到OTP旁路的攻击，并向他展示了如何进行攻击的理论证明，但他需要在一个帐户上进行攻击，并让我登录以向他展示这是可以做到的。</p><h2 id="1ed8" class="mn lr iq bd ls mo mp dn lw mq mr dp ma ko ms mt mc ks mu mv me kw mw mx mg my bi translated">第三阶段</h2><p id="66be" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">现在开始有趣的部分，这篇文章与我以前的文章有所不同。在我写的关于OTP bypass的所有文章中，它们都是一些概念的理论证明，即如果有人真的运行了暴力并且有时间这样做，攻击就可以完成。</p><p id="1e6b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一次，我实际上不得不在99999个号码中寻找一个是OTP的号码。在这种情况下，OTP是5位数，在我这边也是如此，因为使用6位数的OTP是正常的，它为我节省了计算的9/10ᵗʰ，这是非常大的。与我的运气完全背道而驰的一件事是，我已经编写了社区版，强行通过10万个数字将花费我不止一天甚至两天的时间，如果我必须向我的客户证明这是可能的，那就不可能完成这项工作。</p><p id="5af1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就在那时，我开始想办法通过BurpSuite CE进行更快的暴力攻击，而不是蜗牛速度的攻击。当时客户实际上也在旁边工作，他向我推荐了一个他认为可能有帮助的视频。</p><p id="d673" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lk" href="https://www.youtube.com/watch?v=vCpIAsxESFY&amp;t=1328s" rel="noopener ugc nofollow" target="_blank">涡轮入侵者:滥用HTTP错误功能加速攻击由詹姆斯</a></p><p id="a48c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我在BurpSuite社区版中遇到的最好的扩展之一。我请你们大家看一下视频上面的链接，这会让你们更好地理解我将要进行的整个攻击。</p><p id="818a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，Turbo Intruder允许向网站发送管道请求，此外还有<a class="ae lk" href="https://tools.kali.org/web-applications/skipfish" rel="noopener ugc nofollow" target="_blank"> skipfish </a>的功能，它允许以难以想象的速度向网站发送请求。</p><p id="85de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦我在我的BurpSuite中安装了扩展，我就开始工作，编写一个小的bash脚本来打印文件中所有可能的数字组合。现在是时候根据我的需要对涡轮入侵者进行微调，使其发挥最佳效果。</p><p id="6274" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦你在你的系统上下载了Turbo intruder，你就向它发送请求，就像你向intrusor发送请求一样。在你这样做之后，你会看到类似上面这样的内容，屏幕的上半部分是你想要进行暴力攻击的请求，下半部分是python脚本，它实际上可以帮助你提高暴力攻击的速度。</p><figure class="na nb nc nd gt ne gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nn"><img src="../Images/1aeafe0f6533299c728f54f4a4eba980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SPKA3iESAVVsNBEThnPaVg.png"/></div></div></figure><p id="144b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们来看看上面的图像，在图像的前半部分，我们需要暴力破解的值需要用“%s”来表示。让我们看看python脚本所在的图像的下半部分。如果你真的想利用这个工具，一定要启用<code class="fe no np nq nr b">pipeline=True</code>。<code class="fe no np nq nr b">concurrentConnection</code> &amp; <code class="fe no np nq nr b">requestsPerConnection</code>的值需要根据服务器可以承受的负载决定，您可能需要根据服务器进行微调。下一步是设置单词表的路径，然后在底部是微调过程中最重要的部分。</p><p id="d9ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，您需要输入脚本将在响应中查找的关键字。你可以发挥创造力，尝试找到满足你需求的最佳if语句。现在，一旦你准备好了所有这些，你就可以按下最底部的按钮开始攻击了。</p><p id="4579" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种暴力攻击是如此之快，即使网站几乎无法处理流量，涡轮入侵者在一个小时内就获得了正确的动态口令。原本需要一整天的工作被压缩到不到一个小时。我向客户演示了这种攻击，并展示了这种攻击是如何非常可能且容易实施的。</p><h1 id="2377" class="lq lr iq bd ls lt lu lv lw lx ly lz ma jw mb jx mc jz md ka me kc mf kd mg mh bi translated">结论</h1><p id="b4ed" class="pw-post-body-paragraph kf kg iq kh b ki mi jr kk kl mj ju kn ko mk kq kr ks ml ku kv kw mm ky kz la ij bi translated">这篇文章的要点是，无论攻击者有多好，如果您有适当的安全措施，您都可以挫败他的所有努力，至少通过基本的安全策略，您可以阻止90%到95%的坏人。</p><p id="fe94" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从蓝队的角度来看，这里需要注意的要点是，网站没有检查输入动态口令的次数，动态口令的到期时间只保留了一天，允许来自同一个IP的连续请求。如果这些安全特征被保留，这次攻击就不会发生。</p><p id="77c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于红队队员来说，这里的关键点是使用BurpSuite的各种扩展，因为这些可以帮助你多倍提高你的技能，而且你不需要购买它的专业版本。</p><p id="b282" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢，请鼓掌让我们合作吧。获取、设置、破解！</p><p id="02e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">网站</strong>:<a class="ae lk" href="https://www.aditya12anand.com/" rel="noopener ugc nofollow" target="_blank">aditya12anand.com</a>|<strong class="kh ir">捐款</strong>:<a class="ae lk" href="https://paypal.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">paypal.me/aditya12anand</a><br/><strong class="kh ir">电报</strong>:<a class="ae lk" href="https://t.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">https://t.me/aditya12anand</a><br/><strong class="kh ir">推特</strong>:<a class="ae lk" href="https://twitter.com/aditya12anand?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">twitter.com/aditya12anand</a><br/><strong class="kh ir">LinkedIn</strong>:<a class="ae lk" href="https://www.linkedin.com/in/aditya12anand/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/aditya12anand/</a><br/><strong class="kh ir">电子邮件</strong>:aditya12anand@protonmail.com</p></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="3cd2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nz">关注</em> <a class="ae lk" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="nz"> Infosec报道</em> </a> <em class="nz">获取更多此类精彩报道。</em></p><div class="oa ob gp gr oc od"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="oe ab fo"><div class="of ab og cl cj oh"><h2 class="bd ir gy z fp oi fr fs oj fu fw ip bi translated">信息安全报道</h2><div class="ok l"><h3 class="bd b gy z fp oi fr fs oj fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="ol l"><p class="bd b dl z fp oi fr fs oj fu fw dk translated">medium.com</p></div></div><div class="om l"><div class="on l oo op oq om or nf od"/></div></div></a></div></div></div>    
</body>
</html>