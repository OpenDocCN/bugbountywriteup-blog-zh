<html>
<head>
<title>Always use protection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">始终使用保护措施</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/party-crashers-b44bf22a44ab?source=collection_archive---------1-----------------------#2019-01-23">https://infosecwriteups.com/party-crashers-b44bf22a44ab?source=collection_archive---------1-----------------------#2019-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="597a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注:以下文章发表于2016年09月08日https://FogMarks.com</em><a class="ae km" href="https://fogmarks.com/2016/08/09/party-crashers/" rel="noopener ugc nofollow" target="_blank"><em class="kl"/></a></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/4f04440d2153baa8ae465ff4738ec974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*elXLID8wQDQ6w35N.jpg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">鸣谢:谷歌图片</figcaption></figure><p id="e90a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi ld translated"><span class="l le lf lg bm lh li lj lk ll di">在</span> <br/>中，你通过什么方式与你的用户的私人信息进行交互？我指的是他们的全名、电子邮件地址、居住地址、电话号码或任何其他对他们来说可能很重要的信息，或者他们宁愿保密的信息。</p><p id="2b82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天的案例研究正是关于这一点。家长咨询:家长咨询:明确的内容。<strong class="jp ir">开个玩笑。</strong></p><p id="f4a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将讨论私有<strong class="jp ir">对象</strong>(稍后我将解释我对术语“对象”的理解)应该如何处理，然后我们将看到我在<strong class="jp ir">脸书</strong>上发现的两个简单的漏洞示例(当然，已经被修复)。</p><p id="d571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，所以你已经足够成熟，可以让你的用户信任你，告诉你他们的电子邮件地址、家庭住址和电话号码。如果你够聪明，你会知道这种类型的信息应该通过HTTPS在网上传输，但你会记得有时自己加密也是一个好的做法。</p><p id="835a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，您的用户信息被正确地传输并保存在数据库中，您假设您的数据库不会受到SQL注入或其他泄漏事件的影响，并且您正在考虑开一瓶啤酒并开始另一集的<em class="kl">我如何遇见您的母亲</em>。<br/>牛逼！但是首先，我想给你介绍另一个敌人:伊多尔人。</p><p id="9e80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不安全的直接对象引用是信息的第二大敌人(当然，仅次于SQLi)。能够访问其他用户私人<strong class="jp ir">对象</strong>(如电子邮件地址、电话号码等)的攻击者基本上可以暴露服务器上的所有私人数据，而无需直接与数据库“对话”或在服务器上运行任意代码。</p><p id="263f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是解释我对“私有对象”的定义的时候了。用户对象不仅仅是用户的电话号码、电子邮件地址、姓名、性别、性取向或喜欢的床的一边。它们也是用户创建或拥有的对象，如用户购物车中的项目、用户正在管理的组或用户已经绘制的绘画。</p><p id="1343" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">处理私有对象的最好方法是将它们定义为私有的，并以适当的荣誉对待它们。</p><p id="b338" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您知道只有某个用户(或多个用户)应该能够访问某个对象，请确保只有那些用户id(或其他唯一标识符)能够访问和处理该对象。</p><h1 id="33bc" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">你会怎么做？</h1><p id="e312" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">当然是使用私有对象管理器(POM)。这个想法很简单:一个唯一的机制，只有在提供了可接受的标识符的情况下，才能获取或更改私有对象的信息。<br/>例如:只有当请求信息的用户的ID为“212”时，该类才会返回用户ID为“212”的电子邮件地址。</p><p id="af7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">听起来很明显，对吧？<br/>在发布这个案例研究之前，我和一些同事就创建一个独特的机制来处理私有对象的所有请求的想法聊了一会儿。</p><h1 id="2fe1" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">他说这是没有用的</h1><blockquote class="mp"><p id="d082" class="mq mr iq bd ms mt mu mv mw mx my kk dk translated">因为当发出关于某个对象的请求时，会话管理器的工作就是确保当前活动会话正在处理它有权访问的对象</p></blockquote><h1 id="d073" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx mz lz ma mb na md me mf nb mh mi mj bi translated">但他错了。非常不对。</h1><p id="2c3c" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">每个人都知道脸书事件和团体。每个人都是脸书某个团体的成员，或者收到了某个活动的邀请。<br/>像脸书的其他特征一样(尤其是在<a class="ae km" href="https://en.wikipedia.org/wiki/Facebook%E2%80%93Cambridge_Analytica_data_scandal" rel="noopener ugc nofollow" target="_blank">剑桥分析数据丑闻</a>之后)，群体和事件有不同的隐私级别。他们可以是<strong class="jp ir">公开的</strong>——然后每个用户将能够看到活动/群组名称和全部内容，<strong class="jp ir">私人的</strong>——然后每个用户将能够看到活动/群组名称，但不能看到他们的内容或<strong class="jp ir">秘密</strong>——然后只有被邀请加入群组或参与活动的用户才能看到他们的名称和内容。常规脸书搜索不会发现此类团体/事件的存在。</p><p id="b4e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几乎脸书上的每个物体都有一个ID——通常是一个很长的数字，代表脸书庞大数据库中的物体，组和事件也是如此。</p><h1 id="7c0a" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">那么，如何确定一个秘密团体或事件的名称或内容呢？</h1><p id="6dce" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">我花了很多时间在现代脸书平台上，试图从我实际上看不到的秘密团体和事件中获取信息，只能通过他们的ID。<br/> <strong class="jp ir">但是</strong>我找不到任何从秘密对象泄露私人信息的线索。在脸书的现代平台上。<strong class="jp ir">现代</strong>。</p><h1 id="b3a1" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">这时候我开始思考</h1><p id="7e1f" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">脸书的网络平台(甚至手机平台)有很多版本。<br/>他们是否使用同一个私有对象管理器来访问“敏感”对象，如秘密组或事件？</p><h1 id="1c38" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">号码</h1><p id="3165" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">在我开始测试脸书的<strong class="jp ir"> mbasic </strong>版本后，我马上意识到那里的工作方式有些不同。好吧，很不一样。</p><p id="91be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现了两个漏洞，它们允许秘密团体或活动的名称被透露给任何用户，不管他是否被邀请或是否在团体/活动中。第一个漏洞已在此提出，但第二个漏洞尚未完全修补(这些天正在进行中):</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="nc nd l"/></div></figure><h1 id="eb6e" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">始终使用保护措施</h1><p id="eea0" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">说真的，如果脸书为它的任何版本实现了一个单独的私有对象管理器，这些漏洞就会被阻止。希望一个会话管理器能阻止对一个对象的不安全访问的想法是荒谬的，仅仅因为一些对象被如此广泛地使用(像脸书上有数百万成员的组)，用户会话与那个对象的链接是非常低效的(并且是错误的)。</p><p id="2052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">拥有一个<strong class="jp ir">唯一的过滤机制，</strong>一个“避孕套”，来访问最重要的对象或细节，被认为是最佳实践。</p><p id="6c12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">干杯！</p></div></div>    
</body>
</html>