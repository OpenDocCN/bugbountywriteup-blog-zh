<html>
<head>
<title>SSRF via DNS Rebinding (CVE-2022–4096)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过DNS重新绑定的SSRF(CVE-2022–4096)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/ssrf-via-dns-rebinding-cve-2022-4096-b7bf75928bb2?source=collection_archive---------0-----------------------#2022-11-22">https://infosecwriteups.com/ssrf-via-dns-rebinding-cve-2022-4096-b7bf75928bb2?source=collection_archive---------0-----------------------#2022-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a5a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我自己<a class="ae kl" href="http://twitter.com/basu_banakar" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">巴萨瓦拉杰</strong> </a>，今天在这篇文章中，我将解释一下我的第二次CVE，即<a class="ae kl" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4096" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">CVE-2022–4096</strong></a></p><p id="df41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们开始吧</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/bf8977bf58ea45134ad9a6203dfce2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zsc_3dnU9kq9sY99.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">SSRF概述</figcaption></figure><blockquote class="lc ld le"><p id="32de" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir"> SSRF使用DNS重新绑定发现</strong><a class="ae kl" href="https://github.com/appsmithorg/appsmith" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Appsmith</strong></a><strong class="jp ir">。</strong></p><p id="d25d" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated">仅供参考:<a class="ae kl" href="https://github.com/appsmithorg/appsmith" rel="noopener ugc nofollow" target="_blank"> Appsmith </a>用于构建、发布和维护内部工具。</p></blockquote><p id="abbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最初，我通过使用服务器端重定向方法在appsmith中发现了两个SSRF。</p><p id="171e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是绕过这两个最初的SSRF。</p><p id="1a1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> DNS重新绑定概述:</strong></p><blockquote class="lc ld le"><p id="3400" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated">DNS重新绑定是一种操纵域名解析的方法，通常用作计算机攻击的一种形式。在这种攻击中，恶意网页使访问者运行客户端脚本，攻击网络上其他地方的机器。理论上，同源策略可以防止这种情况发生:客户端脚本只允许访问服务于该脚本的同一主机上的内容。比较域名是实施该策略的重要部分，因此DNS重新绑定通过滥用域名系统(DNS)来规避这种保护。</p></blockquote><p id="57c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们通过DNS重新绑定来生成一个主机名，以绕过SSRF限制！<a class="ae kl" href="https://lock.cmpxchg8b.com/rebinder.html" rel="noopener ugc nofollow" target="_blank">https://lock.cmpxchg8b.com/rebinder.html</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lj"><img src="../Images/83b71d9d11d69c5c274cbfbb30491885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NC5oM5Ldl9JfEag6K2UHUQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">DNS重新绑定</figcaption></figure><p id="1518" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到，我们生成的主机名被分配了两个不同的IP</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lk"><img src="../Images/59e883b86dcbce91c08d78cd9289307f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BV4sFaD-qRytG2fYS7qx1g.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">挖掘命令</figcaption></figure><p id="dbf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在易受攻击的功能是创建新的API和Elasticsearch</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/ca408867ec65742f0f13740d220baad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R0uO3e4uTlYN9pupTl_ZCw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">脆弱的功能</figcaption></figure><p id="53c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在url函数中添加生成的主机名，并单击运行，我得到的响应是<strong class="jp ir">主机不允许</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/1b251fdff233532a75207b07a2d7992e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PjD1KaTHOK-wDf2n4urwCQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">不允许主机响应</figcaption></figure><p id="a0bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在再次点击运行后，成功地得到了一些与AWS云元数据路径的响应</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/5991ea412ef68b4eb10a5014e244b8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cv1vQtRkipn367b7GlQgqA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">aws元数据路径</figcaption></figure><p id="e35c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在将“最新的”路径附加到url，并再次单击run，我得到了<strong class="jp ir"> 404 </strong>(因为这次服务器击中了我在DNS重新绑定中使用的IP)。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/069051fa6c949c64808e4a6642874cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBKfWVZNroFU2bgCB1XCbA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">404响应</figcaption></figure><p id="68b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在连续点击和尝试(再次点击“运行”直到我得到一些响应)方法并将路径(我在响应中得到的)附加到url之后，我成功地检索到了AWS键</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ll"><img src="../Images/48cd7293316a049dd0fb50200c16bd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpAGs7mxZC8n1sSgtdw0_Q.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">AWS密钥检索成功</figcaption></figure><p id="0999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">易受攻击的版本:Appsmith &lt; v1.8.1</p><p id="0481" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在将此事报告给Appsmith并获得确认，然后将此事报告给huntr.dev，以获得CVE对此问题的关注，并获得此<a class="ae kl" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-4096" rel="noopener ugc nofollow" target="_blank">CVE-2022–4096</a></p><p id="ea56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请忽略语法和语言的限制:)</p><p id="b514" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">跟我来:</p><p id="1fec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">推特:【https://twitter.com/basu_banakar T2】</p><p id="2b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">insta gram:【https://instagram.com/basu_banakar T4】</p><p id="35f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">领英:<a class="ae kl" href="https://www.linkedin.com/in/basubanakar/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/basubanakar</a></p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h2 id="a7ac" class="lt lu iq bd lv lw lx dn ly lz ma dp mb jy mc md me kc mf mg mh kg mi mj mk ml bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>