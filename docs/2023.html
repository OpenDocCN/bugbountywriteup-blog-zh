<html>
<head>
<title>How I Bypassed 2FA while Resetting Password</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重置密码时我是如何绕过2FA的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-bypass-2fa-while-resetting-password-3f73bf665728?source=collection_archive---------0-----------------------#2022-04-22">https://infosecwriteups.com/how-i-bypass-2fa-while-resetting-password-3f73bf665728?source=collection_archive---------0-----------------------#2022-04-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><blockquote class="jq jr js"><p id="a722" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">这是一个在“Hackerone”上的私人程序，我在心里设定了目标，我必须绕过2fa，所以我检查了每一种绕过“<strong class="jw iu">双因素认证</strong>”的方法</p><p id="1a37" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">为了更好的理解，我把这个博客分成了两部分</p></blockquote><p id="4460" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu"> 1:了解Web应用程序的功能。</strong></p><p id="d6c9" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu"> 2:绕过双因素认证。</strong></p><h1 id="2451" class="kv kw it bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">我们开始吧</h1><p id="ba68" class="pw-post-body-paragraph jt ju it jw b jx lt jz ka kb lu kd ke ks lv kh ki kt lw kl km ku lx kp kq kr im bi translated">我不能透露网站的名字，就当是“Target.com”吧</p><p id="5e97" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">在检查了所有可能的方法后，我开始重置密码功能，我发送了一个密码重置链接，并在我的浏览器中打开了它。</p><p id="bc89" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">" https://ABC . target . com/reset/<token>"</token></p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/9f1f5b228c7168e365dfeb9333f9bc52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tb1iUKE5DjTJiAz1L8sdkA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">输入新密码</figcaption></figure><p id="2f5f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">我输入新的密码，点击下一步按钮，并在打嗝中捕捉到请求。</p><blockquote class="jq jr js"><p id="dfd5" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">请求:</p></blockquote><p id="b145" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">POST <strong class="jw iu"> /reset2fa </strong> HTTP/1.1</p><p id="1e01" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">主持人:abc.target.com</p><p id="bbb4" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi">..</p><p id="d156" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">_ csrf =<token>&amp; reset _ key =<key>&amp; password = Test @ 123</key></token></p><p id="00b1" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">转发此请求后，它被重定向到2fa页面😓</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/30c68f476f30ac8121035275f5017e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*86siOgizXMaDTp7Y8euiVw.png"/></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">2fa页面</figcaption></figure><p id="48c9" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">现在我<strong class="jw iu">从我的账户</strong>禁用2fa，以检查当2fa被启用&amp;禁用时两个请求之间的差异。</p><p id="da37" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">现在，再次用同样的步骤，我请求一个新的密码。</p><p id="ee74" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">输入新密码并在打嗝时捕获请求。</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi ly"><img src="../Images/9f1f5b228c7168e365dfeb9333f9bc52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tb1iUKE5DjTJiAz1L8sdkA.png"/></div></div><figcaption class="mk ml gj gh gi mm mn bd b be z dk translated">输入新密码</figcaption></figure><blockquote class="jq jr js"><p id="a3f5" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated"><strong class="jw iu">请求</strong></p></blockquote><p id="98bd" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">POST <strong class="jw iu"> /reset </strong> HTTP/1.1</p><p id="b14f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">主持人:abc.target.com</p><p id="5c08" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi">..</p><p id="e165" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">_ csrf =<token>&amp; reset _ key =<key>&amp; password = Test @ 123</key></token></p><p id="8af8" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">转发请求后，它被重定向到仪表板。</p></div><div class="ab cl mp mq hx mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="im in io ip iq"><h1 id="2e5e" class="kv kw it bd kx ky mw la lb lc mx le lf lg my li lj lk mz lm ln lo na lq lr ls bi translated">旁路部分</h1><p id="7246" class="pw-post-body-paragraph jt ju it jw b jx lt jz ka kb lu kd ke ks lv kh ki kt lw kl km ku lx kp kq kr im bi translated">通过比较请求，我注意到“<strong class="jw iu"> POST /reset </strong>”被重定向到仪表板，而“<strong class="jw iu"> POST /reset2fa </strong>”被重定向到2fa页面。</p><p id="897e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">为了绕过<strong class="jw iu">，我再次启用了2fa</strong>并要求重置密码。</p><p id="3a4f" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">" https://ABC . target . com/reset/<token>"</token></p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/2b0eaebbab820bef68c888380e044221.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*Lq0L6ujFnVUNGCcm8gYpGQ.png"/></div></figure><p id="0202" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">输入新密码并在打嗝时捕获请求</p><blockquote class="jq jr js"><p id="c78c" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated">原始请求:</p></blockquote><p id="a6d2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">POST<strong class="jw iu">/reset 2 fa</strong>HTTP/1.1</p><p id="e49e" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">主持人:abc.target.com</p><p id="e5fc" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi">..</p><p id="9ca2" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">_ csrf =<token>&amp; reset _ key =<key>&amp; password = Test @ 123</key></token></p><p id="abda" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">将<strong class="jw iu">POST/reset 2 fa</strong>更改为<strong class="jw iu">“POST/reset”</strong></p><blockquote class="jq jr js"><p id="ffa2" class="jt ju jv jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr im bi translated"><strong class="jw iu">修改后的请求:</strong></p></blockquote><p id="8633" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">POST <strong class="jw iu"> /reset </strong> HTTP/1.1</p><p id="8342" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">主持人:abc.target.com</p><p id="e54b" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi">..</p><p id="b3a3" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">_ csrf =<token>&amp; reset _ key =<key>&amp; password = Test @ 123</key></token></p><p id="1df4" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><strong class="jw iu">转发请求并重定向至仪表板😎</strong></p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/1414459dd1a9a9a77b7d19e943703923.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*sjqQiuAQIbwQZJN7rQYbEQ.gif"/></div></figure><p id="b9db" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">向计划报告并奖励$$$</p><figure class="lz ma mb mc gt md gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/cf7d721fa23725a34721ca1d30e4f1fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*iDAEymGhydKoWsoIc6Uz_w.png"/></div></figure><p id="ec64" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated">联系我:</p><p id="bc73" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><a class="ae ne" href="http://www.linkedin.com/in/sufiyan-gouri" rel="noopener ugc nofollow" target="_blank">Linkedin</a>:<a class="ae ne" href="http://www.linkedin.com/in/sufiyan-gouri" rel="noopener ugc nofollow" target="_blank">sufiyan-gouri</a></p><p id="1233" class="pw-post-body-paragraph jt ju it jw b jx jy jz ka kb kc kd ke ks kg kh ki kt kk kl km ku ko kp kq kr im bi translated"><a class="ae ne" href="https://twitter.com/gouri_sufyan" rel="noopener ugc nofollow" target="_blank">推特</a> : @gouri_sufyan</p></div></div>    
</body>
</html>