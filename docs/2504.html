<html>
<head>
<title>Python Source Code Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python源代码分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/python-source-code-analysis-53addcb3894?source=collection_archive---------1-----------------------#2022-11-04">https://infosecwriteups.com/python-source-code-analysis-53addcb3894?source=collection_archive---------1-----------------------#2022-11-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="665b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以通过下面的链接访问用Python编写的易受攻击的web应用程序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/0fa6cb7345d31763b635b04849ffb95a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*POdlJKzUKvT81BEF"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上由<a class="ae lb" href="https://unsplash.com/@hiteshchoudhary?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Hitesh Choudhary </a>拍摄的照片</figcaption></figure><div class="lc ld gp gr le lf"><a href="https://owasp.org/www-project-vulnerable-flask-app/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">OWASP易损烧瓶应用程序</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">erlik 2-Vulnerable-Flask-App Tested-Kali 2022.1它是一个易受攻击的Flask Web App。这是一个创建的实验室环境…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">owasp.org</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt kv lf"/></div></div></a></div><div class="lc ld gp gr le lf"><a href="https://github.com/anil-yelken/Vulnerable-Flask-App/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">GitHub-Anil-yelken/Vulnerable-Flask-App:Erlik 2-Vulnerable-Flask-App</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">erlik 2-Vulnerable-Flask-App Tested-Kali 2022.1它是一个易受攻击的Flask Web App。这是一个创建的实验室环境…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="lu l lq lr ls lo lt kv lf"/></div></div></a></div><div class="lc ld gp gr le lf"><a href="https://github.com/anil-yelken/Vulnerable-Soap-Service/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">GitHub-Anil-yelken/Vulnerable-Soap-Service:Erlik-Vulnerable Soap Service</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">Erlik -易受攻击的Soap服务已测试- Kali 2022.1这是一个易受攻击的SOAP web服务。这是一个实验室环境…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="lv l lq lr ls lo lt kv lf"/></div></div></a></div><h1 id="8568" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">SQL注入</h1><p id="d841" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">发生SQL注入漏洞是因为没有使用参数查询:</p><p id="31b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">cur . execute(" select * from test where username = ' % s ' " % name)</p><h1 id="8147" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">XSS/HTML注入</h1><p id="721c" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">XSS和HTML注入漏洞是由于在没有输入控制的情况下将输出与“Welcome”语句结合起来进行屏幕抑制而导致的。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="a511" class="ne lx iq na b gy nf ng l nh ni">@app.route("/welcome2/&lt;string:name&gt;")<br/>def welcome2(name):<br/>    data="Welcome "+name<br/>    return data</span></pre><h1 id="334c" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">SSTI</h1><p id="5838" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">SSTI漏洞的发生是因为这个人没有检查他写的模板中的输入:</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="6ce8" class="ne lx iq na b gy nf ng l nh ni">@app.route("/welcome2/&lt;string:name&gt;")<br/>def welcome2(name):<br/>    data="Welcome "+name<br/>    return data</span><span id="a42b" class="ne lx iq na b gy nj ng l nh ni">@app.route("/hello")<br/>def hello_ssti():<br/>    if request.args.get('name'):<br/>        name = request.args.get('name')<br/>        template = f'''&lt;div&gt;<br/>        &lt;h1&gt;Hello&lt;/h1&gt;<br/>        {name}<br/>&lt;/div&gt;<br/>'''<br/>		return render_template_string(template)</span></pre><h1 id="6a3d" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">命令注入</h1><p id="8168" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">在命令注入漏洞中，从用户接收的输入在没有任何控制的情况下由子流程模块运行。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="2961" class="ne lx iq na b gy nf ng l nh ni">@app.route("/get_users")<br/>def get_users():<br/>    try:<br/>        hostname = request.args.get('hostname')<br/>        command = "dig " + hostname<br/>        data = subprocess.check_output(command, shell=True)<br/>        return data<br/>    except:<br/>        data = str(hostname) + " username didn't found"<br/>        return data</span><span id="041d" class="ne lx iq na b gy nj ng l nh ni">@rpc( _returns=String)<br/>    def get_log(ctx):<br/>        try:<br/>            command="cat soap_server.log"<br/>            data=subprocess.check_output(command,shell=True)<br/>            return(str(data))<br/>        except:<br/>            return("Command didn't run")</span></pre><h1 id="7ccb" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">信息披露</h1><p id="63e3" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">因为应用程序中的每个事务都被记录，所以关键信息将出现在日志中。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="f3bc" class="ne lx iq na b gy nf ng l nh ni">@app.route("/get_log/")<br/>def get_log():<br/>    try:<br/>        command="cat restapi.log"<br/>        data=subprocess.check_output(command,shell=True)<br/>        return data<br/>    except:<br/>    	pass</span><span id="f580" class="ne lx iq na b gy nj ng l nh ni">@rpc( _returns=String)<br/>    def get_log(ctx):<br/>        try:<br/>            command="cat soap_server.log"<br/>            data=subprocess.check_output(command,shell=True)<br/>            return(str(data))<br/>        except:<br/>            return("Command didn't run")</span></pre><h1 id="4a51" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">LFI</h1><p id="aa24" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">由于GET方法没有提供对使用filename参数接收的输入的控制，因此会读取系统中的文件，从而出现LFI漏洞。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="30e3" class="ne lx iq na b gy nf ng l nh ni">@app.route("/read_file")<br/>def read_file():<br/>    filename = request.args.get('filename')<br/>    file = open(filename, "r")<br/>    data = file.read()<br/>    file.close()<br/>    return jsonify(data=data),200</span><span id="72c4" class="ne lx iq na b gy nj ng l nh ni">@rpc(String, _returns=String)<br/>    def read_file(ctx,file):<br/>        file = open(file, "r")<br/>        data = file.read()<br/>        file.close()<br/>        return(data)</span></pre><h1 id="8144" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">荒漠化</h1><p id="02aa" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">对于Python的反序列化漏洞，可以在源代码中搜索pickle.loads语句。</p><p id="2dab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">data = pickle . loads(received _ data)</p><h1 id="06de" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">磁盘操作系统</h1><p id="2d98" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">使用regex搜索使用GET方法从用户处获得的用户名和密码信息时，会出现DOS漏洞。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="b08f" class="ne lx iq na b gy nf ng l nh ni">@app.route("/user_pass_control")<br/>def user_pass_control():<br/>    import re<br/>    username=request.form.get("username")<br/>    password=request.form.get("password")<br/>    if re.search(username,password):<br/>        return jsonify(data="Password include username"), 200<br/>    else:<br/>        return jsonify(data="Password doesn't include username"), 200</span></pre><h1 id="9ce4" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">文件上传</h1><p id="c0fd" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">因为从用户接收的文件没有大小、扩展名、内容类型控制，所以所选择的文件被直接上传到系统。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="9142" class="ne lx iq na b gy nf ng l nh ni">@app.route('/upload', methods = ['GET','POST'])<br/>def uploadfile():<br/>   import os<br/>   if request.method == 'POST':<br/>      f = request.files['file']<br/>      filename=secure_filename(f.filename)<br/>      f.save(os.path.join(app.config['UPLOAD_FOLDER'], filename))<br/>      return 'File uploaded successfully'<br/>   else:<br/>      return '''<br/>&lt;html&gt;<br/>   &lt;body&gt;<br/>      &lt;form  method = "POST"  enctype = "multipart/form-data"&gt;<br/>         &lt;input type = "file" name = "file" /&gt;<br/>         &lt;input type = "submit"/&gt;<br/>      &lt;/form&gt;   <br/>   &lt;/body&gt;<br/>&lt;/html&gt;<br/>      '''</span></pre><h1 id="faee" class="lw lx iq bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">日志的不正确输出中和</h1><p id="5834" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">利用日志的不正确输出抑制漏洞，攻击者可以了解任何数据都可以写入日志，并可以注入恶意代码或导致日志显示不正确。</p><pre class="km kn ko kp gt mz na nb nc aw nd bi"><span id="e1ba" class="ne lx iq na b gy nf ng l nh ni">@app.route('/logs')<br/>def ImproperOutputNeutralizationforLogs():<br/>    data = request.args.get('data')<br/>    import logging<br/>    logging.basicConfig(filename="restapi.log", filemode='w', level=logging.DEBUG)<br/>    logging.debug(data)<br/>    return jsonify(data="Logging ok"), 200</span></pre><div class="lc ld gp gr le lf"><a href="https://github.com/anil-yelken/python-source-code-analysis/blob/main/README.md" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">python-source-code-analysis/readme . MD位于main Anil-yelken/python-source-code-analysis</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">您可以通过下面的链接访问用Python编写的易受攻击的web应用程序。OWASP易损烧瓶应用程序…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="nk l lq lr ls lo lt kv lf"/></div></div></a></div><div class="lc ld gp gr le lf"><a href="https://github.com/anil-yelken" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">阿尼尔-耶尔肯-概述</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="nl l lq lr ls lo lt kv lf"/></div></div></a></div></div><div class="ab cl nm nn hu no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ij ik il im in"><h2 id="38a8" class="ne lx iq bd ly nt nu dn mc nv nw dp mg jy nx ny mk kc nz oa mo kg ob oc ms od bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lb" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>