<html>
<head>
<title>Bypass the Firewall with SSH Tunnelling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用SSH隧道绕过防火墙</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bypass-the-firewall-with-ssh-tunnelling-711fa78ea97f?source=collection_archive---------0-----------------------#2022-05-28">https://infosecwriteups.com/bypass-the-firewall-with-ssh-tunnelling-711fa78ea97f?source=collection_archive---------0-----------------------#2022-05-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0a8b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">创建SSH隧道以通过端口22访问阻塞端口的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7007e9bf6bfd0533dc0a0d6b37b1b622.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s8z9sil7EnwspH77kdrzjg.png"/></div></div></figure><p id="6421" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你在公司工作吗？他们的防火墙有问题吗？或者你是一个在你的本地计算机上制作netcat监听器的黑客？</p><p id="dfce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这篇文章适合你。因为今天我将向您解释如何创建一个ssh隧道来通过端口22访问被阻塞的端口。</p><p id="ebfd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">默认情况下，端口22用于ssh连接，几乎每个公司都允许在防火墙中使用该端口。</p><h2 id="aca7" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">虚拟场景</h2><p id="565a" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">在这种情况下，我想制定一个防火墙规则来阻止我的Windows计算机中的facebook.com。这是一个概念证明，我们将通过ssh隧道绕过防火墙。</p><h2 id="9c95" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">我的防火墙设置</h2><p id="5c9f" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">首先，用nslookup命令收集脸书的IP。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/0cb47ffe4e8a12786f435840e4a38899.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*W98RW39M_EG8VVk9rFR_QQ.png"/></div></figure><p id="61fc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然后，我在防火墙中创建新的出站规则，专门用于阻止facebook.com</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/a44eec31608d835685d86c5f15911c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wv7skzArN_mtQmvplRMfTg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/33d1fff9cb6026480de3b151d77bae5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E0VeM_mjzN5d88HK5RMy-w.png"/></div></div></figure><h2 id="c0af" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">我的工作笔记本电脑(Windows) —在SSH隧道之前</h2><p id="1bf7" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">因为防火墙阻止了对facebook.com的访问，所以当我试图用浏览器连接时，这是我的浏览器的回应:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/49ea37c353bbe44e6f5787a84dd5e19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oTLlcpr1EZVzxCjxVSNQSQ.png"/></div></div></figure><h2 id="2c02" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">绕过防火墙</h2><p id="4cd4" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">一开始，我在Ubuntu服务器上设置sshd_config。</p><h2 id="abbc" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">我的服务器(Ubuntu服务器)</h2><p id="7cb1" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">确保/etc/ssh/sshd_config文件中的配置如下:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8aac" class="ln lo iq mq b gy mu mv l mw mx"><strong class="mq ir">AllowTcpForwarding</strong> yes<br/><strong class="mq ir">GatewayPorts</strong> yes</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b1b038d76b77cb48c142d636a0984172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*s6Cc2yCQ8mr8YWlW8rGRIQ.png"/></div></figure><p id="378d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">之后，重新启动sshd服务，以确保应用了配置。</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="d7c1" class="ln lo iq mq b gy mu mv l mw mx">sudo service sshd restart</span></pre><h2 id="f119" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">我的工作笔记本电脑(Windows)—SSH隧道之后</h2><p id="f245" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">步骤1在windows机器上，创建一个ssh隧道:</p><pre class="kg kh ki kj gt mp mq mr ms aw mt bi"><span id="8afc" class="ln lo iq mq b gy mu mv l mw mx">ssh -N -D user@ip-server</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/df2b669edff7e328a8f74ac73741a985.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*gzs_u78ShMAlyzjxsX3-FQ.png"/></div></figure><p id="b716" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注意:</p><p id="caf8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">-N →不登录服务器</p><p id="8f2f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">-D→动态隧道</p><p id="d181" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">8181 →本地主机中的端口是否绑定到192.168.0.113中的任何端口</p><p id="c671" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下一步是这样设置您的代理，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/3c82ebfc3ec544d1c226b4eee1972435.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*pq0ECZsp643yR3FclmqCwQ.png"/></div></figure><p id="6ed2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">恭喜你，你的ssh隧道代理服务器<strong class="kt ir">工作正常</strong>，你绕过了防火墙。</p><h2 id="087b" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">演示</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/580bf8d6bc80c22a6908399be2f59593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5nK-woOvZupOnAtPoMFwCA.gif"/></div></div></figure><h2 id="d820" class="ln lo iq bd lp lq lr dn ls lt lu dp lv la lw lx ly le lz ma mb li mc md me mf bi translated">结论</h2><p id="cd93" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">防火墙不是确保公司安全的安全工具之一。与一些安全工具进行组合，让攻击者陷入困境。</p><p id="9d08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>