<html>
<head>
<title>Capture The Flag (CTF) Series- Write up 01- Mr. Robot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">夺旗(CTF)系列-记起01-机器人先生</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/capture-the-flag-ctf-series-write-up-01-mr-robot-78b2006471c2?source=collection_archive---------2-----------------------#2020-07-19">https://infosecwriteups.com/capture-the-flag-ctf-series-write-up-01-mr-robot-78b2006471c2?source=collection_archive---------2-----------------------#2020-07-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d512" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">了解如何通过利用不同类型的漏洞来捕获目标机器上的隐藏标志</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/262a6d9c87d3bbd34333ad7c82d0fcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPnqKn_tiysbyTcC1KodWQ.jpeg"/></div></div></figure></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><p id="9e18" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">嘿，伙计们，欢迎来到我的新CTF系列，在这里我将介绍关于不同CTF挑战的报道。所以，事不宜迟，让我们进入CTF吧</p><p id="7333" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这个CTF是以电视季《机器人先生》为主题的，如果你是《机器人先生》的粉丝，那么你一定知道这个故事的背景和其中的角色。这座CTF的建造方式非常有趣。目标机器上总共隐藏了3个标志，必须使用不同的技术和工具才能找到它们。如果您一直在关注我以前的文章，那么您可能对大多数工具都很熟悉，即使您不是，也不要担心，我会尽可能详细地介绍这些工具，并包含一些链接，这样您就可以对这些工具有一个大致的了解</p><h2 id="d3ee" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">目标</h2><p id="8b96" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">捕捉隐藏的旗帜</p><h2 id="c1f5" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">先决条件</h2><p id="4a80" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">虽然我的文章会很详细，但我建议你对以下内容有基本的了解</p><ol class=""><li id="e7aa" class="ms mt iq la b lb lc le lf lh mu ll mv lp mw lt mx my mz na bi translated"><a class="ae nb" href="https://tools.kali.org/web-applications/gobuster" rel="noopener ugc nofollow" target="_blank">捉鬼敢死队</a></li><li id="1952" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated"><a class="ae nb" href="https://cirt.net/nikto2" rel="noopener ugc nofollow" target="_blank">尼克托</a></li><li id="69ac" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated"><a class="ae nb" href="https://portswigger.net/burp" rel="noopener ugc nofollow" target="_blank">打嗝</a></li><li id="9f33" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated"><a class="ae nb" href="https://wpscan.org/" rel="noopener ugc nofollow" target="_blank"> Wpscan </a></li><li id="eb66" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated">基本的脚本和Linux知识</li><li id="326f" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated"><a class="ae nb" href="https://hackercombat.com/password-cracking-tool-hydra/" rel="noopener ugc nofollow" target="_blank">九头蛇</a></li><li id="e8e6" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated">Nmap</li><li id="8e64" class="ms mt iq la b lb nc le nd lh ne ll nf lp ng lt mx my mz na bi translated">网络发现</li></ol><h1 id="4179" class="nh lv iq bd lw ni nj nk lz nl nm nn mc jw no jx mf jz np ka mi kc nq kd ml nr bi translated">初始设置</h1><p id="033d" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">你需要先下载<a class="ae nb" href="https://download.vulnhub.com/mrrobot/mrRobot.ova" rel="noopener ugc nofollow" target="_blank">机器人先生VM </a>。设置您的VM与目标机器交互，您可以使用Kali Linux、Parrot OS或您选择的任何其他发行版</p><h2 id="f462" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">侦察和扫描</h2><p id="7b4f" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">因此，我们有我们的两个虚拟机运行，即机器人先生的目标虚拟机和我们的Kali Linux盒与它进行交互。让我们首先发现目标机器的IP地址。在确认我的主机IP地址后，我将使用Kali Box中已经预建的<strong class="la ir"> Netdiscover </strong>工具，让我们开始如图所示的发现。<strong class="la ir"> -r </strong>开关用于指定我们希望扫描发现的子网范围。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/b8c5d8dcc70190f8dcedaf67ebcf977c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*r_peO7EHZRWSyvKmA4ETEA.png"/></div></figure><p id="df8a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">几秒钟后，结果将如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/a9a8eaa1a84ceb6bb65e2c7ee3d4c015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_U8C8NOAjbbPyC01XdezmQ.png"/></div></div></figure><p id="d806" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">所以我们现在有了目标IP。让我们对它进行Nmap扫描。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/f2fefb688e1f8a1896535c6b3fb94a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x6cOMokYdu0VWXvdQqDimg.png"/></div></div></figure><p id="9eb6" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">分析上面的扫描，我们知道有一个web服务在端口80上运行。让我们导航到端口80上的网页</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/76a6ad66650c88017b4fe60c47a6db6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Oa7w8zhgb1c5A7Wy4_EFw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/b8d45bb3a5ea4e306d5bd7ef54651f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NSL45iEzzy1eGqzbXCxm_Q.png"/></div></div></figure><p id="7455" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如上所述，当我们在网络浏览器上输入目标IP时，我们会看到一个交互式屏幕，上面显示了电视季《机器人先生》中的一些事件。这没有给我们任何有趣的东西。我们需要挖掘更多的信息来进入机器。所以让我们使用<strong class="la ir"> Gobuster </strong>或<strong class="la ir"> Nikto </strong>来找出隐藏的目录。在大多数情况下，当我们处理web应用程序的web服务器时，总会有一个重要的隐藏目录，称为robots.txt。Gobuster正在使用一个包含常用目录名的世界列表执行暴力攻击。查找web应用程序上的目录和漏洞的另一种方法是使用Nikto，它是一个web应用程序扫描器。我两个都用了，这样你就可以看到这些工具是如何工作的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/e39b91d7e1a40a11379eb87861b42335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MBxNAxMZKX5ADl6FbQZDKQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">使用Gobuster查找隐藏目录</figcaption></figure><p id="335f" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">如上所示，我们看到一个名为<strong class="la ir">机器人的目录。</strong>我们可以类似地使用Nikto来达到相同的目的，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/96b4f28b12f4b3a0b0b5f09256446d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IeLzAcbnYLxjtz0LAy6rSw.png"/></div></div></figure><h2 id="2e27" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">列举</h2><p id="6532" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">让我们导航到机器人的目录。如下图所示，我们必须将文件保存在robots.txt目录中。这个目录包含我们的第一个标志和一个字典，在我们即将到来的与目标机器的交互中可能会派上用场</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi od"><img src="../Images/d0d1c12bbb84a74c4e2f19459fbef2ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*Bhyopo35TMFvxEXcBUBUaA.png"/></div></figure><p id="5154" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在我们可以使用<strong class="la ir"> wget </strong>获取本地机器上的文件</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/f4e17cc661071c5e5cfa72f23124f7b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mYlX-dDdB_TQ_o6xBNlbxQ.png"/></div></div></figure><p id="c6c3" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在导航到桌面，找出我们的第一个标志的输出</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/042ba01c6712819843a71d3d1de90951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*JmpC6jfTw6_Sq400b9HV7g.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">标志1内容</figcaption></figure><p id="c312" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">查看fsocity.dict的大小和内容，该文件是一个字典，可用于字典攻击。字典文件有很多单词，我们可以在下面看到文件的大小，在检查文件的内容后，发现有重复的单词可以排序，这样我们的蛮力就可以花更少的时间</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/2e12361ec9b6beb47778a2418699142e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*zLBMoHE8waczpXsjwvxFrw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/68ba3fa7128d9d6a07d194eeeffc3157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*34iUj-2ZFdaLu_q7lx5Hwg.png"/></div></div></figure><p id="aa89" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">上面的命令按照升序排序<strong class="la ir"> fsocity.dict </strong>文件，并以一种独特的方式消除重复。</p><p id="4628" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">回过头来看一下<strong class="la ir"> Nikto </strong>扫描，我们找到了一条通向/wp-login.php的路径</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/52d3aebb8bf78dcc43112758b66776f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R8HYE6epEjnVBj2oAvnjrQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">wp-login.php</figcaption></figure><p id="f78e" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在，这部分是事情变得更有趣的地方。我们需要用户名和密码才能登录到word press登录面板。因此，我们可以使用<strong class="la ir"> Burpsuit </strong>拦截POST Form方法的流量，如下所示。为Mozilla打开代理，我使用了<a class="ae nb" href="https://addons.mozilla.org/en-US/firefox/addon/foxyproxy-standard/" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> foxy proxy </strong> </a>来配置burp拦截的本地代理。如果你愿意，你也可以在浏览器设置中设置代理。我使用随机的用户名和密码，这样我就可以拦截Burp上的流量</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/83326f37d7851bc67ecb38d7a1566b46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X9IgoQZ_siDOAFikVphSSQ.png"/></div></div></figure><p id="ee8c" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在我们知道了表单的参数，让我们用H <strong class="la ir"> ydra </strong>来蛮力。记住fsocity字典文件，这将在使用<strong class="la ir"> Hydra </strong>时派上用场，如下图所示。<strong class="la ir"> -V </strong>标志是为了详细起见，因为这将向我们显示每一次暴力尝试的细节。<strong class="la ir"> -p </strong>标志用于提供用户名。正如我们从Burpsuite截取中所知，该请求是一个<strong class="la ir"> HTTP后置格式</strong>，所以我们在Hydra的参数中提到了这一点。剩下的语法是对我们前面看到的表单参数的引用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/104104b33f15c28e12467f76501fa7a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WIREl6I4Gyhw3N9t7sjLoA.png"/></div></div></figure><p id="435d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">咩！！！我们得到了使用。现在让我们使用这个用户来获取密码。我用的是WPscan，这是一个针对word press网站的漏洞扫描器。我们将在这里使用我们的分类词典</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/3301e3583b1c0da0b206acb6b09c42f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4W9RCmVzgKQD6Zm81nA8g.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">Wpscan语法</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi om"><img src="../Images/4a46294ade642a32b26ddc7664a2e5b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*URS6IbVDoxzq-cpMiU3BYQ.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">找到凭据</figcaption></figure><h2 id="3bb2" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">获得访问权限</h2><p id="98bf" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">如上所述，我们获得了word press登录页面的凭据。现在我们可以使用这些凭证登录。我们现在作为WordPress Cpanel的管理员用户登录</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/a2fe715de5037d63edcbbe5e8806b89b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b_xpHpYgbBnst8vq8Tmsxw.png"/></div></div></figure><p id="5507" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">正如你所看到的，我们已经可以访问WordPress站点的管理页面了。我们还没有完成，因为我们需要访问服务器本身。为此，我们有两种方法，要么我们利用WordPress的漏洞，要么我们通过上传一个反向shell脚本来获得一个反向shell。我使用后一种方法，因为我没有使用Metasploit框架获得shell</p><p id="5a47" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我在PHP中找到了一个反向shell脚本，并用我的主机IP地址和端口编辑了它，这些地址和端口将用于任何传入的反向连接。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi on"><img src="../Images/55c32c360bb98d6e896ea3678feb9b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*wYiKsy9zI4BTsnJC18bk8Q.png"/></div></figure><p id="ff70" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们需要找到一个可以上传shell脚本的地方。通过导航到不同的选项卡，我找到了一个可以粘贴反向shell脚本的地方。404.php似乎是一个完美的地方，我可以粘贴如下所示的脚本</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/568d25e55d547ea5a44455fe752b34b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDkRgBs_V6vgbB2mdEMbOQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/c2f8ad386d9c1567119ec65ddbc2aa15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgRo3WWiYTXeIC-xoxBsDQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">上传成功</figcaption></figure><p id="389e" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">使用Netcat监听脚本前面指定的端口</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/79de0d5c9ab72728e0a7acccd248cfda.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*NYjO1V8-VzLWK_qwptqPmw.png"/></div></figure><p id="2513" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我将在web浏览器上导航到404.php路径。当我导航到路径时，脚本就开始运行了！！！我们有一个目标Web服务器的shell</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/c89acd68a53fb25e4a8dcf462e982a73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*18RGXkSWfq_KtvWzowv1Aw.gif"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/50319c7ebacffe2c74615c0a48cab78b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TvYhdwpCvvkPuIlY5Yub3Q.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">目标机器外壳</figcaption></figure><p id="fe14" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们的第二个标志出现在这台机器上，但是注意到我不能输出标志内容。还有一个名为password.raw-md5的文件。访问它时，我们会获得另一个用户的密码，这可能是我们访问key-2-of-3.txt内容的途径。请注意，当我尝试访问该用户时，它会说该命令必须从终端运行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi os"><img src="../Images/24260b2e495004a26e3e9ccd2e44f425.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*lZNrSQd-35Pkv53j-R0-DQ.png"/></div></figure><p id="dce2" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">要获得TTY终端，我们必须从中派生出一个shell。我们可以使用python来做这件事，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/7901b13db2adf2e89a9a8ee298f33363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*LraIv29ENx6vsjzVGr889A.png"/></div></figure><p id="4b06" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在我们有了TTY终端，让我们访问password.raw-md5的内容。该文件包含用户机器人的md5哈希。我们在网上破解吧</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/e89daedd88547c72f09dd1f1fa29cef1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IMHPD-ReaiT8ZogXWYMzgQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">破解Md5哈希</figcaption></figure><p id="de82" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">让我们使用用户的凭证登录，并获取我们的标志2的内容</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/970e270416f47a1a06d0ada5992b07af.png" data-original-src="https://miro.medium.com/v2/resize:fit:978/format:webp/1*EZZmKyo4_X5JXPalnU-VXg.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">标志2</figcaption></figure><h2 id="85ba" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">提升权限</h2><p id="e65e" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">既然我们已经抓住了两个旗子，是时候找到最后一个了。我们当前登录的用户不是root用户，我们需要找到一种方法来提升我们的权限。让我们通过检查如下所示的setuids来检查用户是否允许使用当前权限运行某些服务或工具</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/ecf628ee5817faad7f04194ace8ea724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jdCw6AxVctYZyxE8Vg_Ww.png"/></div></div></figure><p id="68f5" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">当前用户似乎已经设置了运行Nmap的权限。看来<strong class="la ir"> Nmap </strong>支持<strong class="la ir">交互模式</strong>，该模式易受攻击，可被利用。因此，我们运行bash命令，是的，我们现在是root用户，如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/c48e49485adfa50a10d9c77633c07f9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EJhTcQ_Xulmp-dro4C4LAQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">获取Root访问权限</figcaption></figure><p id="7399" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">导航到根文件夹，我们可以找到我们的最后一个标志。所以我们的最后一面旗帜是通过升级特权找到的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/5f86140e6d2ec541e4fddbaf487b703c.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*oPj77wJ3_zlrQsonxZg7mg.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">标志3</figcaption></figure><h2 id="5cab" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">结论</h2><p id="191d" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">我们从这个CTF身上学到了很多。我们不仅学习了不同的工具并与之互动，还了解了使用不同的工具和技术攻击易受攻击的机器的流程。</p><p id="f519" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="la ir">我希望你在阅读这篇文章时感到有趣。更多的报道很快就会出现。</strong></p></div><div class="ab cl kr ks hu kt" role="separator"><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw kx"/><span class="ku bw bk kv kw"/></div><div class="ij ik il im in"><h2 id="d521" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lh md me mf ll mg mh mi lp mj mk ml mm bi translated">关于我</h2><p id="462d" class="pw-post-body-paragraph ky kz iq la b lb mn jr ld le mo ju lg lh mp lj lk ll mq ln lo lp mr lr ls lt ij bi translated">我是一名网络安全爱好者，正在攻读信息安全硕士学位，并试图进入全职网络安全职业生涯。你可以点击阅读更多文章和演练<a class="ae nb" href="https://medium.com/@anon_7" rel="noopener"/></p></div></div>    
</body>
</html>