<html>
<head>
<title>Android Pentesting Setup On Macbook M1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Macbook M1上的Android测试设置</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/android-pentesting-setup-on-macbook-m1-d2f1f0a8db4b?source=collection_archive---------0-----------------------#2022-04-09">https://infosecwriteups.com/android-pentesting-setup-on-macbook-m1-d2f1f0a8db4b?source=collection_archive---------0-----------------------#2022-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d00e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好黑客们，</p><p id="2e48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">众所周知，对于人工智能测试，我们需要物理设备或仿真器。当我开始学习模拟器时，我参考了互联网上的一些视频和博客，每个人都建议使用Genymotion模拟器。用了一段时间后，我注意到它基于x-86的架构，所以我们不能测试基于x-64架构的应用。此外，在基于Flutter的应用程序中，他们为SSL pin提供了内部安全性。最近，我转移到Macbook m1进行全职测试。M1芯片不支持虚拟化，所以没有Virtualbox。而且Gennymotion对virtualbox有依赖性。没有virtualbox它不会工作。经过一番研究，我找到了比基因运动更好的方法</p><p id="baf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于模拟器，我选择Andriod工作室。Andriod工作室有他们的虚拟设备。从他们的官方网站下载最新的Andriod studio。关于安装，你可以参考任何Youtube视频，这很简单。</p><h2 id="d8a0" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">安卓工作室大黄蜂2021.1.1补丁3</h2><p id="0c47" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated"><a class="ae lj" href="https://developer.android.com/studio?gclid=CjwKCAjw3cSSBhBGEiwAVII0Z4hEm14aycDbNNrS0fAwH9rI-Ge77EObpqD6V_6DnppYgICNQEfk7BoCKPkQAvD_BwE&amp;gclsrc=aw.ds" rel="noopener ugc nofollow" target="_blank">https://developer.android.com/studio?gclid = cjwkcajw3cssbgbgeiwavii 0 z 4 hem 14 aycdbnnrs 0 faw H9 ri-ge 77 eobpqd 6v _ 6 dnppygicnqefk 7 bockpkqavd _ BwE&amp;gcl src = aw . ds</a></p><p id="9ba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装后打开Andriod Studio并创建一个设备</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/19a3cf52acaa37ca0346c188bf4745c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_2U26X9390KuAUQcpa4rOg.png"/></div></div></figure><p id="d8bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我选择Pixel2 API级别— 32 arm64-v8a</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/205a3fc9e47f1dc576d7e3c5dc11262d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhIU9P8lDhDB1rQX0KiGww.png"/></div></div></figure><p id="e78f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个现代应用程序都支持这种配置。</p><p id="693c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建设备后，将设备名称复制到剪贴板上。走这条路。/Users/your name/Library/Android/SDK/Emulator，然后用这个命令<strong class="jp ir">打开仿真器。/emulator-avd pixel 2-writable-system</strong></p><p id="0ecf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Pixel2是我自定义设备名称，在您的情况下，使用此命令查找您的设备名称会有所不同。<strong class="jp ir"> /emulator -list-avds </strong>和-writable -system对于安装burp证书非常重要</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/4468a31954d071e03494aee527739305.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVh-EywREryrTno9c-kljQ.png"/></div></div></figure><p id="270e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最重要的部分来自这里安装Burpsuite证书作为系统级可信CA，这是对SSL锁定的渗透解决方案。</p><p id="eb2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有可信CA都存储在Andriod中的路径<strong class="jp ir">/system/etc/security/cacerts</strong>中。经过一些修改的root权限允许我们在这里添加我们的证书</p><p id="d19a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">导出并转换打嗝CA </strong>第一步是获得正确格式的打嗝CA。使用Burp Suite，以DER格式导出CA证书。我把它保存为<code class="fe lw lx ly lz b">cacert.der</code></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ma"><img src="../Images/c61a939ac5cb1e6679426a44522960a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCBbwwDw6swUdKPml3aT7g.png"/></div></div></figure><p id="3918" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Android希望证书采用PEM格式，并且文件名等于附加了<code class="fe lw lx ly lz b">.0</code>的<code class="fe lw lx ly lz b">subject_hash_old</code>值。</p><p id="c687" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe lw lx ly lz b">openssl</code>将DER转换为PEM，然后输出<code class="fe lw lx ly lz b">subject_hash_old</code>并重命名文件:</p><pre class="ll lm ln lo gt mb lz mc md aw me bi"><span id="302e" class="kl km iq lz b gy mf mg l mh mi">openssl x509 -inform DER -in cacert.der -out cacert.pem</span><span id="e289" class="kl km iq lz b gy mj mg l mh mi">openssl x509 -inform PEM -subject_hash_old -in cacert.pem | head -1<br/>9a5ba575.     #output hash value </span><span id="0b75" class="kl km iq lz b gy mj mg l mh mi">mv cacert.pem 9a5ba575.0        # change name     </span></pre><p id="7e28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">将证书复制到设备</strong>我们可以使用<code class="fe lw lx ly lz b">adb</code>来复制证书，但是由于它必须被复制到<code class="fe lw lx ly lz b">/system</code>文件系统，我们必须将其重新挂载为<strong class="jp ir">可写的</strong>。作为根，这很容易与<code class="fe lw lx ly lz b">adb remount</code>。</p><p id="1937" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">。/emulator -avd Pixel2 - <strong class="jp ir">可写-系统。#对于这个可写系统是IMP </strong></p><pre class="ll lm ln lo gt mb lz mc md aw me bi"><span id="843e" class="kl km iq lz b gy mf mg l mh mi">adb root<br/>adb remount<br/>adb push 9a5ba575.0 /sdcard/</span></pre><p id="3fb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只需放入一个shell ( <code class="fe lw lx ly lz b">adb shell</code>)并将文件移动到<code class="fe lw lx ly lz b">/system/etc/security/cacerts</code>并将其更改为644:</p><pre class="ll lm ln lo gt mb lz mc md aw me bi"><span id="8c17" class="kl km iq lz b gy mf mg l mh mi">mv /sdcard/9a5ba575.0 /system/etc/security/cacerts/<br/>chmod 644 /system/etc/security/cacerts/9a5ba575.0</span></pre><p id="75f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在用<strong class="jp ir"> adb重启</strong>重启仿真器，并开始用Burpsuite代理</p><p id="b3c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复制机器的IVP4地址，在模拟器中打开扩展控制，然后转到代理选项卡—手动代理配置—根据您的主机名和端口名。Burpsuite配置。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/401daa37cb98949175bd5efb38b29430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8ZH2wn4cgfOdVC1P6Q97A.png"/></div></div></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/a057cfabb190385eb9221ed276645057.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6dGAuk2Kip6YgQacZyHHSA.png"/></div></div></figure><p id="96b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在可以走了。</p><p id="e304" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">黑客快乐…..！</p><div class="mk ml gp gr mm mn"><a href="https://www.linkedin.com/in/ajay-magar/" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">Ajay Magar -安全研究员- HackerOne | LinkedIn</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">查看Ajay Magar在全球最大的职业社区LinkedIn上的个人资料。Ajay有2份工作列在他们的…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">www.linkedin.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb lu mn"/></div></div></a></div></div></div>    
</body>
</html>