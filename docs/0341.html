<html>
<head>
<title>Shopping Products For Free- Parameter Tampering Vulnerability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">购物产品的自由参数篡改漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/shopping-products-for-free-parameter-tampering-vulnerability-8e09e1471596?source=collection_archive---------0-----------------------#2019-07-21">https://infosecwriteups.com/shopping-products-for-free-parameter-tampering-vulnerability-8e09e1471596?source=collection_archive---------0-----------------------#2019-07-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="eab8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从一个电子商务网站在网上讨价还价。</p><p id="84b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我收到了一个非常受欢迎的电子商务网站的黑客邀请。我已经从那个网站订购了很长时间。所以我开始测试，特别是公司想要首先影响他们业务的错误。所以我首先想到的，显然是参数篡改。</p><h1 id="2596" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">总结</strong></h1><p id="f8b3" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">参数篡改攻击依赖于由用户改变的参数的操作，从而改变应用信息，如用户凭证和许可以及产品数量等。通常，这些数据在post请求或隐藏的种类字段中传递。<br/>我们将调查价格操纵漏洞，这一漏洞目前几乎存在于所有在线购物车和支付网关中。</p><blockquote class="lo lp lq"><p id="870e" class="jn jo lr jp b jq jr js jt ju jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj kk ij bi translated">出于显而易见的原因，我们将假设该网站为<strong class="jp ir">redacted.com</strong>。该网站的主要问题是，他们每次保持产品的上限不超过10个数量，但对于下限，他们忘记了设置约束。因此，任何人都可以将购物车价值减为负值，然后乘以产品价格，从而在购物车中添加负的数量和价格。</p></blockquote><h1 id="b005" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">冲击</strong></h1><p id="29f3" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">由于一个业务逻辑错误，我可以篡改购物车的值，并添加产品的负数量，这反映在结账时，并以较低的价格订购产品，因为对最小购物车值有限制。</p><h1 id="0fa4" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">复制步骤:</strong></h1><ul class=""><li id="058e" class="lv lw iq jp b jq lj ju lk jy lx kc ly kg lz kk ma mb mc md bi translated">访问redacted.com，打开你不想买的产品，把它放入购物车，就像我添加t恤衫和拦截请求一样，然后把数量改为-10。<br/> <em class="lr">值:-10 * 599</em>₹<em class="lr">=-5990</em>₹<em class="lr">/-</em></li></ul><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/08fd614d0103bcf1320ea92ee754f235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkXt00fna7YRzmcS82xwQg.png"/></div></div></figure><ul class=""><li id="793c" class="lv lw iq jp b jq jr ju jv jy mq kc mr kg ms kk ma mb mc md bi translated">然后为了平衡购物车，我又加了7只鞋。<br/> <em class="lr">值:7*399 </em> ₹ <em class="lr"> =2793 </em> ₹ /-</li></ul><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/37a192295603d9408cd1eb4fc2d7bb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qv-vkC21T6uryKhVUdsbQw.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">7双鞋平衡399英镑</figcaption></figure><ul class=""><li id="5b84" class="lv lw iq jp b jq jr ju jv jy mq kc mr kg ms kk ma mb mc md bi translated">不过，购物车需要有一些正值，以便显示在UI上。</li><li id="23ab" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">我又加了8个丹尼尔。<br/> <em class="lr">值:8*399 ₹ = 3192 ₹ /- </em></li></ul><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/98d978f6ba6765bcfe7fcca1e436969d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e5TVX0YshY35uFoV-tlr6Q.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">399英镑再买8条牛仔布</figcaption></figure><ul class=""><li id="f255" class="lv lw iq jp b jq jr ju jv jy mq kc mr kg ms kk ma mb mc md bi translated">当我随机添加到余额中并尝试用总花费<em class="lr"> -5 ₹ </em>购买时。但是它向我显示了一个错误。<br/> <em class="lr">数值:-5990 ₹ +2793 ₹ + 3192 ₹ = -5 ₹ </em></li></ul><blockquote class="lo lp lq"><p id="abbc" class="jn jo lr jp b jq jr js jt ju jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj kk ij bi translated">因为最小的购物车价值是350 ₹，继续进行和结帐。</p></blockquote><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi nc"><img src="../Images/3d4553b14c10c9bdc258531a4faaab64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PxFcx29tlIj1kY76fjf1MA.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">推车总数不到350 <em class="nd"> ₹ </em></figcaption></figure><p id="260e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我又加了1件599 ₹的衬衫，这样加起来就比3件50 ₹的多了。</p><ul class=""><li id="6559" class="lv lw iq jp b jq jr ju jv jy mq kc mr kg ms kk ma mb mc md bi translated">总成本变成了<em class="lr"> 594 ₹ </em>加上商品及服务税，大约是<em class="lr"> 923 ₹ </em>。</li></ul><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi ne"><img src="../Images/42a6977d9c4586ff491298ae9eb6a544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xm6vd772YMTT73ZDSo1SGg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">最终购物车价值</figcaption></figure><ul class=""><li id="34dd" class="lv lw iq jp b jq jr ju jv jy mq kc mr kg ms kk ma mb mc md bi translated">所以我的购物车里有7双鞋，8条短裤和1件小衬衫可以买。</li><li id="ed20" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">我进一步选择了地址，并找到了支付方式，通过信用卡支付。</li><li id="f0f9" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">订单成功。</li><li id="1d81" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">然后，我报告了视频POC中的关键错误，并获得了奖金。</li></ul><h1 id="48eb" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">补救:</strong></h1><ul class=""><li id="2e67" class="lv lw iq jp b jq lj ju lk jy lx kc ly kg lz kk ma mb mc md bi translated">不要依赖依赖于浏览器的控件— <strong class="jp ir">不要依赖于客户端验证</strong>并存储在浏览器中。</li><li id="0971" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">当产品被添加到购物车中时，计算总请求的<strong class="jp ir"> md5和或任何哈希</strong>，并与后端进行比较，以便如果在请求中发生任何值的任何操作，它都不同于服务器的哈希。</li><li id="395d" class="lv lw iq jp b jq mx ju my jy mz kc na kg nb kk ma mb mc md bi translated">验证<strong class="jp ir">不正确字符</strong>和<strong class="jp ir">数据类型</strong>的输入。具体到这种情况，我们可以检查负范围的数量。保持范围从1到10，因为最大值已定义，我们可以定义最小值。始终定义应用程序将接受的最大值和最小值。</li></ul><h1 id="3cd2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">参考:</h1><p id="c6ab" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><a class="ae nf" href="https://www.owasp.org/index.php/Web_Parameter_Tampering" rel="noopener ugc nofollow" target="_blank">https://www.owasp.org/index.php/Web_Parameter_Tampering</a></p><p id="b95f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nf" href="https://www.cgisecurity.com/owasp/html/ch11s04.html" rel="noopener ugc nofollow" target="_blank">https://www.cgisecurity.com/owasp/html/ch11s04.html</a></p><p id="c529" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nf" href="https://hackerone.com/reports/403783" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/403783</a></p><p id="bfb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nf" href="https://medium.com/@chawdamrunal/what-is-parameter-tampering-5b1beb12c5ba" rel="noopener">https://medium . com/@ chawdamrunal/what-is-parameter-tampering-5b 12 C5 ba</a></p><p id="9931" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae nf" href="https://yassineaboukir.com/blog/price-manipulation-vulnerability-in-e-commerce-platforms/" rel="noopener ugc nofollow" target="_blank">https://yassineaboukir . com/blog/price-manipulation-vulnerability-in-e-commerce-platforms</a></p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><a href="https://www.buymeacoffee.com/justmorpheus"><div class="gh gi ng"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></a></figure></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="b275" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lr">关注</em> <a class="ae nf" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="lr"> Infosec报道</em> </a> <em class="lr">获取更多此类精彩报道。</em></p><div class="no np gp gr nq nr"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">信息安全报道</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">medium.com</p></div></div><div class="oa l"><div class="ob l oc od oe oa of mo nr"/></div></div></a></div></div></div>    
</body>
</html>