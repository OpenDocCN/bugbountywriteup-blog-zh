<html>
<head>
<title>Fundamentals of SIEM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SIEM的基础知识</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/fundamentals-of-siem-f42359500f1c?source=collection_archive---------0-----------------------#2021-08-11">https://infosecwriteups.com/fundamentals-of-siem-f42359500f1c?source=collection_archive---------0-----------------------#2021-08-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="24bb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这个博客是为那些对任何Siem工具感兴趣的人准备的。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0b5970b833bd7c9fb4e55f987b54bee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6wdswKwlmL1IGmCWjuV66w.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://www.wallarm.com/what/siem-whats-security-information-and-event-management-technology-part-1" rel="noopener ugc nofollow" target="_blank">https://www . wall arm . com/what/siem-whats-security-information-and-event-management-technology-part-1</a></figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="6c8d" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">什么是SIEM？</strong></p></blockquote><p id="819a" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">SIEM代表安全信息和事件管理。SIEM软件结合了安全信息管理(SIM)和安全事件管理(SEM ),可对网络硬件生成的日志和安全警报进行实时分析。在一个组织中，时不时会生成大量日志，SIEM工具可以简化这一过程，因为它具有关联、传输、解析、汇总、存储、警报等功能。SIEM软件为组织提供分析、响应、仪表板、日志修改、相关性、警报等功能。借助SIEM，我们可以创建规则，软件将根据这些规则匹配重复发生的事件。我们可以通过使用来自MITRE等资源的信息，由APT(高级持续威胁)组创建规则来防止高级威胁。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="25ea" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">西安工作</strong></p></blockquote><p id="2936" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">SIEM软件首先从各种来源收集日志，如网络、应用程序、安全设备、防病毒日志、连接到内部网络的其他设备等，然后对其进行分类。现在，开始创建规则，我们需要为特定的威胁创建规则。例如:有一个IP地址正在我们的一个子域上运行web漏洞扫描(使用OpenVas或任何其他扫描器),然后我们将创建一个规则来生成针对此类IP的警报，每当此类事件发生时，SIEM都会生成警报。通过使用SIEM，我们可以提高调查效率。</p><p id="36da" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">日志收集有两种方式:</p><ol class=""><li id="3f15" class="mg mh iq lj b lk ll ln lo md mi me mj mf mk mc ml mm mn mo bi translated">日志代理</li><li id="46d9" class="mg mh iq lj b lk mp ln mq md mr me ms mf mt mc ml mm mn mo bi translated">无代理</li></ol><blockquote class="ld le lf"><p id="f6bd" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">日志代理</strong></p></blockquote><p id="b379" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">简而言之，日志代理是安装在需要收集日志的所有节点上的软件。这些软件具有解析、日志旋转、缓冲、加密等功能。我们将提前学习这些术语。在发送到目的地之前，可以在这里修改日志。例如:如果有一个帐户登录日志的“用户名”=“迈克”；" password" = "172#prod@123 "那么我们可以把它分成两部分，转发为-&gt;</p><p id="0f50" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">信息1:“用户名”=“迈克”</p><p id="f40d" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">信息2:“密码”=“1723 prod @ 123”</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/a02596d5708e06fe75661ffd92d1b93d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dCbjpLxxIY6ie_1ZHpKplA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae kv" href="https://nxlog.co/" rel="noopener ugc nofollow" target="_blank">https://nxlog.co/</a></figcaption></figure><p id="771f" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated"><strong class="lj ir"> Syslog </strong> - &gt; Syslog是一种传输日志的网络协议。TLS可用于加密日志。如果我们想用syslog传输日志，那么我们需要用syslog格式解析它。</p><p id="132b" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">理想的系统日志格式:</p><p id="cb4e" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">时间戳-源设备-设施-严重性-消息编号-消息文本</p><blockquote class="ld le lf"><p id="0fb0" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">无代理</strong></p></blockquote><p id="70c4" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">无代理日志发送过程是指客户端不希望安装任何软件来收集日志并通过SSH发送日志。使用这种方法，我们需要提供登录凭证，这是很危险的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/589c7c067c493a491444801f2e5fb457.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e3w8Tc6LTx1QkerLfQDBSg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated"><a class="ae kv" href="https://nxlog.co/" rel="noopener ugc nofollow" target="_blank">https://nxlog.co/</a></figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="0dff" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">日志解析</strong></p></blockquote><p id="813e" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">日志解析是SIEM用来从原始日志中提取数据元素的一个非常重要的工具。解析使我们能够关联来自各种来源的数据，以进行事件分析。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/253ac762ed294df3149815efb54afb66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qJi7l-Tk2Ir8sELbRDnfpg.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">【https://slideplayer.com/slide/13707343/ T4】</figcaption></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="082f" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">日志聚合</strong></p></blockquote><p id="3532" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">日志聚合是将所有生成的日志发送到的地方。在这里，我们可以根据要发送到目的地的内容来修改日志。例如:如果有一个从web服务器生成的日志，其中包含用户代理、文件、方法等的所有细节，而我们只需要发送代码(404、200等)，那么我们可以解析它，并只将所需的部分发送到目的地。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="8b7f" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">日志聚合器流程</strong></p></blockquote><p id="f2c3" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">在将日志发送到最终目的地之前，需要对日志进行处理。通过3种方式处理日志:</p><ol class=""><li id="2c47" class="mg mh iq lj b lk ll ln lo md mi me mj mf mk mc ml mm mn mo bi translated">从语法上分析</li><li id="3b0d" class="mg mh iq lj b lk mp ln mq md mr me ms mf mt mc ml mm mn mo bi translated">丰富:可以在调查的时候达到更高的效率。例如:我们可以添加地理位置，因为我们从日志中知道IP地址。</li><li id="dd1e" class="mg mh iq lj b lk mp ln mq md mr me ms mf mt mc ml mm mn mo bi translated">过滤:有时需要在将日志发送到目的地之前对其进行修改或过滤。可能会有一些错误，比如:假设日志的时间格式不正确，那么我们可以做的就是以正确的格式修改它。</li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="1750" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir"> EPS </strong></p></blockquote><p id="7593" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">EPS是每秒事件数。EPS与聚集和存储成正比。如果EPS很高，那么聚合和存储也会很高。现在，如果EPS很高，就好像每个日志只使用一个聚合器，那么我们需要多个聚合器，这会使聚合器负载过大。这个过程称为扩展聚合器。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="7a6b" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">日志的存储</strong></p></blockquote><p id="a503" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">一旦日志到达目的地，它们需要被存储，并且我们需要巨大的存储空间来存储日志。存储空间应该足够大，而且要高效。为了提高效率，访问数据的速度应该非常快。</p><p id="5a8d" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">我们也可以使用一写多读(worm)技术，因为我们已经完成了上面的修改部分。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="edd1" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">警报</strong></p></blockquote><p id="b274" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">现在，我们已经成功处理并存储了日志，我们需要创建规则来检测网络、设备和网页上的异常活动。假设今天创建了一个日志，那么我们需要在严格的时间范围内发出警报。如果我们在2-3天后才收到警报，那又有什么意义呢？没什么！因此，快速索引功能是必须的。</p><p id="3a09" class="pw-post-body-paragraph lg lh iq lj b lk ll jr lm ln lo ju lp md lr ls lt me lv lw lx mf lz ma mb mc ij bi translated">创建触发警报的规则的示例:</p><ol class=""><li id="c912" class="mg mh iq lj b lk ll ln lo md mi me mj mf mk mc ml mm mn mo bi translated">假设，有一个新用户在主管理员中添加了高级权限。</li><li id="be25" class="mg mh iq lj b lk mp ln mq md mr me ms mf mt mc ml mm mn mo bi translated">假设，有一个登录网页，有人重复点击重置密码一样15次。</li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="f7a0" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><strong class="lj ir">技巧</strong></p></blockquote><ol class=""><li id="ab37" class="mg mh iq lj b lk ll ln lo md mi me mj mf mk mc ml mm mn mo bi translated">黑名单:在这项技术中，我们创建了一个所有可能的恶意情况的列表。例子-&gt;我们可以使用开源工具收集并记下所有恶意的进程。如果日志中记录了该进程，将会触发一个警报。我们还可以创建一个所有被禁IP的列表。</li><li id="3024" class="mg mh iq lj b lk mp ln mq md mr me ms mf mt mc ml mm mn mo bi translated">白名单:在这种技术中，我们创建了一个所有可能的正常情况的列表，其中不应该有警报。但是我们需要定期更新这个列表。</li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld le lf"><p id="ed46" class="lg lh li lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb mc ij bi translated"><em class="iq">感谢阅读。如果你觉得有用，欢迎在评论中提问并分享这篇文章。</em></p></blockquote></div></div>    
</body>
</html>