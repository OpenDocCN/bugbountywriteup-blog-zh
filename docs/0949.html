<html>
<head>
<title>Evading Filters to perform the Arbitrary URL Redirection Attack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">避开过滤器执行任意URL重定向攻击</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/evading-filters-to-perform-the-arbitrary-url-redirection-attack-cce628b9b6a0?source=collection_archive---------2-----------------------#2020-11-12">https://infosecwriteups.com/evading-filters-to-perform-the-arbitrary-url-redirection-attack-cce628b9b6a0?source=collection_archive---------2-----------------------#2020-11-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d78cfc92f247f383208b89886059442a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ln6w9W8N_7sE797rOyWDCw.png"/></div></div></figure><p id="5803" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任意URL重定向攻击通常被称为开放重定向攻击，这是一种常见的web漏洞，允许攻击者将受害用户重定向到攻击者控制的域。这种攻击可以用来窃取令牌等敏感信息，执行社会工程和其他攻击。</p><p id="b1f0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任意URL重定向攻击大多发生在应用程序接受用户提供的URL并在执行易受攻击的功能时将其重定向的端点。一些常见的参数有<strong class="ka ir">？return=，？returnURI=，？转发给=，？重定向=，？redirectURI=，？url=，？forward= </strong>和其他类似参数，这些参数似乎将用户加载或重定向到另一个端点。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><blockquote class="ld"><p id="5bb1" class="le lf iq bd lg lh li lj lk ll lm kv dk translated">【如果你喜欢读我的文章，请在推特上关注:<a class="ae lo" href="https://www.twitter.com/harshbothra_" rel="noopener ugc nofollow" target="_blank"><strong class="ak"><em class="ln">【https://www.twitter.com/harshbothra_】</em></strong></a></p></blockquote></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="6478" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，各位黑客和Bug赏金猎人，在这篇文章中，我将分享我最近的一个发现，我能够通过规避过滤器来执行任意URL重定向攻击。</p><p id="53e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，现代框架实现安全检查来验证和避免开放重定向攻击。通常，各种过滤器，如验证是否使用了第三方URL或IP，验证是否使用了<strong class="ka ir"> HTTPS:// </strong>协议，如果找到，应用程序会阻止重定向的发生。</p><p id="9f59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最近，我在测试一个叫做<strong class="ka ir">target.com的私人应用时遇到了类似的情况。</strong>在检查我的应用程序安全清单中的各种漏洞时，我正在寻找下一个<strong class="ka ir"> URL重定向</strong>。</p><p id="7ae2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我测试这种攻击的一般方法如下:</p><h1 id="eff5" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak">方法— 1: </strong></h1><ol class=""><li id="7332" class="mn mo iq ka b kb mp kf mq kj mr kn ms kr mt kv mu mv mw mx bi translated">登录应用程序并导航至任何认证页面，如<strong class="ka ir">我的个人资料。</strong></li><li id="1f43" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">网址一般是这样的:<a class="ae lo" href="https://www.target.com/my-profile/" rel="noopener ugc nofollow" target="_blank">https://www.target.com/my-profile/T21</a></li><li id="a199" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">现在，从应用程序中注销，通常一些应用程序抛出一个重定向参数，该参数重定向到<strong class="ka ir"> /my-profile </strong>页面。</li><li id="2068" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">网址如下:<a class="ae lo" href="https://www.target.com/login?forward=/my-profile" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://www.target.com/login?forward=/my-profile</strong></a></li><li id="f92f" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">现在，在这种情况下，<strong class="ka ir">转发</strong>参数是测试<strong class="ka ir">任意URL重定向攻击的潜在攻击媒介。</strong></li></ol><h1 id="3629" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak">方法— 2: </strong></h1><ol class=""><li id="df84" class="mn mo iq ka b kb mp kf mq kj mr kn ms kr mt kv mu mv mw mx bi translated">使用参数枚举工具，如<strong class="ka ir"> ParamSpider &amp; Arjun </strong></li><li id="7b9f" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">测试可疑参数对抗<strong class="ka ir">任意URL重定向攻击。</strong></li></ol><h1 id="5b1d" class="lp lq iq bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated"><strong class="ak">方法— 3: </strong></h1><ol class=""><li id="e0a9" class="mn mo iq ka b kb mp kf mq kj mr kn ms kr mt kv mu mv mw mx bi translated">在目标应用程序上运行<strong class="ka ir"> gau &amp; waybackurls </strong>并将它们保存到一个文件中。</li><li id="6fb4" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">对步骤1保存的文件运行<strong class="ka ir">打开重定向GF模式</strong>，并将输出保存到另一个文件。</li><li id="ab44" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv mu mv mw mx bi translated">这些URL是<strong class="ka ir">任意URL重定向攻击的可疑和潜在端点。</strong></li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="de65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这种情况下，对于我正在测试的应用程序，我使用了<strong class="ka ir">方法— 1 </strong>，并且我发现了以下开放重定向的潜在端点:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="5b0f" class="nm lq iq ni b gy nn no l np nq"><a class="ae lo" href="https://www.target.com/login?forward=/account/address" rel="noopener ugc nofollow" target="_blank"><strong class="ni ir"><em class="nr">https://www.target.com/login?forward=/account/address</em></strong></a></span></pre><p id="ac8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，<strong class="ka ir">转发</strong>参数正在验证是否提供了<strong class="ka ir">URL</strong>并阻止重定向发生。经过进一步调查，我了解到:</p><ul class=""><li id="8c27" class="mn mo iq ka b kb kc kf kg kj ns kn nt kr nu kv nv mv mw mx bi translated">应用程序正在过滤<strong class="ka ir"> HTTPS </strong>协议。</li><li id="0225" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv nv mv mw mx bi translated">应用程序正在过滤<strong class="ka ir">主机&amp;的IP地址。</strong></li></ul><p id="10a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，应用程序允许使用<strong class="ka ir"> HTTP </strong>协议。想了一会儿，我用下面的有效载荷作为旁路:</p><p id="b926" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lo" href="http://2899905732" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">http://2899905732</strong></a>:2899905732是<strong class="ka ir"> google.com的</strong>IP:<strong class="ka ir"/>142.250.64.100的整数IP表示</p><p id="0e20" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最终的有效载荷如下所示:</p><pre class="nd ne nf ng gt nh ni nj nk aw nl bi"><span id="9758" class="nm lq iq ni b gy nn no l np nq"><a class="ae lo" href="https://www.target.com/login?forward=/account/address" rel="noopener ugc nofollow" target="_blank"><strong class="ni ir"><em class="nr">https://www.target.com/login?forward=</em></strong></a><a class="ae lo" href="http://2899905732" rel="noopener ugc nofollow" target="_blank"><strong class="ni ir">http://2899905732</strong></a></span></pre><p id="f961" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我导航到上面的URL并用有效的凭证登录。登录后，应用程序重定向到<strong class="ka ir">google.com</strong>，导致成功的<strong class="ka ir">任意URL重定向攻击。</strong></p><figure class="nd ne nf ng gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><h1 id="c443" class="lp lq iq bd lr ls ny lu lv lw nz ly lz ma oa mc md me ob mg mh mi oc mk ml mm bi translated">外卖食品</h1><ul class=""><li id="8d8e" class="mn mo iq ka b kb mp kf mq kj mr kn ms kr mt kv nv mv mw mx bi translated">尝试所有可能的方法来查看每一个漏洞。</li><li id="20eb" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv nv mv mw mx bi translated">如果某个东西不起作用或被阻塞，尝试寻找可能的替代方案。</li><li id="edf5" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv nv mv mw mx bi translated">尝试所有可能的方法来逃避过滤器获得成功。</li><li id="bcd0" class="mn mo iq ka b kb my kf mz kj na kn nb kr nc kv nv mv mw mx bi translated">一路学习，处处应用你的知识。</li></ul></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="fe24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢阅读文章<strong class="ka ir">，请鼓掌并关注<em class="nr">媒体和推特:</em> </strong></p><p id="cfab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="nr">推特:</em></strong><a class="ae lo" href="https://www.twitter.com/harshbothra_" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nr">https://www.twitter.com/harshbothra_</em></strong></a></p><p id="49e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="nr">领英:</em></strong><a class="ae lo" href="https://www.linkedin.com/in/harshbothra" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nr">https://www.linkedin.com/in/harshbothra</em></strong></a></p><p id="80dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="nr"> 网站: </em> </strong> <a class="ae lo" href="https://harshbothra.tech/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="nr"> https://harshbothra.tech </em> </strong> </a></p><p id="6488" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="nr"> Talks: </em> </strong> <a class="ae lo" href="https://www.youtube.com/playlist?list=PLYn5_MxRvV-fxPL90I-uebXQzQBXfIaY0" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="nr"> WEB //www.youtube.com/playlistlist=PLYn5_MxRvV-fxPL90I-uebXQzQBXfIaY0 </em> </strong> </a></p><p id="bd72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"><em class="nr">幻灯片:</em></strong><a class="ae lo" href="https://speakerdeck.com/harshbothra" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nr">【HTTPS://speakerdeck.com/harshbothra </em></strong></a></p></div></div>    
</body>
</html>