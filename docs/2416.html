<html>
<head>
<title>Credential Stuffing Attack: Countermeasures using Patterns and Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">凭证填充攻击:使用模式和机器学习的对策</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/credential-stuffing-attack-countermeasures-using-patterns-and-machine-learning-4b356d6cb741?source=collection_archive---------1-----------------------#2022-10-03">https://infosecwriteups.com/credential-stuffing-attack-countermeasures-using-patterns-and-machine-learning-4b356d6cb741?source=collection_archive---------1-----------------------#2022-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c02d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">摘要</strong>—“<em class="kl">凭据填充攻击”是针对门户网站发起的一种鲜为人知但却非常成功的网络攻击。它利用了人类重复使用密码以方便记忆的行为以及防御技术中的弱点。不良行为者获得从网站泄露的用户凭证，并在不同的网站上尝试相同的凭证集，以进一步访问用户的数据。门户网站部署的传统防御机制无法抵御这种攻击，因为它是一种非常安静、缓慢且规避基于签名的规则的攻击。大多数中小型门户网站发现很难检测到攻击。由于抵御这种攻击的商业服务非常昂贵且难以调整，用户的敏感数据会被泄露。本文提出了一种基于模式和机器学习的方法，该方法易于部署，是一种有效的解决方案，可用于自动检测和防范这种攻击。</em></p><ol class=""><li id="bfcc" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated"><strong class="jp ir">简介:</strong>凭证填充是一种网络攻击，其中不良行为者获得从在线门户(网站、移动应用)泄露的大量认证凭证(用户名/电子邮件ID和与之相关的密码)的数据库。如(展示1)所示，泄露的凭据会针对多个其他在线门户进行尝试，以获得对用户数据的进一步访问</li></ol><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/8038d4829860d6fc16bf8aa2e8d17c82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hFuPyNTEfTPkOYtQZ4WsCg.jpeg"/></div></div></figure><p id="4818" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(证据1)</p><p id="c894" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如今，有效的黑客不仅瞄准技术，他们还瞄准“人类”，因为人类是安全链中最薄弱的一环。</p><p id="0701" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">人类行为的可预测性使我们容易受到社会工程攻击和像凭据填充这样的攻击。</p><p id="ea15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。为什么这种攻击是在线门户的一个大问题？</strong></p><p id="ddeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">I .如果在线门户网站的许多用户的帐户使用凭据填充技术遭到破坏，这是门户网站的声誉损失。</p><p id="c707" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">二。在一些在线门户网站上，用户付费订阅有限数量的内容，即视频/图像/文档。如果他们的帐户受到凭据填充攻击，攻击者可以用尽他们的使用配额。</p><p id="b6b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">三。缓解技术不太成功。</p><p id="cff7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">四。防止这种攻击的商业软件/服务过于昂贵，并且不提供透明和完整的解决方案。</p><p id="b1e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据研究参考1，这种攻击非常成功，因为超过70%的用户重复使用他们的密码。</p><p id="4bdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，下面提到的传统<strong class="jp ir">缓解策略</strong>对这种攻击不起作用。</p><p id="a062" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)教育用户不要重复使用他们的密码</p><p id="3d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)验证码挑战</p><p id="c936" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)对IP地址进行速率控制检查</p><p id="fdf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)对失败的密码尝试进行速率控制检查</p><p id="cb5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e)多因素认证</p><p id="6e83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">f)阻止自动请求的不良机器人检测系统</p><p id="dbdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">g)欺诈防范系统</p><p id="4f85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。传统缓解策略的弱点</strong></p><p id="f4d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1 </strong> <strong class="jp ir">教育用户不要重复使用他们的密码:</strong></p><p id="da66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这从未成功过，因为人类在选择密码时面临两个挑战:</p><p id="15ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)人类无法记住复杂的密码，所以他们选择简单的密码。但是这使得它们容易受到密码猜测攻击。许多用户意识活动和技术控制在世界范围内被用来教育用户选择一个困难且不容易被猜到的密码。</p><p id="f822" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)当用户选择一个复杂的密码时，他/她希望重复使用它，因为很难记住这么多困难的密码。这有助于用户抵御密码猜测攻击，但使他们容易受到凭据填充攻击。</p><p id="45fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)使用密码管理器是一个很好的选择，但是人们对它的了解非常有限。很少有门户网站支持与密码管理器集成。</p><p id="b9f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1 </strong> <strong class="jp ir">对IP地址进行速率控制检查:</strong></p><p id="d777" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着当来自一个IP地址的登录请求数(通过或失败)超过一个定义的阈值时，该IP地址将被阻止。</p><p id="d394" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">这种方法的问题</strong> —在今天的场景中，随着每个/一些请求改变IP地址是如此容易。频繁更改IP地址的攻击者永远不会被检测到。</p><p id="8826" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.2 </strong> <strong class="jp ir">对失败密码尝试的速率控制检查:</strong></p><p id="7cc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着如果用户多次密码尝试失败，将采取预防措施。</p><p id="1103" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">这种方法的问题</strong> —当攻击者试图对一个用户使用如此多的密码时，这是一个很好的密码猜测攻击解决方案，但对于“凭据填充攻击”来说，这是一个糟糕的解决方案，因为攻击者只尝试了一个密码(在与特定用户名相关的数据泄露中泄露)。</p><p id="291b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.3 </strong> <strong class="jp ir">验证码挑战:</strong></p><p id="a36a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CAPTCHA(区分计算机和人类的全自动公共图灵测试)是一种挑战-响应测试，用于计算中确定用户是否是人类。</p><p id="7383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">挑战- </strong></p><p id="2018" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用验证码来防止此类攻击的一些挑战包括:</p><p id="b18e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)糟糕的用户体验:人类讨厌图像/音频识别挑战</p><p id="5458" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)使用验证码农场和先进的人工智能，网络罪犯甚至可以绕过最好的验证码解决方案</p><p id="ff47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)为高级验证码解决方案定义正确的阈值是一项非常困难的任务</p><p id="ffea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)监控假阳性和假阴性可能会很有挑战性且耗时。</p><p id="a87e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">3.4</strong>T24】多因素认证:</p><p id="3176" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着除了密码之外，用户还需要提供额外的验证信息才能成功登录，例如电子邮件/手机号码上的一次性密码、硬件设备上的一次性密码、安全问题等。</p><p id="71f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">挑战- </strong></p><p id="2ae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这确实是防止“凭证填充攻击”的好选择，但是存在一些问题，即</p><p id="4eb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)对于许多用户来说，每次用户尝试登录时发送OTP是一种糟糕的体验，甚至大多数银行网站都不支持它。</p><p id="fd53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)仅当存在可疑登录时才启用多因素身份认证是好的，但是大多数中小型组织没有识别可疑登录的机制。</p><p id="8ae1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年的一项研究显示，只有10%的Gmail用户选择了多因素身份认证参考2。</p><p id="29da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)根据一项参考研究，只有26%的网站支持多因素身份认证3。</p><p id="672e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.1 </strong> <strong class="jp ir"> Web应用防火墙&amp;不良Bot防范解决方案</strong></p><p id="5275" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太贵了！</p><p id="2e77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种解决方案可以提供一种解决方案来识别登录请求是通过使用浏览器的人还是通过自动化脚本来进行的。</p><p id="44ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">挑战- </strong></p><p id="6a50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种解决方案的挑战是-</p><p id="7309" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">A)此类解决方案无法查看用户登录模式的历史数据，即，如果用户主要从国家A登录，而在短时间内从国家B登录，则不存在此类地理国家异常的规则。</p><p id="63c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)这种解决方案在检测到请求是通过自动脚本发出时，可能会通过阻止IP和ISP来阻止后续请求，但是没有提供保护已经受损的用户的解决方案。</p><p id="18f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)调整假阳性也是一项麻烦的任务。</p><p id="c4b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)此外，高级机器人可以绕过机器人检测系统</p><p id="7330" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3.2 </strong> <strong class="jp ir">防欺诈系统</strong></p><p id="56c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太贵了！</p><p id="50d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种解决方案代表了与不良Bot缓解解决方案相反的方法。</p><p id="1bc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们拥有用户登录模式的历史数据，并根据多个行为异常标准计算每个登录事件的风险。</p><p id="529d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，如果用户从印度登录，并且在短时间内从国外登录，这种异常将被检测到，并进一步采取预防措施，即锁定帐户或自动发送电子邮件通知。</p><p id="5ca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然这是一个很好的方法来保护用户在一个关键的网络应用，即银行或门户网站时，订阅被支付和滥用。</p><p id="d34c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">挑战- </strong></p><p id="e491" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种解决方案不是为了通过阻止IP或ISP来进一步阻止攻击。</p><p id="7e92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。推荐的缓解算法</strong></p><p id="9d13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">针对此攻击的<strong class="jp ir">预防策略</strong>应该是:</p><p id="0a24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)处理所有不同类型的攻击执行</p><p id="6fbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)对用户的干扰较小</p><p id="f4ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)成本效益，以便中小型在线门户可以使用它</p><p id="5b1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)易于实施</p><p id="1958" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e)当攻击发生时，向利益相关者发送通知</p><p id="0cd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">f)提供自动缓解</p><p id="be0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，将讨论一个算法，将满足上述标准</p><p id="5089" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">先决条件:</strong>将下述与每个登录事件(通过或失败)相关的信息存储在一个表中:</p><p id="2b09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a) IP地址</p><p id="ff40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b) ISP(互联网服务提供商)</p><p id="ecc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c) ASN(自治系统号)</p><p id="be79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)触发登录请求的国家</p><p id="6ab3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e)用户名</p><p id="4303" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.1方法:</strong></p><p id="18e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要维护的登录事件的四个表:</p><p id="6561" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表1将根据收到登录请求的唯一用户名的数量来存储排名靠前的IP。脚本将每隔“n”分钟运行一次，并更新这些数据。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/dd7df3c48e54534d519b8bcda4b555f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*kV8tn16oXiixDtiJixLo5w.png"/></div></figure><p id="c0bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表2将根据收到登录请求的唯一用户名的数量来存储排名靠前的ISP。脚本将每隔“n”分钟运行一次，并更新这些数据。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi li"><img src="../Images/e84d33d8ab499b925c38fb0a93fdd00b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*XMqprPK0vkWjEO2p8VDhhw.png"/></div></figure><p id="91cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ASN:自治系统编号</p><p id="f2a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表3将根据收到登录请求的唯一用户名的数量存储排名靠前的外国ISP(fisp)。如果门户网站在A国注册，则A国以外的所有ISP都被称为外国ISP。脚本将每隔“n”分钟运行一次，并更新这些数据。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/c0f396780fb7f36cd3c18274bd13141b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*cnqMneg1YJuk6HI2nDPASw.png"/></div></figure><p id="d731" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">表4将存储一天的地理异常情况的数量。脚本将每隔“n”分钟运行一次，并更新这些数据。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/d49630f4b585137bd16426b4dc64c693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/1*w8OV5zLfvF32PE6ZH3j7cw.png"/></div></figure><p id="9400" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自一个IP地址的唯一用户名的最大登录请求，称为<strong class="jp ir">“IP数据”</strong></p><p id="790a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自一个ISP的唯一用户名的最大登录请求，称为<strong class="jp ir">“ISP数据”</strong></p><p id="a0ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自一个(外国ISP) *的唯一用户名的最大登录请求，称为<strong class="jp ir">“FISP数据”</strong></p><p id="6ea9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(地理国家异常)*案例总数，称为<strong class="jp ir">“地理数据”</strong></p><p id="4b40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl"> *(geo country anomaly是一个术语，当用户从A国登录并在短时间内从b国登录时使用。在每个网站上，对于真实场景中的一些用户，存在geo country异常，因为很少有用户从本地IP地址登录，然后使用VPN连接进行匿名。)</em></p><p id="1d0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl"> *(国外ISP)表示每个在线门户都应该为每个国家的用户维护一个单独的登录事件表。如果A国的用户A从B国的ISP登录，它将被视为外国ISP。</em></p><p id="4532" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4.2用于异常检测的机器学习算法</strong>将分别应用于IP数据、ISP数据、FISP数据、地理数据。</p><p id="2577" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">异常检测是一种用于识别数据集中罕见事件的技术。这些罕见的事件在统计学上不同于其他数据。这将用于检测异常值，并识别攻击者的IP、ISP、外国IP或一天内的地理异常情况。</p><p id="b315" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个无监督的异常检测算法将在这个解决方案中应用。无监督异常检测方法不需要训练数据，其工作原理是非常小百分比的数据不同于其余数据，并且是异常值。</p><p id="50b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为IP数据找到的异常IP的唯一用户名的值将被称为IPt (IP阈值)</p><p id="ea6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">针对ISP数据发现的离群值ISP的唯一用户名的值将被称为ISPt (ISP阈值)</p><p id="54f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在FISP数据中发现的异常值外国ISP的唯一用户名的值将被称为FISPt (FISP阈值)</p><p id="d1ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">地理异常案例数据中发现的异常值数量将被称为地理位置异常阈值。</p><p id="9ce1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在运行该机器学习算法几天之后，确定了一个事实，即一天中每个网站上的用户数量每天都在变化，但是这种变化通常并不显著，因此可以找到模式并且可以形成阈值。</p><p id="62f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于这些阈值，我们将尝试解决两个问题:</p><p id="3c68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)减轻凭证填充攻击</p><p id="7904" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)保护攻击者已经登录的用户</p><p id="f85b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实时防止凭证填充攻击</strong></p><p id="6b3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个自动化脚本(用任何服务器端编程语言编写)将在下面提到的流程中每5分钟分析一次登录事件表的数据:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ll"><img src="../Images/5f5d3c2d542f78c737464a817837f40d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o0KItwI8XwpEXoBPLoMxOQ.jpeg"/></div></div></figure><p id="7502" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(证据2)</p><p id="35e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用该方法分析不同类型的凭证填充攻击。</p><p id="2881" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.1一个IP多用户登录点击量</strong>:</p><p id="cc3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，来自一个IP地址的最大登录命中阈值将被突破。</p><p id="df8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以通过将系统与任何基于主机的防火墙或网络防火墙集成来自动阻止攻击者的IP，并且可以将被阻止的IP保存在数据库表中。</p><p id="6967" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.2拥有多个IP但同一ISP的多个用户的登录点击量</strong>:</p><p id="7059" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，来自ISP的最大登录点击数的阈值将被突破。</p><p id="cafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将系统与任何基于主机的防火墙或网络防火墙集成，攻击者ISP可以被自动阻止，并且被阻止的ISP可以被保存在数据库表中。</p><p id="b95e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">建议在这种模式中排除常见的电信ISP，因为攻击者很难在电信ISP内部切换IP。他们使用VPN或云服务提供商ISP来切换IP。</p><p id="d5b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.3具有多个IP、多个ISP的多个用户的登录点击量</strong>:</p><p id="6654" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，攻击者使用多个外国ISP，包括VPN和云提供商。</p><p id="c3e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，外国ISP的阈值总是小于ISP的总阈值，即，在样本数据集上形成的阈值中，来自ISP的最大命中是6450，但对于外国ISP，如附件2所示，阈值是3070。</p><p id="11ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将系统与任何基于主机的防火墙或网络防火墙集成，攻击者ISP可以被自动阻止，并且被阻止的ISP可以被保存在数据库表中。</p><p id="d29f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.4最大规模攻击:</strong></p><p id="2bf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击者可以如此频繁地更换全球的ISP，以至于外国ISP的阈值可能无法突破。</p><p id="86f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是在这种情况下，将会有许多用户发生地理国家异常，并且地理位置异常情况的阈值将被突破。</p><p id="587b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个组织在检测到此类攻击后的预防措施可能会有所不同，例如，组织可以暂时自动阻止一些国家/地区的流量，或者加强身份验证并引入MFA。</p><p id="6a0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.4保护攻击者已经成功登录的用户</strong></p><p id="59dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于网站上的每个登录事件，都会在一个表中保留一个条目，该表应该类似于表2:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/eda4c1835f3adae42a9faba1156d5003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*ni61b8fQxsLOB7qR_oboxA.png"/></div></figure><p id="db42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自动化脚本将每隔“n”分钟运行一次，分析过去“n”分钟的登录事件表行，并根据行为异常因素计算风险分值:</p><p id="c785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基本分数= 0</p><p id="fc4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">a)如果用户从未从发起该登录请求的国家/地区登录，则得分=得分+50</p><p id="a202" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)如果用户从未从发起该登录请求的ISP登录，则得分=得分+50</p><p id="8caa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)如果该登录请求是成功的，并且是通过突破了当天的IP阈值(如上所述)的IP发出的，则得分=得分+50</p><p id="78a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)如果该登录请求成功，并且是通过当天突破ISP阈值(如上所述)的ISP发出的，则得分=得分+50</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/908a9781e814c814039ec684b09e5a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*er98uv52yHEn-Bn2ghkXEg.jpeg"/></div></figure><p id="74e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(证据3)</p><p id="0b61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果总分等于/大于100，可以对用户帐户采取纠正措施，下面提到了一些纠正措施:</p><p id="dd0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">A)可以向用户发送关于可疑登录事件的通信电子邮件以及更改密码的建议</p><p id="8e4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">b)用户的密码已过期；注销所有活动会话，并向用户发送有关该活动的通信电子邮件</p><p id="dff4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">c)注销所有活动会话后，启用多因素身份认证</p><p id="773b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">d)在有限的时间内锁定账户。</p><p id="7d18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">e)通知信息安全团队进行人工干预</p><p id="2819" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5.5追溯行动:</strong></p><p id="cf56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个IP只有在一天内超过IPt(IP阈值)时才会被阻止。一旦一个IP被阻止，一个自动脚本应该对从该IP记录登录请求的所有用户采取预防措施。</p><p id="215e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ISP仅在一天内违反ISPt/FISPt(ISP或外国ISP阈值)时被阻止。一旦一个IP被阻止，一个自动脚本应该对从该IP记录登录请求的所有用户采取预防措施。</p><p id="4103" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 6。结论:</strong></p><p id="0536" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">传统方法和建议方法的比较:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lo"><img src="../Images/3a3ce449c14832888ff54e1981626875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ryejHk3OGZ4aaBPfe8mANg.png"/></div></div></figure><p id="0c0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(证据4)</p><p id="57b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该系统将结合多重检查，并在很大程度上防止凭证填充攻击。</p><p id="51f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，将对已经受损的用户帐户采取自动纠正措施。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><h2 id="5942" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae mp" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>