<html>
<head>
<title>Everything you need to know about clickjacking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于点击劫持你需要知道的一切</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/everything-you-need-to-know-about-clickjacking-a522b188f2fe?source=collection_archive---------0-----------------------#2022-02-09">https://infosecwriteups.com/everything-you-need-to-know-about-clickjacking-a522b188f2fe?source=collection_archive---------0-----------------------#2022-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8f98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如何利用点击劫持以及如何防止点击劫持的完整指南。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><a href="https://securityboulevard.com/2019/08/clickjacking-attacks-what-they-are-and-how-to-prevent-them/"><div class="gh gi kl"><img src="../Images/72fa2cd145b80d48a6bdfa5b33949ef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P7YRJ7eal9NlzNgVE-qzvA.png"/></div></a></figure><p id="17c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。</p><p id="b25c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我最近发现了一个容易被点击劫持的网站，我想写一篇关于它的文章可能是个好主意。</p><p id="9036" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们系好安全带出发吧！</p><h1 id="1392" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">1) Iframe标签</h1><p id="9e47" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在进入点击劫持之前，我们需要理解什么是iframe标签。</p><p id="987d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看下面的代码。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="11c8" class="mb ku iq lx b gy mc md l me mf">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;body&gt;<br/>&lt;iframe src="<a class="ae mg" href="https://www.w3schools.com" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com</a>"&gt;&lt;/iframe&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="a7bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这段代码可以在这里找到:<a class="ae mg" href="https://www.w3schools.com/tags/tag_iframe.ASP" rel="noopener ugc nofollow" target="_blank"> HTML iframe标签(w3schools.com)</a>。</p><p id="b072" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的代码非常简单。</p><p id="6339" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">iframe标签所做的只是在你的页面中包含另一个页面。</p><p id="f8d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看代码的结果。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/fedfba81f26b1271c5c0d1fa466a3bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xV2uUa1fBVBPGtCfu2M3YA.png"/></div></div></figure><p id="52f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所见，w3站点已经包含在页面中。</p><p id="ed9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单对吗？有了iframe标签，你可以在你的页面中包含其他网站，太棒了！(可能吧)。</p><h1 id="e71f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">2)一个基本的点击劫持漏洞</h1><p id="61b0" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">那么，iframe标签的问题是什么呢？</p><p id="464b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主要问题是iframe可能隐藏在某些东西后面。</p><p id="25ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你现在可能很困惑，但是不要担心，实际上这比你想象的要简单得多。</p><p id="4778" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将使用Portswigger实验室来演示攻击。</p><p id="e9a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【portswigger.net T2实验室:使用CSRF令牌保护的基本点击劫持|网络安全学院】</p></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><p id="e053" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用给定的凭据登录应用程序。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi gj"><img src="../Images/08336fb3ff583f76444029af6726de07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7-JXnfhbRqT35cfpakNAwA.png"/></div></div></figure><p id="3719" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们转到帐户操作，我们可以删除我们的帐户。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mt"><img src="../Images/236f98c1010e24b820b64fbf81b95e04.png" data-original-src="https://miro.medium.com/v2/resize:fit:338/format:webp/1*gS2yzieLfqvnD-dO2PEmpQ.png"/></div></div></figure><p id="4450" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么我们现在能做什么呢？</p><p id="a397" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果页面容易被点击劫持，我们可以隐藏iframe，说服用户在他不知道的情况下点击我们在页面中添加的另一个按钮(或单词)。</p><p id="1178" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你要做的就是把下面的代码交给受害者。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="e66a" class="mb ku iq lx b gy mc md l me mf">&lt;!DOCTYPE html&gt;<br/>&lt;html&gt;<br/>&lt;body&gt;<br/>&lt;style&gt;<br/>   iframe {<br/>       position:relative;<br/>       width:500px;<br/>       height: 700px;<br/>       opacity: 0.0001;<br/>       z-index: 2;<br/>   }<br/>   div {<br/>       position:absolute;<br/>       top:320px;<br/>       left:60px<br/>       z-index: 1;<br/>   }<br/>&lt;/style&gt;<br/>&lt;div&gt;Test me&lt;/div&gt;<br/>&lt;iframe src="Your_URL"&gt;&lt;/iframe&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="2f8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是代码的结果。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/7848a39b537cf9c0243da6303fac4bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*l3vcunLqGL9GLtZOiS9DcQ.png"/></div></figure><p id="41e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，上面的代码确保了编写的<strong class="jp ir">测试我</strong>文本<strong class="jp ir"> </strong>在iframe页面的删除按钮上准确对齐。</p><p id="b6da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以从CSS参数中看到，iframe具有非常低的不透明度，因此它对用户来说是不可见的。z-index标签将确保Portswigger页面位于Test me的顶部。</p><p id="b0df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多关于z-index <a class="ae mg" href="https://www.freecodecamp.org/news/z-index-in-css-what-it-is-and-what-it-does/#:~:text=Z%20Index%20(%20z%2Dindex%20),%2C%20or%20position%3Afixed%20)." rel="noopener ugc nofollow" target="_blank">的信息请点击</a>。</p><h1 id="8e98" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">3)针对点击劫持的防御机制</h1><p id="78ef" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">减轻点击劫持漏洞有几种方法，我将从最不可靠到最安全的方法开始写。</p><ol class=""><li id="d936" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk na nb nc nd bi translated">框架破坏。</li></ol><p id="27cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">框架破坏，这是一种客户端技术，使用JavaScript来避免您的页面被框架到另一个页面中。</p><p id="cbf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像几乎所有的客户端技术一样，使用iframe标签的沙箱属性可以很容易地绕过它，例如，使用允许标签执行JavaScript代码的allow-script参数，从而绕过保护机制。</p><p id="4f99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想练习一下，你可以找到Portswigger实验室。</p><p id="dfee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。</strong> X-Frame选项。</p><p id="4c33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">X-Frame选项是一种服务器端技术，可以使用X-Frame头减轻点击劫持。<br/>这个头可以在一个HTTP请求中配置3个参数。</p><ul class=""><li id="97cf" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk ne nb nc nd bi translated">否认。</li></ul><p id="7860" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个iframe都将被阻塞。</p><ul class=""><li id="e865" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk ne nb nc nd bi translated">同源。</li></ul><p id="9a5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Iframe是允许的，但是只能嵌入到页面上与自身具有相同原点的框架中(例如，如果<a class="ae mg" href="http://example.com" rel="noopener ugc nofollow" target="_blank">http://example.com</a>只请求自身的iframe，它将被允许使用它)。</p><ul class=""><li id="7b5b" class="mv mw iq jp b jq jr ju jv jy mx kc my kg mz kk ne nb nc nd bi translated">允许从。</li></ul><p id="bd86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">列入白名单的网站可以使用iframe。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="48e5" class="mb ku iq lx b gy mc md l me mf">X-Frame-Options: deny<br/>X-Frame-Options: sameorigin<br/>X-Frame-Options: allow-from http://example.com</span></pre><p id="e619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使它是一种优秀的技术，但现在它已被弃用，取而代之的是CSP。</p><p id="e1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。</strong> CSP。</p><p id="8748" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CSP代表内容安全策略，是一种由网站实施的防御机制，用于防止点击劫持和其他客户端攻击，如XSS。</p><p id="7810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它通常在web服务器中作为返回头来实现。</p><p id="bed1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用frame-ancestors参数进行clickjacking，并使用none选项(相当于拒绝X-Frame)、self as sameorigin和允许嵌入网页的网站名称。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="886e" class="mb ku iq lx b gy mc md l me mf">Content-Security-Policy: frame-ancestors 'none'<br/>Content-Security-Policy: frame-ancestors 'self'<br/>Content-Security-Policy: frame-ancestors http://example.com</span></pre><p id="00d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mg" href="https://portswigger.net/web-security/cross-site-scripting/content-security-policy" rel="noopener ugc nofollow" target="_blank">CSP上更多</a>。</p><h1 id="01f2" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">最后的想法。</h1><p id="9442" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在结束之前，我想对这个漏洞的报告做一个说明。</p><p id="eb1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使页面可以包含在iframe中，也不意味着它本身就是一个漏洞。</p><p id="fc6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，点击劫持只能在例如页面中出现表单或XSS漏洞时被利用。</p><p id="7e4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，伙计们，谢谢你们走到最后。</p><p id="541d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一篇文章再见。</p><p id="9316" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再见。</p></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><h1 id="30b5" class="kt ku iq bd kv kw nf ky kz la ng lc ld le nh lg lh li ni lk ll lm nj lo lp lq bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae mg" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nk nl gp gr nm nn"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">iwcon.live</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob kr nn"/></div></div></a></div></div></div>    
</body>
</html>