<html>
<head>
<title>Account takeover through password reset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过密码重置接管帐户</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/account-takeover-through-password-reset-82adc0c19248?source=collection_archive---------0-----------------------#2020-11-14">https://infosecwriteups.com/account-takeover-through-password-reset-82adc0c19248?source=collection_archive---------0-----------------------#2020-11-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8a74a52e7f90c2947c0485dca29f29fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adiep-5hFenpOZ2UfI09hg.jpeg"/></div></div></figure></div><div class="ab cl kb kc hx kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="im in io ip iq"><p id="1cf8" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">大家好，</p><p id="f75c" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我是<strong class="kk iu">奥马尔·哈姆迪</strong> <strong class="kk iu">【海员】</strong>，今天我将解释我在<strong class="kk iu"> Bugcrowd </strong>的私人程序中发现的最酷的bug之一</p><p id="1307" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我们开始吧，</p><p id="2182" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我有一个私人程序，姑且称之为<strong class="kk iu">redacted.com</strong>，经过一段时间的侦察程序，我开始检查密码重置功能，通常我寻找漏洞一样(ATO，主机头注入)</p><p id="6e0f" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">简单地说，当用户想要重置他的密码时，他输入他的名和姓以及电子邮件。密码重置链接将发送到他的电子邮件中。</p><p id="4093" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我请求重设我的账户密码，然后拦截了这个请求(通过<strong class="kk iu"> Zap代理</strong>)并仔细检查。</p><p id="3fc0" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我发现请求是这样的:</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/320a052a2880c3edd9a029ae45dbc531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kIyKXuOBaMUjeY6IxketOA.jpeg"/></div></div></figure><p id="3423" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">密码重置链接是:</p><p id="0c28" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated"><strong class="kk iu">https://redacted.com/Reset?token=04294876770750</strong></p><p id="01ad" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">到目前为止没有什么令人兴奋的，我使用了链接，更改了我的密码并拦截了请求，在这里我发现了一些非常有趣的事情。</p><p id="5f0b" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">我发现请求是这样的:</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5596da7460035d664669c6a6e1915027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FKkJCfsmNEeYq7OU8z7b3A.jpeg"/></div></div></figure><p id="1da2" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">如果查看这个请求，您会发现用于重置密码的令牌，它与用户请求重置其密码时发送的现有令牌相同</p><p id="4015" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">从这里，我可以通过更改受害者的密码来接管我想要的任何帐户</p><p id="5289" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated"><strong class="kk iu">再现</strong>的步骤:</p><p id="6973" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">1-请求重置受害者帐户的密码，并用Burpsuite阻止该请求。</p><p id="3424" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">2-您将找到用于重置受害者密码的令牌。</p><p id="059e" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">3-为您的帐户请求密码重置，然后使用密码重置链接，更改您的密码并通过Burpsuite拦截请求。</p><p id="66fd" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">4-您会发现请求如下:</p><figure class="lg lh li lj gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/5596da7460035d664669c6a6e1915027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FKkJCfsmNEeYq7OU8z7b3A.jpeg"/></div></div></figure><p id="3b20" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">5-将您的令牌替换为受害者的令牌，受害者的密码将被成功更改。</p></div><div class="ab cl kb kc hx kd" role="separator"><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg kh"/><span class="ke bw bk kf kg"/></div><div class="im in io ip iq"><p id="62ce" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">当我向该公司报告该漏洞时，他们降低了从P2到P3的风险，因为我需要知道受害者的名字和姓氏，但随着进一步的研究，我发现我只需要知道受害者的电子邮件，如果我输入的名字和姓氏不正确，我仍然可以获得受害者的令牌。</p><p id="9b36" class="pw-post-body-paragraph ki kj it kk b kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf im bi translated">在twitter @seaman00o上关注我</p></div></div>    
</body>
</html>