<html>
<head>
<title>P1 Vulnerability: How I chained Logical-Error to Account-Takeover Vulnerability 😈🧑‍💻that No-One said you before😁</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">P1漏洞:我如何将逻辑错误与帐户接管漏洞联系起来😈🧑‍💻以前没人说过你😁</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/p1-vulnerability-how-i-chained-logical-error-to-account-takeover-vulnerability-that-no-one-59aa88a9cae8?source=collection_archive---------0-----------------------#2022-01-10">https://infosecwriteups.com/p1-vulnerability-how-i-chained-logical-error-to-account-takeover-vulnerability-that-no-one-59aa88a9cae8?source=collection_archive---------0-----------------------#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="2dd4" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">*导言*</h1><p id="0f52" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">你好黑客们，我是Gowtham，一个来自印度的道德黑客和渗透测试者，他喜欢寻找漏洞😁。由于许多因素，我给了我的第二个博客一个巨大的空白！我真诚地向大家道歉。所以今天，我要告诉你，我是如何利用Web应用程序本身的逻辑错误获得帐户接管漏洞的。我到现在还没有报告这个bug，所以出于某种原因，我不想公开这个网站的名称，姑且称之为“Example.com”。让我们开始学习吧🔥</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><blockquote class="lq lr ls"><p id="aacd" class="kl km lt kn b ko lu kq kr ks lv ku kv lw lx ky kz ly lz lc ld ma mb lg lh li ij bi translated"><strong class="kn ir"> <em class="iq">当逻辑失败时，攻击者会成功:</em> </strong></p></blockquote><p id="b614" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">虽然这个网站没有太多的功能，但我总是首先查找“绕过登录”漏洞。所以我从重置密码功能开始，请求如下所示👇</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/a5da8d9a3a69b551afda24a343250962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fd5suRPRjR7pEFbU7o-8fg.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">忘记密码的请求</figcaption></figure><p id="a420" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">答案是:</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ms"><img src="../Images/78338a94b661a4e129e7a99b35004f73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kW61Cw0dD-m-MkqyoWVAnQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">对上述要求的回应</figcaption></figure><p id="f613" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">一切都会好的，直到我们把参数“status”改成:“fail”。甚至在改变参数时，它发送OTP到注册的移动电话号码，但是这允许我们暴力破解OTP[无速率限制漏洞]。</p><p id="66b5" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">“逻辑错误导致无速率限制”</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><blockquote class="lq lr ls"><p id="e09b" class="kl km lt kn b ko lu kq kr ks lv ku kv lw lx ky kz ly lz lc ld ma mb lg lh li ij bi translated">我如何设法绕过只工作一次的OTP😈</p></blockquote><p id="ee3e" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">修改值后，用户将获得一个OTP[它实际上通知用户]到他/她的手机号码。所以我输入了一些随机的OTP，这样我就可以暴力破解正确的OTP。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mt"><img src="../Images/6dd3be8b3fd7bc7ceb4731534809ef07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ap8eJnkaJn-IA-OPSSwWKQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">对随机输入的OTP的响应。</figcaption></figure><p id="9e70" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">您可能认为可以将该值更改为“status”:“success”来绕过OTP，但这是行不通的，因为验证是在服务器端进行的。现在我唯一的选择就是为检察官办公室而战，我做到了。</p><ul class=""><li id="e502" class="mu mv iq kn b ko lu ks lv kw mw la mx le my li mz na nb nc bi translated">正确的动态口令给出的长度是575，而所有其他动态口令给出的长度是574。</li></ul><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nd"><img src="../Images/29417705eb43a3af9974821af0fd55c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5oo8dX_Q7dRUUNsqUFQ1tA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">正确动态口令的响应</figcaption></figure><p id="0163" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">获得OTP后，我立即修改了值，并在之前的请求中输入了正确的OTP。</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/8939e09367aefa3cff034d78ff887f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VD5j1hqQTbV0cP2Utn770A.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">使用正确的动态口令请求</figcaption></figure><p id="d5a5" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">现在你仍然可以看到，我们得到“状态”:“错误”，因为正如我所说的，它在两端进行检查，服务器端以及客户端。</p><ul class=""><li id="83da" class="mu mv iq kn b ko lu ks lv kw mw la mx le my li mz na nb nc bi translated">我们的代码在暴力破解过程中已经被验证过了，所以现在正如你所预料的，我们可以将值改为“success”来绕过客户端的OTP。</li></ul><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nf"><img src="../Images/8391718185b142424e87d7ad92493fb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bwo6uzKNd3s6L4mGEuZlHA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">我将值更改为Success，它绕过了OTP验证。</figcaption></figure><p id="768d" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">现在我可以为任何用户更改密码了！！😁我可以登录任何用户账户，也就是账户接管漏洞</p><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ng"><img src="../Images/e65196fbaac5de90f0c370747e2c8595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fGTGTvC61pMO8J5vI6a8sQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">可以能够改变任何用户的密码。</figcaption></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nh"><img src="../Images/f5647d6bdfa7f3d4b2eef0a6e90bccd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EhybBstNEFrouZE1-LN_tA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">泄露一些关键数据，如地址、电话号码、姓名以及一些银行信息。</figcaption></figure></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><blockquote class="lq lr ls"><p id="f0f8" class="kl km lt kn b ko lu kq kr ks lv ku kv lw lx ky kz ly lz lc ld ma mb lg lh li ij bi translated">结尾注释😣</p></blockquote><p id="ef94" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">我向每一个觉得这个博客像是一个演练/报告的人道歉。我试图详细解释每件事，这就是粘贴所有截图的原因。我向你保证，我每周至少会写一篇博客😅。让我们一起学习，一起成长。</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><blockquote class="lq lr ls"><p id="f157" class="kl km lt kn b ko lu kq kr ks lv ku kv lw lx ky kz ly lz lc ld ma mb lg lh li ij bi translated">如果你在学习中遇到任何问题，或者对我的博客有任何疑问，请随时联系我😁❤️</p></blockquote><p id="6ac9" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">您可以关注我:</p><p id="cf27" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">https://www.twitter.com/gowtham_ponnana的❤️:</p><p id="0cad" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">https://www.instagram.com/gowtham_ponnana的❤️:</p><p id="19a2" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">gowtham.official45@gmail.com❤️</p><p id="d529" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">[注意]:我真诚地建议人们加入我们的Discord社区，了解更多关于网络安全的东西。</p><p id="165b" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">不和:<a class="ae ni" href="https://discord.gg/gY35nHX7gu" rel="noopener ugc nofollow" target="_blank">https://discord.gg/gY35nHX7gu</a></p><figure class="md me mf mg gt mh"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="6571" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">感谢和问候，</p><p id="5d62" class="pw-post-body-paragraph kl km iq kn b ko lu kq kr ks lv ku kv kw lx ky kz la lz lc ld le mb lg lh li ij bi translated">戈塔姆·奈杜·蓬纳纳</p></div></div>    
</body>
</html>