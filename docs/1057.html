<html>
<head>
<title>Tryhackme Cold Box -Easy walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tryhackme冷箱-简单演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-cold-box-easy-walkthrough-7181ab3f8b96?source=collection_archive---------0-----------------------#2021-01-08">https://infosecwriteups.com/tryhackme-cold-box-easy-walkthrough-7181ab3f8b96?source=collection_archive---------0-----------------------#2021-01-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f3dc383339caae40a1bd6adeb30d3dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7ejcCzF38bG0RyUXFHmQ2w.jpeg"/></div></div></figure><p id="7cfd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">玩家你好，在这篇博客里，我们要解决的是tryhackme给出的<a class="ae kw" href="https://tryhackme.com/room/colddboxeasy" rel="noopener ugc nofollow" target="_blank">冷箱易</a>实验室。为了解决这个问题，我们将遵循通常的方法..</p><ol class=""><li id="ce05" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">情报收集</li><li id="6cc6" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">扫描和计数</li><li id="1e12" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">剥削</li><li id="2def" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">权限提升</li><li id="510a" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">用户和根标志</li></ol><p id="0d79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你不擅长博客，请观看下面的视频</p><figure class="ll lm ln lo gt jr"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="8aad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">部署机器并获取IP地址。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/cdbec1af30147da3948cadd65e8e2e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2y8nAr_Sf_isStv3zRLK7Q.png"/></div></div></figure><h2 id="7b11" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">情报收集</h2><p id="ab2e" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">让我们使用以下命令开始Nmap扫描</p><blockquote class="mq mr ms"><p id="83f2" class="jy jz mt ka b kb kc kd ke kf kg kh ki mu kk kl km mv ko kp kq mw ks kt ku kv ij bi translated">T4国家地图<ip address=""/></p></blockquote><p id="47fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用此命令，我们得到一个输出，表明TCP层中只有一个端口是打开的，即HTTP — 80</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/051a4f7f7ae0e99ca4342da12e602e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eChEmzuR7mpyevH072TJ5Q.png"/></div></div></figure><p id="bb34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在发现http端口被打开后，我进一步枚举，发现有一个word press blog正在这台机器上运行</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5895ce42aa33aac88ed3e4385311b537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*XwcmYoOH5g5KBMJWFM2DYQ.png"/></div></figure><p id="3de7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我检查了wp-admin面板的登录页面，得到了WordPress博客的登录入口</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/299429b471f25f631e4b64605c3d3892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*zK-_FxtC0QH2okFvV_5hPg.png"/></div></figure><p id="fb56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我检查了wp-admin面板的登录页面，得到了WordPress博客的登录入口</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/299429b471f25f631e4b64605c3d3892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*zK-_FxtC0QH2okFvV_5hPg.png"/></div></figure><h2 id="9b7c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">扫描和计数</h2><p id="c6b5" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">接下来我有一个想法来列举用户的凭证，为此我们有一个很棒的工具叫做wp-scan，下面的命令是用来列举用户的</p><blockquote class="mq mr ms"><p id="75a0" class="jy jz mt ka b kb kc kd ke kf kg kh ki mu kk kl km mv ko kp kq mw ks kt ku kv ij bi translated">WP-scan–URL<a class="ae kw" href="http://IP%20Address" rel="noopener ugc nofollow" target="_blank">http://IP地址</a>–enumerate u</p></blockquote><p id="bba0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该命令将枚举登录门户中的所有用户。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/ca4f90d21aac73e5ce7e02f93e569e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*_GPa6AnkUnp15V4EyU9pJA.png"/></div></figure><p id="5e1c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一段时间后，扫描完成并给出了4个有效用户的结果</p><p id="6370" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">查看结果后，我确认用户是c0ldd，因为机器名称也是cold，因此作为提示，我在登录门户中使用了该用户名，并再次确认用户是有效的，但门户抛出了错误</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/889110f0e456a14bb779fd83b1d35f3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*vZXu5JKwb1R07Moo8PNFEA.png"/></div></figure><p id="ade7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">查看结果后，我确认用户是c0ldd，因为机器名称也是cold，因此作为提示，我在登录门户中使用了该用户名，并再次确认用户是有效的，但门户抛出了错误</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/83529dfcf26c1d3b6b8de2fe0f67ea09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLihsr-crncrYqCnuMcnAQ.png"/></div></div></figure><p id="318f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很好，我们找到了用户，现在我将使用一个名为rockyou.txt的常用通行列表来强行打开这个登录门户，我在这里使用的工具是same wp-scan，下面的命令用于枚举提到的用户的密码</p><blockquote class="mq mr ms"><p id="7e11" class="jy jz mt ka b kb kc kd ke kf kg kh ki mu kk kl km mv ko kp kq mw ks kt ku kv ij bi translated">WP-scan–URL<a class="ae kw" href="http://ipaddress/wp-login.php" rel="noopener ugc nofollow" target="_blank">http://IP address/WP-log in . PHP</a>—密码&lt;密码文件&gt; —用户名&lt;用户名&gt;</p></blockquote><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f5b766c0c15643aa85d37771be243585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*-qW0YoaMZrrXazfWmv1jkw.png"/></div></figure><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/864c5bc06e4bbd4a0416c190ac482991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBNlGPpzIe9uJU0nPRGQBg.png"/></div></div></figure><p id="f47a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后用这个我登录了WordPress仪表盘</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/4b66219a6a62663d6ff2751db117ba81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*wPsLOtedPN0pXnHUEAGX7w.png"/></div></figure><h2 id="4e61" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">剥削</h2><p id="5cae" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">在WordPress pentesting中，我们知道，如果我们能够改变主题编辑器代码，那么我们就能够很容易地获得反向外壳，所以我也做了同样的事情，用我的php反向外壳代码编辑了404.php页面，并更新了404.php页面。想了解更多关于WordPress pentesting的信息，请访问<a class="ae kw" href="https://www.hackingarticles.in/wpscanwordpress-pentesting-framework/" rel="noopener ugc nofollow" target="_blank">黑客文章</a>博客</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/b0b32ce32c7798e70c8973d3fba7d9fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MYcaHbjpqGzFIhfIJ4O9Fw.png"/></div></div></figure><p id="5c6d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后在成功更新之后，我启动了我的网猫监听器</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/589d6ef17004a59473c2ee57b7be6801.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*IBLR6crBTUDEPhAR2r1FBg.png"/></div></figure><p id="bd51" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我在浏览器中访问该页面，并从web服务器获得一个反向连接</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e8023b5438e573d39caa9d353dc0f153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*geH7hJSR5OX8LnduVY88pQ.png"/></div></figure><p id="d951" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们成功地获得了www-data用户的外壳</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b71875853b1c696232215c83b79ca89c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*tzarPhHHNYQGhnOjvJamnA.png"/></div></figure><p id="3a4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">经过这一步，我认为我很容易得到用户标志，但不幸的是，我可以得到，因为机器说，许可被拒绝的www-data用户</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3c2bf4cb62aa943796c08ceef880bf95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*bTOd51-1icjCAx3bs4TEPw.png"/></div></figure><p id="9666" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们的下一步是枚举内部配置文件，并需要获得任何用户的凭证，所以我最终确定这是WordPress应用程序，所以它有一个wp-config。包含一些基本信息的php文件，有时文件中硬编码了密码。所以我枚举了这个文件并找到了用户c0ldd的密码</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/1b6c6c066f841b6f896bb112a2381d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*68_NxNzdgeL4bvTG9Akukw.png"/></div></figure><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/984d811290f180026a7f18db3376f458.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x4HhCczxV-FgzMKQv-7MwQ.png"/></div></div></figure><p id="0d5d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我找到了DB凭证，所以我尝试使用su命令将这些凭证切换到用户c0ldd，并且我成功地以c0ldd用户的身份登录</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/9391cf96ee4c62a188f3ccfe6bb03697.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*Lc_AxcOr_AufcXf4Qx05dw.png"/></div></figure><p id="18d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们需要获取用户标志，但是我不会在这里显示用户标志。但是您现在可以查看用户标志，没有任何问题</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/58a17a4c917eb6354812c7981f199f1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*oZNvx7VqGVKvvwhHxbzWPw.png"/></div></figure><h2 id="284e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">权限提升</h2><p id="bf7a" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">现在，我们需要将我们的权限提升到root，以获得root用户标志</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/f8b5f776f982c938960c12c5966bf5bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Fh_ZEchv2RED3mOlJCe6mA.png"/></div></figure><p id="ede0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">太好了，我们发现vim能够以root权限运行，所以我们将访问我们最喜欢的网站，名为<a class="ae kw" href="https://gtfobins.github.io/#" rel="noopener ugc nofollow" target="_blank"> GTFOBIN </a>,在那里我找到了一个以sudo root身份运行vim的命令</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/32979c057d1345400cf292aaae6cdc00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*1Oo4QlHt9zmCLpRpi-jU3Q.png"/></div></figure><p id="339b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这个命令，我升级为root并获得了一个root标志</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/0e15e4238594b0590ebc8697e8843c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:526/format:webp/1*26Llw3ybYVxFOwQ0rhJofQ.png"/></div></figure><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/059a3465df1a4a1c3493bd4f4e506e78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*FXUFy5yIhip7eBV7hFgGOQ.png"/></div></figure><p id="260b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">就这些了…享受快乐的黑客生涯吧！！！</p></div></div>    
</body>
</html>