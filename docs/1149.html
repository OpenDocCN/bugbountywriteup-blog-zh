<html>
<head>
<title>How I was able to bypass the subscription plan of a famous regional e-paper web application by response manipulation.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何通过响应操作绕过一个著名的区域性电子报纸web应用程序的订阅计划的。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-was-able-to-bypass-the-subscription-plan-of-a-famous-regional-e-paper-web-application-by-b14bb5d82c5f?source=collection_archive---------0-----------------------#2021-03-08">https://infosecwriteups.com/how-i-was-able-to-bypass-the-subscription-plan-of-a-famous-regional-e-paper-web-application-by-b14bb5d82c5f?source=collection_archive---------0-----------------------#2021-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7a30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我妻子正在找一份教师的工作。一天，她告诉我，她每周四都需要这份报纸，因为上面刊登了很多就业机会。她让我从办公室回来时把报纸带来。但这让我很头疼，因为在那些日子里，我通常都是晚上9点以后才离开办公室。我妻子认为我工作负担很重(这是我告诉她的)。但实际上晚上7点以后，我们在工作的时候玩纸牌。所以我认为访问他们的电子文件而不是购买硬拷贝会很好。当检查他们的网站时，我可以发现他们已经开始了订阅计划，我们需要付费。幸运的是，有7天免费试用，我很快就注册了。试用期不允许我们浏览旧内容。所以如果我需要特定日期的内容(例如去年)，我应该付费订阅。所以我决定测试这个应用程序，主要有三个原因</p><ul class=""><li id="1ca6" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我想给我妻子留下深刻印象(是的，这是真的，我告诉她我可以用HTML黑掉NASA，她相信了):|</li><li id="e106" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我不想为了买这份报纸而提前离开办公室，放弃游戏和乐趣</li><li id="4255" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我对这份地区性新闻报纸的安全实现很好奇。</li></ul><p id="4c7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以7天后，我开始收到一个错误，说我的订阅期结束了。我可以很容易地使用另一个电子邮件地址注册，然后再使用7天。但我对此不感兴趣，因为它不允许我访问旧的内容。</p><p id="9846" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，我开始检查网络流量。该应用程序是使用ASP.NET网络框架构建的。我注意到，每次尝试加载电子报纸的任何页面时，应用程序都会发送一个请求来检查我的订阅计划和我的身份验证cookie。我把这个请求转发给了打嗝中继器，以便进一步调查。请求如下</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/c348e1dc1db7070b17bcfa15dce80373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeXzQU1oOINk8RiK_YO6Sg.png"/></div></div></figure><p id="8e52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我的试用期已经结束，对上述请求的回应是</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ll"><img src="../Images/2989ef9d292680e0e86c396fffc44cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DesQW0rCn658rA0Jm-CMVw.png"/></div></div></figure><p id="3954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我收到这个回复时，我收到了一个错误，上面写着“你的试用期已经结束”。但是你可能已经注意到了回答中的重要部分。是的，响应中有一个状态字段，其值为“false”。因此，我再次尝试访问另一个页面，请求被转发到burp，这一次我选中了拦截该请求响应的选项。当在burp中收到响应时，我将状态值更改为“Yes ”,并将其转发给浏览器。</p><p id="e4d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不出所料，我绕过了他们的验证，电子纸被加载了。一旦收到验证请求的“真”状态，应用程序就向另一个端点发送请求，该端点将加载内容。有一个选项可以选择电子纸的日期、版本和页码。更改任何该值都将伴随一个验证请求。所以我在burp suite里写了一个规则，这样每一个内容为<em class="lm"> " </em> <strong class="jp ir"> <em class="lm"> {"Usertype":2，" Status":false，" message ":"你的试用期结束了\u003ca" </em> </strong>将被替换为{ <strong class="jp ir"> <em class="lm"> "Usertype":2，" Status":true，" message ":"你的试用期结束了\u003ca。</em> </strong>这样我就可以不受订阅和日期的限制访问内容了。</p><p id="a89d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们没有漏洞奖励计划，但我决定向他们的客户支持报告这个问题。但是他们还没有修复它，也没有在第一次确认后回复。</p></div></div>    
</body>
</html>