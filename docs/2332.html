<html>
<head>
<title>Mass Hunting CVE’s Part-1👀🔥</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大规模狩猎CVE的第一部分👀🔥</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/mass-hunting-cves-part-1-1e162ba6028b?source=collection_archive---------0-----------------------#2022-08-31">https://infosecwriteups.com/mass-hunting-cves-part-1-1e162ba6028b?source=collection_archive---------0-----------------------#2022-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e97e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">VE是“常见漏洞和暴露”的缩写，是公开披露的计算机安全缺陷的列表。CVE编号唯一地标识列表中的一个漏洞。</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/ba0df4f7db9a2b1987d70c8183c561e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*DqqZXU16fKbTWIpN"/></div></figure><p id="cca5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步是找到你想猎杀的CVE！我们将以<a class="ae lc" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-37042" rel="noopener ugc nofollow" target="_blank">CVE-2022–37042</a>为例。下一步是找到一些shodan/fofa呆子，利用他们我们可以找到多个易受这个特定CVE攻击的IP。你可以创造你自己的呆子，或者谷歌一下。很多研究人员也为同样的事情发帖子。在我们的案例中，它将是:</p><blockquote class="ld le lf"><p id="901d" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated"><strong class="jp ir">Shodan-query</strong>:<strong class="jp ir">http . favicon . hash:" 1624375939 " 200</strong></p><p id="22a3" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi"><strong class="jp ir">fofa-query : app=”zimbra-邮件系统”</strong></p></blockquote><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lk"><img src="../Images/00aa909a67f8772f0fbd083ce46b4aa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g3ZemkVkoWR4oaANUuWv8A.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">从Shodan找到79K个结果</figcaption></figure><p id="4ec5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是将这个呆子传递给<a class="ae lc" href="https://github.com/projectdiscovery/uncover" rel="noopener ugc nofollow" target="_blank">揭开</a>以获得所有域的列表。</p><blockquote class="ld le lf"><p id="234b" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated"><strong class="jp ir">命令:cat dorks . txt | uncover | tee-a final . txt</strong></p></blockquote><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lt"><img src="../Images/7d1f013ab963580a6fc57a278efe1c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1HETYA8vubG34Dpq0xDe2g.jpeg"/></div></div></figure><p id="3693" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在检查我们有多少个IP时，我们发现了以下结果:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lt"><img src="../Images/9cd7aa839220a51a9aa04d6b1f0ffdc2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oU4f5yNl5ZmbKU-Y6uubyA.jpeg"/></div></div></figure><p id="daa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只有200个来自uncover的结果，而我们从shodan找到了将近79k个IP。这是因为Shodan Api的限制。</p><p id="554b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，为了扩大我们的范围，我们想通过添加更多的过滤功能来修改我们的dork，以便通过uncover从shodan提取更多的IP。你也可以在uncover的配置文件中添加多个shodan API键。</p><p id="3f17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用国家参数修改了dork:</p><blockquote class="ld le lf"><p id="4a1f" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated"><strong class="jp ir">http . favicon . hash:" 1624375939 "国家:"美国"</strong></p></blockquote><p id="5dc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将创建一个这种呆子的小列表:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lu"><img src="../Images/d055c857d75b7a6f622d274fd7ceadc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u6RPSjmiDa7AHCPwo6WlMg.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">注意:您可以添加更多的呆子为更多的结果</figcaption></figure><p id="0a0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将通过这份呆瓜名单来揭开:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lv"><img src="../Images/93b4fbcde6f34564b917c7a682b696b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4F5XYwHwK8Arrp7AX9Oymg.png"/></div></div></figure><p id="8b05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看我们现在有多少个IP:</p><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lt"><img src="../Images/a0981537adf9bc8103b59294ee366ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NyXaq3nohePf3QY8MNYYng.jpeg"/></div></div></figure><p id="7264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在我们终于有了更多的IP。</p><p id="c4ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以用不同的参数创建你自己的呆子，用这种技术从shodan获得更多的结果，并在评论区与我们分享。</p><p id="ccc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，将IP列表传递给httpx，以找到启动并运行的IP。然后将其与模板名称一起提供给nuclei，以找到有效的模板。</p><blockquote class="ld le lf"><p id="7cb4" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated"><strong class="jp ir">命令:cat fin . txt | httpx—silent | nucleus-t../nucleus-templates/cves/2022/CVE-2022–1388 . YAML</strong></p></blockquote><figure class="kv kw kx ky gt kz gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lt"><img src="../Images/719d616ba39a6ecdfb954b9d8a511de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UXicUOiKnup-wV85HPrTmw.jpeg"/></div></div></figure><p id="0243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">整个过程可以用这个liner脚本来转换:</p><blockquote class="ld le lf"><p id="f884" class="jn jo lg jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">命令:cat dorks . txt | uncover—silent | httpx—silent | nucleus—t../nucleus-templates/cves</em></strong></p></blockquote><p id="288f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们希望这项技术可以帮助你大规模搜索CVE氏症，并找到许多脆弱的领域。</p><p id="9780" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">狩猎愉快！</p><p id="bb17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请继续关注我们的第二部分，将会分享一些更酷更有趣的大规模狩猎方法。</p><p id="161e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">作者:</strong></p><p id="6c1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">瓦伊巴夫·拉哈尼:</p><p id="8bac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lc" href="https://www.linkedin.com/in/vaibhav-lakhani" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vaibhav-lakhani</a></p><p id="4210" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://twitter.com/vlakhani28<a class="ae lc" href="https://twitter.com/vlakhani28" rel="noopener ugc nofollow" target="_blank"/></p><p id="a715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lc" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">迪尔帕尔马</a>:</p><p id="a77e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lc" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dhir-parmar-925b171a4</a>T8】https://twitter.com/dhirparmar</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="955c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lg">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae lc" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lg">加入我们的每周简讯</em> </strong> </a> <em class="lg">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>