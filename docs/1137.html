<html>
<head>
<title>Bragging Rights: Killing File Uploads softly</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">吹牛的权利:杀死文件上传软</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bragging-rights-killing-file-uploads-softly-fba35a4e485a?source=collection_archive---------0-----------------------#2021-02-28">https://infosecwriteups.com/bragging-rights-killing-file-uploads-softly-fba35a4e485a?source=collection_archive---------0-----------------------#2021-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/94f8f1ea129eb9d3711216604d62c558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M0b1d5L_5NHJcxhigdlo-A.jpeg"/></div></div></figure><p id="76fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，朋友们，我希望你们都做得很好，并且经常上网。我从一个月左右开始在Synack上做黑客，我必须说这是一个很棒的旅程。最近几天，我在文件上传功能上下了很多功夫，在这篇文章中，我将讨论一些最近的无限制文件上传的发现。我希望这能在某种程度上帮助你。让我们继续前进。</p><p id="8dde" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您对文件上传功能不熟悉或不熟悉，以下资源将帮助您更好地理解这一点:<a class="ae kw" href="https://portswigger.net/kb/issues/00500980_file-upload-functionality" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="kx">文件上传</em> </strong> </a> <strong class="ka ir"> <em class="kx">。</em>T9】</strong></p><p id="176d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，在一个周末，我想给一整天的时间来上传文件，并搜索了Synack上所有可以上传文件的程序。我得到了4-5个程序，并决定全部检查。在2个程序中，文件上传已经被报告了，所以我不能继续了。剩下的两个目标是相当新的，你可以称之为我的运气，因为没有人报告任何类似文件上传的事情。我开始玩这些功能，看看我们能不能用它做些奇怪的事情。这个网站只接受PDF，所以我试着用传统的方式用burp上传php文件，但是不行:(它不接受除PDF之外的任何东西。</p><p id="b0e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">旁路来了！感谢已经有的文章和博客。起初，我试图上传一个文件，把它的名字改成XSS的有效载荷。傻，没用。等等，如果我们可以使用一个带有PDF扩展名的SVG文件呢？这有用吗？如果我们继续向前，在扩展中添加一个空字节会怎么样？嗯，这实际上是可行的:)想看看完整的扩展吗？这是:</p><p id="ee25" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">提示。SVG%00.pdf </strong></p><p id="c643" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，应用程序接受文件，上传后，任何人都可以下载你上传的东西。他们一打开文件，XSS就出现了。这花了一些时间，但支付是值得的。</p><p id="4cb5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二种情况是非常相同的，我们可以上传我们的收据，管理员会批准它。我用了同样的方法，但不知何故它不起作用。我回到谷歌，搜索了更多可以绕过限制的资源。然而，我观察到，我们可以上传带有恶意内容的PDF接收，当有人打开报告时，有效负载就会执行。感谢<strong class="ka ir"> Payloadallthethings :) </strong>以下是全部内容:</p><p id="b066" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">% PDF-1.3<br/>% T1】1 0 obj<br/>&lt;&lt;/Pages 2 0 R/Type/Catalog&gt;&gt;<br/>endobj<br/>2 0 obj<br/>&lt;&lt;/Count 1/Kids【3 0 R】/Type/Pages&gt;&gt;<br/>endobj<br/>3 0 obj<br/>&lt;/AA<br/>&lt;&lt;/O【T10<br/>}<br/>)<br/>/S/JavaScript&gt;&gt;&gt;&gt;<br/>/Annots[]/Contents 4 0 R/media box[0 612 792]/Parent 2 0 R<br/>/Resources<br/>&lt;&lt;/Font&lt;&lt;/F1&lt;&lt;/base Font/Helvetica/Subtype/Type 1/Type/Font&gt;</p><p id="f5ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">BT<br/>/F1 24 Tf<br/>ET<br/>T30】endstream<br/>endobj<br/>xref<br/>0 5<br/>0000000000065535 f<br/>0000000015 000000n<br/>00000000062 00000n<br/>0000000117 00000n【T38</p><p id="5513" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><root>&lt;</root>&gt;<br/>start xref<br/>493<br/>% % EOF</p><p id="6c80" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">管理员一打开报告，就会看到一个弹出窗口。嗯，你需要检查受害者是否必须在他的系统上下载它，如果它发生了，它就没有意义。在我的例子中，它是在同一个目标的一个新选项卡上执行的，被认为是一个有效的bug。</p><figure class="kz la lb lc gt jr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/37214e166e1d5f5cccae0d189dd02185.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*3_ygClUHHP2DJOiXzvOAnQ.jpeg"/></div></figure><p id="4b85" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些并不是不可思议的发现，但多走几英里去换个角度思考总是有意义的。有时你知道如何利用这些东西，有时你不知道。谷歌来了，它会帮你做任何事情，帮你发现新事物。文件上传非常简单，只需要一种不同的方法。在它的帮助下，我仍然在寻找一个webshell:(然而，在找到这两个bug后，我感觉棒极了，我相信这篇小文章有助于你打造自己的方法。</p><p id="f178" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将是这一次，我希望你从这次阅读中有所收获。如果你喜欢它，你可以点击下面的拍手图标来感谢我:)建议一如既往地受到欢迎，如果你对奖金/黑客有任何问题/建议，我邀请你到我的twitter DM。我会尽力帮你的:)你可以用这个用户名找到我的twitter句柄:<strong class="ka ir"> @manasH4rsh。</strong></p><p id="872c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">保持好奇，保持饥渴！黑客快乐:)</p><p id="9661" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再见，❤</p></div></div>    
</body>
</html>