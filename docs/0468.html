<html>
<head>
<title>Payment Gateway Bypass of Zostel: India’s Biggest Hostel Chain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Zostel的支付网关旁路:印度最大的连锁旅店</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/payment-gateway-bypass-of-zostel-indias-biggest-hostel-chain-81c407454f0a?source=collection_archive---------1-----------------------#2020-01-04">https://infosecwriteups.com/payment-gateway-bypass-of-zostel-indias-biggest-hostel-chain-81c407454f0a?source=collection_archive---------1-----------------------#2020-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="1a06" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">最近我计划去印度进行我的个人旅行。在欧洲，找一个青年旅舍是很普遍的，但是我不确定印度的情况。搜索之后，我偶然发现了Zostel，这是印度和尼泊尔最大的连锁旅店。所以在预订之前，我在我的打嗝历史中找到一些付款请求。我立即重试同样的事情，并修改了价值，我能够绕过支付网关，免费预订我的宿舍。我立即在twitter上找到了CEO，因为他们现在还没有bugbounty计划，并报告了这个问题。</p></blockquote><h1 id="ccfa" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">描述:</h1><p id="1057" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">Web参数篡改攻击基于对客户机和服务器之间交换的参数的操纵，以便修改应用程序数据，例如用户凭证和权限、产品的价格和数量等。随着全球在线交易和电子商务的迅猛发展，针对在线支付系统安全性的攻击的数量和类型也在不断增加。因此，在使用网站为Zostel付款时，很容易绕过支付网关，无需支付任何费用即可预订酒店。</p><h1 id="0589" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">影响:</h1><p id="3df0" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">任何攻击者都可以在不支付任何在线费用的情况下预订旅馆房间，并且很容易提前预订所有房间，这将造成房间不足以及公司的财务损失。</p><h1 id="0306" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">复制步骤:</h1><p id="b2e4" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">1.访问网站。</p><p id="e6fa" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">2.选择您想要预订的任何日期。</p><p id="8a60" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">3.填写用户详细信息并完成页面。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi lv"><img src="../Images/b8c8705001c1e677f80504877ca146f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyBozKnyF8CkssIexZ5O8g.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">带有预付款选项的立即预订页面</figcaption></figure><p id="9c68" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">4.使用任何代理拦截POST请求，如burpsuite/owasp zap/paros代理，并将参数从1更改为0“pay _ flag = 0”</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ml"><img src="../Images/de6b3e133845afcb0c66be4dcbe7b905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBQr87J-2qNZL1XS7Wrclg.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">薪资标志操纵</figcaption></figure><p id="6d47" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">5.302以及成功预订页面，无需支付任何费用。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mm"><img src="../Images/153cb6ef6efe510c404507d3957a841e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_j9KcGNk_4p4_xa60CFetw.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">成功</figcaption></figure><h1 id="2172" class="kp kq iq bd kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">缓解措施:</h1><p id="ade4" class="pw-post-body-paragraph jq jr iq jt b ju ln jw jx jy lo ka kb lp lq ke kf lr ls ki kj lt lu km kn ko ij bi translated">必须从HTTP主体中删除价格变量。只需在HTTP标题中输入商品编号，从数据库中调出价格，并建立某种复查系统。</p><p id="a32c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">计算与价格参数和用户详细信息相关的所有请求的散列，以便没有操纵的机会。</p><p id="3444" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated">使用sha256等强大的哈希算法验证两端的哈希。</p><blockquote class="jn jo jp"><p id="477d" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我要感谢Zostel的Dharamveer先生和Gaurav先生承认了这个问题，并很快对其进行了修补。这是印度生态系统在网络安全方面的一个很好的例子。在30天内报告并解决问题。</p></blockquote></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="2067" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lp kd ke kf lr kh ki kj lt kl km kn ko ij bi translated"><em class="js">关注</em> <a class="ae mu" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="js"> Infosec报道</em> </a> <em class="js">获取更多此类精彩报道。</em></p><div class="mv mw gp gr mx my"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="mz ab fo"><div class="na ab nb cl cj nc"><h2 class="bd ir gy z fp nd fr fs ne fu fw ip bi translated">信息安全报道</h2><div class="nf l"><h3 class="bd b gy z fp nd fr fs ne fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="ng l"><p class="bd b dl z fp nd fr fs ne fu fw dk translated">medium.com</p></div></div><div class="nh l"><div class="ni l nj nk nl nh nm mf my"/></div></div></a></div></div></div>    
</body>
</html>