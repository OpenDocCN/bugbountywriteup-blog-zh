# 第三方应用程序甚至在访问过期后仍在获取你的私人脸书数据。

> 原文：<https://infosecwriteups.com/third-party-apps-were-still-getting-your-private-facebook-data-even-after-their-access-expiry-6e4be4880e6e?source=collection_archive---------0----------------------->

…

![](img/cb5a8ac500c041a8ee93269a75bbf7f8.png)

> 你好，我是来自尼泊尔的 Samip Aryal，这篇文章是关于我在脸书漏洞奖励计划中的第二份有效漏洞报告。
> 
> **我发现第三方应用程序的访问权限(通过‘登录脸书’功能获得)没有正确过期(即使在 90 天不活动之后)；当查找给定用户的朋友时。具体来说，如果目标用户的应用程序访问权限已经过期，但源用户没有过期，脸书仍然会将目标用户的数据返回给第三方应用程序。**

***把它理解清楚；让我们来看看这一弱点的完整故事。***

…

大约一年前；当我随意浏览一款名为“Smule”的应用程序(用户可以在这里做 karaokes)时，我打开了应用程序内的“脸书朋友”部分，那里显示了我的朋友列表，他们也在使用该应用程序，并通过“脸书登录”功能提供了从他们的脸书帐户到第三方应用程序(即 Smule)的所需访问权限(电子邮件、朋友列表数据)。

所以，当我看着我朋友的名字时；我得到了我最近的一个叫普拉贝什的朋友的资料；那里。我点击并打开他的 Smule 个人资料，看到他的最新二重唱是大约两年前的事了。此外，在此之前，他已经以一种连续的方式进行了几次二重奏。这意味着；在他发表的每个二重唱时期之间都有一个类似的微妙的间隙，但是在大约两年前从那个参照系中突然中断了。所以；最近一段时间，我没有在那个应用程序中看到他的任何互动。因此；我预计，由于超过 90 天的不活动，他的 Smule 帐户的脸书帐户访问可能已经过期。

突然之间，让我兴奋不已的是，一周前我们在脸书成了朋友。所以；我当时想:

![](img/531061e28a34cd1e3991855ef59c97bd.png)

因此，我迫不及待地让 Prabesh 去他脸书账户里的“[应用和网站](https://www.facebook.com/settings?tab=applications)安全设置”中的“[过期](https://www.facebook.com/settings?tab=applications&section=inactive)部分。他把截图发给了我:

![](img/4c51f58516b0c42062d6a18bd0fbe4a2.png)

看到这个之后；我当时想:

![](img/9d07f2112534a3e4cb9106fa74174238.png)

→你可能会问，' ***为什么……我的意思是；这些东西有什么好玩的？***

嗯，看截图最上面。在那里你可以清楚地看到这样一个标志:

> ***这些是你使用脸书登录过的应用和网站。他们可以接收您选择与他们共享的信息。已过期和已移除的应用程序仍可以访问以前与他们共享的信息，但他们不能接收额外的非公开信息。***

所以，这里你们中的一些人可能已经明白发生了什么可疑的事情。还是；让我用发生的事件的指示性流程来说清楚:

**用户 A > >通过“使用脸书登录”功能将其包括私人好友列表数据在内的数据访问权限授予第三方 app>>停止使用第三方 app > >超过 90 天第三方 app 访问权限过期>>>>现在，它不应该从用户 a 的脸书账户> >获取任何新的私人数据。然后，用户 a 与用户 B > >用户 b 成为好友**

…

这一系列事件让我问了一个问题:

**第三方应用程序如何在用户 b 的好友列表中显示用户 a，即使它没有从用户 a 那里获得任何好友列表数据来确认用户 b 确实是用户 a 的好友，因为用户 a 的脸书访问权限在他们成为朋友之前就已经过期了？**’

这个问题是故事的主要情节，让我想到“ ***”也许脸书在过期后仍在向第三方应用程序提供数据，因此第三方应用程序在过期后仍获得了 UserA 的最新好友列表数据，其中包括 UserB，这使其确认显示两者是彼此的朋友“*** 。

![](img/062bf974c45dbfc5affe5f6b003d15c1.png)

等一下…

如果你看上面的问题；你可能会注意到一些事情并问；

**嘿！，但第三方应用程序仍在从用户 b 的脸书账户获取好友列表数据，该账户对其有效，因此它可能会在应用程序内用户 b 的“脸书好友”部分显示用户 a，因为它通过用户 b 的脸书账户访问获取了用户 b 的好友列表数据。**'

我也问过自己这个问题，但突然一个潜在的问题出现了:

> **‘第三方 app 怎么能确定它从 UserB 的脸书好友列表数据中挑选的用户也在使用这个 app 呢？**'
> 
> 因此，这只能在第三方应用程序也拥有用户 a 的脸书帐户访问权限时发生，用户 a 可以从该帐户访问权限中确认他也使用该应用程序，并且该第三方应用程序的**访问权限**是他的“**好友列表数据**”。因此，它从用户 a 的脸书帐户获取朋友列表数据，作为仍然具有访问权限的结果，它还确认用户 b 是用户 a 的朋友。

因此，只有在从两个用户的脸书账户获得脸书好友列表数据后，它才能确认这两个用户都使用该应用程序，并且在脸书上彼此也是朋友。这最终将允许该应用程序在用户 b 的“**也使用该应用程序的脸书朋友**”部分显示用户 a。

显然，这对我来说是一些令人满意的想法，但这不足以证明其背后的技术性。所以，我找到了一种方法来实验性地测试这个假设的工作流程。

…

为此，我制作了两个虚拟的脸书账户，用于登录第三方应用。所以，最初。**两个用户账号**互不友好。然后，我从 ***第一个脸书账号*** 进入**安全设置**中的“**应用和网站**版块，之后；我去了**活动应用区**；点击连接的第三方应用旁边的“**编辑**选项，**关闭向应用提供额外好友列表数据**的选项。现在，只有在这之后；我在脸书上把两个用户账号都加为好友。

现在，看看这个安装环境。它与过期的第三方应用程序只从一个用户那里获得好友列表数据，而没有从另一个用户那里获得数据的情况有**相同的类比**。

所以，我去了第三方应用程序中的“脸书朋友”部分，这次我惊讶地发现:第三方应用程序没有在应用程序内的“脸书好友列表”部分显示彼此，即使它仍然从第二个用户帐户获取好友列表数据，其中包括列表内的第一个用户帐户。

因此，我有点满意地看到我关于这个工作流算法的预测假设变成了现实，因为现在，我可以肯定地确认，第三方应用程序需要来自两个用户的脸书帐户的朋友列表数据，包括每个人的朋友列表中的对方。所以，简而言之:据证实，不知何故，第三方应用程序仍然从他们的脸书帐户获取用户的私人数据，即使在到期后。

我当时想:

![](img/aba0fa17cf723ecfd62d292f6d43f5f5.png)

胡！最后…

…

[但是]仍然存在一个挑战，那就是以某种方式报告这个漏洞，以便我可以让脸书安全团队成员清楚地理解它，并像我一样感到满意。

【*(描述可能性的不必要部分)耶！我知道我可以简单地制作一个简单的应用程序，并使用开发者的第三方插件。Facebook*；我可以在我的应用程序上请求“用脸书登录”功能，在它获得批准后&就会变成 live 我只需要使用我的脸书帐户登录到该应用程序，并提供应用程序所需的脸书数据访问。然后，在不使用该应用程序的情况下等待 3 个月，使访问过期，并向他们展示“嘿，看，我仍然在我的应用程序管理面板中获取用户数据，即使在他们的脸书帐户过期后”作为概念验证。是的，这也许是可能的，但这对于一个概念验证来说是一个非常漫长的过程。* ]*

所以…..，每一条信息，我都知道这个漏洞；我以上述描述性方式向脸书安全团队报告了此事，包括几个概念验证视频，以展示我是如何被说服/测试的。

…

这里，

回复是这样的(虽然有点夸张😂):

![](img/5ea7ef1c59ba6caab7af190b5a4094c2.png)

报告连续关闭 4 次

然后，

![](img/6ca22b8db63add67f7a1ed85860fecad.png)

绝对不是这样😂但还是尽力让他们同意。

最后..一个希望；😌

![](img/02ab21af35c785fd26912bc82aec04c2.png)

首先最好从他们那边回复

现在，困难时期到来了；

![](img/a8faf8e9281150b42650b9b21cb67cfe.png)

四个月(最后一个是个笑话)

但还是那句话；

![](img/755dba676686aec683e23472fa77e572.png)

类似的回复——修复后的 UPTO

突然高潮来了:

![](img/e7861ccc0510c26499093ca7f3a55bac.png)

来自 FACEBOOK 的奖励信息

最后，经过一年的调查和 42 次拥挤的回复交流，我今天(在这篇文章发表的当天)得到了这条消息。

# …

# 感谢您阅读这篇关于我在脸书发现的一个漏洞的文章。我希望你喜欢它。如果你有任何建议/疑问，我可以在[脸书](https://www.facebook.com/samiparyalfb/) / [Instagram](https://www.instagram.com/samiparyal_/) 上找到你。

# …..