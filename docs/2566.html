<html>
<head>
<title>Python Malware Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python恶意软件分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/python-malware-analysis-a36f75ec0cad?source=collection_archive---------1-----------------------#2022-11-28">https://infosecwriteups.com/python-malware-analysis-a36f75ec0cad?source=collection_archive---------1-----------------------#2022-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/054b0251e28f6e0615e30e8f6ad7aa44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*m6l__cGYHV0mi2kl"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">迈克尔·盖格在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="9cd5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于恶意软件分析，代码执行以下操作:</p><p id="1d9e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提取散列信息。</p><p id="fd2d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正在打印文件大小。</p><p id="50bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哈希信息在OTX的Alienvault中进行检查。</p><p id="9b1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打印文件的字符串输出。</p><p id="e959" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">PE文件头中包含的许多信息以及所有章节的详细信息和数据都是可以访问的。</p><p id="dded" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">获得十六进制编辑器输出。</p><p id="2208" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要检查恶意软件分析工具的工作方式，您可以查看以下代码:</p><pre class="lb lc ld le gt lf lg lh bn li lj bi"><span id="03f6" class="lk ll iq lg b be lm ln l lo lp">import pefile<br/>from OTXv2 import OTXv2<br/>import hashlib<br/>import IndicatorTypes<br/>import string<br/>import binascii<br/>import os<br/>API_KEY = ""<br/>filename=""<br/>def hex_editor(filename):<br/>    list_editor=""<br/>    data_list=[]<br/>    full_list=""<br/>    counter=0<br/>    try:<br/>        with open(filename, "rb") as file:<br/>            while 1:<br/>                byte_s = file.read(1)<br/>                data_bytes2ascii = binascii.b2a_hex(byte_s)<br/>                list_editor+=str(data_bytes2ascii, 'UTF-8')+"\t"<br/>                data_list.append(int(str(data_bytes2ascii, 'UTF-8'),16))<br/>                full_list+= str(data_bytes2ascii, 'UTF-8') + " "<br/>                if counter == 16:<br/>                    print(list_editor)<br/>                    print("\t".join(map(chr, data_list)))<br/>                    counter=0<br/>                    list_editor=""<br/>                    data_list=[]<br/>                    full_list+=str(data_bytes2ascii, 'UTF-8')+"\n"<br/>                if not byte_s:<br/>                    break<br/>                counter+=1<br/>    except:<br/>        pass<br/>    print("="*30)<br/>    print(full_list)<br/>def strings(filename, min=8):<br/>    with open(filename, errors="ignore") as file:<br/>        result = ""<br/>        for character in file.read():<br/>            if character in string.printable:<br/>                result += character<br/>                continue<br/>            if len(result) &gt;= min:<br/>                yield result<br/>            result = ""<br/>        if len(result) &gt;= min:<br/>            yield result<br/>size = os.path.getsize(filename)<br/>print("File size:",size)<br/>file=pefile.PE(filename)<br/>print("File hashes:")<br/>with open(filename, mode="rb") as File:<br/>    hash_256 = hashlib.sha256(File.read()).hexdigest()<br/>    hash_md5 = hashlib.md5(File.read()).hexdigest()<br/>    hash_sha1 = hashlib.sha1(File.read()).hexdigest()<br/>    print("MD5:",hash_md5)<br/>    print("SAH-256",hash_256)<br/>    print("SHA-1",hash_sha1)<br/>print("Imphash:",file.get_imphash())<br/>for dll in file.DIRECTORY_ENTRY_IMPORT:<br/>    print(dll)<br/>    for functions in dll.imports:<br/>        print(functions.name)<br/>print(file)<br/>otx = OTXv2(API_KEY, server='https://otx.alienvault.com/')<br/>result = otx.get_indicator_details_full(IndicatorTypes.FILE_HASH_MD5, hash_md5)<br/>print("Alienvault Result:\n",result)<br/>print("String Result:")<br/>for string_line in strings(filename):<br/>    print(string_line)<br/>print("File Hex Editor:")<br/>try:<br/>    hex_editor(filename)<br/>except:<br/>    pass</span></pre><p id="5fd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">i̇letişim</strong></p><p id="6d84" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://twitter.com/anilyelken06" rel="noopener ugc nofollow" target="_blank">https://twitter.com/anilyelken06</a><br/><a class="ae kc" href="https://github.com/anil-yelken" rel="noopener ugc nofollow" target="_blank">https://github.com/anil-yelken</a><br/>T12】https://anilyelken.medium.com/<br/>T15】https://medium.com/sibergvenlik</p></div><div class="ab cl lq lr hu ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="ij ik il im in"><h2 id="f9c4" class="lx ll iq bd ly lz ma dn mb mc md dp me ko mf mg mh ks mi mj mk kw ml mm mn mo bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kc" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>