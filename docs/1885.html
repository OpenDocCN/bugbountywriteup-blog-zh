<html>
<head>
<title>Phishing Emails and Malware Traffic Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网络钓鱼电子邮件和恶意软件流量分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/phishing-emails-and-malware-traffic-analysis-1234f2c1ca12?source=collection_archive---------0-----------------------#2022-02-13">https://infosecwriteups.com/phishing-emails-and-malware-traffic-analysis-1234f2c1ca12?source=collection_archive---------0-----------------------#2022-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/45b0c91fc0558f356095a77bedd6e20b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/format:webp/1*m0R38vzznEGhdiFjQWXgiQ.png"/></div></figure><p id="30e4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在本文中，我使用NetworkMiner、Wireshark和混合分析来分析几封恶意电子邮件和一个PCAP文件，这些文件捕获了属于恶意软件感染的网络流量。PCAP和电子邮件文件属于蓝色团队专注于挑战<a class="ae ks" href="https://cyberdefenders.org/blueteam-ctf-challenges/21" rel="noopener ugc nofollow" target="_blank">网络卫士</a>网站，名为“<em class="kt">恶意软件流量分析5 </em>”，由<a class="ae ks" href="https://twitter.com/malware_traffic" rel="noopener ugc nofollow" target="_blank">布拉德·邓肯</a>创建。</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="3c47" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">放弃</h1><p id="98a6" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我喜欢在文章之前添加一个简短的免责声明，以鼓励人们在阅读本文之前尝试挑战，因为在这篇文章中显然会有<strong class="jw ir">剧透</strong> <strong class="jw ir">。我相信，如果你先自己尝试，然后在遇到困难或需要提示时再回来写这篇文章，你会更喜欢这个挑战。因此，没有任何进一步的拖延，让我们开始吧！</strong></p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="a2cc" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">挑战场景</h1><blockquote class="me mf mg"><p id="c5e5" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">您在一家以感恩节为主题的公司的安全运营中心(SOC)担任分析师。一个宁静的夜晚，你听到有人在敲足球俱乐部的大门。当你去开门的时候，一个精疲力竭的邮件服务器技术人员跌跌撞撞地进来，很快就倒在了地板上。他用颤抖的声音低语道，“邮件过滤器坏了…到处都是垃圾邮件…”</p><p id="ea80" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">当你扶他起来的时候，他看着天空喊道:“地狱之门已经打开了！”。技术人员立即再次倒下，轻声低语道:“恐怖……恐怖……”</p><p id="de09" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">邮件过滤器停机持续了整整一天。幸运的是，报道的事件很少。但是有一个例子引起了你的注意。在邮件过滤器停机期间，一名公司员工决定玩“电子邮件轮盘赌”该员工打开了收件箱中的一封恶意邮件，并将其视为合法邮件。</p><p id="354f" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">你获得了该员工收到的四封恶意邮件。你还从他被感染的电脑上收到了一个pcap流量。你的任务？找出是哪封邮件危害了系统。</p></blockquote></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="b3b1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">挑战问题</h1><blockquote class="me mf mg"><p id="ffa4" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">1.c41-MTA5-email-01:恶意文件的名称是什么？</p></blockquote><p id="be84" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我首先将这封邮件上传到VirusTotal，41家安全供应商将这封邮件标记为恶意邮件。在“行为”选项卡下查看电子邮件的输出，我可以看到恶意文件的名称。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/d54850fa1806a69952fd1375220c89f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*wiFFz-ehfiYMr7WO9LcGuA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">恶意文件名。</figcaption></figure><blockquote class="me mf mg"><p id="822b" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">2.c41-MTA5-email-01:该恶意软件所属的木马家族叫什么名字？(由新出现的威胁规则集确定)。</p></blockquote><p id="6f99" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们将邮件上传到<a class="ae ks" href="https://www.hybrid-analysis.com/" rel="noopener ugc nofollow" target="_blank">混合分析</a>，我们可以看到关于邮件及其相关文件的附加信息。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mt"><img src="../Images/e3021f69ae6bbc5f50877b04dd361fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EbgD2212hN9AYXFZUF_yA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">与c41-MTA5-email-01相关的文件。</figcaption></figure><p id="6002" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我选择恶意软件文件名，我可以获得额外的信息，如猎鹰沙盒报告。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1cedeb0b13593e7bad8fa8a26f516942.png" data-original-src="https://miro.medium.com/v2/resize:fit:642/format:webp/1*nkfPCbrMa677E0uloeQODg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">混合分析猎鹰沙盒报告。</figcaption></figure><p id="2a9e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">回顾这份报告，我可以看到Suricata对<a class="ae ks" href="https://malpedia.caad.fkie.fraunhofer.de/details/win.upatre" rel="noopener ugc nofollow" target="_blank"> Upatre </a>特洛伊木马恶意软件家族的警告。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mz"><img src="../Images/8aeb7297e834b38b8c9b92e759cbd740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TWZxzqNvg_Vj1QHO3nMdtg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Upatre特洛伊木马程序恶意软件家族的混合分析Suricata警报。</figcaption></figure><blockquote class="me mf mg"><p id="0be8" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">3.c41-MTA5-email-01:恶意软件丢弃了两个哈希相同但名称不同的恶意文件。提供这些文件的SHA256哈希？(查看2015年提交的报告)。</p></blockquote><p id="2659" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在混合分析中，我们可以使用前面确定的恶意软件的SHA256哈希来搜索2015年提交的任何报告。退回的报告有六份，其中一份是2015年提交的。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi na"><img src="../Images/82630868315b6871ebee3306f96892cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4KOZUjSexSNQizF7gW1s_w.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">2015年提交的报告包含SHA256哈希460630672421.exe。</figcaption></figure><p id="6ba8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们将报告向下滚动到提取的文件部分，我们可以看到两个标记为恶意的文件，它们具有相同的SHA256哈希，但文件名不同。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e9e0d38883045e3f134df60c3db226f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*HWOzWOElnmXyQJDEn0CFfg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">恶意软件丢弃了两个具有相同哈希但不同名称的恶意文件。</figcaption></figure><blockquote class="me mf mg"><p id="8a08" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">4.c41-MTA5-email-01:恶意软件发起了多少个DNS请求？(查看2015年提交的报告)。</p></blockquote><p id="5a2d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在2015年混合分析报告中，我们可以看到提出了三个DNS请求。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/bacb8a37d87d8710a05234c4080f166c.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*q9jmOio4nRyHQNmRSadPlA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">混合分析DNS请求。</figcaption></figure><blockquote class="me mf mg"><p id="de89" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">5.c41-MTA5-email-02:多个流包含本文档中的宏。提供最高的数字。</p></blockquote><p id="621f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我从邮件中提取了附件，并使用<a class="ae ks" href="https://github.com/decalage2/oletools" rel="noopener ugc nofollow" target="_blank"> OLETOOLS </a>对文件进行了分析。如果你想了解更多关于OLETOOLS的知识，我发表了一篇文章，在这篇文章中我使用OLETOOLS分析了恶意的Microsoft word文档。</p><div class="nd ne gp gr nf ng"><a rel="noopener  ugc nofollow" target="_blank" href="/maldoc101-malicious-macros-analysis-with-oletools-8be3cda84544"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">MalDoc101 —使用OLETOOLS进行恶意宏分析</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">这篇文章提供了我的方法来解决由Josh Stroschein在CyberDefenders上创建的maldoc 101 CTF…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">infosecwriteups.com</p></div></div><div class="np l"><div class="nq l nr ns nt np nu js ng"/></div></div></a></div><p id="cc0c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我开始使用OLEID来分析文件，我可以看到文件包含可疑的VBA宏。</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="a2db" class="oa lc iq nw b gy ob oc l od oe">oleid 'Bill Payment_000010818.xls'</span></pre><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi of"><img src="../Images/1f3129a416fc90ed8212959b2c5505f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRs_cAmmVqCWnIc0QlFNdA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">OLEID识别可疑的VBA宏。</figcaption></figure><p id="5fc9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我可以使用OLEDUMP来分析流并识别包含宏的最高流:</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="7f8a" class="oa lc iq nw b gy ob oc l od oe">python oledump.py 'Bill Payment_000010818.xls'</span></pre><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi og"><img src="../Images/155f4961dab8671ea28dc5ef0c869aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jL-CxPjGEbz31Qs9FHNbcA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">包含宏的最高流号。</figcaption></figure><blockquote class="me mf mg"><p id="fc8b" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">6.c41-mt a5-email-02:Excel宏试图下载文件。提供此文件的完整URL？</p></blockquote><p id="4f30" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有两种方法可以解决这个问题。第一种方法是将excel文件上传到VirusTotal。44个安全供应商和一个沙箱将该文件标记为恶意文件。在Behavior选项卡下，我们可以看到宏用来发出HTTP GET请求以下载可执行文件的URL。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/e4970d904a4c3a632f367176909ab24f.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*tE4plMJm7MtKZLlbwo2bwA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">宏用来下载文件的完整URL。</figcaption></figure><p id="fee0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第二种方法是从excel文件中提取和逆向工程VBA代码。要提取VBA代码，我们可以使用OLEVBA。</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="8fc4" class="oa lc iq nw b gy ob oc l od oe">olevba -c "Bill Payment_000010818.xls"</span></pre><p id="169f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这将返回宏的所有VBA源代码，无需任何进一步的分析。如果我们查看源代码，我们可以看到一个名为“<em class="kt"> valdis </em>”的数组，其中包含大量的值。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/76d7c31a74c81dceb382b295ecd21100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*DEhhMYy_YdoMZsBAv-6M6w.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">宏“valdis”数组值。</figcaption></figure><p id="6c84" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这可能是URL，但它已经被编码，所以我们需要确定宏如何获得原始值。再往下看一点，我可以看到数组被传递给一个名为“<em class="kt"> Pochemu </em>”的函数。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/072f547419156324f10ef830dced9090.png" data-original-src="https://miro.medium.com/v2/resize:fit:794/format:webp/1*dXnb5CATJmBMMRgCWqqAXw.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">“Pochemu”函数传递了“valdis”数组。</figcaption></figure><p id="5e3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到“GET”一词，这表明“Pochemu”函数生成的值可能提供了之前在VirusTotal中看到的作为HTTP GET请求一部分的值。我搜索了函数“<em class="kt"> Pochemu </em>，找到了它的源代码。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/f756bef4806229c613c79821f22d5943.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*UmdEd-BUfNWWs3eCCXXYIA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">“波切姆”函数VBA码。</figcaption></figure><p id="52f1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">基于“<em class="kt"> Pochemu </em>”函数的代码，它执行以下操作:</p><ol class=""><li id="6f9f" class="ol om iq jw b jx jy kb kc kf on kj oo kn op kr oq or os ot bi translated">函数有两个参数:</li></ol><ul class=""><li id="95d3" class="ol om iq jw b jx jy kb kc kf on kj oo kn op kr ou or os ot bi translated"><a class="ae ks" href="https://software-solutions-online.com/vba-variant/#:~:text=A%20VBA%20Variant%20is%20a,%2C%20dates%2C%20time%20or%20objects." rel="noopener ugc nofollow" target="_blank">一个VBA变量</a> : <strong class="jw ir">一个VBA变量，它没有被声明为具有特定的数据类型</strong>。因此，它可以保存VBA变量能够保存的任何类型的数据，无论是文本、数字、日期、时间还是对象。</li><li id="2a1b" class="ol om iq jw b jx ov kb ow kf ox kj oy kn oz kr ou or os ot bi translated">一个叫做“oldLen”的整数值。</li></ul><p id="8ba6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">2.“n”变量使用<a class="ae ks" href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/lbound-function" rel="noopener ugc nofollow" target="_blank"> LBound </a>和<a class="ae ks" href="https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/ubound-function" rel="noopener ugc nofollow" target="_blank"> UBound </a>函数来<strong class="jw ir">确定数组</strong>的大小。</p><p id="6575" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">3.在通过“<a class="ae ks" href="http://Chr function converts the specified ANSI character code to a character." rel="noopener ugc nofollow" target="_blank"> <em class="kt"> Chr() </em> </a>”函数将数组中的每个整数值转换为ANSI字符代码之前，对其执行<strong class="jw ir">算术运算</strong>。</p><p id="621e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">既然我们现在有了解码URL的源代码和用于编码URL的值，我们可以使用一个简单的python脚本来复制由"<em class="kt"> Pochemu </em>"函数执行的算术运算，并检索解码后的URL。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/b140ab3e492c91dacf273b84a8ee3e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*g60_pJUsAHfVpXlsY6dv7A.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">解码URL的Python脚本。</figcaption></figure><blockquote class="me mf mg"><p id="0df0" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">7.c41-MTA5-email-02:用于从下载URL获取数据的对象的名称是什么？</p></blockquote><p id="bda6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看前面的"<em class="kt"> Pochemu </em>"函数的第一张图片，我们可以看到一个名为"<em class="kt"> read_same_ch_from3 </em>"的对象。如果我们看看这个对象的值是在哪里设置的，我们可以看到一个部分字符串与“<em class="kt"> zilibobe </em>”对象值连接在一起。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pb"><img src="../Images/50728096fb37625ad8196b361ef55be1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WYE7nV721SB2H5xfYPAHaQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated"><em class="pc"> read_same_ch_from3 </em>字符串值。</figcaption></figure><p id="2e8b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了重建完整的字符串，我们需要识别"<em class="kt"> zilibobe </em>"对象值。在上面的VBA代码中，我可以看到值被设置为“<em class="kt"> t </em>”。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/8a0510a4725f073a913e4d72ed66901b.png" data-original-src="https://miro.medium.com/v2/resize:fit:546/format:webp/1*z_Rljkd1ic-dfXpJ6cvhbA.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated"><em class="pc"> zilibobe </em>对象值。</figcaption></figure><p id="01bf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们现在可以重建完整的字符串:<strong class="jw ir"> Microsoft。XMLHTTP </strong>。</p><blockquote class="me mf mg"><p id="0ac8" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">8.c41-mt a5-email-02:Excel宏将文件写入临时文件夹。提供文件名？</p></blockquote><p id="99cb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">同样，我们可以使用VirusTotal来标识写入临时文件夹的文件名。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/0c2c2e62600246e2322a946f80abca39.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*HXVrjLO9MVBFam_jrti32g.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">写入临时文件夹的VirusTotal文件名。</figcaption></figure><p id="087a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在VBA代码中，我们可以看到一个名为<em class="kt">的函数是_sqr_in_string </em>。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/6ebc52007f411a3e312d4758309184b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*b3jbN4GlrADrBf6iVptCnQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated"><em class="pc">是_sqr_in_string </em>函数的VBA代码。</figcaption></figure><p id="248a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">基于上面的“<em class="kt"> is_sqr_in_string </em>”函数的代码，我可以创建一个简单的python脚本来重建写入TEMP的文件名。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pg"><img src="../Images/1386a511f22e409478c3320603f092bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9jYidrMkHPmIGfbq-dUC4g.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Python脚本重建写入临时文件的文件名。</figcaption></figure><blockquote class="me mf mg"><p id="2829" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">9.c41-MTA5-email-03:提供攻击者用来存储登录凭证的FQDN？</p></blockquote><p id="9ac2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们将电子邮件上传到VirusTotal，我们可以看到已识别的FQDN列表。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/cf3de98d2e42a4d1dc46af39f7009317.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*5XLj-V_sWwqsYYtH0a99Hg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">已识别电子邮件中的病毒总数FQDN。</figcaption></figure><p id="589d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们可以从电子邮件中提取AmericanExpress.html附件，并将文件上传到混合分析。查看生成的报告，我可以看到八个使用“<em class="kt">jpmmotos</em>”FQDN的HTTP GET请求。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/0c3c77b44ae811a4fec163a2d510b700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*XjvjU5TAJN3XkBXzU0w6AQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">攻击者用来存储登录凭据的FQDN。</figcaption></figure><blockquote class="me mf mg"><p id="4622" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">10.c41-MTA5-email-04:恶意js中有多少个FQDNs？</p><p id="34eb" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">11.c41-MTA5-email-04:用来处理和读取文件的对象叫什么名字？</p></blockquote><p id="c1b0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我首先从标题为“<em class="kt"> fax000497762.zip </em>”的电子邮件附件中提取恶意JS。很难在一行中阅读，所以我把它放在一个<a class="ae ks" href="https://beautifier.io/" rel="noopener ugc nofollow" target="_blank"> JavaScript美化器</a>中，使它更易读。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pj"><img src="../Images/646e51d40ade7f3002ef93597d9d6c19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H_gYv07LAsE4ht9t1UnlKg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">恶意JS。</figcaption></figure><p id="8427" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">看一下JavaScript，它似乎在重构一些JS代码，然后将“<em class="kt"> var </em>”字符串值传递给它。我可以将JavaScript传递给一个在线编译器并得到输出。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pk"><img src="../Images/c29754a8cd65d93ace7b7debb38526c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LvGqGGYQmfUjP6t5CWsZUQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">JavaScript输出。</figcaption></figure><p id="6008" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在JavaScript输出的顶部，我们可以看到列出了三个域。再往下，我们还可以看到用来处理和读取文件的对象名称是“<em class="kt"> ADODB。流</em>”。</p><blockquote class="me mf mg"><p id="d181" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">12.c41-MTA5.pcap:受害人收到多封邮件；但是，用户打开了一个附件。提供附件文件名。</p><p id="d5dd" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">13.c41-MTA5.pcap:受害机器的IP地址是什么？</p><p id="0579" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">14.c41-MTA5.pcap:受害机器的主机名是什么？</p><p id="f093" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">15.c41-MTA5.pcap:托管恶意软件的FQDN是什么？</p></blockquote><p id="646c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">以下附件列表是从所提供的电子邮件中提取的。</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="5fb5" class="oa lc iq nw b gy ob oc l od oe">AmericanExpress.html<br/>'Bill Payment_000010818.xls'<br/>'dawning wall up.zip'<br/>fax000497762.zip</span></pre><p id="2b7e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">根据我们之前对恶意附件文件的分析，我们可以使用Wireshark和NetworkMiner来查找与这些文件相关的任何迹象。在NetworkMiner中的hosts选项卡下，我从识别受感染的端点开始。我可以在组织的内部专用网络中看到一台Windows计算机。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/8f077cde33f98a92ed906f5fcc9adfe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*J8yPZTk_tlR7frQNIVcX_w.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">NetworkMiner感染的Windows计算机详细信息。</figcaption></figure><p id="b490" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，在“sessions”选项卡下，我可以看到受感染的Windows主机与之前在问题10的恶意JavaScript中识别的FQDN之一之间的会话。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pm"><img src="../Images/3bf42247dbb19a1d841cb68bcab8d574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_FXkqTUtNovatcmjtGg-KA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">在恶意JavaScript中发现受感染机器和FQDN之间的NetworkMiner会话。</figcaption></figure><p id="cba1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在NetworkMiner的文件选项卡下，我还可以看到三个伪装成GIF文件的可执行文件是从恶意JavaScript中找到的FQDN下载的。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pn"><img src="../Images/b89218833c0b8634885e4edddb736595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cz5iR2uSxKmfUZpwHQsiYg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">下载的NetworkMiner可执行文件。</figcaption></figure><p id="88d7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在Wireshark中，我可以过滤FQDN的IP地址并跟踪TCP流。在TCP流中，我可以看到第一个数据包下载了一个伪装成GIF文件的Windows/DOS可执行文件(注意MZ头文件)。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi po"><img src="../Images/9226f6322da2927eeeaeb74be5723abc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*zkU4iejr4gdVLxUfoQbzNg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Wireshark Windows/DOS可执行文件下载。</figcaption></figure><p id="f20e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看之前的恶意JavaScript，我们还可以看到URL语法结构与Wireshark中的结构相匹配。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pp"><img src="../Images/85f38658007ee48eeec0962afc1035ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcX_Sv6HIdchWj4Z9Lw1hw.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">JavaScript匹配URL结构。</figcaption></figure><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/b440099e6443ae78ff0fdd3aef789a4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*Zbt-n9oFw3eK3vKU59-qAQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Wireshark匹配URL结构。</figcaption></figure><p id="2ad9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这表明受害者打开了“<em class="kt"> fax000497762.zip </em>”电子邮件附件，其中包含恶意JavaScript。</p><blockquote class="me mf mg"><p id="4ac5" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">16.c41-MTA5.pcap:打开的附件向TEMP文件夹写入了多个文件。提供写入磁盘的第一个文件的名称？</p></blockquote><p id="90c9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">分析恶意JavaScript，我可以看到，一旦HTTP GET请求成功，就使用“<em class="kt"> saveToFile() </em>”文件函数，参数如下所示。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pr"><img src="../Images/82b5bffa2adcf77ecf870aead7b172d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2B8h7lxvHOI-Jsyxv8W1dg.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated"><em class="pc"> saveToFile() </em>文件功能。</figcaption></figure><p id="6b47" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">文件名由存储在"<em class="kt"> fn" </em>变量中的值、"<em class="kt"> n </em>变量的当前值和字符串"<em class="kt">组成。exe </em>”。我可以看到在第一个for循环中使用了"<em class="kt"> n </em>"变量，并且"<em class="kt"> fn" </em>变量包含一个静态字符串值。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi ps"><img src="../Images/617973f668ec008a5653847aad3b1038.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CWLCvTqGRLxNmNxe9PjxMQ.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">“fn”变量值。</figcaption></figure><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/6e86056416d61cdf6a3bc6ef72fff944.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*2RkfWMJV2SqMx2KkGW_C8w.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">“n”变量值。</figcaption></figure><p id="5163" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于这是第一个文件，变量“<em class="kt"> n </em>将被设置为1。“<em class="kt"> fn </em>”变量将与“<em class="kt">n</em>and”连接在一起。exe”来提供以下文件名:</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="70ea" class="oa lc iq nw b gy ob oc l od oe">%TEMP%\7997551.exe</span></pre><blockquote class="me mf mg"><p id="b79f" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">17.c41-MTA5.pcap:其中一个写入磁盘的文件有如下md5哈希“35 a 09d 67 bee 10 c 6 aff 48826717680 c1c”；该恶意软件检查哪个注册表项来确定其存在？</p></blockquote><p id="c386" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了分析恶意的可移植可执行(PE)文件，我使用了<a class="ae ks" href="https://www.winitor.com/" rel="noopener ugc nofollow" target="_blank"> pestudio </a>，但是如果你在Linux机器上工作，你可以使用<a class="ae ks" href="https://www.kali.org/tools/pev/" rel="noopener ugc nofollow" target="_blank"> pev工具</a>来代替。与其他一些工具不同，pestudio试图根据某个文件可能具有的某些<em class="kt">指标</em>来确定该文件是否是恶意的。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/39e89302092e238f1ba218cc0b254c2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*5kv5WSRWI2ttKqFQM5o-uQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">pestudio指标。</figcaption></figure><p id="e037" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我查看pestudio发现的一些顶级指标，我可以看到恶意文件引用了一些可疑的字符串。我可以查看pestudio找到的字符串，并根据大小进行组织。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/1304e8dcaf6c0050cec6603adc7b7274.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*7lcvBCaqZLlDSkal34Y4cQ.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">pestudio注册表项。</figcaption></figure><p id="2c89" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到一个不寻常的字符串，它与此挑战的答案格式相匹配，并且是恶意软件用来检查其存在的注册表项。您也可以使用pev tools中的"<em class="kt"> pestr" </em>找到相同的字符串。</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="539a" class="oa lc iq nw b gy ob oc l od oe">pestr pe-file</span></pre><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pw"><img src="../Images/58936bbac51a2e5064854de28baa62c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*48ltKnFdqayK2l_nRqfb4g.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">pestr注册表项。</figcaption></figure><blockquote class="me mf mg"><p id="0c02" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">18.c41-MTA5.pcap:其中一个写入磁盘的文件具有以下md5哈希“e2fc 96114 e 61288 fc 413118327 c 76d 93”向“upload.php”页面发送HTTP post请求。提供web服务器IP。(IP不在PCAP)</p></blockquote><p id="ce6b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以将提供的MD5散列提交给混合分析。查看2015年的最后一份<a class="ae ks" href="https://www.hybrid-analysis.com/sample/f195bc9c26e0819663a907f855f6cff1125812993b89ba9d7bc48272181e2c73/5640065b0e316dc229e2be8b" rel="noopener ugc nofollow" target="_blank">报告，我可以看到该哈希的PE可执行文件向web服务器IP上托管的“<em class="kt">upload.php</em>”页面发出了两个HTTP POST请求，如下所示。</a></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi px"><img src="../Images/0406fca9b6fa452ddb1ef859323b4c81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*BKxf1-t5TZ4go5Dg-T7BQg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">web服务器IP。</figcaption></figure><blockquote class="me mf mg"><p id="d72d" class="ju jv kt jw b jx jy jz ka kb kc kd ke mh kg kh ki mi kk kl km mj ko kp kq kr ij bi translated">19.c41-MTA5.pcap:恶意软件在感染后发起回拨流量。提供目标服务器的IP。</p></blockquote><p id="fe1d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在Wireshark中，我可以导航到“<em class="kt">统计数据&gt;对话&gt; TCP </em>”并按数据包的最高数量对对话进行排序。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi py"><img src="../Images/38da28c45b7c2aced3578ee376db797c.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*IX8lIzf1m-Rm_eMaw0xfTg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">Wireshark对话。</figcaption></figure><p id="457a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我看到受感染的主机和上面突出显示的IP地址之间通过端口80交换了大量数据包。在Wireshark中，我过滤了IP地址和http流量。</p><pre class="ml mm mn mo gt nv nw nx ny aw nz bi"><span id="4d2e" class="oa lc iq nw b gy ob oc l od oe">ip.addr == 109.68.191.31 &amp;&amp; http</span></pre><p id="1137" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以看到一个HTTP GET请求从受感染的机器下载一个可疑的文件。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/cdaf68d177c3691dd90b3bf6b79445a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*EroLDV_HpdV9voOmlOi9cg.png"/></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">可疑的HTTP GET请求</figcaption></figure><p id="ba3a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们查看Wireshark中的HTTP对象，我们可以看到有大量可疑流量与此IP地址相关联，这可能是感染后的流量..</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi pz"><img src="../Images/52462a8dfe47e58612f5c94df9eb5b5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VukeyNSRg1gT78RjAxa8xA.png"/></div></div><figcaption class="mp mq gj gh gi mr ms bd b be z dk translated">感染后流量。</figcaption></figure></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="567d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结束语</h1><p id="3d7e" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">我发现这个挑战对于使用NetworkMiner、Wireshark和Hybrid-Analysis进行实践来说非常棒。我也非常喜欢通过电子邮件和PCAP挑战来了解Windows虚拟机是如何被感染的。谢谢你一直读到最后，继续黑下去😄！</p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="f972" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae ks" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nd ne gp gr nf ng"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">iwcon.live</p></div></div><div class="np l"><div class="qa l nr ns nt np nu js ng"/></div></div></a></div></div></div>    
</body>
</html>