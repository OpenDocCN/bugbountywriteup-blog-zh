<html>
<head>
<title>Breaking Business Logic via Coupons — The Story of my 1st Valid Bug Bounty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过优惠券打破商业逻辑——我的第一个有效Bug赏金的故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/breaking-business-logic-via-coupons-the-story-of-my-1st-valid-bug-bounty-89c30ff214dc?source=collection_archive---------0-----------------------#2020-07-03">https://infosecwriteups.com/breaking-business-logic-via-coupons-the-story-of-my-1st-valid-bug-bounty-89c30ff214dc?source=collection_archive---------0-----------------------#2020-07-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c2bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在一个私人程序上发现的第一个有效漏洞的故事——</p><p id="8b54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将分享:</p><ol class=""><li id="53bb" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jp ir">我是如何开始</strong>信息安全和bug bounty的，我的挣扎和矛盾以及我从中学到了什么。</li><li id="6f2c" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">在学习了一些东西后，我不得不采用一种<strong class="jp ir">不同的方法</strong>。</li><li id="2119" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">然后我会进一步讨论我是如何发现我的第一个有效bug的，<strong class="jp ir">发现Bug。</strong></li><li id="bca4" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我将以<strong class="jp ir">一些从发现</strong>中得到的收获或教训来结束我的演讲。</li></ol><h1 id="aa10" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">我是如何开始的</h1><p id="579f" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">2015年听说了bug bounty，我<a class="ae mc" href="https://www.editweaks.com/2015/02/exclusive-interview-with-laxman-meet.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="md">采访了我的一个好朋友</em> </strong> </a>，后来2017年对信息安全产生了兴趣。</p><p id="6c25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我从2017年开始学习Infosec，以及脸书和谷歌等公共项目的漏洞奖金，但在整个学习阶段，我非常“不一致”。这可能是因为我把它作为一种爱好，也就是说，只有当我从搜索引擎优化顾问、数字营销人员和信息企业家的主要工作中解脱出来的时候。</p><p id="011e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我最初开始在脸书上打猎，<a class="ae mc" href="https://thezerohack.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">拉克斯曼</strong> </a> <strong class="jp ir">和</strong> <a class="ae mc" href="http://twitter.com/phwd" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Phwd </strong> </a>是我的灵感，他们从一开始就很有帮助，我也认识了这个领域里一些更牛逼的人。</p><p id="f810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我读了一些电子书，试图发现和报告错误，但没有成功，事实是我开始的那些公共程序是最具挑战性和最难破解的；因为事实上，世界上大多数最好的安全研究人员/怀特哈特黑客已经在测试它们，并发现了大多数漏洞。</p><p id="8f3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">随着时间的推移，我的报告总是以“不适用”、“信息丰富”或“重复”而告终。每次回复后，我经常会休息很久。</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="cc2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我还注意到，新手(有时甚至是专家或1337)也会有这种挫败感。</p><p id="6411" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对有效bug知之甚少或一无所知，直到我遇到了一个代号为<a class="ae mc" href="https://twitter.com/_sawzeeyy" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> F007573P </strong> </a>的朋友，他总是在那里回复我关于在web应用程序中寻找bug的问题。</p><h1 id="8ed3" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">不同的方法</h1><p id="cf73" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">在这一点上，我觉得有必要在再次寻找困难的公共项目之前积累知识。一些好朋友和信息安全社区的一些推文建议安全研究人员也可以尝试不在bug bounty平台上的私人程序。</p><p id="f78b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哇，也许我可以在其他地方试试我的小知识。所以我决定搬出去，尝试一种不同的方法——我想到了<strong class="jp ir">逻辑缺陷</strong>，这是我目前最喜欢的方法。</p><p id="8d7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定继续调查<a class="ae mc" href="https://owasp.org/www-community/vulnerabilities/Business_logic_vulnerability" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="md">违反商业逻辑</em> </strong> </a>的问题，直到我更有知识或足够熟练去捕捉更严重的更高技术错误(在野外)。</p><figure class="me mf mg mh gt mi"><div class="bz fp l di"><div class="ml mk l"/></div></figure><h1 id="a117" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">寻找BUG</h1><p id="2eb1" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">我们将假设私人程序的网站被称为编辑</p><p id="b1b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个bug存在于处理优惠券的端点，这些优惠券只能一次性使用。</p><p id="de4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据我收到的邮件，当你注册时，你会得到一张优惠券，目的是鼓励顾客购买东西，优惠券将在几个小时后到期，我最初忽略了这张优惠券。</p><p id="6cc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">两周后</strong></p><p id="08ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想在这个网站上购物，所以我在2周后使用了优惠券，优惠券仍然有效，这引发了我的好奇心，我决定深入测试一下。</p><p id="214e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">10分钟后，我意识到我可以想用多少次优惠券就用多少次。</p><p id="b36a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这个，我就可以欺骗被篡改的支付系统，这可能会导致公司的财务损失。</p><p id="9d3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">概念验证</strong></p><p id="34e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要求:新用户的新帐户和一次性使用的优惠券。</p><p id="66e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.登录到修订的帐户</p><p id="3391" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.复制您的优惠券代码</p><p id="dc2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们假设优惠券代码是&gt; &gt; REDCOP300</p><p id="e5d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.我在不同的标签上打开了每一件我想买的东西</p><p id="df87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.在我给每个标签下订单之前，在每个标签上应用代码</p><p id="7966" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将降低每个标签上每个项目的价格。</p><p id="74ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.在我的一个订单中，我点击了结账，选择了PayPal作为结账选项，并在PayPal网站上为订单付款。</p><p id="3e2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一点上，我知道我可以为其他标签上的其他项目下订单(我已经在它们中应用了相同的折扣)，因为PayPal checkout是外部编辑的，编辑的网站不能再控制价格了。</p><p id="746c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我举报了。</p><p id="66e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">团队工作人员回答——我只在一件商品上试过，我没有充分证明我是否可以用相同的优惠券在其他标签上下单，因此他们不确定付款是否会成功。</p><p id="1db5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的回答是——我回答说再次下订单会花费我一些钱，但我接受了挑战，继续执行步骤1-5，并使用“一次性使用”优惠券为其他标签中的许多商品付款。</p><p id="791a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">影响，</strong></p><p id="dc32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">示例:</p><p id="e1ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">价值2000美元的商品我可以得到100美元的折扣</p><p id="64b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">价值3000美元的商品可以获得300美元的折扣</p><p id="8059" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">价值5000美元的商品可获得500美元的折扣</p><p id="d6f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以用一张优惠券统治他们</p><p id="8cba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几个月后，他们回复说安全小组已经调查过了，他们对我的报告表示感谢，并奖励了我奖金。</p><h2 id="40ec" class="mm la iq bd lb mn mo dn lf mp mq dp lj jy mr ms ln kc mt mu lr kg mv mw lv mx bi translated">报告时间表:</h2><p id="0a30" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated">报告已发送—2020年2月9日，</p><p id="9b83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">团队成员回应——2020年2月10日——他们怀疑这个bug是否有效。然后，我提出了新的概念，以显示充分利用。</p><p id="7767" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过几周和几个月的延迟沟通，我放弃了这份报告——2020年3月28日</p><p id="6265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">团队工作人员回应bug有效—4月26日，奖金奖励2020年6月</p><h1 id="b606" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">外卖:</h1><p id="8111" class="pw-post-body-paragraph jn jo iq jp b jq lx js jt ju ly jw jx jy lz ka kb kc ma ke kf kg mb ki kj kk ij bi translated"><strong class="jp ir">高级部分可能有Bug</strong>——这一点怎么强调都不为过，我看到研究人员说了很多，这是真的。一个网站的免费部分通常更安全或者已经被修复，但是当你付费访问研究人员不常去的付费部分时，就有更高的几率在那里发现漏洞。</p><p id="1e4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">总是练习耐心:</strong>我非常想找到一个有效的bug，但是我等了很久才努力实现。我甚至发现并向一些随机的公司报告了错误，他们默默地修复了他们的问题，但甚至没有回复我说谢谢，但这是另一天的故事:)</p><p id="1540" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其次，即使你发现了一个有效的漏洞并报告了它，这些公司也有他们的做事方式。伤检分类和缺陷修复会经历各种各样的过程，这意味着你必须等待或者在等待的时候做其他事情。</p><p id="d159" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">始终检查端点在不同选项卡中的反应</strong> s —当您在浏览器上打开多个选项卡并执行动作A，然后在另一个选项卡上执行动作B时，动作A是否会在其他选项卡中反映出来？或者，动作B是否阻止动作A执行您在其他单独的选项卡中执行的操作，或者您是否可以执行这些操作而不受影响。</p><p id="dc75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样，我作为信息安全和bug bounty爱好者的旅程正式开始了…</p><p id="c26b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢<a class="ae mc" href="https://twitter.com/_sawzeeyy" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> F007573P </strong> </a>帮我校对&amp;这篇评论</p></div></div>    
</body>
</html>