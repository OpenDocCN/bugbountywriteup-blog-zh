# B̶a̶k̶e̶黑掉你的蛋糕！

> 原文：<https://infosecwriteups.com/b%CC%B6a%CC%B6k%CC%B6e%CC%B6-hack-your-cake-923a40054b9d?source=collection_archive---------0----------------------->

> **“如果你不会烤蛋糕，那就黑掉整个蛋糕店”——Vivek Coelho**

这是一个星期六，像往常一样，我们计划明天停止吃垃圾食品。所以，我们决定在丰盛的午餐后吃些甜点，然后停止吃含糖的东西。“我会烤蛋糕”——我妻子说。我说“不，亲爱的！！你已经看腻了《纳金》(印度电视剧)的剧集，为什么不休息一下？”。我还要求她在看完连续剧后有时间的话，准备一些竞争性考试。她同意了❤.快乐的妻子和快乐的我。

![](img/d8ec73931c2baae55173b4f886010d3b.png)

所以我们可以在网上订蛋糕。让我们从这家商店的网站订购。我每天在去办公室的路上都会看到这家商店。这在当地很有名。当我进入这个网站的时候，我就有一种直觉，这个网站有很多漏洞。如果你习惯了安全测试，看到网站的设计等等，你会有这种第六感。我首先注意到的是用于登录的 OTP 特性。也许我可以暴力破解，登录其他账号。但是我为什么要这么做呢？我是来订蛋糕的，而不是来看别人买了什么精美的蛋糕。我登录了自己的账户，并决定坚持购买蛋糕的计划，而不是做一些魔术。但是你知道打破习惯并不容易。我开始检查网络流量。不出所料，该网站没有 CSRF 保护。好的，很好，但是我没有任何向网站所有者报告漏洞或者利用漏洞的意图。我只是好奇，仅此而已。所以没当回事。

我选了一个巧克力蛋糕，价格是 800 卢比。而在支付页面，我看到了一个选项，输入打折券。我试过输入随机值，试过 SQL 注入，XSS，还有其他很多东西。什么都没用。正如我所说的，我对寻找什么东西不感兴趣，因为我知道即使我报告了这个问题，我也不会得到任何奖励或赞赏。此外，午餐太油腻了，我的身体用尽了所有的能量来消化它。“睡吧，睡吧”——这就是我的大脑想要的。

于是，我点击了结账按钮，输入了送货地址，一个嵌入式付款弹出窗口出现了。弹出菜单包含总金额和支付方式，如 UPI、网上银行等。网关是“RazorPay”。但是我仍然打开了网络流量分析器选项卡，我发现了比我选择的蛋糕更美味的东西。他们发送到支付网关的请求包含大量信息，并且它还包含五个或更多字段，这些字段的值类似于“800.00”、“800000”等。总成本是 800 卢比，任何类似的数字应该与总价格有关，对不对？我关闭了支付弹出窗口，通过 burp suite 重定向我的流量，并在再次单击 checkout 按钮后捕获请求。我拦截了 web 请求，并将包含“800”的所有参数都更改为“1 ”,请求就发送了。我惊讶地发现 RazorPay 弹出窗口现在显示的总金额是 1，而不是 800。我选择了 UPI 选项并输入了我的 UPI id。google pay 的金额是 1 英镑，而且它正在运行。接下来，我想知道它是否真的有效。我可以用 1 Rs 完成我的订单。我的本意并不是伤害，但做了正常人做不到的事的那种高人一等的感觉，却是一件了不起的事情。所以我就把金额改成了 750 卢比。我知道如果这样不行，我会失去我的 750 卢比，也不会收到蛋糕。我选择了合众国际社，并使用谷歌支付。支付成功，网站上显示消息说我会按时收到蛋糕。

然后开始了真正的麻烦。像往常一样，我开始想象做违法的事情的后果。我想打电话给商店，告诉他们“我订购了蛋糕，有一些网络错误，不确定我支付了正确的金额和所有”。不，这是自杀。所以我决定放手。第二天，当我听到公寓的门铃响时，我确信不是送蛋糕的男孩就是警察。所以我要求我的妻子藏在毯子里打开前门。

![](img/9d792c9bd7809d018b4703f735d8487c.png)

幸运的是，是送蛋糕的男孩，他把蛋糕递了过来。一切都很好。但是两个小时后，我听到我的电话响了。真正打电话的人正在显示我订蛋糕的那家蛋糕店的名字。他们可能已经检查了账目，可能已经发现了收到的钱中的一些问题。我应该告诉他们什么或者我不应该参加电话会议或者我应该告诉他们当我订购蛋糕的时候有一个网络错误？我参加了电话会议，对话是这样的。

他:你好，是之前订蛋糕的 Vivek 吗？

我:是的先生:|

他:好的。维维克，蛋糕怎么样？

我:很好，先生。味道很好，价格也很合理。

他:谢谢你，维维克。请不要忘记在谷歌评论上给我们打分

我:当然。

**大团圆结局********

注意:我本可以向他们报告这件事，但是我没有，因为我想如果我丢了工作，我可以靠吃蛋糕过活。但是当我检查后发现，最近我看到这个网站被重建了，问题也解决了:(

Infosec Writeups 团队刚刚完成了我们的第一次虚拟网络安全会议和网络活动。我们有 16 位出色的演讲者，他们主持了非常有价值和鼓舞人心的会议。要查看演讲者和主题列表，[点击这里。](https://iwcon.live.)

[](https://iwcon.live/) [## IWCon2022 — Infosec 书面报告虚拟会议

### 与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…

iwcon.live](https://iwcon.live/)