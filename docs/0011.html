<html>
<head>
<title>How I got 5500$ from Yahoo for RCE</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何从雅虎为RCE获得5500美元</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-got-5500-from-yahoo-for-rce-92fffb7145e6?source=collection_archive---------0-----------------------#2017-06-04">https://infosecwriteups.com/how-i-got-5500-from-yahoo-for-rce-92fffb7145e6?source=collection_archive---------0-----------------------#2017-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6ac9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="221d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直认为分享是关爱，我一直在向bug bounty领域的多位安全研究人员学习，所以我决定与您分享我的一些发现，因为它可能会帮助其他开始Bug Bounty之旅的人。</p><p id="b094" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你几个月前已经知道的，在Apache struts 2(CVE-2017–5638)中发现了一个关键的漏洞，该漏洞会导致远程代码执行，这种容易利用的漏洞已经公布，许多web应用程序正在被大规模利用。</p><p id="648d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Struts2漏洞发布近3周后，在我的侦察过程中，我发现了这个链接:https://svdevems01.direct.gq1.yahoo.com/sm/login.jsp，这是雅虎使用的selligent Messages studio解决方案的登录页面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/abe01c6e12b3c5cfea699c7ff76afca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*va0pl6Ayl2bcsEVqm--_hg.png"/></div></div></figure><p id="d46e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">试图在那里找到漏洞，但我失败了，直到我找到这个端点:<a class="ae kx" href="https://hackerone.com/redirect?signature=81be6731e8225a2511c4680d9af714c9874d1c22&amp;url=https%3A%2F%2Fsvdevems01.direct.gq1.yahoo.com%2Fsm%2Flogin%2Floginpagecontentgrabber.do" rel="noopener ugc nofollow" target="_blank">https://svdevems 01 . direct . gq1 . Yahoo . com/sm/log in/loginpagecontentgrabber . do</a>，对于那些不知道您是否使用。行动，。做，。go意味着运行struts2的web应用程序。</p><p id="2874" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，正如我所说的漏洞已被公布，易于使用，但它对这个目标不起作用，即使它被证实是脆弱的，这意味着有WAF或其他东西阻止我的攻击。</p><p id="c19a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不能就此停止，因为它很容易受到攻击，为了报告它，我必须提供一个有效的POC，经过一些搜索后，我发现了一个twitter帖子，其有效载荷可以绕过WAF来利用此漏洞。</p><p id="b2ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现的检测方法利用内容类型的HTTP报头来发送特制的数据包。标题如下所示:</p><p id="e938" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">内容类型:% { # context[' com . open symphony . xwork 2 . dispatcher . http servlet response ']。add header(' X-Ack-th 3g 3 nt 3 lman-POC '，4*4)}。多部分/表单数据</p><p id="14e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新请求要求web服务器将两个数字相乘，并可用于请求web服务器执行任何其他操作。在上例中，这两个数字是<strong class="jp ir"> <em class="ky"> 4 </em> </strong>和<strong class="jp ir"> <em class="ky"> 4 </em> </strong>。web服务器的回答是<strong class="jp ir"> <em class="ky"> 16 </em> </strong>，这表明服务器存在漏洞。</p><p id="5286" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图所示的响应将包含新的报头<strong class="jp ir"><em class="ky">X-Ack-th 3g 3 nt 3 lman-POC:16</em></strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/9932d4217243be92e7ca3e44b97a68cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJXYXfVQWXstwHEfvp-9xQ.png"/></div></div></figure><p id="1457" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这足够公平地通过hackerone为雅虎报告了错误，雅虎在30分钟内对报告进行了分类，使应用程序离线以修复问题，之后我确认了修复，在一周内，我因这一发现获得了5500美元。</p><p id="30e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢这个发现，如果这篇文章中有任何错误，我为我薄弱的英语道歉。</p></div></div>    
</body>
</html>