<html>
<head>
<title>Let’s see how session cookie or cookie not sent over SSL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们看看会话cookie或cookie是如何不通过SSL发送的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/lets-see-how-session-cookie-or-cookie-not-sent-over-ssl-c321a8d27d6?source=collection_archive---------1-----------------------#2019-09-29">https://infosecwriteups.com/lets-see-how-session-cookie-or-cookie-not-sent-over-ssl-c321a8d27d6?source=collection_archive---------1-----------------------#2019-09-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><h1 id="6673" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated">说明</h1><p id="aac3" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现代网络浏览器支持每个cookie一个<code class="fe lm ln lo lp b">secure</code>标志。如果设置了标志，浏览器将只通过HTTPS发送cookie。通过未加密的通道发送cookie会使它们暴露于网络嗅探攻击，因此安全标志有助于保持cookie值的机密性。如果cookie包含私有数据或带有会话标识符，这一点尤其重要。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/dc84ed3d17f0fc1a0485b5fdc9e8bdee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C0FoCiliuQUCSlMgNyJvVw.jpeg"/></div></div></figure><p id="7c83" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">在这种情况下，创建了一个cookie，但是没有调用<code class="fe lm ln lo lp b">setSecure()</code>，或者调用了值<code class="fe lm ln lo lp b">false</code>。</p><p id="5510" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated"><strong class="kq iu">示例:</strong>在下面的示例中，一个cookie在没有设置<code class="fe lm ln lo lp b">Secure</code>属性的情况下被添加到响应中。</p><pre class="lr ls lt lu gt mh lp mi mj aw mk bi"><span id="ef4b" class="ml jr it lp b gy mm mn l mo mp">...<br/>HttpCookie cookie = new HttpCookie("emailCookie", email);<br/>Response.AppendCookie(cookie);<br/>...</span></pre><p id="a7dc" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">如果您的应用程序同时使用HTTPS和HTTP，但是没有设置<code class="fe lm ln lo lp b">secure</code>标志，那么在HTTPS请求期间发送的cookies也会在随后的HTTP请求期间发送。对于攻击者来说，通过未加密的无线连接嗅探网络流量是一件轻而易举的事情，因此通过HTTP发送cookiess(尤其是那些带有会话id的cookie)会导致应用程序受损。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/76e37093e8da4802bc34b7735eb42aac.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*Fk4dOV5tFs5FU_pWunOhsw.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk translated">添加(cookie)</figcaption></figure><pre class="lr ls lt lu gt mh lp mi mj aw mk bi"><span id="03c1" class="ml jr it lp b gy mm mn l mo mp">...<br/>{<br/> if (Request.QueryString[“Cookie”] != null)<br/> {<br/> HttpCookie cookie = new HttpCookie(“UserAddedCookie”);<br/> cookie.Value = Request.QueryString[“Cookie”];</span><span id="0930" class="ml jr it lp b gy mv mn l mo mp">Response.Cookies.Add(cookie);<br/> }<br/>...</span></pre><p id="4342" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">创建一个未将<code class="fe lm ln lo lp b">secure</code>标志设置为<code class="fe lm ln lo lp b">true</code>的cookie。创建cookie时没有将<code class="fe lm ln lo lp b">secure</code>标志设置为<code class="fe lm ln lo lp b">true</code>。</p><p id="faa0" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">在所有新的cookie上设置<code class="fe lm ln lo lp b">Secure</code>标志，以指示浏览器不要明文发送这些cookie。<br/> <strong class="kq iu">举例:</strong></p><pre class="lr ls lt lu gt mh lp mi mj aw mk bi"><span id="eeb0" class="ml jr it lp b gy mm mn l mo mp">...<br/>HttpCookie cookie = new HttpCookie("emailCookie", email);<br/>cookie.Secure = true;<br/>Response.AppendCookie(cookie);</span></pre><h1 id="facf" class="jq jr it bd js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn bi translated"><strong class="ak">我们来讨论一下不通过SSL发送的会话Cookie</strong></h1><p id="4c4c" class="pw-post-body-paragraph ko kp it kq b kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll im bi translated">现代网络浏览器支持每个cookie一个<code class="fe lm ln lo lp b">secure</code>标志。如果设置了标志，浏览器将只通过HTTPS发送cookie。通过未加密的通道发送cookie会使它们暴露于网络嗅探攻击，因此安全标志有助于保持cookie值的机密性。如果cookie包含私有数据或带有会话标识符，这一点尤其重要。</p><p id="272c" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">在这种情况下，在<strong class="kq iu"> Web.config </strong>中创建的会话cookie没有将其安全标志设置为真。</p><p id="a583" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated"><strong class="kq iu">示例:</strong>在下面的示例中，会话cookie将被添加到响应中，而不设置<code class="fe lm ln lo lp b">Secure</code>标志。</p><pre class="lr ls lt lu gt mh lp mi mj aw mk bi"><span id="f7fd" class="ml jr it lp b gy mm mn l mo mp">...<br/>&lt;configuration&gt;<br/>&lt;system.web&gt;<br/>&lt;authentication mode="Forms"&gt;<br/>&lt;forms requireSSL="false" loginUrl="login.aspx"&gt;<br/>&lt;/forms&gt;<br/>&lt;/authentication&gt;<br/>&lt;/system.web&gt;<br/>&lt;/configuration&gt;<br/>...</span></pre><p id="b7b0" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">如果您的应用程序同时使用HTTPS和HTTP，但是没有设置<code class="fe lm ln lo lp b">secure</code>标志，那么在HTTPS请求期间发送的cookies也将在随后的HTTP请求期间发送。对于攻击者来说，通过未加密的无线连接嗅探网络流量是一件轻而易举的事情，因此通过HTTP发送cookiess(尤其是那些带有会话id的cookie)会导致应用程序受损。</p><p id="96e5" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">创建应用程序会话cookie时没有将<code class="fe lm ln lo lp b">secure</code>标志设置为<code class="fe lm ln lo lp b">true</code>。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d92041c0b983765e591d26f3f96c2d4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*Cm5ad8YhCtu4n6YwVmDtLQ.png"/></div></figure><p id="a6a1" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">在所有新的cookie上设置<code class="fe lm ln lo lp b">Secure</code>标志，以指示浏览器不要明文发送这些cookie。<br/> <strong class="kq iu">举例:</strong></p><pre class="lr ls lt lu gt mh lp mi mj aw mk bi"><span id="06f3" class="ml jr it lp b gy mm mn l mo mp">...<br/>&lt;configuration&gt;<br/>&lt;system.web&gt;<br/>&lt;authentication mode="Forms"&gt;<br/>&lt;forms requireSSL="true" loginUrl="login.aspx"&gt;<br/>&lt;/forms&gt;<br/>&lt;/authentication&gt;<br/>&lt;/system.web&gt;<br/>&lt;/configuration&gt;<br/>...</span></pre><p id="5e85" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated">回应。cookies . Add(cookie)；<br/> }</p><p id="11db" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated"><a class="ae mx" href="https://www.patreon.com/mrunal" rel="noopener ugc nofollow" target="_blank">帕特里翁</a>-<a class="ae mx" href="https://www.patreon.com/mrunal" rel="noopener ugc nofollow" target="_blank">https://www.patreon.com/mrunal</a></p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="1777" class="pw-post-body-paragraph ko kp it kq b kr mc kt ku kv md kx ky kz me lb lc ld mf lf lg lh mg lj lk ll im bi translated"><em class="nf">关注</em> <a class="ae mx" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="nf"> Infosec报道</em> </a> <em class="nf">获取更多此类精彩报道。</em></p><div class="ng nh gp gr ni nj"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">信息安全报道</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ma nj"/></div></div></a></div></div></div>    
</body>
</html>