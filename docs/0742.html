<html>
<head>
<title>How I Got Access to Other People’s Medium Accounts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何进入其他人的媒体账户的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-got-access-to-other-peoples-medium-accounts-122d49b7f721?source=collection_archive---------1-----------------------#2020-08-07">https://infosecwriteups.com/how-i-got-access-to-other-peoples-medium-accounts-122d49b7f721?source=collection_archive---------1-----------------------#2020-08-07</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="bc0f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">GitHub搜索、API键和自动化的魔力</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/fc93aca0adf2cc26b47bc719fb88a26c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47VAlRPNZb7XxicH2tYXBg.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">作者照片</figcaption></figure><p id="c762" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">几天前，我发现Medium提供了一个API，每个人都可以请求认证密钥。在等待我的密钥请求被批准时，我在GitHub上搜索是否可以找到意外上传的密钥。令我惊讶的是，我在公共存储库中发现了数百个文件，这些文件包含的数据看起来就像中等认证密钥。事实上，我试的第二把钥匙已经可以用了。在本文中，我描述了恶意用户可以对这些密钥做什么，以及我如何自动完成寻找有效密钥的过程。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lu"><img src="../Images/48aec4069e5d2d94b5799797da4df69a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MeVtb8iKGAhvUKHEQCu2pQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">一个简单的GitHub是找到有效API密钥的第一步(作者供图)。</figcaption></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="3d43" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">介质的API</h1><p id="7c0d" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">有人能用灵媒API的密钥做什么？和往常一样，最好的信息可以在API文档中找到，所以让我们看看<a class="ae mz" href="https://github.com/Medium/medium-api-docs" rel="noopener ugc nofollow" target="_blank"> Medium的API文档</a>。</p><p id="213d" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">正如我们所看到的，这个文档非常短，并且只提供了一些方法。每个请求都发送到<code class="fe na nb nc nd b">api.medium.com</code>并包含HTTP报头<code class="fe na nb nc nd b">Authorization: Bearer &lt;auth key&gt;</code>。第一个请求显然是发送给<code class="fe na nb nc nd b">/v1/me</code>，响应将包含用户的id、姓名和一个到概要文件的链接。这有助于我识别并通知发现钥匙背后的人。</p><p id="4d63" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">一个更关键的方法是请求创建和发布新的帖子或将它们发送到出版物。因为发布文章是Medium的核心功能，拥有另一个人的认证密钥意味着拥有他或她的帐户。</p><p id="f4b2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">API没有提供的一些东西是更改设置或查看私有和敏感信息的选项。我也没有发现查看某人草稿的可能性。当然，我只用自己的账户测试了所有选项。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="302d" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">自动执行关键字搜索</h1><p id="6c68" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">考虑到GitHub向我展示了数百个可能包含有效认证密钥的文件，我认为这可能是一个有趣的小型夜间项目，可以自动搜索有效密钥，识别易受攻击的帐户，并引起所有者的注意。此外，这对我来说是第一次尝试GitHub API的好机会。</p><p id="afbf" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我的方法很简单:首先，我使用GitHub API列出所有包含术语<code class="fe na nb nc nd b">api.medium.com</code>和<code class="fe na nb nc nd b">Bearer</code>的文件。后来我自动化工作的时候，只搜索<code class="fe na nb nc nd b">api.medium.com</code>，导致大量误报。</p><pre class="kj kk kl km gt ne nd nf ng aw nh bi"><span id="fcd4" class="ni md it nd b gy nj nk l nl nm">curl -H "Authorization: token &lt;my token&gt; \<br/>  https://api.github.com/search/code?q=<!-- -->"api.medium.com"+%2B+"Bearer"</span></pre><p id="10e0" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">接下来，我对发现的文件使用regex来查找密钥。因为键有标准格式，65个字符长，所以正则表达式规则非常简单:<code class="fe na nb nc nd b">\w{65}</code>。当然，这会导致更多的误报，但是，在下一步中，所有无效的键都会被过滤掉。</p><p id="0398" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">每次，regex发现一个潜在的结果，我就把它发送给<code class="fe na nb nc nd b">api.medium.com/v1/me</code>,以便验证或反证密钥。如果请求返回时没有错误，我知道密钥是有效的，并且有用户名和到易受攻击帐户的链接。所有这些信息我都存储在SQLite数据库中。</p><p id="1bdc" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">我的最终代码如下所示:</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nn no l"/></div></figure></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="1ddb" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">结果</h1><p id="62a4" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">尽管GitHub列出了数百个文件，但大多数都是误报，因为没有包含认证密钥。此外，即使我的脚本找到了一个密钥，它们几乎都已经被撤销了。API返回的错误消息可以区分无效或被撤销的密钥。</p><p id="fa25" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">总而言之，我只找到了六个功能认证密钥，这比我预期的要少，因为我手动尝试的第二个密钥已经工作正常。然而，这总比通过公开可用的密钥找到数百个易受攻击的帐户要好。此外，我还发现了56把已经作废的钥匙。</p><p id="add6" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">这项研究于6月27日进行。同一天，我联系了所有功能键的所有者，希望他们将它从GitHub中移除或撤销Medium上的键。</p></div><div class="ab cl lv lw hx lx" role="separator"><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma mb"/><span class="ly bw bk lz ma"/></div><div class="im in io ip iq"><h1 id="185b" class="mc md it bd me mf mg mh mi mj mk ml mm jz mn ka mo kc mp kd mq kf mr kg ms mt bi translated">我们能从中学到什么？</h1><p id="2d0c" class="pw-post-body-paragraph ky kz it la b lb mu ju ld le mv jx lg lh mw lj lk ll mx ln lo lp my lr ls lt im bi translated">正如我们所看到的，自动化搜索和测试API键的过程很容易，只需要一个晚上。就我而言，我本可以访问用户账户，并以他们的名义在媒体上发帖。</p><p id="9b3b" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">您应该从本文中吸取的教训是，永远不要将您的API密钥或凭证推送给公共git。虽然在某些情况下，例如，谷歌地图API，危害很小，但也有一些情况下，有人可以接管你的帐户，并通过使用你的API密钥来窃取它。因此，我建议将所有敏感数据放在添加到<code class="fe na nb nc nd b">.gitignore</code>的配置文件中，这样就不会提交给git。这样，就不会有人拿到你的钥匙。</p><p id="4da2" class="pw-post-body-paragraph ky kz it la b lb lc ju ld le lf jx lg lh li lj lk ll lm ln lo lp lq lr ls lt im bi translated">感谢阅读，保管好自己的钥匙！</p></div></div>    
</body>
</html>