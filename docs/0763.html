<html>
<head>
<title>Android Pentesting Lab</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安卓测试实验室</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/android-pentesting-lab-4a6fe1a1d2e0?source=collection_archive---------0-----------------------#2020-08-15">https://infosecwriteups.com/android-pentesting-lab-4a6fe1a1d2e0?source=collection_archive---------0-----------------------#2020-08-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="ed73" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">初学者循序渐进指南！</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/7bd5e0eb6565c0b703673f352a3a677d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6lqaxMLmvIeROL7uqGw5Jg.jpeg"/></div></div></figure><h1 id="c2a3" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">介绍</h1><p id="dfc6" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">作为一个圣灵降临者，在不同的领域发展新的技能是非常重要的，因为你可能会从一种方法中错过一些重要的东西。Android pentesting就是其中之一，但它需要一个专用的环境，我将解释如何设置一个简单的环境。所以让我们开始吧！</p><p id="dc77" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">目录:</strong></p><ul class=""><li id="9943" class="mn mo it lo b lp mi ls mj lv mp lz mq md mr mh ms mt mu mv bi translated">设置android模拟器(Genymotion)</li><li id="32ab" class="mn mo it lo b lp mw ls mx lv my lz mz md na mh ms mt mu mv bi translated">在设备上配置Burp Suite CA证书</li><li id="7010" class="mn mo it lo b lp mw ls mx lv my lz mz md na mh ms mt mu mv bi translated">Frida绕过SSL固定</li><li id="792e" class="mn mo it lo b lp mw ls mx lv my lz mz md na mh ms mt mu mv bi translated">字节码查看器(用于静态分析)</li></ul></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><blockquote class="ni nj nk"><p id="9020" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated">在安装模拟器之前，我建议安装任何基于Linux的发行版或<a class="ae np" href="https://santoku-linux.com/" rel="noopener ugc nofollow" target="_blank"> Santoku </a>，这是专门为移动测试设计的。安装Santoku超出了本文的范围，但是您可以按照本 指南中的<a class="ae np" href="https://santoku-linux.com/howto/installing-santoku/installing-santoku-in-a-virtual-machine/" rel="noopener ugc nofollow" target="_blank"> <strong class="lo iu">进行安装。</strong></a></p></blockquote><h1 id="da69" class="ku kv it bd kw kx ky kz la lb lc ld le jz lf ka lg kc lh kd li kf lj kg lk ll bi translated">1.基因运动</h1><p id="aea7" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">当开始学习时，android模拟器是获得各种具有不同API级别的设备的经验的好方法，而不需要花费太多，免费版本的Genymotion提供了很好的用户体验和易于配置的特性。</p><blockquote class="ni nj nk"><p id="fbc9" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated">注:VirtualBox被genymotion用作核心，虚拟化Android操作系统。因此，请在您的系统中安装VirtualBox以便继续:<a class="ae np" href="https://www.virtualbox.org/wiki/Downloads" rel="noopener ugc nofollow" target="_blank">链接</a></p></blockquote></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="a0a9" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">Genymotion需要用户注册才能使用它的仪表板，首先你需要创建一个帐户:<a class="ae np" href="https://www.genymotion.com/account/create/" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="0327" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">完成注册过程后，从<a class="ae np" href="https://www.genymotion.com/download/" rel="noopener ugc nofollow" target="_blank">这里</a>下载其安装程序，并将其安装在您的主机上。</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="9890" class="nv kv it nr b gy nw nx l ny nz"># Make it executable<br/>$-<strong class="nr iu"> chmod +x genymotion-&lt;version&gt;-linux_x64.bin</strong></span><span id="b171" class="nv kv it nr b gy oa nx l ny nz"># Specify your path, here i am installing in user's home directory<br/>$-<strong class="nr iu"> ./genymotion-&lt;version&gt;-linux_x64.bin -d ~/</strong></span></pre><p id="1d68" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">一旦Genymotion安装完毕，您就可以使用注册过程中指定的凭据登录，并使用其仪表板，如图1所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ob"><img src="../Images/1b4bf53a8857ffd8c3681b8f2685eb5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Kl8_JhE8UE6_udUDVlwEQ.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图一。Genymotion仪表板</figcaption></figure><p id="9d9f" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在这里，我已经安装了两个设备，但是您可以通过单击右上角的加号图标并选择您想要的模板来安装新设备，对于此示例，我将安装三星Galaxy S9 (8.0 — API 26)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi og"><img src="../Images/9fa03f21001248aa9b7dcb737977159d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2XkW_pV2ngN0Fq46cY1gNA.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图二。安装三星galaxy s9</figcaption></figure><h2 id="8fdb" class="nv kv it bd kw oh oi dn la oj ok dp le lv ol om lg lz on oo li md op oq lk or bi translated">配置Genymotion</h2><p id="effd" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">启动装置后，有几件事需要考虑:</p><ul class=""><li id="12dd" class="mn mo it lo b lp mi ls mj lv mp lz mq md mr mh ms mt mu mv bi translated"><strong class="lo iu"> ARM翻译器:</strong></li></ul><p id="8222" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">如果某个应用程序包含ARM本机代码，那么Genymotion将无法运行该应用程序，因为它由x86 (32位)架构组成，并将引发错误。可以通过在仿真设备中安装ARM翻译库来避免这个问题:<a class="ae np" href="https://github.com/m9rco/Genymotion_ARM_Translation" rel="noopener ugc nofollow" target="_blank"> link </a></p><blockquote class="ni nj nk"><p id="f311" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated"><strong class="lo iu">注意:</strong>目前这个库只支持android版本，所以请根据您的仿真设备的规格下载正确的包。</p></blockquote><ul class=""><li id="4858" class="mn mo it lo b lp mi ls mj lv mp lz mq md mr mh ms mt mu mv bi translated"><strong class="lo iu">拯救APK(安卓包):</strong></li></ul><p id="2dcd" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">通过工具栏中的Open Gapps小部件，将目标应用程序安装到仿真设备变得更加容易，如图3所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/43940c7aa249e682dd345167d891bf70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*JsValuEzaaZ-yhQClFMaog.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图3。在genymotion中安装Gapps</figcaption></figure><p id="b007" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">安装后，您可以直接从Play Store下载您的目标应用程序。但是将这个apk保存到主机系统中是有益的，主要有两个原因:</p><ol class=""><li id="32c4" class="mn mo it lo b lp mi ls mj lv mp lz mq md mr mh ot mt mu mv bi translated">无需将相同版本的应用程序下载到具有相同规格的不同仿真设备中。</li><li id="0cc9" class="mn mo it lo b lp mw ls mx lv my lz mz md na mh ot mt mu mv bi translated">反编译程序审查源代码进行静态分析所必需的。</li></ol><p id="844b" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">那么我们如何拯救他们呢？</p><p id="3838" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">通常你有两种方法获得apk，要么从像evozi这样的网站下载，要么使用adb (Android debug bridge)下载</p><blockquote class="ni nj nk"><p id="1105" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated"><strong class="lo iu">注意:</strong> Genymotion已经在它的安装目录中预装了这个工具，我的位于~/genymotion/tools/</p></blockquote><p id="9513" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">出于演示目的，我将使用Twitter Lite应用程序:</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="d886" class="nv kv it nr b gy nw nx l ny nz"># Call package manager (pm) and filter out twitter's package name<br/>$-<strong class="nr iu"> ./adb shell pm list packages | grep twitter</strong></span><span id="08ab" class="nv kv it nr b gy oa nx l ny nz"># Check the absolute path <br/>$-<strong class="nr iu"> ./adb shell pm path com.twitter.android.lite</strong></span><span id="f617" class="nv kv it nr b gy oa nx l ny nz"># Pull apk and rename to twitter_lite.apk<br/>$-<strong class="nr iu"> ./adb pull /data/app/com.twitter.android.lite-somevalue.apk twitter_lite.apk</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ou"><img src="../Images/277f68809e300a2e8e3c9ee218fc288e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJkhBnetEARgX3H6EgSMMw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图4。将apk从Genymotion传输到主机</figcaption></figure><p id="6049" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在只需将这些apk拖放到仿真设备中。</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="774e" class="ku kv it bd kw kx ov kz la lb ow ld le jz ox ka lg kc oy kd li kf oz kg lk ll bi translated">2.打嗝组曲</h1><p id="09d1" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">我假设读者已经安装了burp套件，如果没有，那么只需下载其社区版本:<a class="ae np" href="https://portswigger.net/burp/releases/community/latest/" rel="noopener ugc nofollow" target="_blank">链接</a></p><blockquote class="ni nj nk"><p id="f825" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated">在这里，我将只向你展示如何配置android仿真设备。</p></blockquote><p id="b5cf" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">Android Nougat和更高版本(API &gt;= 24)仅信任系统级CA(证书颁发机构)证书，用于安全通信，尤其是WebView。你可以从这里了解更多:<a class="ae np" href="https://serializethoughts.com/2016/09/10/905" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="bebc" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">因此，绕过这一限制的最简单的方法是安装Burp CA的证书作为系统信任证书，这种方法也将防止我们设置锁定屏幕PIN😎</p><h2 id="79a7" class="nv kv it bd kw oh oi dn la oj ok dp le lv ol om lg lz on oo li md op oq lk or bi translated">步骤:</h2><p id="58ba" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated"><strong class="lo iu"> 1。</strong>将打嗝CA导出为der格式</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pa"><img src="../Images/830ab98fd2e9f242a36c74d6cbae5915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I657DyPfuGe7NZCQ0eN96w.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图5。以der格式导出Burp CA的证书</figcaption></figure><p id="ba50" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu"> 2。</strong>使用<a class="ae np" href="https://github.com/openssl/openssl" rel="noopener ugc nofollow" target="_blank"> Openssl </a>将DER转换为PEM并重命名为&lt;cert-hash&gt;0</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="015d" class="nv kv it nr b gy nw nx l ny nz"># Convert certificate format from DER to PEM<br/>$-<strong class="nr iu"> openssl x509 -inform DER -in cacert.der -out cacert.pem</strong></span><span id="492a" class="nv kv it nr b gy oa nx l ny nz"># Display the "hash" of the certificate subject name<br/>$-<strong class="nr iu"> openssl x509 -inform PEM -subject_hash_old -in cacert.pem | head -1</strong></span><span id="4857" class="nv kv it nr b gy oa nx l ny nz"># Move cert.pem and rename to &lt;hash&gt;.0<br/>$-<strong class="nr iu"> mv cacert.pem 9a5ba575.0</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pb"><img src="../Images/4b0ae0af58758d003d33059560beca0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h80tReXPfhZizarMPYy8aw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图6。使用openssl准备Burp CA</figcaption></figure><blockquote class="ni nj nk"><p id="e73b" class="lm ln nl lo b lp mi ju lr ls mj jx lu nm mk lx ly nn ml mb mc no mm mf mg mh im bi translated">注意:如果你的openssl &lt; 1.0，使用<strong class="lo iu"> -subject_hash </strong></p></blockquote><p id="d1d7" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu"> 3 </strong>。使用adb在仿真设备中移动证书</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="3158" class="nv kv it nr b gy nw nx l ny nz"># Change /system partition into writable mode with remount<br/>$-<strong class="nr iu"> ./adb remount</strong></span><span id="7a42" class="nv kv it nr b gy oa nx l ny nz"># Transfer certificate<br/>$-<strong class="nr iu"> ./adb push 9a5ba575.0 /system/etc/security/cacerts/</strong></span><span id="4f27" class="nv kv it nr b gy oa nx l ny nz"># Change its permissions<br/>$-<strong class="nr iu"> ./adb shell chmod 644 /system/etc/security/cacerts/9a5ba575.0</strong></span><span id="7524" class="nv kv it nr b gy oa nx l ny nz"># Reboot to let changes occur<br/>$-<strong class="nr iu"> ./adb shell reboot</strong></span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/807f06aedd040bf6167c1806f3f37508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*flX9eQ8YjhbtdZQsHZy_Dw.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图7。转移证书</figcaption></figure><p id="f741" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在，您的证书应该安装为系统信任的CA证书，您可以通过导航进行确认:</p><p id="d056" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">设置→安全性和位置→加密和凭证→可信凭证</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pd"><img src="../Images/3dd08457e811aa223f5c0f679e8172e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cwYSkYtmCYqm-zyE8j_L_Q.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图8。确认Burp的证书</figcaption></figure><p id="c58e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu"> 4。</strong>配置burp suite的代理</p><p id="25ea" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">导航到代理→选项→代理监听程序→添加</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pe"><img src="../Images/41781f52d1385d7438ad3ad1b3b2eccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZ5nZACscM90JzxLEV8bxQ.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图9。在Burp中配置代理</figcaption></figure><p id="d15e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">在这里，我将端口8082绑定到我的VirtualBox的接口IP</p><p id="b353" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu"> 5。</strong>在仿真设备上，配置WiFi设置。</p><p id="f757" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">导航到WiFi →长按WiFi名称→修改网络→高级选项→将代理无更改为手动</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/eb6e62bfb70dc35f0db8f4f2840290dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*fduRgDn8GlzTcbMEChMYYQ.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图10。配置WiFi网络</figcaption></figure><p id="78e4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">之后你可以在burp的历史中看到网络流量</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pg"><img src="../Images/f59eca96bde8fd379462a5ab69aeb599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jW74uDwpMXP8CYAYTYitBQ.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图11。拦截流量</figcaption></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="8676" class="ku kv it bd kw kx ov kz la lb ow ld le jz ox ka lg kc oy kd li kf oz kg lk ll bi translated">3.弗里达</h1><p id="9d0c" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">基本上，Frida是一个动态代码工具套件，它允许您动态地将代码片段注入到应用程序的运行过程中，以改变其行为，这正是我们需要绕过SSL锁定的，但现在您可能会想知道这是什么？</p><p id="aea0" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">SSL固定是一种在应用中使用的技术，作为应用流量的附加安全层，以防止MitM(中间人)等攻击，这不允许burp拦截流量，除非我们使用Frida等工具来挂钩绕过此功能的特定代码。</p><p id="6133" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated"><strong class="lo iu">安装</strong></p><ol class=""><li id="683a" class="mn mo it lo b lp mi ls mj lv mp lz mq md mr mh ot mt mu mv bi translated">使用cli在主机中安装带有pip3的frida-tools</li></ol><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="7c4e" class="nv kv it nr b gy nw nx l ny nz">$- <strong class="nr iu">pip3 install frida-tools</strong></span></pre><p id="0419" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">2.只下载x86版本的Frida服务器，因为Genymotion的虚拟设备是基于x86的，您可以如图12所示进行验证。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/7e3882698f653f9b00141aca12d0dedc.png" data-original-src="https://miro.medium.com/v2/resize:fit:908/format:webp/1*xm-WvQG8K9q6kKn-pOC11A.png"/></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图12。三星galaxy s9 (x86) arch</figcaption></figure><p id="707c" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">下载<a class="ae np" href="https://github.com/frida/frida/releases" rel="noopener ugc nofollow" target="_blank">链接</a></p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="ddf9" class="nv kv it nr b gy nw nx l ny nz"># Downloading using wget as an example<br/>$-<strong class="nr iu"> wget </strong><a class="ae np" href="https://github.com/frida/frida/releases/download/12.11.9/frida-server-12.11.9-android-x86.xz" rel="noopener ugc nofollow" target="_blank"><strong class="nr iu">https://github.com/frida/frida/releases/download/&lt;version&gt;/frida-server-&lt;version&gt;-android-x86.xz</strong></a></span><span id="4263" class="nv kv it nr b gy oa nx l ny nz"># Decompress using unxz<br/>$-<strong class="nr iu"> unxz frida-server-&lt;version&gt;-android-x86.xz</strong></span><span id="6f57" class="nv kv it nr b gy oa nx l ny nz"># Rename for ease<br/>$-<strong class="nr iu"> mv frida-server-&lt;version&gt;-x86.xz frida-server</strong></span><span id="161f" class="nv kv it nr b gy oa nx l ny nz"># Transfer into the emulated device using adb<br/>$-<strong class="nr iu"> ./adb push ~/Downloads/frida-server /data/local/tmp</strong></span><span id="0ac8" class="nv kv it nr b gy oa nx l ny nz"># Change its permissions<br/>$-<strong class="nr iu"> ./adb shell chmod 755 /data/local/tmp/frida-server</strong></span><span id="a65a" class="nv kv it nr b gy oa nx l ny nz"># Run Frida-server in the background<br/>$-<strong class="nr iu"> ./adb shell /data/local/tmp/frida-server &amp;</strong></span></pre><p id="fa2e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在，在设置Frida服务器之后，我们将能够使用我们的脚本，但是首先我们需要找到APK的名字，你可以通过任何一种方式找到它</p><pre class="kj kk kl km gt nq nr ns nt aw nu bi"><span id="37b3" class="nv kv it nr b gy nw nx l ny nz"># Old method using pm<br/>$- <strong class="nr iu">./adb shell pm list packages | grep someapp</strong></span><span id="b140" class="nv kv it nr b gy oa nx l ny nz"># Another way using Frida but for this app first need to be started<br/>$- <strong class="nr iu">frida-ps -U | grep someapp</strong></span></pre><p id="a352" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">出于演示目的，我的目标是<strong class="lo iu">s drill</strong>，我使用的是<strong class="lo iu"> </strong> <a class="ae np" href="https://codeshare.frida.re/@sowdust/universal-android-ssl-pinning-bypass-2/" rel="noopener ugc nofollow" target="_blank"> <strong class="lo iu">这个</strong> </a> bypass脚本，只需将它保存到一个js文件中</p><p id="e9f4" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">现在让我们看看Skrill是否抛出了任何SSL错误</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pi"><img src="../Images/8e3deebd6084fa6f91c5d28b534c8053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P4Z0f-GuR-53dKkyQREelg.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图13。Skrill正在使用SSL固定</figcaption></figure><p id="93fe" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">正如预期的那样，现在使用Frida和一个旁路脚本来拦截网络流量</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pj"><img src="../Images/6fd3f3543074ec6f6770e9cef1c437a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6se9VMDFZAd6yUxO_xH8Xg.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图14。旁路成功</figcaption></figure><p id="f732" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">正如你现在看到的，在使用FRIDA成功绕过SSL pin之后，我们可以继续测试😃</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><h1 id="95f9" class="ku kv it bd kw kx ov kz la lb ow ld le jz ox ka lg kc oy kd li kf oz kg lk ll bi translated">4.字节码查看器</h1><p id="cdaa" class="pw-post-body-paragraph lm ln it lo b lp lq ju lr ls lt jx lu lv lw lx ly lz ma mb mc md me mf mg mh im bi translated">静态分析是一个简单的过程，它通过检查应用程序的源代码来了解应用程序的执行情况。然而，反编译它的源代码可能很难，为此有一些反编译程序，如<a class="ae np" href="https://github.com/skylot/jadx" rel="noopener ugc nofollow" target="_blank"> jadx </a></p><p id="a54e" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">但是我个人喜欢<a class="ae np" href="https://github.com/Konloch/bytecode-viewer" rel="noopener ugc nofollow" target="_blank">字节码查看器</a>,因为它有大量不同的Java反编译器、两个字节码编辑器和许多其他特性。</p><p id="ee11" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">下载<a class="ae np" href="https://github.com/konloch/bytecode-viewer/releases" rel="noopener ugc nofollow" target="_blank">链接</a></p><p id="9d45" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">下载后，只需运行反编译程序，将文件拖放到文件部分进行反编译。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pk"><img src="../Images/14c44699f96e1e83cfe9c05a8147503e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XopYxQWjYo5q7Qz2zrLG5Q.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk translated">图15。运行字节码查看器</figcaption></figure></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="f676" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">暂时就这样了😃</p><p id="08d8" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">希望这能消除你的一些疑虑，让你能够创建自己的android实验室。</p><p id="dbc8" class="pw-post-body-paragraph lm ln it lo b lp mi ju lr ls mj jx lu lv mk lx ly lz ml mb mc md mm mf mg mh im bi translated">祝圣灵降临节快乐！</p></div></div>    
</body>
</html>