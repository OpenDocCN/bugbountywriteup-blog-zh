<html>
<head>
<title>Weird and very easy authentication bypass found with Google dorking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奇怪的和非常容易的认证旁路发现与谷歌多金</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/weird-and-very-easy-authentication-bypass-found-with-google-dorking-c13230a038ed?source=collection_archive---------0-----------------------#2021-04-05">https://infosecwriteups.com/weird-and-very-easy-authentication-bypass-found-with-google-dorking-c13230a038ed?source=collection_archive---------0-----------------------#2021-04-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/8240836a9dc6714385b508a954c3e7c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*h7qHTMXB3Psb_ORDNNAIEg.png"/></div></figure><p id="10ff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我将解释我是如何发现认证旁路的，并进一步探索网站的功能，以增加提交的影响。</p><p id="90d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">目标范围很广，而主域没有那么多功能，所以在快速浏览之后，我开始列举子域，并用下面的搜索查询<code class="fe ks kt ku kv b">inurl:redacted</code>进行Google dorking。在谷歌呆呆期间，我发现了以下域名:<code class="fe ks kt ku kv b">redacted.cloud</code>。然后我把搜索范围缩小到了<code class="fe ks kt ku kv b">inurl:redacted.cloud</code>。我用谷歌搜索找到的一个域名，是一个显示类似“正在加载数据…”的网站。我注意到这个网站是用React.js写的，因为React favicon是众所周知的。</p><p id="059d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">几秒钟后，在网站上的数据真正加载之前，浏览器将我重定向到公司的登录门户。因为我没有正确地查看这个站点，所以我决定在一个新的标签页中再次打开它，以便有一个正确的外观。</p><p id="a7b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">令我惊讶的是，这一次所有的数据都加载了，我没有被重定向到登录门户。我并不真正理解为什么会发生这种行为，但是在尝试了一会儿之后，我得出结论，我所要做的就是绕过登录，在一个新的标签页中打开网站。绕过之后，是时候探索这个网站的可能性了。该网站列出了该公司拥有的1902个域名，每个域名都有一个<code class="fe ks kt ku kv b">type</code>、<code class="fe ks kt ku kv b">business owner</code>、<code class="fe ks kt ku kv b">technical owner</code>和<code class="fe ks kt ku kv b">legal entity</code>字段。</p><p id="7704" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过该网站可以编辑这些字段，但不能删除/添加/编辑域。我决定继续四处看看，看看这些行动是否可行。我打开了Burp Suite，查看了编辑域的<code class="fe ks kt ku kv b">type</code>字段时发出的请求。我正在编辑类型的域也在请求体中发送，所以我试着把它改为<code class="fe ks kt ku kv b"><a class="ae kw" href="http://www.grumpinout.be." rel="noopener ugc nofollow" target="_blank">www.grumpinout.be</a></code>。当我刷新页面时，我的域出现在列表中。</p><p id="0bdf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">编辑/添加行的端点是<code class="fe ks kt ku kv b">/update</code>，所以我尝试了下面的端点<code class="fe ks kt ku kv b">/remove</code>来尝试删除我之前添加的行。可惜这个没用，不过之后我又试了一下<code class="fe ks kt ku kv b">/delete</code>，这次成功了！我的域名现在已从列表中删除。</p><p id="38a6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">通过这个网站，我可以下载所有域名的列表，其中一个域名很容易被接管。</p><p id="6c3a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">身份验证绕过提交被标记为高严重性，并在24小时内修复(整个站点和API离线)。对于那些对奖金感兴趣的人，我没有收到任何奖金，因为这个项目没有支付任何奖金。子域接管被标记为中等。</p></div></div>    
</body>
</html>