<html>
<head>
<title>Intercepting HTTP traffic with OpenVPN on Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Android上使用OpenVPN拦截HTTP流量</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/intercepting-http-traffic-with-openvpn-on-android-5835fa40466d?source=collection_archive---------1-----------------------#2022-12-05">https://infosecwriteups.com/intercepting-http-traffic-with-openvpn-on-android-5835fa40466d?source=collection_archive---------1-----------------------#2022-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e964" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">总结</strong></p><p id="002e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们将向您展示如何在Android上拦截HTTP流量。我们的方法基于VPN隧道方法。</p><p id="da7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">免责声明</strong></p><p id="b5b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文仅用于信息和教育目的，并且面向那些愿意并好奇了解安全性和渗透测试的人。内容不得用于非法目的。如果你准备好学习新的好东西，那么继续读下去。</p><p id="846a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">详情</strong></p><p id="70c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Android应用中使用Burp代理拦截HTTP流量不像在传统浏览器web应用中那么容易。在传统的web应用程序中拦截HTTP流量就像用代理服务器配置浏览器一样简单。Android(和iOS)应用没有代理服务器配置。这使得很难将HTTP流量重定向到代理服务器，如Burp Suite。很难，但不是不可能。一般来说，有三种方法可以将流量从移动应用重定向到代理服务器。耶鲁安·贝克尔斯写了一篇出色的文章，解释了iOS的所有三种方法(<a class="ae kl" href="https://blog.nviso.eu/2020/06/12/intercepting-flutter-traffic-on-ios" rel="noopener ugc nofollow" target="_blank">https://blog . nviso . eu/2020/06/12/intercepting-flutter-traffic-on-iOS</a>/)。</p><p id="266d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本文描述了如何在您的移动应用程序和攻击(pentester)机器之间使用VPN连接。此外，我们将展示如何将Burp代理服务器证书传输到移动设备，以及如何为移动设备流量拦截配置Burp代理。</p><p id="7ea9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">POC由1台移动设备和Kali Linux组成:受害者(三星JBOY3乐队)和攻击者机器(Kali Linux 2022.3)。</p><p id="7468" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">受害者:</p><p id="6b84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">—三星JBOY3乐队(安卓5.1，非root)<br/>—IP地址:192.168.43.136</p><p id="e271" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击者(对于Burp代理):<br/> — Kali Linux <br/> — IP地址:192.168.43.136</p><p id="9175" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下部分将向您展示如何在Kali机器上安装OpenVPN服务器，如何在移动设备上安装OpenVPN客户端，如何导入burp代理证书，以及如何使用burp代理拦截HTTP流量。</p><p id="557a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">准备PoC环境</strong></p><p id="ef9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始PoC之前，让我先向您展示一下PoC要求。为了执行这些步骤，您必须:<br/> -使用物理移动设备(Android虚拟设备不可用)<br/> -启用Android开发人员选项<br/> -在Kali攻击者机器和移动设备之间建立TCP连接(例如，两者都连接到同一个Wifi网络或通过USB连接)</p><p id="5a0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本次概念验证中，我们将使用USB连接来建立与Kali主机的TCP连接。您也可以使用WiFi，而不是使用USB连接。在这种情况下，您的移动设备和Kali Linux系统必须连接到同一个WiFi网络。如果您选择使用WiFi网络，可以跳过这一部分，从第7步继续。</p><p id="d8bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.于192.168.43.1执行(受害者，三星JBOY3乐队)。</p><p id="e7dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的移动设备上启用开发者选项。<br/> <br/>进入“设置”<br/>点击“关于设备”或“关于手机”<br/>点击“软件信息”<br/>点击“建立号码”七次。...<br/>可选输入您的模式、PIN或密码以启用开发者选项菜单。<br/>“开发者选项”菜单将出现在您的设置菜单中。<br/><br/><a class="ae kl" href="https://www.samsung.com/uk/support/mobile-devices/how-do-i-turn-on-the-developer-options-menu-on-my-samsung-galaxy-device/" rel="noopener ugc nofollow" target="_blank">https://www . Samsung . com/uk/support/mobile-devices/how-do-I-turn-on-the-developer-options-menu-on-my-Samsung-galaxy-device/</a><br/><br/>注意:这些步骤是针对三星JBOY3乐队设备的。请查看您的供应商网站以获取相关说明。</p><p id="494c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.在192.162.43.1执行(受害者，三星JBOY3乐队)。</p><p id="5658" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在开发者选项中启用USB调试选项。</p><p id="8d85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保“打开”图标上的“开发人员选项”开关(位于右上角)已打开。</p><p id="221c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">轻按USB调试开关将其打开。</p><p id="d2e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.youtube.com/watch?v=-SpUm2_eliA" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=-SpUm2_eliA</a></p><p id="6c69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.在192.162.43.1执行(受害者，三星JBOY3乐队)。</p><p id="1df5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将移动设备连接到Kali攻击者机器的空闲USB端口。选择Linux作为要连接的目标设备。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/924cc729f7eff4166901d25fbf5bb52f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W6NntOWma33Pnf-aWcmA1g.png"/></div></div></figure><p id="733e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="28a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果还没有完成，安装Android调试桥工具。打开Bash终端选项卡并执行:</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="a74e" class="ld le iq kz b be lf lg l lh li">sudo apt install android-tools-adb</span></pre><p id="a6ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="ddfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用adb列出可用设备。你应该看看三星JBOY3乐队设备。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="0835" class="ld le iq kz b be lf lg l lh li">adb devices</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/0ed40f8a773ffb84bfdf14de83410784.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/1*h6Bco5p-a63ROtaxez-Pgg.png"/></div></figure><p id="8305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="6266" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用adb测试对移动设备的外壳访问。尝试使用ping测试我们的Kali攻击(pentesting)机器和互联网的连接性。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="e103" class="ld le iq kz b be lf lg l lh li">adb shell</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/4ddac59842a132b4c8e358216e9d0d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:412/format:webp/1*5IH0__y1HtjaSJbuTQvoMg.png"/></div></figure><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="2ad2" class="ld le iq kz b be lf lg l lh li">ping -c 2 192.168.43.136</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/ba4b665dcad3d86f4dad607dd907d1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*lrQ9nfS1bnfo34xvUjwfoA.png"/></div></figure><p id="47bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">总结</strong> <br/>我们将受害者设备(三星JBOY3乐队)通过USB连接到我们的Kali机器。该设备与我们的Kali攻击者机器有TCP连接。</p><p id="fa8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PoC安装OpenVPN服务器</strong></p><p id="18bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经具备了在Kali pen测试机和移动设备之间设置VPN的所有要求。</p><p id="90c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="d6ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安装OpenVPN服务器。我们将使用耶鲁安·贝克尔斯的安装脚本。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="525d" class="ld le iq kz b be lf lg l lh li">wget https://git.io/vpn -O openvpn-install.sh<br/>sed -i "$(($(grep -ni "debian is too old" openvpn-install.sh | cut  -d : -f 1)+1))d" ./openvpn-install.sh<br/>chmod +x openvpn-install.sh <br/>sudo ./openvpn-install.sh</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lm"><img src="../Images/af372be7cef3b2f179f0b0669b5fe71c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rno6ygX7jpsYkv2uBd2qrQ.png"/></div></div></figure><p id="b120" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="84aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OpenVPN安装脚本向导:选择连接到互联网的网络设备。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/61aa38da79a7c413b967229ab542fde4.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*3DP-_2wzPew1ld9Mg6Xs1Q.png"/></div></figure><p id="caf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">9.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="85e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OpenVPN安装脚本向导:键入终止VPN的ip地址。在我们的例子中，它是ip地址192.168.43.136。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/0287b39cc2d23f591f64e77407e26d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*pzAfTmo3t2ivXWF4oQmFAA.png"/></div></figure><p id="bbf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">10.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="6fb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OpenVPN安装脚本向导:选择UDP作为首选协议。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/2d256c3de547a4c6f701d4dda4948c36.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*2I6Fg_x-7ZQz_j2ObT6-cA.png"/></div></figure><p id="ba5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">11.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="5a98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OpenVPN安装脚本向导:我们将为接下来的选项使用默认设置。按ENTER键输入端口规格、系统解析器和客户端名称。按任意键继续…</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/f24914227b6f335ea199e39d6c95c697.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*R7wP76z6u3pWC43FAonx1Q.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/a8e4b88cdfd7a1b84bb8a10fae2241ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Fy-JESnnX9vxpYvBiXp2Q.png"/></div></div></figure><p id="2e2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经安装了VPN服务器。我们的客户机概要文件存储在/root/client.ovpn。</p><p id="ea2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">12.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="9dd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">启动OpenVPN服务</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="5082" class="ld le iq kz b be lf lg l lh li">sudo service openvpn start</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/5640c254ac96313987032e2b325e4c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*jqufTMObyE4_IGoK2pqPYw.png"/></div></figure><p id="7128" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的OpenVPN服务器现在已经启动并运行。是时候在我们的移动设备上安装OpenVPN客户端软件了。</p><p id="a29e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PoC安装OpenVPN客户端</strong></p><p id="2c0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在接下来的部分中，我们将把文件从Kali Linux机器复制到您的移动设备上。它涉及以下文件:</p><ul class=""><li id="62f2" class="ls lt iq jp b jq jr ju jv jy lu kc lv kg lw kk lx ly lz ma bi translated">client . ovpn(OpenVPN profile)<br/>-OpenVPN-connect-3-3-0 . apk(OpenVPN客户端软件)<br/> - cert-pro.cer (Burp Suite服务器证书)</li></ul><p id="ca2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一节中的步骤基于在您的移动设备和Kali Linux系统之间使用USB连接。如前所述，不需要USB连接。也可以使用共享的WiFi网络。当使用WifI网络时，将文件放在Kali Linux系统上的/tmp目录中，并通过临时http服务器(<em class="mb">python 3-m http . server 80—directory/tmp</em>)为该目录提供服务，就可以将必要的文件复制到移动设备上。然后，可以使用现有的网络浏览器从移动设备下载所需的文件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mc"><img src="../Images/f015df4309685ae2714a7765ae9742ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*C-76fzFoFywf6ox7Lm7Qow.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">三星JBOY3乐队公司可访问http://192.168.43.136</figcaption></figure><p id="faef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">13.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="a0c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用adb将配置文件client.ovpn复制到我们的Android设备的sdcard中。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="c9b5" class="ld le iq kz b be lf lg l lh li">sudo cp /root/client.ovpn /tmp<br/>adb push /tmp/client.ovpn /sdcard/Download/client.ovpn</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mh"><img src="../Images/4f433ee29ca652a81a45805391ba3166.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*DW6BMW5WAk1-qxiz3vZ7uQ.png"/></div></div></figure><p id="a93e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">14.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="f4c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载OpenVPN客户端*。apk安装包。打开网页浏览器(Firefox)并导航至:<a class="ae kl" href="https://openvpn-connect.en.uptodown.com/android/download" rel="noopener ugc nofollow" target="_blank">https://openvpn-connect.en.uptodown.com/android/download</a>。点击绿色的[下载]按钮。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/c22ce83b2972f2ab628b8df3da6af02f.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*a-Bf9TdD3gHeZ_v8nVF22g.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">来源:<a class="ae kl" href="https://openvpn.net/community-downloads/" rel="noopener ugc nofollow" target="_blank">https://openvpn.net/community-downloads/</a></figcaption></figure><p id="8445" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将下载的apk文件移动到/tmp。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="18b3" class="ld le iq kz b be lf lg l lh li">mv ~/Downloads/openvpn-connect-3–3–0.apk /tmp</span></pre><p id="a9ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">15.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="5bc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用adb在我们的Android设备上安装openvpn-connect-3–3–0 . apk。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="dc57" class="ld le iq kz b be lf lg l lh li">adb install /tmp/openvpn-connect-3–3–0.apk</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mi"><img src="../Images/49c441d9108b391a9e598fc7c5751b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHqyeT47atxZ5kIkzMh-5w.png"/></div></div></figure><p id="6f0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">16.于192.168.43.1执行(受害者，三星JBOY3乐队)。</p><p id="8c76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开内置的文件浏览器应用程序，浏览到/sdcard/Downloads/client.ovpn。</p><p id="a98f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击client.ovpn并安装OpenVPN配置文件。继续安装步骤。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/3ebfd14dafe6c41f2f13beaabc7985fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*i9tgyrK07eUezCGYr5vDRA.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">点击[同意]</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/649f180a02cd650bebab8a8233a1460e.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*iO-ZlS8x-hiHT0sEb59spQ.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">单击[确定]</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/ded80cea45739147020bfed9d421821c.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*Yr4LmGxDMqGVQd17_d_lhQ.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">单击[添加]</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/b79e4710597eff076df0afcfce6b2bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*LoX66xPoxsAkaiJs93ugKw.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">我们在移动设备和Kali Linux之间建立了成功的VPN隧道</figcaption></figure><p id="f98f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在移动设备和Kali攻击者机器之间有一个成功的VPN隧道。从现在开始，我们能够拦截来自Android设备的流量。为了使用Burp代理进行HTTPS拦截，我们仍然需要导入Burp代理服务器证书。</p><p id="7d4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PoC安装Burp服务器证书</strong></p><p id="de83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">17.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="2aeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开始打嗝社区版。保留默认代理设置(127.0.0.1:8080)。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mn"><img src="../Images/9bb09629009ddf8d435bd8d84fd43506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zY7qWe4_KArpnI1EpsoT1Q.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">单击“下一步”在TCP端口8080上开始Burp侦听。</figcaption></figure><p id="4caa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">18.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="eb69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用wget下载Burp服务器证书。重要提示:证书文件需要*。cer扩展。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="6492" class="ld le iq kz b be lf lg l lh li">wget http://127.0.0.1:8080/cert -O /tmp/cert-pro.cer</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/a720d57d71936d412a2b77104e8b7df8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poUpiuQXCjDvA7H9XF7Z9Q.png"/></div></div></figure><p id="d98a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">19.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="b6a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用adb将Burp证书(cert-pro.cer)复制到我们Android设备的sdcard中。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="6b4c" class="ld le iq kz b be lf lg l lh li">adb push /tmp/cert-pro.cer sdcard/Download/cert-pro.cer</span></pre><p id="bb67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">20.于192.168.43.1执行(受害者，三星JBOY3乐队)。</p><p id="643d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的移动设备上安装Burp证书。</p><p id="1313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开内置的文件浏览器应用程序，浏览到/sdcard/Downloads/cert-pro.cer。检查是否选择了“用于VPN和应用程序”。点击cert-pro.cer并导入服务器证书。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/cb59a53ca273854c3dd768315d7b0194.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*yjZY_2y0lsYAfw3MZO-JDA.png"/></div></figure><p id="400b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">21.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="3404" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">配置Burp代理监听所有接口。转到代理&gt;选项&gt;选择接口&gt;[编辑]&gt;选项卡绑定；选择“所有接口”。单击[确定]</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mo"><img src="../Images/380313a0d8deb9ff5fc68ac0ac06b80c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-yrvzKXRrDxXtDZUUm_2VQ.png"/></div></div></figure><p id="6b5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">22.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="7529" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将Burp代理配置为使用“不可见代理”。转到代理&gt;选项&gt;选择接口&gt;[编辑]&gt;选项卡上的请求处理；选择“支持隐形代理”。单击[确定]。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mp"><img src="../Images/35e3582ab2c9b9ac3a5003b1c7405d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xP8Pzn4B0SbFtoS19TT6A.png"/></div></div></figure><p id="f10a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">23.在192.168.43.136上执行(攻击者机器，Kali Linux)。</p><p id="1f8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">配置iptables将端口80和443上的传入流量重定向到监听端口8080的Burp代理。</p><pre class="kn ko kp kq gt ky kz la bn lb lc bi"><span id="ad74" class="ld le iq kz b be lf lg l lh li">sudo iptables -t nat -A PREROUTING -i tun0 -p tcp - dport 80 -j REDIRECT - to-port 8080<br/>sudo iptables -t nat -A PREROUTING -i tun0 -p tcp - dport 443 -j REDIRECT - to-port 8080</span></pre><p id="c866" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> PoC使用手机应用拦截流量</strong></p><p id="5c3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">24.于192.168.43.1执行(受害者，三星JBOY3乐队)。</p><p id="53dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您现在已经准备好拦截来自您的移动应用程序的HTTP流量。出于演示目的，我们将使用荷兰公司Talpa拥有的Radio10应用程序。您可以使用任何其他通过TCP端口80或443进行HTTP通信的应用程序。你<strong class="jp ir">不允许</strong>使用这个应用程序进行实际的笔测试或任何(其他)误用它的方式。请首先咨询Talpa关于他们的bug赏金计划和负责任的披露。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/2f2d31d39f95c110ec66296a76abdb9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/1*OPrmXigfOwQad8AZdKiM7Q.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/ca91baf71b7475bc8866351e44d707e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NzWY6I8SQCT6_g37kGGFQ.png"/></div></div></figure><p id="697a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你所看到的，我们从移动应用中获得了流量。用户代理被识别为okhttp/4.4.1。</p><p id="511e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！我希望你喜欢它。在我的下一篇博客中，我将向你展示一些你可以用Burp Suite做的有趣的事情。</p><p id="69a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">感谢</strong><br/>——耶鲁安·贝克尔斯出色的OpenVPN安装脚本。</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h2 id="be3a" class="my le iq bd mz na nb dn nc nd ne dp nf jy ng nh ni kc nj nk nl kg nm nn no np bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>