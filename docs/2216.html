<html>
<head>
<title>How these Crypto Hackers earned a $5000 Bug Bounty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这些加密黑客如何获得5000美元的Bug奖金</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-a-race-condition-made-these-crypto-hackers-5000-bug-bounty-a72158a472a8?source=collection_archive---------1-----------------------#2022-07-27">https://infosecwriteups.com/how-a-race-condition-made-these-crypto-hackers-5000-bug-bounty-a72158a472a8?source=collection_archive---------1-----------------------#2022-07-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="dc1c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">故事的寓意——测试并发请求</h2></div><h1 id="7522" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">什么是竞争条件？</h1><p id="7309" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">当两个线程或进程试图同时访问同一个资源时，就会出现<a class="ae lw" href="https://en.wikipedia.org/wiki/Race_condition" rel="noopener ugc nofollow" target="_blank">竞争情况</a>。具体会发生什么取决于机器、CPU、编译器等等。，并且行为并不总是确定的。本质上，这完全取决于操作顺序改变时<a class="ae lw" href="https://en.wikipedia.org/wiki/Context_switch" rel="noopener ugc nofollow" target="_blank">上下文切换</a>的时机。例如，如果一个用户从500美元的余额开始，然后线程<code class="fe lx ly lz ma b">A</code>处理1000美元的存款，线程<code class="fe lx ly lz ma b">B</code>处理500美元的取款，我们应该期望总共1000美元。然而，如果操作顺序是这样的，即<code class="fe lx ly lz ma b">A</code>和<code class="fe lx ly lz ma b">B</code>都读取到有$500，<code class="fe lx ly lz ma b">A</code>更新<code class="fe lx ly lz ma b">500 + 1000</code>，然后B更新<code class="fe lx ly lz ma b">500 — 500</code>，则用户剩下$0！相反，如果<code class="fe lx ly lz ma b">A</code>第二名，你可以期望用户得到1500美元！</p><p id="e8c3" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">现在，这里有一个现实生活中的例子，两个黑客，<a class="mg mh ep" href="https://medium.com/u/6f816e37be2c?source=post_page-----a72158a472a8--------------------------------" rel="noopener" target="_blank"> HackerOne </a>用户@cyberboy和@z0mb13，发现了一个竞赛条件，使他们获得了<strong class="lc iu">5000美元的奖金</strong>。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mi"><img src="../Images/307193fffd81dcee9ed1d91d6bec9f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1GNNKBCcGYoA0T326fS-4A.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">人工智能生成的图像“比特币窃贼插图”，作者craiyon.com</figcaption></figure><h1 id="364f" class="ki kj it bd kk kl km kn ko kp kq kr ks jz kt ka ku kc kv kd kw kf kx kg ky kz bi translated">利用</h1><p id="5dbe" class="pw-post-body-paragraph la lb it lc b ld le ju lf lg lh jx li lj lk ll lm ln lo lp lq lr ls lt lu lv im bi translated">完整披露的原始报告可以在HackerOne 找到<a class="ae lw" href="https://hackerone.com/reports/1438052" rel="noopener ugc nofollow" target="_blank">。这个bug是在一个叫</a><a class="ae lw" href="https://blog.cosmos.network/learn-to-build-your-own-blockchain-with-the-starport-community-call-50fc32df92e7" rel="noopener ugc nofollow" target="_blank"> Starpor </a> t. <em class="my">的平台上发现的:这里可以找到</em> <a class="ae lw" href="https://github.com/ignite/cli/tree/7812125a7e96f4b0cb1da62766c6e96e56fc4f5b" rel="noopener ugc nofollow" target="_blank"> <em class="my"> Github回购</em> </a>。Starport是“构建区块链<em class="my">、</em>最简单的方法，是基于<a class="ae lw" href="https://cosmos.network/" rel="noopener ugc nofollow" target="_blank"> Cosmos SDK </a>构建的(引用来源:<a class="ae lw" href="https://github.com/ignite/cli/tree/7812125a7e96f4b0cb1da62766c6e96e56fc4f5b" rel="noopener ugc nofollow" target="_blank"><em class="my">Github repo</em></a><em class="my">)。</em>根据Cosmos网站，截至2022年7月26日，基于Cosmos构建的代币市值超过<strong class="lc iu">530亿美元</strong>，其中最引人注目的是<strong class="lc iu"> </strong>币安币。那是一大笔钱。</p><p id="bdca" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">用户@cyberboy和@z0mb13在<a class="ae lw" href="https://coinmarketcap.com/alexandria/article/what-is-a-crypto-faucet" rel="noopener ugc nofollow" target="_blank">加密龙头</a>的Starport实现中发现了竞态条件。我不是加密方面的专家，但我的理解是，加密龙头是一个应用程序，奖励用户一定数量的令牌，以换取完成任务。本质上，代币是免费发放的。下面是<a class="ae lw" href="https://coinmarketcap.com/alexandria/article/what-is-a-crypto-faucet" rel="noopener ugc nofollow" target="_blank">好链接</a>进一步了解。</p><p id="b6af" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">在Starport实现中，构建者可以设置水龙头奖励的最大令牌数。这样做的目的是为了让用户在每个任务中只能获得一定数量的最大令牌。在PoC中，我们的黑客将max设置为11，每个POST请求发送5个令牌。</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mz"><img src="../Images/e72b08908c2952634a19ffd13d182d0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnqGpjH71ht9vLwQEzOdYg.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">最大令牌数设置为11(来源:<a class="ae lw" href="https://hackerone.com/reports/1438052" rel="noopener ugc nofollow" target="_blank">黑客龙</a>)</figcaption></figure><p id="3516" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">两人发送了两个POST请求，向Alice的账户进行两次转账。现在，爱丽丝的账户上有了10个代币，这两个人应该不能再向爱丽丝的账户发送更多的请求了。<em class="my">注:这和我们在</em><a class="ae lw" rel="noopener ugc nofollow" target="_blank" href="/this-is-why-you-should-always-check-for-race-conditions-even-in-javascript-410b6021ad1a"><em class="my">HTB·提奥奇尼斯之怒</em> </a> <em class="my">上的利用一模一样。</em>然而，两人同时发送了50个请求…</p><figure class="mj mk ml mm gt mn gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi na"><img src="../Images/85806c4ba3064ddeb12d474c3580165f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oPYf4hQZOLWPyo43w7rqNA.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">张贴5个令牌的请求(来源:<a class="ae lw" href="https://hackerone.com/reports/1438052" rel="noopener ugc nofollow" target="_blank"> HackerOne </a></figcaption></figure><p id="9383" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">答对了。团队发现爱丽丝的账户有30个代币，而不是10个。这个bug的含义是，用户可以在任何基于Starport服务的水龙头应用程序上提取更多的“免费”令牌，这意味着理论上许多加密令牌开发者可以使用令牌。这被证明是一个巨大而危险的比赛条件，其<strong class="lc iu">严重等级为9.3 </strong>！！！同样，请在这里阅读<a class="ae lw" href="https://hackerone.com/reports/1438052" rel="noopener ugc nofollow" target="_blank"> H1的原始报告，在这里</a>阅读<a class="ae lw" href="https://github.com/ignite/cli/issues/1965" rel="noopener ugc nofollow" target="_blank">最初的Github问题以查看源代码。</a></p><p id="3091" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated">@cyberboy和@z0mb13再次完成了令人难以置信的工作，祝贺你获得5000美元奖金。感谢您通读，请在下面留下任何建设性的反馈、建议或问题！如果你喜欢，请考虑跟随我。在roberto.cyberkid@gmail.com联系我，在twitter上关注我，在LinkedIn上联系我！</p></div><div class="ab cl nb nc hx nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="im in io ip iq"><p id="c6f0" class="pw-post-body-paragraph la lb it lc b ld mb ju lf lg mc jx li lj md ll lm ln me lp lq lr mf lt lu lv im bi translated"><em class="my">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。加入我们的每周简讯，以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em><a class="ae lw" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"><em class="my">https://weekly.infosecwriteups.com/</em></a></p></div></div>    
</body>
</html>