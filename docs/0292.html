<html>
<head>
<title>Banner Grabbing to DoS and Memory Corruption</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">横幅抓取到DoS和内存损坏</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/banner-grabbing-to-dos-and-memory-corruption-2442b1c25bbb?source=collection_archive---------0-----------------------#2019-04-16">https://infosecwriteups.com/banner-grabbing-to-dos-and-memory-corruption-2442b1c25bbb?source=collection_archive---------0-----------------------#2019-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4938" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">朋友们好，</p><p id="ae80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很抱歉我的缺席，这些天我一直在努力工作，但我在这里，为我们的社区做出我的贡献。今天的主题是关于我在一家公司遇到的一个漏洞，我私下运行了Pentest，在那里我在它的各种* .subdomains.com中发现了一个IIS服务器，这个特定的服务器有两个CVE。</p><p id="0799" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现分享有趣的是，在我的bug赏金之旅的开始，我过去常常报告低“悬挂的果实”,甚至没有试图利用它们，例如，抓横幅。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/2df0443f1bef49dd965387cf0c1a17c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zUl-gmJpwSLBsJSXhqSwng.png"/></div></div></figure><p id="8c8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在上面的图片中所看到的，通常抓取横幅本身会被视为低影响，您的报告很可能会被视为信息性报告。随着时间的推移，你获得了更多的知识，你的方法发生了变化，你开始改善看待目标的方式，说到这里，让我们开始吧:</p><p id="80da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">抢横幅和虫子赏金</strong></p><p id="4be1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">标题抓取是一个收集网络上任何远程PC及其开放端口上运行的服务的详细信息的过程。攻击者可以利用横幅抓取来发现网络主机，并在其开放端口和操作系统上运行带有其版本的服务，这样他就可以利用它。</p><p id="a4d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要对此产生重大影响，请检查显示横幅的活动主机列表，记下它们，并开始查找版本的漏洞。一些简单的东西，但初学者很少实践，他们通常报告低影响vuln，而不想深入到足够成为关键。</p><p id="6566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从抢横幅到DoS和内存崩溃</strong></p><p id="e119" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将一步一步地向你展示我如何利用互联网上传播的漏洞来改造DoS和内存崩溃中的横幅抓取。该公司(当时不允许透露身份，我们称之为redacted)有几个子域名，其中许多都暴露了他们的横幅，包括ssh、ftp等端口，但我的重点将放在端口80 (http)上，在那里他们使用了内部票证系统。</p><p id="2d8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">发现:</strong></p><p id="983b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用下面的nmap命令来检查可以在下一次接近目标时帮助我的标语</p><blockquote class="kx ky kz"><p id="dfed" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">nmap</strong><strong class="jp ir">-Pn</strong><strong class="jp ir">-p</strong><strong class="jp ir">80，443</strong><strong class="jp ir">-sV</strong>—<strong class="jp ir">script = banner</strong><strong class="jp ir">-iL all _ subdomains . txt</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/1673b2f431d17c2263c98e005fc7bcfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15GFVDO9UJjTeQ4PwlHcQw.png"/></div></div></figure><p id="a5f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于不想使用nmap的用户，可以通过CURL来完成这项检查:</p><blockquote class="kx ky kz"><p id="20da" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><strong class="jp ir">卷曲</strong><strong class="jp ir">-s</strong><strong class="jp ir">-I</strong><strong class="jp ir">192 . 168 . 0 . 100 |</strong><strong class="jp ir">grep</strong><strong class="jp ir">-e</strong><strong class="jp ir">服务器:“</strong></p></blockquote><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/dee038af22199b6cf28efe141480f3b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XdSURy0JUePQS4rl035Otg.png"/></div></div></figure><p id="1d7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">修订后的公司在其范围内允许DoS，因为我在本地为它工作，很容易与基础设施团队取得联系，报告这方面的一些关键缺陷。记住IIS服务器，在快速搜索中，我发现在微软服务器(MS15–034)上执行DoS的攻击并不广泛，你可以在这里阅读更多关于该漏洞的信息。</p><p id="9464" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">检测漏洞:</strong></p><p id="ff06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过在HTTP请求中指定范围标题，可以触发此漏洞。易受攻击的安装程序将响应HTTP 416请求的范围不可满足错误。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/4f70bdb0624c2dc350961472492875cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QAhEhvlJ-e9BrHwFOiu0NQ.png"/></div></div></figure><p id="03f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我真的得到了这个错误吗？太好了！</p><p id="3f38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按照上面链接的指导，我只需要指定有效的文件和100的字节范围，结果它让我看到一个蓝屏，这意味着… DoS！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/023b83cd7f3db5457f672123d5fd11b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPulDORNxdK7CA8rO6D9VQ.png"/></div></div></figure><p id="b4ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">记住</strong>，在处理一个bounty bug中的DoS时，检查这种类型的vuln是否被允许，如果不被允许，你仍然发现它是相关的，适当地与团队沟通，我上面所做的是由公司的负责团队陪同的。</p><p id="abf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有时，同一个版本可能有多个关键漏洞，此IIS服务器就是这种情况，之前已经知道可以运行内存转储，让我们看看结果如何:</p><p id="bf50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">等等，内存转储？</strong></p><p id="d43b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何让您破坏服务器内存的行为都有可能导致远程代码执行。至少，它让你崩溃进程或操作系统。我们有一个针对这个IIS漏洞的metasploit模块(总是使用搜索选项在那里检查)</p><p id="762e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">设置metasploit模块</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/09e4594d25cefca7e84f0e4093fdf306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E4SgQ1mQjR7lrlgXieMWTQ.png"/></div></div></figure><p id="f100" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/cf4a22a05d0cff865ece17d2883d153d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*FeDY30Oxt2TWMpEuW2c0RA.png"/></div></figure><p id="82a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">屏幕很漂亮，但是…在我执行转储时没有“关键”数据，尽管如此，漏洞被成功确认，这就足够了:)</p><p id="10a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">IIS链接<a class="ae lg" href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/ms15_034_http_sys_memory_dump" rel="noopener ugc nofollow" target="_blank">的Metasploit内存转储模块此处</a>。</p><p id="876d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">要点:</strong></p><p id="4536" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你所观察到的，我试图更多地关注初学者社区，展示如何以不同的方式寻找那些非常常见的低影响漏洞。我希望我在某种程度上有所贡献，正如我向你们所有人学习一样。黑客快乐！</p><p id="086e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢，现在我有一个<a class="ae lg" href="https://twitter.com/danielv47251669" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> twitter </strong> </a>这样我们也可以在那里分享知识。</p><p id="7c75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里找到我<a class="ae lg" href="https://www.linkedin.com/in/daniel-morais-968463120/" rel="noopener ugc nofollow" target="_blank"/>。</p></div></div>    
</body>
</html>