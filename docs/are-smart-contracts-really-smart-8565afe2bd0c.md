# 智能合约真的智能吗？

> 原文：<https://infosecwriteups.com/are-smart-contracts-really-smart-8565afe2bd0c?source=collection_archive---------1----------------------->

![](img/cb83b91036e37bb98019b3e401861416.png)

# 智能合同

好吧，说到合同，我们都知道合法的合同是如何运作的。所以，让我们举一个例子，一个人买了东西，作为回报，必须签署财产的法律文件，这涉及到承包商，银行家，律师，业主，然后是你。嗯，我可以说，如果你想缩短它，让它超级快速和可靠，一个超级合同是你需要的。

超级契约是一种代码，它作为合法契约的替代物，帮助我们不要与许多人打交道(令人兴奋吧？).超级合同是一堆编入区块链的代码，其中包括整个法律合同的条款和条件，我们不必担心信任法律系统、法院、律师，甚至我可以说是所有者本身。基本上，它充当两个法律程序之间的协议。

> ***我们先来了解一下区块链究竟是什么？***

因此，我们可以说，智能合约的整个理念是基于区块链技术。

锁链是一项超酷的技术，我们可以用这种方式存储和记录信息，黑客几乎不可能窃取、更改甚至欺骗整个系统。

> ***区块链作品中这 3 个要素:***

![](img/c4e716c4297707306516cfb8f767c5fb.png)

说到区块链，2009 年，第一种分散式加密货币比特币是由一位名叫中本聪(SATOSHI NAKAMOTO)的开发者发现的。据说区块链技术早在 1991 年就已经提出，但实际上是作为第一个加密货币比特币的公共交易账本。

更简单地说，我们可以说比特币是区块链技术发明的加密货币。

> ***加密货币？加密货币和区块链有什么关系？***

让我们以埃隆·马斯克的一条推文为例，让它变得有趣而简单，这条推文太令人困惑，人们无法理解。

![](img/d4913d788b216d5584c045e7d792d4fa.png)![](img/e37a76c1925c3ffb99c8d6fd678c208b.png)![](img/824e661b936656cb8fa0cd7a2a01640e.png)![](img/d04f273eb225619a522add841752d36e.png)![](img/16d4ff92a10f113945e6ddca211ec46b.png)

这是智能合约、区块链和加密货币的预告片！✅

> *前进到更令人兴奋的部分，我们将讨论并证明“不要恨黑客，要恨代码！”绝对是真的。*

***“每个故事都有两面性*”**

这是最精彩的部分！现在让我们跳到**不好的部分！**

在这一部分，我们将了解智能合同为什么以及如何遭到黑客攻击！😎

在智能合同中，我们需要信任的最重要的东西是合同的代码。当代码被编程到区块链中时，它有自己的位置，不能被改变，但问题是，智能合同类似于任何其他公开的开源代码，甚至安全程序也邀请黑客来——发现并报告其中的错误。而智能合约中的代码与认证、防火墙、缓解风险等无关。这表明，当开发人员的代码是 noob 时，智能合同确实会被黑客攻击。根据这项研究，以太坊(第二大加密货币平台)智能合约容易受到黑客攻击:即 400 万美元的以太网面临风险。同样来自 2021 新闻报道，智能合约→bug 让黑客盗取 3100 万美元数字币。

**是的！这太疯狂了。**

> ***现在，让我们来发现黑客入侵 noob 代码的漏洞！***

**渗透测试**是 ***如何保护智能合约*** *的终极答案。*渗透测试是指发起有意的模拟网络攻击，帮助公司发现漏洞和弱点，并最终在漏洞公开之前通过减少漏洞使开发者变得专业。

因为这对开发者来说是最终的双赢局面。😁

S mart 契约主要处理金融资产的漏洞，如:

> **以下是智能合同中的五大漏洞趋势:**

## ***1。可重入:***

→也称为未知调用、递归漏洞和清空竞争。这也是最著名的以太坊漏洞，它甚至导致了数百万美元的损失。

可重入仅仅意味着攻击者被允许进入契约的中间，并在执行完成之前进行新的调用。最有趣的是，它可以改变可信契约的状态，并导致调用不可信契约。

黑客知道如何玩我们可爱的开发者使用的功能。

**例如:**

1.  *功能用于允许用户取回资金。现在，黑客将使用相同的功能来制定恶意合同，并取回全部资金。*
2.  ****fallback()*** 函数在恶意代码中被用来接受资金然后通过使用 ***withdraw()*** 函数回调成受害者合约。*

*![](img/74c870255dbeb74b79c5d5117fade997.png)*

****恶意代码取回资金。****

1.  *现在，像 **call()** 这样的函数向发送方发送以太网，如果发送方是智能合同，他将使用其回退函数触发所有交易和资金。*

## ***2。访问控制***

*访问控制是一个常见的漏洞，在大多数 web 和 android 应用程序中都存在。因为该漏洞的真正动机是绕过认证系统，通过 pin、密码、安全令牌、生物特征扫描等获得未经授权的访问。在智能合同中，访问控制漏洞是糟糕和不安全的编码实践，它提供了对合同的私有条款和条件、值、逻辑、资金等的直接访问。这是通过使用承包商的公共和外部功能来实现的。*

*![](img/04d5673ebb41e15c8ad50ddb5a65738c.png)*

**init contract()函数仅仅意味着它将这个人设置为所有者**

***理解代码:***

1.  *所有者创建智能合同，并授予提取资金的特殊权限。*
2.  *现在，使用***initial ization()***函数授予该特殊访问权限。*
3.  *但是，这个函数可以被任何人调用，即使这个函数已经被调用过一次也没关系。*
4.  *这是悲剧性的，因为它允许任何人成为合同的所有者，并拿走所有的资金。*

## *3.时间操纵:*

*所有者可以在特定时间锁定和解锁资金。这是通过使用 block.timestamp 来完成的，但是谁来给出所有的值呢？矿工。*

***但是，矿工是什么？***

*→比特币矿工就是计算用品高级的人。比特币矿工竞相成为第一个验证比特币承诺的人，并获得以比特币支付的奖励。他们是所有者，也有责任确认交易是否真实。*

*矿工有能力操纵时间，攻击或利用智能合同。矿工通常这样做是为了赢得以太作为回报。*

***例如:***

1.  *矿工可以使用 *block.timestamp* 来设置午夜的时间，以便赢得游戏。*
2.  *现在离午夜只有几秒钟了，minner 通过使用 block.timestamp 结束挖掘块。这是他/她赢得比赛的方法。*

***构建简单游戏的例子:***

*![](img/717f12df3fc5cc506bfc4f2a8d42469b.png)*

*代码示例*

***理解代码:***

1.  *现在为了赢得游戏，矿工可以发送 1 以太并调用旋转 ***函数()*** 。*
2.  *之后，矿工可以发送 ***块。时间戳*** 以提交可被 7 整除的下一个块*
3.  *现在，如果矿工赢得了区块，他就赢得了所有的以太。*
4.  *最终对 minner 来说，这将是一个双赢的时刻。*

## *4.未检查的返回值:*

*你应该避免调用像“call”这样的低级函数，因为万一你不擅长处理它们，会导致意想不到的行为。*

*底层函数包括: ***call()、callcode()、delegatecall()* 和 *send()*** *。**

*这些错误与不同的实度函数截然不同，因为它们现在可能不再传播(或冒泡),并且现在可能不再导致尖端执行的完全逆转。*

*相反，他们可能会返回一个布尔值 price 设置为 false，代码将保持运行。这可能会让开发人员担心，如果没有正确检查返回，可能会导致打开失败和不同的不良结果。*

*![](img/3e063778684e85bc9ee3b1d17834f337.png)*

*代码缺少返回函数*

***理解代码:***

1.  *现在试想一下，如果开发者忘记检查 ***send()*** 函数的返回值。*
2.  ****call()*** 用于将以太发送到智能合约但它不接受它，因为我们还没有提到应付款 ***fallback()*** 函数。*
3.  *现在以太坊虚拟机会将其返回值替换为 false。*
4.  *如果没有勾选返回值，函数的值将不会改变，也不会恢复，并且 ***etherLeft()*** 将会得到一个不正确的值*

## *5.拒绝服务(DOS):*

****那是意外！🤣****

*拒绝服务是网络安全史上最臭名昭著的攻击。其他应用程序确实有机会从这种攻击中恢复，但是猜猜会发生什么？智能合约没有任何恢复的机会，它将永久离线。许多方法会导致拒绝服务，例如在作为交易接收者时的恶意行为，人为地增加对计算函数至关重要的气体，滥用智能合同来访问个人添加剂，利用混淆和疏忽等。*

*![](img/7d2420c0196d9d821aa5ea88ca6cb4e3.png)*

*DOS 恶意代码示例*

***理解代码:***

1.  *在这个例子中，呼叫者可以确定随后的特征名称将奖励谁。*
2.  *由于 for 循环中的高价格命令，攻击者可以引入一些太大而无法迭代的命令(因为以太坊中的气体阻挡屏障)作为有效阻止函数运行的方法。*

*![](img/17d6451af0f9c1e7dfaa3657b55e2d88.png)*

*-团队数据科学符合网络安全💙❤️*