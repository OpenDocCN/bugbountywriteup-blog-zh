<html>
<head>
<title>Facebook Push Notification Linkshim Bypassed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脸书推送通知链接绕过</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/facebook-push-notification-linkshim-bypassed-385fe471516?source=collection_archive---------0-----------------------#2020-12-07">https://infosecwriteups.com/facebook-push-notification-linkshim-bypassed-385fe471516?source=collection_archive---------0-----------------------#2020-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="17b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在浏览和查找facebook漏洞时，我意外发现了这个facebook推送通知链接</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f0120a007cd3e30001dc43b39dc95544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EsFvubXiG_2hABPCjmb4g.png"/></div></div></figure><p id="bd18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我访问facebook链接时，奇怪的是整个facebook页面都是空白的，这里什么也没有，嗯，所以我查看源代码并阅读它进行分析</p><p id="ccfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【JavaScript代码片段</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/d29661f7c7888ec498b799fd8c79fe5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X7JeyCaPuvoPFrj303R2nQ.png"/></div></div></figure><p id="b264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过在端点参数中添加链接，redirectUrl容易受到open redirect的攻击，因此我快速检查Url是否有端点参数和yes。</p><p id="3a5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在端点参数上加我的网站<strong class="jp ir">？但是什么也没发生，嗯，所以我试着用url编码绕过它</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/35016d75e81ba616c9b31e79864b1851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_GhQw3BU_iNlxOzpBi8RQ.png"/></div></div></figure><p id="968d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是仍然没有反应，然后我在网址上添加了更多的%2f</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/3d5956686050f6b6ef09fd475abb8a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qcVfIzhWBTemMBdYEd1fRw.png"/></div></div></figure><p id="d6b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后Boomm的facebook页面重定向到我的网站</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/6cbbaf704258040b3b6467d511cf8816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6PTEJgm0olXQGrF2x4wxg.png"/></div></div></figure><p id="8ef3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然我试图执行xss，但它已经被十六进制编码过滤，我的知识不足以绕过十六进制过滤器。</p><h1 id="ab38" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">什么是Linkshim</h1><p id="ff24" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">每次点击网站上的链接时，该链接都会检查针对脸书的URL是否有自己的内部恶意链接列表，以及众多外部合作伙伴的列表，包括McAfee、Google、Web of Trust和Websense。如果脸书检测到一个URL是恶意的，脸书会在浏览器真正请求可疑页面之前显示一个间隙页面。</p><p id="8bbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击此链接阅读完整解释:<a class="ae md" href="https://www.facebook.com/10150492832835766" rel="noopener ugc nofollow" target="_blank">www.facebook.com</a></p><p id="4a47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">设置</strong></p><ul class=""><li id="3531" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">用户UserOne</li></ul><p id="bb2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">再现步骤</strong></p><ul class=""><li id="ad02" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">从任何web浏览器以用户身份登录，然后转到</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f0120a007cd3e30001dc43b39dc95544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7EsFvubXiG_2hABPCjmb4g.png"/></div></div></figure><ul class=""><li id="414a" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">现在在参数端点上插入网站，结果如下所示</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/600951042c87928055a2956a89946b86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8nyykvuI7MBpKqLl9PDXew.png"/></div></div></figure><ul class=""><li id="986f" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">添加更多斜杠/然后将网站url编码为url编码并插入到端点参数中</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/3d5956686050f6b6ef09fd475abb8a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qcVfIzhWBTemMBdYEd1fRw.png"/></div></div></figure><ul class=""><li id="4a16" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">点击进入它将重定向到www.mydomain.com/login.php linkshim最后绕过。</li></ul><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mn"><img src="../Images/15787ab5f3af1c50cbddec1fba36e37f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MYMypqzhY890j_oFI1jcw.jpeg"/></div></div></figure><h1 id="c1c5" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">披露时间表</h1><ul class=""><li id="b673" class="me mf iq jp b jq ly ju lz jy mo kc mp kg mq kk mj mk ml mm bi translated">2020年9月22日——我在facebook whitehat页面报告了这个漏洞问题。</li><li id="5764" class="me mf iq jp b jq mr ju ms jy mt kc mu kg mv kk mj mk ml mm bi translated">2020年9月23日–脸书团队重现并调查了该漏洞问题。</li><li id="7c9f" class="me mf iq jp b jq mr ju ms jy mt kc mu kg mv kk mj mk ml mm bi translated">2020年9月28日–我提供了关于此漏洞问题的更多详细信息。</li><li id="5c01" class="me mf iq jp b jq mr ju ms jy mt kc mu kg mv kk mj mk ml mm bi translated">2020年10月8日–漏洞问题已得到修补。</li><li id="38cb" class="me mf iq jp b jq mr ju ms jy mt kc mu kg mv kk mj mk ml mm bi translated">2020年10月21日——悬赏奖金。</li></ul><p id="be62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读这篇文章，我希望你们今天能学到一些新东西。请分享这篇文章来传播知识。</p><p id="54ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">别忘了通过<a class="ae md" href="https://linkedin.com/in/nmochea" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae md" href="https://twitter.com/nmochea" rel="noopener ugc nofollow" target="_blank"> Twitter </a>关注和联系我。</p></div></div>    
</body>
</html>