<html>
<head>
<title>How I was able to send Authentic Emails as others — Google VRP [Resolved]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何能够像其他人一样发送真实的电子邮件——谷歌VRP[已解决]</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-was-able-to-send-authentic-emails-as-others-google-vrp-resolved-2af94295f326?source=collection_archive---------1-----------------------#2020-08-15">https://infosecwriteups.com/how-i-was-able-to-send-authentic-emails-as-others-google-vrp-resolved-2af94295f326?source=collection_archive---------1-----------------------#2020-08-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a93b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">报告ID: 161777102 —谷歌VRP </strong></p><p id="3afb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">三个月后，我回到谷歌VRP，在名人堂上排名。谷歌云引起了我的注意，我决定在那里捕捉虫子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/bd70d51cb3bc7d2f66810573b3acd726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uq8Am-We32dgc1P7xhDZBA.png"/></div></div></figure><p id="bd40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kx">注意:这不是我通常写的复杂文章，但这是我在谷歌云产品上发现的一个简单明了的逻辑漏洞，我想在这里分享一下。</em></p><p id="5335" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我浏览了<strong class="jp ir">谷歌云</strong>，有一款产品引起了我的注意。是<a class="ae ky" href="https://en.wikipedia.org/wiki/AppSheet" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Appsheet </strong> </a>成为我在整个谷歌云产品列表中最喜欢的目标。因为我花了几天时间来理解这个应用程序，这让我更容易找到更多的错误。</p><p id="926d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在理解了这个应用程序20分钟后，我在<strong class="jp ir">https://www.appsheet.com/partners</strong>上发现了一个有趣的页面</p><p id="4335" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它有一个注册为合作伙伴的表单，带有一些输入字段，如<strong class="jp ir"> <em class="kx">名称</em> </strong>，<strong class="jp ir"> <em class="kx">电子邮件</em> </strong>和<strong class="jp ir"> <em class="kx">请求</em> </strong>向各自的组织发送邮件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/b1035145ae7f2ca319a2bd4f8be72d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8sYu7r7bshejgicUAw3p-w.png"/></div></div></figure><p id="62e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">起初，这种联系方式并没有引起我的注意，相反，我在应用程序上发现了几个IDOR，并报告给了谷歌VRP公司，得到了解决。你可以在这里找到<a class="ae ky" href="https://medium.com/bugbountywriteup/the-short-tale-of-two-bugs-on-google-cloud-product-google-vrp-resolved-47c913dca8fc" rel="noopener">的报道</a></p><p id="452e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，当我在请求中发现一些可疑之处时，联系表完全引起了我的注意。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi la"><img src="../Images/0522edf4339ab256a5ec06200067f156.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*o4WHFR8DW4Gnxei-Ee51tQ.png"/></div></figure><p id="22da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在请求中找到了四个参数，它们是</p><p id="c835" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kx"> " </em> <strong class="jp ir"> <em class="kx">合作伙伴邮件</em> </strong> <em class="kx">":"目的地合作伙伴邮件"</em></p><p id="eb02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kx"/><strong class="jp ir"><em class="kx">用户名</em> </strong> <em class="kx">【我的用户名】</em></p><p id="f908" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kx"/><strong class="jp ir"><em class="kx">用户邮箱</em> </strong> <em class="kx">【我的邮箱】</em></p><p id="fe03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kx"/><strong class="jp ir"><em class="kx">用户请求</em> </strong> <em class="kx">【我的消息】</em></p><p id="3b67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在<strong class="jp ir"> <em class="kx"> userRequest </em> </strong>参数上尝试了服务器端注入，但是没有成功。但是它容易受到HTML注入的攻击。当我以<em class="kx">&lt;img src = " test . png "&gt;</em>的身份发送<em class="kx"> userRequest </em>时，图像在邮件中得到反映。</p><p id="38d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但谷歌不会接受HTML注入，直到它不能升级到XSS。我无法启动XSS或测试SSRF，因为它的后端有一个云状耀斑，几乎挡住了我所有的XSS有效载荷。</p><p id="2f78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我尝试将合作伙伴的电子邮件替换为<strong class="jp ir">“admin @ Google . com”</strong>并转发请求。我不相信我会收到电子邮件，但令我惊讶的是，我收到了一封电子邮件。就像<strong class="jp ir">“admin @ Google . com”</strong>发了一封邮件<strong class="jp ir"> </strong>把我的信息包含在表格里。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/daa7cf3760f1d534bcff95d4e3ed76fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*VOcJsa7KQRZBopFjhYwG8A.png"/></div></figure><p id="c0ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等等，什么？！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/163785d79c1940038a620748bba26ec1.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*NJtzIeacCvJyKnvLGtEkXw.gif"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">哇哦！！</figcaption></figure><p id="f296" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有阻止机制，通过了超级酷的谷歌垃圾邮件过滤器没有任何问题，最重要的是谷歌魔术自动标记为重要的电子邮件。我甚至可以像任何gmail用户一样发送电子邮件。</p><p id="c31a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kx"> userEmail </em> </strong>参数也可以替换为任何电子邮件，这意味着我可以以<strong class="jp ir">唐纳德·川普</strong>的身份向<strong class="jp ir">金正恩</strong>发送电子邮件，而不会暴露我的身份。</p><p id="315a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并且很快意识到它很容易受到<strong class="jp ir">开放邮件中继</strong>攻击，这种攻击最近在应用程序中确实发生了。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/b9765e4e340df7bca02813d9c2984df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*CcjiLwKlyK1Lt8Hh1De_Fg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">谷歌魔术添加了我的欺骗邮件的重要性</figcaption></figure><p id="91d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以以任何人的身份发送电子邮件，甚至解雇组织中的员工，甚至发送电子邮件进行网络钓鱼或其他可能的攻击。另一方面，它可以作为一个邮箱推出大量的电子邮件活动，没有任何问题，甚至没有花费一分钱。而且，不用担心邮件最终会变成垃圾邮件，因为它们来自<strong class="jp ir">谷歌系统</strong>，甚至由来自谷歌云<strong class="jp ir">应用程序表</strong>的<strong class="jp ir">google.com</strong>签名，而且由于消息参数容易受到HTML注入的攻击，所以通过添加图像和href标签，发送更具真实性的电子邮件更有可能。</p><p id="abd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击者只需在表单中填写所有细节，然后篡改请求，就可以像任何邮件用户一样发送这种真实的欺骗邮件。</p><p id="50b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很快向Google报告了这个问题，问题在48小时内被接受并得到解决:)</p><p id="7401" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦问题得到解决，我在Google Cloud上发现的IDOR漏洞的相关文章将会发布！敬请期待！！ </p><p id="c69c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，如果你喜欢这个，写下来鼓掌👏，那我们来连线:</p><p id="1c5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">推特:</strong>T32】sriramoffcl</p><p id="19b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">insta gram:</strong><a class="ae ky" href="https://www.instagram.com/sriram_offcl/" rel="noopener ugc nofollow" target="_blank">Sri ram _ off cl</a></p><p id="16f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">LinkedIn:</strong><a class="ae ky" href="https://www.linkedin.com/in/sriramkesavan/" rel="noopener ugc nofollow" target="_blank">sriramkesavan</a></p><p id="d81d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://paypal.me/sri123】捐:<a class="ae ky" href="https://www.paypal.me/sri123" rel="noopener ugc nofollow" target="_blank"/></p><p id="9be8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">和平</strong> ✌️ <strong class="jp ir">！！！</strong></p></div></div>    
</body>
</html>