<html>
<head>
<title>Subdomain takeover dew to missconfigured project settings for Custom domain .</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">子域接管会导致自定义域的项目设置配置错误。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/subdomain-takeover-dew-to-missconfigured-project-settings-for-custom-domain-46e90e702969?source=collection_archive---------0-----------------------#2018-10-25">https://infosecwriteups.com/subdomain-takeover-dew-to-missconfigured-project-settings-for-custom-domain-46e90e702969?source=collection_archive---------0-----------------------#2018-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b23a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨，读者们，</p><p id="b4ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我将写关于<strong class="jp ir">子域接管</strong>。这是一个常见的安全问题，实际上是开发人员的错误，他们留下了一个未使用/无人认领的第三方服务DNS CNAME记录作为他们的子域名，黑客可以在外部服务的帮助下声称这些子域名，这可能会导致严重的问题。你可以从<a class="ae kl" href="https://labs.detectify.com/2014/10/21/hostile-subdomain-takeover-using-herokugithubdesk-more/" rel="noopener ugc nofollow" target="_blank"> detectify博客</a>了解更多关于子域接管的信息。</p><p id="ab3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在测试flock的时候，我得到了一个flock company旗下的域名<strong class="jp ir">flock.co</strong>。所以我开始查看它的子域，得到了子域<a class="ae kl" href="http://newdev.flock.co" rel="noopener ugc nofollow" target="_blank">newdev.flock.co</a>。当我在浏览器中访问子域时，我得到了如下截图所示的错误</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/dd2a9e93a87be4fc00b7e0a0bef042be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fk9rIY1RE9yyl1EjwaFMWQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">错误页面</figcaption></figure><p id="7265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这引起了我的注意。所以我查了这个域名的DNS记录。</p><pre class="kn ko kp kq gt lc ld le lf aw lg bi"><span id="d6f5" class="lh li iq ld b gy lj lk l ll lm"><strong class="ld ir">$ dig newdev.flock.co</strong></span><span id="a01b" class="lh li iq ld b gy ln lk l ll lm">; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; newdev.flock.co<br/>;; global options: +cmd<br/>;; Got answer:<br/>;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 13182<br/>;; flags: qr rd ra; QUERY: 1, ANSWER: 4, AUTHORITY: 0, ADDITIONAL: 1</span><span id="31df" class="lh li iq ld b gy ln lk l ll lm">;; OPT PSEUDOSECTION:<br/>; EDNS: version: 0, flags:; udp: 512<br/>;; QUESTION SECTION:<br/>;newdev.flock.co. IN A</span><span id="32a9" class="lh li iq ld b gy ln lk l ll lm">;; ANSWER SECTION:<br/><strong class="ld ir">newdev.flock.co. 299 IN CNAME cname.readme.io.</strong><br/>cname.readme.io. 299 IN CNAME readme-cache-prod-1392018356.us-east-1.elb.amazonaws.com.<br/>readme-cache-prod-1392018356.us-east-1.elb.amazonaws.com. 59 IN A 52.0.214.29<br/>readme-cache-prod-1392018356.us-east-1.elb.amazonaws.com. 59 IN A 52.5.249.117</span><span id="5c6e" class="lh li iq ld b gy ln lk l ll lm">;; Query time: 69 msec<br/>;; SERVER: 8.8.8.8#53(8.8.8.8)<br/>;; WHEN: Mon Jul 09 04:58:06 +06 2018<br/>;; MSG SIZE rcvd: 175</span></pre><p id="99c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据上面的记录，我们可以说子域指向<strong class="jp ir"> CNAME cname.readme.io。</strong>所以我开始在<a class="ae kl" href="https://readme.readme.io/docs/setting-up-custom-domain" rel="noopener ugc nofollow" target="_blank"> readme.io </a>网站上查看自定义域文档，以了解它们是如何工作的。从他们的文件中我了解到:-</p><ul class=""><li id="d88d" class="lo lp iq jp b jq jr ju jv jy lq kc lr kg ls kk lt lu lv lw bi translated">您需要一个指向您的<strong class="jp ir"> readme.io </strong>子域[<strong class="jp ir">your subdomain . readme . io</strong>]的子域。</li><li id="3127" class="lo lp iq jp b jq lx ju ly jy lz kc ma kg mb kk lt lu lv lw bi translated">您的子域应该在以下页面的域设置中进行配置<strong class="jp ir">https://dash.readme.io/project/&lt;项目<br/>_ Name&gt;/v 1.0/domains</strong></li></ul><p id="a4fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，为了接管，我需要检查<strong class="jp ir"> cname.readme.io </strong>是否已经被声明不存在。但不幸的是已经有人认领了:(。但是我看到许多这样的服务并不强迫用户通过使用相同的CNAME txt记录来验证他们的域名所有权，就像他们的服务子域一样。所以还有希望。</p><p id="4396" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir"> readme.io </strong>开了一个账号，得到了一个子域<strong class="jp ir"> newdev.readme.io </strong>。然后我去域设置<a class="ae kl" href="https://dash.readme.io/project/newdev/v1.0/domains" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a><strong class="jp ir"/>并在自定义域字段中使用<a class="ae kl" href="http://newdev.flock.co" rel="noopener ugc nofollow" target="_blank"/>作为值并<strong class="jp ir">保存</strong>的修改。</p><p id="ee05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在当我访问<a class="ae kl" href="http://newdev.flock.co" rel="noopener ugc nofollow" target="_blank">newdev.flock.co</a>时，它把我重定向到<a class="ae kl" href="http://newdev.flock.co/inactive" rel="noopener ugc nofollow" target="_blank">http://newdev.flock.co/inactive</a>这个页面，现在还没有激活。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/6971777c32158c777320cb9a74ecd401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6ZMhrt9Wf4y0qt3M4rNRA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">见页面标题；)</figcaption></figure><p id="e963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是因为我使用的是一个试用账户。在网页标题中，你会看到我的项目名称，我在创建项目时使用的名称。所以现在这个域名正在为我提供来自<strong class="jp ir"> newdev.readme.io </strong>项目页面<strong class="jp ir"> </strong>的内容。</p><p id="c6e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">如何避免此类问题？:- </strong>随时更新你的DNS记录。删除CNAME或任何其他不使用的DNS记录。</p><p id="adbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你发现一个安全漏洞，请随时通过security@flock.com联系他们</p><p id="779c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。你可以随时在脸书找到我:-<a class="ae kl" href="https://www.facebook.com/prial261" rel="noopener ugc nofollow" target="_blank">https://www.facebook.com/prial261</a></p></div></div>    
</body>
</html>