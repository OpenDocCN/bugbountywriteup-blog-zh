<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-how-i-was-able-to-delete-anyones-account-in-an-online-car-rental-company-8a4022cc611?source=collection_archive---------4-----------------------#2018-01-14">https://infosecwriteups.com/bugbounty-how-i-was-able-to-delete-anyones-account-in-an-online-car-rental-company-8a4022cc611?source=collection_archive---------4-----------------------#2018-01-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><p id="c93c" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><strong class="ir jn"># BugBounty——我是如何在一家在线汽车租赁公司删除任何人的账户的</strong></p><p id="86fe" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">嗨伙计们，</p><p id="0558" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">我最近在一家流行的在线汽车租赁公司发现了一个更有趣的发现。一些参数操作结合CSRF导致禁用任何用户的帐户。让我们看看这是怎么做到的—</p><p id="41e4" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">所以这让我很惊讶，我正在通过“更新个人资料”功能来找到一些错误，然后我在请求中看到了一些可疑的东西。参数“方法”:)</p><figure class="jp jq jr js gt jt gh gi paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="gh gi jo"><img src="../Images/3f8ef9375fe533fbd0f6569613e2b950.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRzFV3iPdyeJpgv-kiwLJg.png"/></div></div><figcaption class="ka kb gj gh gi kc kd bd b be z dk translated">原始HTTP请求</figcaption></figure><p id="7625" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">“method”参数中的原始值是“put ”,它建议创建一个新资源或者用请求的数据替换当前资源的表示，然后我知道下一步该做什么——我只是将该值更改为方法“DELETE”(<strong class="ir jn">HTTP DELETE</strong>请求<strong class="ir jn">方法</strong>删除指定的资源)并转发它。不出所料，账号不见了，被删除了！(实际上，门户网站中没有允许用户停用其帐户的功能)。</p><p id="f88e" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">现在，下一个挑战是做同样的事情，但对其他用户的帐户。我尝试了，搜索了，挖掘了各个领域，但都是徒劳的，然后我尝试了最基本的东西——CSRF。如果你注意到上面的请求，你会发现“csrf_token”出现在文章正文中。只是为了检查令牌是否得到验证，我删除了令牌值并转发了请求，得到了“200 OK”。哇哦！</p><p id="1fc8" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">以下是CSRF的利用-</p><figure class="jp jq jr js gt jt gh gi paragraph-image"><div class="gh gi ke"><img src="../Images/b9fe7d2d41773ac41e676311cff2013c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*bFX_ZKe5pn1m3DHXVGXLhA.png"/></div></figure><p id="586d" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">经过进一步分析，我发现这是CSRF令牌没有得到验证的唯一形式——弱CSRF实现的最常见情况。:)</p><p id="47c3" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><em class="kf">报告详情- </em></p><p id="c980" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2017年12月8日—向相关公司报告了错误。</p><p id="ffae" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2017年12月29日—错误被标记为已修复。</p><p id="4571" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年1月1日—重新测试并确认了修复。</p><p id="851e" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年1月7日—由公司授予。</p><p id="9677" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">~逻辑炸弹(<a class="ae kg" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)</p></div></div>    
</body>
</html>