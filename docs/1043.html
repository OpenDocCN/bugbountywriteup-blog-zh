<html>
<head>
<title>Finding The Origin IP Behind CDNs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">寻找CDNs背后的原创IP</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/finding-the-origin-ip-behind-cdns-37cd18d5275?source=collection_archive---------0-----------------------#2020-12-30">https://infosecwriteups.com/finding-the-origin-ip-behind-cdns-37cd18d5275?source=collection_archive---------0-----------------------#2020-12-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cbe109e92fa454a894b276eec5968890.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u32GvSADiZPBkn1VxpT9zw.jpeg"/></div></div></figure><p id="e016" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好，我是<a class="ae kw" href="https://medium.com/u/f885392a99e7" rel="noopener"> HolyBugx </a>我在<a class="ae kw" href="https://twitter.com/HolyBugx/status/1343156549162852352?s=20" rel="noopener ugc nofollow" target="_blank">这条推文</a>之后开始写这个，因为我看到许多感兴趣的人希望我这样做，所以我决定与你们分享我的知识。最初的帖子在<a class="ae kw" href="https://zdresearch.com/finding-the-origin-ip-behind-cdns/" rel="noopener ugc nofollow" target="_blank"> ZDresearch </a>上，但我也在这里分享了它。没有进一步的解释，让我们进入正题。</p><h1 id="e98b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是CDN？</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/6665d47529a8aa628150828b067c69b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6hv--hQkZaKXk-RQ9bYZsg.jpeg"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">内容交付网络</figcaption></figure><p id="4dd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">CDN允许快速传输加载互联网内容所需的资产，包括HTML页面、Javascript文件、样式表、图像和视频。CDN服务越来越受欢迎，如今大部分网络流量都是通过CDN提供的，包括来自脸书、网飞和亚马逊等主要网站的流量。</p><h1 id="681a" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么网站需要CDN？</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/9e87424c37075eaac81c7fec4f8dfca1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NY4a0DjoOtS021OGzGOUA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">在使用CDN之前</figcaption></figure><p id="b24c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">性能很重要，如果网站不使用CDN，所有用户应该将他们的请求发送到一个服务器，因为这将增加服务器的负载，降低网站的性能。现在大多数网站使用CDN，因为这将有助于他们有一个更好的加载速度，降低带宽成本，提高安全性等。<br/>cdn还为不同类型的企业和组织提供了许多具体优势，例如:</p><ul class=""><li id="6f13" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">电子商务</li><li id="25d0" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">政府</li><li id="d8ce" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">金融</li><li id="feed" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">媒体/出版</li><li id="7617" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">移动应用</li><li id="a5dd" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">技术和SaaS</li></ul><h1 id="a02e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用CDN有什么好处？</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/005b8225f6c3b67ebebcd0f09c6b277b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wpQKRAwKcbX5wBVwkFY89A.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">CDNs工作流</figcaption></figure><ol class=""><li id="5e61" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mu ml mm mn bi translated">提高网站速度和加载时间。</li><li id="c1a6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">降低带宽成本。</li><li id="f3b6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">提高网站安全性。</li><li id="c1fa" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">SEO优势</li><li id="acdf" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">流量峰值和可扩展性</li><li id="fc42" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">更高的转化率</li><li id="56f1" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">可靠性</li><li id="d01c" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mu ml mm mn bi translated">等等。</li></ol><p id="0b55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果你想有一个性能良好的可靠网站，你应该考虑使用CDN。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/54241355e46c9498242b723decd313f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rx575pJX9C0wnU28wwmoUw.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">使用CDN后</figcaption></figure><p id="091e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用CDN后，所有请求网站内容的用户都将从最近的CDN服务器获得其缓存版本，因此内容加载速度会更快，网站的性能也会提高。</p><h1 id="bb0d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">CDN反向代理</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/16bfcfe21fc8333d4d861fbf9b28cf64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mB4tbgAR7UrV6DoY4dMfYg.jpeg"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">反向代理</figcaption></figure><p id="c1c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">反向代理是一种服务器，它接收客户端请求并将其转发到后端服务器。它是客户端和源服务器之间的中间服务器。CDN反向代理通过缓存从源服务器返回到客户端的响应，将这一概念向前推进了一步。因此，CDN的服务器能够更快地将资产交付给附近的访问者。这种方法也是可取的，原因如下:</p><ul class=""><li id="d200" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">负载平衡和可伸缩性</li><li id="9ed5" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">提高网站安全性</li></ul><h1 id="fe1e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">CDN安全和WAFs</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/261b426922637ca8747a84d63c7e99c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CpXBNJPFAb5eNGsk6BRZ_w.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">WAFs解释道</figcaption></figure><p id="9ab2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">cdn本身不能阻止坏的僵尸程序感染网站，cdn本身是脆弱的，这就是为什么你需要使用WAF。<br/>一个<a class="ae kw" href="https://www.cloudflare.com/en-gb/learning/ddos/glossary/web-application-firewall-waf/" rel="noopener ugc nofollow" target="_blank"> WAF </a>或<a class="ae kw" href="https://www.cloudflare.com/en-gb/learning/ddos/glossary/web-application-firewall-waf/" rel="noopener ugc nofollow" target="_blank"> web应用防火墙</a>通过过滤和监控Web应用与互联网之间的HTTP流量来帮助保护Web应用。<br/>它通常保护web应用程序免受诸如跨站脚本(XSS)、文件包含和SQL注入等攻击。</p><h1 id="5104" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">网站来源IP</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/fbf119158d019626df43e1a4c0db9ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*mSL5bc6qgise_H5sfGzfIQ.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">一个使用CDN隐藏原始IP的安全网站</figcaption></figure><p id="1a5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">许多网站使用上述保护措施来隐藏其原始IP地址，以防止攻击者进行DDoS攻击和其他恶意攻击。这些网站大多使用基于云的安全、代理或基于DNS的服务，这使得找到原始IP有点棘手。</p><h1 id="3464" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">为什么我们需要一个网站的起源IP？</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/54dc96062a20cfc662eb70ab97a1a029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*U0k0nDiaFlVc7v1-bLVpig.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">不安全网站泄露了其原始IP</figcaption></figure><p id="ce9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">答案非常简单明了；一旦你有了一个网站的原始IP，你就可以绕过CDN提供的所有保护。</p><h1 id="43c2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">如何找到一个网站的IP地址？</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/59ba81f0378862c36467df8e73f32126.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K9NQc9sQrNWEKJFk8aGd2w.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated"><a class="ae kw" href="https://twitter.com/HolyBugx/status/1343156549162852352?s=20" rel="noopener ugc nofollow" target="_blank">https://twitter.com/HolyBugx/status/1343156549162852352?s=20 </a></figcaption></figure><p id="ab7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我在Twitter上提到的，有几种方法可以找到CDN/WAF背后的原始IP。我们将讨论作为攻击者可以使用的各种方法。</p><h1 id="1acc" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">逆向工程</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/5c3858b6801623e1d22c5ce6b76071f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2agrNPJExlW-1_4h1l5AqA.jpeg"/></div></div></figure><p id="f2b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每当你想绕过一些东西，把自己放在对手的位置，逆向工程你的思维过程，作为一个蓝色的团队思考，并试图找出他们的安全实施！</p><h1 id="6e34" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">蓝色队员提供的保护</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/500f18f21e6625a4690705fcc35512cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uUzcmdhDuRc8mupVGpI9Vg.jpeg"/></div></div></figure><p id="ad71" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是CDN提供商/蓝色团队隐藏其网站原始IP的常见做法:</p><ul class=""><li id="0d03" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">保持所有子域在同一个CDN上</strong></li></ul><p id="3619" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">与根域相比，使用其他子域，他们有更高的成功机会，因为他们可能提供可能导致信息泄露漏洞的文件，从而泄露原始IP。</p><ul class=""><li id="f461" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">不基于用户动作发起出站连接</strong></li></ul><p id="2927" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们能让网络服务器连接到一个任意的地址，我们就能发现原始IP地址。像“从URL上传”这样允许用户从给定URL上传照片的功能应该进行配置，以便进行下载的服务器不是网站源服务器。这一点很重要，因为如果攻击者可以选择输入的URL，他们就可以专门建立一个网站来监控谁连接到该网站，或者使用公共服务来监控与唯一URL联系的IP。</p><ul class=""><li id="b727" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">在配置CDN时更改其原始IP</strong></li></ul><p id="3ffc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">DNS记录是许多历史记录存档的地方。这些历史DNS记录将包含使用CDN的网站原始IP。</p><ul class=""><li id="7476" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">限制使用IP </strong> <strong class="ka ir">地址</strong>直接访问网站</li></ul><p id="1f94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个有趣的选择是，防御者可以限制试图使用IP地址访问网站的用户，这样网站只有在提供了域名的情况下才会加载。让我们探索一下如何在Nginx上做到这一点</p><p id="472e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了禁用/阻止端口80对IP的直接访问，我们创建了一个新的服务器配置，如下所示:</p><pre class="lw lx ly lz gt nb nc nd ne aw nf bi"><span id="4565" class="ng ky iq nc b gy nh ni l nj nk">server {<br/> listen 80 default_server;<br/> server_name _;<br/> return 404;<br/>}</span></pre><p id="05e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了禁用/阻止端口443对IP的直接访问，我们在一个服务器配置块中使用了以下内容:</p><pre class="lw lx ly lz gt nb nc nd ne aw nf bi"><span id="8011" class="ng ky iq nc b gy nh ni l nj nk">if ($host != "example.com") {<br/> return 404;<br/>}</span></pre><p id="d0a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">示例:</p><pre class="lw lx ly lz gt nb nc nd ne aw nf bi"><span id="4855" class="ng ky iq nc b gy nh ni l nj nk">server {<br/> listen 443 ssl;<br/> server_name example.com<br/> <br/> ssl_certificate /etc/nginx/ssl/example.com.crt;<br/> ssl_certificate_key /etc/nginx/ssl/example.com.key;<br/><br/> if ($host != "example.com") {<br/>  return 404;<br/> }<br/>}</span></pre><p id="d2be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将阻止到<a class="ae kw" href="https://your_ip_address/" rel="noopener ugc nofollow" target="_blank"> https://YOUR_IP_ADDRESS </a>的所有流量</p><p id="6a0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将讨论使用一种有趣的方法绕过这个限制。</p><ul class=""><li id="5124" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><strong class="ka ir">白名单</strong></li></ul><p id="fef1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅允许来自CDN的请求的一种可能的解决方案是简单地将CDN列入白名单，因为这种方法可能看起来很有前途，并且足以让防御者隐藏他们的原始服务器，这在实践中相当具有挑战性，因为他们只有3种方法，并且其中只有一种可行:</p><p id="0b5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">选项A:将IP地址列入白名单</strong></p><p id="b757" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将IP地址列入白名单的问题是，它们必须拥有所有可能访问其来源的CDN边缘服务器的IP地址。<br/>这个有点问题。许多cdn不给出它们的IP地址列表，并且即使它们给出了，它们也可能添加一个IP地址或者甚至改变它而忘记通知它们。这些白名单需要定期更新，以免破坏网站。</p><p id="d015" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">选项B:将请求中的唯一标识符列入白名单</strong></p><p id="d92a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个想法很简单。CDN将在其请求中向源服务器发送唯一标识符，源服务器可以使用该标识符在源服务器上识别CDN并允许其请求。然而，这种方法不是完全万无一失的。攻击者也可以自由设置请求。也就是说，如果我们知道他们使用的CDN提供商，并且我们也知道CDN提供商如何向原始服务器标识自己。如果攻击者掌握了这些信息，他们可以很容易地欺骗请求。</p><p id="a7a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">选项C:不可访问的原始主机名</strong></p><p id="e3af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于防御者来说，这可能是最可靠的解决方案，因为如果攻击者试图访问Web服务器，他们将无法找到它。防御者创建一些随机的、长的字母数字字符集，并将它们用作子域。例如，如果他们的域名是“HolyBugx.com ”,那么他们设置一个类似“2547d0jeid15ma”的子域名。HolyBugx.com”。<br/>那么这个主机名只有他们和他们的CDN提供商知道，他们可以将具有这个主机名的请求列入白名单。</p><h1 id="5198" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结论</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/152f51d31b4ca447eb2bfe934456ba8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8mbZs_WgwOCgEwJm-54eUg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">防御者思维导图</figcaption></figure><h1 id="70df" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">回到进攻方</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/e603cb888072ec8e13e5c41818a6469a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OexJmRPJhIUgQ86UU4opPg.jpeg"/></div></div></figure><p id="933d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只是对试图保护其原始网站的防御方的观点有一个基本的了解，知道了这些信息，我们就有了我们将要做什么的思维导图，在我们的思考过程中，我们试图绕过这些限制，找到网络服务器的原始IP。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/cad8f7ce3cd24721f62236a9a2a2165f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cuZ56JhklsbXhBtCOA3ueg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">攻击者思维导图</figcaption></figure><p id="5f69" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面是一个简单的思维导图，告诉我们在测试网站的原始IP泄漏时应该做些什么，让我们深入研究一下。</p><h1 id="0411" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">侦察</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/45d90d1040e206c3d696c05e8a1fef3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HfbhV72Jj7w4zkZeI4GurA.png"/></div></div></figure><p id="7a9a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最重要的部分是做一些基本的侦察，以获得尽可能多的信息。我们的想法是找到有用的信息，例如:</p><ul class=""><li id="5947" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">IP范围/CIDR</li><li id="6e49" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">主机相关信息</li><li id="3082" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">DNS记录</li><li id="5d71" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">Web服务器</li><li id="eae6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">虚拟主机</li><li id="6d2a" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">与Web服务器在同一服务器上的托管服务器(如邮件服务器)</li><li id="3f04" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">信息泄露漏洞</li></ul><h1 id="bd82" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">关于DNS记录的所有信息</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/32575f32d08051c42b42123290a224d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eo-48fRMP-_ii3nMe8X9zA.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">DNS记录</figcaption></figure><p id="cdc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">DNS记录是许多历史记录存档的地方。这些历史DNS记录可能包含使用CDN的网站原始IP。正如我之前提到的，一些网站可能有错误配置的DNS记录，我们可以从中收集有用的信息。</p><h2 id="d74e" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated"><strong class="ak"> 1-安全轨道</strong></h2><p id="d9e8" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated"><a class="ae kw" href="https://securitytrails.com/" rel="noopener ugc nofollow" target="_blank"> SecurityTrails </a>使您能够探索任何互联网资产的完整当前和历史数据。IP &amp; DNS历史、域、SSL和开放端口智能。</p><p id="a305" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将对我们的目标执行一个简单的查询，以查看其历史数据，特别是DNS记录，因为它让您可以找到A、AAAA、MX、NS、SOA和TXT记录的当前和历史数据。<br/>当网站直接在服务器的IP上运行，后来转移到CDN时，这可以方便地找到真正的服务器IP。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/2b8dcac1d9bf79a8d7140e8998736c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mrtCUDWHc-QxaAHAkOxyzg.png"/></div></div></figure><p id="61e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们将点击“历史数据”,查看有关我们目标的有用信息。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/a950c3d227d04e240934d8e932156bca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nAmNKGcJQ3y4nmZV6Mg3Eg.png"/></div></div></figure><p id="7a1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任何DNS记录都不应该包含任何原始IP，仔细查看任何SPF和TXT记录，以确保它们是否包含任何有关原始IP的信息。指向源服务器的简单的A、AAA、CNAME或MX记录将暴露源IP。</p><h2 id="9a20" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">2-挖掘</h2><p id="ec21" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">您可以使用dig为您做一些简单的查询，还可以发现目标是否在使用著名的提供商，如Cloudflare。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/49959ef24d09528a8e3e468e230b508d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgJ34dXt1rQ40kaU4kO32g.png"/></div></div></figure><p id="2cad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是Cloudflare的IP范围，为了确认我们可以在我们找到的记录IP地址上使用<em class="oh"> whois </em>:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/d49c1fe70fae143273fa5e5bbed03496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*ggqY3HZOYgTevKG2jK48Lw.png"/></div></figure><p id="c248" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，还有另一种方法来确定目标是否在云辉后面，那就是使用<em class="oh"> curl: </em></p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oj"><img src="../Images/997cd5c329d9fa6878e873b64d277634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FVM-pyp_7muldnRe10gvqw.png"/></div></div></figure><h1 id="8144" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">关于MX唱片的一切</h1><p id="8b1b" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">MX记录是最受欢迎的方法之一，因为有时很容易找到原始IP。如果邮件服务器由与Web服务器相同的IP托管，攻击者可以从发出的电子邮件中找到IP地址。</p><h2 id="a163" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">1-邮件标题和重置密码</h2><p id="ac57" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">如果邮件服务器与Web服务器的IP地址相同，我们还有一个有趣的选择，就是使用“重置密码”功能，这样我们就可以在目标网站上创建一个帐户，使用重置密码，收到的电子邮件就可能会泄露源服务器的IP地址。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/65c3f07760233f3b75ea5c5eeadc2ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1288/format:webp/1*WLkOFhnwxMhApRORi2y5Mw.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">“重置密码”和邮件标题的示例</figcaption></figure><p id="f897" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，您应该收集所有您可以在收到的电子邮件中看到的IP地址，并手动尝试它们，看看它是否是服务器源IP。有时“返回路径”的值会变得很方便。</p><h2 id="6471" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">2-发送电子邮件</h2><p id="c92e" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">还有一个有趣的方法你可以用，给一个不存在的邮箱发邮件到“non-existent@target.com”会引起反弹；因为用户不存在，传递将会失败，您应该会收到一个通知，其中包含向您发送电子邮件的服务器的原始IP。</p><h1 id="1d45" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">虚拟主机发现</h1><p id="fcfd" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">找到Web服务器后，您就有了Web服务器及其IP地址的列表，您应该弄清楚您的目标域是否在这些服务器上被配置为<a class="ae kw" href="https://www.webopedia.com/definitions/virtual-host/#:~:text=Often%20abbreviated%20vhost%2C%20a%20virtual,Web%20servers%20and%20Internet%20connections." rel="noopener ugc nofollow" target="_blank">虚拟主机</a>。</p><p id="bc1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于虚拟主机发现，我建议<a class="ae kw" href="https://pentest-tools.com/information-gathering/find-virtual-hosts" rel="noopener ugc nofollow" target="_blank"> Pentest-Tools </a>如果你喜欢GUI，并且像我一样喜欢CLI工具，我建议这些工具:</p><ul class=""><li id="777f" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated"><a class="ae kw" href="https://github.com/codingo/VHostScan" rel="noopener ugc nofollow" target="_blank">VHostScan</a>by<a class="ae kw" href="https://twitter.com/codingo_" rel="noopener ugc nofollow" target="_blank">Codingo</a></li><li id="b45d" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated"><a class="ae kw" href="https://github.com/jobertabma/virtual-host-discovery" rel="noopener ugc nofollow" target="_blank">虚拟主机发现</a>由<a class="ae kw" href="https://twitter.com/jobertabma" rel="noopener ugc nofollow" target="_blank"> Jobertabma </a></li><li id="fa44" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated"><a class="ae kw" href="https://github.com/OJ/gobuster" rel="noopener ugc nofollow" target="_blank"> Gobuster </a>由<a class="ae kw" href="https://twitter.com/thecolonial" rel="noopener ugc nofollow" target="_blank"> OJ </a></li></ul><p id="6907" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用这些工具，你可以找到虚拟主机，如果你的目标被配置为虚拟主机，那么你有机会找到源IP。</p><h1 id="64f7" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">安全错误配置</h1><p id="646b" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">错误配置很容易被利用，例如，要加载的内容的URL指向一个不属于可以连接到您的CDN的IP，就像服务器的实际IP一样。</p><p id="4744" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">问:但是一个人可以只用一个CSS文件建立一个服务器，而不用其他东西(举例来说)，你怎么能说这个IP就是我们正在寻找的真正的IP呢？</p><p id="ba97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">答:实际上，我们并没有寻找CDN背后服务器的真实IP地址。我们正在寻找可以验证的信息，只有在此之后，我们才能做出结论。</p><p id="ca24" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">基本上，我们在寻找属于cdn的IP。</p><h1 id="b0c2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">物联网搜索引擎</h1><p id="0677" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">当我们想要对我们的目标及其资产进行一些基本的侦察时，物联网搜索引擎是我们最好的朋友。有一些物联网搜索引擎，我们可以查询关于我们目标的有用信息。</p><h2 id="2f6f" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">1- Censys</h2><p id="ff60" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated"><a class="ae kw" href="https://censys.io/" rel="noopener ugc nofollow" target="_blank"> Censys </a>是一个帮助信息安全从业者发现可从互联网访问的设备的平台。在Censys的帮助下，您可以找到有价值的信息，例如:</p><ul class=""><li id="1947" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">IP地址；网络地址</li><li id="af62" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">开放端口</li><li id="81b4" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">SSL证书</li><li id="9138" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">托管提供商</li><li id="d285" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">等等。</li></ul><p id="d741" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对我们文章主题的查询非常简单，我们可以简单地查询域名本身，看看是否有任何IP泄漏。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/e4f3f30516c2adb1e6c3ee122258d1d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rld7Skj9I2mz0xrtEFNU7g.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">Uber.com查询</figcaption></figure><p id="66f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一种方法是使用证书进行搜索，只需从蓝色栏中选择证书，然后搜索您的目标。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/bcbe9129b56613c1e5b8038b3ff937ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YZ7TLstqCCRx0amDlftdNQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">Censys证书查询</figcaption></figure><p id="19ad" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在打开每个结果以显示详细信息，并从右侧的“Explore”菜单中选择“IPv4 Hosts”:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/48a9edacd40ab8ab9ffcb6fd9ddfdbb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*85lcD_U51xkvjMaHXTiaaA.png"/></div></div></figure><p id="a4c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简单地分析你的目标，看看是否有任何IP泄漏，并试图达到你的目标使用他们的IP。</p><p id="015f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了向您展示Censys有时如何导致目标的完全IP泄漏，我现在将向您展示我最近正在处理的一个目标，通过简单的IPv4查询，我实现了CDN背后的IP:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oo"><img src="../Images/45621de3cdb06496dd3fd670bf52ba43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JJRjTe5_Knsbj_6F3LivtQ.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">这个简单的查询导致了源IP泄漏</figcaption></figure><p id="ace3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你在上面看到的，有一个IP是我探索并意识到它是网站的起源IP。</p><h2 id="adac" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">2- Shodan</h2><p id="217e" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated"><a class="ae kw" href="https://www.shodan.io/" rel="noopener ugc nofollow" target="_blank"> Shodan </a>是另一个物联网搜索引擎，它可以帮助安全研究人员找到关于他们正在接近的目标的有用信息。在Shodan中有很多可以搜索的内容，我强烈推荐你去看看<a class="ae kw" href="https://beta.shodan.io/search/filters" rel="noopener ugc nofollow" target="_blank"> Shodan Filters Guideline </a>，为了这篇文章，我们可以简单地查询域名并搜索IP。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi op"><img src="../Images/bc96fda716a856705c6b26a352a9c81c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jCivSnYdKh56B4IG-LuxPg.png"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">对Tesla.com的简单质疑</figcaption></figure><p id="b1eb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Shodan，您可以查询其他有趣的过滤器:</p><ul class=""><li id="d771" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">组织</li><li id="40fb" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">ASNs</li><li id="352b" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">图标散列</li><li id="28a6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">SSL证书</li><li id="530a" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">等等。</li></ul><h2 id="7f51" class="ng ky iq bd kz np nq dn ld nr ns dp lh kj nt nu ll kn nv nw lp kr nx ny lt nz bi translated">3- Zoomeye</h2><p id="5aa9" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated"><a class="ae kw" href="https://www.zoomeye.org/" rel="noopener ugc nofollow" target="_blank"> ZoomEye </a>是另一个物联网搜索引擎，可用于发现:</p><ul class=""><li id="0aa1" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">网络服务器</li><li id="b5fa" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">IP和端口</li><li id="f436" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">标题和状态代码</li><li id="1d9a" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">脆弱点</li><li id="cbd6" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">等等。</li></ul><h1 id="a2c2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用IP地址直接访问网站</h1><p id="a0c6" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">正如我前面提到的这个方法:</p><blockquote class="oq or os"><p id="7584" class="jy jz oh ka b kb kc kd ke kf kg kh ki ot kk kl km ou ko kp kq ov ks kt ku kv ij bi translated">另一个有趣的选择是，防御者可以限制试图使用IP地址访问网站的用户，这样网站只有在提供了域名的情况下才会加载。<br/>我们将讨论使用一种有趣的方法绕过这个限制。</p></blockquote><p id="a725" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们跳出框框思考。如果我们扫描我们的目标CDN提供商的IP范围，然后做一些神奇的事情会怎么样？<br/>为了找到IP范围，我们可以执行DNS强制，因此，找到IP范围，然后我们可以继续使用下面的命令:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ow"><img src="../Images/6b59240f6185abb891f2fd1fe7d9b1e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5IJ3t9pIjlXeDT0LHpe5yg.jpeg"/></div></div></figure><p id="cbb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如您所见，我们正在扫描目标的IP范围。然后我们使用<a class="ae kw" href="https://github.com/projectdiscovery/httpx" rel="noopener ugc nofollow" target="_blank"> Httpx </a>来寻找活的。然后我们使用<em class="oh"> curl </em>来提供一个包含目标域的主机头，从而绕过所有的限制。</p><h1 id="5cc9" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">发挥创造力的时候到了:Favicon Hashes</h1><p id="54b4" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">Favicons有时非常有用，可以找到关于网站使用的某些技术的有趣信息。<br/> Shodan允许通过<code class="fe ox oy oz nc b">http.favicon.hash</code>进行favicon哈希查找。Hash指base64中favicons文件内容的<a class="ae kw" href="https://github.com/aappleby/smhasher/wiki/MurmurHash3" rel="noopener ugc nofollow" target="_blank"> MurmurHash3 </a>。</p><p id="d07b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://gist.github.com/yehgdotnet/b9dfc618108d2f05845c4d8e28c5fc6a" rel="noopener ugc nofollow" target="_blank">用于生成哈希的Python3脚本</a>:</p><pre class="lw lx ly lz gt nb nc nd ne aw nf bi"><span id="7b79" class="ng ky iq nc b gy nh ni l nj nk">import mmh3<br/>import requests<br/>import codecs</span><span id="1d06" class="ng ky iq nc b gy pa ni l nj nk">response = requests.get('https://&lt;website&gt;/&lt;favicon path&gt;')<br/>favicon = codecs.encode(response.content, 'base64')<br/>hash = mmh3.hash(favicon)<br/>print(hash)</span></pre><p id="8db2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">查看下面的博客文章，深入了解:<a class="ae kw" href="https://medium.com/@Asm0d3us/weaponizing-favicon-ico-for-bugbounties-osint-and-what-not-ace3c214e139" rel="noopener"> Asm0d3us — Favicon hashes </a></p><p id="0c43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以使用的另一个有用的工具是<a class="ae kw" href="https://twitter.com/noneprivacy" rel="noopener ugc nofollow" target="_blank">皮耶科11 </a>的<a class="ae kw" href="https://github.com/pielco11/fav-up" rel="noopener ugc nofollow" target="_blank">收藏夹</a>。使用这个工具，你可以从favicon图标和Shodan开始查找真正的IP。</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/6e59d240fb12f94f83f821a6acda5d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*jlY93ZKYfgsOcTztwZ4GsQ.png"/></div></figure><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi pc"><img src="../Images/e56f98b1ab52ec2d00770a020c30818a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iN5BrymucxpKey2ClIscDA.png"/></div></div></figure><h1 id="03ff" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">XML-RPC Pingback</h1><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/b037cf91a452aa066c38e26e8a59854c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MUS-JZMF4a6bY9fHwxyIsA.png"/></div></div></figure><p id="c569" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">XML-RPC允许管理员使用XML请求远程管理他们的WordPress网站。pingback是对ping的响应。当站点A链接到站点B时，会执行ping操作，然后站点B会通知站点A它已经注意到这一提及。这是乒乓球。</p><p id="56c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以通过调用<code class="fe ox oy oz nc b">https://www.target.com/xmlrpc.php</code>轻松检查它是否已启用。你应该得到如下:<br/> <code class="fe ox oy oz nc b">XML-RPC server accepts POST requests only.</code></p><p id="2bed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您也可以使用<a class="ae kw" href="https://orilliadentist.com/xml-rpc-validator/" rel="noopener ugc nofollow" target="_blank"> XML-RPC验证器</a>。</p><p id="d781" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据<a class="ae kw" href="https://codex.wordpress.org/XML-RPC_Pingback_API" rel="noopener ugc nofollow" target="_blank">WordPress XML-RPC ping back API</a>，函数有两个参数<code class="fe ox oy oz nc b">sourceUri</code>和<code class="fe ox oy oz nc b">targetUri</code>。以下是它在Burp Suite中的样子:</p><figure class="lw lx ly lz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/a6c93d53906e2263036d1039a8f9b818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u1OwPO8KuaiTbk-KOxLC6w.jpeg"/></div></div><figcaption class="ma mb gj gh gi mc md bd b be z dk translated">信用:<a class="ae kw" href="https://twitter.com/gwendallecoguic" rel="noopener ugc nofollow" target="_blank"> Gwendallecoguic </a></figcaption></figure><h1 id="14c4" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">参考</h1><p id="56e8" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">)(我)(们)(都)(不)(知)(道)(,)(我)(们)(还)(不)(知)(道)(,)(我)(们)(还)(不)(能)(还)(有)(什)(么)(情)(感)(呢)(?)(我)(们)(还)(没)(有)(什)(么)(情)(感)(呢)(?)(我)(们)(还)(没)(有)(什)(么)(好)(感)(呢)(?)(我)(们)(就)(没)(有)(什)(么)(好)(感)(,)(我)(们)(还)(没)(有)(什)(么)(感)(觉)(到)(,)(我)(们)(还)(没)(有)(什)(么)(好)(感)(,)(我)(们)(还)(没)(有)(什)(么)(好)(感)(感)(。</p><h1 id="c6af" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">最后的话</h1><p id="71da" class="pw-post-body-paragraph jy jz iq ka b kb oa kd ke kf ob kh ki kj oc kl km kn od kp kq kr oe kt ku kv ij bi translated">你们值得爱！我尽我所能写了一篇文章，可以帮助你了解CDN如何工作的全过程，蓝方队员的POV，以及攻击者试图找到web服务器的源IP的选项。如果您有任何相关的问题或反馈，请随时在<a class="ae kw" href="https://twitter.com/HolyBugx" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系。</p><p id="b679" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">作者:<a class="ae kw" href="https://twitter.com/HolyBugx" rel="noopener ugc nofollow" target="_blank"> HolyBugx </a></p></div></div>    
</body>
</html>