<html>
<head>
<title>Writing A Keygen Using Python Itertools</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python Itertools编写Keygen</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/writing-a-keygen-using-python-itertools-1944cbb4d07c?source=collection_archive---------0-----------------------#2020-01-17">https://infosecwriteups.com/writing-a-keygen-using-python-itertools-1944cbb4d07c?source=collection_archive---------0-----------------------#2020-01-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/77c27d8a168fabd199f5c84dcfa8c7e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GapX2U7v7zbXgg25"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">由<a class="ae kc" href="https://unsplash.com/@mattartz?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马特·阿特兹</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="8938" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天我们要生成一个简单的keygen来破解<a class="ae kc" href="https://crackmes.one/crackme/5c9126c033c5d46ecd37c8f4" rel="noopener ugc nofollow" target="_blank">这个名为“获取密码”的美丽破解程序</a>。野兽在这里:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/e91781245406ed254c337f704c14e2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V5_vtbc8UeV4gYqBXPaLkg.png"/></div></div></figure><p id="8cc6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很酷的图表，不是吗？</p><p id="ead5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在顶部，我们可以看到一个模式，就在这里:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/3738be29b3731d66f2f1f83f82cade8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jF5K0LDNFUFom1CWceNpmQ.png"/></div></div></figure><p id="a51e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是怎么回事？嗯，基本上…</p><p id="1c0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lh li lj lk b">cl</code>被用作索引，与每次递增的硬编码值(0，1，2)进行比较..9)和<code class="fe lh li lj lk b">edx</code>被用于成对的块中，每次递增或递减1，然后将硬编码值与<code class="fe lh li lj lk b">al</code>的内容进行比较，如果满足条件，则返回到算法的开始。</p><p id="3540" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">阅读代码后，我们可以得出结论，这些块中的每一个都代表了对密码中每一个字符的单独检查。</p><p id="c458" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个以白色突出显示的块组:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/3b7c523d1d23df6d028e4ff968059f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UPsImyxRjsGEvXRXIUUsJA.png"/></div></div></figure><p id="bc50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lh li lj lk b">edx</code>被用作“检查计数器”,<code class="fe lh li lj lk b">ecx</code>是我们正在检查的密码中字符的索引。如果检查通过，则<code class="fe lh li lj lk b">edx</code>递增，否则递减。</p><p id="a4a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这一系列检查的最后，有一个最终验证，控制是否所有10个检查都已成功通过，如果是这样，则显示“密码是正确的:)”消息。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lm"><img src="../Images/6ab38300f52807e7d25fd42d79b3ea18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HQRLH3k70vER6LldgntZRw.png"/></div></div></figure><p id="9a9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现有的大多数条件都是“开放式的”(<em class="ln">小于或等于</em>、<em class="ln">大于</em>等等)，因此我们可以得出结论，因为这不是一个单一解决方案的难题，所以编写一个keygen是最好的选择。</p><p id="f29d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用我们从静态分析中收集的条件列表，我们可以使用一些python itertools魔法创建一个keygen。我们只需要写下我们看到的每一个检查，并为给定的条件集生成所有可能的组合。整体逻辑应该如下所示:</p><pre class="lc ld le lf gt lo lk lp lq aw lr bi"><span id="8a51" class="ls lt iq lk b gy lu lv l lw lx">password_template = [<br/>    greater_than(0x47),<br/>    lower_than(0x66),<br/>    [0x56],<br/>    greater_than(0x66),<br/>    lower_than(0x33),<br/>    greater_than(0x79),<br/>    greater_than(0x38),<br/>    lower_than(0x4e),<br/>    diff_from(0x52),<br/>    [0x32],<br/>]</span><span id="bc80" class="ls lt iq lk b gy ly lv l lw lx">for p in itertools.product(*password_template):<br/>    print(p)</span></pre><p id="13c9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你对细节感兴趣，这里有完整脚本的GitHub链接:</p><div class="lz ma gp gr mb mc"><a href="https://github.com/alanvivona/pwnshop/blob/master/src/0x1C-HN1-Crackme1-GetThePassword/solve.py" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">破解“GetThePassword”的解决方案(keygen)</h2><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">github.com</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp jw mc"/></div></div></a></div><p id="6b43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这个脚本，我们可以轻松地获得一些有趣的有效代码。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/93a84f2cb864b763c1ec2bb5b79d6b64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Chr3X0-Q3vAJBcctY-OSWA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">答对了。</figcaption></figure><p id="24fe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢这篇文章，下次再见！</p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><div class="lc ld le lf gt mc"><a href="https://twitter.com/syscall59" rel="noopener  ugc nofollow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">系统调用59</h2><div class="my l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">Syscall 59的最新推文(@syscall59)。功能过多的脚本小子。Linux &amp;逆向工程迷。意大利</h3></div><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">twitter.com</p></div></div><div class="mk l"><div class="mz l mm mn mo mk mp jw mc"/></div></div></a></div></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><p id="c383" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ln">关注</em> <a class="ae kc" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ln"> Infosec报道</em> </a> <em class="ln">获取更多此类精彩报道。</em></p><div class="lz ma gp gr mb mc"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd ir gy z fp mh fr fs mi fu fw ip bi translated">信息安全报道</h2><div class="my l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="mj l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">medium.com</p></div></div><div class="mk l"><div class="na l mm mn mo mk mp jw mc"/></div></div></a></div></div></div>    
</body>
</html>