<html>
<head>
<title>HackTheBox: Lame</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客盒子:蹩脚</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hackthebox-lame-649ae6d39ac6?source=collection_archive---------3-----------------------#2022-05-31">https://infosecwriteups.com/hackthebox-lame-649ae6d39ac6?source=collection_archive---------3-----------------------#2022-05-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a2e0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">走查</h2></div><p id="4925" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嘿，伙计们，这一次我将从被认为是简单的Linux机器的<a class="ae lb" href="https://app.hackthebox.com/home" rel="noopener ugc nofollow" target="_blank"> Hackthebox </a>开始。</p><p id="e857" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">事不宜迟，我们来开发一下。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/0c649add20abf0af059dff40823b9164.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qIpRZfXl-IJGX8ZwZnYUTw.png"/></div></div></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="b91e" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">首字母:</h1><pre class="ld le lf lg gt mn mo mp mq aw mr bi"><span id="eb23" class="ms lw iq mo b gy mt mu l mv mw">export IP=10.129.99.7</span></pre><h2 id="c579" class="ms lw iq bd lx mx my dn mb mz na dp mf ko nb nc mh ks nd ne mj kw nf ng ml nh bi translated">端口扫描</h2><pre class="ld le lf lg gt mn mo mp mq aw mr bi"><span id="4551" class="ms lw iq mo b gy mt mu l mv mw">rustscan -a $IP --ulimit 5000 | ports.txt</span></pre><p id="ebe0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有三个开放的端口，即21 (ftp)、22 (ssh)、139 (samba)</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/0e4471d37672a121a8274ec2a483d21d.png" data-original-src="https://miro.medium.com/v2/resize:fit:774/format:webp/1*CUFBqbZIo-jFLAWKMqLXRA.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">rustscan结果</figcaption></figure><h2 id="af86" class="ms lw iq bd lx mx my dn mb mz na dp mf ko nb nc mh ks nd ne mj kw nf ng ml nh bi translated">nmap</h2><pre class="ld le lf lg gt mn mo mp mq aw mr bi"><span id="7fec" class="ms lw iq mo b gy mt mu l mv mw">nmap -sC -sV -p21,22,139 -oN namp $IP -Pn</span></pre><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nn"><img src="../Images/850bc7f8927944576dfbbebc5d93b0d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZsOXhNCMRuMaa6he9WJfg.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">nmap结果</figcaption></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="ca42" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">剥削</h1><h2 id="1f46" class="ms lw iq bd lx mx my dn mb mz na dp mf ko nb nc mh ks nd ne mj kw nf ng ml nh bi translated">文件传送协议</h2><p id="b9f4" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">我发现ftp允许匿名登录，所以我登录了FTP服务</p><pre class="ld le lf lg gt mn mo mp mq aw mr bi"><span id="c2e4" class="ms lw iq mo b gy mt mu l mv mw">ftp $IP</span></pre><p id="9100" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是没有文件。</p><p id="7404" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">后来我检查了<strong class="kh ir"> vsftpd 2.3.4 </strong>漏洞，发现了一个名为“<strong class="kh ir">后门</strong>的漏洞。我使用了Metasploit和其他脚本，但未能获得会话/shell。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/556160f8de410e3e801e4698e0d1fa26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*2R01BU5_grimuPyvU7GREw.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">无法利用FTP</figcaption></figure><p id="13e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">后来我在模块描述中发现</p><blockquote class="nu nv nw"><p id="fd94" class="kf kg nx kh b ki kj jr kk kl km ju kn ny kp kq kr nz kt ku kv oa kx ky kz la ij bi translated">该模块利用了添加到VSFTPD下载档案中的恶意后门。根据现有的最新信息，这个后门在2011年6月30日到2011年7月1日之间被引入vsftpd-2.3.4.tar.gz档案馆。这个后门在2011年7月3日被移除。</p></blockquote><h2 id="52ab" class="ms lw iq bd lx mx my dn mb mz na dp mf ko nb nc mh ks nd ne mj kw nf ng ml nh bi translated">桑巴舞</h2><p id="bea0" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">因为FTP漏洞没有用，而且我没有ssh证书，所以我选择了samba。有一个可写的共享名tmp，其某些文件不可访问。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi nn"><img src="../Images/c93cd6de9712323d349aa797e630f094.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hUJXkvDLQspwRHOCbILhKg.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">中小企业股份</figcaption></figure><p id="3136" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">发现samba名为“用户名映射脚本”命令执行的漏洞</p><p id="c73b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我从<strong class="kh ir"> </strong> <a class="ae lb" href="https://github.com/amriunix/CVE-2007-2447" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> GitHub </strong> </a>拿到了漏洞利用脚本并修改了有效载荷(并添加了一些微调XD)。</p><p id="5067" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">脚本的语法是</p><pre class="ld le lf lg gt mn mo mp mq aw mr bi"><span id="a1e4" class="ms lw iq mo b gy mt mu l mv mw">./username.py &lt;rhosts&gt; &lt;rport&gt; &lt;lhost&gt; &lt;lport&gt;</span></pre><p id="6852" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">→启动监听器</p><p id="0566" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">→运行脚本</p><p id="a518" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并以贝壳为根。不需要特权(:</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="a0e3" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">证明</h1><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/ce8cf0a5c26ca6eb21f9e710bfd1d04d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*Ig3cB94biMz9H2JgPbW_Og.png"/></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">用户和root.txt</figcaption></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="1f10" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">结尾部分</h1><p id="03f3" class="pw-post-body-paragraph kf kg iq kh b ki no jr kk kl np ju kn ko nq kq kr ks nr ku kv kw ns ky kz la ij bi translated">这就是这部机器的全部内容，我们将在下一篇博客中见面。再见，快乐黑客o7</p></div></div>    
</body>
</html>