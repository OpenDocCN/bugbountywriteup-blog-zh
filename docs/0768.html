<html>
<head>
<title>Write-Up 12- THM- Bolt</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向上写12- THM螺栓</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/write-up-12-thm-bolt-604ac90b7ba8?source=collection_archive---------0-----------------------#2020-08-16">https://infosecwriteups.com/write-up-12-thm-bolt-604ac90b7ba8?source=collection_archive---------0-----------------------#2020-08-16</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="e794" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">学习使用远程代码执行来利用易受攻击的CMS(内容管理系统)</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ki"><img src="../Images/3e05439e089e625cb01d701fd8410f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/0*lgzbSYYIAk9bN8k2.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">《闪电狗》这部动画电影的主角</figcaption></figure></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h2 id="e14d" class="lb lc it bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">使用远程代码执行利用CMS</h2><p id="c34e" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf lk mg mh mi lo mj mk ml ls mm mn mo mp im bi translated">这篇文章基于TryHackMe平台上的房间“Bolt”。这是一个初学者级别的房间，CMS版本中的一个漏洞被利用来获得目标机器上的根用户访问权限。</p><h2 id="5d7a" class="lb lc it bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">先决条件</h2><p id="40dc" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf lk mg mh mi lo mj mk ml ls mm mn mo mp im bi translated">推荐以下的知识来解决这个棘手的挑战<a class="ae mq" href="https://medium.com/@anon_7/write-up-07-tryhackme-toolsrus-6dfd8448e868" rel="noopener"> <strong class="lz iu">工具</strong> </a> <strong class="lz iu"> </strong>非常好用，可以在解决任务的时候搜索。</p><ol class=""><li id="a3cd" class="mr ms it lz b ma mt md mu lk mv lo mw ls mx mp my mz na nb bi translated">Nmap</li><li id="f231" class="mr ms it lz b ma nc md nd lk ne lo nf ls ng mp my mz na nb bi translated">Searchsploit</li><li id="df03" class="mr ms it lz b ma nc md nd lk ne lo nf ls ng mp my mz na nb bi translated">利用数据库</li><li id="3fe0" class="mr ms it lz b ma nc md nd lk ne lo nf ls ng mp my mz na nb bi translated">Metasploit</li><li id="ad4b" class="mr ms it lz b ma nc md nd lk ne lo nf ls ng mp my mz na nb bi translated"><a class="ae mq" href="https://medium.com/bugbountywriteup/write-up-10-tryhackme-linux-challenges-74408715ece4" rel="noopener">基本Linux命令</a></li></ol><blockquote class="nh ni nj"><p id="aa10" class="lx ly nk lz b ma mt ju mc md mu jx mf nl nm mh mi nn no mk ml np nq mn mo mp im bi translated">我强烈建议你们先试着自己解决这些任务，如果你遇到困难，你可以参考这篇文章。</p></blockquote><h2 id="bbe6" class="lb lc it bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><a class="ae mq" href="https://medium.com/@anon_7/getting-started-with-tryhackme-52f2cc7eb9aa" rel="noopener">入门</a></h2><p id="89aa" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf lk mg mh mi lo mj mk ml ls mm mn mo mp im bi translated">导航到THM上的房间“<a class="ae mq" href="https://tryhackme.com/room/bolt" rel="noopener ugc nofollow" target="_blank"> <strong class="lz iu">螺栓</strong> </a>”。部署机器并使用OpenVPN连接到THM网络。在终端上使用ifconfig命令检查tun0或tun1接口，确认您已连接到THM网络</p><h2 id="8e41" class="lb lc it bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">黑进机器</h2><p id="64f8" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf lk mg mh mi lo mj mk ml ls mm mn mo mp im bi translated">让我们对目标机器运行一次Nmap扫描，看看哪些端口是打开的，哪些类型的服务正在这些端口上运行</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/28bdc87deab6ead960b7e9d3a08a659f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*x-F2qmJXY36YKLzZH9cAIQ.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">对目标计算机进行Nmap扫描</figcaption></figure><p id="6ce5" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">正如我们从上面的Nmap扫描中看到的，三个端口当前是打开的。让我们逐一探讨这些问题。我们看到一个web服务器在端口80上运行。导航到目标机器IP，我们看到下面的页面。我们在这一页上没有发现什么有趣的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ns"><img src="../Images/cffca5f5d2d1a120301cac076c6f0f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0DvSnL4U275SCLWYafVduA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">在端口80上运行的web服务器</figcaption></figure><p id="7e5f" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">让我们试试端口8000，因为它也运行某种web应用程序</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi nx"><img src="../Images/eb4a307eedf90f582e697b4cb2b39917.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FF5FqmAFrGncUienwO8olg.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">螺栓CMS</figcaption></figure><p id="c8ff" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">从上面的截图中，我们可以看到一个CMS正在端口8000上运行。让我们探索一下，导航到不同的选项卡，看看我们是否能找到一些有趣的东西。所以我们找到了一个在即将到来的任务中可能有用的用户名。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ny"><img src="../Images/df45c4eca719770270a49713060eb320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkZZfAcx36WJRT6AhNOyRA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">找到用户名</figcaption></figure><p id="11ef" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">再往前走一点，我们找到了密码。说真的吗杰克？？？在网站上张贴密码的人。杰克最终可能会因此丢掉工作。不管怎样，让我们继续前进</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi nz"><img src="../Images/fc0f4149e69d2ecfd7c4333e9ec01f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTlO4wA2XDxnrzszNXSBGA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">找到密码</figcaption></figure><p id="7728" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">我们需要找到螺栓cms版本，以便我们可以找到一个漏洞相关的漏洞版本。为此我打算使用谷歌，搜索bolt cms门户我找到了一个链接，在那里我可以得到登录门户。所有你需要做的是追加“bolt”一词与你的目标IP和端口，如下所示。我们会得到一个博尔特cms登录页面。记得我们找到了用户名和密码，这是由杰克不小心张贴在网站上，我们将使用这些凭据登录</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oa"><img src="../Images/67adf2539a2157541017e9419a580ff2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9xU0PaCSK0ozChJsUaCuuA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">BOLT CMS登录门户</figcaption></figure><p id="8dee" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">只要我们输入凭据，我们欢迎与下面看到的页面。在这里，我们可以找到CMS版本在页面的左下方</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ob"><img src="../Images/16a58f051dcddc5f16286fc64022d1c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MubOkQpTrevFJmKE37Hfdw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">已登录Bolt CMS</figcaption></figure><p id="0fc9" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">接下来，我们需要为Bolt CMS的前一个版本找到EDB(漏洞利用-数据库ID)。您可以使用搜索利用或利用数据库来找出答案。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oc"><img src="../Images/b3bfb5403789181e216dbaf0bed64629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*owglVVeoVSLY6zRVlgWIcg.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">EDB–Bolt CMS 3 . 7 . 0的ID</figcaption></figure><p id="9c58" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">是时候利用我们刚刚发现的BOLT cms的当前版本了。为此，我们将使用Metasploit。启动Metasploit并搜索bolt。正如我们在下面所看到的，一个与BOLT认证的RCE相关的漏洞是可用的。通过输入命令use 1选择此漏洞利用。</p><blockquote class="nh ni nj"><p id="732e" class="lx ly nk lz b ma mt ju mc md mu jx mf nl nm mh mi nn no mk ml np nq mn mo mp im bi translated">注意:如果你在Metasploit中没有看到这个漏洞，你需要更新它</p></blockquote><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi od"><img src="../Images/92583fe21f04a9f308e972403fc7dd95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZD_IA5hkqEMX7Q0nQI-Qvw.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">发现Bolt CMS漏洞</figcaption></figure><p id="5c93" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">您需要设置目标计算机IP地址、端口编号、用户名、密码和本地主机IP地址等参数，如下所示</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oe"><img src="../Images/231e3c9fe86043679605421694d6d69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y52TFYEkqmgRLaqDVbN1RA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">设置利用漏洞的参数</figcaption></figure><p id="44d8" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">成功设置所有必需参数后。利用<strong class="lz iu">跑</strong>或<strong class="lz iu">剥削</strong>执行剥削。一段时间后，您将可以访问目标计算机，如下所示。输入命令id以检查您的权限级别，如下所示，我们已获得以root用户身份访问目标计算机的权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi of"><img src="../Images/80244b24e06ba6d98859236948e52487.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZWq1OaEZw0QoLf5Ln1TrA.png"/></div></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">外壳弹出，获得根访问权限</figcaption></figure><blockquote class="nh ni nj"><p id="0563" class="lx ly nk lz b ma mt ju mc md mu jx mf nl nm mh mi nn no mk ml np nq mn mo mp im bi translated">注:如果第一次尝试失败，也不要沮丧。试着多次运行它。检查您的THM网络，刷新连接，然后尝试再次运行该漏洞利用</p></blockquote><p id="16eb" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">现在我们有了对目标机器的根访问权，让我们来找到我们的标志。导航到主目录，我们发现我们的标志如下所示。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/aebba8dabd201811a56bbda5b7b13d86.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*H0zDlprv6t0YjT-HS80WYA.png"/></div><figcaption class="kq kr gj gh gi ks kt bd b be z dk translated">找到标志</figcaption></figure><p id="1b93" class="pw-post-body-paragraph lx ly it lz b ma mt ju mc md mu jx mf lk nm mh mi lo no mk ml ls nq mn mo mp im bi translated">我们的挑战任务到此结束。我希望这篇文章对你们有所帮助。有关更多的开发技术和工具，您可以在<a class="ae mq" href="https://medium.com/bugbountywriteup/write-up-04-tryhackme-blue-e3e58268ca22" rel="noopener">导航到这里</a></p></div><div class="ab cl ku kv hx kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="im in io ip iq"><h2 id="a505" class="lb lc it bd ld le lf dn lg lh li dp lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">关于我</h2><p id="9a1e" class="pw-post-body-paragraph lx ly it lz b ma mb ju mc md me jx mf lk mg mh mi lo mj mk ml ls mm mn mo mp im bi translated">我是一个网络安全爱好者，正在攻读信息安全硕士学位，并试图进入一个全职的网络安全职业。你可以在这里<a class="ae mq" href="https://medium.com/@anon_7" rel="noopener"/>继续进行更多的总结和演练</p></div></div>    
</body>
</html>