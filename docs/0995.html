<html>
<head>
<title>Bcrypt — Account TakeOver Due To Weak Encryption — #HR51KDB</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Bcrypt —由于弱加密导致的帐户接管— #HR51KDB</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bcrypt-account-takeover-due-to-weak-encryption-hr51kdb-4418f6e65907?source=collection_archive---------2-----------------------#2020-11-29">https://infosecwriteups.com/bcrypt-account-takeover-due-to-weak-encryption-hr51kdb-4418f6e65907?source=collection_archive---------2-----------------------#2020-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6dba47543c49d2884422b6e7c04012c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qB5mAsAviIAMhxBJJh9uzw.png"/></div></div></figure><p id="aca4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘿伙计们！我希望你们都平安无事。非常感谢您对我之前的<a class="ae kw" href="https://medium.com/bugbountywriteup/api-token-hijacking-through-clickjacking-2e36c02e6c48" rel="noopener"><strong class="ka ir"/></a>博客感兴趣，并使之成为InfoSec报道的第一篇<a class="ae kw" href="https://twitter.com/darklotuskdb/status/1276909010029969408?s=20" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">病毒性</strong> </a>博客文章。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/3177407f256f882aabb2c23a4e3095de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JBiMsJPfPJZwRgV-SzjtaQ.jpeg"/></div></div></figure><p id="5003" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我最近在测试一个私人程序，让我们以<strong class="ka ir">target.com</strong>为例。在登录页面上，有一个功能“OTP登录”。其中OTP被发送到注册的移动号码。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/109d555795ae03377072a2c107e9fb27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*xUEePkpZEbeStontCk7rPw.jpeg"/></div></figure><p id="11cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了检查OTP是否在响应体中泄漏，我在burp中截取了“OTP Log In”请求。是的，我是对的。动态口令在名称为“otpPassword”的响应正文中泄漏，但动态口令是加密格式，即<a class="ae kw" href="https://bcrypt-generator.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Bcrypt </strong> </a>。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ld"><img src="../Images/549e7ca261bf4bfa2a2ac5c03c534c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xl97BZYF8r5O-Z817TM6dg.jpeg"/></div></div></figure><p id="d8be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个好看的<a class="ae kw" href="https://github.com/BREAKTEAM/Debcrypt" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">工具</strong></a><strong class="ka ir"/>(<a class="ae kw" href="https://github.com/BREAKTEAM/Debcrypt" rel="noopener ugc nofollow" target="_blank">【https://github.com/BREAKTEAM/Debcrypt】</a>)<strong class="ka ir">，</strong>的帮助下，我轻松解密了OTP值，成功夺下了受害者的账号。</p><p id="ff91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤:</strong></p><ol class=""><li id="3a96" class="le lf iq ka b kb kc kf kg kj lg kn lh kr li kv lj lk ll lm bi translated">" OTP password ":" $ 2a $ 10 $ hs/tvukd 4 gveedx/hacrdehwza 38 z1n cmaefeotg 77/l . Ja0ktuQa "</li></ol><p id="37c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.复制Bcrypt加密值来解密它。</p><p id="f54c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.为此工具提供了价值。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/11ab41268d10caa49196555dcadce289.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ldyEExGS_Jyec04mIhp0Cg.jpeg"/></div></div></figure><p id="35e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.登录的OTP是“12345”。</p><p id="a72e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.ATO成功了。</p><p id="23ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢这篇文章！，在<a class="ae kw" href="https://twitter.com/darklotuskdb" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">推特</strong> </a>上关注我一些很酷的小技巧。</p></div></div>    
</body>
</html>