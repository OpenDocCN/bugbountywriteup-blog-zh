<html>
<head>
<title>Facebook Invitees Email Address Disclosure</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">脸书受邀者电子邮件地址披露</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/facebook-invitees-email-address-disclosure-25059ae93725?source=collection_archive---------2-----------------------#2019-01-21">https://infosecwriteups.com/facebook-invitees-email-address-disclosure-25059ae93725?source=collection_archive---------2-----------------------#2019-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2105" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">注:以下文章发表于2016年03月04日https://FogMarks.com</em><a class="ae km" href="https://fogmarks.com/2016/04/03/facebook-invitees-email-addresss-disclosure/" rel="noopener ugc nofollow" target="_blank"><em class="kl"/></a></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/aa6ba780c0bc06ad5cfbe4d6ba70b8a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Kb0Btdka29Pks2ep.jpg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated"><a class="ae km" href="https://de.wikipedia.org/wiki/Willy_St%C3%B6wer" rel="noopener ugc nofollow" target="_blank">威利·斯托尔</a>画的沉船</figcaption></figure><p id="2835" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi ld translated">当脸书还是一个只有几个成员的小公司时，它需要一种方法来吸引更多的成员。</p><p id="48e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，如果你想让更多的人访问你的网站，你可以在脸书上做广告，因为每个人都在那里。</p><p id="67b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当时，主要的广告选择是在热门网站上手动发布广告(比如使用谷歌)，或者让你的会员用他们的电子邮件账户邀请他们的朋友。</p><h1 id="dd13" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">脸书过去的邀请制度</h1><p id="62d5" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">当用户在早期加入脸书时，实际上没什么可看的。因此，脸书要求他们的成员使用注册用户创建的电子邮件邀请邀请他们的朋友。</p><p id="8e7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户提供了他朋友的电子邮件地址，他们收到了一封来自脸书的邮件，邮件中写道“X先生现在在脸书，你也应该加入！”。</p><h1 id="4be3" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">有趣的部分</h1><p id="6510" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">当我发现脸书的这个特点时，我立即开始分析它。</p><p id="848a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我觉得试着愚弄一下用户Y邀请他们加入会很不错，尽管做这件事的人是用户x。</p><p id="c1c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我一次又一次地邀请人们时，我注意到了一些有趣的事情:每个特定电子邮件地址的邀请都包含一个邀请ID: ent_cp_id。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mp"><img src="../Images/7935464839f9bc548c8026a9287956d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7saM7THnynzDOISE.png"/></div></div></figure><p id="5c4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当点击邀请到脸书时，弹出一个小窗口，显示被邀请者的完整电子邮件地址。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/498a9b58ff52260a2075b74d8d1c1ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/0*CETLS1xW1UZCrx5P.png"/></div></figure><p id="1b1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我写下了某个我想邀请的邮件的ent_cp_id，邀请了他一次。</p><p id="f41c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时我想:“好吧，我已经邀请了这个用户，他的ent_cp_id应该不能再访问了”。但我错了。它的ent_cp_id仍然在那里。事实上，通过简单地重新发送HTTP请求，我可以再次邀请同一个用户。</p><p id="540d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是这个漏洞最有趣的部分是，任何用户都可以看到ent_cp_id后面的电子邮件地址。</p><p id="c06e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着任何通过电子邮件被邀请到脸书的人都容易受到电子邮件地址泄露的影响，因为该邀请从未被删除过<strong class="jp ir">并且任何用户都可以访问到它。攻击者接下来要做的就是随机猜测ent_cp_ids。我说过，旧的ent _ cp _ ids不删除，所以成功率很高。</strong></p><h1 id="b672" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">结论</h1><p id="bcef" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">当你处理像电子邮件地址这样的敏感信息时，你应该总是限制一个动作被执行的次数。此外，建议删除任何可能与敏感信息相关联的id，或者至少对其进行哈希保护。</p><p id="e416" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">脸书很快解决了这个问题，并给了一笔丰厚的奖金。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div></div>    
</body>
</html>