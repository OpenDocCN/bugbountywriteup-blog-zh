<html>
<head>
<title>Don’t stop at one bug $$$$</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不要停留在一个错误上</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/dont-stop-at-one-bug-d3c56806b5?source=collection_archive---------2-----------------------#2020-07-10">https://infosecwriteups.com/dont-stop-at-one-bug-d3c56806b5?source=collection_archive---------2-----------------------#2020-07-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d60d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单个程序中的3个严重错误[本地文件窃取、Java Script注入、打开重定向]</p><h2 id="abbf" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">首先我要感谢所有支持我的读者:)</h2><p id="1c6b" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">大家好，</p><p id="741c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi lj translated">今天我要谈谈我在一个私人项目上提交的东西，在这个项目上，我提交了三个关键的bug，它是基于#Android的。每当谈到android bug赏金，我更喜欢从反编译APK开始。不过这次我确实用了“<a class="ae ls" href="https://github.com/skylot/jadx/releases" rel="noopener ugc nofollow" target="_blank">T3】JADx-GUIT5”。</a></p><p id="cb91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了更好地理解，我将使用一个示例应用程序。</p><p id="d960" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你只需要打开JADx-GUI →文件→打开文件→company-app . apk &amp; Open "<em class="lt">androidmanifest . XML</em>"</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lu"><img src="../Images/10196ce48746de348c7694fcf2c17abb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*2JNeuqDNRbPiSF8FAuwMVw.gif"/></div></div></figure><p id="29b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在你需要搜索"<em class="lt"> AndroidManifest.xml </em>"中的<strong class="jp ir"><em class="lt">Android:exported = " true "</em></strong>活动，我找到了一个。</p><blockquote class="mg mh mi"><p id="8f23" class="jn jo lt jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">点击此链接了解更多关于<strong class="jp ir"><em class="iq">Android:exported = " true ":</em></strong><a class="ae ls" href="https://developer.android.com/guide/topics/manifest/activity-element" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/guide/topics/manifest/activity-element</a></p></blockquote><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mm"><img src="../Images/76a9e30f7571dddc288b873a3d8af583.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRwUVmKti8aVFc401LKzIg.png"/></div></div></figure><blockquote class="mg mh mi"><p id="e8d0" class="jn jo lt jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated"><strong class="jp ir">注意:</strong>“导出”的活动、服务或内容可以被其他应用程序访问。这使得导出的组件易受攻击。；)</p></blockquote></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="22e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi lj translated">问题来了——我们可以如何利用什么样的漏洞？</p><p id="2ff2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们弄清楚:例如，考虑活动名称为<strong class="jp ir">"<em class="lt">app . company . ui . events . web . webview activity</em>"</strong></p><p id="5d16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在JADx-GUI中打开此活动→搜索“<em class="lt"> SetJavascriptEnable </em>”</p><blockquote class="mg mh mi"><p id="aa87" class="jn jo lt jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">点击此链接了解关于“<strong class="jp ir"><em class="iq">setjavascript enable</em></strong>”<br/><a class="ae ls" href="https://developer.android.com/reference/android/webkit/WebSettings#setJavaScriptEnabled" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/reference/Android/WebKit/web settings # setjavascript enabled</a></p></blockquote><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi mu"><img src="../Images/cf33493007ad7ae01144e11fec1d4673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Wde2bdsU1BGZBhEjWKaVw.png"/></div></div></figure><blockquote class="mg mh mi"><p id="4332" class="jn jo lt jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">您可以看到该活动包含"<em class="iq"> SetJavaScriptEnabled </em>"</p></blockquote><p id="d347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在关注两个方面:</p><p id="f0b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">片段#1 </strong></p><p id="887b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">* * Code:→<strong class="jp ir">"<em class="lt">intent . putextra(" EXTRA _ URL "，str)；"</em>T44】</strong></p><p id="8635" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在android中"<strong class="jp ir"><em class="lt">【putExtra】</em></strong><em class="lt">(String name，str) </em>"用于将扩展数据添加到intent中。它有两个参数，第一个指定了<strong class="jp ir">名称</strong>中的哪一个额外数据，第二个参数是<strong class="jp ir">数据</strong>本身。</p><p id="74b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">片段#2 </strong></p><p id="b9da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">**代码:→ " <strong class="jp ir"> <em class="lt"> loadUrl(getIntent()。getstring EXTRA(" EXTRA _ URL ")；"</em> </strong></p><p id="3193" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，<strong class="jp ir"><em class="lt">getIntent</em></strong><em class="lt">()</em>返回开始这个活动的意图。如果你用一些数据开始一项活动。</p><blockquote class="mg mh mi"><p id="1613" class="jn jo lt jp b jq jr js jt ju jv jw jx mj jz ka kb mk kd ke kf ml kh ki kj kk ij bi translated">让我们把它变得非常简单和简短，<strong class="jp ir">"<em class="iq">intent . putextra(" EXTRA _ URL "，str)；"</em> </strong>的意思是，<strong class="jp ir"> <em class="iq"> </em> </strong>你可以把<strong class="jp ir"><em class="iq">【EXTRA _ URL】</em></strong>看成一个变量&amp;<strong class="jp ir"><em class="iq">getStringExtra(" EXTRA _ URL "))</em></strong>这里用来从<strong class="jp ir"><em class="iq">【EXTRA _ URL】</em></strong>变量中获取数据或值。</p></blockquote><h1 id="b334" class="mv km iq bd kn mw mx my kq mz na nb kt nc nd ne kw nf ng nh kz ni nj nk lc nl bi translated"><strong class="ak">概念验证</strong></h1><ol class=""><li id="cc18" class="nm nn iq jp b jq le ju lf jy no kc np kg nq kk nr ns nt nu bi translated">再现<strong class="jp ir"> OpenRedirect </strong>:</li></ol><p id="d098" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">am start-W-n app . company/. ui . events . WEB . webview activity-a</em>ACTION _ OPEN _ WEB<em class="lt">-e EXTRA _ URL</em><a class="ae ls" href="https://evil.com" rel="noopener ugc nofollow" target="_blank"><em class="lt">https://evil.com</em></a></p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nv"><img src="../Images/230d2982d0955df499c3b281e2fd37a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pl8Nn8lTV5_-eJBQm141uA.png"/></div></div></figure><p id="8189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.再现<strong class="jp ir"> Javascript注入</strong>:</p><p id="55c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="lt">app . company . ui . events . web . webview activity</em></strong>不验证传递给intent的数据，因此该活动也容易受到Javascript注入的攻击。</p><p id="404a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">am start-n app . company/. ui . events . WEB . webview activity-a ACTION _ OPEN _ we B- e EXTRA _ URL " JavaScript://Google . com % 0A alert(lol)；"</em></p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nw"><img src="../Images/6dc727c9d2a53d299211123d13ba0d7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PhZkSu25DjAllfxkvuZf4A.png"/></div></div></figure><p id="bf87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.再现<strong class="jp ir">本地文件窃取</strong>:</p><p id="1bf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该错误可能:<br/> →在应用程序沙箱中显示令牌、授权、配置等<br/> →在应用程序沙箱中显示用户数据<br/> →访问“/sdcard”数据，如果允许的话</p><p id="f0df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">am start-n<em class="lt">app . company</em>/. ui . events . WEB . webview activity-a ACTION _ OPEN _ we B- e EXTRA _ URL ' file:///SD card/personal . txt '</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi nx"><img src="../Images/89d5a6c56133ccaa9b2d2479206152a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14OhFJCsJ5tXrQ1WyOd7JQ.png"/></div></div></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="f77c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我如何在一个私人程序中报告三个关键错误的。嘣！！！$$$$</p><figure class="lv lw lx ly gt lz gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/32a29bdae97e6723c25dbee0a98e9ddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/1*ONkYronjnq7WWk0IAwqa9g.gif"/></div></figure><p id="45c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很高兴与你们所有人联系:)我希望你能得到一些动力去做bug赏金，并在下一篇文章中再次见到你。</p><p id="b423" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">推特简介:@ </em> <a class="ae ls" href="https://twitter.com/Dheerajmadhukar" rel="noopener ugc nofollow" target="_blank"> Dheerajmadhukar </a></p><p id="9387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt"> Linkedin个人资料:@</em><a class="ae ls" href="https://www.linkedin.com/in/dheerajtechnolegends/" rel="noopener ugc nofollow" target="_blank">dheerajtechnolegends</a></p></div></div>    
</body>
</html>