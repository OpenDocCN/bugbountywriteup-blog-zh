<html>
<head>
<title>Vulnerabilities in JS based Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于JS的应用程序中的漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/vulnerabilities-in-js-based-applications-397e0dc90124?source=collection_archive---------0-----------------------#2022-06-17">https://infosecwriteups.com/vulnerabilities-in-js-based-applications-397e0dc90124?source=collection_archive---------0-----------------------#2022-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/fbebd669748cd19802abd0ebd8b26021.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*8mbMihOcjOTdVrD7"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">琼·加梅尔在<a class="ae kf" href="https://unsplash.com/s/photos/javascript?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8f20" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">简介</strong></p><p id="7d0b" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">如今，开发人员越来越倾向于用JavaScript编写框架。当我们在为客户执行渗透测试的过程中前进时，我们会遇到大量基于JS的应用程序。由于next.js、vue.js和其他类似的东西具有针对漏洞的某些内置保护措施，相当多的web3开发者现在采用这些技术，以便更轻松地设计他们的网站。</p><p id="5992" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">由于各种原因，预计这一趋势在未来几年将会加剧。最常见的原因是它们内置了一些安全保护。例如，如果你考虑Django，它在默认情况下对一些攻击免疫，如CSRF和SQL注入，因为他们通常有视图状态参数来对抗CSRF漏洞。如果你考虑基于JavaScript的框架，比如React、VueJS、NextJS、NuxtJS等等。他们内置了XSS投影。所以，除非你故意让它变得脆弱，否则你不会遇到XSS(在大多数情况下)。</p><p id="4ddc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是，XSS、CSRF、SQL注入只是使应用程序易受攻击的几种攻击。仍然有很多易受攻击的漏洞。</p><p id="ca7a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇博文中，我们将讨论一些你可以在基于JS的框架中发现的漏洞。</p><h1 id="08df" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">文件上传旁路</strong></h1><p id="59a6" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">当您能够绕过应用程序在上传文件时应用的限制时，就会出现上传绕过漏洞。</p><p id="7f79" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">这些类型的文件上传漏洞会给组织带来很多威胁。它还能够将攻击传递到后端系统、客户端攻击、简单的破坏以及过载的文件系统或数据库。这取决于应用程序在文件上传后如何处理它，尤其是它将文件存储在哪里。</p><p id="9f07" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">仅在客户端应用黑名单仍然非常普遍。这些应用程序大多只允许你上传一个. png。jpg或. gif文件。</p><p id="42ae" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">但是您可以尝试上传一个恶意的SVG文件或任何其他文件来证明客户端的限制很容易被绕过。你也可以把一个恶意的负载放在一个SVG文件中，然后上传它。这些上传的SVG文件可用于许多不同的攻击，例如执行XSS，将用户重定向到不同的网站，或者危害用户的cookies(如果它们的范围是存储文件的子域)。</p><h1 id="0d8a" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">打开重定向</strong></h1><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/3b15bfbf6a7fc7d8b34b5dc93b4ed7ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*BjovrLq5qzyxscGy"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://spanning.com/blog/open-redirection-vulnerability-web-based-application-security-part-1/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="bd68" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">另一个常见的漏洞是开放重定向。当应用程序允许用户操作重定向或转发到不同的URL时，该应用程序就被称为存在开放重定向漏洞。如果应用程序不验证来自不受信任用户的输入，恶意用户可能会提供一个URL，将不知情的受害者从真正的域引导到恶意用户控制的网络钓鱼站点。</p><p id="21b8" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，【https://login.company.com/login.aspx?】T4_ redirect = https://attack . XYZ</p><p id="905e" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，在上面的URL中，攻击者可以很容易地操纵重定向参数，如果应用程序没有正确验证这一点，用户将被重定向到恶意域。</p><p id="0c7c" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，一旦用户登录到应用程序，用户通常应该被重定向到开发人员指定的同一个域或不同的域，但由于我们已经将_redirect参数修改为<a class="ae kf" href="https://attacker.xyz" rel="noopener ugc nofollow" target="_blank"> https://attacker.xyz </a>，受害者将被重定向到<a class="ae kf" href="https://attacker.xyz" rel="noopener ugc nofollow" target="_blank"> https://attacker.xyz </a>。攻击者可以在他的站点上托管恶意软件，甚至是一个钓鱼页面，让用户暴露其凭据。</p><h1 id="91f0" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">授权失败</strong></h1><p id="72fe" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">这种类型的错误在任何应用程序中都很常见。当用户能够访问或修改默认情况下他/她不能访问的资源时，就会出现授权问题。</p><p id="140f" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因为在所有端点实现授权检查有些困难，所以执行授权测试可能非常有利可图，应该尽可能地进行。在许多情况下，授权失败的严重性要高于XSS漏洞。这些授权缺陷会导致对敏感信息的未授权访问、对属于其他用户的信息的修改以及对属于这些个人的信息的访问。</p><p id="a018" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以手动检查授权和权限提升问题，也可以使用Autorize自动检查。Autorize是一个BurpSuite扩展，它帮助您自动处理权限提升和授权问题。</p><h1 id="0931" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">认证旁路</strong></h1><p id="d82a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">无论是单因素还是多因素身份认证，如果实施不当，都可能被绕过。这可能导致完全绕过登录屏幕。这可能是由于SQL注入、NoSQL注入、XPATH注入。</p><p id="2373" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">通常，当实现2FA时，您可以在输入有效密码后完全绕过它，只需打开一个不同的端点。这可能是由于会话混乱或简单的逻辑缺陷绕过造成的。</p><p id="c406" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，您知道一旦您输入了密码和端点，网站就会将您带到/dashboard端点。你可以核实这个信息。</p><p id="2573" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">您可以做的是，在输入密码后，当应用程序将您重定向到/otp端点以输入otp时，您可以改为拦截请求并将端点更改为/dashboard。这可以通过将浏览器地址栏中的端点更改为/dashboard来实现。</p><h1 id="e38b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">跨站点请求伪造(CSRF) </strong></h1><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mm"><img src="../Images/b715f9b92b0dc8488422a60a8d4ced19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VnefsvAr8TPuJp2G"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://medium.com/@ashifm4/protection-from-cross-site-request-forgery-csrf-9cf4f542e268" rel="noopener">来源</a></figcaption></figure><p id="ef3a" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">跨站点请求伪造(CSRF)是一种客户端技术，用于攻击web应用程序的其他用户。这是一个漏洞，允许攻击者诱导用户执行他们不打算执行的操作。因为应用程序已经将cookies附加到发送到网站的请求中，所以攻击者可以利用这种情况的权限。这种攻击只需要一种简单的社会工程技术来实施攻击。</p><p id="be76" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">默认情况下，CSRF攻击不会对Django框架起作用，但是基于JavaScript的框架仍然需要实现这个功能。因此，当特权或非特权用户执行任何功能时，CSRF令牌丢失是很常见的。现在很多网站都有相同的站点cookie属性，默认情况下不会让CSRF攻击发生。</p><h1 id="ddec" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">结论</strong></h1><p id="9504" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">在博客的这篇文章中，我们讨论了在评估基于JavaScript的框架时应该注意的一些漏洞。除此之外，您还可以检查OAuth问题、信息泄漏、XXE攻击和请求走私攻击。</p><p id="1899" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">即使这些能抵抗XSS有效载荷，确保没有也没什么坏处。我们经常在不同个人的用户面板上看到自我反映XSS的例子。因此，我们总是建议在网站上进行VAPT，然后再把它们放到网上。</p></div></div>    
</body>
</html>