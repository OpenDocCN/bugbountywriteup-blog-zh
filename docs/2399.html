<html>
<head>
<title>CVE-2022–27492: An integer underflow in WhatsApp causing remote code execution when receiving a crafted video file</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CVE-2022–27492:WhatsApp中的整数下溢导致在接收特制视频文件时远程执行代码</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cve-2022-27492-an-integer-underflow-in-whatsapp-causing-remote-code-execution-when-receiving-a-b50bebae14f4?source=collection_archive---------1-----------------------#2022-09-28">https://infosecwriteups.com/cve-2022-27492-an-integer-underflow-in-whatsapp-causing-remote-code-execution-when-receiving-a-b50bebae14f4?source=collection_archive---------1-----------------------#2022-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0036" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作者:<a class="ae kl" href="https://www.instagram.com/_ansh_vyas/" rel="noopener ugc nofollow" target="_blank">安舒尔·维亚斯</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/2d3d7aed6f71cfb398be6e119cb0c416.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yKVwmJC_Ts2jl4Uv"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated"><a class="ae kl" href="https://unsplash.com/@eyestetix?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Eyestetix工作室</a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><h1 id="5850" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">概观</h1><p id="c149" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">由于WhatsApp中的整数下溢，精心编制的视频文件可能会触发远程代码执行。组件视频文件处理程序的一个未指定代码块受此RCE错误影响。此漏洞是由操纵可能损坏内存的未知输入引起的。恶意攻击者需要说服用户播放放入WhatsApp messenger的特制视频文件，才能利用此漏洞。</p><h1 id="f186" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">整数下溢</h1><p id="0477" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">将负值赋给一个在赋值时应该始终为正的数，会在执行算术整数运算时导致整数下溢错误。如果将值为-120和-9的两个8位二进制补码整数相加，得到的二进制补码数为-129，小于可能的最小二进制补码数(-128)。在这种情况下，大整数已经下溢。这是危险的，因为当以目标整数大小解释时，结果将具有不同的含义。</p><p id="1328" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果解释为8位二进制补数，则-129就是127。如果一个负数(意味着其最高有效位被置位)被加到一个非负数(意味着其最高有效位未被置位)上，就会发生整数下溢。将两个符号不同的数字相加时，不会发生整数溢出。可以用类似的方式检查是否发生了整数溢出。</p><p id="f264" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">带有负值的数组索引错误是整数下溢错误的典型例子。这种类型的弱点通常会导致崩溃和未定义的行为。当循环索引变量溢出时，也很有可能出现无限循环。</p><h1 id="c6c5" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">发生整数下溢的结果</h1><p id="205b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">整数的上溢、下溢或舍入可能会导致以下结果:</p><ol class=""><li id="bdbf" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">如果程序中发生整数溢出或下溢，数学计算将产生不准确的结果。</li><li id="57a3" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">使用变量来控制循环可能会导致无限循环，如果由于整数溢出而从未到达该变量，则会导致无限循环，如果条件从未满足，则会导致无限循环。</li><li id="feec" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">当使用变量来确定分配给缓冲区的内存量时，整数溢出导致的负值可能会导致系统崩溃。</li></ol><h1 id="3a28" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="0533" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通过为用于存储整数值的变量分配正确的内存量，可以避免整数溢出和下溢。某些编程语言中的特殊数据结构可以检测到整数溢出。开发人员应该采取所有必要的步骤来防止这种运行时错误。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="77de" class="na ld iq bd le nb nc dn li nd ne dp lm jy nf ng lq kc nh ni lu kg nj nk ly nl bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>