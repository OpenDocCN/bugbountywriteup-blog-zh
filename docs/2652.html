<html>
<head>
<title>Param Hunting to Injections</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">注射参数搜索</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/param-hunting-to-injections-4365da5447cf?source=collection_archive---------1-----------------------#2022-12-16">https://infosecwriteups.com/param-hunting-to-injections-4365da5447cf?source=collection_archive---------1-----------------------#2022-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0aaa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">嘿黑客们！你这周过得怎么样？</h2></div><p id="289d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们又回到了另一个博客。</p><p id="3920" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">今天我们将讨论注射液的有效参数搜索</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/4b3815b3ce16d83ffe98280c5ba5ee05.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*I33Yi-NXdCJT6zzlt0tbLQ.gif"/></div></figure><p id="df92" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以最近我们一直在做一个私人项目。姑且称之为<em class="lj">redacted.com</em>。</p><p id="7d59" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为有很多子域，我们想到根据<em class="lj">内容长度</em>过滤子域，以找到提供大量功能的域。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lk"><img src="../Images/13ba6de29d3e042fa115225bbd6e42b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bNwJtD32njEvAFLO"/></div></div></figure><p id="66cd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以经过筛选后，我们登陆了有登录页面的<sub.redacted.com>。</sub.redacted.com></p><p id="4603" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最初，我们在寻找BAC同时，我们注意到，当我们在登录页面上输入无效凭证时，它会在url中响应一个错误参数。</p><p id="db9b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">于是，我们很快开始注入<em class="lj"> XSS </em>有效载荷，以生成<em class="lj"> XSS </em>，但没有运气，因为我们无法绕过过滤。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/738615b004dc858b9c5376271c05d399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/0*2cyUSkg9GAX7o8Kk"/></div></figure><p id="7bf1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们开始测试密码重置功能后不久。</p><p id="91b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们注意到，在输入任何无效的电子邮件后，url中没有生成错误参数，因此我们考虑手动添加该参数。</p><p id="ee3b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">令我们惊讶的是，参数实际上反映。</p><p id="0fbd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们再次尝试注入<em class="lj"> XSS </em>有效载荷，但是WAF阻止了一切。</p><p id="812c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们想到使用标签来平衡，因为and boom来了<strong class="kh ir"> HTML注入</strong>。</p><p id="d552" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们知道你在想什么，是的，IFRAME完成了剩下的工作。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/9f9967b2bf71b17225bf56fa9c1a3301.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/1*IRl67FxRuy8-t3pVALBArg.gif"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lr"><img src="../Images/0e7cfcd15c47b8c3ad78879ca4deb94a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*LaHEhOeDT5mc38Xx"/></div></div></figure><p id="6251" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">查找隐藏参数:</strong></p><p id="b86a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有很多像Paramminer、Arjun、x8等工具可以帮助我们找到隐藏的参数，但不幸的是，在我们的例子中，这两种工具都不起作用，因为参数可能不在默认的单词列表中。</p><p id="7d7d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">主动参数搜索:</strong></p><p id="ad44" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">主动参数搜索有助于检测所有参数并生成自定义的目标特定单词列表。</p><p id="6a34" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了创建一个自定义单词表，我们需要提取所有与领域相关的参数，为此我们将使用这个漂亮的工具<a class="ae ls" href="https://github.com/xnl-h4ck3r/GAP-Burp-Extension" rel="noopener ugc nofollow" target="_blank"> <em class="lj"> getAllParams </em> </a>。</p><h2 id="cbd2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">步骤:</h2><ol class=""><li id="01e3" class="mm mn iq kh b ki mo kl mp ko mq ks mr kw ms la mt mu mv mw bi translated">在您的burp套件中下载并配置<a class="ae ls" href="https://github.com/xnl-h4ck3r/GAP-Burp-Extension" rel="noopener ugc nofollow" target="_blank"> getAllParams </a>扩展</li><li id="c7f7" class="mm mn iq kh b ki mx kl my ko mz ks na kw nb la mt mu mv mw bi translated">现在开始自动和手动抓取网站。</li></ol><p id="0b9b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">手动测试和自动化的结合总会比盲目使用脚本提供更好的结果</p><p id="b457" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.现在目标-&gt;站点地图-&gt;选择目标-&gt;右击-&gt;扩展-&gt;获取所有参数(GAP)</p><p id="9986" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">4.将所有提取的参数保存在一个文件中</p><p id="c6b8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">5.您也可以使用<em class="lj"> gau </em>、<em class="lj"> wayback </em>、<em class="lj"> Katana </em>或任何其他工具收集所有URL，然后从提取的URL中提取所有参数。</p><p id="a62e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们已经编写了一个非常基本的脚本，它可以从各种工具收集的URL中提取所有参数:</p><p id="20a4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://github.com/302Found1/Param-Extract" rel="noopener ugc nofollow" target="_blank"><em class="lj">【Param-Extract】</em></a><em class="lj">(耶懒的剧本但作品也是我们以后会更新的)</em></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nc"><img src="../Images/0873cb0698dca7c05ca5e6c7b69f14ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*T_c2gQLAjoCJFokm"/></div></div></figure><p id="744b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">或者，您也可以使用下面的一行程序通过展开工具提取url:</p><blockquote class="nd ne nf"><p id="ca9e" class="kf kg lj kh b ki kj jr kk kl km ju kn ng kp kq kr nh kt ku kv ni kx ky kz la ij bi translated">分类网址|展开格式% q | cut-d " = "-f1 | sort-u &gt; params . txt</p></blockquote><p id="10d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.现在合并param文件和sort -u</p><p id="f6cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">7.一旦创建了包含所有参数的自定义单词表，就可以很容易地使用Paraminer burp扩展来发现隐藏的参数。</p><p id="3882" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">8.一旦您确定了隐藏的参数，您就可以基于案例场景测试各种注入或其他错误。</p><p id="711f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">狩猎愉快！！！！</p><p id="f50a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">作者:</strong></p><p id="62f2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">瓦伊巴夫·拉哈尼:</p><p id="4221" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://www.linkedin.com/in/vaibhav-lakhani" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vaibhav-lakhani</a>T12】https://twitter.com/vlakhani28</p><p id="4960" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Dhir Parmar<a class="ae ls" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">:</a></p><p id="b801" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dhir-parmar-925b171a4</a>T18】https://twitter.com/dhirparmar</p><p id="e6cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://www.linkedin.com/company/302found/" rel="noopener ugc nofollow" target="_blank">302发现</a>:</p><p id="b8b2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae ls" href="https://twitter.com/_302Found" rel="noopener ugc nofollow" target="_blank">https://twitter.com/_302Found</a>T24】https://www.linkedin.com/company/302found/T26】https://github.com/302Found1/</p><p id="3716" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你也可以给我们买杯咖啡，如果你喜欢的话:<a class="ae ls" href="https://www.buymeacoffee.com/302found" rel="noopener ugc nofollow" target="_blank">https://www.buymeacoffee.com/302found</a></p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><h2 id="96c9" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ls" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>