<html>
<head>
<title>Open Redirect Scanner with Uber.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带Uber.com的开放式重定向扫描仪</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/open-redirect-scanner-c72cd60d0bf?source=collection_archive---------0-----------------------#2016-10-10">https://infosecwriteups.com/open-redirect-scanner-c72cd60d0bf?source=collection_archive---------0-----------------------#2016-10-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1d07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">搜索假人重定向:)</p><p id="ef6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">WTF是一个开放的重定向扫描器？</p><p id="1f35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当web应用程序接受不受信任的输入时，未经验证的重定向和转发是可能的，这可能导致web应用程序将请求重定向到不受信任的输入中包含的URL。通过修改恶意站点的不可信URL输入，攻击者可以成功发起网络钓鱼诈骗并窃取用户凭据。因为修改后的链接中的服务器名称与原始站点相同，所以网络钓鱼企图可能看起来更可信。未经验证的重定向和转发攻击也可用于恶意创建URL，通过应用程序的访问控制检查，然后将攻击者转发到他们通常无法访问的特权功能。</p><p id="26b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参考:<a class="ae kl" href="https://www.owasp.org/index.php/Open_redirect" rel="noopener ugc nofollow" target="_blank">https://www.owasp.org/index.php/Open_redirect</a></p><p id="7d4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">扫描仪:</p><p id="6675" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在对uber的研究中，我需要一个工具来扫描查看跳转到最终url目的地的请求的跟踪，并查看是否有一个uber域列表可以强制重定向到其他外部站点。有几行代码的python是最好的解决方案。为什么危险是一个开放的重定向？因为攻击者可以发送url并强制将用户重定向到恶意站点，执行恶意脚本或网络钓鱼敏感数据。</p><p id="e98f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是使用打开重定向扫描仪工具的示例视频:</p><p id="6d39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">扫描仪发现一个开放的超级子域名重定向，并显示如何被迫加载www.yahoo.com的<a class="ae kl" href="http://www.yahoo.com" rel="noopener ugc nofollow" target="_blank">网站:</a></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="f5f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">报告了该问题，但优步决定不修复，因为不认为这对其用户有风险</p><p id="caf7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">工作怎么样？</p><p id="ad68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当域是vuln时，扫描仪显示303错误代码(参见其它代码)</p><p id="d93a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击:</p><p id="afbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">比如这个域名在优步是vuln打开重定向-&gt;【https://trip.uber.com/ T4】</p><p id="876c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以向用户发送这个邪恶的url，它带有一个有效负载-&gt;<a class="ae kl" href="https://trip.uber.com//yahoo.com/%2F.." rel="noopener ugc nofollow" target="_blank">https://trip.uber.com//yahoo.com/%2F..</a>，然后用户被重定向到yahoo.com站点..我们可以使用任何可用的编码来欺骗用户</p><p id="1b72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码:</p><p id="14af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是我编写的python代码，用来跟随请求到达最终目的地，并查看开放重定向是否有效。基本上，扫描仪加载一个子域列表，并添加一个有效载荷到最终的url，看他去哪里</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kt ks l"/></div></figure><p id="adc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">享受快乐的黑客生涯！:)</p><p id="5de3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问候，</p><p id="ed77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ku kv ep" href="https://medium.com/u/c5b622272cd5?source=post_page-----c72cd60d0bf--------------------------------" rel="noopener" target="_blank"> Ak1T4 </a></p></div></div>    
</body>
</html>