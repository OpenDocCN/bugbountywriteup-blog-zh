<html>
<head>
<title>Bug Bounty: Fastmail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">臭虫赏金:快速邮件</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bug-bounty-fastmail-feeda67905f5?source=collection_archive---------2-----------------------#2017-12-08">https://infosecwriteups.com/bug-bounty-fastmail-feeda67905f5?source=collection_archive---------2-----------------------#2017-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="405e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我首先想说的是，Fastmail有一个很棒的bug bounty计划，他们真的非常关心他们的服务和客户的安全。几个月前，我第一次开始研究他们的bug bounty计划，在浏览web应用程序后不久，我发现了以下特征:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/91ee2ae9d58f352c8d6c738e1b9deb86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rIZ7V6Ba9nQPbw3y3Lxslg.png"/></div></div></figure><p id="e988" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现使用这个特性，我可以使用任何端口向任何网站发出HTTP请求，包括内部IP地址。如果您向一个不包含有效iCal文件的服务器发出请求，它将返回一个包含响应正文部分内容的错误，这很容易表明这是一个有效的安全问题。我注意到的第二件事是，如果您在URL路径中包含\r\n您可以添加自定义标头，因此理论上这可能被用作协议走私的一种方式。不幸的是，我找不到任何可以用来远程执行代码的内部服务。然而，在查看他们网站的源代码时，我能够找到一个运行web服务器的内部IP地址的引用，并且能够提取他们内部web应用程序的部分内容。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/f666e2ed7412129920102a1c0924e2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1g8i2kMbE5Z7w0VvOyhcpA.png"/></div></div></figure><p id="83ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向他们的安全团队报告了这个漏洞，并因我的发现获得了1000美元的奖励。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="14a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现的第二个漏洞是盲SSRF +盲XXE。我发现这个漏洞是因为我的Amazon EC2实例的主机名在网站的一个请求电子邮件地址的区域运行web服务器。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/a385ccad9ddcc5540360d86c90e7f3a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDcKv9WuKjo8ouWkrOWxNw.png"/></div></div></figure><p id="26e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在看到来自Fastmail的对我的VPS的web服务器的HTTP请求后，我立即知道我发现了一个盲SSRF漏洞，因为响应不包含被请求文件的任何内容。然而，我无法指定端口号或自定义文件路径，但我很快发现这个SSRF遵循Location头中指定的重定向。我首先尝试使用gopher://来创建定制请求，试图创建对内部服务的定制请求，试图与HTTP和HTTPS之外的协议进行交互，不幸的是，这并不成功，因为唯一成功的请求都被重定向到HTTP或HTTPS。不久之后，我查看了VPS上的访问日志，发现最初的请求是请求一个XML文件。接下来，我将一个盲XXE有效负载放在他们的服务器所请求的文件路径上，结果成功了。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/b4471443a7336280fcbe99774dffbe05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gxZf_WI9cNhx9oKhJisyGQ.png"/></div></div></figure><p id="e001" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个请求是服务器最初请求的文件。然后，我使用的XXE有效负载试图请求success.txt，但是由于该文件不存在，我的web服务器被重定向到根目录。在根目录中有一个php文件，它使用Location头重定向到/example-test-redirect.txt。然后我向Fastmail报告了这个漏洞，并因我的发现获得了2000美元的奖励。</p><p id="89f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我使用Fastmail的bug bounty程序的经验中，我发现他们的安全团队总是反应迅速，他们总是在我报告后的24小时内推出补丁。我强烈建议任何安全研究人员使用这个程序。除了奖金之外，我也加入了他们的名人堂。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/1c9c137d08a80c6d4dc0cd435947a803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IC8R5RWR4rZLApmfynnwzQ.png"/></div></div></figure></div></div>    
</body>
</html>