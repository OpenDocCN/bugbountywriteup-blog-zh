<html>
<head>
<title>Authorization bypass — Gmail</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绕过授权— Gmail</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/authorization-bypass-gmail-2949af041fb?source=collection_archive---------0-----------------------#2022-01-06">https://infosecwriteups.com/authorization-bypass-gmail-2949af041fb?source=collection_archive---------0-----------------------#2022-01-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/49027b03751b9531317d055cff65f713.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XwxWIerRF2vQfk7pc5psog.png"/></div></div></figure><ul class=""><li id="6687" class="jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp bi translated"><em class="kq">关于漏洞</em></li></ul><p id="1db4" class="pw-post-body-paragraph kr ks iq ka b kb kc kt ku kd ke kv kw kf kx ky kz kh la lb lc kj ld le lf kl ij bi translated">Gmail上最简单但最棘手的案例，攻击者可以通过发送电子邮件<strong class="ka ir">冒充知名品牌和个人</strong>来欺骗目标。不要再绕弯子了，让我们进入正题吧。</p><h2 id="d7bb" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">Gmail授权</h2><p id="cbaf" class="pw-post-body-paragraph kr ks iq ka b kb lz kt ku kd ma kv kw kf mb ky kz kh mc lb lc kj md le lf kl ij bi translated">在创建谷歌账户时，Gmail绝不会要求你证明你的身份。它要求你证明你是一个人，而不是一个机器人。我们可以编辑我们的个人信息&amp;即使我们可以编辑我们的信息，仍然有一些限制。</p><p id="75e7" class="pw-post-body-paragraph kr ks iq ka b kb kc kt ku kd ke kv kw kf kx ky kz kh la lb lc kj ld le lf kl ij bi translated"><strong class="ka ir">这些都是谷歌自己实施的，用来防御侵犯&amp;滥用。↓↓ </strong></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="58fb" class="lg lh iq mj b gy mn mo l mp mq"><em class="kq">1. Some characters aren’t allowed. </em><br/><strong class="mj ir"><em class="kq">eg: emoji, tick, (, |, {, &lt;, :), #,%,$ etc.</em></strong></span><span id="d4a8" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">2. The name which does not seem to meet Google’s policy is restricted.</em></span><span id="bb7b" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">3. Input limits</em></span><span id="70fb" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">4. etc.</em></span><span id="d846" class="lg lh iq mj b gy mr mo l mp mq">Along with further restrictions,<strong class="mj ir"> you can’t create an account </strong>exactly named<strong class="mj ir"> “Google”</strong></span></pre><h2 id="1422" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">校样:</h2><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/62ed8cfe0e33f7a20656cac85d79b885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJ-pm8EhVZ4QNFGrdpKRcQ.jpeg"/></div></div></figure><p id="bebe" class="pw-post-body-paragraph kr ks iq ka b kb kc kt ku kd ke kv kw kf kx ky kz kh la lb lc kj ld le lf kl ij bi translated">Gmail禁止用户这样做的原因很清楚。否则，任何人都可以滥用它&amp;把它变成影响个人、公司、机构等的漏洞。</p><h2 id="62bb" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">案例:</h2><blockquote class="mt mu mv"><p id="d6be" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated">攻击者可以绕过其中的一些限制&amp;可以以看得见的方式向任何拥有Gmail帐户的个人发送电子邮件。</p><p id="8203" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir">绕过谷歌的这一限制，攻击者可以准确地将他们的名字改为“谷歌”,并加上一个“验证标记”,还有一个真正的网址。</strong></p></blockquote><h2 id="9374" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">概念证明</h2><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/205ca15eaeaa4458c74d61640f00b838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nF6B0et3oQRh7VMazBpAMw.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">更多细节等着你，不要跳过</figcaption></figure><h2 id="7a14" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated"><strong class="ak">再现步骤:</strong></h2><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6bbc" class="lg lh iq mj b gy mn mo l mp mq"><em class="kq">** 1. Open Gmail from the web browser.</em></span><span id="76b9" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">** 2. Pick up the target.</em></span><span id="e390" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">** 3. Intercept the request while sending the mail</em></span><span id="026b" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">** 4. Edit </em>the <strong class="mj ir">"NAME" </strong><em class="kq">&amp; send the request</em></span><span id="2766" class="lg lh iq mj b gy mr mo l mp mq"><strong class="mj ir">Edited portion of request:</strong></span><span id="818a" class="lg lh iq mj b gy mr mo l mp mq">POST /sync/u/3/i/s?hl=en&amp;c=13 HTTP/1.1<br/>Host: mail.google.com<br/>Cookie: COMPASS=XXXX;<br/>3PSID=XXX;<br/>t-GMAIL_SCH=XXXX;<br/>User-Agent: XXXX;<br/>Accept: */*<br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Content-Type: application/json<br/>Content-Length: 743<br/>X-Google-Btd: 1<br/>X-Gmail-Btai: {"3":{"6":0,"10":1,"13":1,"15":0,"16":1,"17":1,"18":0,"19":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":0,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":1,"37":"en","38":"Mozilla/5.0 (X11; Linux x86_64; rv:90.0) Gecko/20100101 Firefox/90.0","39":1,"40":0,"41":25,"43":0,"44":1,"45":0,"46":1,"47":1,"48":1,"49":1,"50":1,"52":1,"53":1,"54":0,"55":1,"56":1,"57":0,"58":0,"60":0,"61":1,"62":0,"63":1,"64":0,"66":0,"67":0,"68":1,"69":1,"70":0,"71":1,"72":0},"5":"e00e0efee9","7":25,"8":"gmail.pinto-server_20211227.06_p0","9":1,"10":5,"11":"","12":19800000,"13":"+05:30","14":1,"16":418514969,"17":"","18":"","19":"1641437521701","21":"1370"}<br/>X-Framework-Xsrf-Token: AKwhgQq1WH-n-MYenPLNA8YOCdUuhO2D8A:1641437195302<br/>Origin: <a class="ae nd" href="https://mail.google.com" rel="noopener ugc nofollow" target="_blank">https://mail.google.com</a><br/>Sec-Fetch-Dest: empty<br/>Sec-Fetch-Mode: cors<br/>Sec-Fetch-Site: same-origin<br/>Sec-Gpc: 1<br/>Referer: <a class="ae nd" href="https://mail.google.com/mail/u/3/" rel="noopener ugc nofollow" target="_blank">https://mail.google.com/mail/u/3/</a><br/>Te: trailers<br/>Connection: close<br/>{"1":{"3":2},"2":{"1":[{"1":"43","2":{"1":"thread-a:r-3342554841964375422","2":{"14":{"1":{"1":"msg-a:r-4547215635208082171","2":{"1":1,"2":"SENDER-MAIL-ID@gmail.com","3":<strong class="mj ir">"SENDER-NAME"</strong>,"10":"SENDER-MAIL-ID@gmail.com"},"3":[{"1":1,"2":"TARGET-MAIL-ID@gmail.com@gmail.com"}],"7":"1640181726619","8":"","9":{"2":[{"1":0,"2":"&lt;div dir=\"ltr\"&gt;Testing&lt;br&gt;&lt;/div&gt;"}],"7":1},"11":["^all","^pfg","^f_bt","^f_btns","^f_cl","^a"],"18":"1640181726619","36":{"6":0},"37":{"4":0},"42":0,"43":{"1":0,"2":0,"3":7,"4":0},"52":"s:12fc9f890bfae0e|#msg-a:r-4547215635208082171|0"},"3":1}}}}]},"4":{"1":"1640181719997","2":1,"3":"1640181726641","4":1,"5":200},"5":2}</span><span id="57e0" class="lg lh iq mj b gy mr mo l mp mq">** <em class="kq">5. Done</em></span></pre><h2 id="8c70" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">影响</h2><blockquote class="mt mu mv"><p id="18cd" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir">T15】</strong></p></blockquote><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="3eb0" class="lg lh iq mj b gy mn mo l mp mq"><em class="kq">1. Anyone can exploit this vulnerability without any complexity.</em></span><span id="9c68" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">2. Google can’t detect the changes made while exploiting</em></span><span id="0226" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">3. The attacker can navigate the individuals using Gmail</em></span><span id="91d9" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">(utilizing the trustworthiness of Google)</em></span><span id="e002" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">4. The complete abusement</em></span><span id="a0b0" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">5. Likewise, It’s possible to perform any kind of spam attack</em></span><span id="098c" class="lg lh iq mj b gy mr mo l mp mq"><em class="kq">(highlighting other companies)</em></span></pre><blockquote class="ne"><p id="3408" class="nf ng iq bd nh ni nj nk nl nm nn kl dk translated">在欺诈者滥用这个案例之前，我向谷歌详细描述了当时的情况。</p></blockquote><figure class="np nq nr ns nt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/097667c3da3d6c310df1491d15d19547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*AA2np3tEzlgBl5q6Ar7YLQ.png"/></div></figure><blockquote class="mt mu mv"><p id="ed5d" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir"> <em class="iq">报道日期:2021年12月22日</em> </strong></p><p id="08e8" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir"> <em class="iq">分流(初始分流):2021年12月23日</em> </strong></p><p id="d743" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir"> <em class="iq">分配(内部分流):2021年12月28日</em> </strong></p></blockquote><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/e51c797fef5d299dbbbf230bf10c5bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1TZp-7B5NgokB6zkS2l6cw.png"/></div></div></figure><blockquote class="mt mu mv"><p id="655f" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir">当前状态:</strong></p><p id="d4d2" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated"><strong class="ka ir">关闭日期:2022年1月5日</strong></p></blockquote><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/518d7fbbe07e68e2cff65310e464d2f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*xzHZpO8USu-c2ABvWPdz0Q.png"/></div></figure><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6c12" class="lg lh iq mj b gy mn mo l mp mq"><strong class="mj ir">Priority: P3</strong></span><span id="a711" class="lg lh iq mj b gy mr mo l mp mq"><strong class="mj ir">Severity: S4</strong></span><span id="b818" class="lg lh iq mj b gy mr mo l mp mq"><strong class="mj ir">Status: Won't Fix </strong></span></pre></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h2 id="92af" class="lg lh iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kh ls lt lu kj lv lw lx ly bi translated">中间发生了什么？为什么我被理所应当的谷歌名人堂拒之门外？</h2><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi od"><img src="../Images/0d41a1ca83f425295230bbab0afd0b56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*1o-vpe1IlMVQJEBcodgQQw.gif"/></div></figure><blockquote class="ne"><p id="5fd9" class="nf ng iq bd nh ni nj nk nl nm nn kl dk translated"><em class="oe">运气又被吸了！</em></p></blockquote><p id="eeb6" class="pw-post-body-paragraph kr ks iq ka b kb of kt ku kd og kv kw kf oh ky kz kh oi lb lc kj oj le lf kl ij bi translated">如果情况变得一致，谷歌会奖励我。报案后，我试图引发一件史诗般的事情。所以，我尝试了不同的方法。所以，最初，没有威慑。我做了更多的测试&amp;行为很奇怪。然后它被标记为 <strong class="ka ir"> <em class="kq">。</em> </strong> <em class="kq">简单来说，被Gmail的垃圾邮件过滤器捕获的破坏性邮件</em> <strong class="ka ir"> <em class="kq">【连续尝试后】</em> </strong></p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/6cd0afb6fdc9a9524c71df008009ef72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wR6i-hH6sU0D3tE1S8Dt5A.png"/></div></div></figure><blockquote class="ne"><p id="e0db" class="nf ng iq bd nh ni nj nk nl nm nn kl dk translated"><strong class="ak"> <em class="oe">一切都在一秒钟内发生变化。我更新了谷歌的观点。</em> </strong>没必要“求赏金”</p></blockquote><p id="e967" class="pw-post-body-paragraph kr ks iq ka b kb of kt ku kd og kv kw kf oh ky kz kh oi lb lc kj oj le lf kl ij bi translated"><strong class="ka ir">~ Gmail是安全的~ </strong></p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/3d8b186bbb52137a9eb8732fe963b178.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBqnWzh72i56C281MY0sOw.jpeg"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">任务完成</figcaption></figure><p id="f03b" class="pw-post-body-paragraph kr ks iq ka b kb kc kt ku kd ke kv kw kf kx ky kz kh la lb lc kj ld le lf kl ij bi translated">我猜你喜欢这篇报道。我始终相信我最好的还在后面！并且不要无视与我接通 <strong class="ka ir">推特</strong>@<a class="ae nd" href="https://twitter.com/7h3h4ckv157" rel="noopener ugc nofollow" target="_blank">7h 3 H4 ckv 157</a></p><h1 id="652d" class="ol lh iq bd li om on oo ll op oq or lo os ot ou lr ov ow ox lu oy oz pa lx pb bi translated">注意:</h1><blockquote class="mt mu mv"><p id="6b29" class="kr ks kq ka b kb kc kt ku kd ke kv kw mw kx ky kz mx la lb lc my ld le lf kl ij bi translated">你想知道它以前是怎么出现的吗？然后看看我上传的视频。</p></blockquote><p id="0a40" class="pw-post-body-paragraph kr ks iq ka b kb kc kt ku kd ke kv kw kf kx ky kz kh la lb lc kj ld le lf kl ij bi translated"><strong class="ka ir">我的第一次概念验证(在Gmail过滤器检测之前)</strong></p><figure class="me mf mg mh gt jr"><div class="bz fp l di"><div class="pc pd l"/></div></figure></div></div>    
</body>
</html>