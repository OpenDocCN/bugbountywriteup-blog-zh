<html>
<head>
<title>How Hackers Use Open-Source Intelligence to Ransomware Companies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客如何利用开源情报勒索公司</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-hackers-use-open-source-intelligence-to-ransomware-companies-12946a8e6b04?source=collection_archive---------0-----------------------#2021-09-10">https://infosecwriteups.com/how-hackers-use-open-source-intelligence-to-ransomware-companies-12946a8e6b04?source=collection_archive---------0-----------------------#2021-09-10</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="c9fb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">向一家真实的公司展示黑客如何利用OSINT和社会工程在不到2小时的时间内攻破一个组织。</p><figure class="kp kq kr ks gu kt"><div class="bz fq l di"><div class="ku kv l"/></div></figure><h1 id="377b" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">视频抄本</h1><p id="0e95" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">今天，我将演示网络犯罪分子如何使用开源智能创建有针对性的高效网络钓鱼电子邮件，从而为全公司范围的勒索软件攻击奠定基础。我将向您展示一个熟练的攻击者可以在不到两个小时的时间内获得什么样的信息，任何知道去哪里找的人都可以获得这些信息。</p><p id="a37f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">什么是开源智能？在我看来，只要你知道如何以及在哪里寻找，它就是你能在互联网上找到的任何东西。有很多工具和技术，但我最喜欢的是谷歌。</p><h1 id="03f1" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">谷歌黑客</h1><p id="6c08" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">Google Dorking或Google hacking是您使用精心设计的查询来查找特定信息的地方，这些信息永远不会出现在我们每天进行的标准搜索中。如您所见，添加搜索操作符(如inurl和filetype)以及敏感关键字(如password、secret或confidential ),可以返回各种有趣的结果。</p><p id="833e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在前两个例子中，我展示了亚马逊的S3简单存储服务和一个传统网站上泄露的密码文件。在那下面，我在代码托管网站github.com上搜索了短语“开始RSA私钥”和“AWS_SECRET”。您可以看到的凭证使您可以通过VPN访问某人的公司网络，并通过API访问某人的Amazon web services帐户。</p><p id="837b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在右下角，我用Shodan找到了可以从互联网上公开访问的RDP服务器。现在有人会暴力攻击所有这些。一旦他们进入，他们将在网络上有一个立足点，开始四处窥探，提升他们的访问级别，窃取数据，并在他们看到的任何东西上安装勒索软件。</p><p id="fe58" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">但这实际上并不是大多数勒索软件攻击的开始。今天最常见的方法是用电子邮件。</p><h1 id="0782" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">通过网络钓鱼电子邮件进行勒索</h1><p id="b909" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">电子邮件被设计成勾选所有正确的心理框，以确保收件人要么打开直接附加的文件，要么点击链接从网站下载文件。该文件包含恶意软件，最常见的形式是带有武器的Office宏。在Office文档中运行的Visual basic代码。</p><p id="2c9e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">许多组织将Office配置为提示用户“启用内容”,以防止默认情况下运行宏。但是人们在每一个有宏的文档上都有这个按钮，所以他们每次看到它的时候就点击这个按钮。即使你把文本改成“执行恶意软件”，他们可能还是会点击它。</p><p id="acee" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">一旦他们点击该按钮，小型内置恶意软件就会执行，并从互联网上下载更大的恶意软件。这是一个后门程序，允许他们从互联网远程访问受损系统。从这里开始，他们还不如坐在电脑前。</p><h1 id="7cd7" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">钴罢工</h1><p id="ac04" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">Cobalt Strike是一种工具，旨在让道德黑客模拟网络罪犯的攻击。它太棒了，以至于网络罪犯抛弃了他们的旧工具，开始自己使用它。</p><p id="29ed" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">为了绕过您的公司保护，后门通过加密的HTTP请求DNS查询与命令和控制服务器通信。除非你使用安全的网络代理和DNS解决方案，否则这些会直接通过你的防火墙进入互联网。</p><p id="7fda" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">安装了后门程序后，他们开始探查您网络，寻找提高他们访问全公司管理员权限的方法。然后，他们窃取您的数据，加密您的备份，最后加密他们能得到的一切。</p><h1 id="1a6c" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">黑掉一家真正的公司</h1><p id="0edd" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">不久前，一家名为Tessian的公司找到了我。他们让我向他们的客户演示网络罪犯如何使用开源情报来实施网络钓鱼和社会工程攻击。最终导致整个组织爆发勒索病毒的攻击。</p><p id="acfb" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我说“当然！只要我能把你当靶子。”</p><p id="7ba1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">他们一开始有些犹豫…但是我答应在和任何人分享之前让他们看看结果。</p><h1 id="2eba" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">对付目标的第一步——他们是谁？</h1><p id="465f" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">当我接近任何目标时，不管是为了bug奖金还是其他，我做的第一件事就是看他们的公司网站，试图了解他们是谁，他们在做什么。</p><p id="6e49" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在他们的网站上，有一个非常有用的页面，上面有他们最资深的人的名字和照片。不仅仅是这三个人，而是所有人，包括他们的投资者。</p><p id="6f6e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我找到了一个页面，上面列出了他们所有的办公地点、联系电话以及支持和媒体的电子邮件地址。然后我看了一下他们的公共DNS记录。从这一点上，我可以看出他们在Cloudflare后面托管他们的网站。他们的电子邮件指向Google Workplace，这很好，因为它告诉我他们可能会采取的控制类型。</p><p id="65ed" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我去了accounts.google.com，在用户名栏里输入了admin@tessian.com。当我点击“下一步”时，它将我重定向到一个品牌化的单点登录页面。这太神奇了。现在我有了一个品牌钓鱼网页的源代码，它与Tessian用户每天看到的网页一模一样。</p><p id="3191" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我用一个叫做Harvester的开源工具在互联网上搜索电子邮件地址。它找到了几个地址，其中大部分是“无名氏”或用于客户支持和媒体咨询的公共地址，但其中一个是真实的人。它证实了该公司对员工邮箱使用firstname.surname格式。这是另一个伟大的发现。</p><p id="246f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">有了这些信息，我所需要做的就是得到一份员工名单，我有每个人的电子邮件地址。LinkedIn在这方面很棒，但如果你将搜索结果限制在“site: linkedin.com”并添加公司名称，谷歌会做得更好</p><p id="28be" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我给营销团队的某个人发了一个愚蠢的问题，他们回复了，给了我一份官方邮件签名的复印件。</p><h1 id="e6e2" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">在公司内部寻找目标</h1><p id="c086" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">有了这个关于公司如何运作的基本信息，我开始寻找目标个人和几乎可以保证成功攻击的方法。</p><p id="68a3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Tessian有一个Instagram账户。关注者不多，但照片很多。当我翻阅它们时，我了解到它们是狗的忠实粉丝。还有Macbooks。</p><p id="f115" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">没有一台运行Windows的机器。我早就知道他们使用Google Workplace。这意味着武器化的Office宏的传统攻击途径已经不存在了。</p><p id="c374" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我看了看他们的职业页面，这个页面是从他们的Instagram个人资料链接过来的。在那里我找到了大量有用的信息。我了解到他们主要运行在Amazon AWS上，但他们刚刚开始了一个迁移项目，从docker迁移到运行在Microsoft Azure上的Kubernetes。他们用python 3编写后端代码，用React JavaScript框架编写前端代码。</p><p id="109e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">和往常一样，我在Github上查看了它们。我发现他们只有一个单一的代码库，在他们的组织中没有成员。但当我点击进入回购时，我可以看到8个人一直在做这件事，其中两个被标记为泰森的员工。</p><h1 id="8679" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">把所有的放在一起</h1><p id="67e2" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">我做的第一件事就是注册了一个看起来很像的域名。谢天谢地，Tessiam.com是可用的，改变n到一个m，乍看起来很不明显。然后，我注册了一个Google workplace账户，以便从与他们相同的基础设施上发送电子邮件。</p><p id="3a9f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我收到的第一封钓鱼邮件来自首席技术官艾德·毕肖普。</p><p id="9ce8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">“你好，John，我知道你最近一直在开发catapult AWS部署工具。我一直在尝试运行一些部署审计工具，但我无法让它们工作。你能不能用你的账户试试这个，让我知道它对你是否有效？”</p><p id="a6d9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后有一个链接指向一个python工具，该工具抛出一个奇怪的错误，并从他的本地机器上窃取他的AWS凭证。</p><p id="d9ee" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">第2封网络钓鱼电子邮件，由John发送给Jane，同样使用带有M基础架构的Tessiam。</p><p id="c1c3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">“嗨，简，我觉得我快疯了..我整个早上都在尝试运行这个脚本，但没有成功。我的Macbook上没有需要安装的依赖项，python 3也是最新的…我甚至尝试在新的虚拟机上全新安装…</p><p id="a410" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">你能帮我一下吗？在Mac上运行时会发生什么？"</p><p id="901f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后是一个python脚本的链接，在她的Macbook上安装了Cobalt Strike后门后，该脚本抛出了一个随机错误。</p><p id="9b5d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">总投资，不到两个小时，比麦当劳的两人晚餐还便宜。</p><h1 id="f5cb" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">那么我们能做什么呢？</h1><p id="93c8" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">首先，把基础打好。修补一切，设置强密码，启用MFA，从域管理或其他公司范围的管理组中删除所有人。运行网络钓鱼模拟测试并提供安全意识培训。创建不能被在线系统更改的离线备份，并定期测试它们。安装防病毒和端点检测及响应工具。防火墙关闭一切，使攻击面尽可能小，甚至在您的网络内部。</p><p id="d724" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">网络安全是80%做正确的事，20%做聪明的事。如果你没有把基本的东西做好，做花哨的东西是没有意义的。</p><p id="bdc6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">永远假设你会妥协。将更多精力放在检测问题上，最大限度地减少单台受损PC或笔记本电脑可能造成的损害。尽可能长时间地控制疫情。即使你所做的只是拖延时间，你也在为自己争取更多的时间做出反应，在事情变得太严重之前停止一切。据我所知，在不到一个小时的时间里，从网络钓鱼邮件到一个完全勒索软件的公司，攻击已经发展到了<a class="ae lz" href="https://medium.com/swlh/phishing-email-to-company-devastating-ransomware-in-5-hours-c914687ecbbc" rel="noopener">。</a></p><p id="3576" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">最后，勒索你自己。嗯……不尽然。我做的一项练习是浏览最近发布的已披露违规事件报告，看看我的控制措施能承受多长时间的攻击。最近泄露的孔蒂集团攻击战术手册是这种桌面演习的一个很好的资源。我利用这些攻击的反馈来加强控制，然后再做一遍。</p><p id="9cee" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">真正的勒索软件攻击是你所能得到的最准确的测试。自己动手，小心翼翼(不要真的弄坏东西——确保你在动手之前明白自己在做什么)，这是最接近真相的方法，而不需要最终真的花掉比特币。</p><h1 id="1878" class="kw kx iu bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">摘要</h1><p id="38c4" class="pw-post-body-paragraph jr js iu jt b ju lu jw jx jy lv ka kb kc lw ke kf kg lx ki kj kk ly km kn ko in bi translated">总结一下，这些攻击是会发生的，所以最好做好准备。最重要的是做好基础工作，防止容易的攻击危及你的安全。并尽可能地使其难以获得第一个立足点。</p><p id="edbe" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">但是，期待有一天这个立足点会出现，当它出现时，准备好遏制它，发现它，并做出适当和迅速的反应，以尽量减少它造成的损害。来阻止它的蔓延和失控。</p><figure class="kp kq kr ks gu kt gi gj paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gi gj ma"><img src="../Images/f230b7e16e058c421496738c4495aab2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AO4Zp9undu_-6GC-_dw8_A.jpeg"/></div></div></figure></div><div class="ab cl mh mi hy mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="in io ip iq ir"><p id="6514" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><a class="ae lz" href="https://craighays.com/newsletter-medium-signup" rel="noopener ugc nofollow" target="_blank">加入我私人邮件列表中的其他人，了解我的最新文章、视频、想法等等。</a></p></div></div>    
</body>
</html>