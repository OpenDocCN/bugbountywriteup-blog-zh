<html>
<head>
<title>Develop Bluetooth Apps | Fundamentals, Tools &amp; Coding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开发蓝牙应用|基础、工具和编码</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/develop-bluetooth-apps-fundamentals-tools-coding-4a08922a7cd6?source=collection_archive---------2-----------------------#2022-04-10">https://infosecwriteups.com/develop-bluetooth-apps-fundamentals-tools-coding-4a08922a7cd6?source=collection_archive---------2-----------------------#2022-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cc81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一篇非常介绍蓝牙技术的文章。这是第一部分，请继续关注更长更全面的文章。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/b6601866a9f13e20707ba02339462c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*roKbDZspgnZwBkKofD9jRA.jpeg"/></div></div></figure><p id="cc6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在蓝牙世界中，蓝牙技术已经发展到支持更节能的蓝牙子协议。因此，我们有蓝牙classic，用于您的音频耳环或汽车音频系统，还有蓝牙Low Energy，主要用于功耗受限的设备，如智能手表、手机或智能锁。</p><p id="d556" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将解释非常基础的BLE，然后我将继续与一个完整的蓝牙应用程序。</p><h1 id="ac4e" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">协议</h1><p id="3d60" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">蓝牙低能耗协议非常简单。这里涉及到许多网络层，但是你现在不应该担心其中的任何一层。我们将使用应用层编写我们的应用程序，因为BLE控制器将为我们处理其余的工作。</p><p id="0f44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在蓝牙生态系统中，有两种设备:<strong class="jp ir">中央设备</strong>和<strong class="jp ir">外围设备</strong>。</p><p id="1cc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前者是连接到外围设备的设备，把它们看作是客户端——也就是你的智能手机。<br/>后者是接受新连接的设备。把它们想象成服务器，也就是你的智能手表。</p><p id="4007" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图总结了这一概念:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/6c2728f4a02bb5ae08860dbd1737de1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*ecV4hSExDbtE-rUGZrSC9w.png"/></div></figure><ul class=""><li id="05e4" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated">在BLE，有一些由蓝牙SIG(负责蓝牙协议的官方组织)定义的规范。</li><li id="a06d" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">此类配置文件有HID配置文件、心率配置文件、健康体温计配置文件、接近度配置文件等等。</li><li id="8b02" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">每个简档定义了该设备必须服务的特定服务。每个服务可以有零个、一个或多个特征，通常一个服务有一到五个特征。</li><li id="8514" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">这些特征可以被认为是服务的输入/输出端点。</li><li id="22be" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">每个服务或特征都有一个唯一的Id，即UUID。</li><li id="816e" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">当一个外围设备想要被发现时，它处于广告模式。在这种模式下，广告分组由附近扫描外围设备的中央设备发送和接收。此类数据包包含设备特定的数据，如设备名称、蓝牙地址或电池电量。这些数据将在BLE系列的后续文章中进行分析，所以不要忘记关注。</li></ul><h1 id="0850" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">实施</h1><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mp"><img src="../Images/bc005360585237aedcf7c54f722dc075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmYW-p6jjW7qbqXF_l9lWQ.png"/></div></div></figure><p id="fa9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">使用的控制器:</strong>开源BLE:bit设备—官方:<a class="ae mq" href="https://docs.blebit.io" rel="noopener ugc nofollow" target="_blank"> blebit.io </a> <br/> <strong class="jp ir">场景:</strong>设置一个中央设备和一个外围设备。这两台设备都将由我们的软件控制。目标是让两台计算机通过BLE进行通信。</p><p id="3305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在后面的文章中，我将向您展示如何与智能手表通信。</p><p id="b7a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">设置外围设备</strong></p><p id="20ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们将首先设置外围设备。它将向客户端提供一些服务，并能够接受新的连接。</p><p id="8dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我们使用的是BLE:Bit，所以我们将使用BLE:Bit Java SDK。BLE:Bit是编程访问和设置蓝牙连接的最简单的工具之一。此外，它还提供现成的工具，帮助BLE安全审计，侦察，枚举，调试或任何类型的BLE自动化，真的。</p><p id="945a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的代码创建了一些服务，添加了一些特征，并创建了控制器对象，完成后，它开始向附近的设备发布广告。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/3f9f5b4a685a22524644e1a563033a4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*gHCnmus6bOmd1pYEQO0yNA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">BLE:钻头工具</figcaption></figure><pre class="km kn ko kp gt mw mx my mz aw na bi"><span id="a06a" class="nb ky iq mx b gy nc nd l ne nf">public class VerySimplePeripheral {<br/><br/>    public static void main(String[] args) <br/>    {   <br/>        setupPeripheral();<br/>    }<br/><br/>    private static void setupPeripheral()<br/>    {<br/>        try {<br/>            /** Retrieve a BLE:Bit Peripheral controller **/<br/>            PEController pe = BLEHelper.getPeripheralController(new PEBLEDeviceCallbackHandler());<br/><br/>            /** Create a connection parameter **/<br/>            pe.sendConnectionParameters(new PEConnectionParameters());<br/><br/>            /** We won't make use of any pairing method **/<br/>            pe.configurePairing(ConnectionTypesCommon.PairingMethods.NO_IO);<br/><br/>            /** Set peripheral's Bluetooth Address **/<br/>            pe.sendBluetoothDeviceAddress("aa:bb:cc:dd:ee:ff", ConnectionTypesCommon.BITAddressType.STATIC_PRIVATE);<br/><br/>            /** Create HRS service **/<br/>            BLEService heart_rate_service = new BLEService(UUID.fromString("0000180D-0000-1000-8000-00805F9B34FB").toString());<br/><br/>            /** Create advertisement data **/<br/>            AdvertisementData adv_data = new AdvertisementData();<br/>            adv_data.setFlags(AdvertisementData.FLAG_LE_GENERAL_DISCOVERABLE_MODE | AdvertisementData.FLAG_ER_BDR_NOT_SUPPORTED);<br/>            pe.sendAdvertisementData(adv_data);<br/><br/>            /** Add BLE Characteristic Heart Rate Measurement **/<br/>            String uuid_char = UUID.fromString("00002A37-0000-1000-8000-00805F9B34FB").toString();<br/>            BLECharacteristic hr_measurement = new BLECharacteristic(uuid_char, "hello-world".getBytes());<br/>            hr_measurement.enableRead();    // Enable read-requests<br/>            hr_measurement.enableWrite();   // Enable write-requests<br/><br/>            /** Bind Characteristic to the service **/<br/>            heart_rate_service.addCharacteristic(hr_measurement);<br/><br/>            /** Attach service to the controller device **/<br/>            pe.sendBLEService(heart_rate_service);<br/><br/>            /** Let the controller know that <br/>             * we have finished with setting <br/>             * up the device **/<br/>            pe.finishSetup();<br/><br/>        }catch(IOException e) {<br/>            System.err.println(e.getMessage());<br/>        }<br/>    }<br/>}</span></pre><p id="304c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的代码显示了使用BLE:Bit SDK创建外设是多么容易。上述代码的分解:</p><ol class=""><li id="c6bf" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk ng mh mi mj bi translated">BLE:位控制器和适当的回调对象被创建</li><li id="50fa" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk ng mh mi mj bi translated">设置连接和配对/安全参数</li><li id="dc58" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk ng mh mi mj bi translated">地址和广告数据包集</li><li id="86b0" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk ng mh mi mj bi translated">定义了BLE服务和特征</li><li id="9d03" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk ng mh mi mj bi translated">设置完成—设备开始向附近的设备发布广告</li></ol><p id="abfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一篇文章中，我们将介绍如何设置中央设备，以便外设可以与中央设备交换数据。不需要硬件知识，因为BLE:位工具可以完全由软件控制，并通过USB连接。</p><p id="6de6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在以后的文章中，我将介绍如何开发更高级的应用程序，以及如何与智能手表等设备进行通信。</p><p id="273e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有关蓝牙控制器的更多信息:<a class="ae mq" href="https://docs.blebit.io" rel="noopener ugc nofollow" target="_blank"> docs.blebit.io </a></p></div></div>    
</body>
</html>