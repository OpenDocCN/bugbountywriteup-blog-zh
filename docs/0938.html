<html>
<head>
<title>Identifying Vulnerabilities in SSL/TLS and Attacking them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">识别SSL/TLS中的漏洞并攻击它们</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/identifying-vulnerabilities-in-ssl-tls-and-attacking-them-e7487877619a?source=collection_archive---------2-----------------------#2020-11-08">https://infosecwriteups.com/identifying-vulnerabilities-in-ssl-tls-and-attacking-them-e7487877619a?source=collection_archive---------2-----------------------#2020-11-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5427" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">SSL重新协商攻击| Sweet32生日攻击</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/e1a3ac102522ac5ed536d02dd92a8759.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PFAojbnH6ybrP75-"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">马库斯·斯皮斯克</a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄的照片</figcaption></figure><p id="7e93" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在本文中，我们将探讨SSL/TLS中与安全相关的问题，了解它们是如何受到攻击的，以及后续的补救措施。</p><h1 id="17c4" class="lv lw it bd lx ly lz ma mb mc md me mf jz mg ka mh kc mi kd mj kf mk kg ml mm bi translated">实验室<strong class="ak">设置</strong></h1><p id="3a31" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">这里我有两个虚拟机:</strong></p><p id="f141" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">(1.)<strong class="lb iu">受害机器</strong> — Windows还是Linux</p><p id="7e32" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">(2.)<strong class="lb iu">攻击者机器</strong> — Kali Linux</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/9b1fc2afc990a4f3a1792cfb5bd7170c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ohslYS3VqFQXLKejdceuaw.png"/></div></div></figure><p id="04c2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">在您的VMware中，确保两台虚拟机的网络适配器都设置为“桥接”模式。</p><p id="b927" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这将允许两台机器连接到您的路由器，以自动从DHCP服务器获取IP地址<em class="mt">(或者可能需要设置一个静态IP地址)</em></p><blockquote class="mu"><p id="615f" class="mv mw it bd mx my mz na nb nc nd lu dk translated">桥接模式允许这些虚拟机就像网络上的物理机一样。</p></blockquote></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="28a5" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">攻击者机器</h1><p id="b799" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated"><strong class="lb iu">检查I. </strong> <code class="fe nq nr ns nt b">ping</code>检查受害机是否处于活动状态。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/0af20d3a5f1af18784cf118382e5c1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMPOuaoKf9HhlKzKmrGYnA.png"/></div></div></figure><p id="2199" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><strong class="lb iu">检查二。</strong>运行<code class="fe nq nr ns nt b">nmap</code>查看哪些端口是打开的，以及这些端口后面运行的服务。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nv"><img src="../Images/de1546a7053bdd047996622695757b1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RxLfzAv9Txda6xAZYOBtcg.png"/></div></div></figure></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="9afd" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">拒绝服务攻击</h1><h2 id="8893" class="nw lw it bd lx nx ny dn mb nz oa dp mf li ob oc mh lm od oe mj lq of og ml oh bi translated">1.SSL重新协商攻击</h2><p id="a4a8" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">这是一种DoS攻击，利用服务器的处理能力和重新协商攻击，根据<a class="ae ky" href="https://www.mcafee.com/blogs/enterprise/tips-securing-ssl-renegotiation/" rel="noopener ugc nofollow" target="_blank"> McAfee </a>的说法，它可以使一台<a class="ae ky" href="https://www.mcafee.com/blogs/enterprise/tips-securing-ssl-renegotiation/" rel="noopener ugc nofollow" target="_blank">30gb的链接服务器</a>瘫痪，而流量只来自一个终端设备。</p><p id="1103" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">工具<code class="fe nq nr ns nt b">THC-SSL-DOS</code>利用所有SSL实现和重新协商攻击。该工具能够通过单个TCP连接触发数千次重新协商。该工具最初完成TCP 3次握手以连接到服务器。完成后，它立即反复请求对<strong class="lb iu">加密方法</strong>的<strong class="lb iu">重新协商</strong>，直到服务器完全耗尽并从互联网上断开。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi oi"><img src="../Images/19c38cc097ec53957b012b4b2b30b90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iuhyz_gS6GBuNXjhceSH0g.png"/></div></div></figure><h2 id="8db6" class="nw lw it bd lx nx ny dn mb nz oa dp mf li ob oc mh lm od oe mj lq of og ml oh bi translated">减轻</h2><ul class=""><li id="7785" class="oj ok it lb b lc mn lf mo li ol lm om lq on lu oo op oq or bi translated">如果不需要，在服务器上禁用SSL重新协商支持。</li><li id="e6f9" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">始终只允许安全的重新协商。</li><li id="a1f2" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">限制SSL握手的次数</li><li id="f7e3" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">通过实施SSL加速器等产品来升级服务器资源</li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="e39d" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">中间人</h1><h2 id="a855" class="nw lw it bd lx nx ny dn mb nz oa dp mf li ob oc mh lm od oe mj lq of og ml oh bi translated">1.Sweet32生日袭击</h2><p id="cf56" class="pw-post-body-paragraph kz la it lb b lc mn ju le lf mo jx lh li mp lk ll lm mq lo lp lq mr ls lt lu im bi translated">CVE-2016–2183，CVE-2016–6329</p><p id="4cf3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">Sweet32攻击利用了传统的64位3DES密码套件。此漏洞使得能够进行中间人攻击的远程用户可以利用此漏洞在纯文本数据中暴露敏感信息。</p><p id="a8a2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">使用以下nmap NSE脚本，您可以确定网站是否易受Sweet32攻击。</p><p id="a7a1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><code class="fe nq nr ns nt b">nmap --script ssl-enum-ciphers -p 443 &lt;IP&gt;</code></p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ox"><img src="../Images/bf581e86fd91c0b22515d501b6e81e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nc07js2L5sBW487li-F7Zw.png"/></div></div></figure><h2 id="e832" class="nw lw it bd lx nx ny dn mb nz oa dp mf li ob oc mh lm od oe mj lq of og ml oh bi translated">减轻</h2><ul class=""><li id="9476" class="oj ok it lb b lc mn lf mo li ol lm om lq on lu oo op oq or bi translated">网络服务器和VPN应配置为最低128位密码套件。例如，优选密码AES-128-CBC。<strong class="lb iu">注意:</strong> <em class="mt"> 3DES是TLS 1.0和1.1中的强制算法，而AES是最常支持的批量</em> <strong class="lb iu"> <em class="mt">密码</em> </strong> <em class="mt">在</em><strong class="lb iu"><em class="mt">TLS 1.2</em></strong><em class="mt">&amp;</em><strong class="lb iu"><em class="mt">TLS</em></strong><em class="mt">1.3</em><strong class="lb iu"><em class="mt">密码</em></strong></li><li id="1f96" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">禁用3DES密码套件。</li><li id="2f9b" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated">在TLS模式下实现64MB的默认重新协商。</li></ul><p id="9837" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="mt">更多跟随……</em></p></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="c0ae" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">测试SSL/TLS的其他命令行工具</h1><ul class=""><li id="5a9e" class="oj ok it lb b lc mn lf mo li ol lm om lq on lu oo op oq or bi translated"><code class="fe nq nr ns nt b">openssl s_client -connect &lt;ip&gt;:&lt;port&gt; -msg</code></li><li id="8670" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated"><code class="fe nq nr ns nt b"><a class="ae ky" href="https://github.com/nabla-c0d3/sslyze" rel="noopener ugc nofollow" target="_blank">SSLyze</a></code></li><li id="3929" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oo op oq or bi translated"><code class="fe nq nr ns nt b"><a class="ae ky" href="https://testssl.sh" rel="noopener ugc nofollow" target="_blank">testssl.sh</a></code></li></ul></div><div class="ab cl ne nf hx ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="im in io ip iq"><h1 id="7aa5" class="lv lw it bd lx ly nl ma mb mc nm me mf jz nn ka mh kc no kd mj kf np kg ml mm bi translated">参考</h1><ol class=""><li id="e8fd" class="oj ok it lb b lc mn lf mo li ol lm om lq on lu oy op oq or bi translated"><a class="ae ky" href="https://www.cloudflare.com/learning/ddos/glossary/denial-of-service/" rel="noopener ugc nofollow" target="_blank">https://www . cloud flare . com/learning/DDOS/glossary/denial-of-service/</a></li><li id="b243" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oy op oq or bi translated">http://kb.mit.edu/confluence/pages/viewpage.action?pageId=154192964 </li><li id="ecfd" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oy op oq or bi translated"><a class="ae ky" href="https://www.mcafee.com/blogs/enterprise/tips-securing-ssl-renegotiation/" rel="noopener ugc nofollow" target="_blank">https://www . McAfee . com/blogs/enterprise/tips-securing-SSL-re negotiation/</a></li><li id="2d9d" class="oj ok it lb b lc os lf ot li ou lm ov lq ow lu oy op oq or bi translated"><a class="ae ky" href="https://casecurity.org/2016/09/07/how-a-sweet32-birthday-attack-is-deployed-and-how-to-prevent-it/" rel="noopener ugc nofollow" target="_blank">https://case security . org/2016/09/07/how-a-sweet 32-birthday-attack-is-deployed-and-how-to-prevent-it/</a></li></ol></div></div>    
</body>
</html>