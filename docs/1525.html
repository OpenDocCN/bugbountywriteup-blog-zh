<html>
<head>
<title>Find real website ip bruteforcing ipv4 ranges</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">发现真正的网站ip暴力</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/find-real-website-ip-bruteforcing-ipv4-ranges-c1e9ab2941e7?source=collection_archive---------1-----------------------#2021-08-17">https://infosecwriteups.com/find-real-website-ip-bruteforcing-ipv4-ranges-c1e9ab2941e7?source=collection_archive---------1-----------------------#2021-08-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bd14a0ed4e78ac044678f426adbc2c8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mKXrAGCFpHDcipZXnBJnSQ.png"/></div></div></figure><p id="abc6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如今，许多web应用程序都受到Cloudfare、Akamai等服务的保护，隐藏了它们的真实ip地址，这在我们执行pentest或试图利用漏洞时可能会成为障碍。</p><p id="e474" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我想分享一个技巧，它将在很多情况下帮助我们找到真正的ip地址。</p><p id="ffd6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个过程有两个部分:</p><ol class=""><li id="b468" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated"><em class="lf">确定可以托管服务器的ipv4范围。</em></li><li id="2048" class="kw kx iq ka b kb lg kf lh kj li kn lj kr lk kv lb lc ld le bi translated"><em class="lf">使用http请求强制范围。</em></li></ol></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h2 id="2b59" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">第1部分:确定与组织相关的ipv4范围</h2><p id="3c2b" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">让我们开始假设我们想要找到下一个网站真实ip:</p><blockquote class="mq mr ms"><p id="255f" class="jy jz lf ka b kb kc kd ke kf kg kh ki mt kk kl km mu ko kp kq mv ks kt ku kv ij bi translated">https://examplecorp.com</p></blockquote><p id="0231" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">任何一个web应用都是在一个发布到互联网的服务器上，有一个ip地址，这个IP地址属于一个IP范围，这个范围归一个组织所有。我们要做的第一件事是去一个<strong class="ka ir">在线ipv4数据库</strong>，如<a class="ae mw" href="http://ipv4info.com" rel="noopener ugc nofollow" target="_blank"> Ipv4info </a>或<a class="ae mw" href="https://ip-netblocks.whoisxmlapi.com/lookup" rel="noopener ugc nofollow" target="_blank"> WhoisXMLAPI </a>并寻找“Example Corp”，这样我们将找到属于要攻击的组织的一个或多个IP地址范围。</p><p id="872d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一种方法是在其他服务中查找ip地址，如子域、邮件服务器等。假设您找到一个子域，如下所示:</p><blockquote class="mq mr ms"><p id="bd01" class="jy jz lf ka b kb kc kd ke kf kg kh ki mt kk kl km mu ko kp kq mv ks kt ku kv ij bi translated">webmail.examplecorp.com</p></blockquote><p id="e714" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个子域解析一个ip地址，这个ip地址可以托管在AWS、Azure等服务中。好的，我们可以假设部分目标基础设施可以托管在这个提供者中，我们可以在<a class="ae mw" href="http://ipv4info.com" rel="noopener ugc nofollow" target="_blank"> Ipv4info </a>或<a class="ae mw" href="https://ip-netblocks.whoisxmlapi.com/lookup" rel="noopener ugc nofollow" target="_blank"> WhoisXMLAPI </a>中找到子域ip的提供者IP范围。</p><p id="ce43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你所看到的，这部分只是正确地思考如何找到网站服务器可能位于的可能的ipv4范围。</p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><h2 id="d6b4" class="ls lt iq bd lu lv lw dn lx ly lz dp ma kj mb mc md kn me mf mg kr mh mi mj mk bi translated">第2部分:用http请求强制ipv4范围</h2><p id="f9e2" class="pw-post-body-paragraph jy jz iq ka b kb ml kd ke kf mm kh ki kj mn kl km kn mo kp kq kr mp kt ku kv ij bi translated">在这一点上，有一些ipv4范围，我们怀疑可以托管网站服务器，我们基本上需要发送http请求与网站主机名，并检查是否有任何范围的ipv4地址响应网站。</p><p id="c836" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">考虑到一个0.0.0.0/24范围有256个ip地址，或者一个0.0.0.0/16范围有65，536个IP地址，你可以一个接一个地尝试。</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/c8267134301e2e32440de8a04b644083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/0*DNg4-mb8dM0HXFj7.jpg"/></div></figure><p id="e0ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了有所帮助，我开发了一个python工具来自动化这一部分:</p><p id="d658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae mw" href="https://github.com/elefr3n/real_ip_discover" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://github.com/elefr3n/real_ip_discover</strong></a></p><p id="8600" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们需要为脚本设置接下来的三个位置参数:<br/>-主机名(例如:examplecorp.com)<br/>-目标列表范围或IP列表(例如:0.0.0.0/24，1.1.1.1/16，2 . 2 . 2 . 2)<br/>-匹配(例如:&lt;标题&gt;欢迎来到examplecorp.com&lt;/标题&gt;)</p><p id="6ffc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们也可以设置可选参数，如超时，线程，uri等…</p><p id="83fc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该工具向我们给定的范围和ip中的每个ip地址发送http和https请求，标题中包含网站主机名，检查是否有任何ip地址响应我们设置的匹配。</p><p id="b444" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我想展示一个工具的使用示例，出于法律原因，显然是一个没有任何服务来隐藏ip地址的网站。</p><p id="67fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设网站cisco.com位于Cloudflare之后，并怀疑它可能位于72.163.4.0/24范围内，我们运行该工具，如下图所示:</p><figure class="my mz na nb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/2e79a1ea89e6b71101e35a61fc4e181c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IJLeiCDLJbzLjGkRNSXdHw.gif"/></div></div></figure><p id="5c04" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该工具检测到，当ip 72.163.4.183收到一个带有<a class="ae mw" href="http://www.cisco.com" rel="noopener ugc nofollow" target="_blank">www.cisco.com</a>主机名、<strong class="ka ir">的http请求时，它会用我们设置的匹配项“<title> Cisco”进行响应，这时我们就有了真正的网站IP。</title></strong></p></div><div class="ab cl ll lm hu ln" role="separator"><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq lr"/><span class="lo bw bk lp lq"/></div><div class="ij ik il im in"><p id="d31d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">写完这篇文章，我想说保护我们的网络服务器真的很简单，就像在你的防火墙、iptables或任何其他可用的安全配置中设置一些规则一样简单，你应该只允许从我们使用的服务ip范围接收连接。例如，如果您使用的是Cloudflare，他们会提供一个链接，您可以通过该链接获得他们的所有ipv4范围:</p><ul class=""><li id="7e25" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv nd lc ld le bi translated"><a class="ae mw" href="https://www.cloudflare.com/ips-v4" rel="noopener ugc nofollow" target="_blank">https://www.cloudflare.com/ips-v4</a></li></ul><p id="bc91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">仅此而已，真心希望这篇帖子能对大家有用；)</p><p id="12a9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的推特:<a class="ae mw" href="https://twitter.com/elefr3n" rel="noopener ugc nofollow" target="_blank">https://twitter.com/elefr3n</a></p></div></div>    
</body>
</html>