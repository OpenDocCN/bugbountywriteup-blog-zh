<html>
<head>
<title>$350 XSS in 15 minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">15分钟内350美元XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/350-xss-in-15-minutes-dcb74ad93d5f?source=collection_archive---------0-----------------------#2022-12-23">https://infosecwriteups.com/350-xss-in-15-minutes-dcb74ad93d5f?source=collection_archive---------0-----------------------#2022-12-23</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f9af" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">通过JSONP +参数污染写关于多姆XSS的Bug Bounty</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/dc5ec1e485f06d7ad72e696ba45d35a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*21-fKcAn1yFgejgI"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">照片由<a class="ae ky" href="https://unsplash.com/@timbatec?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Pepi Stojanovski </a>在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>拍摄</figcaption></figure><p id="d67f" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">你好👋</p><p id="dfa6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是我今年的第一篇也是最后一篇关于Bug Bounty的文章。😀</p><p id="bce4" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">我正在与你分享我最新的XSS发现，这是我两周前发现的。</p><p id="d74d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">这是最快的，有点不寻常的流量，我通常这样做时，我搜索XSS。</p><p id="b27c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">所以让我们开始吧…</p><ul class=""><li id="e199" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">公司让我重新测试一份旧的XSS报告。</li><li id="66d4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我已经检查了XSS，并确认它已被正确修复。</li><li id="24f0" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">特定终点的参数<code class="fe mj mk ml mm b">name</code>易受反射XSS注入的影响。</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="6bb3" class="mr ms it mm b be mt mu l mv mw">example.com/profile?name=&lt;img+src=1+onerror=alert(1337)&gt;</span></pre><ul class=""><li id="cb0a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我已经开始搜索一个旁路，并使用Chrome Developer tools中的搜索功能在所有JS文件中搜索这个端点<code class="fe mj mk ml mm b">/profile</code>，以检查另一个易受攻击的参数，但找到了另一个端点:</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="6a67" class="mr ms it mm b be mt mu l mv mw">example.com/services</span></pre><ul class=""><li id="b950" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我想到的第一个想法是把这个URL放在google搜索引擎中，看看这个端点是否用params缓存在google web空间的某个地方。</li><li id="f003" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第一次尝试后，我在结果的第一页上发现了一个缓存的端点，该端点有ID参数和一些其他参数。</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="5be0" class="mr ms it mm b be mt mu l mv mw">example.com/services?id=123&amp;page=Demo</span></pre><ul class=""><li id="6124" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我已经将我的有效载荷<code class="fe mj mk ml mm b">qwe'"&lt;X&lt;/</code>添加到ID参数中，并开始检查网页源代码中是否有任何反映。</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="c3f7" class="mr ms it mm b be mt mu l mv mw">example.com/services?id=123qwe'"&lt;X&lt;/</span></pre><ul class=""><li id="7172" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">除此之外，我还打开了Chrome Developer tools中的Network选项卡，检查这个端点可能发送到某个地方的所有请求。</li><li id="a51d" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">在第二次刷新页面后，我发现了一个有趣的AJAX请求，它使用了JSONP回调参数和来自端点本身的ID参数。AJAX请求URL与此类似:</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="e235" class="mr ms it mm b be mt mu l mv mw">lib.com/find?id=123qwe&amp;jsonp=cb12</span></pre><ul class=""><li id="438a" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">我测试的第一件事是JSONP param本身，看看我是否能把它变成一个带有自定义参数的<code class="fe mj mk ml mm b">alert</code>函数</li><li id="70ac" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">令我惊讶的是，没有检查JSONP值，所以我很容易地将其更改为<code class="fe mj mk ml mm b">alert(1337);</code></li><li id="fac3" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">现在是时候再次检查ID param，看看它是否接受其他符号，例如，<code class="fe mj mk ml mm b">%</code> sign来创建一个编码的有效负载，以便向AJAX URL添加自定义参数。</li><li id="4fd4" class="lv lw it lb b lc me lf mf li mg lm mh lq mi lu ma mb mc md bi translated">我已将端点URL更改为</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="54bc" class="mr ms it mm b be mt mu l mv mw">example.com/services?id=1%26jsonp=alert(1337);%23</span></pre><ul class=""><li id="fec5" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">JS处理的时候把<code class="fe mj mk ml mm b">%26</code>转换成&amp;把<code class="fe mj mk ml mm b">%23</code>转换成#。浏览器会忽略# (hashtag)符号后面的所有内容。最终的AJAX调用如下所示:</li></ul><pre class="kj kk kl km gt mn mm mo bn mp mq bi"><span id="cabe" class="mr ms it mm b be mt mu l mv mw">lib.com/find?id=1&amp;jsonp=alert(1337);#&amp;jsonp=cb12</span></pre><ul class=""><li id="4384" class="lv lw it lb b lc ld lf lg li lx lm ly lq lz lu ma mb mc md bi translated">使用这个AJAX URL操作(参数污染攻击)，我成功地触发了一个文本为<code class="fe mj mk ml mm b">1337</code>的警告框。这证实了多姆XSS漏洞的存在，我收到了350美元的奖金，另外50美元用于重新测试一份旧报告。</li></ul><p id="31c9" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">感谢阅读！</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="5a6c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><em class="ne">继续阅读……</em></p><p id="b426" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔗<a class="ae ky" href="https://therceman.medium.com/how-to-find-your-first-bug-motivation-and-tips-for-bug-bounty-hunting-5e7343066d0c" rel="noopener">如何找到你的第一个Bug:Bug赏金的动机和技巧</a> <br/>🔗<a class="ae ky" href="https://therceman.medium.com/how-to-start-bug-bounty-hunting-94b1ff3dda27" rel="noopener">如何开始Bug赏金狩猎</a></p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="10b1" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">又及:我正在写一本给Bug Bounty世界初学者的书。这本书将包括网络，HTML和JavaScript基础知识，广泛的漏洞的简短描述，以及对XSS漏洞的深入分析，包括示例，提示，工具和技巧。在本书的最后，我将教你如何创建和部署你自己的NodeJS服务来测试盲XSS / SSRF漏洞。</p><p id="9ef6" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">请继续关注更新，不要忘记至少在某个地方订阅，这样你就不会错过任何关于这本书的信息。</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="bd6b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">节日快乐&amp;新年快乐！</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><p id="40b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">分享臭虫奖励提示</p><p id="48d7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸<a class="ae ky" href="https://LinkedIn.com/in/therceman" rel="noopener ugc nofollow" target="_blank">LinkedIn.com/in/therceman</a></p><p id="4c90" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸<a class="ae ky" href="https://Twitter.com/therceman" rel="noopener ugc nofollow" target="_blank">Twitter.com/therceman</a></p><p id="10f8" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸<a class="ae ky" href="https://Telegram.me/therceman" rel="noopener ugc nofollow" target="_blank">Telegram.me/therceman</a></p><p id="7e1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸<a class="ae ky" href="https://TikTok.com/@therceman" rel="noopener ugc nofollow" target="_blank">TikTok.com/@therceman</a></p><p id="9b1c" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">🔸<a class="ae ky" href="https://YouTube.com/therceman" rel="noopener ugc nofollow" target="_blank">YouTube.com/therceman</a></p><p id="e1fb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">最诚挚的问候，安东</p></div><div class="ab cl mx my hx mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="im in io ip iq"><h2 id="70b5" class="nf ms it bd ng nh ni dn nj nk nl dp nm li nn no np lm nq nr ns lq nt nu nv nw bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ky" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>