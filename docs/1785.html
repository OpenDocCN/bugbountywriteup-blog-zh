<html>
<head>
<title>MalDoc101 — Malicious Macros Analysis with OLETOOLS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">MalDoc101 —使用OLETOOLS进行恶意宏分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/maldoc101-malicious-macros-analysis-with-oletools-8be3cda84544?source=collection_archive---------0-----------------------#2022-01-09">https://infosecwriteups.com/maldoc101-malicious-macros-analysis-with-oletools-8be3cda84544?source=collection_archive---------0-----------------------#2022-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/66a128f9f235e3e55d32bf810b037d08.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*IJJygj2OwUNfiBJAI6TkEA.png"/></div></figure><p id="809e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这篇文章提供了我解决由<em class="ks"> Josh Stroschein </em>在CyberDefenders网站上创建的<strong class="jw ir"> MalDoc101 </strong> CTF的方法，这是一个蓝色团队专注的挑战，要求你静态分析一个恶意的Microsoft word文档。我在最后提供了一个网络卫士网站的链接，供有兴趣尝试这项挑战的人使用。</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="28d3" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">放弃</h1><p id="b1bf" class="pw-post-body-paragraph ju jv iq jw b jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr ij bi translated">我喜欢在一篇文章之前添加一个简短的免责声明，以鼓励人们在阅读这篇文章之前尝试一下这个房间，因为在这篇文章中显然会有<strong class="jw ir">剧透</strong><strong class="jw ir"/>。我相信，如果你先自己尝试，然后在遇到困难或需要提示时再来写这篇文章，你会更喜欢CTF。因此，没有任何进一步的拖延，让我们开始吧！</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="74a8" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">OLETOOLS</h1><p id="b5b4" class="pw-post-body-paragraph ju jv iq jw b jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr ij bi translated">为了解决一些挑战性问题，我将使用oletools python包。OLETOOLS是一套python工具，用来分析<a class="ae md" href="http://en.wikipedia.org/wiki/Compound_File_Binary_Format" rel="noopener ugc nofollow" target="_blank">微软OLE2文件</a>(也叫结构化存储，复合文件二进制格式或复合文档文件格式)，比如微软Office文档或Outlook消息，主要用于恶意软件分析、取证和调试。我在下面提供了一些对感兴趣的人有用的资源:</p><div class="me mf gp gr mg mh"><a href="https://github.com/decalage2/oletools" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">GitHub-decal age 2/ole tools:ole tools-用于分析MS OLE2文件的python工具(结构化存储…</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">用于分析MS OLE2文件(结构化存储，复合文件二进制格式)和MS Office…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">github.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv js mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://juliodellaflora.wordpress.com/2017/04/07/oletools-tools-to-analyze-ms-ole2-files-and-ms-office-documents-for-malware-analysis-forensics-and-debugging/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">分析MS OLE2文件和MS Office文档的工具，用于恶意软件分析，取证…</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">oletools是一个python工具包，用于分析Microsoft OLE2文件(也称为结构化存储、复合文件…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">juliodellaflora.wordpress.com</p></div></div><div class="mq l"><div class="mw l ms mt mu mq mv js mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://blog.didierstevens.com/programs/oledump-py/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">oledump.py</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">oledump.py是一个分析OLE文件(复合文件二进制格式)的程序。这些文件包含数据流…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">blog.didierstevens.com</p></div></div><div class="mq l"><div class="mx l ms mt mu mq mv js mh"/></div></div></a></div><div class="me mf gp gr mg mh"><a href="https://0xevilc0de.com/analyzing-malicious-office-documents-with-oledump/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">使用ole dump | 0xEvilC0de.com分析恶意Office文档</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">Microsoft office文档是恶意软件作者用来传播恶意软件的常用工具。这些文件，用于…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">0xevilc0de.com</p></div></div><div class="mq l"><div class="my l ms mt mu mq mv js mh"/></div></div></a></div></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="0aed" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">挑战问题</h1><blockquote class="mz na nb"><p id="8856" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">1.多个流包含本文档中的宏。提供最高的数字。</p></blockquote><p id="917b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">解压缩挑战文件后，我开始使用OLEID来分析文件，并收集恶意文件中常见的任何指标:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="d8ea" class="no lb iq nk b gy np nq l nr ns">oleid sample.bin</span></pre><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi nt"><img src="../Images/5f27d2e54e4dcbc7f94bb064a32f7521.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ck4hn21DYddd3Yu12yh4MA.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">OLEID输出。</figcaption></figure><p id="b598" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">根据输出，我们可以看到文件格式、容器格式、应用程序名称等。但更重要的是，我们可以看到该文件包含VBA宏(用红色突出显示)。要回答问题1，我们可以使用OLEDUMP来分析流并识别包含宏的最高流:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="f967" class="no lb iq nk b gy np nq l nr ns">oledump.py sample.bin</span></pre><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/bb7cfb4f095a34f358e447eb280530ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*NRR3FnIb9rt9W9WDPLV1Qw.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">OLEDUMP流。</figcaption></figure><p id="e73b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在OLEDUMP的输出中，在一些流的旁边，我们可以看到字母<strong class="jw ir"> M </strong>，表示该流包含VBA宏。</p><blockquote class="mz na nb"><p id="bbfa" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">2.什么事件被用来开始宏的执行？</p></blockquote><p id="a392" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要收集有关恶意宏的更多信息，我们可以使用OLEVBA:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="93e6" class="no lb iq nk b gy np nq l nr ns">olevba sample.bin</span></pre><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi od"><img src="../Images/c369d1e2dbf4bae412e62d747b35e9cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBZLQC_L5Coch-_SYRIuxQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">OLEVBA AutoExec事件</figcaption></figure><p id="d68a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在上面的输出中，我们看到了<strong class="jw ir"> AutoExec，</strong>，这意味着当您启动Word或加载一个全局模板时，宏就会运行。接下来，我们可以看到用于开始执行宏的事件。您可以使用下面的链接了解有关恶意宏和用于启动它们的事件的更多信息:</p><div class="me mf gp gr mg mh"><a href="https://www.trustedsec.com/blog/malicious-macros-for-script-kiddies/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">脚本小子的恶意宏-可信安全</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">宏似乎是黑客们的新宠，但我认为宏只是一些会计人员编写的简单脚本…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.trustedsec.com</p></div></div><div class="mq l"><div class="oe l ms mt mu mq mv js mh"/></div></div></a></div><blockquote class="mz na nb"><p id="60f9" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">3.这个maldoc试图放弃什么恶意软件家族？</p></blockquote><p id="7227" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要回答这个问题，我们可以将恶意文档上传到VirusTotal:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi of"><img src="../Images/1581a8908479a12177f053f52c8998a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CZbJIWNC-1gKBOo9-4wLzA.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">病毒总分。</figcaption></figure><p id="e9f6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">将maldoc加载到VirusTotal后，我们可以看到38家安全供应商将其标记为恶意软件。查看详细信息选项卡，我们可以看到恶意软件家族的名称。</p><blockquote class="mz na nb"><p id="d969" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">4.哪个流负责存储base64编码的字符串？</p></blockquote><p id="3ae5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们返回到OLEVBA输出并向上滚动，我们可以看到OLE流'<em class="ks"> Macros/roubhaol/i09/o </em>'中存储的一大串编码文本:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi og"><img src="../Images/758f23129495d09940c52c26ce366120.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qD_Obi5FmckGmW8Mrk14jQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">负责存储base64编码字符串的OLE流名称。</figcaption></figure><p id="2256" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了确定OLE流的编号，我们可以查看OLEDUMP的输出，并找到上面看到的流名称:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ddbbd1a4be2410a358aa77d227ec5d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*Mlx-zsyxlnLMqKIsVH7nbA.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">负责存储base64编码字符串的OLE流的编号。</figcaption></figure><blockquote class="mz na nb"><p id="dabe" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">5.该文档包含一个用户表单。提供姓名？</p></blockquote><p id="c987" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">用户表单<a class="ae md" href="https://docs.microsoft.com/en-us/office/vba/language/glossary/vbe-glossary#object" rel="noopener ugc nofollow" target="_blank">对象</a>是一个窗口或对话框，它构成了应用程序用户界面的一部分。为了识别用户表单的名称，我们可以利用OLEVBA及其code参数只显示VBA源代码:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="f61b" class="no lb iq nk b gy np nq l nr ns">olevba sample.bin -c </span></pre><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/3240e417794fa398981e17111ad38931.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*v9eVaQBRUGOE_J3kHxi8-w.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">VBA宏用户表单。</figcaption></figure><p id="b528" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">浏览VBA的源代码，我们可以看到用户表单的代码被保存为一个<strong class="jw ir"> *。frm </strong>文件，文件名就是答案。您可以在下面了解有关用户表单文件扩展名的更多信息:</p><div class="me mf gp gr mg mh"><a href="https://answers.microsoft.com/en-us/msoffice/forum/all/introduction-to-the-office-macro-editor-part-2/ab747f7e-3c40-48cc-b28d-db5221701535" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">Office宏编辑器介绍，第2部分</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">作为对新浪Fekrazadeh 2017年11月10日帖子的回复，虽然有时获得一些语法是有用的…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">answers.microsoft.com</p></div></div><div class="mq l"><div class="oj l ms mt mu mq mv js mh"/></div></div></a></div><blockquote class="mz na nb"><p id="a858" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">6.此文档包含一个模糊的base64编码字符串；用什么值填充(或混淆)这个字符串？</p></blockquote><p id="c51e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要回答这个问题，我们可以继续分析问题5中看到的OLEVBA提供的VBA代码。往下看VBA代码，我们看到一个变量保存了一个大的连接字符串的值:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="b867" class="no lb iq nk b gy np nq l nr ns">haothkoebtheil = "2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqw2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqin2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqm2342772g3&amp;*gs7712ffvs626fqgm2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqt2342772g3&amp;*gs7712ffvs626fq" + gooykadheoj + "2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fq:w2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqin2342772g3&amp;*gs7712ffvs626fq322342772g3&amp;*gs7712ffvs626fq_2342772g3&amp;*gs7712ffvs626fq" + roubhaol.joefwoefcheaw + "2342772g3&amp;*gs7712ffvs626fqr2342772g3&amp;*gs7712ffvs626fqo2342772g3&amp;*gs7712ffvs626fq2342772g3&amp;*gs7712ffvs626fqc2342772g3&amp;*gs7712ffvs626fqes2342772g3&amp;*gs7712ffvs626fqs2342772g3&amp;*gs7712ffvs626fq"</span></pre><p id="48d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">再往下，我们可以看到Split函数:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="4482" class="no lb iq nk b gy np nq l nr ns">feaxgeip = Split(geutyoeytiestheug, "2342772g3&amp;*gs7712ffvs626fq")</span></pre><p id="27cf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">仔细观察，我们可以看到<strong class="jw ir"> Split </strong>函数使用的分隔符用于填充上面看到的变量的连接值。如果我们删除这个分隔符字符串，我们会得到以下结果:</p><pre class="nf ng nh ni gt nj nk nl nm aw nn bi"><span id="4977" class="no lb iq nk b gy np nq l nr ns">haothkoebtheil = "winmgmt" + gooykadheoj <!-- -->+ ":win32_" + roubhaol.joefwoefcheaw + "rocess"</span></pre><blockquote class="mz na nb"><p id="0203" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">7.base64编码字符串执行的程序是什么？</p></blockquote><p id="38ed" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">继续使用VBA代码，我们可以看到有一大块混淆的base64编码的文本，正如前面回答问题4时看到的。查看文本块，我们可以看到它已经使用了与问题6中相同的分隔符进行了模糊处理。我们可以将文本块复制到CyberChef中，然后使用具有相同分隔符的<strong class="jw ir"> Split </strong>函数来检索混淆的文本:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ok"><img src="../Images/de6b7deb2208d0a2ab84c09c6091410d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UkRr3PJ_pFoHQJrtNed76A.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">赛博咖啡馆的反混淆字符串。</figcaption></figure><p id="198d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看去模糊字符串，我们可以看到用于执行base64编码字符串的程序。</p><blockquote class="mz na nb"><p id="7a2a" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">8.哪个WMI类用于创建启动木马的进程？</p></blockquote><p id="4804" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要回答这个问题，我们可以从上面问题7中看到的CyberChef输出中取出base64编码的字符串，并对其进行解码:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="nu nv di nw bf nx"><div class="gh gi ol"><img src="../Images/9c98b48f18f774a0cf31af83d2b91b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EeWMdYd1HPp5AU6jraqDVQ.png"/></div></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">CyberChef Base64字符串解码。</figcaption></figure><p id="086a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">浏览解码后的文本，我可以看到用于创建启动特洛伊木马程序的WMI类:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi om"><img src="../Images/2f620633ac0f498cefd254de3c0937a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*D5vytlWaOVFjgQ4Cq5XPDQ.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">WMI级。</figcaption></figure><blockquote class="mz na nb"><p id="d6d1" class="ju jv ks jw b jx jy jz ka kb kc kd ke nc kg kh ki nd kk kl km ne ko kp kq kr ij bi translated">9.联系了多个域来下载特洛伊木马。根据提供的提示提供第一个FQDN。</p></blockquote><p id="bf0e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">查看问题8中相同的base64解码文本，我们可以看到FQDN联系的第一个下载木马的人:</p><figure class="nf ng nh ni gt jr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/370603c941cf8be9371d8b29b382801e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*9SxZ7IB6FlNcAQ_XWtA9ig.png"/></div><figcaption class="ny nz gj gh gi oa ob bd b be z dk translated">首先FQDN联系了。</figcaption></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="535d" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结束语</h1><p id="8cde" class="pw-post-body-paragraph ju jv iq jw b jx ly jz ka kb lz kd ke kf ma kh ki kj mb kl km kn mc kp kq kr ij bi translated">我真的很喜欢通过这个CTF工作，并有机会学习更多关于使用OLETOOLS python包分析恶意宏的知识。谢谢你一直读到最后，继续黑下去😄！</p><div class="me mf gp gr mg mh"><a href="https://cyberdefenders.org/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">网络卫士:蓝队CTF挑战</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">网络卫士的想法是在两位联合创始人致力于一个联合项目以培训一支…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">cyberdefenders.org</p></div></div><div class="mq l"><div class="oo l ms mt mu mq mv js mh"/></div></div></a></div></div></div>    
</body>
</html>