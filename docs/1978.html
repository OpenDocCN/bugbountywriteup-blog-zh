<html>
<head>
<title>CloudSek EWYL 2022 CTF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CloudSek EWYL 2022 CTF</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cloudsek-ewyl-2022-ctf-eae4229b561c?source=collection_archive---------2-----------------------#2022-03-31">https://infosecwriteups.com/cloudsek-ewyl-2022-ctf-eae4229b561c?source=collection_archive---------2-----------------------#2022-03-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fbd7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">解决哈利波特主题的CTF</h2></div><p id="3b3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个“哈利·波特”主题的CTF，包含来自多个Web安全领域的挑战，如模板注入和代码审查。这项挑战由CloudSEK主办，是EWYL-2022计划的一部分。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/8717882b61fcb1f322a3ff1216d8321b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEqj94rcqFK9llK9vY75xg.png"/></div></div></figure><p id="3815" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这份报告中，我已经详细解释了我是如何解决CTF的。</p><h1 id="014b" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">初步侦察</h1><p id="87bd" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">我通过扫描目标IP开始挑战，目标IP是<a class="ae mk" href="http://13.235.95.179" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">【http://13.235.95.179】</strong></a><strong class="kh ir">。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ml"><img src="../Images/8034061d5c0503c7ecedb15bb1a3d3a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7arLi2VBaMO6KSFk7CnDMg.jpeg"/></div></div></figure><p id="52d2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">扫描显示有三个开放的港口，但是根据CTF的规定，我们不允许攻击CTF的基础设施。所以端口22没有被触及。我们将只关注端口<strong class="kh ir"> 80 </strong>和<strong class="kh ir"> 5000。</strong></p><p id="6eb1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在NMAP扫描之后，我执行了一次目录蛮力来寻找感兴趣的目录和文件，但是那次扫描没有返回任何特别的东西，甚至没有一个<em class="mm"> "robots.txt" </em>文件。</p><h1 id="b519" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">解码和去模糊</h1><p id="8899" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">在<strong class="kh ir">端口80 </strong>上访问主网页显示了挑战的主题以及"<em class="mm"> /gateway.php" </em>端点上的登录页面</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mn"><img src="../Images/022f8589b6f8aaeffa48be212b1376c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z_wXhH3DV1VPyQVq12ciZA.jpeg"/></div></div></figure><p id="86e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是一个没有太多功能的基本登录页面。这一页有一句很有意思的台词<em class="mm">“你还需要在来霍格沃茨之前多探索一下魔法的内容”。</em>这可能表明我们在初始扫描中找不到丢失的“robots.txt”。</p><p id="0c77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">经过一轮反复试验后，在"<em class="mm"> /wizardry.txt" </em>找到了一个页面，里面有一段混乱的文字，还有一条来自小精灵多比的信息。</p><p id="4c79" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里显示的文本首先用Base64进行了双重编码，然后用JSFuck语言进行了编码。</p><p id="5992" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">乱码文本-&gt; Base64 -&gt; JSFuck解码-&gt; alert(" id 3 nt 1 ty _ card . PHP ")；</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mo"><img src="../Images/41044f80aa4f228d04f79592a66d3700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HwlhvSyC17j55mz6dm77HA.jpeg"/></div></div></figure><p id="4851" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在对<em class="mm"> "/wizardry.txt" </em>的文本进行解码后，我们得到了一个新的页面<strong class="kh ir"> id3nt1ty_card.php </strong></p><h1 id="c6ec" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">检查身份证</h1><p id="92fa" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated"><em class="mm">漏洞:隐藏参数发现</em></p><p id="f95b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">访问<strong class="kh ir"> id3nt1ty_card.php </strong>上的页面，给了我们一张身份证的图片，上面有一些随机数。在端点上执行GET parameter蛮力得到参数"<strong class="kh ir">？id”。</strong></p><p id="8f30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用<em class="mm">？页面上的id=1 </em>向我们展示了下面的图像</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mp"><img src="../Images/c0ee166a608529ecb7adc89f141d8bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tE_dF7HK_NeMDyV0zFktkw.jpeg"/></div></div></figure><p id="105d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这表明我们在正确的轨道上，我们再次使用蛮力来获得id参数的有效值。</p><p id="4484" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">蛮力给我们的参数是接受的值"？id=212。</p><p id="142f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从服务器收到以下响应。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mq"><img src="../Images/34eee9b4f838bb6ab9934a08e4ee7211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y9OACfSBYjCay7O60sZibA.jpeg"/></div></div></figure><p id="2d33" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个页面给了我们非常有用的信息，可以帮助我们登录到网关</p><p id="e961" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它有两个变量，这些变量的组合将为我们提供登录密码。</p><p id="cbf5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">= = = = = = =&gt;x = 436 c 3075445 f 53654 b 5f</strong></p><p id="c2d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">= = = = = = = =&gt;y = ControlC—密码保护页面</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mr"><img src="../Images/41b4e6d14686e4c8ac8eaa3422cf081d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yO1PuCzR0KdlzuQleBCBnA.jpeg"/></div></div></figure><p id="d2de" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要破解"<strong class="kh ir"> ControlC" </strong>页面的密码，以获得密码的第二部分。</p><p id="0be5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在同一页上，我们找到了其他几幅图像，但它们都是兔子洞。</p><p id="713f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是页面的源代码中出现了一个特殊的图像</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ms"><img src="../Images/9f68ad50e41c3afbf8fb7dbd92cdd2bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3bOLIgaa8ugw8vq4QPOOQ.jpeg"/></div></div></figure><p id="fc42" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这里，我们找到了一个PHP代码，用于组合可在“ControlC”网站上使用的不同密码。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mt"><img src="../Images/572a1b837c51b82eabc8038f21137978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pjoon-r1UBDRonAk37E0Vg.jpeg"/></div></div></figure><h1 id="846c" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">玩弄PHP</h1><p id="a181" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated"><em class="mm">漏洞:PHP类型杂耍攻击</em></p><p id="b5d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们在上一步中收到的这段代码将允许我们从ControlC获得密码的第二部分。</p><p id="7051" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们来分析一下代码。</p><p id="9555" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"><em class="mm">-&gt;if(array _ key _ exists(" passphrase "，$ REQUEST)) </em> : </strong>该行检查参数" pass phrase "是否在" REQUEST "正文中定义，请求可以是任何类型(GET或POST)。</p><p id="932a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">-&gt;<em class="mm">if(strstr(＄REQUEST[" pass phrase "]，" carbonblack"): </em> </strong>该行使用<strong class="kh ir"> strstr </strong>函数检查给定的字符串是否存在于原始字符串中。如果字符串存在，则返回True。</p><p id="242b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="mm"> - &gt; ($_REQUEST["通行短语"] &gt; 22) &amp; &amp; ($ REQUEST["通行短语"] &gt; 55) </em> </strong></p><p id="fed3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们可以利用PHP类型杂耍漏洞的行，这一行在字符串和整数之间进行松散的比较，所以只检查第一个整数字符。</p><p id="fbb2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，几种可能的密码是:从23炭黑到54炭黑。</p><p id="a47a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">试了试这些密码，正确的密码是:<strong class="kh ir">33炭黑。</strong></p><p id="479e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这给了我们密码的第二部分:</p><p id="4343" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> alert("密码第二部分:W0rK _ iS _ FuN ")；</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mu"><img src="../Images/17222809ea4163c6125e10a5ade547d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NItvUj6vqC9aw0JsvLapsA.jpeg"/></div></div></figure><h1 id="cf2d" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">解锁网关</h1><p id="94dc" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated"><em class="mm">隐写术挑战</em></p><p id="cc73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在有了变量x和y的值来解锁网关</p><p id="4052" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"><em class="mm">= = = = =&gt;x = 436 c 3075445 f 53654 b 5f</em></strong></p><p id="f54b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"><em class="mm">= = = = =&gt;y = W0rK _ iS _ FuN</em></strong></p><p id="93ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="mm"> x </em> </strong>的值好像不太对，经进一步检查发现是十六进制编码</p><p id="ebf5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mm"> 436c3075445f53654b5f - &gt;十六进制解码- &gt; Cl0uD_SeK_ </em></p><p id="b2b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我列出了挑战中几个可能的用户名，并找到了正确的凭证</p><p id="2c35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="mm"> - &gt;用户名:Cloudster </em> </strong></p><p id="c169" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="mm"> - &gt;密码:Cl0uD _ SeK _ W0rK _ iS _ FuN</em>-T47】</strong></p><p id="83fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用这个我们现在可以进入网关。登录后，我们会在<strong class="kh ir"> /we1c0mE_start.php </strong>上看到巧克力蛙收藏卡页面</p><p id="46aa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们找到一张<strong class="kh ir"> cfcard </strong>图片。我使用Exiftool提取图像中任何可能隐藏的元数据。图像中有一个有趣的注释。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mv"><img src="../Images/a6315a860d3fd5642e6c7675b63a8535.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0gfEigyhFS2MA5Hw2YXiHg.jpeg"/></div></div></figure><blockquote class="mw mx my"><p id="8b4d" class="kf kg mm kh b ki kj jr kk kl km ju kn mz kp kq kr na kt ku kv nb kx ky kz la ij bi translated"><em class="iq"> Krasy8 unicode密钥7 → Sl}lsf8fJs7|KfzLrf^pUMsHn(移动到下一个具有域:5000端口的密钥)</em></p></blockquote><p id="6b08" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我不知道什么是<strong class="kh ir">克拉斯。</strong>在谷歌上搜索给出了一个GitHub Repo，一个使用密钥进行编码和解码的工具。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nc"><img src="../Images/8d1b42f0a80fec8c466c291d7d07b887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rq7kpUmDIZmw0MZHmGqoRA.jpeg"/></div></div></figure><p id="d256" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对注释中的文本进行解码后，我们得到了级别1的最终标志</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nd"><img src="../Images/0418004795a7a165f44e5ff898311afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BxzD0Lvj6gwWEISzhLo8rA.jpeg"/></div></div></figure><blockquote class="ne"><p id="438d" class="nf ng iq bd nh ni nj nk nl nm nn la dk translated"><strong class="ak">一级标志:Level_1_Cl0uD_sEk_WiNFlAg </strong></p></blockquote><h1 id="8a23" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw no jx lz jz np ka mb kc nq kd md me bi translated">注射模板</h1><p id="a047" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated"><em class="mm">漏洞:服务器端模板注入{SSTI} </em></p><p id="4eb6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们现在转移到另一个端口(5000)来解决下一个问题。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nr"><img src="../Images/834e0b6061dbd8dc988c03dace4c5d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZkzilpUwbKhBYEl5nJ4xpQ.jpeg"/></div></div></figure><p id="e092" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图像是不言自明的(对于“？搜索”参数)。不管怎样，我们做了一个启发式测试，发现页面接受一个参数<strong class="kh ir">？搜索。</strong></p><p id="dd92" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">模糊搜索参数给了我们一个有趣的结果。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ns"><img src="../Images/975ef5ad48a888d3dcbbeb703e33e2f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47JM2AYmO3-2WCNi-T4cdQ.jpeg"/></div></div></figure><p id="ef67" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">结果证实服务器易受SSTI攻击，后端使用的是<strong class="kh ir"> Jinja2 </strong>模板。我试图使用<strong class="kh ir"> OS </strong>模块运行系统命令，但是失败了<strong class="kh ir"> <em class="mm">【因为他们不希望我们在服务器上运行命令】</em> </strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nt"><img src="../Images/16c7fd3f50c26236d3e2cbc6063ae3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RKa2Oe6dB4RpMTuY8Xu_g.jpeg"/></div></div></figure><p id="1406" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以现在这里剩下的唯一路径是检查应用程序中的一些预定义对象，如<strong class="kh ir">“Config”。我使用了<strong class="kh ir"> {{Config }} </strong>对象，瞧！！！我收到了回复…</strong></p><p id="cc82" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> -什么是配置对象？</strong></p><p id="c524" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">config对象是一个Flask模板全局，表示“当前配置对象(flask.config)”</p><p id="5b02" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它是一个类似字典的对象，包含应用程序的所有配置值。</p><p id="274d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在大多数情况下，这包括敏感值，如数据库连接字符串、第三方服务的凭证、SECRET_KEY等。查看这些配置项就像注入有效负载<strong class="kh ir"> {{ config.items() }}或{{config}} </strong>一样简单</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nu"><img src="../Images/a5c3fbb02e647c0ce2ee80fd4989a38d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oMWRpkIH5ij7MQhMBo5D4w.jpeg"/></div></div></figure><p id="a9d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回复中有一段有趣的文字<strong class="kh ir">{没什么好隐瞒的/再见} </strong>。</p><p id="adc7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么作为一名黑客，当有人告诉我们不要访问某个东西时，我们该怎么办呢？完全正确，我们参观它！！</p><h1 id="f5d1" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">“再见”</h1><p id="edce" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">移动到下一页，我们得到一个简单的页面</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nv"><img src="../Images/42cde3129f2500724bc4262501c26645.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9p4xT5aOp4yRi7RJhMQqNw.jpeg"/></div></div></figure><p id="9586" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">查看这个页面的源代码会给我们带来一些有趣的东西。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nw"><img src="../Images/9a4a5441c2d997b1c6f25b4e7117e526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9iOOuA2uAP6yQVOLnhjnXg.jpeg"/></div></div></figure><p id="a977" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里我们得到一个GitHub回购的链接:<a class="ae mk" href="https://github.com/aayush-vish/cloudSEK-CTF" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">https://github.com/aayush-vish/cloudSEK-CTF</strong></a></p><p id="e451" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">手动访问回购给我们一个404错误，这意味着这个回购是私人的。我们需要做更多的工作来完成这个私人回购。</p><h1 id="762c" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">GitHub Quest</h1><p id="f1f7" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">通过更多的被动侦察，我们发现了私人回购所有者的一些索引提交。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nx"><img src="../Images/850b4bf63aff7cc119c55b7f7bcb0c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HXzI-LGK5P6a7_5c476o5A.jpeg"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ny"><img src="../Images/e7271aac3f14ac9ae2ebe273cbad8fe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8hNjiHowjmC3hOwSEwYkRg.jpeg"/></div></div></figure><p id="3db8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个文件中，我们找到了克隆回购的令牌</p><p id="09bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">令牌是Base64编码的:<strong class="kh ir">z 2 hwx 2g 1c 1 nkdxpbuj 1 seszm 0 fvmnnwt 3 V5 wpvmdvjedb 6 oxn 6 ca = =</strong></p><p id="9a42" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解码它给我们:<strong class="kh ir">GHP _ h6 ssjuzgmbuhk 33 au 2 spouyxzu 05 ix0z 9 szp</strong></p><h1 id="fe45" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">跟踪提交</h1><p id="6d84" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">克隆回购并没有给我们带来任何有趣的东西，所以是时候查看提交历史了。</p><p id="b2fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">初始搜索给了我们这个，虽然很有趣但是我们不需要这个。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/8a9b71ea1c6eb65aef15dabca168a75e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*R7KBZlhGskBPxJzQ2q9pdQ.jpeg"/></div></figure><p id="a121" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">撤销提交后，我们发现一些非常有趣的事情，它是<strong class="kh ir">标志</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oa"><img src="../Images/6cd23b7cc800dd23e663679c90f45f71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkAfQ6K_QJsAFTEUl1QZTA.jpeg"/></div></div></figure><p id="1dfd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们找到了2级标志</p><blockquote class="ne"><p id="f490" class="nf ng iq bd nh ni ob oc od oe of la dk translated">二级标志:CTF {恭喜您_Level02_Completed}。超文本标记语言</p></blockquote><h1 id="0209" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw no jx lz jz np ka mb kc nq kd md me bi translated">结束狩猎</h1><p id="d72f" class="pw-post-body-paragraph kf kg iq kh b ki mf jr kk kl mg ju kn ko mh kq kr ks mi ku kv kw mj ky kz la ij bi translated">这个CTF抛出了一些惊人的挑战，一些来自现实世界，另一些来自想象世界，就像哈利波特一样。</p></div><div class="ab cl og oh hu oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ij ik il im in"><p id="f1e4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">非常感谢你的阅读。喜欢就分享😇😇</p><p id="86d5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关注我这里的<a class="ae mk" href="https://mayank-01.medium.com/follow" rel="noopener"> <strong class="kh ir"> <em class="mm">中的</em> </strong> </a>和<a class="ae mk" href="https://mayank-01.medium.com/subscribe" rel="noopener"> <strong class="kh ir"> <em class="mm">订阅邮件列表</em> </strong> </a> <strong class="kh ir">💌如果你想在我发表文章时得到它们。✨✨</strong></p><p id="0476" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以在推特上找我:<a class="ae mk" href="https://twitter.com/mayank_pandey01" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">mayank _ pandey 01</strong></a><strong class="kh ir">👻</strong></p></div></div>    
</body>
</html>