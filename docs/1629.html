<html>
<head>
<title>HOW I HACKED BILLION ANDROID USERS SOCIAL AND 3rd PARTY ACCOUNT | A STORY ABOUT 5000$ BUG</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何黑掉10亿安卓用户的社交和第三方账户|一个关于5000美元漏洞的故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-hacked-billion-android-users-social-and-3rd-party-account-a-story-about-5000-bug-c422ca43bd2?source=collection_archive---------0-----------------------#2021-10-09">https://infosecwriteups.com/how-i-hacked-billion-android-users-social-and-3rd-party-account-a-story-about-5000-bug-c422ca43bd2?source=collection_archive---------0-----------------------#2021-10-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f32f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇博客中，我将解释我发现一个漏洞的过程，这个漏洞触发了移动应用程序，从而允许我接管多个帐户。</p><h2 id="fae3" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated"><strong class="ak">深度链接</strong></h2><p id="1336" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">深度链接是一种将用户直接发送到应用程序而不是网站或商店的链接类型。它们用于将用户直接发送到特定的应用内位置，节省用户自己定位特定页面的时间和精力，从而显著改善用户体验。</em> </strong></p><p id="46e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">深度链接通过指定一个自定义URL方案(iOS通用链接)或一个意向URL(在Android设备上)来打开你的应用程序(如果已经安装的话)。还可以设置深层链接，将用户引导至特定的事件或页面，这些链接可能与您想要开展的活动相关联。</em>T11】</strong></p><h2 id="22b7" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">攻击</h2><p id="53ab" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">Android有一个名为app link的组件，确切地说，它叫做deep link，是专门为触发任何移动应用程序而开发的。如前所述，即使应用程序被更新，也有可能被劫持。研究人员如何利用它…当攻击者开发一个应用程序时，他会开发一个深度链接，其次，这个深度链接会触发邪恶的网站。例如，如果今天发布了一个更新，第二天就会发布第二个更新，一群用户会安装并更新它。无论你在这里给什么，它都会被加载到深度链接应用程序中。你知道，如果你重置密码，链接将被发送给攻击者，他可以窃取令牌，他可以做任何他想做的事情，所以这是一个场景。</p><p id="cdc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">研究人员开发了带有深度链接劫持有效载荷的恶意软件，以利用任何深度链接集成的android应用程序。</p><p id="5048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤:</strong></p><ol class=""><li id="3b80" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated">研究人员用自己的深度链接劫持有效载荷开发恶意软件。在这种情况下，他然后在他自己的深层链接上测试它(深层链接:<a class="ae lt" href="https://cappriciosec.com)" rel="noopener ugc nofollow" target="_blank">https://cappriciosec.com)</a>。</li></ol><p id="79c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.每当用户单击此链接时，都会出现一个提示，要求选择其中一个。其中一个选项选择“<em class="kl">只是一次</em> <strong class="jp ir"> </strong>”或者另一个选项“<em class="kl">总是</em>”。</p><p id="1ebb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.当用户点击选项“<em class="kl"> ALWAYS </em>”时，恶意软件打开，每当他/她点击链接时，它就会自动触发。这是基本机制。</p><p id="cc80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.研究人员修改了恶意软件，在第一个案例中，他编程的方式是只触发cappriciosec.com，然后他添加了一个额外的有效载荷，可以触发任何应用程序链接</p><p id="ce4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.现在，研究人员在google play商店发布了一个更新，用户将获得一个更新，用户将更新它</p><p id="6d7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.更新后，应用程序恶意软件功能将发生变化，因为研究人员更新了恶意软件中的新有效载荷。正如我们已经知道的，用户已经允许访问，这反过来触发了恶意软件。每当用户单击Cappriciosec链接时。</p><p id="b3d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果用户打开任何链接，它将自动触发恶意软件，弹出窗口将永远不会要求选择“只一次”或“总是”。</p><p id="fe39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">为什么它易受攻击？</strong></p><p id="3a3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前面提到用户允许打开cappriciosec.com，但是更新后，任何链接都可以处理，没有弹出窗口出现。这一切都是在用户不知情的情况下发生的，因此这是易受攻击的部分。</p><p id="848d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">冲击</strong></p><p id="66bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有更新，就有可能注入有效载荷。最大的影响是，它很容易绕过验证，如双因素认证，电子邮件验证码或令牌，密码重置链接或令牌，帐户凭证，等等..任何与网络相关的东西都很容易被劫持。但要做到这一点，它不需要用户认证，只需一个代码就可以做到这一点，任何HTTP相关的东西都可以很容易地被这种类型的漏洞劫持</p><blockquote class="lu lv lw"><p id="0c1f" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">被</strong>发现的漏洞:——karthithehacker(<a class="ma mb ep" href="https://medium.com/u/a14784d94f2c?source=post_page-----c422ca43bd2--------------------------------" rel="noopener" target="_blank">Karthikeyan。V </a></p><p id="3cd3" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">合作完成&amp;报告撰写:-</strong><a class="ae lt" href="https://www.linkedin.com/in/jeyasri-a-7b571a1a9/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">jeyasri</strong></a><strong class="jp ir">。答(耶亚斯里</strong> __001)</p></blockquote><p id="a885" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">时间线</strong></p><blockquote class="lu lv lw"><p id="2cb1" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">向android操作系统安全团队报告:</strong>日期:2020年8月7日12:11PM</p><p id="de22" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">创作期</strong>:2020年8月10日晚上11:37</p><p id="afa2" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">指定日期</strong>:2020年8月11日上午10:42</p></blockquote><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mc"><img src="../Images/f46a1697e8edf7b22a1b2934cb3d0186.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NZXC0O3_VRFOEqqYCMc3QQ.jpeg"/></div></div></figure><blockquote class="lu lv lw"><p id="e067" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated">更新更多</p></blockquote><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mo"><img src="../Images/ca2e6ef4149cec76acc65cf825a0b443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Z_pvRlPduhXC6FvuGHeCw.jpeg"/></div></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mp"><img src="../Images/1f0b870fb2fac8905fe2fb6c5b2ed273.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtV_fGn7R1t6W8u-fTrNCg.jpeg"/></div></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mp"><img src="../Images/e430dfcb55bbe55e448149131d6a59ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MIG4wlT_M2uBS9RUyYNOhw.jpeg"/></div></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mq"><img src="../Images/5490845af33164d44f837c45d031febf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ic3xyeN88Biz8PnA3McUcg.jpeg"/></div></div></figure><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mr"><img src="../Images/b984ca0ccb85b4d9fc9d4e3cf164333e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ei1MXfXiTwE_FKcVcJRuxw.jpeg"/></div></div></figure><blockquote class="lu lv lw"><p id="8a78" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">固定日期</strong>:2021年2月2日凌晨1:57</p><p id="9e73" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated">致谢:-<a class="ae lt" href="https://source.android.com/s/results/?q=jeyasri" rel="noopener ugc nofollow" target="_blank">https://source.android.com/s/results/?q=jeyasri</a></p><p id="3a23" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">奖励日期</strong>:2021年2月2日凌晨1点57分</p><p id="a7b8" class="jn jo kl jp b jq jr js jt ju jv jw jx lx jz ka kb ly kd ke kf lz kh ki kj kk ij bi translated"><strong class="jp ir">奖励</strong>:5000美元</p></blockquote><figure class="md me mf mg gt mh gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ms"><img src="../Images/01d7fade41a2ce74575be140b93ad36a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QFNQA8gyva0JTOgkEwkvEA.png"/></div></div></figure><h2 id="efc0" class="km kn iq bd ko kp kq dn kr ks kt dp ku jy kv kw kx kc ky kz la kg lb lc ld le bi translated">注意:-</h2><p id="cdf8" class="pw-post-body-paragraph jn jo iq jp b jq lf js jt ju lg jw jx jy lh ka kb kc li ke kf kg lj ki kj kk ij bi translated">我们已经要求android安全团队对该CVE进行保密，因此我们不能公开有效载荷、恶意软件源代码和概念验证视频</p><p id="3563" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">-谢谢</strong></p><p id="9b51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作者:- <a class="ae lt" href="https://www.linkedin.com/in/agnes-rusaliya-3b18481b7/" rel="noopener ugc nofollow" target="_blank">艾格尼丝·鲁莎莉娅</a></p></div></div>    
</body>
</html>