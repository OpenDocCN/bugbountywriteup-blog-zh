<html>
<head>
<title>This SIMPLE trick will exploit image uploads - $2500 TikTok bug bounty.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这个简单的技巧将利用图片上传-2500美元抖音虫赏金。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/this-simple-trick-will-exploit-image-uploads-2500-tiktok-bug-bounty-41fc01128ee?source=collection_archive---------1-----------------------#2022-08-25">https://infosecwriteups.com/this-simple-trick-will-exploit-image-uploads-2500-tiktok-bug-bounty-41fc01128ee?source=collection_archive---------1-----------------------#2022-08-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="cece" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在SVG文件中存储XSS。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/d6abbe006f711077553231a7d15d0384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_5yeoPC54yupPaf0KGJ_Pg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">电脑黑客的赛博朋克数字艺术。</figcaption></figure><h2 id="3e5c" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">摘要</h2><p id="abcf" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">跨站点脚本(XSS)是所有web应用程序开发人员头疼的安全问题。在这种类型的漏洞中，攻击者会以某种方式将恶意的JavaScript代码或“脚本”注入良性的web应用程序。如果攻击者能够成功嵌入该脚本，那么该脚本将拥有访问重要用户信息的权限。当受害者访问所述web应用时，恶意脚本可以窃取用户的cookies或其他帐户凭证。近日，HackerOne用户<code class="fe mo mp mq mr b"><a class="ae mn" href="https://hackerone.com/sinayeganeh?type=user" rel="noopener ugc nofollow" target="_blank">sinayeganeh</a></code>在<a class="ae mn" href="https://hackerone.com/reports/1504202" rel="noopener ugc nofollow" target="_blank">抖音</a>发现一个XSS漏洞，被判中等严重程度，并获得2500美元的bug赏金！</p><p id="be9f" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated">XSS的传统示例是测试输入字段并添加以下有效负载:</p><pre class="kj kk kl km gt mx mr my mz aw na bi"><span id="11cb" class="ky kz it mr b gy nb nc l nd ne">&lt;script&gt; <!-- -->alert(“TEST”); &lt;/script&gt;</span></pre><p id="081e" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated">如果弹出一个警告框说“测试”，那么XSS是可能的。这个脚本可能会被一个更危险的脚本所取代，这个脚本会将访问者的会话<code class="fe mo mp mq mr b"><a class="ae mn" href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie" rel="noopener ugc nofollow" target="_blank">document.cookie</a></code>发送给黑客。许多现代web框架都有某种针对易于发现的XSS攻击的防御措施，但黑客们不断想出有趣的方法来绕过这些过滤器。Ismail Tasdelen在Github 上为XSS收集了一份非常棒的有效载荷测试列表，而<a class="ae mn" href="https://twitter.com/XssPayloads" rel="noopener ugc nofollow" target="_blank"> @XssPayloads </a>也一直在推特上发布新发现的有效载荷。</p><h2 id="fa02" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">SVG有效负载</h2><p id="271c" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated"><a class="ae mn" href="https://developer.mozilla.org/en-US/docs/Web/SVG" rel="noopener ugc nofollow" target="_blank">可缩放矢量图形，或svg </a>，是“一种基于XML的标记语言，用于描述基于二维的矢量图形”(来源:<a class="ae mn" href="https://developer.mozilla.org/en-US/docs/Web/SVG" rel="noopener ugc nofollow" target="_blank"> Mozilla </a>)。这意味着这是一种不同于标准jpg或png的表示图像的方式。开发者防范包含在<code class="fe mo mp mq mr b">&lt;img&gt;</code>标签中的XSS更常见，但是<code class="fe mo mp mq mr b">&lt;svg&gt;</code>标签也支持JS代码！</p><p id="1ec5" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated">本质上，这种形式的XSS有效载荷与标准的<code class="fe mo mp mq mr b">&lt;img&gt;</code>有效载荷相同，但目标是标准防御机制不会将其注册为有效载荷。</p><p id="9adc" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated">黑客组织<a class="ae mn" href="http://ghostlulz.com/xss-svg/" rel="noopener ugc nofollow" target="_blank"> Ghostlulz撰写了一篇很好的文章</a>，解释了如何为SVG文件构建一个可靠的有效负载的细节。我将包含一个他们突出显示的有效负载作为示例，如果web应用程序允许上传SVG文件并容易受到XSS攻击，它将弹出一个带有文本“Ghostlulz XSS”的警告框。</p><pre class="kj kk kl km gt mx mr my mz aw na bi"><span id="42a0" class="ky kz it mr b gy nb nc l nd ne">&lt;?xml version="1.0" standalone="no"?&gt; <br/>&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"&gt;  </span><span id="2815" class="ky kz it mr b gy nf nc l nd ne">&lt;svg version="1.1" baseProfile="full" &gt;    <br/>    &lt;rect width="300" height="100" style="fill:rgb(0,0,255); stroke-width:3;stroke:rgb(0,0,0)" /&gt;    <br/>    &lt;script type="text/javascript"&gt; <br/>        alert("Ghostlulz XSS");    <br/>    &lt;/script&gt; <br/>&lt;/svg&gt;</span></pre><h2 id="aa56" class="ky kz it bd la lb lc dn ld le lf dp lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">抖音利用</h2><p id="f0d9" class="pw-post-body-paragraph lu lv it lw b lx ly ju lz ma mb jx mc lh md me mf ll mg mh mi lp mj mk ml mm im bi translated">HackerOne用户<code class="fe mo mp mq mr b"><a class="ae mn" href="https://hackerone.com/sinayeganeh?type=user" rel="noopener ugc nofollow" target="_blank">sinayeganeh</a></code>最近在<a class="ae mn" href="https://hackerone.com/reports/1504202" rel="noopener ugc nofollow" target="_blank">抖音</a>发现了一个XSS漏洞。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ng"><img src="../Images/1ab94682c9d6009a999c163172185261.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*itcXdHJtoFHfUevGufNK2w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae mn" href="https://hackerone.com/reports/1504202" rel="noopener ugc nofollow" target="_blank">钢骨</a>上报告总结</figcaption></figure><p id="bbc0" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated">如摘要中所述，抖音Ads上有一个易受攻击的端点，允许包含XSS有效负载的SVG上传。抖音通常不会提供比摘要更多的关于已披露漏洞的信息，但这被给予了6.5的评级，这是一个中等严重级别。</p><p id="db2e" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated"><code class="fe mo mp mq mr b"><a class="ae mn" href="https://hackerone.com/sinayeganeh?type=user" rel="noopener ugc nofollow" target="_blank">sinayeganeh</a></code>的伟大发现，祝贺你获得2500美元的bug赏金！</p><pre class="kj kk kl km gt mx mr my mz aw na bi"><span id="7e06" class="ky kz it mr b gy nb nc l nd ne"><strong class="mr iu">Want to Connect? </strong></span><span id="1a8a" class="ky kz it mr b gy nf nc l nd ne">Please consider contacting me at roberto.cyberkid@gmail.com following me on Medium, <a class="ae mn" href="https://www.buymeacoffee.com/robertocyberkid" rel="noopener ugc nofollow" target="_blank">buying me a coffee</a>, following me on <a class="ae mn" href="https://twitter.com/CyberKidLama" rel="noopener ugc nofollow" target="_blank">twitter</a>, or connecting with me on <a class="ae mn" href="https://www.linkedin.com/in/roberto-lama-9a126a123/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>!</span></pre></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="c0f8" class="pw-post-body-paragraph lu lv it lw b lx ms ju lz ma mt jx mc lh mu me mf ll mv mh mi lp mw mk ml mm im bi translated"><em class="no">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae mn" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lw iu"> <em class="no">加入我们的每周简讯</em> </strong> </a> <em class="no">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>