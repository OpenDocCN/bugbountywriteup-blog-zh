<html>
<head>
<title>Write-up: Authentication bypass via OAuth implicit flow @ PortSwigger Academy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐:通过OAuth隐式流@ PortSwigger Academy绕过身份验证</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/write-up-authentication-bypass-via-oauth-implicit-flow-portswigger-academy-c98b841d3d3d?source=collection_archive---------2-----------------------#2022-08-30">https://infosecwriteups.com/write-up-authentication-bypass-via-oauth-implicit-flow-portswigger-academy-c98b841d3d3d?source=collection_archive---------2-----------------------#2022-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/762984425c4c6037470c23aa1f2e07a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0dehpIqyyl8U7kn_.png"/></div></div></figure><p id="5265" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇关于通过OAuth隐式流绕过实验室<em class="kw">认证的文章是我在<a class="ae kx" href="https://portswigger.net/web-security" rel="noopener ugc nofollow" target="_blank"> PortSwigger的Web安全学院</a>的演练系列的一部分。</em></p><p id="5817" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">学习路径</strong>:高级主题→ OAuth认证</p><div class="ky kz gp gr la lb"><a href="https://portswigger.net/web-security/oauth/lab-oauth-authentication-bypass-via-oauth-implicit-flow" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd ir gy z fp lg fr fs lh fu fw ip bi translated">实验室:通过OAuth隐式流绕过身份验证|网络安全学院</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">本实验使用OAuth服务来允许用户使用其社交媒体帐户登录。有缺陷的验证由…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">portswigger.net</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp jw lb"/></div></div></a></div><p id="21fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Python脚本:<a class="ae kx" href="https://github.com/frank-leitner/portswigger-websecurity-academy/blob/main/22_OAuth_authentication/Authentication_bypass_via_OAuth_implicit_flow/script.py" rel="noopener ugc nofollow" target="_blank"> script.py </a></p><h1 id="cdc3" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">实验室描述</h1><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/2cde22158835b42ea8109a8e052c1ae4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MwVgzFr7-_WqPHui.png"/></div></div></figure><h1 id="095e" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">步伐</h1><p id="053b" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">通常，第一步是分析实验室应用程序的功能。在这个实验室中，它是一个博客系统。</p><p id="8d55" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该描述提到了认证功能的访问控制中的一个缺陷，所以我使用已知的凭证<code class="fe my mz na nb b">wiener</code>登录。</p><p id="085f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">登录是通过外部身份提供者完成的。第一步，我登录，第二步，我授权目标应用程序接收我的一些数据:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/38c090a621fb19ea07138a0925cd03b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zY-zXEvf_0B5lWkF.png"/></div></div></figure><p id="c121" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我点击<code class="fe my mz na nb b">Continue</code>，我就登录到实验室应用程序。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="5848" class="lq lr iq bd ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj no ml mm mn bi translated">该理论</h1><p id="5cf8" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">登录后，我在Burp代理的历史中检查登录特性的请求/响应活动。</p><p id="def6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实验室名称已经暗示了OAuth的隐式流程。这种方法是不安全的，因为它通过客户端路由安全信息，如果不包含针对操纵的对策，我就可以操纵它。</p><p id="0c76" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">身份提供者向我发送身份验证令牌，我的客户端使用该令牌向目标应用程序进行身份验证:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/6c92ecb6cd790dfea5fd463a456dd502.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hRMLl4Wq3dTCnHap.png"/></div></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/ada302d9c2b4b815ddf6133f1a7323e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*APgjUROW8ID4p3nr.png"/></div></div></figure><p id="6b61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果令牌中没有关于我的用户名的信息，那么使用我的令牌并替换用户名和电子邮件就足以冒充我的受害者。</p><p id="3fac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">甚至在OAuth 2.0的<a class="ae kx" href="https://datatracker.ietf.org/doc/html/rfc6749#section-1.3.2" rel="noopener ugc nofollow" target="_blank">原始RFC </a>中也提到了安全问题。不幸的是，以一种相当模糊的方式:</p><blockquote class="nq"><p id="6e28" class="nr ns iq bd nt nu nv nw nx ny nz kv dk translated"><em class="oa">应权衡便利性和安全影响</em></p></blockquote><p id="9672" class="pw-post-body-paragraph jy jz iq ka b kb ob kd ke kf oc kh ki kj od kl km kn oe kp kq kr of kt ku kv ij bi translated">这种措辞不够令人沮丧，所以在最新的草案中，措辞更加强烈和直接:</p><blockquote class="nq"><p id="a81d" class="nr ns iq bd nt nu nv nw nx ny nz kv dk translated"><em class="oa">为了避免这些问题，客户不应使用隐性授权[…] </em></p></blockquote><p id="f919" class="pw-post-body-paragraph jy jz iq ka b kb ob kd ke kf oc kh ki kj od kl km kn oe kp kq kr of kt ku kv ij bi translated">只有时间会证明这是否足够…</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="d673" class="lq lr iq bd ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj no ml mm mn bi translated">恶意负载</h1><p id="10cd" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">我退出应用程序，在Burp代理中激活intercept，然后重新登录。一旦身份验证令牌被拦截，我就更改用户名和电子邮件给我的受害者。</p><p id="848d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这样，我登录的令牌值将用于受害者的帐户，至少在令牌不包含任何用户名和/或电子邮件信息的情况下是如此:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/6b2201fd3f63b8737b01d7e7c116c6a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*QlGDv0PPzR9giyys.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk translated">身份验证请求的操作</figcaption></figure><p id="f51c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我转发请求并关闭拦截。完成所有重定向后，应用程序更新为</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/1c1d82e9ee4e73c5132143f58435e63a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*We0Fut8FiSbS8Cbu.png"/></div></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="8251" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">原载于【https://github.com】<a class="ae kx" href="https://github.com/frank-leitner/portswigger-websecurity-academy/tree/main/22_OAuth_authentication/Authentication_bypass_via_OAuth_implicit_flow" rel="noopener ugc nofollow" target="_blank"><em class="kw"/></a><em class="kw">。</em></em></p><p id="e1c4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe my mz na nb b"><a class="ae kx" href="https://medium.com/@frank.leitner/membership" rel="noopener">New to Medium? Become a Medium member to access all stories on the platform and support me at no extra cost for you!</a></code></p><p id="c74d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">来自Infosec的报道:每天Infosec上都会出现很多难以跟上的内容。</em> <a class="ae kx" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="kw">加入我们的每周简讯</em> </strong> </a> <em class="kw">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>