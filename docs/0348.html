<html>
<head>
<title>How I Found XSS By Searching In Shodan</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何在庄丹找到XSS的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-found-xss-by-searching-in-shodan-6943b799e648?source=collection_archive---------0-----------------------#2019-08-04">https://infosecwriteups.com/how-i-found-xss-by-searching-in-shodan-6943b799e648?source=collection_archive---------0-----------------------#2019-08-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="30b0" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这只是另一个XSS的博客。</p></blockquote><p id="97ba" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">不管怎样，我正在尝试一个私人项目，我从信息收集开始，同时在后台开始dirbuster。我从谷歌和shodan开始。当下我搜索了<strong class="jt ir"><em class="js"/></strong>在搜索。shodan查询中出现了一个带有响应的结果。我打开链接，它有一个未开发的带有搜索栏的WordPress页面。我输入XSS有效载荷，它弹出来了。然后，我将请求方法从POST改为GET，效果非常好。我们将假设网站是https://companyname.com的T4。</p><h1 id="82c6" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">描述:</strong></h1><p id="818f" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">代码注入攻击要求攻击者在应用程序的数据字段中输入恶意代码(通常是JavaScript或HTML ),该数据字段将显示给应用程序的另一个用户。当受害者用户查看该数据字段时，javaScript将在受害者的浏览器中执行，并可能执行恶意操作。一种常见的攻击是javaScript或HTML代码将受害者的cookies发送给攻击者。</p><h1 id="bbda" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">影响:</strong></h1><p id="40ca" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">攻击者在易受攻击的参数/用户搜索字段中注入恶意的javascript代码或Html代码。这里是一个<strong class="jt ir">反映XSS </strong>，这是由shodan查询发现的。这可能被用来窃取会话令牌和cookie，因为它是运行在同一服务器上的父网站的一部分。</p><h1 id="9365" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">复制步骤:</h1><p id="5ce7" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">在石家庄搜索<strong class="jt ir"><em class="js">companyname.com</em></strong>。</p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi lv"><img src="../Images/8086981639f3f1c23ae199aa6ede2b57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RhSOgrJQmPd0LLNEJDM_Nw.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">Shodan查询结果</figcaption></figure><ol class=""><li id="6ccc" class="ml mm iq jt b ju jv jy jz kp mn kq mo kr mp ko mq mr ms mt bi translated">访问网址:<br/><a class="ae mu" href="http://companyname.com" rel="noopener ugc nofollow" target="_blank"><em class="js">https://www.companyname.com/eiy/redacted?s=test</em></a></li><li id="aced" class="ml mm iq jt b ju mv jy mw kp mx kq my kr mz ko mq mr ms mt bi translated">在搜索栏输入有效载荷<strong class="jt ir"><em class="js">"&gt;&lt;img src = x on error = alert(document . domain)&gt;</em></strong></li><li id="5d35" class="ml mm iq jt b ju mv jy mw kp mx kq my kr mz ko mq mr ms mt bi translated">XSS警报出现了。</li><li id="37d2" class="ml mm iq jt b ju mv jy mw kp mx kq my kr mz ko mq mr ms mt bi translated"><br/>概念证明:<a class="ae mu" href="http://comapanyname.com" rel="noopener ugc nofollow" target="_blank">https://www.companyname.com/eiy/redacted?s = % 22% 3E % 3c img+src % 3Dx+on error % 3d alert % 28 document . domain % 29% 3E</a></li></ol><figure class="lw lx ly lz gt ma gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi na"><img src="../Images/3ed6cba05b10468aabc51e2a8b8d23ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hbssdklKpPOaXxIa7dpG1w.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk translated">反映了XSS</figcaption></figure><h1 id="3e3c" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">补救:</strong></h1><p id="f124" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated">为了防止跨站点脚本之类的数据验证攻击，我推荐一种包括输入验证和输出净化的深度防御策略。</p><p id="e4c5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">阻止任何数据验证攻击的第一步是验证输入，以防止接受任何可能在应用程序或数据的最终目的地(在本例中为浏览器)中有特殊含义的字符。处理输入验证的推荐方式是默认拒绝，只接受具有期望值的输入(即白名单)。输入验证例程应该总是检查数据的长度、范围、类型和格式(可能使用正则表达式)。</p><p id="d908" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">清除应用程序提供的HTML中的恶意字符是防止XSS的一个同样重要的措施。例如，字符&lt; would be encoded as &lt; and, although appearing to the user as the less-than character, would not be interpreted by the client browser as the start of an HTML tag.</p><p id="0604" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">The best way to prevent XSS is to enforce output encoding, precisely Hex or URL encoding on user-controlled parameters which prevent the code to execute in the HTML page.</p><h1 id="6395" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">引用:</strong></h1><p id="a09c" class="pw-post-body-paragraph jq jr iq jt b ju lq jw jx jy lr ka kb kp ls ke kf kq lt ki kj kr lu km kn ko ij bi translated"><a class="ae mu" href="https://www.owasp.org/index.php/XSS_(Cross_Site_Scripting)_Prevention_Cheat_Sheet" rel="noopener ugc nofollow" target="_blank">https://www . owasp . org/index . PHP/XSS _(Cross _ Site _ Scripting)_ Prevention _ Cheat _ Sheet</a><br/>http://<a class="ae mu" href="http://www.softwaremag.com/L.cfm?Doc=1006-12/2006" rel="noopener ugc nofollow" target="_blank">www.softwaremag.com/L.cfm?Doc=1006-12/2006</a><br/><a class="ae mu" href="https://www.acunetix.com/websitesecurity/cross-site-scripting/" rel="noopener ugc nofollow" target="_blank">https://www . acune tix . com/website security/Cross-Site-Scripting/</a></p><figure class="lw lx ly lz gt ma gh gi paragraph-image"><a href="https://www.buymeacoffee.com/justmorpheus"><div class="gh gi nb"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></a></figure></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="8628" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><em class="js">关注</em> <a class="ae mu" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="js"> Infosec报道</em> </a> <em class="js">获取更多此类精彩报道。</em></p><div class="nj nk gp gr nl nm"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">信息安全报道</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">medium.com</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa mf nm"/></div></div></a></div></div></div>    
</body>
</html>