<html>
<head>
<title>Protect your business from a DoS attack, with your firewall</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用您的防火墙保护您的企业免受DoS攻击</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/protect-your-business-from-a-dos-attack-with-your-firewall-5f9587ea4af0?source=collection_archive---------1-----------------------#2020-11-02">https://infosecwriteups.com/protect-your-business-from-a-dos-attack-with-your-firewall-5f9587ea4af0?source=collection_archive---------1-----------------------#2020-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/61e7c95d7b8c3543ae4df6ba72dffcc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*n3oc7jZDY14lG0CL"/></div></div></figure><p id="da1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在过去30年的所有网络威胁中，拒绝服务攻击可能是对您的企业而言最知名、最复杂的一种。话虽如此，但它是最容易执行的，这里有一篇文章介绍了如何针对我的家用路由器<a class="ae kw" href="https://medium.com/bugbountywriteup/some-may-call-it-a-dos-attack-i-just-tried-to-find-how-my-streamer-behaves-under-stress-36fead7643e4?source=friends_link&amp;sk=2dcdae27987fdf4ea862e61c47d7b3d6" rel="noopener"><strong class="ka ir">https://medium . com/bugbountywriteup/some-may-call-it-a-dos-attack-I-just-tryed-to-find-how-my-streamer-behaviors-under-stress-36 fead 7643 E4？source = friends _ link&amp;sk = 2d cdae 27987 fdf 4 ea 862 e 61 c 47d 7 B3 d 6</strong>T5】</a></p><h1 id="9384" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">DoS攻击有很多种类型，但想法是一样的，攻击者想要摧毁您的关键基础设施，让您的客户和员工无法使用。</strong></h1><h1 id="7b63" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">坏东西</strong></h1><ul class=""><li id="1f12" class="lv lw iq ka b kb lx kf ly kj lz kn ma kr mb kv mc md me mf bi translated">大多数DoS攻击利用众所周知的端口，如端口80</li><li id="7d72" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">DoS攻击是分布式的</li><li id="9f6c" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">它们可以使用低CPU设备如IP摄像机来执行</li><li id="3259" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">仅有防火墙是不够的</li><li id="44aa" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">使用第3、4和7层的攻击变得越来越复杂</li><li id="48fb" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">IPS检查将占用其他操作可能需要的资源</li><li id="cfe2" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">IPS引擎的检测可能会导致误报事件</li><li id="8553" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">新的DoS技术出现了</li></ul><p id="01ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> DOS攻击可以像ICMP flood攻击一样非常快，也可以像slowloris攻击一样非常慢</strong><a class="ae kw" href="https://en.wikipedia.org/wiki/Slowloris_(computer_security)" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/slow loris _(computer _ security)</a></p><h1 id="4a54" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">敌人在</strong>之内</h1><p id="a7c7" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">DOS攻击可以毫无理由地从内部发起，也可以通过连接到受感染PC的僵尸网络进行控制。</p><p id="ce1e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用网络行为分析(一旦您有了稳定的网络基线)和基于速率的阈值，可以快速缓解DDOS攻击，该阈值可以针对异常情况发出警报并提供保护，例如一秒钟内从一个源或向一个目的地发送太多SYN请求、CPU过载…</p><p id="3d48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">话虽如此，但在本文中，我们将研究使用ICMP flood的简单攻击，以及如何使用我们的IPS和DDOS策略来保护它。那么让我们开始</strong></p><h1 id="098d" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">第一步</strong></h1><p id="acd0" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">我假设您已经设置好了LAN和WAN，我们的任务是保护您的WAN接口免受恶意ICMP flood攻击，即攻击者试图用ICMP回应请求淹没您的服务器。ICMP回应请求也称为PING，用于排除连通性问题</p><p id="2c30" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">在你的堡垒</strong>上<a class="ae kw" href="https://amzn.to/3phfikH" rel="noopener ugc nofollow" target="_blank">https://amzn.to/3phfikH</a>上<strong class="ka ir">导航到政策&amp;对象</strong></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/856da77853498bcc506e8c3e15a48cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tbSr1JHu-R-372a6"/></div></div></figure><p id="497e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">选择IPV4 DoS策略</strong></p><p id="fca6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您的DOS策略(FortiGate防火墙中有多种类型的策略，其中一种是DOS策略)使用FortiGate IPS引擎来跟踪您网络中发生的各种异常情况。</p><p id="dbbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">IPS</strong>(入侵防御系统)引擎是每个下一代防火墙的一部分，如FortiGate、checkpoint、Paloalto防火墙。它的主要任务是保护您的网络免受以下两种情况的影响:异常、网络中的异常行为(如UDP数据包的突然增加)，或者更高的CPU百分比和利用众所周知的签名的攻击</p><p id="0088" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">您的FortiGate IPS使用签名数据库</strong>，但它还做了另外一件事，<strong class="ka ir">它对众所周知的协议</strong>进行解码，并查看它们的内部结构，这样做时，它会检查流量的数据包是否到位，其行为是否符合标准，一个很好的例子就是发送到您的WAN接口的ICMP数据包。这种数据包的标准在大多数情况下是56字节(不包括报头)，另一个原因可能是过多的HTTP报头不符合标准</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/46568f136678b02d62852dae485c8129.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*h8yFOpnwhU_3_axU"/></div></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/7ea06a72aa7b2329a2c31da7bdb7e8cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/0*-yE_KyXj0aVL2byr"/></div></figure><h1 id="b7a9" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">步骤3 —选择新的Dos策略</strong></h1><p id="0f7d" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">当您选择创建新的DoS策略时，您将看到以下屏幕</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/891bf5e0db70008cc268ccd72b5f20e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*lqbsnQ_ktJx5UWhu"/></div></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/97db7f1ab60dba45e01184242dea856a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jjoIsJ0xpnW5hTYf"/></div></div></figure><p id="087f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">在这里，您将配置不同的第3层和第4层异常</strong></p><p id="86da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您需要提供的第一个信息是传入接口，通常是您的WAN接口，至于源地址、目的地和服务，您可以非常细化，但在大多数情况下，我们将使用所有</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/14d7797b740d40101b74e0ada0091df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aiT6hW1cmR-uTA3L"/></div></div></figure><p id="3478" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">现在到了实际创建不同传感器的阶段，这些传感器将跟踪异常情况。您可以将传感器应用于4种协议:</strong></p><ul class=""><li id="be81" class="lv lw iq ka b kb kc kf kg kj mv kn mw kr mx kv mc md me mf bi translated">传输控制协议（Transmission Control Protocol）</li><li id="a545" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">用户数据报协议(User Datagram Protocol)</li><li id="b713" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">网间控制报文协议(Internet Control Messages Protocol)</li><li id="65d7" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">SCTP</li></ul><p id="b830" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">您还可以在一个策略中为不同的层应用不同的传感器</strong></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/87fbfe06d00842fa7aaeb783967fc2aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*AE92-xFcf1hO7oe7"/></div></div></figure><p id="ac61" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">您将在政策中看到的主要异常情况有:</strong></p><ul class=""><li id="6c8c" class="lv lw iq ka b kb kc kf kg kj mv kn mw kr mx kv mc md me mf bi translated">泛洪-检测大量协议</li><li id="ef1c" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">扫描/扫描-检测探测尝试</li><li id="510d" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">源-检测来自单个IP的大量数据</li><li id="d122" class="lv lw iq ka b kb mg kf mh kj mi kn mj kr mk kv mc md me mf bi translated">目的地-检测流向单个IP的大量数据</li></ul><p id="dfd9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在每个传感器的右侧，您会注意到阈值，每个异常都有其阈值，您可以(并建议)根据您的拓扑和网络基线来这样做</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/b4a3eb01c885301bf3869d2178eca869.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fPUvVSLjaEBaXxpn"/></div></div></figure><p id="ca42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">扫描、淹没和扫描传感器的阈值被定义为每秒的会话数</p><h1 id="2449" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">那么，我们如何配置ICMP flood DOS传感器</strong></h1><p id="1ba5" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">导航到第4层异常</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/623aafa7590b5793d03865f274ce2b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EWmHhFzQ3yzOHWaZ"/></div></div></figure><h1 id="91e2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">在动作窗格中，选择阻止</strong></h1><p id="cad1" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj ml kl km kn mm kp kq kr mn kt ku kv ij bi translated">在“阈值”面板中，选择ICMP的秒数。例如，如果您选择<strong class="ka ir"> 50 </strong>，您的传感器将丢弃数据包编号<strong class="ka ir"> 51 </strong></p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="2e94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">一段视频，取自我的Linux机器，在那里我对我的家庭网关发起了洪水攻击，但在20个数据包后，它就停止了，这符合我的IPS异常阈值</strong></p><p id="b1c7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的Fortigate管理指南手册【https://amzn.to/3brDX1t T2】</p><p id="54a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以订阅我在youtube.com/fortitip的频道或者参加我在https://www.udemy.com/course/fortigate-admin-crash-course/?<a class="ae kw" href="https://www.udemy.com/course/fortigate-admin-crash-course/?referralCode=0B534DCF7A6D8BD3417E" rel="noopener ugc nofollow" target="_blank">的FortiGate课程referral code = 0 b 534 DCF 7 a6 D8 BD 3417 e</a></p></div></div>    
</body>
</html>