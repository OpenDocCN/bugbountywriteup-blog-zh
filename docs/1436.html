<html>
<head>
<title>The fine line of IDOR (ESET $WAG)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伊多尔的细线(ESET $WAG)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/the-fine-line-of-idor-eset-wag-c5689a38690d?source=collection_archive---------1-----------------------#2021-07-01">https://infosecwriteups.com/the-fine-line-of-idor-eset-wag-c5689a38690d?source=collection_archive---------1-----------------------#2021-07-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，</p><p id="9401" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我们来谈谈几个月前我在ESET上发现的漏洞。漏洞已被修复，我已获准将其公之于众，所以我们可以自由交谈！</p><p id="82f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我谈论这个漏洞之前，我准备这篇文章的目的不是解释IDOR，所以我假设您已经有了IDOR的基本信息。<br/>那么让我们开始吧！</p><blockquote class="kl km kn"><p id="0ec3" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">基本侦察</strong></p></blockquote><p id="2fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我会把这部分讲得很短，因为没有多余的东西。简而言之，我正在检查ESET服务中的子域，我找到了以下类型的应用程序面板。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/296ef0a64ca534500d33fedaeb99dcd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*3vKYOGQiwKAzoqKxM11khw.png"/></div></figure><blockquote class="kl km kn"><p id="1004" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">开战吧！</strong></p></blockquote><p id="6060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我注册了应用程序，并试图了解这是怎么回事。没有太多，基本上下面这条信息引起了我的注意。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi la"><img src="../Images/5a288de670486f49209f1be4f59d6aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1G2fmEy03qlthBn9o7BDqw.png"/></div></div></figure><p id="d026" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它看起来像一个欢迎信息。我打开拦截，试图通过点击十字按钮直接删除消息。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/0b08e6e638a665bcbd6d506d150036ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*oQqHP1KPV0FkNYUJxYTBGQ.png"/></div></figure><p id="3822" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我遇到过这种请求。乍一看，没有什么引起我的注意。我没有看到任何对象id。我发送了请求，邮件被成功删除。我甚至无法接近伊多尔。<br/>几分钟后，我再次查看请求，参数<strong class="jp ir">“mainTable _ selection = "</strong>为空。我以为是关于对象id，但我不确定。我成功地再次提交了请求，消息已被删除，但看起来我没有选择任何对象。</p><blockquote class="kl km kn"><p id="b1cb" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">这里是伊多的细线！</strong></p></blockquote><p id="a4c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我回到应用程序面板来查找任何对象id，我在寻找一个可以更改请求的属性。当然，我不确定这里是否有一个IDOR，我只是在碰碰运气。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lg"><img src="../Images/2bbc68ee51bd2e93c840afa8a07995e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zw8Hi2PjarRTZzdsDr3R-Q.png"/></div></div></figure><p id="f810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，你注意到了，对吧？我重复删除过程，看看我错过了什么，然后我也注意到了。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lh"><img src="../Images/4f035915b431d7f89df206b333d945e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pFZJKd3CsR-cKgk_BUUzBw.png"/></div></div></figure><p id="618f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我重新提交了请求，看看会有什么变化。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi li"><img src="../Images/40ac686de02c29f2a00c0cd3570ee9d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*E_ntQZUN_upyRoiRkUNpUA.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">正如我们预测的:)</figcaption></figure><p id="9a19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即创建了一个受害者用户，并用它的欢迎消息替换了对象id。我的受害者的欢迎信息已被删除，宾果！电子邮件编号在特定值之间增加，这意味着系统中的所有电子邮件都可以删除。</p><p id="295a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">消息选择按钮直接在后台使用参数<strong class="jp ir"> "mainTable_selection=" </strong>工作，并不真正检查对象属于哪个用户。</p><p id="81c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向ESET安全团队报告了这个漏洞，并获得了奖品。我希望你喜欢！</p><p id="69f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">举报—2020年12月5日<br/>奖励—2020年12月23日<br/>修复—2021年4月27日</p></div></div>    
</body>
</html>