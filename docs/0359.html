<html>
<head>
<title>CVE-2019-15092 WordPress Plugin Import Export Users = 1.3.0 - CSV Injection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CVE-2019-15092 WordPress插件导入导出用户= 1.3.0 - CSV注入</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cve-2019-15092-wordpress-plugin-import-export-users-1-3-0-csv-injection-b5cc14535787?source=collection_archive---------0-----------------------#2019-08-22">https://infosecwriteups.com/cve-2019-15092-wordpress-plugin-import-export-users-1-3-0-csv-injection-b5cc14535787?source=collection_archive---------0-----------------------#2019-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/f3ef26a3c1f1362245e6539b3d2c9d75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*2V3YAL68xU_wncT4kB9YgQ.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated"><a class="ae jy" href="https://wordpress.org/plugins/users-customers-import-export-for-wp-woocommerce/" rel="noopener ugc nofollow" target="_blank">https://WordPress . org/plugins/users-customers-import-export-for-WP-woo commerce/</a></figcaption></figure><h1 id="563e" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">摘要</h1><p id="f470" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">CSV注入，也称为公式注入，在网站将不受信任的输入嵌入CSV文件时发生。当使用Microsoft Excel或LibreOffice Calc等电子表格程序打开CSV时，任何以“=”开头的单元格都将被软件解释为公式。恶意制作的公式可用于三种主要攻击:</p><ul class=""><li id="e307" class="lv lw iq kz b la lx le ly li lz lm ma lq mb lu mc md me mf bi translated">通过利用电子表格软件中的漏洞，如CVE-2014–3524，劫持用户的计算机。</li><li id="72a3" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">通过利用用户忽略从自己网站下载的电子表格中的安全警告的倾向来劫持用户的计算机。</li><li id="7f34" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">从电子表格或其他打开的电子表格中过滤内容。</li></ul><h1 id="eb20" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">影响</h1><p id="ac4b" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">拥有<strong class="kz ir">基本WordPress权限</strong>(订户)的恶意用户可以利用该插件的CSV注入漏洞，公开修改域名、姓氏、别名或显示名称，恶意加载到<strong class="kz ir">的管理员电脑上执行命令</strong>。</p><p id="3ec3" class="pw-post-body-paragraph kx ky iq kz b la lx lc ld le ly lg lh li ml lk ll lm mm lo lp lq mn ls lt lu ij bi translated">许多公司通常非常重视CSV注射。</p><ul class=""><li id="9d82" class="lv lw iq kz b la lx le ly li lz lm ma lq mb lu mc md me mf bi translated"><strong class="kz ir">https://hackerone.com/reports/126109:</strong><a class="ae jy" href="https://hackerone.com/reports/126109" rel="noopener ugc nofollow" target="_blank">优步</a></li><li id="be41" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated"><strong class="kz ir">哈克罗内:</strong>T12】https://hackerone.com/reports/72785</li><li id="7d7d" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated"><strong class="kz ir">哈克罗内:</strong>T16】https://hackerone.com/reports/124223</li><li id="21b1" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated"><strong class="kz ir">新遗迹:</strong><a class="ae jy" href="https://hackerone.com/reports/127032" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/127032</a></li></ul><h1 id="7695" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">概念证明</h1><ol class=""><li id="1ad9" class="lv lw iq kz b la lb le lf li mo lm mp lq mq lu mr md me mf bi translated">使用订阅者用户登录并更改“名字”、“姓氏”和“别名”字段(此有效负载使用PowerShell从web服务器下载恶意文件并在管理员的计算机中执行)。</li></ol><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ms"><img src="../Images/5cc22ccbaf50effb3da144a29d3c334e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Syuti2Kw0Tyk-ccno7dLsQ.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">恶意用户用户面板</figcaption></figure><p id="880b" class="pw-post-body-paragraph kx ky iq kz b la lx lc ld le ly lg lh li ml lk ll lm mm lo lp lq mn ls lt lu ij bi translated">2.使用管理员用户登录，然后<strong class="kz ir">将所有用户</strong>导出到CSV。</p><p id="8b24" class="pw-post-body-paragraph kx ky iq kz b la lx lc ld le ly lg lh li ml lk ll lm mm lo lp lq mn ls lt lu ij bi translated">3.如果您使用Microsoft Office打开该文件，您将看到<strong class="kz ir">字段以字符“=”</strong>开头，后跟PowerShell命令。</p><figure class="mt mu mv mw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nb"><img src="../Images/d0e6067b1a194153bf2ff4bd116da839.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4hinOQ3HPBgl1voHok7XVw.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">在Microsoft Office上导入CSV文件</figcaption></figure><h1 id="828b" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">减轻</h1><p id="903a" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">这种攻击很容易缓解和补救，在生成CSV文件时，请确保没有任何单元格以下列字符开头:</p><ul class=""><li id="b913" class="lv lw iq kz b la lx le ly li lz lm ma lq mb lu mc md me mf bi translated">等于(" = ")</li><li id="b0d9" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">加号(“+”)</li><li id="8bcc" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">减号(“-”)</li><li id="e3d3" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">在(“@”)</li></ul><h1 id="2632" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">易受攻击代码</h1><p id="5880" class="pw-post-body-paragraph kx ky iq kz b la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu ij bi translated">来自<strong class="kz ir">的函数<strong class="kz ir"> do_export() </strong>不检查字段是否以<strong class="kz ir"> (=，+，-，@) </strong>字符开头。</strong></p><h1 id="141a" class="jz ka iq bd kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw bi translated">时间表</h1><ul class=""><li id="69ff" class="lv lw iq kz b la lb le lf li mo lm mp lq mq lu mc md me mf bi translated">2019年8月15日-👨‍💻发现</li><li id="be72" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">2019年8月15日-👨‍💻向Webtoffee支持部门报告</li><li id="e1ec" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">2019年8月16日-👨‍💼更多信息请求</li><li id="ae0c" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">2019年8月16日-👨‍💻详细的漏洞报告</li><li id="389d" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">2019年8月19日-👨‍💼无法识别的漏洞</li><li id="c848" class="lv lw iq kz b la mg le mh li mi lm mj lq mk lu mc md me mf bi translated">2019年8月22日-👨‍💻公开披露</li></ul><p id="1501" class="pw-post-body-paragraph kx ky iq kz b la lx lc ld le ly lg lh li ml lk ll lm mm lo lp lq mn ls lt lu ij bi translated"><strong class="kz ir">西班牙语版</strong></p><div class="nc nd gp gr ne nf"><a href="https://hackpuntes.com/cve-2019-15092-wordpress-plugin-import-export-users-1-3-0-csv-injection/" rel="noopener  ugc nofollow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">CVE-2019-15092 WordPress插件导入导出用户= 1.3.0 - CSV注入-黑客攻击</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">CVE公共图书馆-2018-15571 en El plugin para WordPress Import Export Users = 1 . 3 . 0 permite eje cución de…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">hackpuntes.com</p></div></div><div class="no l"><div class="np l nq nr ns no nt js nf"/></div></div></a></div></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="1777" class="pw-post-body-paragraph kx ky iq kz b la lx lc ld le ly lg lh li ml lk ll lm mm lo lp lq mn ls lt lu ij bi translated"><em class="ob">关注</em> <a class="ae jy" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ob"> Infosec报道</em> </a> <em class="ob">获取更多此类精彩报道。</em></p><div class="nc nd gp gr ne nf"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ng ab fo"><div class="nh ab ni cl cj nj"><h2 class="bd ir gy z fp nk fr fs nl fu fw ip bi translated">信息安全报道</h2><div class="nm l"><h3 class="bd b gy z fp nk fr fs nl fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nn l"><p class="bd b dl z fp nk fr fs nl fu fw dk translated">medium.com</p></div></div><div class="no l"><div class="oc l nq nr ns no nt js nf"/></div></div></a></div></div></div>    
</body>
</html>