<html>
<head>
<title>Importance of burp history analysis to bypass 403</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打嗝历史分析对旁路403的重要性</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/importance-of-burp-history-analysis-to-bypass-403-afc7af6c08b?source=collection_archive---------4-----------------------#2021-06-15">https://infosecwriteups.com/importance-of-burp-history-analysis-to-bypass-403-afc7af6c08b?source=collection_archive---------4-----------------------#2021-06-15</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4100" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">或者，我是如何知道特定的Referer header可以产生很大的不同</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/3c233168c5db36106da79db637dcf94d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QfijqU8HU-6yDFSNFF9ucw.png"/></div></div></figure><p id="70bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">当谈到bug狩猎时，目录暴力是必要的一部分，如果你想涵盖所有的基础。有时，根据bug bounty程序的政策，或者仅仅是服务器的配置，像captcha或429这样的事情，或者只是完全阻止你的ip会发生。有很多方法可以解决，但这不是重点。这是关于检查结果，看到有趣的端点被标记为403，并且未能使用通常的技术(如Host、x-forwarded-host、x-forwarded-for等头)绕过它。)，然后呢？是时候向前看了。</p><p id="02c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Referer header，以及更广为人知的bypass <br/> </strong>现在，也许你们中的一些人知道某些端点不接受没有Referer header的请求。通常的情况是端点在哪里，例如:<br/>【https://admin.target.com/interestingendpoint.php】T4</p><p id="3dde" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">除非Referer是匹配的子域或至少基本域，它将导致403或404或重定向。但是，有时，这些价值观也会失效。输入burp或任何其他方式来分析在浏览有问题的网站时发生了什么请求和响应。</p><p id="9135" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu"> Referer header，以及鲜为人知的bypass <br/> </strong>这纯属偶然。我完成了看起来很有趣的特定子域的ffuf。一无所获，于是我转向其他子域。这是一个大范围的bug赏金计划，所以我有很多其他的目标可以玩。在我忙碌的过程中，我还关注了burp的历史，试图找出各种端点与其他端点之间的关系，因为这是一个大范围的目标，所以我还关注了跨子域的交互。然后，我注意到一个熟悉的子域，它的一个端点响应为200 OK。这促使我更深入地研究它的原因是，问题中的端点是ffuf单词表的一部分。为了验证我的困惑，我对整个位置进行了简单的复制/粘贴，得到了403。Wtf？</p><p id="ec67" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">分析</strong> <br/>很自然的，我只是把打嗝历史的请求发送给了复读机，点了发送，得到了200 OK。所以，这不是侥幸。下一步是删除用户代理，我仍然得到了200 OK。所以，我尝试删除引用，并得到403禁止。好的。进步…算是吧。关于Referer头有趣的事情是，它有一个不同于端点的子域(即。不是https://targetsubdomain.target.com的T3，而是https://othersubdomain.target.com的T5和T6。我删除了子域名，估计可能只是检查基本域名部分(即https://target.com)。还有……403禁止入内。所以，我试着把端点的子域(即。https://target subdomain . target . com)，还有……403又禁了。不管出于什么原因，只有一个特定的子域允许请求通过，200 OK是响应。显然，我编辑了请求标题，将Referer改为这个“特殊”的子域(即https://other subdomain . target . com)，得到了预期的200 OK。</p><pre class="kp kq kr ks gt lb lc ld le aw lf bi"><span id="3bc9" class="lg lh it lc b gy li lj l lk ll"><strong class="lc iu">The adjusted ffuf<br/></strong>&gt;ffuf -c -w words.txt -H “Referer: othersubdomain.target.com”  <a class="ae la" href="https://somethingelse.target.com/FUZZ" rel="noopener ugc nofollow" target="_blank">https://somethingelse.target.com/FUZZ</a></span></pre></div><div class="ab cl lm ln hx lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="im in io ip iq"><p id="2d00" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它只是告诉你，即使像被动侦察这样的事情也可能需要一些主动侦察，以避免假阴性。所以，下次当你有一个大范围的目标，并且它的一个子域有一个返回403的有趣的端点，并且没有一个通常的旁路工作时，试着弄乱Referer头，但是不要忘记把它和burp历史分析结合起来。</p></div></div>    
</body>
</html>