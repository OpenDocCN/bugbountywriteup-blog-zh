<html>
<head>
<title>#BugBounty — API keys leakage, Source code disclosure in India’s largest e-commerce health care company.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated"># bug bounty——印度最大的电商医疗保健公司API密匙泄露，源代码泄露。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-api-keys-leakage-source-code-disclosure-in-indias-largest-e-commerce-health-care-c75967392c7e?source=collection_archive---------0-----------------------#2018-02-25">https://infosecwriteups.com/bugbounty-api-keys-leakage-source-code-disclosure-in-indias-largest-e-commerce-health-care-c75967392c7e?source=collection_archive---------0-----------------------#2018-02-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="60e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="c9ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到一个长期悬而未决的漏洞，我发现在我的bug赏金猎人，虽然一个迟到的博客，但我发现它值得分享。我在印度最大的在线健康平台网站<strong class="jp ir"> <em class="kl">发现了这个漏洞。</em>T3】</strong></p><blockquote class="km kn ko"><p id="e650" class="jn jo kl jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">通过这个漏洞，我能够读取应用程序的源代码、敏感文件，如webconfig，在那里我获得了邮件服务器、sms、支付网关等的API密钥，此外，我还能够使用这些邮件服务器密钥从他们的企业邮件服务器发送邮件，甚至能够使用sms密钥向他们的客户发送sms。让我们看看我是如何做到的—</p></blockquote><p id="8102" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用于发现此漏洞的技术是路径遍历攻击。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/aed4fcc8c732eade4127677e0c222dc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*x0WtQsi5q7le1Dq-2aAb0w.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">易受攻击的URL</figcaption></figure><p id="1edf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我是在上面截图显示的URL和参数中发现这个漏洞的。</p><p id="c64c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述URL HTTP请求的响应如下-</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi le"><img src="../Images/cbebb60b91ff30145b51f4611e1a7e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*GaeX7A7rbna7HoAth3zQQQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">易受攻击的请求响应</figcaption></figure><p id="70cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你看上面的截图，你会看到HTTP头“服务器”。由此我分析出微软-IIS web服务器正在使用中。所以我试着打开WIN。路径遍历攻击。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/141ae624add809d26c5177b007393a6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*dpRRoQ9ybLk1hVXgyDhOKg.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">路径遍历atatck</figcaption></figure><p id="f7ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得到了如下的回应-</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi le"><img src="../Images/3e0f68bdb98202a4383e700ec9fab8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*aeh076e0259yBpJLNC-ufA.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">HTTP响应</figcaption></figure><p id="da3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是WIN的内容。INI文件。因此，我确认存在本地文件包含漏洞。所以我尝试升级这个漏洞，并继续阅读一些应用程序的源代码—</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/346e8c7087ff5f2f1e8f0fbf3dcb7ca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*tqQ9-VhGMghNQmcH6xd9hw.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">登录页面源代码请求</figcaption></figure><p id="5550" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我知道这是一个IIS服务器，所以我很清楚应用程序目录看起来像什么，我试着阅读登录页面的源代码，正如我所料，我得到了下面的响应—</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi le"><img src="../Images/7286d5263de45b5cc84229892cde5f3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*hcKrrF4IeKQhg1xVV4la6g.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">登录页面源代码</figcaption></figure><p id="8d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">同样，我能够下载任何页面的应用程序的完整源代码。现在到了关键的方面，web.config文件如下-</strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/d4073b542b42dd21444d5e8d756c1d16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*Pno1zwKtmtp86JbSu6irNQ.png"/></div><figcaption class="la lb gj gh gi lc ld bd b be z dk translated">Web配置文件包含</figcaption></figure><p id="0359" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我看到上述请求的回复时，:D脸上露出了灿烂的笑容</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/b6139f9fc90ef4620ead0f9b851ab64e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*WVCXMXIZWohRHMOVqV59Yg.png"/></div></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/4b1d2a0921fec7edda06d957ab355956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vs41kF_j6AW_YKhMBZ8wUQ.png"/></div></div></figure><p id="9bd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">所有敏感的APIs key都暴露了！-邮件服务器API密钥、IIS服务器管理凭证、SMS API密钥、支付网关密钥，这是非常重要的。我可以用这些键来发送邮件，给用户发送短信，支付操作等等。</em>T9】</strong></p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="36d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">报告详细信息- </em></p><p id="c980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2016年6月19日—向相关公司报告了错误。</p><p id="ffae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2016年7月11日—错误被标记为已修复。</p><p id="4571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2016年7月11日—重新测试并确认了修复。</p><p id="851e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2016年8月1日—由公司授予。</p><p id="9677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(<a class="ae lr" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)</p></div></div>    
</body>
</html>