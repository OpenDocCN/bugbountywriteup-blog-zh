<html>
<head>
<title>Interesting case of SQLi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有趣的SQLi案例</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/interesting-case-of-sqli-84cc3f4a5255?source=collection_archive---------1-----------------------#2020-11-12">https://infosecwriteups.com/interesting-case-of-sqli-84cc3f4a5255?source=collection_archive---------1-----------------------#2020-11-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="36f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，各位，今年没有时间写我的发现。但是这一次，我发现大约2-3个月前，这是一个有趣的情况，因为它现在已经修复，我要写一点。</p><p id="f513" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在一个Synack程序中发现了一个有趣的SQLi案例。</p><p id="f2d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为只允许未经认证的测试，所以我从目录和文件暴力开始，但是应用程序不断将我重定向到每个目录和文件暴力的登录页面，并将我重定向到门户页面，因此产生了一个循环。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/77bf758b59cef0f59a51b953a964d2c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oz9ICot0SEGZWXlA00zUfA.jpeg"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/93138d6fc309a47a636e2e4e6db3c4a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QWPavVaXyuSQnbJVCHyKYA.png"/></div></div></figure><p id="23a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图改变方法，看看是否有某个特定的方法受到限制。但是结果一样。</p><p id="85c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我注意到应用程序正在使用第三方解决方案。我谷歌了一下，发现这是一个托管的电子发票解决方案。我想，从这里开始，让我们检索应用程序路径，并再次尝试使用这些路径进行暴力破解。</p><p id="56fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我检查了一下，看是否能得到一份拷贝。不，不行，因为我们会根据您的要求提供演示</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/b0e854bdcfe2ad96743eca44761dd716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/format:webp/1*b8Pk5eneZH79AkUdhB4wUA.png"/></div></figure><p id="cd93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不想浪费时间去申请一个演示版本，这也是一个繁琐的过程(填写表格，与销售人员交谈，提出要求等等)。我在GitHub等网站上搜索，想看看是否有该应用程序的演示版本，但什么也没找到。我只是在他们的频道上有一个应用程序演示的youtube视频，没有其他的。从视频中，我只能透露他们所有客户和少数rxs的发票细节，但我的动机是SQLi。从这里，我还知道重定向只发生在/portal/下目录中，这看起来像是应用程序的核心部分。</p><p id="0292" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定检查应用程序的子域，看看我是否能在它们自己的一个子域上得到任何演示版本。我主要使用子查找器来发现子域，所以我运行了一个快速扫描。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/a7f1b6f0f0c6565840e979071c7a6f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:200/format:webp/1*XytC2amI61Ud5VOTux7w5g.png"/></div></figure><p id="15b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">酷，我有很多运行演示实例的子域。好消息是他们甚至没有密码保护。但这也有点奇怪，因为所有的演示实例都没有认证，并且属于一个客户端的其他子域的行为和我得到的一样(登录时重定向循环)。我开始疑惑，如果根本没有认证呢？从他们在youtube上的演示视频来看，客户不需要登录应用程序，一些非常具体的链接就会生成并发送到他们的电子邮件中，通过点击它，他们可以查看所有与发票相关的信息，甚至可以直接付款。</p><p id="f574" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我改变了我的计划，而不是应用程序路径，我从演示实例中捕获所有post请求，并将域替换为范围内的应用程序域，然后重放它。令我惊讶的是，它没有重定向循环。</p><p id="8936" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">酷，接下来我检查了一个参数的SQLi，不出所料，它也很脆弱。我迅速运行sqlmap，获得了所有数据</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi la"><img src="../Images/1c2fe7435e3ce19ed5267e60c015f689.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*GILQwkxJ8b-QUm4JMh4vfw.png"/></div></figure><p id="f56c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我报了名，几个小时后就被接受了。如果不涉及blitz，Synack最多可以为SQLi支付3000美元。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/3ab0ef06fd72407966253c9f04a04ad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*O8DRmZxctVHWSW2tj0BL9w.png"/></div></figure><p id="d139" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呆在家里，保持安全，保持好奇！</p></div></div>    
</body>
</html>