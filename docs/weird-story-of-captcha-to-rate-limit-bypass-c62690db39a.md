# 奇怪的故事验证码的速率限制旁路

> 原文：<https://infosecwriteups.com/weird-story-of-captcha-to-rate-limit-bypass-c62690db39a?source=collection_archive---------1----------------------->

![](img/d9994eae90fc424d572d788d59268f28.png)

当应用程序没有实现一种机制来限制在 X 时间量内触发的**封电子邮件和消息的数量时，这个问题通常被认为是速率限制。然而，速率限制不仅仅如此，根据业务逻辑，可能会有多种情况，如 **X 评论/消息/邀请的数量或 Y 时间内的创建/删除操作。****

另一方面，验证码被认为是一种保护机制，可以**减缓攻击者&在自动触发执行速率限制攻击的请求的过程中创建一个拦截器。**

嘿，黑客们，在这篇博客中，我将写一个最近发生的奇怪的场景，我不小心绕过了验证码来执行限速。

# **简单地说，故事是:**

1.  忘记了密码，填写了验证码和详细信息
2.  使用 Burp 代理捕获的请求。
3.  **既没有关闭拦截，也没有转发请求。**
4.  向**入侵者**发送请求，并使用空有效载荷播放了 300 次。
5.  成功！！
6.  验证码机制正在验证初始请求，该请求在验证码过期之前由代理保留。

我正在开发的应用程序来自一个私人项目，为了保持不泄露策略，让我们将目标命名为**target.com**

几乎所有的漏洞都在范围之内，所以我开始寻找 XSS、伊多斯等，并在第一天就与他们交了好运。第二天当我再次启动时，我忘记了我设置的密码:p 所以我去“忘记密码”功能重置我的密码。注意到应用程序正在实现一个验证码来限制自动化。太酷了，让我们尽情享受吧。

我开始通过提供有效的**验证码答案来捕获请求，并试图重复请求*，但失败了。*** 此外，我继续尝试删除验证码参数，仍然没有成功。

接下来我做的事其实是无意的。我捕获了一个新的请求，并将其发送到 Repeater 并重复它。成功了！怎么会？以前它对我不起作用:/ 我注意到我忘记关闭拦截器并转发请求。我直接关掉了拦截器。令我惊讶的是，一个电子邮件通知弹出，收到两个密码重置电子邮件！事情有些可疑。

我捕获了另一个新的请求，并用代理将它保留下来并发送给入侵者。我用空有效载荷播放了大约 200 次请求。

我收到了 200 封邮件。:D 验证码和速率限制被绕过；)

**#为什么会这样？**

根据我对该应用程序的理解，该应用程序正在实施一些“未知/本地验证码”，这实际上是在使“验证码”过期之前验证**原始请求(被代理搁置)是否正确。**这会导致攻击者保留原始请求并绕过“忘记密码”的速率限制，从而**在几分钟内触发 N 封邮件**

**外卖**

*   将新旁路添加到限速旁路列表中
*   总是试图篡改本地实现的保护机制。他们更容易受到伤害。