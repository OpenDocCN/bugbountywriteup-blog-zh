# 吹牛的权利:杀死文件上传软

> 原文：<https://infosecwriteups.com/bragging-rights-killing-file-uploads-softly-fba35a4e485a?source=collection_archive---------0----------------------->

![](img/94f8f1ea129eb9d3711216604d62c558.png)

嗨，朋友们，我希望你们都做得很好，并且经常上网。我从一个月左右开始在 Synack 上做黑客，我必须说这是一个很棒的旅程。最近几天，我在文件上传功能上下了很多功夫，在这篇文章中，我将讨论一些最近的无限制文件上传的发现。我希望这能在某种程度上帮助你。让我们继续前进。

如果您对文件上传功能不熟悉或不熟悉，以下资源将帮助您更好地理解这一点: [***文件上传***](https://portswigger.net/kb/issues/00500980_file-upload-functionality) ***。***

所以，在一个周末，我想给一整天的时间来上传文件，并搜索了 Synack 上所有可以上传文件的程序。我得到了 4-5 个程序，并决定全部检查。在 2 个程序中，文件上传已经被报告了，所以我不能继续了。剩下的两个目标是相当新的，你可以称之为我的运气，因为没有人报告任何类似文件上传的事情。我开始玩这些功能，看看我们能不能用它做些奇怪的事情。这个网站只接受 PDF，所以我试着用传统的方式用 burp 上传 php 文件，但是不行:(它不接受除 PDF 之外的任何东西。

旁路来了！感谢已经有的文章和博客。起初，我试图上传一个文件，把它的名字改成 XSS 的有效载荷。傻，没用。等等，如果我们可以使用一个带有 PDF 扩展名的 SVG 文件呢？这有用吗？如果我们继续向前，在扩展中添加一个空字节会怎么样？嗯，这实际上是可行的:)想看看完整的扩展吗？这是:

**提示。SVG%00.pdf**

因此，应用程序接受文件，上传后，任何人都可以下载你上传的东西。他们一打开文件，XSS 就出现了。这花了一些时间，但支付是值得的。

第二种情况是非常相同的，我们可以上传我们的收据，管理员会批准它。我用了同样的方法，但不知何故它不起作用。我回到谷歌，搜索了更多可以绕过限制的资源。然而，我观察到，我们可以上传带有恶意内容的 PDF 接收，当有人打开报告时，有效负载就会执行。感谢 **Payloadallthethings :)** 以下是全部内容:

% PDF-1.3
% 1 0 obj
<</Pages 2 0 R/Type/Catalog>>
endobj
2 0 obj
<</Count 1/Kids【3 0 R】/Type/Pages>>
endobj
3 0 obj
</AA
<</O【T10
}
)
/S/JavaScript>>>>
/Annots[]/Contents 4 0 R/media box[0 612 792]/Parent 2 0 R
/Resources
<</Font<</F1<</base Font/Helvetica/Subtype/Type 1/Type/Font>

BT
/F1 24 Tf
ET
endstream
endobj
xref
0 5
0000000000065535 f
0000000015 000000n
00000000062 00000n
0000000117 00000n【T38

<root><</root>>
start xref
493
% % EOF

管理员一打开报告，就会看到一个弹出窗口。嗯，你需要检查受害者是否必须在他的系统上下载它，如果它发生了，它就没有意义。在我的例子中，它是在同一个目标的一个新选项卡上执行的，被认为是一个有效的 bug。

![](img/37214e166e1d5f5cccae0d189dd02185.png)

这些并不是不可思议的发现，但多走几英里去换个角度思考总是有意义的。有时你知道如何利用这些东西，有时你不知道。谷歌来了，它会帮你做任何事情，帮你发现新事物。文件上传非常简单，只需要一种不同的方法。在它的帮助下，我仍然在寻找一个 webshell:(然而，在找到这两个 bug 后，我感觉棒极了，我相信这篇小文章有助于你打造自己的方法。

这将是这一次，我希望你从这次阅读中有所收获。如果你喜欢它，你可以点击下面的拍手图标来感谢我:)建议一如既往地受到欢迎，如果你对奖金/黑客有任何问题/建议，我邀请你到我的 twitter DM。我会尽力帮你的:)你可以用这个用户名找到我的 twitter 句柄: **@manasH4rsh。**

保持好奇，保持饥渴！黑客快乐:)

再见，❤