<html>
<head>
<title>Building an open-source SIEM: combining ELK, Wazuh HIDS and Elastalert for optimal performance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建开源SIEM:结合ELK、Wazuh HIDS和Elastalert实现最佳性能</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/building-a-siem-combining-elk-wazuh-hids-and-elastalert-for-optimal-performance-f1706c2b73c6?source=collection_archive---------0-----------------------#2020-08-25">https://infosecwriteups.com/building-a-siem-combining-elk-wazuh-hids-and-elastalert-for-optimal-performance-f1706c2b73c6?source=collection_archive---------0-----------------------#2020-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="88b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在构建SIEM时，您需要决定的第一件事是您要选择的分布式体系结构。这意味着分析可用的资源，以及您的SOC的需求。</p><ul class=""><li id="a6a5" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">您是在监控100、1000还是10000台主机？</li><li id="d7f2" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">你有购买商业工具的预算吗？</li><li id="f339" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">您的基础架构的异构程度如何？</li><li id="c941" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">您只是在寻找安全警报，还是也需要用于审计目的的持久事件日志记录？</li><li id="a73d" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">您希望实现什么类型的粒度？</li><li id="ed0b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">您希望实现什么样的响应时间？您需要实时通知吗？</li><li id="dd84" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">您是否有时间改进/调整您的解决方案，或者您是否需要一些能够尽快100%工作的东西？</li></ul><p id="82da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是你需要问自己的一些问题。在我们的特殊例子中，我们需要为一个大约20K台主机的网络设置一个SIEM。我们没有购买商业工具或许可证的预算。出于审计目的，我们需要持久的日志记录。这包括记录在我们的基础设施中执行的每个命令，同时监控恶意命令。为了编写自定义规则，我们还需要低层次的粒度。基本上，我们想要一款顶级的SOC，而不需要花钱。但这是不可能的。</p><blockquote class="kz la lb"><p id="43c6" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated">作为经理，你应该明白的第一件事是没有免费的东西。如果你选择开源，你可能不需要支付许可费，但是你会花钱组建一个团队，这个团队可以有效地:</p><p id="efe8" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated">1)根据您需求调整开源解决方案，无需支付支持费用。</p><p id="1c0c" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated">2)如果你想有所回报，就为开源项目做贡献。</p></blockquote><p id="33c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">你要么付钱给有才华的员工，要么付钱给封闭源码+支持。</strong>这是不可避免的。就我而言，我很幸运能够与一个由安全工程师和soc分析师组成的优秀团队合作，他们能够共同努力实现我在开始时详述的所有目标。</p><p id="b338" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会问这有什么关系？嗯，我们采取的架构决策可能不符合您的需求。你可能需要一些快速且能完成工作的东西。你可能没有一个喜欢弄脏自己的团队。在这种情况下，像Splunk(【https://www.splunk.com/】)这样的东西可能最适合你。这将是昂贵的，尤其是如果你有一个相当大的基础设施来监控，但这将是更容易实现比我们所做的。</p><p id="8290" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">描述了我们最初的情况后，让我们继续前进。查看常见的SIEM架构，最常见的开源架构涉及ELK +类似Elastalert的东西。在我之前的文章中，我已经谈到了如何将麋鹿用于伐木目的。</p><p id="de23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种架构通常在每台受监控的主机上运行某种类型的日志/事件转发(类似于filebeat ),它将数据发送到Logstash ingestor，后者解析数据、丰富数据并将其发送到非关系数据库(在本例中为Elastic ),然后可以通过仪表板(Kibana)对其进行查询和可视化。它看起来会像这样。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/3d1d2e89219fdec66afbb01ce86148b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*xpsJ8isuwcGjf_M28ZLy6A.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">SIEMS架构的第一次迭代</figcaption></figure><p id="0cbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，这个设计有一个明显的缺陷。它100%是手工制作的。SOC分析师必须手动查询和分析数据来检测线程。你应该尽可能地让每个过程自动化。</p><p id="488c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这还有另一个问题。你不会留下任何发现/相关事件的记录。至少不是自动的。</p><p id="f092" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要解决这两个问题，您需要添加某种警报/通知系统来保存信息。这可以通过Elastalert(<a class="ae lg" href="https://github.com/Yelp/elastalert" rel="noopener ugc nofollow" target="_blank">https://github.com/Yelp/elastalert</a>)来实现。这是一个python开发的框架，它查询Elasticsearch并在警报触发时通知您。</p><p id="7c2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们选择两种通知方法。第一种是通过一个松弛的频道来发布更紧急的警报。第二种是通过收件箱留下记录。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/e32330888a82a90bc6ff0afba836bba6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*MES0oy-i2gazG-Pettu-ZA.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">我们SIEM架构的第二次迭代</figcaption></figure><p id="e23b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Elastalert通知您特定的事件查询，但是它查询哪些事件呢？你必须定义这些。为此，我们将使用西格玛规则项目(<a class="ae lg" href="https://github.com/Neo23x0/sigma" rel="noopener ugc nofollow" target="_blank">https://github.com/Neo23x0/sigma</a>)。适马是一种标准的规则格式，允许您定义可以转换为多种格式的查询，如Kibana的KQL、Splunk、Arcsight、Qualys，当然还有Elastalert(等等)。引用它的创造者的话<a class="lt lu ep" href="https://medium.com/u/2fdc032a69b3?source=post_page-----f1706c2b73c6--------------------------------" rel="noopener" target="_blank">弗洛里安·罗斯</a></p><blockquote class="kz la lb"><p id="3071" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated">适马用于日志文件，就像Snort用于网络流量，YARA用于文件。</p></blockquote><p id="2c4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在克隆存储库之后，您可以使用David Routin提供的python脚本<code class="fe lv lw lx ly b">sigma2elastalert.py</code>将规则转换成elastalert格式。</p><p id="5b8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您有了一个可以独立于操作系统的架构，并且具有用于检测恶意事件的社区开源规则。但是问题跟踪呢？好吧，Slack和Gmail都不擅长这个。幸运的是，您可以将吉拉与Elastalert集成在一起，自动创建对您可能发现的问题的跟进。你在这里有一个逐步实现:<a class="ae lg" href="https://qbox.io/blog/jira-alerting-elasticsearch-elastalert-tutorial" rel="noopener ugc nofollow" target="_blank">https://qbox . io/blog/jira-alerting-elastic search-elastalert-tutorial</a></p><p id="f16a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用新增加的内容来更新图表。</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/608cee4843403dd6f13d1a52fe0c4673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*Sts2OaXHnPfAOi8uSg1-Qw.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">我们SIEM架构的第三次迭代</figcaption></figure><p id="f9d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经满足了所有的基本需求，我们可以开始优化我们的实现了。到目前为止，我们提出的解决方案是HELK平台的精简版，由<a class="lt lu ep" href="https://medium.com/u/996cb7f12ac1?source=post_page-----f1706c2b73c6--------------------------------" rel="noopener" target="_blank"> Roberto Rodriguez </a>创建(https://github . com/cyb 3 rward 0g/HELK)。对于那些不知道的人，去看看吧，太棒了。它不仅涵盖了我们迄今为止所做的工作，还包含了通过Apache Spark、Hadoop、GraphFrames和Jupiter笔记本电脑实现的分布式处理和机器学习功能。我们实际上并不需要这些功能，但是您的用例可能会有所不同。</p><p id="5916" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管我们架构的第三次迭代确实有一些问题。虽然它确实允许我们在搜索某些事件时获得更高的粒度，但这是以牺牲性能为代价的。像ElasticSearch这样的非关系数据库确实很快，但是请记住我们的首要要求之一:出于听觉目的的日志记录和命令监控。现在，让我们做一些数学计算。您有大约20K台服务器和一个低级别的审计策略，它基本上记录了每个execve syscall的运行。你已经在<a class="ae lg" href="https://medium.com/@securityshenaningans/building-a-siem-centralized-logging-of-all-linux-commands-with-elk-auditd-3f2e70503933" rel="noopener">上看到了我的第一篇文章</a>中的详细审计输出，即使假设你去掉了大部分输出，只保留时间和调用的命令，也需要查询很多信息。西格玛规则库有大约350条规则。假设您监控大约200个恶意命令/字符串(在Unix和Windows规则之间),并且您定义了大约100个其他定制规则，特别是针对您的平台。总共有650条规则。</p><p id="af5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您的每个服务器每10秒记录一次系统调用(这已经很慷慨了)，那么您每秒将有650 x20000/10 =<strong class="jp ir">130万次检查。</strong> <br/>当然，这并不是100%准确，因为你有几个东西可能会优化你的查找时间，如<a class="ae lg" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/query-cache.html" rel="noopener ugc nofollow" target="_blank">缓存查询</a>，但仍然，这个粗略的数字超出了我们的基础设施预算。它也有通知延迟的缺点。您可以增加查询间隔，并减少负载，但稍后会通知您。这就是权衡。我们正在寻找实时警报。我们需要找到另一种选择。</p><p id="2e1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">进入瓦祖赫。Wazuh是一个开源的主机入侵检测系统(HIDS)，可以减轻你的处理负荷(<a class="ae lg" href="https://wazuh.com/" rel="noopener ugc nofollow" target="_blank">https://wazuh.com/</a>)。Wazuh可以通过多种方式实现，但最常用的方式是在每个节点中有一个Wazuh代理，然后有几个Wazuh管理器接收事件。每个Wazuh代理监控安装它的主机上的几个事件，但它也可以充当日志转发器，取代filebeat。它将有关主机的信息转发给每个代理，代理将处理该信息，并仅将您需要的警报转发给SIEM。<br/> Wazuh管理器可以支持多个连接，并帮助减少大约80%的信息处理。这是因为它的规则处理器利用了用c编写的特定解码器。该解码器以非常快的方式解析警报字段，然后以树状结构匹配每个规则(<a class="ae lg" href="https://documentation.wazuh.com/3.13/user-manual/ruleset/ruleset-xml-syntax/rules.html" rel="noopener ugc nofollow" target="_blank">https://documentation . wazuh . com/3.7/user-manual/ruleset/ruleset-XML-syntax/rules . html</a>)。</p><p id="b711" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Wazuh通过定义与特定事件相匹配的规则来工作，所以您可能会看到类似这样的内容(不要使用这些规则，这些规则已被修改以用于简化目的):</p><p id="dabc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">规则1:检测分组的ssh消息</p><pre class="li lj lk ll gt lz ly ma mb aw mc bi"><span id="6f24" class="md me iq ly b gy mf mg l mh mi">&lt;rule id="1" level="0" noalert="1"&gt;<br/> &lt;decoded_as&gt;sshd&lt;/decoded_as&gt;<br/> &lt;description&gt;SSHD messages grouped.&lt;/description&gt;<br/> &lt;/rule&gt;</span></pre><p id="6c39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">规则2:检测失败的登录</p><pre class="li lj lk ll gt lz ly ma mb aw mc bi"><span id="b443" class="md me iq ly b gy mf mg l mh mi">&lt;rule id="2" level="5"&gt;<br/> &lt;if_sid&gt;1&lt;/if_sid&gt;<br/> &lt;match&gt;illegal user|invalid user&lt;/match&gt;<br/> &lt;description&gt;sshd: Attempt to login using a non-existent user&lt;/description&gt;<br/> &lt;/rule&gt;</span></pre><p id="a113" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">规则3:在定义的时间段内检测多个规则2(暴力)</p><pre class="li lj lk ll gt lz ly ma mb aw mc bi"><span id="f702" class="md me iq ly b gy mf mg l mh mi">&lt;rule id="3" level="10" frequency="8" timeframe="120" ignore="60"&gt;<br/> &lt;if_matched_sid&gt;2&lt;/if_matched_sid&gt;<br/> &lt;description&gt;sshd: brute force trying to get access to the system.&lt;/description&gt;<br/> &lt;same_source_ip /&gt;<br/> &lt;/rule&gt;</span></pre><p id="a6f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种树状规则结构有两个主要问题:</p><ol class=""><li id="f988" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mj kr ks kt bi translated">很快就会变得难以维持。一些规则可能首先与您不期望的其他规则匹配，或者如果您没有提前计划，您可能最终会得到杂乱无章的代码。</li><li id="3fc7" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">粒度级别由规则预处理器决定。当然，您可以进行正则表达式匹配，但这并不容易让您关联不同的匹配规则。</li></ol><p id="293b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，对于Wazuh，我们不需要粒度或详细的事件。我们追求速度。这意味着您可以使用:</p><ol class=""><li id="1acb" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mj kr ks kt bi translated">Wazuh以真正快速的方式匹配最简单的规则(想想恶意命令、未授权登录或勒索软件加密警报的字符串匹配等基本内容)</li><li id="9576" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">针对不需要实时通知的特定用例的Elastalert和sigma规则(例如每5分钟查询一次的特定恶意软件组检测规则)。</li></ol><p id="498e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将Elastalert和Wazuh结合使用，您可以平衡处理负载，两全其美。</p><p id="2bb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们的架构看起来会像这样:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/2f93ef91ac12450e228e2bd991abfd86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgtteOQN5qmz2oUcaYVvpA.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">经济高效的SIEM的最终体系结构</figcaption></figure><p id="7aad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们最终的架构实现了我们最初打算的所有目标。然而，<strong class="jp ir">它的缺点是维护起来困难两倍</strong>，因为您现在必须调优和监控两个不同的规则集，一个是针对Wazuh的快速规则集，另一个是针对Elastalert的缓慢但更详细的规则集。<br/>你需要考虑的最后一些事情(这可以被认为是一般的架构规则):</p><ul class=""><li id="9682" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">设计时总是考虑到事情会失败。在我们的例子中，我们最终在4个不同的环境中使用了14个Wazuh管理器(原生Windows AD、原生Unix、原生云和AWS Cloud)。10个用于主机，4个用于故障切换(每个区域一个)</li><li id="ef29" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">从代理接收连接时平衡流量。您可以使用类似Nginx的东西，甚至可以使用DNS平衡器，但总是通过您的管理器平均分配连接。如果您推送一个需要重启的配置更改，当没有正确分发时，所有代理都可以很容易地DDOS管理器。</li><li id="6dd8" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">分析网络开销。不要使用美国基础设施中的管理器接收来自欧盟代理的连接。这不仅会增加延迟时间(特别是如果你使用VPN)，而且在处理跨AZ AWS流量时可能会产生额外的成本。</li><li id="1bb7" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">确保监控Wazuh代理服务的启动和停止，并限制单个实例可以创建的日志数量，以防止通过垃圾日志发起DOS攻击。</li><li id="baaf" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">进行频繁的红队演习，以验证您的警报工作正常。你可以用Mitre的Att&amp;ck框架来映射单元测试(<a class="ae lg" href="https://attack.mitre.org/" rel="noopener ugc nofollow" target="_blank">https://attack.mitre.org/</a>)以及类似Red Canary的原子测试(<a class="ae lg" href="https://github.com/redcanaryco/atomic-red-team" rel="noopener ugc nofollow" target="_blank">https://github.com/redcanaryco/atomic-red-team</a>)来自动化这个过程。</li><li id="7a0f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">适马和瓦祖赫规则经常更新。一定要保持更新。</li><li id="5345" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">扩展您的规则集。不要只依赖社区的书面规则。有时你会发现错误，不得不手动修改它们。其他时候，您可能希望合并以顺序格式编写的规则/用于其他索引结构。</li></ul><p id="42ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想练习规则翻译，我可以推荐Teymur Kheirhabarov的两篇精彩演讲。</p><ul class=""><li id="bfd2" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">"<a class="ae lg" href="https://www.slideshare.net/heirhabarov/hunting-for-credentials-dumping-in-windows-environment" rel="noopener ugc nofollow" target="_blank">在windows环境中搜寻凭据转储</a>"</li><li id="7587" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">"<a class="ae lg" href="https://www.slideshare.net/votadlos/hunting-lateral-movement-in-windows-infrastructure" rel="noopener ugc nofollow" target="_blank">寻找windows基础架构中的横向移动</a>"</li></ul><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mp"><img src="../Images/6e292f72070a8196554963be0edc3d30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tzx8WVNv42aLxEzMFsliXw.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">这个例子说明了这些规则可以变得多么精细(这个例子通过卷影副本识别凭证转储)</figcaption></figure><p id="9c36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实上，我们最终翻译了这些会谈中的许多规则，以监控我们公司特定的用例。</p><p id="64b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与所有事情一样，该体系结构需要大量调整才能完成，但是您将拥有一个可靠的SIEM，它将允许您:</p><ol class=""><li id="f4a5" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk mj kr ks kt bi translated">监控来自不同环境/操作系统的数千台主机。</li><li id="6368" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">接收实时警报。</li><li id="bda6" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">实现开源规则以及编写您自己的自定义规则</li><li id="d2d6" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">出于安全和审计目的，自动检测、跟踪和记录威胁。</li><li id="29a6" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk mj kr ks kt bi translated">不为一个许可证付费。</li></ol><p id="4db3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">记住，</p><blockquote class="kz la lb"><p id="8cb6" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">没有完美的午睡，只有完全符合你需求的午睡</strong>。</p></blockquote></div></div>    
</body>
</html>