<html>
<head>
<title>Email and Phone Number Verification Bypass Worth $$$</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">价值$$$的电子邮件和电话号码验证绕过</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/email-and-phone-number-verification-bypass-worth-85dbaa794b28?source=collection_archive---------2-----------------------#2021-05-17">https://infosecwriteups.com/email-and-phone-number-verification-bypass-worth-85dbaa794b28?source=collection_archive---------2-----------------------#2021-05-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3498" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。我叫图欣·博斯(<a class="ae kl" href="https://instagram.com/tuhin1729" rel="noopener ugc nofollow" target="_blank"> @tuhin1729 </a>)。我目前在<a class="ae kl" href="https://virtualcyberlabs.com" rel="noopener ugc nofollow" target="_blank">虚拟网络实验室</a>担任首席技术官。在这篇文章中，我将分享我的一个发现，它帮助我赚到了$$$。</p><p id="f6c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以不浪费时间，让我们开始吧:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/7cb621ed8871d4c8df4afa4da51ac4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*ETIL-3kEGpOEq1tSLCX7AA.jpeg"/></div></figure><h1 id="00a9" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">简介:</h1><p id="7f5d" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">基本上，目标是一个电子邮件营销网站，让我们称之为redacted.com。我很快试图在那里创建一个账户。创建帐户时，我注意到他们使用OTP验证用户的电子邮件和电话号码。所以我决定尝试OTP旁路。我提交了OTP并使用burp捕获了请求。在这两种情况下(电子邮件和电话号码)，请求如下所示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi lx"><img src="../Images/19f0448293910124dc39eb1422f4cd3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XbYbJX3R8dh4tXb5sPA9lA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">tuhin1729</figcaption></figure><h1 id="c636" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">我的假设是:</h1><p id="10ba" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">OTP与requestId相关联。当我们转发请求时，服务器将验证“response”的值是否与相应的“requestId”相同，如果匹配，它将重定向到电话号码验证。因此，如果我们复制请求主体并删除请求，然后尝试使用主体，同时使用受害者的电子邮件地址生成帐户，我们可能会成功。</p><h1 id="9b47" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">复制步骤:</h1><p id="6495" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我执行了以下步骤，然后嘣！成功绕过电子邮件验证！我用受害者的电子邮件地址创建了一个账户。</p><p id="ad68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">I .尝试使用攻击者的电子邮件地址创建一个帐户。</p><p id="7fb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">二。提交OTP(在攻击者的帐户中接收)，复制请求主体并丢弃它。</p><p id="1042" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">三。现在尝试使用受害者的电子邮件地址创建一个帐户。</p><p id="34af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">四。输入任意随机的OTP并使用Burp捕获请求。</p><p id="4132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">动词 （verb的缩写）用您在步骤ii中复制的请求体替换请求体。</p><p id="4fb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不及物动词转发请求。</p><p id="aac5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于在验证电话号码时实现了相同的机制，所以我也能够成功地绕过电话号码验证。</p><h1 id="555e" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">影响:</h1><p id="fe06" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">通过利用此漏洞，攻击者可以使用受害者的电子邮件地址和电话号码创建一个帐户。</p><h1 id="6632" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">回应:</h1><p id="168c" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我很快做了一个POC发给他们。24小时内他们回复我:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mg"><img src="../Images/8d9ee1fc205b09c743c55387489a6231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K72GZoyRM8oiROOCVo5QDw.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">tuhin1729</figcaption></figure><p id="261e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">时间线</strong>:</p><p id="9f9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2011年4月5日—报告的漏洞</p><p id="ba7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2011年5月5日—回复了赏金邮件</p><p id="f341" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等待赏金！！！</p><p id="a2d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Twitter上关注我:@ <a class="ae kl" href="https://twitter.com/tuhin1729_" rel="noopener ugc nofollow" target="_blank"> tuhin1729 </a> _</p><p id="3669" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。我希望你喜欢这个博客。</p></div></div>    
</body>
</html>