<html>
<head>
<title>AngstromCTF Writeups</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">AngstromCTF评论</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/angstromctf-writeups-4e3d51c3dc42?source=collection_archive---------1-----------------------#2018-03-23">https://infosecwriteups.com/angstromctf-writeups-4e3d51c3dc42?source=collection_archive---------1-----------------------#2018-03-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2072" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是我在焦虑中解决的问题的记录。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/41bbf0d0d5f620df7f6bada05bd59430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pjzFWiF4k-N5F2G6ki3g0g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">AngstromCTF</figcaption></figure><h1 id="baec" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated"><strong class="ak">杂项</strong></h1><ol class=""><li id="9765" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">瓦尔多1 </strong></li></ol><p id="8822" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一个zip文件——flags . zip，其中包含各国的国旗。flag5.png的文件，我们看到阿开亚人有这面旗帜。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mk"><img src="../Images/2819010d50b4de15e6bbfc4501e23d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*muFu5dcdmfPytfy7a8eDOQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">旗帜-瓦尔多1</figcaption></figure><p id="42bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。瓦尔多2 </strong></p><p id="3a2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个问题中，我们在一个文件夹中有多个旗帜图像。从问题来看，好像一个形象不一样。我们看到了几个相同文件的MD5 hash-<strong class="jp ir">9f6e 902 c 233020026 caf 0 ebb B1 cf 0 ff 5</strong>。所以我们写了下面的脚本-</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="fe18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我们得到的文件名是waldo339.jpg。对文件运行<code class="fe mn mo mp mq b">strings</code>，我们得到的标志为—<strong class="jp ir">actf { r3d _ 4nd _ wh1t 3 _ str 1 p3s }</strong>。</p><p id="6f62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。那不是我的名字</strong></p><p id="d00b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一个pdf文件——gettysburg.pdf，但在试图打开它时，它打不开，给出了不正确的文件格式错误。我们在文件上运行<code class="fe mn mo mp mq b">binwalk</code>,看到它实际上是一个<code class="fe mn mo mp mq b">docx</code>文件。我们将扩展名更改为<code class="fe mn mo mp mq b">.docx</code> anf，打开时我们得到的标志为—<strong class="jp ir">actf { thanks _ Mr _ Lincoln _ but _ who _ even _ uses _ word _ more }</strong>。</p><p id="6885" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。文件传输</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/0faaefa83fe39377dd7fd244bae97075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flQ38h34yG6jFYd9bFxHqg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">捕获</figcaption></figure><p id="ebc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">突出显示的数据包显示了JPEG图像捕获。我们将JPEG导出为字节来获取图像。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/b70a632644ea2b6c630d2de889dac9a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*aayVyoMoE_seknW6BTx_ZQ.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">标志—文件传输</figcaption></figure><p id="4785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。GIF </strong></p><p id="d5d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在给定的图像上运行<code class="fe mn mo mp mq b">binwalk</code>，我们看到它实际上是许多图像的集合。</p><p id="89a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我们运行命令<code class="fe mn mo mp mq b">binwalk -D 'png image:png' jiggs.gif.png</code>。在检查提取的文件时，我们看到一个带有标志的图像。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/32906f795ebdb83ca3bcd455ae91d853.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*wF4EGcWIP_FhGDJo01Yyvg.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">标志Gif</figcaption></figure></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="c835" class="lb lc iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">秘密党员</h1><ol class=""><li id="35b5" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">热身</strong></li></ol><p id="6555" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从术语<strong class="jp ir"> <em class="ng">精</em> </strong>密码中，我们得到暗示，它可能是一个<strong class="jp ir">仿射密码</strong>。我们使用一个在线仿射密码<a class="ae nh" href="https://www.dcode.fr/affine-cipher" rel="noopener ugc nofollow" target="_blank">解算器</a>来获得标记为— <strong class="jp ir"> actf{it_begins} </strong>。</p><p id="cff4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。返回基地-ics </strong></p><p id="9c98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了下面的密码文本-</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/fa2fe0e34b48c44d9e50f3b1c3a728ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SofSDIsA6M2pokSNuTvjOw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">密文</figcaption></figure><p id="7179" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以很容易地看到，第一部分是二进制(基数2)，第三部分是十六进制(基数16)。使用任何在线转换器对它们进行解码，我们得到</p><p id="a7d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一部分:<strong class="jp ir"> actf{0ne_tw0_f0 </strong></p><p id="54f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三部分:<strong class="jp ir"> n_th1rtytw0_s1x </strong></p><p id="b622" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样从题目来看，我们可以说所有的密码都以2的某个幂为基数。我们猜测第二部分可能是基数8(八进制)。使用在线八进制到文本的转换器，</p><p id="a8dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二部分:<strong class="jp ir"> ur_eight_sixt33 </strong></p><p id="c4c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一个看起来像base64。解密后，我们得到</p><p id="9886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第四部分:<strong class="jp ir">tyf our _ no _ m0re }</strong></p><p id="5b41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，标志是—<strong class="jp ir">actf { 0ne _ tw0 _ f0ur _ eight _ sixt 33n _ th1rtytw 0 _ S1 xty f0ur _ no _ m0re }</strong></p><p id="658b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。异或</strong></p><p id="c521" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这看起来像是singlebyteXOR问题。我们使用下面的脚本</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="9494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在看到所有的纯文本后，我们得到的标志为—<strong class="jp ir">actf { hope _ you _ used _ a _ script }</strong>。</p><p id="0bff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。RSA简介</strong></p><p id="2b8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个经典的RSA问题，我们用下面的脚本来解密</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ml mm l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">RSA代码</figcaption></figure><p id="7ebb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以旗是—<strong class="jp ir">actf { RSA _ is _ reallly _ fun！！！！！！} </strong>。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="0037" class="lb lc iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">网</h1><ol class=""><li id="0abb" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">源Me 1 </strong></li></ol><p id="d6bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我们看到了一个登录页面。在检查源代码时，我们在注释中找到了密码— <strong class="jp ir"> f7s0jkl </strong>。<strong class="jp ir"> </strong>所以，我们用用户名<code class="fe mn mo mp mq b">admin</code>和密码<code class="fe mn mo mp mq b">f7s0jkl</code>登录。</p><p id="1b59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这为我们提供了标志-<strong class="jp ir">actf { source _ aint _ secure }</strong>。</p><p id="a086" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。给我接</strong></p><p id="c13c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最初，我们所有的是一个按钮，只有授权用户才允许通过的消息。单击该按钮时，我们会收到一条消息，提示我们未被授权。然而在地址栏中我们看到get参数是<code class="fe mn mo mp mq b">auth=false</code>。我们将其更改为<code class="fe mn mo mp mq b">auth=true</code>并按回车键。</p><p id="0278" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们得到标志—<strong class="jp ir">actf { why _ did _ you _ get _ me }</strong>。</p><p id="d9b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。续集</strong></p><p id="3151" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是SQL注入(SQLi)的经典案例。这里的提示是问题的名称，也就是SQL的发音。</p><p id="b7b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们输入用户名和密码作为<code class="fe mn mo mp mq b">'or''='</code>。</p><p id="76e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这给了我们一个标志—<strong class="jp ir">actf { SQL _ injection _ more _ like _ prequel _ injection }</strong>。</p><p id="bc0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。来源我2 </strong></p><p id="b830" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们给出了另一个登录页面。这里也是，用户名是<code class="fe mn mo mp mq b">admin</code>。在检查源代码时，我们找到了将我们输入的密码转换为md5的脚本，并将其与哈希<strong class="jp ir">BDC 87 b 9 c 894 da 5168059 e 00 ebffb 9077</strong>进行比较。我们使用一个<a class="ae nh" href="http://www.md5online.org/" rel="noopener ugc nofollow" target="_blank">在线md5解密器来</a>得到密码为<code class="fe mn mo mp mq b">password1234</code>。输入这个会给出标志—<strong class="jp ir">actf { MD5 _ hash _ browns _ and _ pasta _ sauce }</strong>。</p><p id="a52d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。马德里布斯</strong></p><p id="6c74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，从Flask代码中我们看到有一个变量app.secret_key，它基本上是一个配置变量。因此，我们前往“一个人的故事”部分，输入<code class="fe mn mo mp mq b">{{config}}</code>作为作者姓名，并在其他选项中输入任意随机字符串。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/2697fbcd20143f72bcf35a01a53320fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BDzPvfP_cvN_s0C7EJzaRw.png"/></div></div></figure><p id="3247" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里我们看到分配给标志<strong class="jp ir">的SECRET_KEY变量，actf{wow_ur_a_jinja_ninja} </strong></p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="1bbf" class="lb lc iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">倒车(再)</h1><ol class=""><li id="9805" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">版本1 </strong></li></ol><p id="17f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们在给定的ELF可执行文件上运行<code class="fe mn mo mp mq b">strings</code>。我们看到了字符串，<strong class="jp ir"> s3cret_pa55word </strong>。这可能是程序正在寻找的秘密密码。在运行可执行文件并给出上面的字符串作为键时，我们得到了标志。这将在shell服务器上完成。</p><p id="411f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。版本2 </strong></p><p id="72ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ELF在执行时要求猜测一个数字。我们用radare2反汇编代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/19d6850f74c17f33e31b0a148271ab57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDh5OuNNmXQdMQwlU1czHw.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nl"><img src="../Images/5e9ceeb29ab3a2c2b09ae57aeeb4d95c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28kMsr7STOHxzDHu3PhGhA.png"/></div></div></figure><p id="054e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">突出显示的十六进制，0x11d7是十进制的<strong class="jp ir"> 4567 </strong>。输入后，程序会要求我们给出两个两位数的数字。我们再次分析反汇编代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nm"><img src="../Images/75256c6d718b78140a24d9ddfaca1a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BBAVc48z0eGXVlvczdTCOg.png"/></div></div></figure><p id="39f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这告诉我们两个数的乘积应该是0xd67，即<strong class="jp ir"> 3431 </strong>。从<a class="ae nh" href="http://www.mathwarehouse.com/arithmetic/numbers/prime-number/prime-factorization.php?number=3431" rel="noopener ugc nofollow" target="_blank">这个环节，</a>我们发现数字是<strong class="jp ir"> 47 </strong>和<strong class="jp ir"> 73 </strong>。我们按升序排列，即47，然后是73。</p><p id="d7d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到的标志为— <strong class="jp ir"> actf{4567_47_73} </strong>。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="2549" class="lb lc iq bd ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu nf lw lx ly bi translated">二进制的</h1><ol class=""><li id="a9bf" class="lz ma iq jp b jq mb ju mc jy md kc me kg mf kk mg mh mi mj bi translated"><strong class="jp ir">蓄能器</strong></li></ol><p id="577a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的想法是不断地将整数加到变量上，而不需要显式地输入负值，我们必须使结果为负。这可以通过整数溢出来实现。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/6b467e73c2edb5ba65e91f782e83c6a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*kap7BYb0afMQZnJo4KhUSg.png"/></div></figure><p id="18cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在shell服务器上运行这些输入会给我们一个标志。</p><p id="6759" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。饼干罐</strong></p><p id="a26a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个缓冲区溢出问题。虽然我们从来没有明确地给numCookie赋值，但是我们可以溢出缓冲区，让它得到一个值。我把下面的输入——aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa99999998发送给程序，我们得到了这个标志。</p><p id="b9ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">标志是—<strong class="jp ir">actf { eat _ cookies _ get _ buffer }</strong>。</p><p id="aa89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。数字猜测</strong></p><p id="c56b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们借助于所给的暗示。printf函数最常见的漏洞是使用(或不使用)格式字符串。</p><p id="275d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在代码中，就在<code class="fe mn mo mp mq b">printf(buf)</code>之前，两个随机整数被初始化。所以，当我们被询问姓名时，如果我们给出以下输入，<strong class="jp ir">% d % d % d % d % d % d % d % d % d % d % d % d % d % d</strong>。这将为我们提供堆栈中的其他数字。运行时，我们将第3个和第9个值作为rand1和rand2。我们将它们相加，给出结果作为我们的猜测。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/72768ce184a6312f6da3134d58ef5b06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LNJZGo3pJFJAHw0I6HFy5Q.png"/></div></div></figure><p id="e0a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以标志是-<strong class="jp ir">actf { format _ string z _ are _ pre 77y _ sc4ry }</strong>。</p><p id="3358" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。Rop到顶部</strong></p><p id="3aa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个面向返回的编程(ROP)漏洞的例子，它基本上是访问不可执行堆栈的缓冲区溢出。为了利用它，我们可以使用下面的命令集-</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi np"><img src="../Images/e23513d25d79617f81a0199736aaf9bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6HY6fUj12aZN08cFBirMA.png"/></div></div></figure><p id="9f04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们发现_top 函数的地址<strong class="jp ir">是<strong class="jp ir"> 0x8048db </strong>。缓冲区大小也是<strong class="jp ir"> 0x28 </strong>。</strong></p><p id="821c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，下面的命令对我们有用-</p><p id="32b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">。/ROP _ to _ the _ top 32 " $(python-c ' print " A " * 0x 28+" BBBB "+" \ xdb \ x84 \ x04 \ x08 " ')"</strong></p><p id="3607" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们输入字符“A”来填充缓冲区的大小，输入“BBBB”来替换当前的堆栈指针(%ebx)，后跟我们希望指向的地址，这里是函数<strong class="jp ir">_ top</strong>的地址。</p><p id="ae16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在shell服务器上运行上面的命令会给我们一个标志。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="478c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ng">想了解更多文章，可以关注我的</em><a class="ae nh" href="https://github.com/wr47h" rel="noopener ugc nofollow" target="_blank"><em class="ng">Github</em></a><em class="ng">。</em></p></div></div>    
</body>
</html>