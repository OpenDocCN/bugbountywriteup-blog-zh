<html>
<head>
<title>How I was able to bypass the admin panel without the credentials.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何在没有凭证的情况下绕过管理面板的。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-was-able-to-bypass-the-admin-panel-without-the-credentials-d65f90e0e1e4?source=collection_archive---------0-----------------------#2021-06-11">https://infosecwriteups.com/how-i-was-able-to-bypass-the-admin-panel-without-the-credentials-d65f90e0e1e4?source=collection_archive---------0-----------------------#2021-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3483" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我的第一篇文章，我希望你们一定会学到一些新东西。因为我不被允许透露关于公司的信息，让我们假设它是example.com。主域是测试漏洞的唯一范围。现在让我们进入bug………。</p><p id="06ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当我们访问一个网站时，我们都试图首先了解所使用的技术，为此，我使用了一个名为<a class="ae kl" href="https://www.wappalyzer.com/" rel="noopener ugc nofollow" target="_blank"> wappalyzer </a>的扩展。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/a18b0a82c1c59fd7b322c5fb7762852d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*8zVZQtFv5pASQQTYporRVg.png"/></div></figure><p id="319d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你一定在想，是的，有一个CMS(内容管理系统),它是WordPress，让我们绕过/wp-admin。但事实并非如此，这个结果可以说是假阳性。因此，为了验证这一点，我们可以使用Kali Linux中预装的名为Wpscan的工具。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/f50026bdaa1ec9d75f9e1e56ec908cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Clx_UBpE0p-LfCFQIeUzQ.png"/></div></div></figure><p id="49b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以这是一个很好的例子，说明wappalyzer如何向您显示假阳性结果。这让我想到，如果WordPress是一个假阳性结果，那么这个网站的CMS会是什么。现在，让我们从侦察过程开始。</p><p id="ada2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在好戏开始了……</strong></p><p id="246c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1)目录暴力</p><p id="f875" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有多种工具可以暴力破解目录。下面给出其中的几个。</p><p id="653b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">i) <a class="ae kl" href="https://github.com/ffuf/ffuf" rel="noopener ugc nofollow" target="_blank"> FFUF </a></p><p id="1e01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ii) <a class="ae kl" href="https://github.com/OJ/gobuster" rel="noopener ugc nofollow" target="_blank"> GoBuster </a></p><p id="8f04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">三)<a class="ae kl" href="https://github.com/M4DM0e/DirDar" rel="noopener ugc nofollow" target="_blank">迪达尔</a></p><p id="c8c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有太多的列表可用于暴力破解目录。下面给出其中的几个。</p><p id="d2e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">i) <a class="ae kl" href="https://github.com/danielmiessler/SecList" rel="noopener ugc nofollow" target="_blank"> Seclist: </a></p><p id="8075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ii ) <a class="ae kl" href="https://github.com/maurosoria/dirsearch/blob/master/db/dicc.txt" rel="noopener ugc nofollow" target="_blank">目录搜索:</a></p><p id="2206" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">iii) <a class="ae kl" href="https://wordlists.assetnote.io/" rel="noopener ugc nofollow" target="_blank">资产说明</a></p><p id="3cbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了ffuf工具和assetnote文件，所以命令看起来像这样</p><p id="4b98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">命令:ffuf-c-w/word list-u/URL/FUZZ-MC 200，301，302 -t 500</p><p id="c242" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在使用了单词表之后，我能够进入其中一个目录，这个目录是“<strong class="jp ir">site manager”</strong>。我打开目录，我得到了该公司的CMS登录页面。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/bdaa5bc3b13a66e9947d6562fe071574.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*aapXQsLS_7sEVaht15-4XA.png"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated"><strong class="bd ll">管理门户</strong></figcaption></figure><p id="fb9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我尝试使用默认凭证，但仍然无法进入管理门户。</p><p id="3c3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个网站看起来有点像这个https://www.example.com/sitemanager/login.php?位置= % 2fs item manager % 2F</p><p id="1d8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了不浪费任何时间，我尝试重新构建/sitemanager/FUZZ目录，结果我得到了这么多端点(所有这些都是假阳性，显示200 OK，大小为“0”)，但是单词列表中只有一个有效，那就是/s <strong class="jp ir"> tartup.sh </strong></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lm"><img src="../Images/d942e2989cf1a74662830d1b763caf09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eaHNijCfZyWyABEhMz4-AQ.png"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated"><strong class="bd ll">启动。sh </strong></figcaption></figure><p id="dc82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这让我感到高兴，是的，我得到了一些端点，通过它们我可以升级到管理门户，但仍然有一些机会在“settings.txt”或“errors_php.txt”中暴露凭据，我可以通过它们进入管理门户。</p><p id="1bbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在打开errors_php.txt和settings.txt后</p><ol class=""><li id="2ad0" class="ln lo iq jp b jq jr ju jv jy lp kc lq kg lr kk ls lt lu lv bi translated"><strong class="jp ir">错误_php.txt </strong></li></ol><p id="0981" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="e44c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出现错误:02.11.2020 10:02:32 <br/>用户:admin，script:/site manager/admin . PHP<br/>IP:77。**.**.**| ISP信息:host-77–236–201–15 |会话:emdcjngeinl81f9kl5c9hjlp31|代理:Mozilla/5.0(Windows NT 6.1；WOW64RV:16.0)Gecko/2010 01 01 Firefox/16.0<br/>8、未定义变量:edit_profile_page_pid、/home/text/www/site/modrw.php、42</p><p id="195d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出现错误:02.11.2020 10:56:16 <br/>用户:管理员，脚本:/site manager/admin . PHP<br/>IP:77。**.**.**| ISP信息:host-77–236–201–15 |会话:emdcjngeinl81f9kl5c9hjlp31|代理:Mozilla/5.0(Windows NT 6.1；WOW64RV:16.0)Gecko/2010 01 01 Firefox/16.0<br/>8、未定义变量:edit_profile_page_pid、/home/text/www/site/modrw.php、42</p><p id="b0ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出现错误:05.11.2020 11:41:46 <br/>用户:管理员，脚本:/site manager/admin . PHP<br/>IP:77。**.**.**| ISP信息:host-77–236–201–15 | Session:i6f 928 p 13 qcd 1 bpoinlkljj 31 |代理:Mozilla/5.0(Windows NT 6.1；WOW64RV:16.0)Gecko/2010 01 01 Firefox/16.0<br/>8、未定义变量:edit_profile_page_pid、/home/text/www/site/modrw.php、45</p><p id="9484" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="1085" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我觉得我可以使用这个错误文件升级到管理门户的一点。但不幸的是，我没能做到。因此，从道德上讲，我单独报告了这份文件，并得到了。</p><p id="83de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir"> settings.txt </strong></p><p id="2324" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次打开这个文件后，我得到了一些HTTP burp请求文件，但这次它们有cookies。这些请求响应是管理员和cookie的，也是多个用户和cookie的。现在，admin的HTTP请求如下所示:</p><p id="b440" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="ff99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">日期:2020–11–20 15:19:41<br/>设置<br/>头:GET <br/>主机:www.example.com<br/>连接:keep-alive <br/>编译指示:无缓存<br/>缓存控制:无缓存<br/>升级-不安全-请求:1 <br/>用户代理:Mozilla/5.0(Windows NT 10.0；Win64x64) AppleWebKit/537.36 (KHTML，像壁虎一样)Chrome/70 . 0 . 3538 . 102 Safari/537.36<br/>接受:text/html，application/xhtml+xml，application/XML；q=0.9，image/webp，image/apng，*/*；q=0.8 <br/>推荐人:https://www.example.com/sitemanager/admin.php<br/>接受-编码:gzip，deflate，br <br/>接受-语言:cs，en-GB；q=0.9，en；q=0.8，sk；q = 0.7<br/>Cookie:_ _ stripe _ mid = b1a 624 a 3-b1da-45aa-9aca-6236 DD 8 # # #；_ ga = ga 1.2 . 805574655.149725 # # # #；_ _ at uvc = 0% 7c 41% 2c 0% 7c 42% 2c 0% 7c 43% 2c 0% 7c 44% 2c 1% 7c 45；语言= csPHPSESSID = lqcp 890 ff 17 r 02 erb # # # # #；_ GID = ga 1.2 . 1643979482.1542716 # #；login _ config = u % 3admin_gat=1 <br/> IP信息:<br/>脚本:/site manager/settings . PHP<br/>IP:213。**.**.** <br/> ISP信息:213。**.**.** <br/>会话:lqcp890ff17r02erbkot5u### <br/>代理:Mozilla/5.0(Windows NT 10.0；Win64x64) AppleWebKit/537.36 (KHTML，像壁虎一样)Chrome/70 . 0 . 3538 . 102 Safari/537.36</p><p id="832b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — — — — — —</p><p id="bfd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将它粘贴到burpsuite的repeater中，并根据repeater做了一些基本的修改&amp;添加了目标部分，我得到了200 OK。我就像……</p><blockquote class="lw"><p id="320d" class="lx ly iq bd lz ma mb mc md me mf kk dk translated"><strong class="ak">现在我们回到了正题上</strong></p></blockquote><figure class="mh mi mj mk ml ky gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/2bf00f266cca3d51cf022b5168435507.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*hXNQdB-NK471ZUe1iR2UhA.gif"/></div></figure><p id="5da9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我添加了“<strong class="jp ir"> /dashboard.php </strong>”目录，然后我获得了管理员权限，可以使用这个门户了。</p><h1 id="fbc6" class="mm mn iq bd ll mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">奖励/赏金</h1><p id="90fc" class="pw-post-body-paragraph jn jo iq jp b jq nj js jt ju nk jw jx jy nl ka kb kc nm ke kf kg nn ki kj kk ij bi translated">这被报告给了安全团队，他们删除了sitemanager门户。</p><p id="d0f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我因为这个bug获得了500€。</p><h1 id="bef9" class="mm mn iq bd ll mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni bi translated">拿走</h1><p id="6445" class="pw-post-body-paragraph jn jo iq jp b jq nj js jt ju nk jw jx jy nl ka kb kc nm ke kf kg nn ki kj kk ij bi translated">始终寻找可用于将bug从低级升级到严重/高级的端点。</p><blockquote class="lw"><p id="6a41" class="lx ly iq bd lz ma mb mc md me mf kk dk translated">感谢你阅读这篇文章。欢迎评论和反馈。</p></blockquote></div></div>    
</body>
</html>