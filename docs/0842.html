<html>
<head>
<title>Fun with Header and Forget Password</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有趣的标题和忘记密码</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/fun-with-header-and-forget-password-without-that-nasty-twist-cbf45e5cc8db?source=collection_archive---------1-----------------------#2020-09-22">https://infosecwriteups.com/fun-with-header-and-forget-password-without-that-nasty-twist-cbf45e5cc8db?source=collection_archive---------1-----------------------#2020-09-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="efd3" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">——没有那个讨厌的扭曲</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b979bfeef221c67451ccce854871538a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*honY5DMRuioU5H7FljGuAw.png"/></div></div></figure><p id="4dd9" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">与我的另一篇<a class="ae lq" href="https://medium.com/bugbountywriteup/fun-with-header-and-forget-password-with-a-twist-af095b426fb2" rel="noopener">文章</a> :) <br/>相比，这篇文章没有那种可怕的警告，在bug搜索期间，摆弄头部是很重要的。但是，很容易将自己限制为只发送带有盲XSS/盲sqli/盲rce/等的GET请求。内部引用，用户代理，Cookies，自定义标题等。但是，这是一个容易错过的事情。如果我没有在burp套件中使用匹配和替换规则，我就不会发现这个错误。</p><p id="9b08" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">初始阶段:</strong></p><p id="1f9b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">为了根据portswigger文章[链接]确定是否有延迟的pingbacks，我在有效负载中将Referer头设置为pingb.in。并且，在浏览了目标网站之后，我使用各种功能检查了任何pingbacks。什么都没有，连域名系统都没有。我想，如果不超过几个小时，可能会有几个小时的延迟，所以我让它去。剧透:在这种情况下，从来没有得到任何延迟的pingbacks，但这篇文章不是关于这一点:)</p><p id="c760" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">发现:</strong></p><p id="4845" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">有问题的目标网站也有注册功能，用它忘记密码。在前面的步骤中，我还触发了忘记密码，以便稍后查看。令我惊讶的是，当我检查我的电子邮件时，密码恢复链接使用了我的pingb.in链接。</p><p id="4ac3" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在进一步检查打嗝历史后，我注意到发送忘记密码的电子邮件的原始请求有Referer:<a class="ae lq" href="https://targetwebsite.com/" rel="noopener ugc nofollow" target="_blank">https://targetwebsite.com</a>，这解释了一切。</p><p id="7a44" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">概念验证:</strong></p><p id="9285" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在，我知道如何构建我的PoC。</p><p id="cc7d" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">1 —输入测试帐户B的电子邮件</p><p id="6164" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">2-拦截POST请求</p><p id="5f0c" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">3 —将有效负载中的引用标头更改为pingb.in</p><p id="55e2" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">4-从测试帐户B的电子邮件中单击中毒链接</p><p id="728f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">5 —检查pingb.in日志，它将发出GET请求，其中包含更改帐户B的密码所需的帐户B的令牌。</p><p id="e3d1" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">除了pingb.in，burpcollaborator也可以用于您有权访问的vps。</p></div><div class="ab cl lr ls hx lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="im in io ip iq"><p id="fa3f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">它只是向您展示了Referer header除了一些地方使用它来保护CSRF或生成返回到上一页的链接之外，还有一个额外的作用，这是一个很难以一种有用的方式利用的问题(至少从个人经验来看)。</p></div></div>    
</body>
</html>