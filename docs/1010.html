<html>
<head>
<title>JaWT Scratchpad (picoCTF)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JaWT草稿栏</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/jawt-scratchpad-picoctf-93766d81fd8e?source=collection_archive---------0-----------------------#2020-12-06">https://infosecwriteups.com/jawt-scratchpad-picoctf-93766d81fd8e?source=collection_archive---------0-----------------------#2020-12-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4920" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">阿克谢·辛德撰写</p><p id="0191" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种挑战属于网络开发的范畴。理解如何操作和使用jwt(Json Web令牌)是一个很好的挑战。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/325ce7ddf064c4103b667ee7d67d33f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VpWkjeqV5DGTRFZ2mTBPew.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">JWT</figcaption></figure><h2 id="3950" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">什么是JWT，它是如何工作的？</h2><p id="7803" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">JSON Web Token  ( <strong class="jp ir"> JWT </strong>)是一个开放标准(RFC 7519)，它定义了一种紧凑的自包含方式，以JSON对象的形式在各方之间安全地传输信息。该信息可以被验证和信任，因为它是数字签名的。</p><p id="4a4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">访问URL并验证您的身份。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lz"><img src="../Images/38538df95bbb1ba27aa1d3175b5bf3d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*418E0pqouBAuWyqU596GuA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">网页</figcaption></figure><p id="74bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看这个提示，它告诉我们要小心饼干。你可以使用Chrome开发者工具(F12)或者这个叫做<strong class="jp ir"> Cookie编辑器</strong>的很酷的扩展。我将使用Cookie编辑器。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ma"><img src="../Images/637654706c990e75e69b843854eeabcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q6TDoNj_1f4RX6KUcuXWjQ.png"/></div></div></figure><p id="f7f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来理解这个饼干背后的概念(JWT)。</p><p id="5d98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">cookie被分成三部分，中间用一个<strong class="jp ir"><em class="mb"/></strong>点隔开。</p><ol class=""><li id="51b3" class="mc md iq jp b jq jr ju jv jy me kc mf kg mg kk mh mi mj mk bi translated">页眉</li></ol><p id="c4f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一部分由一个头组成，它基本上告诉我们使用哪种类型的算法。它是base64URL编码的字符串。解码后我们得到了下面的字符串:</p><blockquote class="ml mm mn"><p id="0b0e" class="jn jo mb jp b jq jr js jt ju jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj kk ij bi translated">{"typ":"JWT "，" alg":"HS256"}</p></blockquote><p id="730a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.有效载荷</p><p id="fe25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二部分是有效载荷，也是base64URL编码的，它几乎包含了用户名。(可用于访问控制)。在这个CTF，我们以“akshay”的身份登录。</p><blockquote class="ml mm mn"><p id="dd21" class="jn jo mb jp b jq jr js jt ju jv jw jx mo jz ka kb mp kd ke kf mq kh ki kj kk ij bi translated">{"user":"akshay"}</p></blockquote><p id="9708" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.签名</p><p id="5817" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该部分验证令牌并检查令牌是否被篡改。因此，如果我们尝试将令牌或用户字段的值更改为admin，本部分不会允许这种情况发生，并且会给出错误。</p><h2 id="7e90" class="lb lc iq bd ld le lf dn lg lh li dp lj jy lk ll lm kc ln lo lp kg lq lr ls lt bi translated">利用jwt。</h2><p id="be40" class="pw-post-body-paragraph jn jo iq jp b jq lu js jt ju lv jw jx jy lw ka kb kc lx ke kf kg ly ki kj kk ij bi translated">这里的令牌使用的是HS256算法。因此，如果一个弱密钥被用来签署一个令牌，那么也许我们可以尝试暴力攻击来获取该密钥。</p><p id="ac78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将使用<a class="ae mr" href="https://github.com/openwall/john" rel="noopener ugc nofollow" target="_blank"> JohnTheRipper </a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/089a26fb190eab9b10f0f3d1e1fa533f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7vlZkqJGhtjfco1NBn0uyA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">暴力攻击</figcaption></figure><p id="a6fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获得密钥后，我们可以用它来签署一个令牌，并尝试以管理员的身份进行访问。</p><p id="ff84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个<a class="ae mr" href="https://jwt.io/" rel="noopener ugc nofollow" target="_blank">站点</a>允许您生成和验证JSON Web令牌。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/01a152bc6210a5acb81ac1278125bebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJfB_b7yXHzzFdp7dKamfw.png"/></div></div></figure><p id="b14a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入您的密钥并生成令牌。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mu"><img src="../Images/d54a28c4ddcee067974597cbf1793e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qGQOnC5kNj_Hwe5YJppJFg.png"/></div></div></figure><p id="5a86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">复制我们生成的令牌，并使用cookie编辑器粘贴它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/d538bdfaa141c98dd4ce44f159c127dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*-nTDVcWp9VJ-rAMZofwwrw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">令牌已复制</figcaption></figure><p id="5fac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击“保存”按钮并刷新页面以获得管理员访问权限。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mw"><img src="../Images/e05d0451875eeca3c27d54f5381123ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JiRRp7JA-9yLsoxuYuOt2g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">成功</figcaption></figure><p id="234b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你😃祝你黑客愉快💻</p></div></div>    
</body>
</html>