<html>
<head>
<title>OTP Bypass on India’s Biggest Video Sharing Site.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">印度最大的视频分享网站OTP Bypass。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/otp-bypass-on-indias-biggest-video-sharing-site-e94587c1aa89?source=collection_archive---------0-----------------------#2020-04-10">https://infosecwriteups.com/otp-bypass-on-indias-biggest-video-sharing-site-e94587c1aa89?source=collection_archive---------0-----------------------#2020-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1577" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经很久没有发表任何文章了，我会继续发表一些关于我最近最好的发现。</p><p id="9612" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几个月来，我们一直在通过我们的组织从事一些私人项目。所以，我决定休息一会儿，在公共平台上寻找bug来更新我的技能。</p><p id="9630" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">后来，我发现了一个允许用户分享视频的社交媒体网站，类似于拥有超过5000万活跃用户的抖音，但我决定不向公众透露。</p><h1 id="d965" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">让我们开始吃吧！</h1><p id="76b1" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我通过收集一些关于目标网站的信息开始了攻击，让我们把这个网站想象成example.com，我注册了一个账户，正在搜索dashboard。但令我惊讶的是，我找不到停止前进的仪表板，因为我喜欢寻找XSS ❤</p><p id="09c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等等，让我们试试登录页面。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/3a255814c68fbaa12fa601c857379af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*_-MVF3x0l9kWGQRdHRal_A.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">登录页面(出于安全原因修改！)</figcaption></figure><p id="c0a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">登录页面有一个登录与电话号码的方法，这允许我输入我的手机号码，并输入我收到的4位数的动态口令。我决定通过使用入侵者选项卡来强行使用OTP方法。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi ma"><img src="../Images/116f8df39a8394e680ea0b0d17d893b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8VxkMQe5bCtoCPyRHP2lQ.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">使用不正确的OTP将请求发送到易受攻击的站点</figcaption></figure><p id="ee38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我转发了请求，但不幸的是，当我达到10个数据包时，请求数据包被阻止。我必须承认，这是一个很好的实现。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mf"><img src="../Images/11474e4123e57d6b02c849e934714698.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uVqihRgtz3DP4aEtyPvDCg.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">用于OTP暴力的入侵者攻击</figcaption></figure><p id="3bab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定不放弃OTP旁路，让我去另一个镜头，我前往创建帐户，并再次尝试蛮力迫使OTP，但仍然失败。喝了几杯咖啡因饮料后，我决定通过使用<strong class="jp ir">动作&gt;拦截&gt;对请求的响应来分析请求和响应。</strong>该方法允许攻击者修改发送给浏览器的响应。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mg"><img src="../Images/dc1c1c15a71c16618721dfc90d3c6817.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eljKdgfDDkJPLEHEkT-p9w.png"/></div></div></figure><p id="3e9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我用新的手机号码在创建帐户表单上提出了另一个请求，并输入了我收到的正确的动态口令。通过使用Do Intercept响应，我开始分析响应，令我惊讶的是，响应非常简单，如下所示。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mh"><img src="../Images/6ee306f74c4b41de71762a5822162505.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1P1UAgpa6VxnreQsKlpHow.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">有效动态口令的响应</figcaption></figure><blockquote class="mi mj mk"><p id="0257" class="jn jo ml jp b jq jr js jt ju jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj kk ij bi translated"><strong class="jp ir"> {"data":{"det":{}，" blocks":[]}，" gsc":"700"} </strong></p></blockquote><p id="6355" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">坦白说，我不知道这是什么意思。但是我发现如果用户输入有效的OTP，这个代码片段可以用来获取用户的详细信息。</p><p id="303f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我决定用无效的OTP来分析响应。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mp"><img src="../Images/91e4fc9c2c95ed61f90b2890e4eddb91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4d25Tea03q0lr-u1Luqs0g.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">对无效动态口令的响应</figcaption></figure><blockquote class="mi mj mk"><p id="a921" class="jn jo ml jp b jq jr js jt ju jv jw jx mm jz ka kb mn kd ke kf mo kh ki kj kk ij bi translated"><strong class="jp ir"> {"gsc":"615 "，" message ":"验证码无效" } </strong></p></blockquote><p id="c575" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我发现这是唯一用于验证OTP的代码片段。为了让这个可行，我需要证明这个确实可行。于是我决定用朋友的手机号注册，输入了一个错误的OTP，而我所做的只是通过拦截响应，把无效的验证码片段去掉，换成有效的代码片段。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="mb mc di md bf me"><div class="gh gi mq"><img src="../Images/c965b4b747ce445a8d37fa2857c1842e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*b9m3Itq4oEy4_iFTfkRAUA.gif"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">无线一键通</figcaption></figure><p id="a6af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好。！即使没有有效的动态口令，我也可以用我朋友的手机号码创建帐户，这清楚地表明我可以用任何手机号码创建帐户，而无需验证动态口令。</p><h1 id="884a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">吸取教训！</h1><p id="6b3d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">研究人员总是试图破坏OTP字段，但是他们忘记了分析发送到浏览器的响应。玩弄回应，用力打奖金。</p><h1 id="954d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">时间线:</h1><p id="2697" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">2019年10月:就此问题发送的邮件。</p><p id="c302" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2019年11月:已就此问题发送邮件。</p><p id="6812" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2019年12月:已发送关于此问题的邮件。</p><p id="46dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2020:还在发邮件！！:)</p><p id="07b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请鼓掌👏(50X)，那我们来连线:</p><p id="754e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">推特:</strong>【https://twitter.com/sriramoffcl】T4</p><p id="928f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">insta gram:</strong><a class="ae mr" href="https://instagram.com/sriram_offcl" rel="noopener ugc nofollow" target="_blank">https://instagram.com/sriram_offcl</a></p><p id="a491" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">领英:</strong><a class="ae mr" href="https://www.linkedin.com/in/sriramkesavan/?lipi=urn%3Ali%3Apage%3Ad_flagship3_feed%3B24kf2%2BxTTkih9NPd%2B%2BEBJw%3D%3D" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/sriramkesavan</a></p><p id="c1a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mr" href="paypal.me/sri123" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">邮件:</strong></a>sriramkesavan98@gmail.com |<strong class="jp ir">捐款:</strong><a class="ae mr" href="https://paypal.me/sri123" rel="noopener ugc nofollow" target="_blank">https://paypal.me/sri123</a></p><h1 id="b243" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">放弃</h1><p id="a9f9" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">博客内容仅用于信息和教育目的。</p><p id="5111" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于因使用博客内容而直接或间接产生的任何直接、间接、暗示、惩罚性、特殊、附带或其他后果性损害，我特此声明不对任何一方承担任何及所有责任，由读者自行负责。</p><p id="015a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">和平</strong> ✌️ <strong class="jp ir">！！！</strong></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="289d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ml">关注</em> <a class="ae mr" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ml"> Infosec报道</em> </a> <em class="ml">获取更多此类精彩报道。</em></p><div class="mz na gp gr nb nc"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">信息安全报道</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq lu nc"/></div></div></a></div></div></div>    
</body>
</html>