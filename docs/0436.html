<html>
<head>
<title>APU Battle of Hackers Final 2019 Write Up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">APU黑客之战2019决赛记起</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/apu-battle-of-hackers-final-2019-write-up-e4141f21b0a4?source=collection_archive---------0-----------------------#2019-11-24">https://infosecwriteups.com/apu-battle-of-hackers-final-2019-write-up-e4141f21b0a4?source=collection_archive---------0-----------------------#2019-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/4f19074a1b0ebf6f902e6263f86ca1c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*_KnxA9HIjXKfiSiZXJiS3A.png"/></div></figure><p id="863a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是一篇关于我的团队如何解决APU黑客之战2019 (APUBoH)在最后一轮捕捉旗帜中的挑战的文章。在CTF结束时，我们排名第9，并设法解决了3个问题，2个法医问题和1个隐写术。</p><p id="1cb8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于那些不熟悉《夺旗》(CTF)的人来说，你可能想看看我之前的文章，在那里我解释了一点关于CTF的情况。</p><div class="ks kt gp gr ku kv"><a href="https://medium.com/@mfrashad/my-first-ctf-writeup-kpmg-cyber-security-challenge-2019-a42a64db04d8" rel="noopener follow" target="_blank"><div class="kw ab fo"><div class="kx ab ky cl cj kz"><h2 class="bd ir gy z fp la fr fs lb fu fw ip bi translated">我的第一篇CTF报道:毕马威2019年网络安全挑战</h2><div class="lc l"><h3 class="bd b gy z fp la fr fs lb fu fw dk translated">CTF:学习黑客的有趣方式</h3></div><div class="ld l"><p class="bd b dl z fp la fr fs lb fu fw dk translated">medium.com</p></div></div><div class="le l"><div class="lf l lg lh li le lj js kv"/></div></div></a></div><p id="c352" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">继续，这篇文章的挑战可以在github上下载:<br/>【https://github.com/mfrashad/apuboh19 T4】</p><p id="f913" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好了，继续写文章。</p><h1 id="a185" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">密写</h1><h1 id="c2ee" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">尼亚尼亚尼亚</h1><p id="2294" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">当我们下载挑战赛的附件时，我们得到了一个名为All_Star_-_Smash_Mouth.mp3的mp3文件。打开该文件，它是一首歌，但奇怪的是它有一张封面图片。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/30f192d0a65414a1355744c9aedc6230.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/0*75Ip9F96V8yxpTLZ.png"/></div></figure><p id="1ebc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">后来，我们尝试了一些常见的技巧，如字符串命令，并查看文件的频谱图，但它并没有给我们带来任何线索。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mt"><img src="../Images/ca5f7d3da9dab337dc983dbca1a9f11a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p6_sj2iUcMu4yU7-.png"/></div></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">文件的光谱图</figcaption></figure><p id="c6f3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但是，我们在使用binwalk雕琢文件时发现，文件中嵌入了一个png文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7241ff804cc8ff042455475393045e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/0*TNrZAHBst_wYlErJ.png"/></div></figure><p id="2366" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来，我们继续提取图像，打开它，不出所料，我们会看到与之前看到的相同的封面图像。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/f59bb0fbe36404bf30b60788f17c17d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/0*tcqUDqFJVWk8n1WQ.png"/></div></figure><p id="e4a7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但现在，由于我们有一个png文件要处理，我们可以尝试各种图像隐写程序。因此，我们做的第一件事是在Stegsolve.jar中打开图像，这是一个java程序，将对图像应用各种操作，如求逆、异或或噪声等。令人惊讶的是，它立刻为我们展示了红色飞机1上的旗帜。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/b890db64e34d4c858be68f43e8d94414.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/0*kpuewfGfZKO77IjM.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">Stegsolve.jar</figcaption></figure><p id="13dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">标志为<strong class="jw ir"><em class="ne">apuboh 2019 { s 0 m3 b 0 dy _ h1d _ th3 _ fl @ g }</em></strong>。</p><h1 id="a155" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">辩论术</h1><h1 id="a2f5" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">邻居</h1><p id="f954" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">对于这个挑战，我们得到了一个pcapng文件<code class="fe nf ng nh ni b">neighbors.pcapng</code>。由于这是一个pcap文件，我们继续在wireshark中打开它。接下来，我们开始在flag格式中搜索一些关键字，在本例中是“apu ”,幸运的是，它马上就给了我们这个标志。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi mt"><img src="../Images/c84c6968798bceb16e6e83142f3f516f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*W7FGuRlSyPqMV_RE.png"/></div></div></figure><p id="3cd3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">标志为<strong class="jw ir"><em class="ne">apuboh 2019 { CDP _ spoofed }</em></strong>。</p><h1 id="1bd5" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">闭嘴</h1><p id="346c" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">下一个挑战也是网络取证挑战，我们又得到了<code class="fe nf ng nh ni b">zipit.pcapng</code>，一个pcapng文件。然而，这一次，搜索字符串不会给我们带来任何东西。经过四处寻找，我们发现了一些可疑的HTTP数据包，这可能是线索。因此，我们使用wiresharks中的导出对象功能。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nj"><img src="../Images/1f9da86c9d5b99259390f5797f6b7771.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*wGC2gpzxvjuG7TMS.png"/></div></div></figure><p id="a455" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">导出文件后。我们运行<code class="fe nf ng nh ni b">file</code>命令来检查文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/33d5dff44eafeb2811384ec1556d0075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/0*4aTzrbVabbzYMhds.png"/></div></figure><p id="efbe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">根据输出，<code class="fe nf ng nh ni b">smss.doc</code>文件很突出，因为它是一个zip文件，与标题相关。因此，我们试图提取<code class="fe nf ng nh ni b">smss.doc</code>文件，但是它要求输入密码。到这个时候，我们知道我们在正确的轨道上，这可能是有标志的文件。接下来，我们开始搜索密码，我们在一个导出的文件中找到了线索，<code class="fe nf ng nh ni b">share</code>。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mu mv di mw bf mx"><div class="gh gi nl"><img src="../Images/bb81828df68d9a0f5f59e2046c45eefe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p1VkktIcw4xyDA4f.png"/></div></div></figure><p id="b1ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们发现了一个关于<code class="fe nf ng nh ni b">rockyou.txt</code>的文本，这是一个非常有名的用于破解的密码列表。因此，我们尝试使用压缩文件破解工具<code class="fe nf ng nh ni b">fcrackzip</code>和<code class="fe nf ng nh ni b">rockyou.txt</code>字典来破解这个压缩文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7b886470ebd5860c5b6163ca6bcaad92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*ZX71-G5WfawGXeAY.png"/></div></figure><p id="f1b6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然而，它给了我们一个错误，即它不是一个zip文件。经过一番搜索后，我们发现这个文件不是通常的PKzip文件，而是7zip和fcrackzip无法与7zip文件一起工作(我花了很长时间才弄明白这一点，我以为我只需要使用不同的版本)。因此，我们寻找其他破解工具，找到了7个zip-crack。<br/><a class="ae lk" href="https://github.com/Goron/7zip-crack" rel="noopener ugc nofollow" target="_blank">https://github.com/Goron/7zip-crack</a></p><p id="223c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，我们开始用7zip-crack的<code class="fe nf ng nh ni b">rockyou.txt</code>字典破解文件。过了一会儿它终于给了我们密码<code class="fe nf ng nh ni b">godisgood</code>，耶！。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/ba704828eefd71ba476b1a4820b74732.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/0*R_nTsaXBHIIeAoaA.png"/></div></figure><p id="32ab" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">用密码解压zip文件会给我们一个PE32 Windows可执行文件<code class="fe nf ng nh ni b">smss</code>。我们首先尝试的总是<code class="fe nf ng nh ni b">strings</code>，但遗憾的是它没有给出任何结果。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/523c55eda06f620063e51be8b86f05e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/0*Pltreuo6Pdg6EbTe.png"/></div></figure><p id="bc94" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于这是一个可执行文件，我们认为这将是一个逆向工程的挑战，并试图运行和逆向工程。但是我们甚至没能在dos模式下运行这个程序，因为它出现了一些错误。试图在IDA pro中对程序进行逆向工程只会让我们更加困惑，因为我们只能进行静态分析，而不能调试程序。</p><p id="4da7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">幸运的是，我们在<code class="fe nf ng nh ni b">hexedit</code>中打开了该文件，在这里您可以读取该文件的二进制格式和十六进制格式。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/bd571c57ae844023ddb23c181bac3c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*KXsbtasOPW0CP5Qf.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk translated">hexedit中的smss文件</figcaption></figure><p id="b492" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">耶，我们找到旗子了！我们怀疑<code class="fe nf ng nh ni b">strings</code>命令没有选择标志的原因是因为标志不是一串字符，而是由0位或空格分隔。这个挑战真的花了我们相当长的时间，也相当令人沮丧。我们真的很幸运能在hexeditor中打开这个文件，否则我们就会错过这个标志。</p><p id="da86" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">标志为<strong class="jw ir"><em class="ne">apuboh 2019 { 7z 1 pisus 3 fu | }</em></strong></p><h1 id="8f41" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">结论</h1><p id="3436" class="pw-post-body-paragraph ju jv iq jw b jx mj jz ka kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr ij bi translated">上面的挑战可能看起来很简单，但是我们在解决它的时候确实有点困难。然而，我们的大部分时间都花在试图解决我们没有解决的其他挑战上，尽管我们确实取得了一些进展。当我有时间的时候，我可能会编辑这个帖子来添加其他挑战的文章，但是请随意在评论中发布您的解决方案或链接到您的文章！</p><p id="731d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我的一个遗憾是，在参加比赛之前，我没有更彻底地研究二进制剥削问题。我期待基本的逆向工程挑战，但给了二进制开发挑战，如基本堆栈或缓冲区溢出。如果我事先研究了这些，我们的排名会提高很多。</p><p id="eb6b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">总的来说，这是一次很棒的经历，我们从比赛中学到了很多。此外，我要感谢我的队友法里斯·罗斯利和谭力·童的出色表现，感谢他们花时间为比赛进行练习。也感谢APU(亚太大学)举办此次活动！这里应该有更多的反恐部队！</p><p id="374c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于APU BoH 2019的其他参与者，请随意在评论中发布您的解决方案或发布您的书面报告的链接！</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="b0e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ne">原载于2019年11月24日</em><a class="ae lk" href="https://dev.to/mfrashad/apu-battle-of-hackers-final-2019-write-ups-19ad" rel="noopener ugc nofollow" target="_blank"><em class="ne">https://dev . to</em></a><em class="ne">。</em></p></div></div>    
</body>
</html>