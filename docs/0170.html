<html>
<head>
<title>IDOR, Content Spoofing and Url Redirection via unsubscribe email in Confluent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IDOR、内容欺骗和通过unsubscribe电子邮件的Url重定向</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/idor-content-spoofing-and-url-redirection-via-unsubscribe-email-in-confluent-1fa7398cfe7a?source=collection_archive---------0-----------------------#2018-09-28">https://infosecwriteups.com/idor-content-spoofing-and-url-redirection-via-unsubscribe-email-in-confluent-1fa7398cfe7a?source=collection_archive---------0-----------------------#2018-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="5c0a" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">摘要</h1><p id="5f9a" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当我在查看我的电子邮件以退订它们时，就收到了来自confluent的邮件。在复制链接时，我发现了一个子域<a class="ae lj" href="https://sdr.confluent.io" rel="noopener ugc nofollow" target="_blank"> https://sdr.confluent.io </a>。更改id参数允许任何用户退订汇合邮件，同时允许内容欺骗，并在提交退订后重定向到主页。所以把网址从主页改成任何网站后。</p><h1 id="8432" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">背景</h1><p id="32f9" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">内容欺骗，也称为内容注入、“任意文本注入”或虚拟篡改，是一种针对用户的攻击，可能是由web应用程序中的注入漏洞造成的</p><p id="da9f" class="pw-post-body-paragraph kl km iq kn b ko lk kq kr ks ll ku kv kw lm ky kz la ln lc ld le lo lg lh li ij bi translated">当web应用程序接受不可信的输入时，开放重定向无效重定向和转发是可能的，这可能导致web应用程序将请求重定向到不可信输入中包含的URL。</p><p id="3d2f" class="pw-post-body-paragraph kl km iq kn b ko lk kq kr ks ll ku kv kw lm ky kz la ln lc ld le lo lg lh li ij bi translated">不安全的直接对象引用是指在没有任何适当的访问控制设置的情况下向用户公开对内部实现对象的引用。</p><h1 id="5a8b" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated"><strong class="ak">退订链接</strong></h1><p id="323f" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kn ir">链接</strong>:<br/><a class="ae lj" href="https://sdr.confluent.io/api/mailings/1xxxx7/unsubscribe_html?id=1xxxx7&amp;message=ALERT:%20THERE%20HAD%20BEEN%20A%20MASSIVE%20BREACH%20AT%20OUR%20DATA%20CENTER.%20KINDLY%20UNSUBSCRIBE%20AND%20RE-REGISTER%20AT%20https://xxx.org&amp;org=03cc2586-0cbc-479a-a28c-25882d14226f&amp;sig=tzKGVFwyxtfzk1KYmkZHOHWFWd4S7Bjnt-qePZ6RlmQ%3D&amp;unsubscribe_redirect_url=https%3A%2F%2Fwww.openbugbounty.org" rel="noopener ugc nofollow" target="_blank">https://SDR . confluent . io/API/mailings/1 xxxx 7/unsubscribe _ html？id = 1 xxxx 7&amp;message = ALERT:% 20 where % 20 had % 20 been % 20A % 20 massive % 20 breach % 20 at % 20 our % 20 data % 20 center。% 20 kindly % 20 unsubscribe % 20和% 20重新注册% 20 at % 20 https://XXX . org&amp;org = 03cc 2586-0 CBC-479 a-a28c-25882d 14226 f&amp;SIG = tzkgvfwyxtfzk 1 kymkzhohwfwd 4 S7 bjnt-qepz 6 rlmq % 3D&amp;unsubscribe _ redirect _ URL = https % 3A % 2F % 2 fwww . open bugbounty</a></p><p id="e2e0" class="pw-post-body-paragraph kl km iq kn b ko lk kq kr ks ll ku kv kw lm ky kz la ln lc ld le lo lg lh li ij bi translated">参数易受攻击:<br/>id = XXXXXX<br/>message = XXXXXX<br/>unsubscribe _ redirect _ URL =<a class="ae lj" href="https://examplexxx.com" rel="noopener ugc nofollow" target="_blank">https://examplexxx.com</a></p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/4d1e62c7a6ce670da2f689bdd7dcb2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bs0qJjXWrATZTSftEoVNwA.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">内容欺骗</figcaption></figure><h1 id="84d5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">无线一键通</h1><p id="811d" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">1)点击网址。<br/> 2)添加参数&amp;message = ALERT&amp;Unsubscribe _ redirect _ URL =<a class="ae lj" href="https://xxx.org" rel="noopener ugc nofollow" target="_blank">https://xxx.org</a><br/>3)点击Unsubscribe <br/> 4)它会重定向到<a class="ae lj" href="http://www.openbugbounty.org" rel="noopener ugc nofollow" target="_blank">www.xxx.org</a><br/><br/>这可能会被用于网络钓鱼攻击。</p><h1 id="627d" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">影响</h1><p id="7aea" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">任何恶意用户都可以通过简单的暴力强制id参数来取消订阅任何已订阅电子邮件的人，这可用于欺骗消息以点击取消订阅，这将重定向到恶意网站。</p><h1 id="b5d7" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">解决办法</h1><p id="522a" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">因为这是一个简单的业务逻辑错误。因此，提供id和消息字段并替换为签名，这样就不能从外部提供输入。</p><p id="9d14" class="pw-post-body-paragraph kl km iq kn b ko lk kq kr ks ll ku kv kw lm ky kz la ln lc ld le lo lg lh li ij bi translated">由于此问题是第三方问题，因为邮件在托管服务下，而不是直接在汇合下，但负责此问题的组织确认此问题已得到补救，并且已实施修复。</p><h1 id="f666" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">参考</h1><p id="52d5" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><a class="ae lj" href="https://hackerone.com/reports/201314" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/201314</a><br/><a class="ae lj" href="https://hackerone.com/reports/230328" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/230328</a><br/><a class="ae lj" href="https://www.bugcrowd.com/how-to-find-idor-insecure-direct-object-reference-vulnerabilities-for-large-bounty-rewards/" rel="noopener ugc nofollow" target="_blank">https://www . bug crowd . com/how-to-find-idor-insecurity-direct-object-reference-vulnerability-for-large-bounty-rewards/</a></p><h1 id="fc21" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">时间表</h1><p id="4c04" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">06/29/2018:发现并向融合团队报告<br/> 06/29/2018:确认Bug<br/>08/17/2018:第三方修复Bug并经融合团队确认<br/> 08/30/2018:确认公开发布<br/> 28/09/2018:发布POC</p><p id="d23e" class="pw-post-body-paragraph kl km iq kn b ko lk kq kr ks ll ku kv kw lm ky kz la ln lc ld le lo lg lh li ij bi translated">#justmorpheus</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></figure></div></div>    
</body>
</html>