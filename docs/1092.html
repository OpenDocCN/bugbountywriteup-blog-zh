<html>
<head>
<title>Abusing Two Factor Authentication</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">滥用双因素认证</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/abusing-two-factor-authentication-d26113c97607?source=collection_archive---------6-----------------------#2021-01-28">https://infosecwriteups.com/abusing-two-factor-authentication-d26113c97607?source=collection_archive---------6-----------------------#2021-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/6005c5a10e8a593647059c7d6f917ccc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kYqN1opOV_Yocvr8wx4Mtg.png"/></div></div></figure><p id="eaac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">双因素身份认证(2FA)有时也称为多因素身份认证。…增加一个身份认证步骤会使攻击者更难访问您的数据。这大大降低了欺诈、数据丢失或身份盗窃的几率。</p><p id="cedb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在这里阅读更多关于2Fa的内容</p><p id="d4cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你好黑客&amp;爱好者X0rby7e在这里，在这篇文章中，我将写如何滥用2FA的关键漏洞。让我们更多地了解一下2Fa以及如何绕过它。</p><p id="68e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我得到一个2FA的端点时，我所涉及的和我用来测试的方法</p><ol class=""><li id="0513" class="kx ky iq ka b kb kc kf kg kj kz kn la kr lb kv lc ld le lf bi translated">缺乏费率限制</li><li id="2a28" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">逻辑流程</li><li id="0c86" class="kx ky iq ka b kb lg kf lh kj li kn lj kr lk kv lc ld le lf bi translated">会话管理</li></ol><blockquote class="ll lm ln"><p id="73ba" class="jy jz lo ka b kb kc kd ke kf kg kh ki lp kk kl km lq ko kp kq lr ks kt ku kv ij bi translated"><strong class="ka ir">缺乏费率限制- </strong></p></blockquote><p id="6524" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.1缺乏验证OTP的速率限制-</p><p id="ec6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在web应用程序请求OTP的burp套件中捕获请求。现在对OTP使用入侵者暴力。有效的OTP响应返回200 OK，或者它取决于场景。只需观察长度即可检查有效长度。</p><p id="c139" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1.2发送动态口令没有速率限制-</p><p id="cceb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在web应用程序向用户发送OTP的burp套件中捕获请求。现在只需通过入侵者重复相同的请求100到200次，结果应用程序发送OTP来响应请求。影响—如果目标组织使用付费短信系统，如每条短信的一些金额，这将是组织的损失。</p><p id="0e4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.3基于cookie、IP、会话的旁路速率限制-</p><p id="a153" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">观察请求并尝试绕过他们用于速率限制的限制。IPRotate是burp suite的最佳扩展之一，它对做同样的事情很有用</p><blockquote class="ll lm ln"><p id="dc21" class="jy jz lo ka b kb kc kd ke kf kg kh ki lp kk kl km lq ko kp kq lr ks kt ku kv ij bi translated"><strong class="ka ir">逻辑缺陷- </strong></p></blockquote><p id="a02f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.1旧的OTP仍然有效</p><p id="6e00" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在刷新与新令牌关联的新动态口令后，动态口令与令牌关联，但旧的1仍然有效</p><p id="bec5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.2另一个用户可以使用动态口令</p><p id="3214" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查是否有其他用户通过同一个OTP登录。</p><p id="1a4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.3 OTP泄漏响应</p><p id="8903" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在Burp suite中捕获请求并检查每个请求的响应，有时OTP会在头中泄漏，尝试更改请求会导致OTP在错误地探索。补充。json在请求结束时导致OTP在响应中公开[并非在所有情况下]</p><p id="8f4e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.4账户锁定</p><p id="3512" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">应用程序在多次尝试后锁定帐户。</p><p id="6443" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.5玩OTP</p><p id="64c8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有一个应用程序允许我使用OTP 0000登录，在这种情况下，0000充当主密钥。</p><blockquote class="ll lm ln"><p id="2d2d" class="jy jz lo ka b kb kc kd ke kf kg kh ki lp kk kl km lq ko kp kq lr ks kt ku kv ij bi translated"><strong class="ka ir">会话管理- </strong></p></blockquote><p id="4caf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.1缺少会话失效</p><p id="92d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建一个用户id并在两个不同的浏览器中登录到同一个用户，现在在第一个浏览器中激活2FA并检查第二个浏览器会话是否仍然有效。如果这是有效的或者没有注销用户，那么在激活2FA之后就没有会话失效。</p><p id="7738" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.2缺少关于密码更改的2FA</p><p id="d90a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果激活了2FA，则更改密码功能受2FA保护。</p><p id="f666" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这完全是在滥用双因素身份认证</p><p id="1ae4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢阅读文章<strong class="ka ir">，请鼓掌并关注<em class="lo">媒体和</em></strong><a class="ae kw" href="https://www.instagram.com/x0rby7e_bug/?igshid=1q9jzd7k589n6" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="lo">insta gram</em></strong></a><strong class="ka ir"><em class="lo">。</em>T13】</strong></p></div></div>    
</body>
</html>