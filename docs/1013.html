<html>
<head>
<title>Remote Sensitive Data Exposure over *.unesco.org, thanks to Options Bleed</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">由于Options Bleed，通过*.unesco.org暴露远程敏感数据</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/remote-sensitive-data-exposure-over-unesco-org-thanks-to-options-bleed-21973b1218b6?source=collection_archive---------1-----------------------#2020-12-07">https://infosecwriteups.com/remote-sensitive-data-exposure-over-unesco-org-thanks-to-options-bleed-21973b1218b6?source=collection_archive---------1-----------------------#2020-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9a03" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">抓住一个<strong class="ak">低的</strong> - <strong class="ak">挂着多汁的水果</strong>通过选项放血</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d00a6c9987f33fcf210e627c280e53ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*q2w1UAw89YcaHCE2.jpg"/></div></div></figure><p id="fd3c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">报告日期—<strong class="kt ir">2019年7月2日</strong></p><p id="e11a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">#易受攻击的软件—Apache<br/># CVE:<a class="ae ln" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9798" rel="noopener ugc nofollow" target="_blank">CVE-2017–9798</a>/<a class="ae ln" href="https://ubuntu.com/security/notices/USN-3425-1" rel="noopener ugc nofollow" target="_blank">USN-3425–1 " options bleed "</a><br/>#类型— P1:敏感数据暴露+ P5:指纹/横幅抓取<br/> #受影响的域名— *.unesco.org <br/> #已测试—<a class="ae ln" href="https://en.unesco.org" rel="noopener ugc nofollow" target="_blank">https://en.unesco.org</a>(193.242.192.49)</p><h1 id="3b58" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">摘要</h1><p id="8bca" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">Options Bleed是Apache HTTP中的free error后的一种用法，它会导致构建一个损坏的Allow头来响应HTTP OPTIONS请求，这有助于通过错误配置的<strong class="kt ir"> server-status </strong>模块<code class="fe ml mm mn mo b">mod_status</code>来查找敏感数据的直接泄漏，其中<strong class="kt ir"> Apache </strong> web服务器会显示该模块以显示指标。</p><h2 id="6689" class="mp lp iq bd lq mq mr dn lu ms mt dp ly la mu mv ma le mw mx mc li my mz me na bi translated">再现性</h2><p id="431f" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">由于其性质，错误不会确定地出现。它似乎只出现在繁忙的服务器上。有时在多次请求后出现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/48b219f97bffc2cdaa861896644fdfe1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/0*QDGnNUsyxVwZ_u_m"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">选项出血在*.unesco.org上</figcaption></figure><h1 id="3536" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">影响</h1><p id="3474" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">任何人都可以设置一个工人，可以定期提取和枚举所有敏感文件路径。暴露的文件可以直接访问。</p><h2 id="b64a" class="mp lp iq bd lq mq mr dn lu ms mt dp ly la mu mv ma le mw mx mc li my mz me na bi translated">概念证明</h2><pre class="kg kh ki kj gt ng mo nh ni aw nj bi"><span id="e586" class="mp lp iq mo b gy nk nl l nm nn">$ curl -s https://—REDACTED—.unesco.org/server-status/<br/>—REDACTED—<br/>/system/files/private_documents/—REDACTED—<br/>/system/files/—REDACTED—.pdf<br/>[+] news/news.mbp<br/>[+] /BingSiteAuth.xml<br/>—REDACTED—</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/7ecff7b1018e99da5cc27e395bf2e2cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vrvNR4dpLeREuieU.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/a5fbee426e3006933dd96713660f342f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FFy61QMEM4y578h8.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated"><em class="nq">配置错误的UNESCO Apache </em> <strong class="bd lq"> <em class="nq">服务器-状态</em> </strong> <em class="nq">模块</em></figcaption></figure><p id="4d6d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完全敏感路径披露。你可以看看我测试时拍的一个离线<a class="ae ln" href="https://blog.0x48piraj.com/media/files/ApacheStatus.html" rel="noopener ugc nofollow" target="_blank">镜</a>。我还列举了服务器的web配置——看一下<a class="ae ln" href="https://blog.0x48piraj.com/media/files/web.config" rel="noopener ugc nofollow" target="_blank">—看看</a>。</p><h1 id="046a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly jw lz jx ma jz mb ka mc kc md kd me mf bi translated">用链条锁住</h1><p id="c1e3" class="pw-post-body-paragraph kr ks iq kt b ku mg jr kw kx mh ju kz la mi lc ld le mj lg lh li mk lk ll lm ij bi translated">泄露地址(—redated—. UNESCO . org/server-status/)泄露了与其他关键指纹数据一起运行的OS的确切版本，如泄露的<code class="fe ml mm mn mo b">mod_auth_kerb/5.4</code>和<code class="fe ml mm mn mo b">mod_prefork</code>。</p><pre class="kg kh ki kj gt ng mo nh ni aw nj bi"><span id="fe4d" class="mp lp iq mo b gy nk nl l nm nn">Server Version: Apache/2.4.18 (Ubuntu) mod_auth_kerb/5.4<br/>Server MPM: prefork<br/>Server Built: 2019–04–03T13:34:47</span></pre><p id="14af" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">知道了版本发现运行<code class="fe ml mm mn mo b">prefork</code>，也变得容易受到<a class="ae ln" href="https://nvd.nist.gov/vuln/detail/CVE-2019-0211" rel="noopener ugc nofollow" target="_blank">CVE-2019–0211</a>。由于越界数组访问导致任意函数调用，此特定Apache版本存在本地根权限提升漏洞。Apache正常重启时会触发该漏洞— <code class="fe ml mm mn mo b">apache2ctl graceful</code>。在标准的Linux配置中，<code class="fe ml mm mn mo b">logrotate</code>实用程序每天在早上6:25运行一次该命令，以重置日志文件句柄。没有测试这最后一个，因为我没有被授权作为一个客人用户上传文件。</p><p id="022d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，通过看<a class="ae ln" href="https://en.unesco.org/user/login?destination=user/password/core/includes/bootstrap.inc" rel="noopener ugc nofollow" target="_blank">https://en.unesco.org/user/login?destination = user/password/core/includes/bootstrap . Inc</a>——看起来drupal bug也存在，只是在一些waf后面。</p><blockquote class="nr ns nt"><p id="5606" class="kr ks nu kt b ku kv jr kw kx ky ju kz nv lb lc ld nw lf lg lh nx lj lk ll lm ij bi translated"><em class="iq">原载于2020年12月5日</em> <a class="ae ln" href="https://blog.0x48piraj.com" rel="noopener ugc nofollow" target="_blank"> <em class="iq">修补内核</em> </a> <em class="iq">。</em></p></blockquote><div class="ny nz gp gr oa ob"><a href="https://blog.0x48piraj.com/sensitive-data-exposure-over-unesco-org-thanks-to-optionsbleed-for-low-hanging-fruit/" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">* .unesco.org上的敏感数据暴露，感谢OptionsBleed for low-hanging fruit</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">报告日期- 02-07-2019 #易受攻击的软件-Apache # CVE:CVE-2017-9798/USN-3425-1 " options bleed " # Type…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">blog.0x48piraj.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kp ob"/></div></div></a></div></div></div>    
</body>
</html>