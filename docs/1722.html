<html>
<head>
<title>How I hacked into one of India’s biggest online book stores(RCE and more)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何黑进印度最大的网上书店之一(RCE和更多)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-hacked-into-one-of-indias-biggest-online-book-stores-rce-and-more-887ef6460935?source=collection_archive---------0-----------------------#2021-12-17">https://infosecwriteups.com/how-i-hacked-into-one-of-indias-biggest-online-book-stores-rce-and-more-887ef6460935?source=collection_archive---------0-----------------------#2021-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b50b5173562b36b1784987415feff876.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gkIdvKFZpyzR-b8zrGsIuA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Oswaal Books(oswaalbooks.com)</figcaption></figure><p id="93f1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这篇文章将讲述我是如何在印度最大的电子商务网站之一找到我的第一个RCE的。</p><p id="430a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Oswaal Books是一家非常受欢迎的公司，在印度的高中生和像JEE、NEET等竞争考试的学生中很受欢迎。他们制作指南、样卷、题库等。故事从一个简单的XSS臭虫开始。有一天，当我试图登录我的帐户时，我不小心输入了错误的密码，它显示了一条错误信息，说密码无效。我注意到的奇怪的事情是，错误消息与URL中给' errmsg '参数的输入相同。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi la"><img src="../Images/0b49917fba2db3f869ee1f4d2f299fb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rkk069RyJq-AgKqrX6AR9w.png"/></div></div></figure><p id="b3d3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于那些刚刚读过《网络黑客手册》中XSS章节前几页的人来说，他们知道该怎么做。我只是用我的XSS有效载荷替换了错误消息，并发现了另一个XSS错误。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/30032f6c4f6fe94cbb6f17bd0dbceb04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qs4ZnMzRhe90cdK3hSwboA.png"/></div></div></figure><p id="bacd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">几个月后，当我再次在网站上闲逛时，我决定回到这里。这个错误现在已经修复，我编辑了我的个人资料，看到有一个成功的消息，但这也是来自“errmsg”参数。在这里做了XSS测试，得到了一个。我意识到“errmsg”参数在很多地方都有使用。我在域上运行了waybackurls，过滤了所有带有“errmsg”参数的查询。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/0805c66b9472d56b8618b039cfc8a1e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6qdHprTc0jOO-NG4KTF1ig.png"/></div></div></figure><p id="f3f5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你仔细观察这些链接，你会发现我不仅发现了多个易受XSS攻击的链接，我还发现了一个秘密登录页面，这是我使用目录暴力无法找到的(URL 1)。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lh"><img src="../Images/9b432881df3afa1fae0f59584dfb9aa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IXeSWNc55Acm-B6UnnukOQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">后端管理面板</figcaption></figure><p id="2ad9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我非常兴奋地看着这个页面，并尝试了所有基本的教科书方法，如试图绕过验证码(失败)，响应代码操作(失败)，默认凭证(失败)。最后一个选择是尝试SQLi，但这是一个漫长的尝试，因为它在主网站的任何地方都不工作。我还意识到我只尝试过基于GET的SQLi，所以我决定使用基于POST的SQLi。</p><pre class="lb lc ld le gt li lj lk ll aw lm bi"><span id="ff6a" class="ln lo iq lj b gy lp lq l lr ls">Try 1:<br/>user = admin’<br/>pass = test</span></pre><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/69e6d51ad033d0412e54f0ed681f7f5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUjbpZ3TOKA9-zTCJK_MVg.png"/></div></div></figure><p id="febb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">而错误被触发了！</p><pre class="lb lc ld le gt li lj lk ll aw lm bi"><span id="4749" class="ln lo iq lj b gy lp lq l lr ls">Try 2:<br/>user = admin’ OR 1=1 -- <br/>pass = test</span></pre><p id="a1d7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">还有…..我是网站管理员！！！</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/5bb5a5d7e8bbbeb8605c46dc57fe67e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYuRlRmcUMeW6axKXSoREQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">仪表盘</figcaption></figure><p id="ca8f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">权限:<br/> 1)更改密码<br/> 2)编辑会员详细信息<br/> 3)查看订单并篡改其设置(取消订单、发起退款等)<br/> 4)编辑书籍详细信息(甚至价格)<br/> 5)编辑博客、新闻等<br/> 6)在主站点上查看从门户网站上传的简历。<br/> 7)编辑SEO设置<br/> 8)查看私人客户信息(地址、电话号码等)</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/5bdc6280f061edef4b73d7452166c534.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xGNp1RbeMJ5mR7jF8qd5ZA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户详细信息</figcaption></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/64789d802b9c78f1419b606b99fd5dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wCrwL3bGaBcvrMKSP1C-3w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">篡改订单的能力</figcaption></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/ca851ecc62af876ccf19cb66949e30ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wDjOrPlP_8RHR5XqqPqwDQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">客户发票</figcaption></figure><p id="a90a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">继续前进，进入管理面板是可以的，但我想看看我是否能做得更多。有了所有的新功能，我现在有更大的机会去做像RCE这样的大事。我浏览了面板并导航到管理博客部分。我选择了一个旧的和有缺陷的博客进行测试。我去了编辑区，试图篡改照片上传部分。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/2607f2909b6a73e8d1a7792f73614b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9ZJcbsQqHo1iLc7Wqyjig.png"/></div></div></figure><p id="0956" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">方法:</p><ol class=""><li id="3048" class="ly lz iq ke b kf kg kj kk kn ma kr mb kv mc kz md me mf mg bi translated">我首先尝试上传一张样本照片，看看文件是否被重命名，但没有(win 1)</li><li id="a7f9" class="ly lz iq ke b kf mh kj mi kn mj kr mk kv ml kz md me mf mg bi translated">尝试查看它接受哪些扩展名(。php、. php5、. php4、.phtml，. php.jpg没起作用)</li><li id="0051" class="ly lz iq ke b kf mh kj mi kn mj kr mk kv ml kz md me mf mg bi translated">已尝试查看mime类型是否会触发任何警报。</li><li id="2bc6" class="ly lz iq ke b kf mh kj mi kn mj kr mk kv ml kz md me mf mg bi translated">最后将扩展名改为。“PhP”完成了这项工作</li></ol><p id="9ff7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">开始了…</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/5690dc443d2e48e296ff44f407895ce6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yz1MaeJ2_kYsbk1-06qvvg.png"/></div></div></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="1084" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Bug 2:价格操纵【P2】</strong></p><p id="2be3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个bug的灵感来自Infosec评论页面上的另一篇文章(现在找不到链接，如果你知道的话，请在评论中提到它)。所有产品都与产品ID相关联，因此我无法通过编辑请求来更改价格。然而，我可以编辑数量，所以我决定在那里放一个负整数，这是错误2…</p><pre class="lb lc ld le gt li lj lk ll aw lm bi"><span id="122e" class="ln lo iq lj b gy lp lq l lr ls"><strong class="lj ir">Case 1:</strong><br/>Price: Rs 1000<br/>Quantity: 1<br/>Subtotal: 1000 x 1 = Rs 1000</span><span id="9614" class="ln lo iq lj b gy mu lq l lr ls"><strong class="lj ir">Case 2:</strong><br/>Price: Rs 1000<br/>Quantity: 2<br/>Subtotal: 1000 x 2 = Rs 2000</span><span id="091f" class="ln lo iq lj b gy mu lq l lr ls"><strong class="lj ir">Case 3:</strong><br/>Price: Rs 1000<br/>Quantity: 3<br/>Subtotal: 1000 x -2 = Rs -2000</span></pre><p id="c490" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果购物车价值为负(例如:2000卢比)，我将无法逆转交易过程，也无法从购物车价值为负的客户账户中提取金额，就像我有一张优惠券一样。所以我可以把我的购物车装满我想要的所有产品，直到我达到最小购物车值。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/f105a18811dbb79197dd7ffa20520731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPHTt8dDkOM9oXsqwtCYgg.png"/></div></div></figure><p id="1185" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">3本书和总额Rs。0(这可能不适用于所有情况，您可能需要满足最小购物车值才能继续)。</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="af4b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Bug 3:跨站请求伪造【P3】</strong></p><p id="9af2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里不需要太多的解释。事实是，CSRF代币没有被用于任何地方，甚至是敏感的行动。</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="e64c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Bug 4:通过响应代码操作绕过认证【P3】</strong></p><p id="8cd7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此漏洞存在于主登录页面上。输入我的号码后，我选择用我的OTP登录。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/4f843c4467d6c75c45412c93f77a0117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*umpsZovSm6HVJbUfs02-bA.png"/></div></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/bc892498c21d0824d9eb88d6fbdf2883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VrH5QfavKgF6wkx3HdFpeg.png"/></div></div></figure><p id="251a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然后我输入一个测试OTP并截取响应。我得到的回答是“2”。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/cfe5116b5fd33bfaebd1c26020b27d34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Abx1D_J3Z3nhV0mnRPjy6w.png"/></div></div></figure><p id="0a34" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里我只是猜测(通常您会添加正确的OTP并查看正确的响应，然后尝试用错误的OTP复制它，以查看是否可以绕过身份验证)，并决定将响应更改为“1”。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/f9aa90911bd361b248b78843b680555a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m0ZxPbe-xfZdbObdGPxVRg.png"/></div></div></figure><p id="f799" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是第四个错误…</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/244553fa76b2dba1be9464a6c5a6a3a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0hSQVfWWQnBXP40vS0544Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">(在没有正确OTP的情况下登录到测试帐户)</figcaption></figure></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="3866" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">超越捕虫</strong></p><p id="4fe7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公司，尤其是拥有大量用户的公司，需要理解安全性的重要性。上述方法是用于笔测试(我会说这就像玩CTF)和bug搜索的一些最基本的方法。我只需要几个步骤就能进入网站。敏感的细节可能会被泄露，有害的事情，如网站污损也是可能的。这不仅会影响公司或其品牌价值，还会影响信任它的用户。这就是为什么权力越大，责任越大。公司需要对客户信任的数据负责。</p><blockquote class="nb nc nd"><p id="5637" class="kc kd na ke b kf kg kh ki kj kk kl km ne ko kp kq nf ks kt ku ng kw kx ky kz ij bi translated">网络安全服务可能很昂贵，但你的用户的信任和安全值得每一分钱。</p></blockquote><p id="7d26" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">报道日期:2021年9月29日</p><p id="2a6e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">修补日期:2021年12月17日</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="1e04" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你也是/曾经是一名印度高中生，使用过他们的产品并喜欢这篇文章，请随时鼓掌，在Medium和Twitter上关注我。</p><p id="0413" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">推特:<a class="ae nh" href="https://twitter.com/vikaran101" rel="noopener ugc nofollow" target="_blank">https://twitter.com/vikaran101</a></p><p id="a668" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">谢谢你。</p></div></div>    
</body>
</html>