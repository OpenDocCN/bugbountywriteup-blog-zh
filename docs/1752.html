<html>
<head>
<title>Bug Hunting Journey of 2021</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2021年的捕虫之旅</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bug-hunting-journey-of-2021-1fa60b28d949?source=collection_archive---------0-----------------------#2021-12-31">https://infosecwriteups.com/bug-hunting-journey-of-2021-1fa60b28d949?source=collection_archive---------0-----------------------#2021-12-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7a60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，大家好，</p><p id="532f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望每个人都有一个愉快的黑客年，我今年没有分享任何文章，所以我想我应该写一篇文章，在那里我将讨论我今年主要在<em class="kl"> Hackerone </em>平台上发现的大多数错误。所有的bug都是在打嗝、浏览器和大脑的帮助下人工发现的</p><p id="89ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将是类似的博客，就像我以前已经做过的:</p><div class="km kn gp gr ko kp"><a href="https://sudhanshur705.medium.com/bug-hunting-journey-of-2019-95e5190aca7c" rel="noopener follow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">2019年的捕虫之旅</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">嘿，大家好，</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">sudhanshur705.medium.com</p></div></div><div class="ky l"><div class="kz l la lb lc ky ld le kp"/></div></div></a></div><p id="272a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今年，我不再使用任何脚本来查找bug，而是完全依靠我的手工黑客技能来查找bug。我没有去追子域，而是直接去追主应用程序。</p><p id="d61b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，你可以说，今年我没有走得更远，而是更深入地了解了目标。</p><p id="3598" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不得不在我的方法上做许多改变，因为以前我只是使用脚本，从终端进行黑客攻击，现在我必须浏览目标，了解它是如何工作的，然后尝试破解它。</p><p id="6fb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会说谎，我当时用的是<em class="kl"> Burpsuite破解版</em>，是的，你没听错，是LarryLau那个。我做的第一件事就是把破解版倒掉，只用社区版。</p><p id="eb55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我现在意识到，我真的不需要它，但我不知道为什么我会使用它，因为我开始做bug狩猎，可能是因为我从youtube等网站上获得的任何<em class="kl">视频概念验证/教程</em>也在使用破解版本，所以我一直认为要擅长bug狩猎，你需要<em class="kl"> BurpSuite pro </em>。</p><p id="50bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">我决定转储破解版是因为</em> : </strong></p><p id="4e52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能已经知道他了:</p><div class="km kn gp gr ko kp"><a href="https://in.linkedin.com/in/rootxharsh" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">Harsh Jaiswal - Bug bounty参与者- HackerOne | LinkedIn</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">查看Harsh Jaiswal在世界上最大的职业社区LinkedIn上的个人资料。Harsh列出了4项工作…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">in.linkedin.com</p></div></div><div class="ky l"><div class="lf l la lb lc ky ld le kp"/></div></div></a></div><p id="a4ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Harsh非常擅长发现服务器端的bug，如果你看过他的视频POC，你可能会注意到他使用的是Burp社区版本，这改变了我的想法，你不需要这个专业工具来发现bug，你只需要积累正确的技能和经验。</p><p id="f3dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一条来自s0md3v的推文(我找不到了:(现在)，他在那里跟别人说，你不要用破解版。Portswigger 为社区、实验室(网络安全学院)、研究论文等做了很多事情，都是免费的，所以你不应该以这种方式背叛他们。使用社区版本，它有你需要的所有东西。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="513d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一路走来，我可以免费访问这些令人敬畏的网站来提高我的技能:</p><p id="8ebe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我从@zseano发起的CTF挑战赛中赢得的:)</p><div class="km kn gp gr ko kp"><a href="https://www.bugbountyhunter.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">成为bug赏金猎人-了解web应用程序漏洞以及如何在…</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">新的或有经验的，了解各种漏洞类型的定制web应用程序的挑战基于真实的错误…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">www.bugbountyhunter.com</p></div></div><div class="ky l"><div class="ln l la lb lc ky ld le kp"/></div></div></a></div><p id="7526" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢Snyff和Codingo的慷慨捐赠。</p><div class="km kn gp gr ko kp"><a href="https://pentesterlab.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">PentesterLab:学习Web渗透测试:正确的方法</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">例如，我们在JSON Web Token (JWT)上面临十几个挑战，因为JWT引入了非常有趣的漏洞…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">pentesterlab.com</p></div></div><div class="ky l"><div class="lo l la lb lc ky ld le kp"/></div></div></a></div></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="ae38" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">现在开始研究虫子</h2><p id="25a5" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">刚开始的时候很难，因为我是新手，要处理很多信息丰富的报告。我的报告没有显示出任何影响，所以它们都被关闭了。但是我一直在提交</p><p id="127e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那段时间，我看到了一些披露的报告，来自:</p><div class="km kn gp gr ko kp"><a href="https://hackerone.com/logitech?type=team" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">罗技- Bug赏金计划| HackerOne</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">罗技Bug Bounty计划在HackerOne上寻求黑客社区的帮助，以使罗技更加安全…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div><div class="ky l"><div class="mn l la lb lc ky ld le kp"/></div></div></a></div><div class="km kn gp gr ko kp"><a href="https://hackerone.com/automattic" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">自动虫赏金程序|黑客龙</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">Automattic Bug Bounty计划在HackerOne上寻求黑客社区的帮助，以使automatic更加安全…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div><div class="ky l"><div class="mo l la lb lc ky ld le kp"/></div></div></a></div><p id="ca3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我想我应该试一试，看看被披露的错误是否真的得到了修复，或者我是否可以绕过现有的保护措施。</p><p id="8bb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在streamlabs.com呆了很长时间，这在罗技bbp的资助范围内:</p><div class="km kn gp gr ko kp"><a href="https://streamlabs.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">Streamlabs | #1面向实时流媒体和游戏玩家的免费工具集</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">Twitch、YouTube和脸书最受欢迎的流媒体平台。基于云，并被70%的Twitch使用。与…一起成长</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">streamlabs.com</p></div></div><div class="ky l"><div class="mp l la lb lc ky ld le kp"/></div></div></a></div><p id="b7de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">起初我很犹豫要不要猎取它们，因为<em class="kl">细流实验室</em>非常受欢迎，但我还是尝试了</p><p id="7862" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">找到一个<strong class="jp ir"> <em class="kl">存储的xss </em> </strong>，这真的很容易找到:)，这是一种自我xss，因为这个页面只能从我的仪表板上查看。后来，我发现我们可以邀请其他用户加入我们的仪表板，所以我在报告中添加了这一点</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/0a534681dd9ccce52c677ac61a1681a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SzCY6Dt1t3pUFjNPWG6tAA.png"/></div></div></figure><div class="km kn gp gr ko kp"><a href="https://hackerone.com/reports/1049012" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">罗技在HackerOne上披露:存储XSS在...</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">嘿，我在下面的目标设置页面中发现了一个存储的xss漏洞。```…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div><div class="ky l"><div class="nb l la lb lc ky ld le kp"/></div></div></a></div><p id="052b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我发现了一个<strong class="jp ir"> <em class="kl"> csrf vuln </em> </strong>影响了大部分端点，</p><p id="fa45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然在请求中有一个<em class="kl"> csrf头</em>，但是它根本没有被服务器验证，所以在测试应用程序时，我只是移除了这个头，瞧，它仍然工作。但是有一个问题，<em class="kl"> Content-Type </em>头被正确验证，所以它必须被设置为<code class="fe nc nd ne nf b">application/json </code>，所以我不能创建<em class="kl"> csrf poc </em>，因为它将触发CORS飞行前请求。</p><p id="3f34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我检查了所有的端点，找到了一个接受<code class="fe nc nd ne nf b">text/plain</code>的端点</p><div class="km kn gp gr ko kp"><a href="https://hackerone.com/reports/1049360" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">罗技在HackerOne上披露:CSRF在改变用户...</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">嘿，我发现,“API/V6/viewer-portal/viewer-settings/donation _ settings”端点容易受到…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div><div class="ky l"><div class="ng l la lb lc ky ld le kp"/></div></div></a></div><p id="d3be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要为<code class="fe nc nd ne nf b">JSON</code>请求创建一个CSRF poc，我们需要添加一个额外的填充。在下面的截图中，你可以看到我添加了一个额外的<em class="kl">键，值</em>对(高亮部分),这将确保<em class="kl">请求体</em>是有效的json数据</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nh"><img src="../Images/4dbd793d5f71a9da39ae5d91dddfca64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JeQ7ZhVIpnPDZipf1yWJcQ.png"/></div></div></figure><p id="321e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想了解更多关于JSON CSRF概念验证的信息，请阅读Geekboy的这篇文章:</p><div class="km kn gp gr ko kp"><a href="https://www.geekboy.ninja/blog/tag/json-csrf/" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">极客|安全研究员</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">对于第一种情况，在某些情况下，服务器可能会因为额外的数据填充而拒绝请求，但是…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">www.geekboy.ninja</p></div></div><div class="ky l"><div class="ni l la lb lc ky ld le kp"/></div></div></a></div><p id="a1a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此期间，我发现了罗技的最后一个bug，<strong class="jp ir"> Streamlab </strong>提供了许多只有<em class="kl"> Prime会员</em>才能使用的功能。</p><p id="90d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有突出显示的端点都需要<em class="kl"> Prime订阅</em>。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mq"><img src="../Images/19ee8d5bcad1cf9dd24007bafd3f0900.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2SGeOZk2nh88K3cTHc1ZJg.png"/></div></div></figure><p id="018b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在浏览不同的请求/响应时，我发现这个端点非常有趣:</p><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="f965" class="lp lq iq nf b gy nn no l np nq"><a class="ae nr" href="https://streamlabs.com/api/v5/user/prime/subscription" rel="noopener ugc nofollow" target="_blank">https://streamlabs.com/api/v5/user/prime/subscription</a></span><span id="8962" class="lp lq iq nf b gy ns no l np nq"><strong class="nf ir">Reponse</strong>:</span><span id="2095" class="lp lq iq nf b gy ns no l np nq">{<br/>  "is_active": false,<br/>  "is_pending": false,<br/>  "is_past_due": false,<br/>  "is_canceled": false,<br/>  "is_pro": false,<br/>  "type": "",<br/>  "free_trial_claimed": false,<br/>  "hibernate_claimed": false,<br/>  "free_trial_eligible": false,<br/>  "hibernate_eligible": false,<br/>  "cooldown_eligible": false,<br/>  "cooldown_seconds_past": null<br/>}</span></pre><p id="84c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一切都被设置为false，所以我决定使用<em class="kl">打嗝的匹配和替换</em>规则将响应体中出现的所有false替换为true</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nt"><img src="../Images/a91fbf35559ff5a052b9262d95f8d513.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X9xCcr0prbgxPP6_F1n_-g.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk translated">打嗝匹配和替换</figcaption></figure><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="03ca" class="lp lq iq nf b gy nn no l np nq"><strong class="nf ir">Type</strong>: Response Body <br/><strong class="nf ir">Match</strong>: false <br/><strong class="nf ir">Replace</strong>: true</span></pre><p id="111e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我只是好奇，想看看应用程序是否真的依赖<em class="kl">客户端验证</em>来检查用户是否有Prime订阅。</p><p id="5134" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">令我惊讶的是，它真的起作用了。</p><p id="9e27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Prime订阅最有趣的部分是你可以得到免费的东西，比如t恤、鼠标等等</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ny"><img src="../Images/855fa6e9172c55e5c0c4eecd207deab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dN0gIeo13iZ_zAiYRhWiJQ.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk translated">在应用匹配和替换规则之前</figcaption></figure><p id="072d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在看看应用匹配和替换规则后的屏幕截图:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ny"><img src="../Images/64177c5ff97932974ae5d3d56eb1a27c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*my-_3GZ7px1_EO9bku-Pww.png"/></div></div></figure><p id="af95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了实际确认它是否工作，我点击了<strong class="jp ir"> <em class="kl">确认</em> </strong>按钮，它要求输入一个电子邮件地址:</p><p id="8c89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我在收件箱中收到的确切电子邮件:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi nz"><img src="../Images/29040031148c7edcbcaa8f45fc9004cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GDeze0aJpiDlPkc21xG8g.png"/></div></div></figure><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oa"><img src="../Images/3aa0b26c1ab346bbee42d8515fc0c83b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-wOdnpfbiS-1_o0hyiwAkA.png"/></div></div></figure><p id="87d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">免费购买罗技鼠标的优惠券代码</p><p id="81b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我告诉他们这个影响:</em></p><p id="2e5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过创建1000个帐户，我可以获得1000份礼物，礼物是一个罗技游戏鼠标，平均价格约为30美元。因此，1000个罗技游戏鼠标的成本将是30 * 1000 = 30，000美元。我可以免费得到这一切</p><p id="33f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能导致公司的财务损失，但他们仍然降低了严重性:(</p><div class="km kn gp gr ko kp"><a href="https://hackerone.com/reports/1070510" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">罗技在HackerOne上披露:操纵响应导致...</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">Heyy团队，我发现了一个很酷的bug，它允许我免费访问streamlabs的主要功能。这里是api…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div><div class="ky l"><div class="ob l la lb lc ky ld le kp"/></div></div></a></div></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="0e66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我参加了h1-ctf，这是在今年的最后一周，所以我能够得到许多免费邀请私人节目。我决定更多地关注私有程序，因为我有更好的机会在那里找到有效的bug。</p><p id="aa3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我发现的大部分错误都在私人程序中，所以大部分东西都会以<strong class="jp ir">编辑</strong>的形式出现。</p><h2 id="b7b4" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">BUG: XSS导致账户被接管</h2><p id="8271" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">我从几个月前开始的一个项目开始，它完全是新的，没有太多的提交，响应时间非常有吸引力，所以我决定尝试一下。</p><p id="a13e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个网站上四处逛了一会儿后，我现在对这个应用程序的工作原理及其提供的所有功能有了一些了解。该应用程序基本上类似于<strong class="jp ir"> <em class="kl"> TryHackme </em> </strong>平台。</p><p id="411a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我查看了cookie政策:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oc"><img src="../Images/7bdf11e80aaffd6531e92443b17f9257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kCr5U-OORn3D7P6V0O9jCw.png"/></div></div></figure><p id="89fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以看到cookie的范围被设置为<code class="fe nc nd ne nf b">.example.com</code></p><p id="b685" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着所有的子域也将拥有与<code class="fe nc nd ne nf b">example.com</code>相同的cookie，所以如果我能够在一个子域上找到xss，这将允许我轻松地窃取受害者的cookie。这个应用程序有趣的地方在于，所有易受攻击的挑战都托管在<code class="fe nc nd ne nf b">example.com</code>的子域上</p><p id="9a7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设有一个xss挑战赛，那么它将被托管在一个子域<code class="fe nc nd ne nf b">xss-challenge.example.com</code></p><p id="c47c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我使用了<code class="fe nc nd ne nf b">xss-challenge.example.com</code>子域(已经有一个xss漏洞)来证明通过xss窃取其他用户的会话cookies是可能的。我告诉他们将cookies的范围更改为一个域，或者使用一些沙盒域来主持挑战。</p><p id="9275" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该问题已被分类并奖励为<code class="fe nc nd ne nf b">HIGH</code>严重性漏洞:)</p><h2 id="14a2" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak"> <em class="od">进入下一个节目，……..</em>T9】</strong></h2><p id="aa1a" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">该程序已有2-3年历史，提交率很高，排名第一的黑客的声誉为<em class="kl"> 1500+ </em></p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/9f22b7db0cecd955a9e292bbe5b2aaeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*sxAnEbNMuxU7J6uNx79SZg.png"/></div></figure><p id="0b46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看这个程序的统计数据，你可以肯定地说，得到一个bug的副本的机会非常高，因为他们平均要花<em class="kl"> 1年来修复</em>一个问题，我仍然决定试试这个程序。</p><h2 id="d761" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">BUG:多重CSRF</h2><p id="6efe" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">发现了一个<strong class="jp ir"> <em class="kl"> csrf漏洞</em> </strong>，它允许我更改受害者的登录电子邮件地址。这很容易导致帐户接管漏洞。我很快报告了该漏洞，正如所料，它是重复的。</p><p id="2e61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我发现了更多的<em class="kl"> csrf </em>漏洞，比如<em class="kl">更改申请人的名字</em>以及许多其他低严重性<em class="kl"> csrf </em>漏洞。我决定不报告它们，因为它们可能已经被报告过了(<em class="kl">因为我已经重复了一次高严重性csrf vuln </em>)，我不想在它们上面浪费时间。</p><p id="5956" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几天后，当我在同一个目标上没有发现任何其他错误时，我想他妈的，我会报告那些低严重性的错误，看看会发生什么。</p><p id="6061" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在晚上和第二天早上，当我检查我的邮件时，这些报告中有一些活动，我想是的，所有这些都因为重复而被关闭，我已经知道了，但当我打开邮件时，我发现所有这些都被筛选并得到了奖励，这是我完全没有想到的。</p><p id="e6d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经报告了4-5个csrf错误，所以我决定寻找更多类似的错误。识别这些易受攻击的请求非常容易，因为其中没有csrf令牌</p><p id="d13a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总的来说，我能够找到大约10个csrf错误，没有重复的，都得到了奖励。那时我很有动力去寻找更多的项目。</p><h2 id="ed70" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">BUG: IDOR</h2><p id="58f5" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">然后，我检查了范围中提到的其他域，在一个应用程序中，我可以看到大多数基于<strong class="jp ir"> <em class="kl"> GET </em> </strong>的请求中都有参数<code class="fe nc nd ne nf b">company_id</code>。所以我测试了他们的IDOR vuln，很快就发现了一个泄露了一些受害者公司信息的IDOR，我报告了这个IDOR，它被作为重复关闭:(</p><p id="dd3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之前我特别提到过，只有基于<em class="kl"> GET的请求</em>才有那个<code class="fe nc nd ne nf b">comapny_id</code>参数，基于<strong class="jp ir"> <em class="kl"> POST </em> </strong>的请求(比如更改个人资料设置、公司设置)没有这个参数</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi of"><img src="../Images/3f218b499af941f07e048708ce5ec66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8KXlDsSaiMVlKP5he7287g.png"/></div></div></figure><p id="fc7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然<em class="kl"> GET Based IDOR </em> report得到了副本，但这个没有。这是审判和奖励为<code class="fe nc nd ne nf b">High</code>严重性。</p><p id="afa9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你正在寻找一个收集的IDOR bytes签出这个网站:</p><div class="km kn gp gr ko kp"><a href="https://book.hacktricks.xyz/pentesting-web/idor" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">伊多尔</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">清单-本地Windows权限提升</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">book.hacktricks.xyz</p></div></div><div class="ky l"><div class="og l la lb lc ky ld le kp"/></div></div></a></div></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="ecf2" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">错误:通过SVG文件上传和2个旁路存储XSS</h2><p id="9bb0" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">现在我要告诉你一个我感觉被欺骗的经历，是的，这经常发生，不是所有的节目都好，所以确保你选择了正确的一个:)</p><p id="30d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过文件附件上传在这个程序中发现了一个存储的xss错误，它基本上是一个松弛型应用程序。</p><p id="50af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上传的文件存储在s3桶中，例如:<code class="fe nc nd ne nf b">xmessenger-attachments.s3.amazonaws.com</code>，</p><p id="635d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样上传的文件也可以从目标<code class="fe nc nd ne nf b">attachments.example.com</code>的子域访问</p><p id="3485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我上传了一个svg文件，内容如下:</p><figure class="mr ms mt mu gt mv"><div class="bz fp l di"><div class="oh oi l"/></div></figure><p id="815b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上传文件的url是这样的:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oj"><img src="../Images/8b56a922ca826d67a349a9c872cce7ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KDMlJgthzHZxvhgEKGGdQQ.png"/></div></div></figure><p id="5ba6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在目标的一个子域上有一个xss，如果你不是急性子，我在文章的开始就讲过这个:)</p><p id="182f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我检查了<em class="kl"> cookie范围策略</em>，在这里也发现了同样的事情<code class="fe nc nd ne nf b">.example.com</code>，这次在cookie中有一个<em class="kl"> jwt令牌</em>，它在所有api端点和其他子域中用于认证目的。</p><p id="41e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与此同时，我检查了<em class="kl">更改密码请求</em>，发现它不需要当前密码<em class="kl">。</em></p><p id="d7f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一次，我发现了一些东西，可以轻松地让我改变受害者的密码，并接管他们的帐户。</p><p id="de65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在报告中特别提到了这一点:</p><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="5226" class="lp lq iq nf b gy nn no l np nq">We can create a javascript code which will first steal the victim's jwt token , then sends a request to the change password endpoint using the stolen jwt token, which will eventually allows us to takeover the victim's account. If you need a actual POC for this let me know, I am not providing it along the report as it will take time</span></pre><p id="47a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该计划的响应时间很长，所以我在提交报告后几个小时内就收到了响应，结果是这样的:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ok"><img src="../Images/57db3d31152a39b24662626ffd025a38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wHrSIWETkRpgDwuhmyF3wA.png"/></div></div></figure><p id="d2df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种情况来来回回发生了2-3次，然后我什么也没说，因为他们每次都告诉我相同的答案，他们已经知道cookie政策，并正在尽最大努力保护它们。它被奖励为一个<code class="fe nc nd ne nf b">Medium</code>的严重程度，这有点糟糕，因为影响远高于此。</p><p id="6687" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便说一句，猜猜我刚刚检查了什么，即使他们不断努力，饼干的政策仍然是一样的。</p><p id="5b5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大约一周后，问题得到了解决。</p><p id="ac30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我当时只是想检查一下修复，发现了一个非常简单的旁路:)</p><p id="c228" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是上传附件的请求</p><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="5991" class="lp lq iq nf b gy nn no l np nq">POST /graphql HTTP/2<br/>Host: x.example.com<br/>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0<br/>Authorization: Bearer Redacted<br/>Content-Type: application/json<br/>Content-Length: 59</span><span id="883e" class="lp lq iq nf b gy ns no l np nq">{<br/>  "operationName": "uploadFile",<br/>  "variables": {<br/>    "fileType": "image/svg+xml",<br/>    "cId": "1490072"<br/>  },<br/>  "query": "mutation uploadFile($cId: ID!, $fileType: String!) {\n  uploadFile(cId: $cId, fileType: $fileType)\n}\n"<br/>}<br/></span></pre><p id="37c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">修复后，如果文件的<code class="fe nc nd ne nf b">Content-Type</code>是<code class="fe nc nd ne nf b">image/svg+xml</code>，应用程序不接受该文件，所以为了绕过它，我尝试了不同的<em class="kl">内容类型</em>的文件，如<code class="fe nc nd ne nf b">image/svg , text/html</code>等，我发现<code class="fe nc nd ne nf b">text/xml</code>是允许的，xss弹出窗口再次出现。</p><p id="d446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">程序启用了<strong class="jp ir"> <em class="kl">复检</em> </strong>，但他们在第一份报告中没有要求我这样做，所以我提交了一份新报告。</p><p id="1c22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们确认了搭桥手术，我再次获得了相同数额的奖金。</p><p id="4e03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于<strong class="jp ir"> <em class="kl">已解决</em> </strong>，再次应用了新的修复，报告关闭。这一次也没有要求<strong class="jp ir"> <em class="kl">重新测试</em> </strong>。</p><p id="ac2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">激发我打嗝检查修复，现在随着<code class="fe nc nd ne nf b">image/svg+xml</code>它也不接受<code class="fe nc nd ne nf b">text/xml</code>。在幕后，他们可能有一个白名单过滤器，只接受少数<code class="fe nc nd ne nf b">content-type</code>，如<code class="fe nc nd ne nf b">text/plain</code>和其他常见的。</p><div class="km kn gp gr ko kp"><a href="https://github.com/BlackFan/content-type-research/blob/master/XSS.md" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">master black fan/content-type-research/XSS . MD</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">内容型研究。在GitHub上创建一个帐户，为black fan/内容类型研究的发展做出贡献。</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">github.com</p></div></div><div class="ky l"><div class="ol l la lb lc ky ld le kp"/></div></div></a></div><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi om"><img src="../Images/55aacf402a01b33d3fba710cb99330f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b0JuiIMBnZtrT8vVaL1CpA.png"/></div></div></figure><p id="9cc5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">fileType:text/html(xxx</code>、<code class="fe nc nd ne nf b">fileType:text/html,xxx</code>等</p><p id="0b2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了所有这些方法，看看应用程序是否允许它们中的任何一个，但是没有一个有效。</p><p id="3b67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我得出结论，应用程序从<strong class="jp ir">上传文件的扩展名</strong>中验证了<em class="kl">内容类型</em>:如果我上传一个文件名为<code class="fe nc nd ne nf b">test.txt</code>的文件，那么<strong class="jp ir"> <em class="kl">文件类型</em> </strong>参数值将是<em class="kl">上传请求</em>中的<code class="fe nc nd ne nf b">text/plain</code>。于是我上传了<code class="fe nc nd ne nf b">xss.svg</code>文件，并将<strong class="jp ir"> <em class="kl">文件类型</em> </strong>参数值从<code class="fe nc nd ne nf b">image/svg+xml</code> ( <em class="kl">不允许</em>)改为<code class="fe nc nd ne nf b">image/png</code> ( <em class="kl">允许</em>)，文件上传成功</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi on"><img src="../Images/9db07c021c3cbd8e26de151182622a7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R4xAN14-8aq9EH_DOqBUkA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk translated">上传文件的Url</figcaption></figure><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="93ae" class="lp lq iq nf b gy nn no l np nq">HTTP/2 200 OK<br/><strong class="nf ir">Content-Type: image/svg+xml</strong><br/>Content-Length: 416<br/>Date: Mon, 27 Dec 2021 05:14:36 GMT<br/>Last-Modified: Wed, 01 Sep 2021 04:52:51 GMT<br/><strong class="nf ir">Content-Disposition: inline; filename="xss2.svg"</strong><br/>Accept-Ranges: bytes<br/>Server: AmazonS3</span><span id="a29c" class="lp lq iq nf b gy ns no l np nq">&lt;?xml version="1.0" standalone="no"?&gt;<br/>&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "<a class="ae nr" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>"&gt;<br/>&lt;svg version="1.1" baseProfile="full" ae nr" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg" width="240px" height="240px"&gt;<br/>   &lt;polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/&gt;<br/>   &lt;script type="text/javascript"&gt;<br/>      alert(document.cookie);<br/>   &lt;/script&gt;<br/>&lt;/svg&gt;</span></pre><p id="1f52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">做了一个新的报告，他们验证了旁路，并奖励了我(金额与之前的相同)。</p><p id="1deb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而且这次他们要求复试:)</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oo"><img src="../Images/998e6a85f66cb39ac9036565cc959dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0yxIXQ8h7b2D_glqzVyIA.png"/></div></div></figure><p id="1368" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我确认了他们的修复，发现这次没有旁路，他们这次做得很好。但是等等，故事并没有就此结束。</p><p id="c1b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">故事的转折来了。</em> </strong></p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi op"><img src="../Images/d4faea58f97294fd7077a28694895729.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrIjPkdxafPsEpDMMEMikw.png"/></div></div></figure><p id="f0cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我再次检查了这个bug，这一次它是可复制的，我根本不相信，我告诉他们是的，我只是试着复制它，发现它仍然在那里。遗憾的是，我没有任何用于<strong class="jp ir"> <em class="kl">复试</em> </strong>的视频概念验证，所以我无法证明在我检查之前这是不可重现的。</p><p id="ee8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一周后，他们推出了一个补丁，当我检查时，我可以看到<em class="kl">上传请求</em>中的差异:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi oq"><img src="../Images/b2a0a0a072631967f8629ab94f3bbfb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3mefiPxAQTLYA9jvOM29Yw.png"/></div></div></figure><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="acb9" class="lp lq iq nf b gy nn no l np nq">POST /graphql HTTP/2<br/>Host: x.example.com<br/>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0<br/>Authorization: Bearer Redacted<br/>Content-Type: application/json<br/>Content-Length: 59</span><span id="a2c1" class="lp lq iq nf b gy ns no l np nq">{<br/>  "operationName": "uploadFile",<br/>  "variables": {<br/>    "fileType": "image/svg+xml",<br/>    <strong class="nf ir">"fileName":"xss2.svg",</strong><br/>    "cId": "1490072"<br/>  },<br/>  "query": "mutation uploadFile($cId: ID!, $fileType: String!) {\n  uploadFile(cId: $cId, fileType: $fileType)\n}\n"<br/>}</span></pre><p id="6ba5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正文中增加了一个新参数<code class="fe nc nd ne nf b">fileName</code>。现在应用程序正在验证文件名<em class="kl">和文件<code class="fe nc nd ne nf b">content-type</code>。</em></p><p id="fdd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的截图中，你可以看到<strong class="jp ir"> <em class="kl">复试</em> </strong>被拒绝，所以我告诉他们，我没有得到<strong class="jp ir"> <em class="kl">复试</em> </strong>的50美元，因为它被拒绝了。这是他们的回答:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi or"><img src="../Images/30ffb4be2804f5a6a0e2a3e66692eed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iNoVkdeJP2Xycv-_ssdfaQ.png"/></div></div></figure><p id="96fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就在那时，我决定再也不黑他们的程序了，顺便说一句，黑客仍然显示我在复试中赚了50美元，这有点可笑。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi os"><img src="../Images/ac24628bd87126c3f11578b271bd99e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qm6ZzJfa7JBuP8kriFDVMQ.png"/></div></div></figure><blockquote class="ot ou ov"><p id="6a7a" class="jn jo kl jp b jq jr js jt ju jv jw jx ow jz ka kb ox kd ke kf oy kh ki kj kk ij bi translated">永远要小心像这样的程序，在Frans Rosen的一次演讲中，他告诉我们，当开始入侵一个新程序时，他只发送几个低悬的错误报告，实际上是为了发现这个程序是否值得他花费时间。他不想把宝贵的时间花在一个他们不尊重黑客，不把安全当回事的程序上。</p></blockquote></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="bf15" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak"> BUG:通过api端点泄露私有注释</strong></h2><p id="238c" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">我现在要讲的这个bug真的非常简单，没有太大的影响，但是仍然相对容易找到。</p><p id="a705" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个已经运行了4-5年的项目，所以它不希望如此容易地找到这样的东西。该应用程序是一个文件共享平台，用户可以上传文件并与其他用户共享。</p><p id="18bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个功能允许任何用户为他们的文件设置密码，如果任何人想访问它，他们需要提供密码。除了文件之外，所有者还可以发送一条注释，只有当最终用户提供正确的密码时，他们才可以看到。</p><p id="90bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我拿起共享链接，在我的浏览器中打开它，检查加载该url后发出的所有请求，第一个请求是向<code class="fe nc nd ne nf b">/api</code>端点发出的。</p><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="956a" class="lp lq iq nf b gy nn no l np nq"><a class="ae nr" href="https://example.com/api/file/v1/info?hash=xxxxxxxxxxxxxxxxx" rel="noopener ugc nofollow" target="_blank">https://example.com/api/file/v1/info?hash=xxxxxxxxxxxxxxxxx</a></span></pre><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/24457486226653654001007e82142c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*aEU8MsZzkUBq9M8jkj1YgA.png"/></div></figure><p id="4384" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在响应中，您可以看到一个<code class="fe nc nd ne nf b">description</code>字段，其中包含随文件一起附加的注释，这不应该在响应中公开。</p><p id="a006" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想这是不可能发生的，我又在匿名窗口打开了同一个网址，并在打嗝监测请求。发现了同样的反应。</p><p id="56fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我决定报告它，我有一种强烈的感觉，这可能已经被报告了，因为它是如此明显，你只需要加载url并观察响应，很容易的错误，对不对？</p><p id="148e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，没有其他人报告说它被归类并奖励为一个<code class="fe nc nd ne nf b">LOW </code>严重性漏洞，甚至在报告它几个小时后就被修复了。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="2e73" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">错误:只需知道电子邮件地址就可以禁用任何用户的帐户</h2><p id="5f6f" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">现在准备好，我要讲一个非常有趣的bug，它很容易发现，但也有很大的影响</p><p id="a769" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很久以前我被邀请参加这个项目，但在那段时间里我没有发现任何有趣的事情，有人透露了他们的发现，是关于在主示波器上发现的一个<strong class="jp ir"> <em class="kl">全文阅读ssrf </em> </strong> bug。我真的被这个bug惊呆了，所以我决定花更多的时间在这个程序上，看看我能找到什么。</p><p id="6802" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你入侵一个新程序时，你可以设定一些目标，比如我会尽最大努力提交这个程序的至少一个有效的bug，即使你没有发现任何bug也没关系。一些目标很难，并且具有非常好的安全态势。继续尝试一些不同的项目，比如社交媒体网站、B2B应用程序、零售网站等等，找到最适合你的。</p><p id="e948" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到bug，…</p><p id="773d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我有点喜欢寻找<em class="kl">不适当的访问控制</em>、<em class="kl">权限提升</em>错误，要找到这样的错误，你需要更深入地挖掘应用程序，了解不同的用户角色是如何定义的，只有管理员的权限才能执行什么操作，等等</p><p id="e771" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我测试的应用程序是一个<em class="kl">商家门户</em>，店主可以在那里控制他们的零售店。我们也可以邀请其他用户加入我们的<em class="kl">商家门户。</em></p><p id="051f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我通过输入<em class="kl">电子邮件地址</em>邀请了另一个用户，邀请电子邮件被发送到该用户的电子邮件地址，现在被邀请的用户可以访问商家门户并根据其<code class="fe nc nd ne nf b">Role</code>执行操作</p><p id="f2cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">访问控制设置得非常强大，我在任何端点都找不到任何错误配置。</p><p id="e4f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到管理员界面，我注意到我们可以执行一些操作，比如更改被邀请用户的<em class="kl">用户名等</em></p><p id="2b7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将名称改为其他名称，然后访问被邀请用户的个人资料，更改成功完成。那一刻我意识到当我邀请用户时，收到了一封邀请邮件，上面有<strong class="jp ir"> <em class="kl">邀请确认链接</em> </strong>，我正确地记得我没有点击它。</p><p id="95db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你还没有弄明白，我来告诉你这里出了什么问题。应用程序不验证<em class="kl">被邀请用户</em>是否确实确认了<em class="kl">邀请请求</em>。<em class="kl">邀请用户</em>直接添加到<em class="kl">商家门户。</em></p><p id="beb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要知道一些人的<em class="kl">电子邮件地址</em>，我就可以邀请他们到我的<em class="kl">商家门户</em>，然后可以更改他们的<strong class="jp ir"> <em class="kl">用户名(名，姓)</em> </strong>，根本不需要任何用户交互。</p><p id="1da3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尽快提交了这个，几个小时后，我发现我完全错过了一些东西。我能做的不仅仅是改变被邀请用户的用户名。我可以<em class="kl">在他们的acc上启用2fa，禁用登录</em></p><p id="7d01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">被邀请的<em class="kl">用户</em> <strong class="jp ir"> <em class="kl">将永远无法登录</em> </strong>到他的账户，直到我将他从我的<em class="kl">商家门户</em>中移除</p><p id="e0ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发给他们的确切答复，包括进一步的细节:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pa"><img src="../Images/eecc1c37e68cf2424992352b1cbe1030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*unkcZ9TP_alnoxSbSKwRgQ.png"/></div></div></figure><p id="7e33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几天后，我收到了报告的以下更新:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pb"><img src="../Images/72a2edd931eb1b3c4134d4c3329af310.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CYUSNajlWBpsM8PPgvdhYg.png"/></div></div></figure><p id="ae64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很快升级了:)</p><p id="da89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一个我想测试的范围，但是提供的凭证不起作用，所以在同一个报告中，我问他们是否可以研究这个问题。他们在几个小时内回复了新的一对信用记录，我现在准备看看另一个范围。</p><p id="fae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个与<em class="kl">商家门户</em>完全不同的应用程序</p><p id="3e64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在查看它的所有功能时，我注意到了一个我已经在<em class="kl">商家门户</em>中见过的类似的<code class="fe nc nd ne nf b">User Management</code>端点</p><p id="7404" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定在这个端点上也检查同样的错误，结果成功了！！！！！！！！！</p><p id="9566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">唯一的问题是，除了更改受害者的名字(<em class="kl">名，姓</em>)之外，我不能执行任何其他操作。其他选项如<em class="kl">启用2fa，禁用登录</em>在这里不起作用。</p><p id="abe1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于这是一个与我已经报告的问题非常相似的问题，我决定询问<em class="kl">项目经理</em>我应该做什么来提交一份新的报告(因为两个应用程序可能共享相同的代码库，所以只需要一次修复)。</p><p id="efc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">program-manager</code>告诉我写一份新的报告，然后他们会核实。</p><p id="979b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后他们也因为这篇报道而受到奖励:)</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pc"><img src="../Images/05c5e0b8dfeabb3359f3dda4444cadb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*14a6pq_reUegf9ztkH86MQ.png"/></div></div></figure><p id="f1f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我真的很喜欢参与这个项目，因为他们反应非常快，<code class="fe nc nd ne nf b">program-manager</code>也非常好。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="8b17" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak"> <em class="od"> BUG: CSRF在邀请用户动作中</em> </strong></h2><p id="179c" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">这是一个相当新的私人项目，在2-3个月前启动，但是有很多人提交了申请，看起来非常活跃。和以前一样，这个应用程序也是一个<em class="kl">商业门户</em>。</p><p id="f444" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我花了很少的时间来理解应用程序，然后开始处理请求。在诸如(<strong class="jp ir"> <em class="kl"> POST、PUT、DELETE </em> </strong>)的状态更改请求中，有许多自定义头与<code class="fe nc nd ne nf b">X-CSRF-Token</code>头一起使用。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pd"><img src="../Images/109e11788718f086b5cf1836c05806e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z5e9Tz3eiTdTxTS5-wHYzg.png"/></div></div></figure><p id="61f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看到如此多的自定义标题以及<code class="fe nc nd ne nf b">X-Nonce</code>和<code class="fe nc nd ne nf b">X-CSRF-Token</code>，任何人都不会费心去寻找CSRF错误，对吗？</p><p id="6ec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我删除了<code class="fe nc nd ne nf b">X-CSRF-Token</code>并转发了请求，仍然成功。然后我想他们肯定会验证其他的<em class="kl">自定义标题</em>。我一个接一个地删除了<em class="kl">自定义标题</em>，但是请求仍然成功。哇，所以他们甚至没有验证这些头。</p><p id="6e11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我需要确认最后一件事，应用程序是否接受<code class="fe nc nd ne nf b">text/plain</code>作为请求主体的<code class="fe nc nd ne nf b">Content-Type</code>，它成功了:)</p><p id="ac95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了一个poc并验证了它，然后提交了报告，再次怀疑它可能会重复，因为这很容易找到。</p><p id="e0d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个站点范围的csrf问题，它影响了所有端点，最敏感的端点是我在上面的<strong class="jp ir"> <em class="kl">邀请用户操作、</em> </strong>中显示的那个端点，因此我在报告中以它为例来演示其影响。</p><p id="764b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二天，我收到了团队的回复，我没想到会是这样的回复。看到他们对这份报告的反应，我非常惊讶:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pe"><img src="../Images/e06ab0466bface804da061f38ce67989.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jg_Q9QH3Ao1O-_c-G0eJFw.png"/></div></div></figure><p id="311a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我会解释他第二次回复的<code class="fe nc nd ne nf b">program-manager</code>是什么意思，以确认csrf的bug。我创建了一个<code class="fe nc nd ne nf b">csrf.html</code>文件，并将<em class="kl"> csrf poc代码</em>保存在那里</p><p id="c433" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下内容类似于您在<em class="kl">细流实验室的csrf </em>概念验证案例中看到的内容</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pf"><img src="../Images/695070be4593684f8d98374aad2c00af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpMY-PgPtXWXsSFWlm9Z8A.png"/></div></div></figure><p id="6544" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我刚刚在我的浏览器中打开了<code class="fe nc nd ne nf b">csrf.html</code>文件，所以url类似于<code class="fe nc nd ne nf b">file:///Directory/csrf.html</code>，在<strong class="jp ir"> <em class="kl"> Firefox </em> </strong>中，如果请求是从<code class="fe nc nd ne nf b">file</code> URI发出的，没有<em class="kl">来源</em>头被发送。如果你在Chrome等其他浏览器中尝试同样的操作，你会注意到发送了<code class="fe nc nd ne nf b">Origin: null</code>头。</p><p id="0dfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">服务器接受没有<code class="fe nc nd ne nf b">Origin </code>头的请求</p><p id="2fd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你读过我几天前分享的这篇文章，你可能已经知道如何处理<code class="fe nc nd ne nf b">Origin</code>头。</p><div class="km kn gp gr ko kp"><a rel="noopener  ugc nofollow" target="_blank" href="/story-of-a-weird-csrf-bug-bde1129c106e"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">一只奇怪的CSRF虫子的故事</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">嘿，大家好，</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">infosecwriteups.com</p></div></div><div class="ky l"><div class="pg l la lb lc ky ld le kp"/></div></div></a></div><p id="27e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用相同的技巧<code class="fe nc nd ne nf b">iframe</code> <em class="kl">数据uri </em>创建了一个poc，并使用现在工作的poc更新了报告。</p><p id="79b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很快<code class="fe nc nd ne nf b">program-manager</code>验证了这份报告</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ph"><img src="../Images/01e2bc92ebf2391b25f290d6137479f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WeufhSRGtD-oROXA9GADsw.png"/></div></div></figure><p id="a68c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我同意他们的推理，甚至没有想到会有这么多，所以我真的很感激他们。。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="a897" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak"> BUG:通过打开重定向窃取vitcim的access _ token</strong></h2><p id="54ce" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">每个bug猎人都应该做的一件事是在<strong class="jp ir"> Hackerone </strong>上阅读关于<em class="kl">黑客攻击</em>的公开报道</p><div class="km kn gp gr ko kp"><a href="https://hackerone.com/hacktivity" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">哈克龙</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">编辑描述</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hackerone.com</p></div></div></div></a></div><p id="5c24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想更进一步，那就试着重现这个错误，确认它是否真的被修复了。</p><p id="7e27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里有一个图表来解释我想说的:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pi"><img src="../Images/11da54658b0f42bb2f5013a89bc1267c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6fpI3cuCyDwV725g2HyoA.png"/></div></div></figure><p id="6c0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是图表的一个示例:</p><p id="f6b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一份报告在<em class="kl">黑客事件</em>中被披露</p><div class="km kn gp gr ko kp"><a href="https://hackerone.com/reports/1178239" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">罗技在HackerOne上披露:通过开放协议接管会话...</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">摘要:嗨，罗技团队，在streamlabs.com的端点…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">hacker one . com rff</p></div></div><div class="ky l"><div class="pj l la lb lc ky ld le kp"/></div></div></a></div><p id="cd0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从报告中，我了解了一个端点:</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pk"><img src="../Images/fdcbabf45d8a55d80cb3710792402e02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIRU4wGsrojPbac_PiyHsg.png"/></div></div></figure><p id="c626" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击者控制了url的<code class="fe nc nd ne nf b">protocol</code>部分，他们将其描述为<em class="kl">开放协议重定向</em>而不是<em class="kl">开放重定向</em>，因为他们没有对url的完全控制。只是<code class="fe nc nd ne nf b">protocol</code>部分。</p><p id="83e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">修复后，<code class="fe nc nd ne nf b">protocol</code>被验证，现在它只接受http &amp; https。我不确定记者是否试图通过<code class="fe nc nd ne nf b">javascript:</code>将<em class="kl">开放协议重定向</em>升级到xss，因为他们对协议部分xss可能有完全的控制权。</p><p id="a843" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只有<code class="fe nc nd ne nf b">streamlabs.com</code>子域被列入白名单，如果我尝试使用任何其他网址，如<code class="fe nc nd ne nf b">example.com</code>，将会抛出一个错误。我也尝试了一些变化<code class="fe nc nd ne nf b">xstreamlabs.com</code>、<code class="fe nc nd ne nf b">streamlabs.co.in</code>等，看看它是否有效。</p><p id="0ff3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于什么都不工作，我只是想在<em class="kl"> wayback machine </em>中搜索这个端点，看看我是否能找到任何其他也在白名单中的域。</p><div class="km kn gp gr ko kp"><a href="https://github.com/lc/gau" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">GitHub - lc/gau:从AlienVault的开放威胁交换、Wayback机器和…</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">getallurls (gau)从AlienVault的开放威胁交换、Wayback Machine和Common Crawl中获取已知的URL</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">github.com</p></div></div><div class="ky l"><div class="pl l la lb lc ky ld le kp"/></div></div></a></div><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="1a70" class="lp lq iq nf b gy nn no l np nq">https://streamlabs.com/global/identity?r=https://darthvapes.tv https://streamlabs.com/global/identity?r=https://dragynslair.live/ https://streamlabs.com/global/identity?r=https://franmg.net/merch https://streamlabs.com/global/identity?r=https://itzyony2.com https://streamlabs.com/global/identity?r=https://lmgtwitch.com https://streamlabs.com/global/identity?r=https://maitresharinganv1.com https://streamlabs.com/global/identity?r=https://themavshow.tv https://streamlabs.com/global/identity?r=https://veterangamertv.com https://streamlabs.com/global/identity?r=https://www.koopatroop.com https://streamlabs.com/global/identity?r=https://www.lokenplays.com https://streamlabs.com/global/identity?r=https://yagurlbubblezl4d.com</span></pre><p id="aa35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由此，我能够找到更多的白名单域:</p><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="c5aa" class="lp lq iq nf b gy nn no l np nq">dragynslair.live <br/>darthvapes.tv <br/>nixxiom.tv</span></pre><p id="d7be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一个经过验证的用户访问这个url，他的<code class="fe nc nd ne nf b">access_token </code>将被发送到<code class="fe nc nd ne nf b">dragynslair.live</code>域:<a class="ae nr" href="https://streamlabs.com/global/identity?r=https://dragynslair.live/" rel="noopener ugc nofollow" target="_blank">https://streamlabs.com/global/identity?r = https://dragynslair . live/</a></p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pm"><img src="../Images/1619659cd8adb98bd1355fd2e23478d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Kqa-hx9Ta4aG5t5EFIJOw.png"/></div></div></figure><p id="3d6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个特殊域名最有趣的地方在于它可以注册</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pn"><img src="../Images/32ce5e2c6de97c289f2251d52f550326.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pIXPCbEgB2aJtAPqyRUl1Q.png"/></div></div></figure><p id="67ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了证明我的声明，我在我的<code class="fe nc nd ne nf b">/ect/hosts</code>文件中为<code class="fe nc nd ne nf b">dragynslair.live</code>添加了一个条目，这将允许我在不实际购买域名的情况下确认它</p><p id="5ce5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个截图中，你可以看到<code class="fe nc nd ne nf b">access_token</code>被发送到我的服务器。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi po"><img src="../Images/658c60a497e9a6cf9a68bfea86a1a43f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C5nLpitONn6GQwMbZ5gAmw.png"/></div></div></figure><p id="6f84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b">access_token</code>可用于以下端点:</p><div class="km kn gp gr ko kp"><a href="https://dev.streamlabs.com/reference" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">/授权</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">使用Streamlabs API，您可以访问用户的Streamlabs帐户的各个方面，甚至触发自定义警报…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">dev.streamlabs.com</p></div></div></div></a></div><p id="3422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">团队就像上次一样降低了严重性，没有任何解释，根据我过去在这个项目中的经验，我已经知道这将会发生</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="eba1" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated">错误:XSS过滤器旁路</h2><p id="3140" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">在该计划中明确提到，如果您发现任何<em class="kl"> waf </em>绕过eg，如<em class="kl"> xss </em>，他们将视报告为<code class="fe nc nd ne nf b">HIGH</code>严重性，并给予相应奖励。</p><p id="9aef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个应用程序有很多功能，所以我能够找到一个有趣的端点，在那里输入被传递到<code class="fe nc nd ne nf b">window.location</code>接收器。</p><p id="d077" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">过滤器的工作方式是这样的:如果我输入<code class="fe nc nd ne nf b">javascript:alert()</code>，它会像这样结束</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/a2b8e553bc6127a2d065cb2840889707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*ujuuVa_Db-ey5k9rKFNXbw.png"/></div></figure><p id="6952" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试过大写的<code class="fe nc nd ne nf b">JAVASCRIPT</code>，混合大写和小写的<code class="fe nc nd ne nf b">JaVaSCript</code>，但是同样的事情发生了。</p><p id="6ff7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我在<strong class="jp ir"><em class="kl">Portswigger XSS cheat sheet</em></strong>上查找更多方法:</p><div class="km kn gp gr ko kp"><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">跨站点脚本(XSS)备忘单- 2021版|网络安全学院</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">这个跨站点脚本(XSS)备忘单包含许多可以帮助你绕过WAFs和过滤器的向量。你可以…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">portswigger.net</p></div></div><div class="ky l"><div class="pq l la lb lc ky ld le kp"/></div></div></a></div><pre class="mr ms mt mu gt nj nf nk nl aw nm bi"><span id="4095" class="lp lq iq nf b gy nn no l np nq">j&amp;#x61vascript:alert(1)<br/>&amp;#X6A;avascript:alert(1)<br/>javascript&amp;colon;alert(1)<br/>java&amp;Tab;script:alert(1)<br/>java&amp;NewLine;script:alert(1)<br/>javascript&amp;colon;alert&amp;lpar;1&amp;rpar;</span><span id="5ce9" class="lp lq iq nf b gy ns no l np nq">.............</span></pre><p id="cdb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我开始寻找其他博客，偶然发现有效载荷中有<em class="kl">十六进制转义序列</em>，这对我的目标有效，我可以绕过过滤器</p><p id="dd3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nc nd ne nf b"><em class="kl">\x61</em></code> <em class="kl">代表一个</em></p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pr"><img src="../Images/4859ff938041cf6215866a75a6d5c7e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0PCqzPioeNMz-w12vP6DA.png"/></div></div></figure><p id="d90e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它被归类并奖励为<code class="fe nc nd ne nf b">High</code>严重性漏洞。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><h2 id="0850" class="lp lq iq bd lr ls lt dn lu lv lw dp lx jy ly lz ma kc mb mc md kg me mf mg mh bi translated"><strong class="ak"> BUG </strong>:存储XSS</h2><p id="6425" class="pw-post-body-paragraph jn jo iq jp b jq mi js jt ju mj jw jx jy mk ka kb kc ml ke kf kg mm ki kj kk ij bi translated">我将讨论最后一个严重程度最高的错误，也是迄今为止我得到的最高奖励。</p><p id="967d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个超级新的节目，我可以说我是最先被邀请的人之一。</p><p id="aa17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经从另一个新程序那里得到了非常糟糕的体验，我在那里提交了许多错误，例如<em class="kl">存储的xss，csrf，访问控制错误</em>甚至一个bxss在他们的管理面板中触发。他们开始一个接一个地关闭报告，因为<em class="kl">信息&amp;副本</em>声明<em class="kl"> csrf、访问控制、xss错误</em>是<strong class="jp ir">站点范围的</strong>，所以他们将只奖励第一个突出问题的报告。</p><p id="911b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我也和同一个项目的其他人谈过，他们都说了同样的话<code class="fe nc nd ne nf b">site-wide</code>，他们的报告也因为重复而被关闭。几个月过去了，他们甚至没有支付任何有效的错误的奖励。</p><p id="8b19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对我来说，不要过多参与新项目是一个很好的教训。</p><p id="5ecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到新的私人程序，由于过去的经验，我很犹豫要不要在这个程序上打猎，但我还是尝试了，这个应用程序类似于Twitch，我们可以在那里做流媒体。</p><p id="8c3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户资料是公开的，我们可以添加任何<em class="kl"> spotify嵌入代码</em>，然后将显示给其他用户。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi ps"><img src="../Images/e7716aeec08cc01a76bdf4da3c280764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KVFugnSieTKNIZ4csfmv5Q.png"/></div></div></figure><p id="9cef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的截图中，你可以看到一个嵌入代码的例子，顺便说一句，如果你在开始听这个可怕的播客之前从未听说过<strong class="jp ir"><em class="kl">【Darknet Diaries】</em></strong>。相信我，你会喜欢的:)</p><div class="km kn gp gr ko kp"><a href="https://darknetdiaries.com/" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">黑暗网络日记-来自互联网黑暗面的真实故事。</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">一个播客，讲述来自互联网黑暗面的真实故事。</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">darknetdiaries.com</p></div></div><div class="ky l"><div class="pt l la lb lc ky ld le kp"/></div></div></a></div><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pu"><img src="../Images/c6a16a0c2b6d90ae05172b1f1c1f7d56.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cQDlZgNr4wozbPzLIGtsgQ.png"/></div></div></figure><p id="0b47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序将这个<em class="kl"> iframe代码</em>嵌入到用户的配置文件中，我开始测试是否可以利用这个功能，并向其中添加我自己的任意代码。</p><p id="668b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我首先从一个简单的有效载荷<code class="fe nc nd ne nf b">&lt;img src=x onerror=alert()&gt;</code>开始，错误返回了无效的<strong class="jp ir"> <em class="kl"> Spotify嵌入代码，</em> </strong>然后我尝试了各种其他标签，但似乎只允许使用frame。</p><p id="0a97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我开始玩src属性，如果我能把它改成<code class="fe nc nd ne nf b">src=javascript:alert()</code>，我会有一个容易的xss错误，但是收到了同样的错误，不是有效的<strong class="jp ir"> <em class="kl"> Spotify嵌入代码。</em> </strong></p><p id="b810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我想过使用<code class="fe nc nd ne nf b">srcdoc</code>属性，但是也没成功</p><div class="km kn gp gr ko kp"><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-srcdoc" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">:内嵌框架元素- HTML:超文本标记语言| MDN</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">HTML元素表示嵌套的浏览上下文，将另一个HTML页面嵌入到当前页面中。每个嵌入式…</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">developer.mozilla.org</p></div></div><div class="ky l"><div class="pv l la lb lc ky ld le kp"/></div></div></a></div><p id="1bed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">过了一段时间，我想为什么不在事件处理器上添加一个<em class="kl">来触发src加载，我将这个<em class="kl">属性</em>添加到嵌入代码<code class="fe nc nd ne nf b">onload=alert()</code></em></p><p id="4c84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而且成功了！！我可以看到xss弹出窗口，这个xss在我的公共配置文件中。因此，如果任何其他用户访问我的网站，xss将被触发。</p><p id="86ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很快提交了这个问题，等待他们的回应。当处理这样的新程序时，确保你不要浪费时间尽快报告错误，以确保你不会重复，我已经从其他一些程序中学到了这个教训。</p><p id="7dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们的响应时间真的很快，他们把这个xss奖励为<code class="fe nc nd ne nf b">HIGH</code>严重性漏洞。</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi pw"><img src="../Images/b1b37bcae429cf37185854cf0ce211ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jnRGJB7Yc_CPsmC30Btnew.png"/></div></div></figure><p id="6ae8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我环顾四周，注意到该应用程序允许用户通过谷歌/脸书登录，然后我还找到了我们可以<em class="kl">添加/删除谷歌/Facebook帐户的设置，</em></p><p id="8189" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在想，利用xss漏洞，我可以很容易地接管受害者的帐户，就像我在一些文章中看到的那样。</p><p id="ddfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向他们解释了这一点，他们证实了我的说法</p><figure class="mr ms mt mu gt mv gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi px"><img src="../Images/b3345905519651dff49475f05a30535b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Zp5qzTN6aWwkLyI-qdrcA.png"/></div></div></figure><p id="5122" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们总共奖励了我3200美元的<code class="fe nc nd ne nf b">Critical</code></p><p id="1df5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我得到的最高奖励，所以我真的很开心。</p><p id="6622" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今年我开始玩ctf只是为了网络挑战，你会得到挑战的源代码，因为我不擅长源代码审查，做这个CTF挑战让我克服了我的弱点。此外，挑战作者通常会使用一些你想在其他地方找到的观察技术。</p><p id="3032" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以如果你想提高你的网络黑客技能，开始玩一些有高评分的CTF吧。</p><p id="1d65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以从这里了解即将推出的CTF:</p><div class="km kn gp gr ko kp"><a href="https://ctftime.org/event/list/upcoming" rel="noopener  ugc nofollow" target="_blank"><div class="kq ab fo"><div class="kr ab ks cl cj kt"><h2 class="bd ir gy z fp ku fr fs kv fu fw ip bi translated">CTFtime.org/关于CTF的一切(夺旗)</h2><div class="kw l"><h3 class="bd b gy z fp ku fr fs kv fu fw dk translated">捕捉旗帜，CTF队，CTF评级，CTF档案馆，CTF报道</h3></div><div class="kx l"><p class="bd b dl z fp ku fr fs kv fu fw dk translated">ctftime.org</p></div></div></div></a></div></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="9088" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道这真的是一篇很长的文章，我希望你在读完这篇长文章后不会感到无聊，并从中学到一两件事。</p><p id="90e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这些，非常感谢你一直读到最后。希望你会喜欢它。</p><p id="71cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝2022年好运:)</p><p id="eb96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好</p></div></div>    
</body>
</html>