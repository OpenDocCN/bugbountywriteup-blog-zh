<html>
<head>
<title>SANS Holiday Hack (Kringlecon) 2020 Write-up— Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SANS Holiday Hack(kring lecon)2020报道—第3部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/sans-holiday-hack-kringlecon-2020-write-up-part-3-5cdb627363ae?source=collection_archive---------3-----------------------#2021-01-21">https://infosecwriteups.com/sans-holiday-hack-kringlecon-2020-write-up-part-3-5cdb627363ae?source=collection_archive---------3-----------------------#2021-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="acc4" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这是我的SANS Holiday Hack文章的最后一部分，涵盖了目标9-11。</p></blockquote><p id="8d2c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><a class="ae ks" href="https://medium.com/bugbountywriteup/sans-holiday-hack-kringlecon-2020-write-up-part-1-82041d094b01" rel="noopener">第一部</a> / <a class="ae ks" href="https://medium.com/bugbountywriteup/sans-holiday-hack-kringlecon-2020-write-up-part-2-617e1870ed2e" rel="noopener">第二部</a></p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/8d9097ce12fea842ac958d12a4282f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*6FGQLhuhln306_9w_7mOOA.png"/></div></figure><h1 id="a539" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">(圣诞老人)目标9 — ARP欺骗</h1><p id="c0da" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">目标:去屋顶的网络战争房间，帮助雪花石膏雪球使用ARP协议访问主机。在<code class="fe me mf mg mh b">/NORTH_POLE_Land_Use_Board_Meeting_Minutes.txt</code>检索文档。谁回避了文件上描述的投票？</p><p id="d130" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">1.这样做的总体目标是将ARP和DNS欺骗结合起来，将HTTP流量发送到您的计算机，然后使用该流量插入恶意的。deb文件并获取受害者电脑的文件。</p><blockquote class="jn jo jp"><p id="5e09" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">ARP和DNS欺骗都使用Scapy来拦截和调整传入的数据包</p><p id="760e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">有效的ARP和DNS请求/响应存储在/pcaps文件夹中</p><p id="6450" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">模板scapy脚本保存在/scripts文件夹中</p></blockquote><p id="3f8d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2.我做的第一件事是创建一个小的助手python脚本来读取所提供的/pcaps并输出scapy信息，以便对我的响应进行建模。这为我们提供了需要加载到响应中的值，特别是第二个包，也就是响应。</p><pre class="ku kv kw kx gt mi mh mj mk aw ml bi"><span id="aece" class="mm lc iq mh b gy mn mo l mp mq">from scapy.all import *</span><span id="b6d7" class="mm lc iq mh b gy mr mo l mp mq">packets = rdpcap('arp.pcap')<br/>for packet in packets:<br/>  print(packet.show())</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/2dd01b92e0057b29ec190fabba9850d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*v7Xv3fpZ0zJTTPR7HjQQyA.png"/></div></figure><p id="9886" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.当调整ARP/DNS scapy脚本时，最好对进入的数据包本身使用动态值，而不是硬编码。还必须翻转source和dest，因为我们正在回复传入的数据包</p><p id="6ee1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.Arp欺骗</p><p id="0309" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我从提供的脚本中删除了p和hwlen，因为不需要它们，并调整了其他值以匹配提供的arp包或正确的返回位置。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="36d9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">5.当它在一个窗口中运行时，应该会看到对<code class="fe me mf mg mh b">ftp.osuosl.org</code>的DNS请求开始通过。还需要返回一个DNS欺骗来将数据包定向到我们的机器。和以前一样，我阅读了提供的正确的DNS包，并根据那里的响应模拟了我的包。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/55b72a79bae4ef1ed2358d244c43b1b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*YkrK1xaHVa70bmdOFHeMxA.png"/></div></figure><p id="f1c4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">对于这一个，困难的部分是正确地形成dns响应片段，必须添加相当多的片段。确保您的响应与您查看的提供的数据包完全匹配。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0af0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">6.准备就绪后，应该会开始看到HTTP流量。启动HTTP服务器会显示发送的请求。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/2971a401fdf113779ff6951f9cfeb0d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1aR1RIpfbh9buWJomWOg_w.png"/></div></div></figure><p id="94da" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">7.现在我制造了一个恶意的。deb文件，遵循这里的指南:<a class="ae ks" href="http://www.wannescolman.be/?p=98" rel="noopener ugc nofollow" target="_blank">http://www.wannescolman.be/?p=98</a></p><p id="8536" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我们所需要做的就是将代码放入DEBIAN/postinst文件夹，并构建我们自己的deb文件。转到tmp并创建一个与所请求的相匹配的目录结构</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/e162f1383ca0ebb9aa6a9229b6d416d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*3rm8ChpWp7N-RlHJpxeYmQ.png"/></div></figure><p id="575d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">从~/debs文件夹中复制socat deb并将其拆分，使用tar拉出控制结构</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/91a706707c346d63a4e1aa68cc755cc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*bYvGQ734VT_ldd4SLW4PYQ.png"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3a3a246a5f98e54549c81be35c5e14df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*TzU2D0HWRHOBdITIFHfg7Q.png"/></div></figure><p id="e039" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在后门文件夹中创建一个work/DEBIAN文件夹，并将控制文件移入其中。创建反向shell或命令，我打算用socat文件读取。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/c043875a61980bcad0d06f54762801fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*AaaPYXn5aCIE7t7EOjqq8w.png"/></div></figure><p id="88bb" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">设置权限，构建和重命名文件。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nf"><img src="../Images/f1510e505467702af8a1f9b6c90883dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aFSAVjSj0NouOQvEQimkKg.png"/></div></div></figure><p id="6314" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">回到tmp，设置socat监听器并启动HTTP服务器。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/aec198f06d363da2bf45efe54a21086e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*M2Ga4_A8OStxyPHc6aCFPg.png"/></div></figure><p id="10ea" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">文件应该保存到本地机器。答案是坦塔·克林果</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/429c5227b2de8189d12ca64e17a53243.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*qNfdxA2TDyeUPN3UxXP3mw.png"/></div></figure></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="23d9" class="lb lc iq bd ld le np lg lh li nq lk ll lm nr lo lp lq ns ls lt lu nt lw lx ly bi translated">电梯(红色、绿色、黄色)—目标10</h1><p id="62c5" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">再多种方法解决，这是我的。作为圣诞老人，你应该可以通过指纹识别器进入圣诞老人的办公室。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7ad366b3b5c0aa92e98589d14cc445e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*gnZToy-HyYDXtyQbsx5reA.png"/></div></figure><h1 id="1f0f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">目标10 —电梯旁路</h1><p id="dbec" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">目的:绕过Santavator指纹传感器。不带圣诞老人的指纹进入圣诞老人的办公室。</p><p id="82f3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">为了这个目标，你需要离开圣诞老人的身份，穿过挂在门厅的画。另外，我发现所用的技术只在Chrome上有效，所以我推荐使用它。</p><p id="4cd8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">1.作为普通玩家进入电梯，确保三盏灯都亮着。</p><p id="b7cf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2.按F12，打开电梯源代码，我们关心的部分在这里:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/13856e23400779b0a573625b6a9c58b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:990/format:webp/1*v9VMJm7NtOkmT9qkH4sXig.png"/></div></figure><p id="689c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">关键的拦截器是令牌“贝桑塔”</p><p id="4f63" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.在F12菜单中打开开发者控制台，并在开发者控制台中将上下文设置为电梯。使用Javascript将besanta令牌添加到列表中。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nw"><img src="../Images/194bf8496629b7f65f15818a5ce69750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adFKSzAkxluUUbeCk15l9A.png"/></div></div></figure><p id="61f4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.现在试试指纹扫描仪，即使不是圣诞老人也能工作。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="d758" class="lb lc iq bd ld le np lg lh li nq lk ll lm nr lo lp lq ns ls lt lu nt lw lx ly bi translated">圣诞老人办公室-目标11a/11b</h1><p id="8fa1" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">圣诞老人的办公室只包含一个项目，最后的11a/11b目标。</p><h1 id="499b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">(Santa)目标11a —区块链调查第1部分</h1><p id="77ce" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">目标:即使您拥有的区块链块以块129996结尾，您能预测块130000的随机数吗？与扬声器无准备室的Tangle Coalbox交流预测技巧，与Tinsel Upatree交流更多技巧和<a class="ae ks" href="https://download.holidayhackchallenge.com/2020/OfficialNaughtyNiceBlockchainEducationPack.zip" rel="noopener ugc nofollow" target="_blank">工具</a>。(仅输入随机数的16个字符的十六进制值)</p><ol class=""><li id="6ad7" class="nx ny iq jt b ju jv jy jz kp nz kq oa kr ob ko oc od oe of bi translated">目标是正确预测数据块130000的随机数。每个随机数是一个64位MD5和。我们之前预测了打雪仗的32位，现在也要做同样的事情，但是64位增加了一些复杂性。我们需要获取每个随机数，将其分成两个32位表示，获取这32位中的前624位，预测出其余的，选择正确的，组合回64位，转换为16位十六进制字符。这是可行的，因为每个nonce都是MD5，并且是在32位部分中创建的，所以每个32位部分都遵循我们之前了解的Mersenne预测符。像SHA-256这样更健壮的散列随机数不会有这个弱点。</li><li id="c5e2" class="nx ny iq jt b ju og jy oh kp oi kq oj kr ok ko oc od oe of bi translated">第一步:从每个块中获取完整的64位nonce，并分成两个32位。我在这里使用了一个拆分器函数:<a class="ae ks" href="https://stackoverflow.com/questions/32053137/split-each-after-32-bits-of-128-bit-input-in-python" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/32053137/split-each-after-32-bits-of-128-bit-input-in-python</a>。我所有的代码都放在给定的naughty.py的底部，它是作为提示的一部分提供的</li></ol><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f26a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">这里的一个关键部分是分割的顺序，你看我把split[1]放在split[0]的上面。稍后，我将展示如何验证订单是否正确</p><p id="b9ee" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">通过管道输出到文件，并去掉前624个值。</p><p id="35bc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><code class="fe me mf mg mh b">head -n 624 32_bit_full_values.txt &gt; 32_bit_known.txt</code></p><p id="3d6c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.现在我们需要计算出我们想要的准确的预测随机数。Wordcount显示整个文件中共有3096个随机数(记住每个块有2个随机数)。3096–624 = 2472.这意味着接下来的2472个预测随机数将与已知值匹配。</p><p id="8413" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.让我们验证我们的预测是正确的</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ol"><img src="../Images/a392524ed7ca906a46e5e5a1d6072c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CmURiMfhLo38EqE0Ve7_sw.png"/></div></div></figure><p id="b835" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">这两个值组合回64位时，应该等于624/2=312个块现时(我们用来预测的624之后的下两个值)。312块nonce = 15093713008609744919。</p><p id="921a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">用这个组合回64位:<a class="ae ks" href="https://stackoverflow.com/questions/3553354/concatenate-two-32-bit-int-to-get-a-64-bit-long-in-python" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/3553354/concatenate-two-32-bit-int-to-get-a-64 bit-long-in-python</a>。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi om"><img src="../Images/9b15fad7dd0b403fb1eb8d97275212c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*nZD7XZcGJERIsUeWVfG48w.png"/></div></figure><p id="a533" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">验证了我们预测的是正确的值</p><p id="445f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">5.为了得到130000块，我们需要预测比现在多4个块，因为最后一个块是129996</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi on"><img src="../Images/b7935e05424b2bb28fdb1f01d2cd6f27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLBU1iioVvFPJQuuIe1_dg.png"/></div></div></figure><p id="615a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">6.将这些值组合在一起并转换成十六进制形式</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/bc0c8a2648954c009d9811d8b82d4a45.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*eWg2JLVRY9GVHNsOny2cXQ.png"/></div></figure><p id="576f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">57066318f32f729d就是答案</p><h1 id="a1da" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">(Santa)目标11b —区块链调查第2部分</h1><p id="b0ac" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">目的:杰克蚀变块的SHA256为:58 a3 b 9335 a6 CEB 0234 c 12d 35 a 0564 c 4 e f0e 90152d 0 EB 2 ce 2082383 b 38028 a 90 f。如果您够聪明，您可以通过仅更改4个字节的值来重新创建该块的原始版本。一旦您重新创建了原始块，该块的SHA256是什么？</p><p id="3088" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">1.我们得到了Jack修改的块的SHA256值:58 a3 b 9335 a6 CEB 0234 c 12d 35 a 0564 C4 ef 0 e 90152d 0 EB 2 ce 2082383 b 38028 a90f</p><p id="2a44" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我们需要找到那个块，调整4个字节，并将其恢复到预期值。我不会太深入地探究技术细节，但会试图涵盖所发生的事情的基本情况。这个滑梯是无价的<a class="ae ks" href="https://speakerdeck.com/ange/colltris" rel="noopener ugc nofollow" target="_blank">https://speakerdeck.com/ange/colltris</a></p><p id="05ed" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2.通过SHA256哈希找到该块。SHA256哈希目前尚未计算，因此我们需要计算它并找到正确的块。创建一个SHA256函数，复制现有的md5函数。</p><pre class="ku kv kw kx gt mi mh mj mk aw ml bi"><span id="5d65" class="mm lc iq mh b gy mn mo l mp mq">def sha256_hash(block):<br/>    hash_obj = SHA256.new()<br/>    hash_obj.update(block.block_data_signed())<br/>    return hash_obj.hexdigest()</span></pre><p id="8ddc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">运行每个程序块并保存输出。</p><pre class="ku kv kw kx gt mi mh mj mk aw ml bi"><span id="6632" class="mm lc iq mh b gy mn mo l mp mq">for block in c2.blocks<br/>    sh = sha256_hash(block)<br/>    print("{} - {}".format(count,sh))<br/>    count+=1</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi op"><img src="../Images/d208dfa867ea6f4c4f030bd2bcde2cab.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*XUOIi3neUN6jyC0NsikM2w.png"/></div></figure><p id="3d5c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">搜索给定的散列导致框1010</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oq"><img src="../Images/c4a64dc350cf09f4b41fdbcca8505ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciE0NVsfgdMILqGKDvznng.png"/></div></div></figure><p id="ef77" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">打印有问题的块给出了一大块数据，但显示其上存储了两个文档。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi or"><img src="../Images/ce165da5871abc9b2e4e04245dd31960.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2kEsrKy1MCi-OV4PzBsLOQ.png"/></div></div></figure><p id="6f2f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3.忽略二进制blob，使用内置的dump_doc类下载PDF。虽然它是一个有效的PDF，但内容似乎不正确。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi os"><img src="../Images/886eb2e095ebcce1eb368367e6aff4e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*3HMpBrtMj7dt93Jgy3yPXg.png"/></div></figure><p id="1ec8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">4.这就是幻灯片开始发挥作用的地方。简而言之，有一个pdf漏洞，它允许某人通过调整一个比特来轻易地改变PDF中显示的内容。阅读<a class="ae ks" href="https://github.com/corkami/collisions#pdf" rel="noopener ugc nofollow" target="_blank">此处</a>了解更多信息。这种攻击技术被称为UniCOLL，最大的秘密是，由于MD5在64位块中操作，如果您将一位增加/减少1个值，您可以在下一个块中的相应字节上进行相反的交互，以获得相同的MD5哈希值。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/88c2f6f867799d6bd1c47c641b283ff8.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Do32sNbdqCQGYOIZDUqNFw.png"/></div></figure><p id="06b6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">因此，在这种情况下，基本上有2个PDF合并为一个，原来的审查和杰克的积极审查。通过调整一位将页面值从2移动到3，我们应该能够显示原始评论。</p><p id="1a4f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">5.让我们将这个单独的块保存为. dat文件，并将其加载到hexeditor中。我用的是<a class="ae ks" href="https://hexed.it" rel="noopener ugc nofollow" target="_blank"> https://hexed.it </a>，超级好用。首先要做的几件事会有所帮助。在设置中设置行长度为32位，获取当前MD5哈希值工具- &gt;文件哈希生成器- &gt; Md5</p><p id="07e7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">6.调整数值:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ou"><img src="../Images/ecfe61d2ddd7a127f3e698f8559dc230.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zxXrwEAqpN2ryURIxm9_sg.png"/></div></div></figure><p id="308d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">将32 (2)调整为33 (3)</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/44e41932490b5923f22c5e625fa4a832.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*FpzdShyhi54E70gCSfv8wQ.png"/></div></figure><p id="a326" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">向下移动两行，并将该值向下调整一行以进行偏移</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/5932c83823320d149ea15247cec2846b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*dpRNKrQzwDsCncivdlVWAw.png"/></div></figure><p id="06df" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">7.检查新的MD5散列(应该是相同的值)并使用UNIX“hex edit”或保存此文件复制hexedits for real。</p><p id="ff0b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">8.正确的审查现在应该显示。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/99a15848b2d1dbeba20dedd3e3ef8906.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*5uvhKIWro9lfcr2jcySv5g.png"/></div></figure><p id="142a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">9.还有另外一组要做的更改，原始块显示Nice标志已经设置好了。我们可以假设这是不正确的，标志应该是顽皮的</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/fdb48427ea5c35f44cc9ae646d510b87.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*TzLsG5jLLj_UVzogGbVF6A.png"/></div></figure><p id="601f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">根据python源代码，淘气的标志可以是任何&lt; 1</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/4debc33d2cfbbd7e174faacfd4584829.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*2C7w-Gw0tbTWEmpCVbA0vw.png"/></div></figure><p id="cf89" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">10.再次查看hexed.it，这一次我们查看的是最开始的值，具体来说，我们在ffffffff的分数后寻找1</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi pa"><img src="../Images/328c1a71fda9fc2238cdc26ef07817aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7beMiYLm339eI4Y46FTcrA.png"/></div></div></figure><p id="462f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">让我们将其向下调整为0，并将相应的位2向下调整1行。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi pb"><img src="../Images/aa0710af126f270db7f86895d1b40f91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sr6H97hg2iNRwnjTGef87Q.png"/></div></div></figure><p id="1813" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">11.让我们验证一下，两个dat文件的MD5应该是相同的，而SHA256发生了变化。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/7643f3c50efb2489325e24e352600c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*gs1hJcnNCMBMCXRKjOTRrA.png"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi pd"><img src="../Images/0f388501b346c4b51bc0137f1629a9f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JGvcgPrC49yo-A4eipXx5Q.png"/></div></div></figure><p id="f0e2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">可以看出MD5和是相同的，而SHA256是不同的</p><p id="3d2f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">12.答案是fff 054 f 33 c 2134 e 0230 efb 29 dad 515064 AC 97 aa 8 c 68d 33 c 58 c 01213 a0d 408 AFB</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><h1 id="bb3b" class="lb lc iq bd ld le np lg lh li nq lk ll lm nr lo lp lq ns ls lt lu nt lw lx ly bi translated">结束并回顾</h1><p id="c230" class="pw-post-body-paragraph jq jr iq jt b ju lz jw jx jy ma ka kb kp mb ke kf kq mc ki kj kr md km kn ko ij bi translated">一旦你完成11b，交换回你的正常角色，让你的方式到圣诞老人的办公室，并在阳台上获得学分和链接到KringleCon赃物商店。</p><p id="7f6f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">像往常一样，今年的KringleCon制作精良，执行到位，我很高兴成为其中的一员，为这场有趣的冒险带来一些关注。对我来说，特别是ARP/DNS欺骗真的很有趣，因为这一直是我喜欢看到的东西，所以实际上使用Scapy来找出它是很棒的。区块链在最后的操纵是激烈的，没有我，还有其他几个克林果康的与会者可能无法搞清楚。总的来说，我玩得很开心，并期待着明年的！</p></div></div>    
</body>
</html>