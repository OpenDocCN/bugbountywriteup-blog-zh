# 从不同角度上传任意文件

> 原文：<https://infosecwriteups.com/arbitrary-file-upload-from-a-different-angle-1193ffb80b09?source=collection_archive---------1----------------------->

*注:以下文章发表于 2016 年 1 月 19 日 https://FogMarks.com*[](https://fogmarks.com/2016/01/19/arbitrary-file-upload-from-a-different-angle/)

*![](img/7d20b2b009bec2c33e43dc999bfd6b0b.png)*

*今天我们将讨论任意文件上传，这是一个不太常见的漏洞，但却是最强大的漏洞之一。*

# *不太常见？为什么？*

*因为任何有理智的开发人员的平台都会验证他们与之交互的任何文件的内容类型和文件扩展名。但是今天我想向你介绍一种新的验证态度，我建议每个人都使用这种态度——验证内容本身。
如果您希望上传一张图片，请确保图片内容适合图片内容。如果你期待一个 html 文件——清理它，并确保没有脚本标签存在。有很多库和工具可以做到这一点。*

*话虽如此，我遇到的许多公司和开发者对我说:“当我们可以在 CDN(内容交付网络)上托管上传的文件时，我们为什么要付出那么多努力？”。嗯，今天的故事就是关于这个。*

***Freelancer.com**是我第一次接触这种新的攻击媒介。它们允许图片作为个人资料和封面图片上传，DOC 和 DOCX 文件作为简历上传等等。*

*但他们也有一个很好的功能，用户可以写文章并发布给其他人阅读。
这个表单支持图片上传，可以想象，这些图片正在上传到一个 CDN (https://cdn.f-cdn.com/)。
f-cdn.com 当然是自由职业者公司的官方 CDN。*

*这里的开发人员可能认为，由于图像被上传到 CDN，不应该进行任何清理和内容验证——表单不支持 HTML——所以 XSS 无法完成，CDN 不允许 php 文件(或任何其他类似文件)被访问——只需下载它们。*

*嗯，这种态度让我能够上传一个. exe 文件到自由职业者公司的官方 CDN。*

*你能想象一个黑客会在官方公司的 CDN 上托管恶意病毒的场景吗？我希望你知道。
更重要的是，没有大小限制——任何大小的文件都可以托管在 CDN 上(尽管上传它可能需要时间，并且连接最终可能会被拒绝)。*

*所以请记住，使用 cdn 并不总是最佳选择。是的，XSSes 不会影响用户(因为一个不同的域),是的，shells 和 rce 不会直接危及你的服务器。但是错误验证你的 CDN 托管的文件类型可能会给你的公司带来巨大的损失。请记住这一点。*