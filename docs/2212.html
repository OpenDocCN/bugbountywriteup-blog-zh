<html>
<head>
<title>Mail Server Misconfiguration leads to sending a fax from anyone’s account on HelloFax (Dropbox BBP) for a bounty of $4,913</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">邮件服务器配置错误导致从hello fax(BBP Dropbox)上任何人的账户发送传真，奖金为4913美元</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/mail-server-misconfiguration-leads-to-sending-a-fax-from-anyones-account-on-hellofax-dropbox-bbp-aab3d97ab4e7?source=collection_archive---------0-----------------------#2022-07-25">https://infosecwriteups.com/mail-server-misconfiguration-leads-to-sending-a-fax-from-anyones-account-on-hellofax-dropbox-bbp-aab3d97ab4e7?source=collection_archive---------0-----------------------#2022-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b019" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好！,</p><p id="09db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你们都过得好:)</p><p id="d147" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章是关于我最近在多个目标中发现的邮件服务器错误配置，它允许我在易受攻击的web应用程序上执行未经授权的操作，这个漏洞在多个目标和不同类型的web应用程序中很常见。Dropbox修复了这个问题，并奖励了我4913美元的bug赏金。</p><h2 id="0b5b" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated"><strong class="ak">描述</strong></h2><p id="8154" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">我在<a class="ae lj" href="https://hackerone.com/dropbox?type=team" rel="noopener ugc nofollow" target="_blank"> Dropbox BBP </a>开发HelloFax应用程序，寻找授权问题，但该应用程序很好地解决了授权问题，如IDOR和访问控制，所以我想寻找更有趣的功能，我发现了一个功能，允许用户<a class="ae lj" href="https://faq.hellosign.com/hc/en-us/articles/215338277-How-to-send-a-fax-through-email" rel="noopener ugc nofollow" target="_blank">使用他们的电子邮件</a>发送传真，而无需登录他们的HelloFax帐户</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/64a733ac9d8baa607c8b09eff38dc646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q9Z6t3pD6tGg8qrHXxuhDw.png"/></div></div></figure><p id="128c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，当一个付费用户向<em class="lw">FAXNUMBER@hellofax.com</em>发送电子邮件时，应用程序会将电子邮件的内容作为传真从用户的HelloFax账户发送到FAXNUMBER，例如，如果我向<em class="lw">13456789000@hellofax.com</em>发送电子邮件，那么应用程序会从我的HelloFax账户向<strong class="jp ir"> +13456789000 </strong>发送传真</p><h2 id="06b4" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">剥削</h2><p id="abe2" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">这里我想到的第一件事是给FAXNUMBER@hellofax.com发一封假邮件，通过把受害者的邮件从字段放入<strong class="jp ir">字段，我很快去了http://anonymailer.net/<a class="ae lj" href="http://anonymailer.net/" rel="noopener ugc nofollow" target="_blank">并给+12345678900@hellofax.com发了一封假邮件，令人惊讶的是效果很好，我收到了来自HelloFax的邮件</a></strong></p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lx"><img src="../Images/78452260817d92a0dd190537977b2907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p67Yit6aNcdQUv0URpaDcg.png"/></div></div></figure><p id="4a58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这封邮件说，我们的传真已经成功发送，Hellofax的邮件服务器没有验证我发送的假邮件的真实性，它从受害者的帐户发送邮件</p><p id="8433" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是漏洞的工作原理:-</p><ul class=""><li id="7ec6" class="ly lz iq jp b jq jr ju jv jy ma kc mb kg mc kk md me mf mg bi translated">Target允许我们通过向email@target.com发送电子邮件来执行操作</li><li id="e0e7" class="ly lz iq jp b jq mh ju mi jy mj kc mk kg ml kk md me mf mg bi translated">攻击者通过将受害者的电子邮件放在来自字段的<strong class="jp ir">中，向email@target.com发送一封假电子邮件</strong></li><li id="fefd" class="ly lz iq jp b jq mh ju mi jy mj kc mk kg ml kk md me mf mg bi translated">目标服务器收到电子邮件，但不验证其真实性，而是将其视为用户发送的合法电子邮件</li><li id="be45" class="ly lz iq jp b jq mh ju mi jy mj kc mk kg ml kk md me mf mg bi translated">应用程序处理电子邮件并从受害者的帐户执行操作，从而绕过授权</li></ul><p id="c591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即在Hackerone上向Dropbox BBP报告了这个错误，第二天它就被分类了，但是团队将严重性降级为<strong class="jp ir">高</strong>级，原因如下</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/ee9348ff372baa8ef8ff026b005cceab.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*DdmF6I3JAEb9kHsyHqxGpw.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">团队对Hackerone的评论</figcaption></figure><p id="5692" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管他们按照政策付给我4913美元的高级别奖金</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mr"><img src="../Images/823bdeaebacd00b51ea4a5a1dcf339ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FwElyhXBBve1WxUg_WauEQ.png"/></div></div></figure><p id="f74e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">其他剥削场景</strong></p><ul class=""><li id="b131" class="ly lz iq jp b jq jr ju jv jy ma kc mb kg mc kk md me mf mg bi translated">我在一个漏洞报告门户网站上发现了同样的漏洞，它允许我通过向bugs@redacted.com<em class="lw">的</em>发送电子邮件，从受害者的账户中创建漏洞报告</li><li id="2f98" class="ly lz iq jp b jq mh ju mi jy mj kc mk kg ml kk md me mf mg bi translated">在使用自己的支持面板的应用程序上可能会发现这个错误，我们可以代表内部团队或任何其他用户在那里创建票证</li><li id="e33c" class="ly lz iq jp b jq mh ju mi jy mj kc mk kg ml kk md me mf mg bi translated">任何其他类型的应用程序，通过向他们发送电子邮件来执行操作或创建票证/错误</li></ul><p id="e216" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此漏洞的根本原因是目标服务器不验证SPF记录，配置为使用SPF和DMARC的电子邮件客户端将自动拒绝未通过验证的电子邮件，这应该应用于应用程序以防止此漏洞</p><p id="abc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">时间线</strong></p><p id="da4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年12月16日—向Hackerone上的<a class="ae lj" href="https://hackerone.com/dropbox" rel="noopener ugc nofollow" target="_blank"> Dropbox BBP </a>报告了一个错误</p><p id="31d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年12月17日Hackerone分类小组对错误进行了分类</p><p id="1fd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年12月31日Dropbox团队奖励4913美元奖金</p><p id="cff8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2022年3月17日— Dropbox团队修复了该问题</p><p id="10f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2022年5月2日—报告因已解决而关闭</p><p id="ad50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您阅读本文，如果您有任何疑问，请随时通过Twitter联系我，电话:<a class="ae lj" href="https://twitter.com/ehsayaan" rel="noopener ugc nofollow" target="_blank"> @ehsayaan </a>或<em class="lw">ehsayaan@gmail.com</em></p><p id="5b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">特别感谢山姆·库里校对这篇文章</p><p id="ba33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下次见！</p><p id="23ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lj" href="https://sayn.in" rel="noopener ugc nofollow" target="_blank">赛亚安阿拉姆</a></p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="b3e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lw">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。加入我们的每周简讯，以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em><a class="ae lj" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"><em class="lw">https://weekly.infosecwriteups.com/</em></a></p></div></div>    
</body>
</html>