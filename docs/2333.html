<html>
<head>
<title>OAuth 2.0 (Introduction and Exploitation Part I)Explained By Hashar Mujahid</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Hashar Mujahid解释OAuth 2.0(介绍和开发第一部分)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/oauth-2-0-introduction-and-exploitation-part-i-explained-by-hashar-mujahid-262f9c59de6c?source=collection_archive---------1-----------------------#2022-08-31">https://infosecwriteups.com/oauth-2-0-introduction-and-exploitation-part-i-explained-by-hashar-mujahid-262f9c59de6c?source=collection_archive---------1-----------------------#2022-08-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ab3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇博客中，我将解释OAuth 2.0是如何工作的，以及如果不正确地实现它会引发什么样的漏洞。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/e817e98a2946392e5829b3ceabd5516d.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*OvTMdfJbMBcHV422.jpg"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">OAuth 2.0</figcaption></figure><p id="f57a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简介</strong>:</p><p id="1b0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨，我的名字是哈沙尔·穆贾希德。我是一名网络安全学习者，今天我将解释OAuth 2.0的工作原理以及如何被利用。</p><p id="6b63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">什么是OAUTH 2.0？</strong></p><p id="5ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OAuth 2.0(开放授权)是一种协议，允许网站或应用程序代表用户访问其他web应用程序托管的资源。OAuth的旧实现是1.0。OAuth提供对用户资源的应用程序的受限访问以进行操作。</p><p id="76e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> OAuth 2.0实现:</strong></p><p id="6168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当你访问一个网络应用程序时，你会在注册页面上看到一个按钮，用来注册谷歌、脸书和GitHub。这使应用程序能够访问一些资源，如你的用户名、电子邮件和必要的信息，以自动完成注册过程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/decdc7bf67e259d87bbea2009659fc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:910/format:webp/1*2rsHF7xjmLqP5EL22jIl0g.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">OAuth 2.0</figcaption></figure><p id="3888" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它是如何工作的？</p><p id="79e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们都听说过API键。OAuth也使用类似的访问令牌。这些访问令牌验证用户的身份，并与资源服务器交互以获取所需的数据。简单来说，</p><blockquote class="ky kz la"><p id="02d4" class="jn jo lb jp b jq jr js jt ju jv jw jx lc jz ka kb ld kd ke kf le kh ki kj kk ij bi translated"><strong class="jp ir">应用程序使用访问令牌代表用户发出API请求。</strong></p></blockquote><p id="fff7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有另一个名为<strong class="jp ir">刷新令牌</strong>的令牌。其目的是从资源服务器检索新的访问令牌。它通常与旧的访问令牌一起发送，并检索新的令牌。</p><p id="87b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【OAUTH 2.0期间的信息流？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/19c6be2d471bad69dd08b786a645a1b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/0*P1553k1c-WQNlEjE"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">谷歌认证</figcaption></figure><p id="6b8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个过程并不像看起来那么复杂。要理解这个过程，我们必须首先理解整个过程中的角色或参与者。</p><p id="292a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步:</p><p id="1c1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个请求是由<strong class="jp ir">客户端应用程序</strong>(您希望使用OAuth功能登录的网站)向<strong class="jp ir">资源所有者</strong>(授权<em class="lb">应用程序</em>访问其帐户的<em class="lb">用户</em>)请求访问服务资源的授权请求。如果用户允许该授权请求，则向客户端应用程序授予授权许可。</p><p id="db5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二步:</p><p id="a144" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，客户端应用程序向<strong class="jp ir">授权服务器</strong>发送请求(授权服务器在向应用程序发布访问令牌之前验证用户的身份)，并提供其自身身份的证明和用户发布的授权许可。然后，授权服务器验证用户给出的应用身份和授权许可，并发布访问令牌。</p><p id="a5d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三步:</p><p id="0642" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，客户机应用程序有了一个访问令牌，通过它可以与资源服务器的API(资源服务器是保存安全用户帐户的地方)进行交互，请求用户的有限数据并完成注册过程。</p><p id="5584" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很简单，不是吗？；-)</p><p id="c965" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在有了一个简单的了解，现在我们可以看到如何利用OAUTH 2.0以及这些漏洞是如何出现的。</p><p id="4f99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">oauth 2.0认证漏洞是如何产生的？</strong></p><p id="075e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OAuth身份验证缺陷的出现部分是因为OAuth规范故意含糊不清且不够灵活。虽然有些组件对于每种授权类型的基本操作是必不可少的，但实现的大部分内容完全是可选的。</p><p id="0edf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这包括保护用户数据安全所需的几个配置选项。简而言之，不当行为有很大的介入空间。</p><p id="5fe4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">OAuth的另一个重要问题是完全没有内置的安全机制。</p><p id="d4db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">安全性几乎完全依赖于开发人员利用适当的配置参数，并在其上添加他们自己的额外安全机制，如强输入验证。正如您已经猜到的，需要记住的东西很多，如果您不熟悉OAuth，很容易弄错。</p><p id="2075" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">剥削:</strong></p><p id="a9c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多方法可以利用OAUTH 2.0标准，但是今天我们只看到一种。我将在本系列的后续部分解释更多的方法。</p><p id="4056" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lg" href="https://portswigger.net/web-security/oauth/lab-oauth-authentication-bypass-via-oauth-implicit-flow" rel="noopener ugc nofollow" target="_blank">实验:通过OAuth隐式流程绕过认证</a></p><p id="4d56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目标:</p><p id="c0bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个实验室使用一个<a class="ae lg" href="https://portswigger.net/web-security/oauth" rel="noopener ugc nofollow" target="_blank"> OAuth </a>服务来允许用户使用他们的社交媒体帐户登录。客户端应用程序有缺陷的验证使得攻击者有可能在不知道其他用户密码的情况下登录他们的帐户。</p><p id="0148" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要解决实验室，登录卡洛斯的账户。他的电子邮件地址是<code class="fe lh li lj lk b">carlos@carlos-montoya.net</code>。</p><p id="b36d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以使用以下凭证使用自己的社交媒体帐户登录:<code class="fe lh li lj lk b">wiener:peter</code>。</p><p id="3478" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解决方案:</p><p id="3098" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们进入实验室，我们可以看到我们有登录选项。当我们点击登录时，我们可以看到我们被重定向到使用您的社交媒体帐户登录。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ll"><img src="../Images/4e144e1b26fe199ab109c317399d4498.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BuZYaRzaX47ErOujZSc0Aw.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk translated">让我们登录</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lq"><img src="../Images/b178bf2099ac649c1e63ede57d1c1c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5KGwkMBVifvIxPkWdMRljg.png"/></div></div></figure><p id="e371" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到客户端应用程序想要访问这两条信息来完成登录。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lr"><img src="../Images/e78f13a57dbe46e39b17a38cb3e9235a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Su5gS3TPkLRMiltcIyg-JQ.png"/></div></div></figure><p id="39ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到如何传递访问令牌来批准我的登录。</p><p id="bd47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只需要将电子邮件地址和用户名更改为Carlos的电子邮件和用户名，然后发送请求</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi ls"><img src="../Images/6c4d50a120b32fc5afcc8dd44cc18dcf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HaMP3kJ4jmIe0v29-d2qvA.png"/></div></div></figure><p id="697e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序不检查访问令牌是否属于carlos，除非它不是有效的令牌，并为Carlos生成一个会话。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lt"><img src="../Images/c5933e653f01ab57ad07a8ca59fe252c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d_v3D2JLuEplCeIMS63Wbw.png"/></div></div></figure><p id="8807" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在复制这个会话，并将当前会话的值改为这个。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/332c40b54316cabf6a7fc2c28e58d3e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*MfJ9AWOqolXR8jGgt9ZIMg.png"/></div></figure><p id="d412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">重新加载页面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lv"><img src="../Images/8cbf327af932c3dcb6b76bf5e9360993.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sJjBT5IZK2FKjaeX83JPyQ.png"/></div></div></figure><p id="cac0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的实验室解决了。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="lw lx l"/></div></figure><p id="68ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将在接下来的几天里发布更多的实验和挑战，如果你想得到通知，请考虑跟随我，❤.</p><p id="61c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">直到下一次！快乐的Learning❤</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><p id="3ab7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。 <a class="ae lg" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lb">加入我们的每周简讯</em> </strong> </a> <em class="lb">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>