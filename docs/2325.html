<html>
<head>
<title>Definitive Guide to SQL Injection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">SQL注入权威指南</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/definitive-guide-to-sql-injection-df5ac445eef1?source=collection_archive---------2-----------------------#2022-08-29">https://infosecwriteups.com/definitive-guide-to-sql-injection-df5ac445eef1?source=collection_archive---------2-----------------------#2022-08-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/05d38cc104109e57c1bb7d6b46375aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FpzOjoG5IEvmsM4phCB31w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">大卫·普帕扎在<a class="ae kf" href="https://unsplash.com/@dav420?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="a072" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="e656" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">手机或网络上有两种应用——静态和动态。静态网站只是一堆网页汇编在一起，每次给你看的都是一样的信息。它不根据用户类型/角色显示信息，也不与后端数据库交互。</p><p id="e56a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">另一方面，动态站点从后端数据库获取数据。根据网站类型的不同，它可以根据你的品味和偏好向你展示数据，比如脸书和YouTube，或者像medium.com一样向你展示一篇文章。</p><p id="efd1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">有不同类型的数据库。我们可以根据它们存储数据的方式将它们分为两类。如果它们以行和列的形式存储数据，它被称为关系数据库或SQL数据库，如果它以对象的形式存储数据，它被称为非SQL数据库。</p><p id="40c2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">与非SQL数据库不同，SQL数据库已经使用了很长一段时间，并且比非SQL数据库更受许多开发人员的青睐。</p><h1 id="006f" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">什么是SQLi漏洞？</h1><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/2218f5bafde8dae9ca8b831f390137cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qDVWS1fuHqKNnNpw2eGA5g.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://www.avast.com/c-sql-injection#gref" rel="noopener ugc nofollow" target="_blank">资料来源:Avast </a></figcaption></figure><p id="d4c4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">SQL注入是一个漏洞，当攻击者可以从SQL数据库获取信息时，就会出现该漏洞。这通常是他们不应该接触到的信息。它的范围可以从访问凭据和敏感令牌到绕过身份验证、泄露数据和安装后门。</p><p id="e4c8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">只有SQL类型的数据库容易受到这种攻击，称为SQLi漏洞。</p><figure class="mh mi mj mk gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/e7a9235f853271542bfc73c610def434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*flecEOBfozw4oI5I6jO01w.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://www.cloudflare.com/learning/security/threats/sql-injection/" rel="noopener ugc nofollow" target="_blank">来源:Cloudflare </a></figcaption></figure><p id="97c8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果web应用程序接受web表单、输入参数(例如，搜索查询)、cookie等，则会发生SQL注入。，而不验证它们并将其直接传递给数据库服务器。</p><p id="0553" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">数据库服务器将输入解释为代码而不是数据，并最终执行它。这可能会有严重的后果。下面提到了其中的一些。</p><p id="e9f1" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">绕过身份验证</p><p id="c93a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">篡改数据</p><p id="86d2" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">电子欺骗</p><p id="9890" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">拒绝服务</p><p id="ab0f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">数据泄漏</p><p id="af06" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">特权的提升</p><p id="4bcd" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">信息披露</p><h1 id="1299" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">我们如何在Web应用程序中检测它？</h1><p id="5611" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">不是所有的网站都是一样的。有些接受用户的输入并即时显示输出，而有些接受用户的输入并不向用户返回任何内容。</p><p id="fdbf" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">案例web应用程序基于输入查询返回一些输出。</strong></p><p id="29c8" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">假设你在一个电子商务网站上。您输入搜索查询，web应用程序将查询直接发送到SQL数据库服务器，而不执行任何验证并返回输出。您可以只输入一些非法字符，检查输出中的任何数据库错误，并与输入数据库中不存在的产品名称时的输出进行比较。</p><p id="5bd6" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这被称为基于错误的检测。<br/>可以是单引号<strong class="lg iu">(’)</strong>，双引号<strong class="lg iu">(”</strong>等。</p><p id="a30f" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">如果它返回类似，你有一个SQL语法错误或其他一般性错误，viola，你发现了SQL注入。</p><p id="fc64" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">然后，您可以尝试不同的有效负载来提取数据。寻找有效负载的最佳仓库之一是<a class="ae kf" href="https://github.com/swisskyrepo/PayloadsAllTheThings" rel="noopener ugc nofollow" target="_blank"> PayloadAllTheThings </a></p><p id="f7d4" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">案例web应用程序不返回任何输出</strong></p><p id="5a09" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">在这种情况下，您可以通过触发响应延迟或检查布尔条件来检查SQL注入。</p><p id="eab9" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">这被称为基于盲的检测。</p><p id="f5d3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">例如，您发现一个接受ID号但不返回任何信息的端点。<br/>设终点为:<a class="ae kf" href="https://www.example.com/return_nothing?id=2" rel="noopener ugc nofollow" target="_blank"><strong class="lg iu">https://www.example.com/return_nothing?id=2</strong></a></p><p id="3096" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">有两种方法来检查SQL注入。您可以导致延迟或检查条件是否为真。</p><p id="8a4b" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">但是您必须记住，不同的SQL数据库服务器接受相同操作的不同命令。这是您必须付出一点努力并精确定位正在使用的SQL数据库的地方。</p><p id="02ce" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">现在让我们开始检查布尔条件。</p><p id="c94a" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">https://www.example.com/return_nothing?id=2'和1=1 — <br/> </strong>因为1=1总是真的，所以如果id=2存在，你会得到一个200-状态码返回。因为1=1为真，且id=2存在(即真)。所以，<strong class="lg iu">真实，真实就是真实。</strong></p><p id="d202" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">但是如果你输入https://www.example.com/return_nothing?id=2'<strong class="lg iu">和1=2 — </strong>，现在因为1=2不成立，你可能会收到一个400状态码。<br/>因为1=2是假的，而id=2就存在(即真的)。所以，<strong class="lg iu">假与真就是假</strong>。</p><p id="fe69" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><strong class="lg iu">补救</strong></p><p id="7fea" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">SQL注入可能非常可怕，会给你的网站造成重大损失，甚至进入你的网络。</p><p id="62bf" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">因此，保护您的网站免受SQL注入攻击变得至关重要。防止SQL注入的一些方法有:</p><p id="fdf7" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">1.输入验证和消毒。永远不要相信用户的输入。应用allowlist和blocklist过滤器来保护自己免受SQL注入攻击。转义不安全的字符。</p><p id="8f02" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">2.对参数化查询使用预处理语句<br/>这是消除SQL查询的另一种有效方式。在这种方法中，语句已经写下，参数(用<strong class="lg iu">表示？</strong>这里)留给应用程序绑定值。例如:<strong class="lg iu">插入到用户的值(？,?, ?)</strong></p><h1 id="c22b" class="kg kh it bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="d171" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">随着技术的发展，新产品和服务不断推出。但通常情况下，其中存在未知的后门和漏洞，会危及整个系统的安全。</p><p id="3cd3" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">防火墙和入侵检测和预防系统的使用越来越普遍。但是，如果配置不正确，它们可以被绕过。</p><p id="c846" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated">为了确保你的网站是安全的，让你的网站通过检查除了SQL注入以外的各种漏洞进行笔测。</p></div><div class="ab cl ml mm hx mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="im in io ip iq"><p id="e6b5" class="pw-post-body-paragraph le lf it lg b lh mc lj lk ll md ln lo lp me lr ls lt mf lv lw lx mg lz ma mb im bi translated"><em class="ms">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae kf" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="lg iu"> <em class="ms">加入我们的每周简讯</em> </strong> </a> <em class="ms">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>