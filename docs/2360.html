<html>
<head>
<title>Detecting Log4j &amp; its Remediation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">检测Log4j及其修复</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/detecting-log4j-its-remediation-58ab3a59c865?source=collection_archive---------3-----------------------#2022-09-12">https://infosecwriteups.com/detecting-log4j-its-remediation-58ab3a59c865?source=collection_archive---------3-----------------------#2022-09-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9cd0a75ad80b4a49a3d1a8b698163a18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pCBv7DtBtOgBbaq9lEr80A.jpeg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kf" href="https://unsplash.com/@ralexnder?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">亚历克斯·丘马克</a>在<a class="ae kf" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><p id="1aa4" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">本文致力于log4j以及攻击者如何在野外利用它。</p><h1 id="8841" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">Log4j</h1><p id="d43a" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">Apache Log4j是Apache Software Foundation的一个项目，是一个基于Java的日志记录工具。它是用java编写的，是位于Java日志系统中的一个包。它是几个Java日志框架的一部分。</p><p id="65d3" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">发现了一个影响Java日志记录包log4j的0天漏洞，已为该漏洞提供了CVE号码2021–44228。它允许攻击者在web服务器上远程执行代码，CVE得分为满分10分，这使其成为最严重的漏洞之一。</p><p id="7ad9" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">Java被认为是全球第一大开发平台，在超过30亿台设备上运行。运行log4j的设备数量就算没有几十亿，也可以算是几百万。这使得它成为对攻击者有吸引力的攻击面。</p><p id="0eef" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki iu">有不同的方法可以利用这个漏洞。您可以在服务器端记录的一个头中注入有效负载，或者将其作为URL参数的一部分传递。</strong></p><p id="27cc" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">一些常见的头是用户代理或自定义头，如X-Forwarded-For等。</p><h1 id="c64b" class="le lf it bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">我们来检测一下</h1><p id="4865" class="pw-post-body-paragraph kg kh it ki b kj mc kl km kn md kp kq kr me kt ku kv mf kx ky kz mg lb lc ld im bi translated">我们可以访问这种攻击方法的日志文件，这使得我们更容易利用这一漏洞。</p><p id="f524" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">查看日志文件，我们发现/admin/cores端点需要一个参数。由于之前没有传递任何参数，因此param参数为空(即param={})</p><figure class="mi mj mk ml gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mh"><img src="../Images/89b343a2b96097e70a3a2f873f3b20ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k4xybTkQ_y-fNCOX76OEYA.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">日志文件</figcaption></figure><p id="2b8d" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">现在我们有了这些知识，我们可以向/admin/cores端点提供一个带有随机参数的有效负载。</p><p id="9fc7" class="pw-post-body-paragraph kg kh it ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">滥用log4j 0-day的一般有效载荷是使用JNDI。一般来说，JNDI是一个目录服务的API。你可以使用LDAP和jndi来调用你的攻击者的机器。</p></div><div class="ab cl mm mn hx mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="im in io ip iq"><h2 id="2fd1" class="mt lf it bd lg mu mv dn lk mw mx dp lo kr my mz ls kv na nb lw kz nc nd ma ne bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kf" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>