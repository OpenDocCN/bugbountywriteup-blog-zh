<html>
<head>
<title>How to Reverse Engineer, Sniff &amp; Fuzz Vulnerable RF Adult Toys with WHID Elite</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何逆向工程，嗅嗅和模糊易受攻击的射频成人玩具与WHID精英</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/electrocuting-testicles-with-whid-elite-6f52b7fb84bf?source=collection_archive---------0-----------------------#2019-07-30">https://infosecwriteups.com/electrocuting-testicles-with-whid-elite-6f52b7fb84bf?source=collection_archive---------0-----------------------#2019-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/a3c1884e41593b49b87b334e4b52d252.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*Ar1Arnim48uvLwtF.jpg"/></div></figure><p id="5fcc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如你所知，我很快就要发布《WHID Elite》了。作为一个迂腐的硬件开发人员，我想确保一切正常，即使是最小的细节。</p><p id="0409" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">上周我在寻找新的目标来测试<strong class="jw ir"> WHID Elite的无线电窃听能力</strong>，突然我发现了一个有趣的目标:一个<strong class="jw ir">电击鸡鸡环</strong>。是的，你没看错(亚马逊上找不到的……)。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/a759c934711b278c5c975795cf3605fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sMg4TehhsyXb_DRle9NAEw.png"/></div></div></figure><p id="920e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">长话短说…昨天新玩具到家了，你猜怎么着？没有滚动码，没有MSK/FSK/GMSK或其他奇怪的调制…只是一个经典的433MHZ的振幅转换键调制与开关键。这是为非射频人员翻译的…很容易:</p><ul class=""><li id="02f6" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated">嗅</li><li id="12ce" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">重播</li><li id="b590" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">当然，还有……绒毛。</li></ul><p id="19aa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我采用了研究新RF器件时常用的逆向工程方法，并启用了成功的LimeSDR/RTL-SDR + URH组合。(声明:由于我专注于RF方面，所以我从RF分析开始。如果它不会导致任何低挂水果的结果，我会开始硬件逆向工程的方法:拆除，BoM枚举和指纹，FCC ID狩猎，等等。幸运的是，对于我稀缺的业余时间，我不需要它。)</p><p id="f2a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">可以看到，中心频率约为433MHz，这是商用消费级RF设备的标准频率。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lq"><img src="../Images/2d3689fa3b8d07557e7d99ab799c838e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeX5jHZX1rnKqiLahcMVFQ.png"/></div></div></figure><p id="7546" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">从<strong class="jw ir">频谱图</strong>中，我们可以清楚地看到<strong class="jw ir">调制是ASK </strong>，尽管边上有一些谐波(很可能是由制造商使用的低成本发射机引起的)。</p><p id="40fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们需要解码数据包，看看我们是否真的在处理ASK，并最终确认子调制类型(即<strong class="jw ir"> OOK </strong>，在我的假设中)。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lr"><img src="../Images/7e361b103517986004a1a8f347cd0cc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLn6YCFaoc18N99HJ1CPjg.png"/></div></div></figure><p id="3fc7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如你所见，URH成功地解码了数据包(对<em class="ls">容错</em>和<em class="ls">位长</em>参数进行了微调)。</p><p id="72a9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们有了二进制序列，我们可以清楚地看到这个射频器件的<strong class="jw ir">占空比</strong>，其中a:</p><ul class=""><li id="c712" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated"><strong class="jw ir"> 1编码为1110 </strong></li><li id="6e4e" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated"><strong class="jw ir"> 0编码为1000 </strong></li></ul><p id="35dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">没有序言。没有来自接收单元的ACK包。只是一个简单的广播包。总是不断重复。这使得我们可以消除滚动码假设。</p><p id="d440" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有了所有这些数据，我们最终可以组成数据包，发送该数据包以触发振动模式:</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lt"><img src="../Images/933fbcbe9d08f7dd592a1efe8554a5c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hPmc-jJfXJJTKIrrBK5dbA.png"/></div></div></figure><p id="b759" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们准备用WHID Elite的独立固件试一试，看看它是否也能解码。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/09de0aa93f18ddf16925ae82e4d9daa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*kagzPqBWLWZVtfaM5M9Keg.png"/></div></figure><p id="089e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如假设的那样，WHID Elite可以完美地嗅探和解码数据包。在上图中，您可以看到两种类型的数据包:</p><ul class=""><li id="6553" class="lc ld iq jw b jx jy kb kc kf le kj lf kn lg kr lh li lj lk bi translated">146565 <strong class="jw ir"> 16振动模式</strong></li><li id="2447" class="lc ld iq jw b jx ll kb lm kf ln kj lo kn lp kr lh li lj lk bi translated">146565 <strong class="jw ir"> 20电击模式</strong></li></ul><p id="b7d9" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如你可以很容易地发现两种类型的数据包之间的小数距离只是几个整数的问题。这意味着，我们可以<strong class="jw ir">轻松模糊，从而耗尽它们之间的空间</strong>与主要WHID精英固件。</p><p id="e7d5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此<strong class="jw ir">没有更多的文字阅读，享受音频/视频:)</strong></p><figure class="ku kv kw kx gt jr"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="709f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">请关注我的推特【https://twitter.com/WHID_Injector T4】很快我将为一整套WHID精英做赠品！</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/a64e83aad3f39fc5b7e31f126c6301fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:540/0*x1kj4RLfjMFcMn4P"/></div></figure><p id="7c72" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了方便起见，内部TX是一个<strong class="jw ir"> SYN470R。</strong>根据其数据表:<em class="ls">是单芯片ASK/OOK(开关键控)射频接收IC </em>。这再次证实了整个射频分析。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/66dfff50018596ba74f02b8ba13fe794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*B5rBIt9MkLMelnH3g1T3MA.png"/></div></figure></div></div>    
</body>
</html>