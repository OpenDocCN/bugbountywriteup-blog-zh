<html>
<head>
<title>Break the Logic: 5 Different Perspectives in Single Page (€1500)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打破逻辑:单页中的5个不同视角(€1500)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/break-the-logic-5-different-perspectives-in-single-page-1500-5aa09da0fe7a?source=collection_archive---------0-----------------------#2022-08-26">https://infosecwriteups.com/break-the-logic-5-different-perspectives-in-single-page-1500-5aa09da0fe7a?source=collection_archive---------0-----------------------#2022-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d6c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。今天我将谈论我在一个页面上发现的五个不同的漏洞。这些漏洞中的三个被接受，另外两个作为重复被关闭。公司还奖励了我1500€。</p><p id="731a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，我不能提供公司的信息，因为他们有一个私人的bug赏金计划。所以，让我们称它们为“修订的”。</p><p id="fc9b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始之前，让我给你一些关于应用程序的信息。这基本上是一个学校/学生的app。它有三种不同的用户模型:教师、学生和家长。家长只能在学生档案上编辑自己的信息。所以我们作为父用户的权限有限。所有报告都将在单个联系人页面中从这个角度进行。</p><p id="e188" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">一、用户即使没有访问权限也可以更改学生的主地址</strong></p><p id="118f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我作为家长用户访问学生的个人资料时，我发现了一个我们无权编辑的地址部分。“编辑”按钮是活动的，但是当我单击它时，所有字段都被禁用。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/441d3e026e041936e62133c40703d979.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*5bWinrfrOLS859cwDDmjUw.png"/></div></figure><p id="a041" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，您仍然可以看到“保存”按钮处于活动状态。因此，作为一个相当简单的方法，我从字段中删除了disabled属性。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi kt"><img src="../Images/4f91b29fa403bc112c4e48460412a613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PyR-NpNrEG1rQWEVXFcfAA.png"/></div></div></figure><p id="c41f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在字段中填入了自己的信息，发送请求非常容易，因为保存按钮仍然处于活动状态。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ky"><img src="../Images/10fe87227760fd1be8f46ac613508f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcu49Iu4xVTaPU-kI2qfwQ.png"/></div></div></figure><p id="172e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发送了请求，看到目标信息确实发生了变化。保护只是在应用程序的前端。类似地，这些信息可以使用Burp Suite进行更改。</p><blockquote class="kz la lb"><p id="493f" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">二世。即使没有访问权限，用户也可以编辑他们的所有部分</strong></p></blockquote><p id="4f55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">家长用户在学生的个人资料中有一些联系信息。但是，他们不能编辑所有这些信息。所以，他们只有编辑某些字段的权利。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lg"><img src="../Images/9b28d2c082466684fe3e279ca075abfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwJ8ARNAielplzVbZrrxFw.png"/></div></div></figure><p id="08e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，还有姓名和地址等信息，但是当我们单击编辑按钮时，只能更改联系人字段。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lh"><img src="../Images/0425158efa21e8c609c6f7935b6cdde7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BVPBwPkjfEeNdGXiFl5SFA.png"/></div></div></figure><p id="ce94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我以这种方式发送请求时，我遇到了下面的PUT请求。如您所见，还有其他不能更改的字段，如姓名、地址等。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi li"><img src="../Images/bb155de29599389736b17c8eb75afe0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*FH5THgT9ZhptvU98vMn8dw.png"/></div></figure><p id="4d48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我更改了一些信息，如姓名、地址、关系，并发送了请求。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lj"><img src="../Images/18c057a87009cecd7eb115b850b5397b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A_wCwWAE0lfPdHVXev4IgQ.png"/></div></div></figure><p id="73bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">信息已成功更改并显示在页面上。</p><blockquote class="kz la lb"><p id="4d96" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">三世。即使没有访问权限，用户也可以创建新的家长联系人字段</strong></p></blockquote><p id="0e69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如您所知，家长用户只能编辑自己的信息。他们不能添加新的父联系人字段。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lk"><img src="../Images/43857d7098e037151ee89f3a5c57c597.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybZsWXfguSDWCQGwQLMqtQ.png"/></div></div></figure><p id="a989" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，当我发送编辑联系人表的请求时，我更改了参数中的所有ID值，并且能够创建一个新的联系人表。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ll"><img src="../Images/60ab6fd130beb87af189c4ab85bd4bdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*igZuzbSafpWjFhwgW7Bx4g.png"/></div></div></figure><p id="0402" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图中的请求与第二个报告中的PUT请求相同。如您所见，请求有许多不同的ID值。我用随机值替换了所有ID值的最后一位数。(learnerPersonalid除外，因为它位于每个请求的开头，不是特定于页面的。)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lm"><img src="../Images/80b2d3dec26ce4572233b60b2a6f76f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*12ooL0atKoExweL3wTLHLg.png"/></div></div></figure><p id="7728" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实际上，我想知道应用程序会如何响应这个动作。我可能会期待500或403个答案，但这款应用为我创建了一个新的联系人字段。</p><blockquote class="kz la lb"><p id="e369" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">四。用户甚至可以在没有访问权限的情况下更改地址类型</strong></p></blockquote><p id="7ca4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用户不能更改学生的已定义地址类型。例如，在下图中，有两个为学生和家长用户定义的地址不能更改它们的类型。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ln"><img src="../Images/53b23533fd7517cf3e0219969375f5e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_CDvfaR_BhjN4hmWV_u0Mw.png"/></div></div></figure><p id="0a80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们试图将居住地址更改为官方地址时，应用程序会抛出一个错误，我们的请求不会被完成。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/11cee6106c4ad0c961b2086894e5d06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*QpknQhKVHA4TKPHX1dqk2w.png"/></div></figure><p id="ef1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我记得第一份报告中的保存按钮对于地址仍然有效。于是，我编辑了一个居住地址，发了过去，看到了下面的请求。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lp"><img src="../Images/e1e786ecaec6cd57770404abf8f4f402.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efShXMylBNEbnChxxzg-kA.png"/></div></div></figure><p id="d496" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我把“postalTitle”参数改成了官方的。(同样，我也可以把它改成官方地址的住宅区。)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lq"><img src="../Images/d052f28a10c01c8cf0df9c7f7c8b439a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H74evEMVnYU0t2BjlKkv2A.png"/></div></div></figure><p id="259c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在应用程序中，只有一个地址可以是官方地址，但你可以看到两个地址都已更改为主要地址。</p><blockquote class="kz la lb"><p id="6e25" class="jn jo lc jp b jq jr js jt ju jv jw jx ld jz ka kb le kd ke kf lf kh ki kj kk ij bi translated"><strong class="jp ir">五、用户无需访问即可删除学生官方地址(基础IDOR) </strong></p></blockquote><p id="7922" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在检查地址类型时，我发现了一个不同之处。住宅地址的删除按钮处于活动状态，但官方地址没有删除按钮。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/995b1d8998e8d737dec69079e1d6eae8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*B4Q4QNiX7hxKtijQeQjFVA.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">住宅地址示例</figcaption></figure><p id="7700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，虽然住宅地址的“删除”按钮是活动的，但官方地址没有此类按钮。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/441d3e026e041936e62133c40703d979.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*5bWinrfrOLS859cwDDmjUw.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">官方地址示例</figcaption></figure><p id="e588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是，我点击了学生官方地址编辑按钮。我运行了Burp Suite并点击了保存按钮。然后，我又碰到了下面的请求，复制了“住户”值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/80803a7b85308c0a062ee1d9cd522b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*F6WATLLvReyrkMwIhx8qYw.png"/></div></figure><p id="d520" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我回到住宅地址，点击删除按钮，得到请求，并用官方地址ID替换“家庭:”值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/e14d61baa427e77197c79cb4c39cc7d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*ta44K8CNRvVqroTtvdduXQ.png"/></div></figure><p id="bf5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，即使无法访问，我也可以删除官方地址。</p><p id="95eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前就这些。感谢你读到这里，希望你喜欢！</p><p id="7ca3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在推特上关注我:【https://twitter.com/canmustdie T4】T5</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><p id="cb55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lc">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae ly" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lc">加入我们的每周简讯</em> </strong> </a> <em class="lc">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>