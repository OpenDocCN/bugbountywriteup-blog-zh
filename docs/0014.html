<html>
<head>
<title>IDOR leads to getting Access tokens of users linked to Google Drive on Edmodo</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">IDOR导致用户访问Edmodo上链接到Google Drive的令牌</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/idor-leads-to-getting-access-tokens-of-users-linked-to-google-drive-on-edmodo-3978017134bd?source=collection_archive---------1-----------------------#2017-08-12">https://infosecwriteups.com/idor-leads-to-getting-access-tokens-of-users-linked-to-google-drive-on-edmodo-3978017134bd?source=collection_archive---------1-----------------------#2017-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d9d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，</p><p id="47d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你做得很好，在这篇文章中，我想与你分享我在<a class="ae kl" href="https://www.edmodo.com" rel="noopener ugc nofollow" target="_blank"> Edmodo </a>上的发现，我是如何获得用户的访问令牌的，这些用户已经将他们的帐户与Google drive链接，以便从它添加文件，让我们深入了解一下。</p><p id="3d45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基本上，edmodo是一个教师和学生的平台，他们可以在那里创建一个小组，并开展各种活动，如作业、测验等。所以，最近我开始在edmodo中寻找bug，经过两天的搜索，我得到了我的第一个bug，那是一个存储的XSS，但遗憾的是，它被复制了。但是我想。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/8e6ec2987bd407707b75947afd7f9da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*GgNDlmNtQBr3oaSdQ3buPA.gif"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在查找bug时，请始终记住这一点。</figcaption></figure><p id="7a4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我重新开始，再次完成了应用程序的映射。我看到增加了一个新的功能，那就是学生可以直接从他们的Google drive中添加文件到他们在edmodo的背包中。我很快就完成了添加文件的过程，并在Burp中处理所有请求。现在问题来了</p><p id="8acf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我找到了一个API端点，它检查用户是否已经将他/她的帐户链接到Google drive。</p><pre class="kn ko kp kq gt ky kz la lb aw lc bi"><span id="78ca" class="ld le iq kz b gy lf lg l lh li">https://api.edmodo.com/omniauth_callbacks/sso_user_exists?provider=google&amp;user_id=123456789&amp;_=1501610351655&amp;access_token=&lt;Our access token here of edmodo&gt;</span></pre><p id="0188" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，通过改变参数<strong class="jp ir"> user_id </strong>的值，我们可以得到用户是否已经将他/她的帐户链接到Google drive，这是我使用入侵者扩展的。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lj"><img src="../Images/32eeefbbff4663ce2fd11d54ebe05a81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4fQJhAVYTkqS6afcSSFxkA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">链接时用户存在且Unix时间戳</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lo"><img src="../Images/19e66819914fbdce71fda1c6b6b0f68a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9oJvY2GCbjCd03ZW9hlOKg.png"/></div></div></figure><p id="240b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如你所看到的，我得到了很多edmodo用户的id，他们将自己的账户链接到了google drive。</p><p id="4d34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我有了另一个端点，它将访问令牌分配给用户。</p><pre class="kn ko kp kq gt ky kz la lb aw lc bi"><span id="92c5" class="ld le iq kz b gy lf lg l lh li">https://api.edmodo.com/omniauth_callbacks/access_token?access_token=&lt;our edmodo access token here&gt;</span></pre><p id="e6ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，这个请求发送两个参数<em class="lp">提供者</em>和<em class="lp"> user_id </em>作为POST请求，其中我将<em class="lp"> user_id </em>更改为使用先前端点找到的其他用户。它还给我一个有效的访问令牌，用于另一个用户添加文件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lq"><img src="../Images/4b189d727f0b33a0e44c5fbc71c07d57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q2Q5WK6-rJqU65cA8CLs2Q.png"/></div></div></figure><p id="bd96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，它没有验证用户并返回访问令牌。我很快向Edmodo报告了这件事，一天后他们奖励了我一个很酷的礼包。Edmodo也修复了这个问题，现在它给出了一个禁止消息。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lk ll di lm bf ln"><div class="gh gi lr"><img src="../Images/d5cf4e90026a7f109783f0765c371a33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdBwewy6TMOQOjxoV9bckQ.jpeg"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">埃德蒙多糖果</figcaption></figure><p id="bea5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">要点:</strong>根据许多其他研究人员的建议，新功能总是不断增加，而且它们也有缺陷。这在这里对我有用。一定要记得检查新功能。</p><p id="0a57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你能愉快地阅读这篇文章。这是我第一个值得分享的有趣发现。我们随时欢迎您的评论，或者您可以在twitter上给我发消息。祝你过得愉快。☺️☺️</p></div></div>    
</body>
</html>