<html>
<head>
<title>Integrated Approach for Application Security and Security Operations Center using data correlation and Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用数据关联和机器学习的应用安全和安全运营中心的集成方法</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/integrated-approach-for-application-security-and-security-operations-center-using-data-correlation-dc723f493316?source=collection_archive---------7-----------------------#2022-09-28">https://infosecwriteups.com/integrated-approach-for-application-security-and-security-operations-center-using-data-correlation-dc723f493316?source=collection_archive---------7-----------------------#2022-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cb5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">摘要</strong> — <em class="kl">一个组织典型的网络安全部门至少由两个团队组成，即应用安全(AppSec)团队和安全运营中心(SOC)团队。应用程序安全团队的职责主要是在不良分子发现/利用安全漏洞之前发现它们。SOC团队持续监控攻击，并使用各种技术消除它们。本文阐述了一种将各个团队的信息结合起来使其他团队受益的方法。</em></p><p id="16d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 1。简介</strong></p><p id="2990" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行多个web门户的组织的应用程序安全团队使用不同的工具和技术扫描所有的web门户，寻找安全漏洞。</p><p id="8c20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个团队发现安全漏洞，并与IT和开发团队互动来解决问题。应用安全团队使用的所有扫描工具和技术都有一定的局限性。一个主要的限制是端点的不完全爬行。</p><p id="22d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SOC团队使用web应用程序防火墙和Modsecurity规则等工具持续监控和防止针对组织门户网站的攻击。SOC团队不掌握攻击成功概率的信息。</p><p id="c15f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。应用安全流程的弱点</strong></p><p id="50f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AppSec团队使用自动或手动技术扫描门户网站的安全漏洞。扫描的主要部分之一是搜索门户网站的端点。无论是自动还是手动方式，爬行仍然是不完整的。如果web门户由“n”个端点组成，爬行不能保证覆盖所有“n”个端点。这是由于AppSec团队不知道的web门户中的条件流很少，基于Ajax的请求被自动爬虫错过，以及只有用户角色和选择的特定组合使用的端点很少。<br/> AppSec团队不知道如何找出扫描中遗漏的端点。这使组织面临风险，因为许多终端从未接受漏洞扫描，最终也从未得到修补</p><p id="bc98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。安全运营中心的弱点</strong></p><p id="b92e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">SOC团队监控组织门户网站上发生的攻击，但无法确定哪些攻击需要紧急手动关注。足球队不知道正在进行攻击成功与否的概率。在今天的场景中，很多时候黑客会同时攻击一个组织的所有“x”个门户网站，耗尽SOC团队的带宽。还不知道哪个门户网站比其他门户网站面临的风险更大。</p><p id="245d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。AppSec和SOC团队的集成方法</strong></p><p id="9f4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">假设:</strong>组织运行4个门户网站。每个门户网站分别有125、260、300、170个端点。</p><p id="2262" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于爬行效率低且不完整，AppSec团队在漏洞扫描中遗漏了10、15、20、40个端点。</p><p id="9c69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">集成方法:</strong> AppSec团队从自动化工具中导出漏洞扫描所覆盖的端点列表，或者在表格中手动列出扫描的端点。</p><p id="b84f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">样本数据:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/836d223771e9ae7265853c7b68e5e720.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*hImq02MyAU5CpTV2LGqOxA.png"/></div></figure><p id="208f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个端点的公开漏洞(如果存在)也在下一列的同一电子表格中提及。</p><p id="a5d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">样本数据:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/442126f9d9b5c18906b3434c89239ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kdqQM1adQw46gmUE1EQKQw.png"/></div></figure><p id="d991" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结合所有门户网站的端点/漏洞数据，如下表所示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kv"><img src="../Images/b2f0c34252b6d850461fa3ff36fd927e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k1DJPBf7BiWngKClcz4g-g.png"/></div></div></figure><p id="93f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据下面的假设，漏洞扫描遗漏了Web门户1的端点:</p><p id="35d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点30至端点39</p><p id="c07f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据以下假设，漏洞扫描遗漏了Web门户2的端点:</p><p id="9900" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点130至端点144</p><p id="52bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据下面的假设，漏洞扫描遗漏了Web门户3的端点:</p><p id="cc07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点30至端点49</p><p id="1956" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据以下假设，漏洞扫描遗漏了Web门户4的端点:</p><p id="6fbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点330至Ednpoint369</p><p id="e6f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> SOC团队</strong>通过web应用防火墙(WAF)、Mod安全规则或对传入请求的手动监控来监控传入的Web流量。</p><p id="18c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每隔“n”分钟，收到请求的唯一端点列表以及每个端点收到的请求数都会记录在一个表中。</p><p id="4bb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了避免垃圾数据，只记录HTTP响应代码为200、301、302的有效请求。</p><p id="775f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">样本数据:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi la"><img src="../Images/cfbc3246dc65812cff3380d3cfca1e40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHlYKVtqVSvfZcp2aOuogA.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/f9f413ebc6f57f56eb225eb4f86ece91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*80rZ6tEuP_W0434x5grXFg.png"/></div></figure><p id="fa9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每隔“n”分钟，将请求的端点数据(表4)与扫描的端点数据(表3)进行比较。</p><p id="e8a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个合理的假设，即使AppSec团队在扫描中遗漏了一些端点，攻击者也不会遗漏它们。原因是攻击者有无限的攻击时间，攻击者人数更多，攻击者拥有的工具比AppSec团队更多。</p><p id="8c0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当将请求的端点数据与扫描的端点数据进行比较时，会出现3个观察结果，这在下面提到的饼状图中进行了解释。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi lc"><img src="../Images/161ee8adb8793492577c9f64e396dc9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPr_U3750qUCuXwG8mRjiw.png"/></div></div></figure><p id="a211" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">图例:</strong></p><p id="14e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">绿色:请求的端点已被AppSec团队扫描，没有漏洞</p><p id="c742" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">橙色:AppSec团队扫描的请求的端点存在漏洞</p><p id="7215" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">蓝色:AppSec团队在扫描中遗漏的请求端点</p><p id="32a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">收到请求但这些端点不在AppSec团队扫描范围内的端点(在附件1中显示为蓝色)是AppSec团队的即时反馈。</p><p id="4ba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些信息被传递给AppSec团队，他们将计划另一次扫描，并在后续扫描中覆盖遗漏的端点。</p><p id="0935" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点(在展示1中以橙色显示)是向SOC团队发出的信号，表明这些端点存在公开的漏洞。因此，如果在许多门户网站上发现攻击，SOC团队可以根据公开的漏洞而不是扫描的端点来确定优先级。</p><p id="0c3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，为足球队提供了这样的正在进行的攻击的可视化:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ld"><img src="../Images/90a242471de5d6298d841f12b80e0073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bOPWWqt5KqFXdrjIjdgBFw.png"/></div></div></figure><p id="59c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从视觉效果来看，SOC团队更容易确定优先级。Web Portal 4的攻击成功概率最高，因为在AppSec团队的扫描中有许多公开的漏洞和许多端点被遗漏。</p><p id="08ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应向漏洞管理团队、IT和开发团队传递另一个信息，即几乎没有公开的漏洞(在端点x、端点y上..)并且在相同的端点上观察到“n”次攻击。漏洞被利用的可能性更高。</p><p id="1601" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 5。正常流量和受到攻击时的异常检测</strong></p><p id="67da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用于异常检测的机器学习算法将应用“未扫描端点上的请求数”和“存在公开漏洞的端点上的请求数”的数据</p><p id="7ab6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">异常检测是一种用于跟踪每个数据集中罕见事件的方法。这些罕见事件在统计学上不同于其他数据。这将用于检测异常值和识别异常流量。</p><p id="428b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个无监督的异常检测算法将在这个解决方案中应用。无监督异常检测方法不需要训练数据，其工作原理是非常小百分比的数据不同于其余数据，并且是异常值。</p><p id="946b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果“未扫描的端点”或“存在公开漏洞的端点”上的请求数量出现异常峰值，异常检测方法将触发警报</p><p id="cb7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对“未扫描的端点”或“存在公开漏洞的端点”的攻击越多，就越有可能被不良行为者利用。</p><p id="b042" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种使用机器学习算法的警报可以帮助确定行动计划的优先次序。</p><p id="228f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 6。结论</strong></p><p id="81c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法可以通过对遗漏的端点给出即时反馈，帮助AppSec团队提高扫描覆盖率。足球队可以配备一种方法，帮助他们了解攻击成功或失败的概率。此外，当IT和开发团队的带宽有限时，他们可以根据每个端点上发生的攻击数量，了解与每个端点上的每个漏洞相关的风险。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><h2 id="2a34" class="ll lm iq bd ln lo lp dn lq lr ls dp lt jy lu lv lw kc lx ly lz kg ma mb mc md bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae me" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周时事通讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>