<html>
<head>
<title>[GraphQL IDOR]Leaking credit card information of 1000s of users [External Audit]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[graph QL IDOR]泄露数千用户的信用卡信息[外部审计]</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/graphql-idor-leaking-credit-card-information-of-1000s-of-users-d07eec732979?source=collection_archive---------2-----------------------#2022-12-20">https://infosecwriteups.com/graphql-idor-leaking-credit-card-information-of-1000s-of-users-d07eec732979?source=collection_archive---------2-----------------------#2022-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="29d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿大家好</p><p id="186b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在搜索一个网络应用程序。该计划是私人的；出于显而易见的原因，让我们假设域是redacted.com。通过利用两个不同的Graphql端点，我能够找到大量信息。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f88edef5b74123916e0db259e5b339e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h6u_N2zKRCxXC5sFSSCI4w.jpeg"/></div></div></figure><h1 id="5de1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">正在查找Graphql IDOR</h1><p id="1cf6" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">在对redacted.com进行初步调查时，我发现web应用程序使用GraphQL进行API管理。</p><p id="5f7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了将查询转换成可读的格式，我使用了graphql raider扩展，它将graphql查询和变量从不可读的JSON主体转换成可读的格式，其中查询和变量显示在单独的选项卡中。Graphql raider提取了' id '变量作为插入点。对此请求的响应包含用户的个人信息，包括信用卡信息。</p><p id="6fc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了两个帐户并检查了IDOR。该应用程序容易受到IDOR的攻击，我可以获得我的另一个帐户的个人信息。</p><h1 id="b854" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">发现一个奇怪的功能</h1><p id="675d" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">ID变量是一个12字符长的字符串，所以我不能猜测/强行取值。我正在寻找一种方法来获得id参数，浏览了burp suite repeater选项卡，发现了一个令人兴奋的端点。端点获取我的关注列表，响应包含我关注的用户的id值和个人资料图片。</p><p id="1d46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当用户在redacted.com上创建账户时，用户会自动关注一些公司高管。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="d487" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我点击这些高管的关注者列表时，会发送一个graphql查询，从用户的个人资料中获取信息，响应包含用户的ID和许多用户的个人资料图片。我发现了一个拥有百万粉丝的用户，这也是可以利用的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mc"><img src="../Images/de9b97fa7f64eb05488d1b4ca06cad65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GETgdod2FMv_zvix6o3oYw.png"/></div></div></figure><h1 id="0202" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">剥削</h1><p id="658a" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">我从以下公司高管列表的回复中收集了一个“id”来创建POC。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi md"><img src="../Images/54ca4bcee56e0b28c65ffefb6e753282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Or-1yVH2NhIubRQUHV-kEA.png"/></div></div></figure><p id="d9c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现graphql查询没有抵御暴力攻击的保护措施。在此之后，我使用bash脚本获取了id，并使用burp入侵者强行获取了数千用户的敏感数据。</p><h1 id="8ef8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">披露</strong></h1><p id="fa17" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">2020年12月26日报道</p><p id="e02d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">领英:</strong>【https://www.linkedin.com/in/vipul-sahu-a7a420174/】T4</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h2 id="0812" class="mm ky iq bd kz mn mo dn ld mp mq dp lh jy mr ms ll kc mt mu lp kg mv mw lt mx bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae me" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>