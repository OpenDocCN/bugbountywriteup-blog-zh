<html>
<head>
<title>WEB APPLICATION — BUSINESS LOGIC VULNERABILITIES</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">WEB应用程序—业务逻辑漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/web-application-business-logic-vulnerabilities-51be9c6b99fa?source=collection_archive---------0-----------------------#2021-09-13">https://infosecwriteups.com/web-application-business-logic-vulnerabilities-51be9c6b99fa?source=collection_archive---------0-----------------------#2021-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/878c578a4baae75b7e01620f6a348a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pV35n0nSmYlpK6xI"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">沙哈达特·拉赫曼在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><blockquote class="kd ke kf"><p id="e2df" class="kg kh ki kj b kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">业务逻辑漏洞是应用程序的设计、实现和概念中的缺陷，它允许攻击者引发意外行为。术语“业务逻辑”指的是定义web应用程序如何工作和行为的一组规则。</p></blockquote><p id="170c" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">每当我们在网络领域听到“Web应用程序漏洞”这一术语时，我们往往会想到OWASP十大漏洞或另一个主要漏洞，往往会忽略逻辑漏洞的影响。</p><p id="627e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">原因是逻辑的缺陷对于没有明确寻找它的人来说是看不见的。但是，攻击者可以通过简单地与应用程序交互来利用行为。</p><p id="b0f7" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这让我们想到了一个问题-</p><h1 id="c7b2" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">业务逻辑漏洞是如何产生的？</strong></h1><p id="f8c0" class="pw-post-body-paragraph kg kh iq kj b kk mg km kn ko mh kq kr lf mi ku kv lg mj ky kz lh mk lc ld le ij bi translated">这些缺陷通常是由于设计和开发过程中的漏洞而产生的。对最终用户如何与应用程序交互的错误假设会导致对用户输入的不充分验证。例如，如果开发人员完全依赖于用户只通过web浏览器传递数据这一事实，那么它将导致弱客户端控件来验证输入，而这可以通过使用web代理(如Burpsuite)很容易地绕过。</p><h1 id="a368" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">冲击！！</strong></h1><p id="f359" class="pw-post-body-paragraph kg kh iq kj b kk mg km kn ko mh kq kr lf mi ku kv lg mj ky kz lh mk lc ld le ij bi translated">此漏洞的影响是高度可变的，有时可能非常严重。这主要取决于用户将如何操作web应用程序，在某些情况下，漏洞本身并不构成重大威胁，但却是高严重性攻击的初始负载。</p><p id="28f2" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">影响的类型与web应用程序的功能直接相关，例如，如果缺陷在身份验证模块中，那么它将动摇web应用程序的完全安全性。同样，如果有缺陷的逻辑在金融交易中，那么它将影响资金的大量损失。</p><p id="a914" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在让我们更深入地了解一下逻辑漏洞的类型</p><h1 id="bd1c" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">业务逻辑漏洞示例- </strong></h1><p id="b0cb" class="pw-post-body-paragraph kg kh iq kj b kk mg km kn ko mh kq kr lf mi ku kv lg mj ky kz lh mk lc ld le ij bi translated">如前所述，缺陷与它们发生的特定环境有关。在这一节中，我们将看看设计和开发团队的一些主要缺陷，并了解它们如何影响业务。</p><ol class=""><li id="7600" class="ml mm iq kj b kk kl ko kp lf mn lg mo lh mp le mq mr ms mt bi translated"><strong class="kj ir">过度信任客户端控制</strong> -</li></ol><p id="7d72" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">从根本上来说，开发人员考虑到了这样一个事实，即用户将以期望的方式直接与应用程序进行交互，而忽略了来自客户端的任何恶意输入都会对web应用程序产生负面影响的事实。攻击者大多使用Burp代理在数据通过浏览器后篡改数据，以使开发人员使用的任何类型的客户端验证机制失败。</p><p id="3fe2" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们用一个例子来理解一下——</p><p id="9290" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">假设一个用户计划从一个非常著名的电子商务网站购买牛仔裤，该网站的价格标签为“X”。现在，在将其添加到购物车后，他/她进一步将请求发送到代理服务器而不是服务器，并试图通过'<em class="ki"> POST /cart </em>'请求篡改价格。通过简单地将任意值传递给price参数，然后将其转发给服务器，原始价格将被修改为最终用户提供的新值，因此损害了web应用程序的完整性和功能性。</p><p id="1d76" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">2.<strong class="kj ir">未能处理非常规输入</strong></p><p id="72f6" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">另一种类型的漏洞存在于应用程序没有被设计为处理来自终端用户的非常规输入时。大多数情况下，应用程序被定义为遵守特定的业务规则，例如用户不能输入不切实际的值，例如:在前面的部分中，如果用户试图订购比库存中可用数量更多的数量，那么服务器将通过给出错误来编辑它。</p><p id="7fe6" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">为了更好地理解这个漏洞，让我们看一个例子:</p><p id="4f53" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">想象一下，如果两个人‘A’和‘B’需要从A的账户交易钱到B的账户。如果在服务器端没有提供适当的输入验证，那么非常规的输入(比如“负值”)将会产生重大缺陷。由于应用程序将首先检查在转账之前是否有足够的资金，传递负值不仅会绕过这一条件，还会迫使B的帐户将资金转到错误的方向。</p><p id="0372" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kj ir"> 3。绕过双因素认证</strong></p><p id="6215" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">许多web应用程序通过实施双因素认证来防止非预期用户登录，从而增强了安全性。但是，2FA的不正确实现会导致完全绕过登录面板。</p><p id="981e" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">许多使用2FA的网站要求用户在一个页面上登录，然后在另一个页面上输入安全代码。但是假设用户将以相同的方式进行交互是有害的，因为攻击者可以使用前面讨论的工具Burp Proxy和repeater来绕过登录页面，一旦攻击者了解了应用程序的工作流，例如应用程序如何维护和识别用户会话，攻击者获得多个帐户的访问权限只是时间问题。</p><h1 id="11e6" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated"><strong class="ak">如何防范业务逻辑漏洞</strong></h1><p id="9a06" class="pw-post-body-paragraph kg kh iq kj b kk mg km kn ko mh kq kr lf mi ku kv lg mj ky kz lh mk lc ld le ij bi translated">在开发web应用程序之前，有许多事情需要记住，开发人员和测试人员应该对应用程序的目的和工作流程有一个完整的理解，并且他们应该避免对用户输入的隐含假设。</p><p id="60e4" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">开发团队应遵循最佳实践以防止致命后果，并应考虑应用程序在多种情况下的行为，应采取的一些步骤如下:</p><ol class=""><li id="477c" class="ml mm iq kj b kk kl ko kp lf mn lg mo lh mp le mq mr ms mt bi translated">开发团队应该为工作流的所有事务维护一个清晰的设计文档和数据流，记下在任何阶段做出的每个假设。</li><li id="3350" class="ml mm iq kj b kk mu ko mv lf mw lg mx lh my le mq mr ms mt bi translated">代码应该清晰明了，这样在最初的步骤中查看源代码和找到逻辑流程就不会很麻烦了。</li><li id="7eef" class="ml mm iq kj b kk mu ko mv lf mw lg mx lh my le mq mr ms mt bi translated">如果应用程序使用其他代码作为组件的引用，那么应该检查依赖关系的所有可能的副作用，以防恶意方异常操纵它们。</li></ol><p id="6893" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这些并不是保护应用程序应该采取的唯一步骤，许多其他步骤取决于功能。因此，无论何时与应用程序交互，都要睁大眼睛，因为你永远不会发现另一个缺陷。</p><p id="673b" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">继续寻找一个好的目标，让世界和互联网成为一个安全的居住地</p><p id="8807" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">更多这样的内容，请在medium here和LinkedIn上关注我</p><p id="f300" class="pw-post-body-paragraph kg kh iq kj b kk kl km kn ko kp kq kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><a class="ae kc" href="https://www.linkedin.com/in/sagar-tiwari-7a7639156/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/sagar-tiwari-7a7639156/</a></p></div></div>    
</body>
</html>