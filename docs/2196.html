<html>
<head>
<title>Finding 0-days in Enterprise Application — Red Team Diaries</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在企业应用中寻找0天—红队日记</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/finding-0-days-in-enterprise-application-471a409ade8d?source=collection_archive---------2-----------------------#2022-07-17">https://infosecwriteups.com/finding-0-days-in-enterprise-application-471a409ade8d?source=collection_archive---------2-----------------------#2022-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3e2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“全网站账户接管”的故事</p><p id="27d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们开始讨论漏洞的技术部分之前，我希望您简要介绍一下作为目标的应用程序。</p><p id="88ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它被称为'<a class="ae kl" href="https://www.ibm.com/common/ssi/cgi-bin/ssialias?subtype=ca&amp;infotype=an&amp;supplier=897&amp;letternum=ENUS204-143#@2h@78@" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a><strong class="jp ir">'</strong>统一访问门户，供员工通过单一平台访问基于It的应用程序。ESS应用程序由IBM销售，也可以与运行Lotus Domino服务器的SAP集成。</p><p id="a067" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一次持续的红队项目中，我偶然发现了这个web应用程序，并希望探索该应用程序的后身份验证功能，因此我开始收集所有可能导致后身份验证功能的相关信息。</p><p id="3ce9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于不知道登录字段中要传递的登录详细信息格式，我随机创建了一个所有默认用户名和密码的列表，但未能重用它们。</p><p id="d617" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们后来开始从可用的数据泄露中收集所有电子邮件地址和明文密码的列表，并对其进行暴力破解。幸运的是，一个电子邮件地址和密码的组合成功了。我们后来开始探索所有的后身份验证模块，因为这是一个单点登录应用程序，我们有很多模块要探索。在探索应用程序时，我遇到了多个常见的web应用程序漏洞，其中两个被证明有助于连锁攻击:</p><ol class=""><li id="c8eb" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">身份验证后:发现了提供电子邮件、员工ID、员工详细信息等的端点。创建了一个爬虫并收集了相同的。</li></ol><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi kv"><img src="../Images/1d7a5ac86915d9e055fdf64469cd03fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pdEI2_a-XENzqAwc3VQ_HQ.png"/></div></div></figure><p id="93c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.预认证:发现一个端点来重置员工的密码，其中需要有效的电子邮件地址和员工id。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lh"><img src="../Images/989a854e2b68ba7bec10783b64630df0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2uW54YYTDhjqUCM3Kp5CkA.png"/></div></div></figure><p id="2226" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">了解了电子邮件和员工ID之后，我们决定了解密码重置功能的流程。我输入了有效的员工id，而不是输入有效的注册公司电子邮件地址，我决定输入我的电子邮件地址并点击enter。<em class="li">轰！！！</em></p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/e3ad6443e9500f15962f18e3dc2aa74a.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/1*fJNJQpRMq9_WgJLas5peQA.gif"/></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lk"><img src="../Images/eaba84feb93129dbbc266dc2cffd44a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aoReXPLHQY_g8xRHeTsEMQ.png"/></div></div></figure><p id="cd7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序为我提供了一个新的登录密码。同样，我创建了一个暴力列表，为了测试的目的，我成功地重置了500多个帐户的密码。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ll"><img src="../Images/558fbac0ff1890d6d2bbc4234fbcd19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LKTWmwa3sxvIoEqpkw7mPA.png"/></div></div></figure><p id="6f96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">全世界至少有200多家公司在使用这个应用程序。该漏洞被报告给了我正在执行红队评估的公司，该公司决定关闭该门户，将来他们会将该门户迁移到另一个应用程序。同样的情况也报告给了母公司，即SAP及其合作伙伴IBM。</p></div></div>    
</body>
</html>