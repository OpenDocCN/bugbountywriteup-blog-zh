<html>
<head>
<title>Hacking Misconfigured Cloud Apps</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">破解错误配置的云应用</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hacking-misconfigured-cloud-apps-a46bed1069bd?source=collection_archive---------3-----------------------#2021-04-02">https://infosecwriteups.com/hacking-misconfigured-cloud-apps-a46bed1069bd?source=collection_archive---------3-----------------------#2021-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/60b25782a3c9c9b8576341d51f629316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*Yf2ns_Us0knBXoQK.png"/></div></figure><p id="4f54" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">去年，也就是2020年，超过89%的财富500强公司采用了云基础设施。云非常强大，由于当前的疫情，组织迁移到云更有意义，因为它可以远程供应，不需要组织端的人力，部署在云上的应用程序可以通过互联网供应。</p><p id="5416" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">部署web应用程序是一项共同的责任，配置错误对组织来说可能是灾难性的。</p><p id="930f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">写这篇博客的目的是展示小的错误配置在本质上是多么的具有破坏性。下面是两个测试案例，任何人都可以添加到他们的控制表中。</p><h1 id="9998" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">测试用例EC2实例中暴露的端口。</h1><p id="6346" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">通俗地说，EC2就像一个虚拟机或者一个远程运行在服务器上的OS。如果一个不应该暴露的端口暴露在外，那么黑客可以强行进入实例，在他们访问实例后，他们可以利用实例的计算能力窃取任何东西或做任何他们想做的事情。</p><p id="7770" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了测试这一点，我使用了一个像DVWA一样设计脆弱的实验室。</p><h2 id="bccf" class="lv kt iq bd ku lw lx dn ky ly lz dp lc kf ma mb lg kj mc md lk kn me mf lo mg bi translated">侦察</h2><p id="93ee" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">掌握了IP或网络的基本知识后，您可以使用Nmap扫描实例的端口。在下面的测试中，我的攻击机器在VPC网络中。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/decdd9c5c77aa25c7d1139973a999589.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HyfQz-Ifkk8cBARL"/></div></div></figure><ul class=""><li id="e98e" class="mq mr iq jw b jx jy kb kc kf ms kj mt kn mu kr mv mw mx my bi translated"><em class="mz">sudo nmap-sS-script http-enum-v-top-ports 10000-g80 10 . 0 . 100 . 11</em></li></ul><p id="829d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我的情况下，我已经知道了IP，大多数时候应用程序也可以泄漏IP的，否则你可以随时做侦察。从上面的截图可以看到，发现端口22是打开的。</p><h2 id="c604" class="lv kt iq bd ku lw lx dn ky ly lz dp lc kf ma mb lg kj mc md lk kn me mf lo mg bi translated">第二步:攻击</h2><p id="0009" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">根据您的发现，您的攻击方法可能有所不同，但从恶意黑客试图访问22端口开放的EC2的角度来看，最合适的方法是暴力攻击。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/bafcbd573e0b3b936a004aa25fa65767.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QzNWt1MALHFAFDR1"/></div></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/84c8ac8c48e9da8b6c911521b5b96789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*i2kCY68T__Pdvcjd"/></div></div></figure><p id="a03b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了执行蛮力，我用了九头蛇。您可以使用下面的命令来做同样的事情，我使用了实验室自带的自定义词典，您可以使用不同的单词表，我同意所有安全爱好者的观点，暴力破解在这里不是最好的方法，但这只是一个测试案例，您可能会很幸运。</p><ul class=""><li id="36bc" class="mq mr iq jw b jx jy kb kc kf ms kj mt kn mu kr mv mw mx my bi translated"><em class="mz">hydra-f-V-V-l ec2-user-P { dictionary file } { target IP } ssh</em></li></ul><p id="e7a3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗯，你们中的一些人可能想知道为什么ec2-user被写成一个用户，答案很简单，默认情况下大多数ec2实例都有这个用户名，这就是为什么你可以强行进入一个实例。</p><p id="12bf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">获得一组正确的凭证后，您可以ssh到实例中。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/9763b47f086e4c7311bfc0bd9b4efaab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ePP82dMi9SFOhX_x"/></div></div></figure><h1 id="d888" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">测试用例2:错误配置的S3桶</h1><p id="32d0" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">S3是由AWS提供的对象存储，S3意味着简单的存储服务，它有桶的概念，用通俗的语言来说就是文件夹，其中也有关于文件夹的元数据，例如，谁拥有它，最后一次访问是公共的还是私有的。部署在云上的Web应用程序可以使用这个服务，或者可以使用来自另一个供应商的类似服务来存储、管理和访问数据。</p><p id="3146" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果这个s3存储桶存储敏感数据，并且被错误配置，作为一个例子，考虑一个可以通过互联网公开访问的s3存储桶，这对于犯这种错误的组织来说会花费一大笔钱。</p><p id="062e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">攻击者可以获得大量敏感数据或对公司数据的深入了解，他可以利用这些数据来策划其他攻击等等。</p><p id="08bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">Grayhatwarfare.com是一个网站和一个重要的工具，pentester可以在执行侦察时使用，因为它索引不受保护的公共S3桶。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mh"><img src="../Images/18fd75253e3439afebb6bcae94e4fba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Xd7_N9Q5Guv54BT"/></div></div></figure><p id="f0c6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我不是说你只能在s3上得到你的手，我在这里建议的是桶或存储可以被公开，可以被搜索引擎索引，无论是S3桶还是Azure blob存储。</p><p id="1b4e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你也可以利用专业搜索或谷歌词典来查看或搜索相同的内容。</p><p id="1ccb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这完全取决于服务到服务的错误配置可能在任何地方，所有攻击者需要利用云是大海捞针，这就是本文的全部内容，不久将添加更多的测试案例。</p></div></div>    
</body>
</html>