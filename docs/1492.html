<html>
<head>
<title>My First Instagram Bug Bounty Report</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的第一份Instagram Bug赏金报告</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/my-first-instagram-bug-bounty-report-682f39a45994?source=collection_archive---------1-----------------------#2021-07-29">https://infosecwriteups.com/my-first-instagram-bug-bounty-report-682f39a45994?source=collection_archive---------1-----------------------#2021-07-29</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="9c3c" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">有总比没有好，即使不如人意。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/db82a4e090ee94a7fb26de0acec6d8e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PvexCsYG1h82Feu9"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">由<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的<a class="ae ky" href="https://unsplash.com/@kvalifik?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Kvalifik </a>拍摄的照片</figcaption></figure><blockquote class="kz"><p id="519c" class="la lb it bd lc ld le lf lg lh li lj dk translated">光是标题就足以让你兴奋了吧？好吧，拿上你的咖啡，跟我坦白。</p></blockquote><h2 id="3553" class="lk ll it bd lm ln lo dn lp lq lr dp ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">介绍</h2><p id="622a" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated">几天前，在测试一个网站的漏洞时，我在一个标签页中打开了Instagram。在某个时候，那个标签向它的服务器发送了一些数据，我的<strong class="mi iu">代理</strong>拦截了它，让我注意到一个有更高赏金机会的更好的目标。</p><blockquote class="kz"><p id="7111" class="la lb it bd lc ld my mz na nb nc lj dk translated">有一个关于这个的POC视频，但是不知道怎么贴在这里。</p></blockquote><p id="581b" class="pw-post-body-paragraph mg mh it mi b mj nd ju ml mm ne jx mo lt nf mq mr lx ng mt mu mb nh mw mx lj im bi translated">经过几个小时试图找到一些弱点，我放弃了。就在那时，我收到了一封来自<strong class="mi iu"> HackerOne </strong>的电子邮件，要求我提供关于几天前一份报告的更多信息，该报告涉及一个逻辑重置密码链接的缺陷。老实说，我不想尝试测试Instagram的这个相同的缺陷，因为我们都知道他们的安全性是最重要的，或者至少我是这么认为的。</p><h2 id="29de" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">《我的宝贝》</h2><p id="ce1e" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated">Instagram的密码重置链接有一个奇怪的缺陷。这些是重现它的步骤。</p><ol class=""><li id="6e52" class="nn no it mi b mj np mm nq lt nr lx ns mb nt lj nu nv nw nx bi translated">要求两个密码重置链接，在浏览器中打开它们。</li><li id="188e" class="nn no it mi b mj ny mm nz lt oa lx ob mb oc lj nu nv nw nx bi translated">打开两个点击，在其中一个标签中，更改您的密码。</li><li id="4987" class="nn no it mi b mj ny mm nz lt oa lx ob mb oc lj nu nv nw nx bi translated">更改密码后，转到您的设置并注销。</li><li id="d27f" class="nn no it mi b mj ny mm nz lt oa lx ob mb oc lj nu nv nw nx bi translated">现在，跳到第二个选项卡，再次更改密码，就像您之前做的那样。</li></ol><p id="5d24" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">问题来了，Instagram未能杀死第二个未使用的<em class="og">链接</em>。<strong class="mi iu">这个漏洞让攻击者接管你的帐户</strong>，因为让他们使用一个不应该工作的链接第二次更改你的密码。</p><h2 id="bcd9" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">真正的威胁</h2><p id="ade2" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated">这个漏洞的更大问题不仅在于它让你使用一个不应该工作的链接重新设置密码。下面是我在测试它时了解到的一些更危险的事情。</p><ol class=""><li id="9ba5" class="nn no it mi b mj np mm nq lt nr lx ns mb nt lj nu nv nw nx bi translated">当您第一次更改密码时，您会收到一封电子邮件通知您。但是当你第二次做的时候，你将一无所获。</li><li id="a7df" class="nn no it mi b mj ny mm nz lt oa lx ob mb oc lj nu nv nw nx bi translated">继续打开你的手机原生Instagram应用程序会让你退出，就像它应该做的那样。但是当你试图使用上次设置的密码重新登录时，它不会让你这样做。它只接受使用这两个链接创建的第一个密码。</li><li id="d56b" class="nn no it mi b mj ny mm nz lt oa lx ob mb oc lj nu nv nw nx bi translated">不像大多数重置链接。这是很长的代码串，每次你得到一个新的链接时都会改变。这个只有一个5/6字母的单词，作为你账户的令牌。</li></ol><h2 id="d79c" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">结果和一个非常可能的攻击场景</h2><p id="4c81" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated"><strong class="mi iu">受害者；</strong> <br/>你向一个认识的人要电话，因为你一时不能用手机，所以要打电话或找东西。你上了这个人的Instagram，看了一眼他的邮件，编了个故事说你被黑了，然后把他注销。</p><p id="d944" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">注销他的帐户后，要求两次密码重置链接。打开他的邮件app，记住链接的5/6字母令牌。为了节省时间，您已经可以在自己的密码重置链接中打开手机浏览器标签。现在把你的<strong class="mi iu">令牌</strong>换成他的。</p><p id="70f9" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">一旦那个人拿回他的手机，并试图进入他的个人资料，这并不保证会马上发生，他会注意到两件事，他的帐户被注销，一个新的密码重置电子邮件。此人的第一反应将是惊慌失措，并试图通过该电子邮件找回自己的个人资料。一旦进入他的个人资料，他会继续查看，看到Instagram上的故事说<em class="og">你被黑了</em>，然后把它撤下来。</p><p id="572f" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated"><strong class="mi iu">攻击者；</strong> <br/>在原生应用中使用你自己的Instagram账户，你将在受害者账户上检查何时攻击的提示。暗示？我们之前做的Instagram的故事，甚至因为害怕更多的<em class="og">“攻击”</em>而将账户转为私有。一旦得到提示，继续从打开的选项卡中更改密码。他不会收到电子邮件告诉他，而且他的密码仍然有效，以防他在你更改密码后注销。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/afe7b58a9a80b3b83016dedf215d47ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*P_3sl-tJ-vkPNyn3LZTK5w.png"/></div></figure><p id="a316" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">看到这是一件严重的事情，我联系了脸书，告诉他们我的发现，以为我发现了一些有趣的东西。许多事情都没有正常工作，因为这是很可能发生的事情，即使是在会议或健身房这样的地方把手机放在看不见的地方，我自己也见过很多次。</p><h2 id="e8f8" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">他们的反应</h2><p id="bc72" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated">他们回复我很快，但是说实话。我没想到会得到这样的回应。在最初的回复中，他们甚至不明白我用一个<strong class="mi iu"> POC视频向他们展示的是什么，</strong>这就是为什么我和他们反复讨论，试图用文字向他们解释在一个视频和两张照片*facepalm*中非常清楚的东西</p><p id="5a09" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">最后，当他们无法否认这个缺陷时，这就是他们的回应。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/d075c82e905ad8fd376f7ffb5784a1e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*51NrDE6ruAPTYq0IvO_HxQ.png"/></div></figure><p id="4161" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">我读到这里感到很惊讶，因为我们都使用WhatsApp，而且都知道他们不允许人们在两部不同的手机上使用WhatsApp。为什么？因为任何人只要拿到你的手机，就可以“黑掉”你的账户，在不止一个地方使用。当然，使用他同样的逻辑，一些手机会被锁定，但至少对于androids用户来说，这不会阻止攻击者暴力破解你的手机，我甚至给他们发了一个视频。</p><p id="3bd5" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">他们没有试图在这里使用相同的WhatsApp逻辑。在他们看来，这是一次“<strong class="mi iu">理论上的攻击</strong>，因为他们不相信攻击者无法接触到受害者的手机甚至电子邮件。为了防止这些攻击，他们只让用户使用一个帐户。</p></div><div class="ab cl oi oj hx ok" role="separator"><span class="ol bw bk om on oo"/><span class="ol bw bk om on oo"/><span class="ol bw bk om on"/></div><div class="im in io ip iq"><h2 id="6802" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">不要对我们动粗</h2><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/a67cdb484adcfe514e404c5cd3d9a69f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1182/format:webp/1*dPLD15kF-Es4rH50K3lO5Q.png"/></div></figure><p id="313f" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">如此处所示，他们甚至不关心他们的缺陷，他们的借口是一旦你得到物理访问不是他们的问题。嗯，不应该是这样的，仅仅因为你可以得到一些东西并不意味着它应该这么容易被黑掉。</p><h2 id="6723" class="lk ll it bd lm ln ni dn lp lq nj dp ls lt nk lv lw lx nl lz ma mb nm md me mf bi translated">结论</h2><p id="e9ec" class="pw-post-body-paragraph mg mh it mi b mj mk ju ml mm mn jx mo lt mp mq mr lx ms mt mu mb mv mw mx lj im bi translated">这不是我第一次与脸书的傲慢打交道，他们只会在你向他们展示你能做一些真正的伤害时才会认真对待你，而不是在deep web上出售它，你转向他们并祈求奖励。</p><p id="189a" class="pw-post-body-paragraph mg mh it mi b mj np ju ml mm nq jx mo lt od mq mr lx oe mt mu mb of mw mx lj im bi translated">这就是为什么我从来没有向他们报告更大的事情，他们不值得。你可能是有史以来最白的黑客，但知道如何黑掉或恢复一个用户的账户总是好的。😈</p></div></div>    
</body>
</html>