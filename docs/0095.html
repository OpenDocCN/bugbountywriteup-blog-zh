<html>
<head>
<title>Integrating OWASP Dependency Check in to development process</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将OWASP依赖性检查集成到开发过程中</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/integrating-owasp-dependency-check-in-to-development-process-f53ae3797439?source=collection_archive---------5-----------------------#2018-04-30">https://infosecwriteups.com/integrating-owasp-dependency-check-in-to-development-process-f53ae3797439?source=collection_archive---------5-----------------------#2018-04-30</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="4838" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">OWASP依赖项检查是一个众所周知的开源工具，它可以跟踪项目中的依赖项，并识别具有已知已发布漏洞的组件。该工具支持多种语言和平台，如Java、.NET，Ruby和Python。在项目中使用依赖项检查的最简单的方法之一就是手动运行它。这种方式至少有一个缺点:您必须确保定期运行该工具。幸运的是，有几种方法可以让这个过程自动化。</p><p id="676f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">但不幸的是，有时仅仅自动化是不够的。如果该工具报告了一个漏洞，这意味着必须有人来修复它。至少评价一下问题就好了。在一个完美的世界中，所有的问题都是立即解决的，但是在现实世界中，开发团队总是没有时间做这些。除了将依赖项检查集成到CI/CD中之外，可能还有几个其他步骤来更新易受攻击的依赖项。</p><h1 id="6f22" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">将OWASP依赖项检查集成到CI/CD中</h1><p id="9689" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">首先，您可以将该工具集成到您喜欢的构建系统中。Gradle、Maven和其他插件可以让你轻松地将依赖检查加入到你的构建和测试例程中。接下来，Jenkins有一个插件，允许你将工具集成到你的CI/CD管道中。因此，您可以在您的Jenkins中获得依赖性检查报告。如果您的Jenkins被配置为针对每个提交、分支或拉请求运行一个作业，那么一旦关于它们的信息公开，您很可能会收到关于易受攻击组件的通知。有一个例外。如果您不经常更新您的应用程序，但是它仍然部署着，那么您就有可能没有及时收到通知。为了解决这个问题，您可以将Jenkins配置为定期运行依赖性检查(例如，每晚)。</p><h1 id="4d92" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">更新易受攻击的依赖项的问题</h1><p id="b48e" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">正如我之前提到的，将OWASP依赖项检查与Jenkins集成可能不足以保持依赖项最新。</p><p id="58ad" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们需要确保有人阅读报告并评估已识别的漏洞。但是一个工程师可能会忘记看报告，甚至可能会忽略它，以为别人会这样做。然后，别人也可以忘掉这件事，或者也这么想。结果，经过一段时间后，我们可以发现，即使我们与Jenkins集成了依赖检查，X个月来仍然存在易受攻击的组件。</p><p id="64ab" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">第二，我们需要确保在发现易受攻击的组件后，确实有人对其进行了更新。在一个完美的世界里，这可以马上完成，但在现实中我们会遇到一些问题。</p><p id="8888" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">让我们假设我们的开发团队正在开发重要的特性X，它需要尽快交付。最后期限快到了。及时依赖性检查识别出漏洞。但是更新易受攻击的库有引入回归、兼容性问题等的风险。减轻这种风险的一种方法是拥有良好的测试程序。理想情况下，它应该是在您的CI/CD中运行的自动化测试套件。如果一个完整的测试周期需要大量的时间，那么特性X的交付可能会延迟，这让我们很不高兴。或者，也许我们只是没有好的测试覆盖率。</p><p id="7bfb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接下来，更新一个库可能会导致更新其他库。总的来说，这还不算太坏，但它可能会增加一点引入回归的风险。此外，新版本的库可能会改变API，从而导致代码更新。同样，这需要时间，增加了倒退的风险等等。最终它会延迟我们重要的特性x的交付。</p><p id="95f3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">此外，组件中的漏洞可能具有不同的严重性级别和影响。其中一些甚至可能对项目没有影响。另外，我们不应该忘记OWASP依赖项检查可能会报告误报。这一切都意味着首先应该评估报告的问题，结果可能是问题并不严重，没有必要推迟功能X尝试修复这个问题。</p><h1 id="db76" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">设置更新易受攻击的相关性的流程</h1><p id="e8d2" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">一方面，在现实世界中，一旦发现易受攻击的组件，强制更新并不是一个好主意。另一方面，我们需要确保我们不会忘记稍后更新它们。</p><p id="d791" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">设置更新易受攻击组件的过程可能如下所示:</p><ol class=""><li id="ded3" class="lr ls it js b jt ju jx jy kb lt kf lu kj lv kn lw lx ly lz bi translated">集成OWASP依赖性检查以构建system和Jenkins。该检查应包含在由提交或拉取请求触发的常规作业中。该检查还应在单独的作业中定期运行。</li><li id="5465" class="lr ls it js b jt ma jx mb kb mc kf md kj me kn lw lx ly lz bi translated">引入质量关，如果发现严重程度高的漏洞，工作就会失败。让我们参考一下<a class="ae mf" href="https://nvd.nist.gov/vuln-metrics/cvss" rel="noopener ugc nofollow" target="_blank"> NIST </a>，如果一个漏洞的CVSS分数高于7，那么它的严重性级别就很高。</li><li id="7685" class="lr ls it js b jt ma jx mb kb mc kf md kj me kn lw lx ly lz bi translated">一旦作业失败，评估报告的漏洞。安全工程师也可能参与其中。如果确定漏洞足够危险，那么应该立即更新易受攻击的组件。</li><li id="c405" class="lr ls it js b jt ma jx mb kb mc kf md kj me kn lw lx ly lz bi translated">如果确定漏洞对项目来说不是那么重要，那么就创建一个标签来更新易受攻击的组件。接下来，将已识别漏洞的记录添加到<a class="ae mf" href="https://jeremylong.github.io/DependencyCheck/general/suppression.html" rel="noopener ugc nofollow" target="_blank">抑制文件</a>中，以阻止构建失败。该记录应包含一个指向该票证的链接。这里，我们使用抑制文件作为需要修复的已确认已知故障的列表。</li><li id="9717" class="lr ls it js b jt ma jx mb kb mc kf md kj me kn lw lx ly lz bi translated">定期检查票证列表，并计划修复易受攻击的组件。</li></ol><p id="9386" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这一进程试图实现安全与发展之间的平衡。一方面，如果可以接受的话，我们有办法推迟更新易受攻击的依赖项。另一方面，我们有更新易受攻击的组件的明确积压，所以我们可以更好地控制这种情况。当然，这个过程不会神奇地解决问题——最终需要有人去更新库。</p><h1 id="b5f1" class="ko kp it bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll bi translated">通过OWASP相关性检查实施质量关</h1><p id="e937" class="pw-post-body-paragraph jq jr it js b jt lm jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj lq kl km kn im bi translated">如何设置上面定义的质量关？幸运的是，这很简单。OWASP依赖项检查有一个<a class="ae mf" href="https://jeremylong.github.io/DependencyCheck/dependency-check-cli/arguments.html" rel="noopener ugc nofollow" target="_blank">选项</a>，它设置一个CVSS分数，并指示工具在识别出一个CVSS分数等于或高于该分数的漏洞时返回一个非零退出代码。Gradle，Maven和Jenkins的插件支持这个选项。这里有一个<code class="fe mg mh mi mj b">build.gradle</code>文件的例子，它介绍了这样一个质量门:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="893a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要在Jenkins中使用依赖项检查报告，您需要在Jenkins管道中运行<code class="fe mg mh mi mj b">dependencyCheckPublisher</code>任务。一旦配置了质量门，如果发现了漏洞，作业将会失败，这意味着依赖性检查之后的步骤可能无法运行。你需要确保<code class="fe mg mh mi mj b">dependencyCheckPublisher</code>一直在运行，即使质量关失败了。以下是Jenkinsfile的一个示例:</p><figure class="mk ml mm mn gt mo"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="e7e4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">还有一个很好的改进，可以让我们的生活变得轻松一些。OWASP依赖性检查使用<a class="ae mf" href="https://nvd.nist.gov/" rel="noopener ugc nofollow" target="_blank">国家漏洞数据库</a> (NVD)。该工具首次运行时会下载整个数据库。然后，该工具会尝试定期获取更新。不幸的是，事实证明，NVD有时可能会关闭。当NVD不可用时，依赖性检查将失败。如果我们有上面定义的质量关，那么工作也会失败，这可能会阻碍我们的CI/CD流程。但这不是我们想要的。为了解决这个问题，大多数插件都提供了忽略这类问题的选项。但这意味着，如果NVD关闭，我们将完全跳过检查。幸运的是，有一个更好的解决方案。您可以配置一个单独的Jenkins作业，定期下载NVD的副本(例如，它可以每晚运行)。然后，您可以<a class="ae mf" href="https://jeremylong.github.io/DependencyCheck/data/mirrornvd.html" rel="noopener ugc nofollow" target="_blank">配置其他作业来使用副本</a>。</p><p id="6c91" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">总之，在这里你可以找到<a class="ae mf" href="https://github.com/artem-smotrakov/spring-boot-fun/releases/tag/v1.0" rel="noopener ugc nofollow" target="_blank">一个带有上述</a>质量关的Spring Boot应用的例子。尽情享受吧！</p></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="ad23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="my">原载于</em><a class="ae mf" href="https://blog.gypsyengineer.com/en/security/integrating-owasp-dependency-check.html" rel="noopener ugc nofollow" target="_blank"><em class="my">blog.gypsyengineer.com</em></a></p><figure class="mk ml mm mn gt mo gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/dd92c6d239003f4cfbd038737afa07de.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*CDJIettYqEbODrv_CsCsOg.png"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk translated">来自<a class="ae mf" href="https://jeremylong.github.io/DependencyCheck/" rel="noopener ugc nofollow" target="_blank">https://jeremylong.github.io/DependencyCheck/</a></figcaption></figure></div><div class="ab cl mr ms hx mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="im in io ip iq"><p id="3651" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="my">关注</em> <a class="ae mf" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="my"> Infosec报道</em> </a> <em class="my">获取更多此类精彩报道。</em></p><div class="ng nh gp gr ni nj"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd iu gy z fp no fr fs np fu fw is bi translated">信息安全报道</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">medium.com</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx na nj"/></div></div></a></div></div></div>    
</body>
</html>