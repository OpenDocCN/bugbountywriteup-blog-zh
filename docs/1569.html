<html>
<head>
<title>Exposing Millions of IRCTC Passengers' ticket details.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">暴露了数百万IRCTC乘客的车票信息。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/exposing-millions-of-irctc-passengers-ticket-details-53338280fb9e?source=collection_archive---------0-----------------------#2021-09-12">https://infosecwriteups.com/exposing-millions-of-irctc-passengers-ticket-details-53338280fb9e?source=collection_archive---------0-----------------------#2021-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ab75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">你好，</em></p><p id="4ef8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">这里是Renganathan，我是一名职业黑客&amp;安全研究员。</em></p><p id="b829" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我因报告了LinkedIn、United Nations、BYJU's、Nike、Lenovo、Upstox网站应用程序中的安全漏洞而得到了他们的认可。</em></p><p id="75de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">什么是IRCTC？</strong></p><p id="f7dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">印度最大的在线票务运营网站IRCTC运营着最大的电子商务网站之一，拥有约3000万注册用户，每天约有55万至60万次预订，使其成为世界第二大繁忙的旅游门户网站，每年创收2000万美元(来源:Wiki) </em> </strong></p><p id="9a00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我以普通人的身份订票时，我突然有了一个测试漏洞的想法。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/e46eed52613db1fd388951bc31a81d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*DPyvegYtn9go7o_FdzM49Q.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">黑客模式！</figcaption></figure><p id="82f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我想到的第一个漏洞就是<a class="ae ky" href="https://portswigger.net/web-security/access-control/idor" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> IDOR </strong> </a>。以下是重现的步骤。</p><ol class=""><li id="10d4" class="kz la iq jp b jq jr ju jv jy lb kc lc kg ld kk le lf lg lh bi translated">登录您的<a class="ae ky" href="https://www.irctc.co.in/nget/train-search" rel="noopener ugc nofollow" target="_blank"> IRCTC </a>账户</li><li id="0447" class="kz la iq jp b jq li ju lj jy lk kc ll kg lm kk le lf lg lh bi translated">进入我的帐户&gt;我的交易&gt;预订机票历史记录。</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ln"><img src="../Images/a00cd7b53e6de947c8fe9a9d473614fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6fag9uQkFe30IfR2cTJjKQ.png"/></div></div></figure><p id="3be6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.所以有下面的票，点击后会展开</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ls"><img src="../Images/8fb87fa940f46b091512685245aeea12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsjwJonZ_Cc-x-6kgz4UrA.jpeg"/></div></div></figure><p id="5ce8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用了burp suite，打开拦截，看到了一个below-get请求。</p><pre class="kn ko kp kq gt lt lu lv lw aw lx bi"><span id="a6ea" class="ly lz iq lu b gy ma mb l mc md">GET /eticketing/protected/mapps1/historySearchByTxnId/XXXXXXXXXX48?currentStatus=N HTTP/1.1<br/>Host: <a class="ae ky" href="http://www.irctc.co.in" rel="noopener ugc nofollow" target="_blank">www.irctc.co.in</a><br/>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:91.0) Gecko/20100101 Firefox/91.0<br/>Accept: application/json, text/plain, */*<br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Referer: <a class="ae ky" href="https://www.irctc.co.in/nget/txn/my-transactions?page=Booked%20Ticket%20History&amp;eWallet=false" rel="noopener ugc nofollow" target="_blank">https://www.irctc.co.in/nget/txn/my-transactions?page=Booked%20Ticket%20History&amp;eWallet=false</a></span></pre><p id="ec12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试使用IDOR并减少事务ID的数量，然后转发数据包。</p><p id="2469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的。我获得了一个随机用户的交易和车票信息，如车次、出发时间、旅程持续时间、PNR号、车票状态、上车站、乘客信息，如姓名、座位信息、性别和年龄。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/495419f66b43b52c176de04c83cbf2f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*ofq8Dj4-aiwjPgPNeFXnNg.jpeg"/></div></figure><p id="8ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为后端代码是相同的，所以它也容易被取消机票、更改登机点、订购食物、预订酒店、旅游套餐，甚至预订巴士。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/3cc952b94186c9266acfa9702372aad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:530/format:webp/0*FP2x9QYC0wmcaIAH.jpg"/></div></figure><p id="06a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即记录了一个POC，并将其报告给了incident@cert-in.org.in</p><p id="e366" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概念验证:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi mg"><img src="../Images/f980341be4e4b8d01292277a6a2caf7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*m8GDPMbWcITW6OyylWL5bQ.gif"/></div></div></figure><p id="0150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">时间线:</p><p id="3469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年8月30日中午12点45分:已报告</p><p id="0485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年8月30日下午1:30:分配了一张票。</p><p id="8e17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年9月4日:问题已解决(重新测试)</p><p id="8ab6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2021年9月11日:IRCTC确认。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/a271aeaa35d0b9c1bc02ff2387c7020e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*TkRu2jT9BBoHEDgFLUMAdQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">来自IRCTC的确认</figcaption></figure><p id="3adc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读:)<br/>注意安全。</p><p id="0350" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ky" href="https://www.instagram.com/renganathanofficial/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/renganathanofficial</a></p><p id="19a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://twitter.com/IamRenganathan】</p></div></div>    
</body>
</html>