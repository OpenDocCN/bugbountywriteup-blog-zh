<html>
<head>
<title>[Open redirect] Developers are lazy(or maybe busy)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[Open redirect]开发人员很懒(或者可能很忙)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/open-redirect-developers-are-lazy-or-maybe-busy-6c51718b10e4?source=collection_archive---------1-----------------------#2018-12-12">https://infosecwriteups.com/open-redirect-developers-are-lazy-or-maybe-busy-6c51718b10e4?source=collection_archive---------1-----------------------#2018-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3c3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这次我要写一个我在一个私人程序中发现的开放式重定向错误。bug本身是一个唾手可得的果实，但报告它的过程足够有趣。</p><p id="1d47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们谈谈bug本身。🙂</p><p id="0020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们称这个域为example.com。我先注册了一个账户，然后四处逛逛。然后我找到了一个网址:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="6765" class="ku kv iq kq b gy kw kx l ky kz"><a class="ae la" href="https://www.example.com/account/signup?next=https%3A%2F%2Fwww.example.com&amp;next=@google.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com/account/login?next=https%3A%2F%2Fwww.example.com</a></span></pre><p id="0748" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">"测试打开重定向的时间到了。"我告诉自己。</p><p id="27c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我尝试了最简单的有效载荷:<a class="ae la" href="https://www.example.com/account/signup?next=https%3A%2F%2Fgoogle.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com/account/login?next = https % 3A % 2F % 2f Google . com</a>。没用。然后我尝试了next=https://example.com@google.com，//google.com，javascript:alert(1)(将一个开放的重定向转向XSS)等。但是这些都不起作用。然后HPP (HTTP参数污染)出现在我的脑海里:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="669b" class="ku kv iq kq b gy kw kx l ky kz"><a class="ae la" href="https://www.example.com/account/login?next=https%3A%2F%2Fwww.example.com&amp;next=https:%3A%2F%2Fgoogle.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com/account/login?next=https%3A%2F%2Fwww.example.com&amp;next=https%3A%2F%2Fgoogle.com</a></span></pre><p id="bc3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我没有期待什么，相反，我只是试了一下，看看会发生什么。然后我的地址栏变成了</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="46e5" class="ku kv iq kq b gy kw kx l ky kz"><a class="ae la" href="https://example.com%2Cwww.example.com" rel="noopener ugc nofollow" target="_blank">https://example.com%2Cwww.google.com</a></span></pre><p id="34f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的浏览器向我抛出错误信息。</p><p id="ab63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那一刻，我知道我可以利用它。第二个<strong class="jp ir">下一个</strong>参数的值没有像第一个那样被过滤。%2C只是一个逗号，所以example.com处理这个请求的机制基本上是用逗号连接两个<strong class="jp ir">和下一个</strong>，而不过滤第二个。</p><p id="73bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我这样做又怎么样呢？</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="2bc9" class="ku kv iq kq b gy kw kx l ky kz"><a class="ae la" href="https://www.example.com/account/login?next=https%3A%2F%2Fwww.example.com&amp;next=@google.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com/account/login?next=https%3A%2F%2Fwww.example.com&amp;next=<strong class="kq ir">@</strong>google.com</a></span></pre><p id="ea75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，现在第二个参数中有一个“@”。所以最后example.com会把我重定向到https://example.com,@google.com，实际上是去google.com。所以现在我要报告一个成功的开放重定向。(我曾试图深入挖掘，并利用它来更严重的错误，错误我失败了😦)</p><figure class="kl km kn ko gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lb"><img src="../Images/b6b773439fa2119181efedc989c65b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jbawN1go2N-xbtdV"/></div></div></figure><p id="0bf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二天被告知是重复的，bug被修复。😦。但是我想到了一个主意:你为什么不检查一下他们是否已经完全修好了？也许他们在修理过程中犯了一些其他的错误！</p><p id="d85f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我去检查一下。我在上面的登录URL上尝试了很多有效载荷，但是我不能再利用它了。我开始说服自己，他们已经很好地解决了这个问题，我不再需要打开重定向错误。</p><p id="ba0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等等，“没有更多的开放重定向错误”？我可以检查其他端点的开放重定向错误！</p><p id="1455" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我没有登录页面(这是固定的)，而是尝试了注册页面，如下所示:</p><pre class="kl km kn ko gt kp kq kr ks aw kt bi"><span id="920c" class="ku kv iq kq b gy kw kx l ky kz"><a class="ae la" href="https://www.example.com/account/signup?next=https%3A%2F%2Fwww.example.com&amp;next=@google.com" rel="noopener ugc nofollow" target="_blank">https://www.example.com/account/signup?next=https%3A%2F%2Fwww.example.com&amp;next=@google.com</a></span></pre><p id="6605" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我成功了！</p><figure class="kl km kn ko gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lj"><img src="../Images/4aa47c34ecf5d8c53995df1b63658955.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*T7R81vd6UlEHE6vL14UdqQ.jpeg"/></div></div></figure><p id="4293" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以结论是，他们的开发人员在修复登录页面时忘记了注册页面。</p><p id="34dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我拿到了赏金。开发人员很懒，或者可能只是很忙。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="bf51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">赏金奖励:150美元</p><p id="fbc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">*备注:在我之前发现登录页面bug的bug赏金猎人，他也忘了在注册页面检查同样的bug。罗尔。猎人也懒！</p></div></div>    
</body>
</html>