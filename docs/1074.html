<html>
<head>
<title>Site Defacement and Denial of Service via. Cross-Site Scripting</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">网站污损和拒绝服务。跨站点脚本</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/site-defacement-and-denial-of-service-via-cross-site-scripting-9c54d1d3fd06?source=collection_archive---------1-----------------------#2021-01-20">https://infosecwriteups.com/site-defacement-and-denial-of-service-via-cross-site-scripting-9c54d1d3fd06?source=collection_archive---------1-----------------------#2021-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bcf7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在Oracle产品中绕过正则表达式过滤</h2></div><blockquote class="kf kg kh"><p id="bf06" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">“跨站点脚本(XSS)可能是最广为人知的网络漏洞，它会让您的站点遭到黑客攻击。当网页显示未经正确验证的用户输入(通常通过JavaScript)时，就会发生XSS。犯罪黑客可以利用输入过滤的缺失，使网页在查看该网页的任何用户的计算机上执行恶意代码。”</p><p id="ca10" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">—<a class="ae lf" href="https://www.dummies.com/" rel="noopener ugc nofollow" target="_blank">https://www.dummies.com/</a></p></blockquote><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi lg"><img src="../Images/239c1a8ee0631219bdd8f5db6e27502a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AuruDUTKdDmxZLBqxnKW8g.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">用户输入有点像sus(一个“在我们之中”的引用):P</figcaption></figure><p id="dc00" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">对此类客户端注入攻击的理想补救措施是执行<a class="ae lf" href="https://owasp.org/www-project-proactive-controls/v3/en/c4-encode-escape-data" rel="noopener ugc nofollow" target="_blank">输出编码</a>，但是一些开发人员更喜欢通过使用正则表达式来过滤某些关键字和/或通常用作XSS有效负载一部分的特殊字符来解决这个问题。在开发人员了解漏洞并使用正确的黑名单正则表达式模式的情况下，这肯定是有效的，但是正如您可能知道的，JavaScript中的函数和方法有一些非穷尽的替代方法，可用于触发客户端注入攻击。这篇博客旨在强调，仅仅依靠黑名单或过滤作为服务器端验证的一部分并不是现有的最佳安全实践，并且总是有办法绕过这种实现。研究人员总是在寻找新的/替代的方法来绕过现有的协议。</p><h2 id="49f3" class="lz ma iq bd mb mc md dn me mf mg dp mh lw mi mj mk lx ml mm mn ly mo mp mq mr bi translated">问题是</h2><p id="b052" class="pw-post-body-paragraph ki kj iq kl b km ms jr ko kp mt ju kr lw mu ku kv lx mv ky kz ly mw lc ld le ij bi translated">Oracle基于云的实用程序允许用户构建和部署企业应用程序，在花了几个小时研究它的主要功能后，我发现在每个表单提交请求中发送的用户输入在呈现到响应中之前都经过了适当的编码。但是奇怪的是，并非所有的功能都是如此；对于(<em class="kk">非常</em>)少数功能(<em class="kk">遗留功能)，应用程序对用户输入进行了不同的处理。</em>)。具体来说，看起来这个应用程序(在这几个功能中的<em class="kk">)被设计成过滤掉响应中的某些特殊字符和关键字，由于这些特殊字符和关键字，正常的XSS有效载荷将不能正常工作。</em></p><p id="1ba4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">在接下来的几个小时里，我理解了过滤机制实现背后的正则表达式模式，并精心制作了绕过过滤器的完美负载。结果是屏幕上出现了一个“警告框”，每次访问功能时都会出现，即存储的跨站点脚本。</p><figure class="lh li lj lk gt ll"><div class="bz fp l di"><div class="mx my l"/></div></figure><h2 id="e444" class="lz ma iq bd mb mc md dn me mf mg dp mh lw mi mj mk lx ml mm mn ly mo mp mq mr bi translated">接下来呢？</h2><p id="3aef" class="pw-post-body-paragraph ki kj iq kl b km ms jr ko kp mt ju kr lw mu ku kv lx mv ky kz ly mw lc ld le ij bi translated">我列出了使用上述实现的所有模块，并观察到它们都容易受到存储的跨站点脚本的攻击，其中一个模块允许用户创建表单并与某个组(<em class="kk"> DEV、QA、UAT、PROD等)的其他用户共享表单。</em>)，即用户填写并提交表单后，该表单的内容在登录时对集团所有用户可见(<em class="kk">，包括提交表单的用户</em>)。</p><p id="e1f6" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">作为表单提交的一部分，我触发了新制作的JavaScript XSS有效负载，并观察到当组中的任何有效用户(<em class="kk">甚至管理员</em>)登录到应用程序时，JavaScript有效负载就会被加载。接下来，我修改了XSS负载，让应用程序在用户登录到应用程序时解析<em class="kk">document . write(‘AAAA’)</em>。</p><figure class="lh li lj lk gt ll gh gi paragraph-image"><div role="button" tabindex="0" class="lm ln di lo bf lp"><div class="gh gi mz"><img src="../Images/258bb8f371c161f33b90a59eb69561d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h-bJecbtxzhINruueqfn2w.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">该组的每个用户登录时将看到的内容。</figcaption></figure><p id="5855" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">也就是说，该组的登录用户不会在屏幕上看到一个花哨的“警告框”，而是会被定向到一个响应中带有“<strong class="kl ir"> aaaa </strong>”的空白页面。</p><p id="39e4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">你可能会想知道下面这些—</p><ol class=""><li id="39d4" class="na nb iq kl b km kn kp kq lw nc lx nd ly ne le nf ng nh ni bi translated">如果我强行访问其他功能的URL，会发生什么情况？</li><li id="6047" class="na nb iq kl b km nj kp nk lw nl lx nm ly nn le nf ng nh ni bi translated">XSS是如何拒绝用户访问应用程序的？</li></ol><p id="abea" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated"><strong class="kl ir"> Ans 1。</strong>应用程序在每个请求中发送一个动态生成的唯一标识符，即，对于每个点击的按钮，应用程序发送一个随机生成的标识符，该标识符在服务器中被验证和映射，因此用户不可能访问任何其他功能，除非他们能够预测标识符值。下面是一个请求标识符的例子。</p><blockquote class="kf kg kh"><p id="983e" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi">:640991690762043326726::</p></blockquote><p id="b0a7" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated"><strong class="kl ir"> Ans 2。</strong>现在用户无法访问应用程序中的任何其他功能(<em class="kk">参见Ans 1 </em>)，并且每次任何有效的工作区用户登录时都会执行XSS有效负载，因此任何用户(<em class="kk">甚至管理员</em>)都无法访问应用程序中的任何功能。Oracle团队必须清除后端数据库中的有效负载，以便应用程序可以再次访问。</p><h2 id="135e" class="lz ma iq bd mb mc md dn me mf mg dp mh lw mi mj mk lx ml mm mn ly mo mp mq mr bi translated">结果</h2><p id="a351" class="pw-post-body-paragraph ki kj iq kl b km ms jr ko kp mt ju kr lw mu ku kv lx mv ky kz ly mw lc ld le ij bi translated">在最初的披露中，Oracle团队将漏洞裁定为预期功能，但经过几次反复，这些问题在2020年10月和2021年1月的补丁发布周期中被接受并修复。</p><p id="b890" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lw kt ku kv lx kx ky kz ly lb lc ld le ij bi translated">与Oracle安全团队的合作非常愉快，我很高兴能够获得Oracle发布的第一批简历。更多即将推出！</p><h2 id="adb7" class="lz ma iq bd mb mc md dn me mf mg dp mh lw mi mj mk lx ml mm mn ly mo mp mq mr bi translated">参考</h2><p id="b4b1" class="pw-post-body-paragraph ki kj iq kl b km ms jr ko kp mt ju kr lw mu ku kv lx mv ky kz ly mw lc ld le ij bi translated">CVE-2020–14762 | CVE-2020–14763 | CVE-2020–14898 | CVE-2020–14899 | CVE-2020–14900 | CVE-2021–2116 | CVE-2021–2117</p><h2 id="0251" class="lz ma iq bd mb mc md dn me mf mg dp mh lw mi mj mk lx ml mm mn ly mo mp mq mr bi translated">非常感谢博客上的反馈和见解。欢迎发表评论或在Twitter上联系我。</h2></div></div>    
</body>
</html>