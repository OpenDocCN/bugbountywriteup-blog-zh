<html>
<head>
<title>How I ended up downloading a malware</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何下载恶意软件的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-ended-up-downloading-a-malware-c5aa93742ce4?source=collection_archive---------3-----------------------#2022-01-23">https://infosecwriteups.com/how-i-ended-up-downloading-a-malware-c5aa93742ce4?source=collection_archive---------3-----------------------#2022-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bb7ea33b1baea977f323b3d70e0fd3e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jpmN_UGwhuLzfHM32G2SsA.jpeg"/></div></div></figure><p id="43c1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好！！！这个周末我和弟弟无聊，决定玩个游戏，他就下载了游戏。精彩的部分来了:在他的电脑上解压游戏时，他发现了一些可疑的文件，并推测道:“也许是病毒，”所以我决定试一试。以下是提取游戏和恶意软件到你的电脑的步骤。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kw"><img src="../Images/e132abd2c1caa64380c9123c542db104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c_6l-2yi7kDDx1W0uBxABw.jpeg"/></div></div></figure><p id="adba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步——禁用Defender.exe: </strong>这不过是一个工具，用来在windows 10中禁用windows defender。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/95ac928c2786f59ac5d8ae6945281d9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IBIHGYtN-XILyfXK-sd6iA.png"/></div></div></figure><p id="0086" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想知道更多关于这个软件的信息，你可以参考下面的链接。</p><div class="lc ld gp gr le lf"><a href="https://thedfirreport.com/2020/12/13/defender-control/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">防守队员控制</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">Defender Control是一个我们在各种入侵中遇到的免费软件工具。虽然我们还没有看到…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">thedfirreport.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt jw lf"/></div></div></a></div><p id="cc81" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤2 —提取Setup.rar: </strong>根据文本文件中的说明，现在我们需要运行步骤2。</p><p id="f10b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二步是一个密码保护的rar文件。</p><blockquote class="lu lv lw"><p id="164b" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><strong class="ka ir">密码:123 </strong></p></blockquote><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/bc27da80936a08111df4fe4ecbd06d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*J-iwJtZfUGuJH6fEMyGYSw.png"/></div></figure><p id="e0cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">步骤3 — Setup_Install_Game.exe: </strong>在提取rar文件时，我们得到了步骤3的文件，这是一个exe文件。为了方便起见，我把名字改成了<strong class="ka ir"> game_extracter(病毒)。exe </strong>。这是将提取游戏和恶意软件的文件。</p><p id="da3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们将这个示例上传到any.run</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/4416ac9989cbcc16f74712a836f009a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*TS4mA_69u1JX9G2EzTI6Ug.png"/></div></figure><p id="c9ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从上面的图片中，我们可以看到恶意软件正在利用wscript.exe和reg.exe来完成一些任务。我们稍后会谈到这一点。但在此之前，让我们检查一下<strong class="ka ir">游戏提取器(病毒)。exe </strong>稍微深入一点。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/e9a1c40aa41e02a82b08f2a460bd1706.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VAXuMfZ8iNtZf2NQocWb0Q.png"/></div></div></figure><p id="aff8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗯…所以这个示例在这个位置创建了一个名为<strong class="ka ir"> Windows Update Files </strong>的文件夹。</p><blockquote class="lu lv lw"><p id="d688" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><strong class="ka ir">位置:C:\ Users \ admin \ Appdata \ Roaming \ Windows Update Files</strong></p></blockquote><p id="c88e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此外，它将两个文件放在这个位置。<br/>1)Windows Update Service.vbs<br/>2)encode.vbs<br/>顾名思义encode . VBS会对Windows Update service . VBS进行编码，然后自己删除。</p><p id="01c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，在目标文件夹中，我们可以看到名为Windows Update Service.vbe的文件</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/d8213e698c89518b9cccb20f93c6dec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0Qt9eYDJOICevUmaD--Vg.png"/></div></div></figure><blockquote class="lu lv lw"><p id="26fc" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><strong class="ka ir">是什么。vbe文件？</strong><br/>VBS脚本的编码形式是vbe脚本</p></blockquote><p id="7013" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有两个选择。我们可以对其进行解码，也可以在编码之前使用该文件(即Windows Update Service.vbs)</p><blockquote class="lu lv lw"><p id="2bb9" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><strong class="ka ir">注意:</strong>如果你想解码文件，请使用下面链接中的程序。<br/><a class="ae mf" href="https://github.com/JohnHammond/vbe-decoder" rel="noopener ugc nofollow" target="_blank">https://github.com/JohnHammond/vbe-decoder</a></p></blockquote><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/f38a42a9d97d3dd8c433568ee8ecf6a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLqnyXOtNna7KxrEdhaPPw.png"/></div></div></figure><p id="569d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">查看解码后的脚本，我们可以理解，它正在使用<strong class="ka ir">“ping”</strong>命令(在第10行)检查互联网连接。如果不存在，它将使用<strong class="ka ir">“pause()”</strong>功能等待一段时间，然后再次using。</p><p id="ffb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它还在端口9222上以无头模式打开Chrome进程，并导航到这个网站(在第19行)。</p><blockquote class="lu lv lw"><p id="7455" class="jy jz lx ka b kb kc kd ke kf kg kh ki ly kk kl km lz ko kp kq ma ks kt ku kv ij bi translated"><a class="ae mf" href="http://www.google.com.199052757687038.windows-display-service.com/" rel="noopener ugc nofollow" target="_blank">http://www . Google . com . 199052757687038 . windows-display-service . com/</a></p></blockquote><p id="9c2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果Chrome不存在，它会检查Firefox浏览器并重复相同的操作(第21 &amp; 22行)。</p><p id="a8bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，恶意软件打开<strong class="ka ir">“reg . exe”</strong>使用下面的命令修改注册表项。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/938d0454da34a6421d28da56f438ec8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_8gM7BdBiJK3JVbEqpJu1Q.png"/></div></div></figure><p id="b63c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该恶意软件修改的密钥是<strong class="ka ir">“自动运行”</strong>密钥。通常，威胁参与者使用此密钥来实现持久性。因此，将会发生什么意味着，每当受影响的用户启动到他的系统，这将自动启动和运行。</p><p id="056b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到达这个<a class="ae mf" href="http://www.google.com.199052757687038.windows-display-service.com/" rel="noopener ugc nofollow" target="_blank">网站</a>后，还不清楚这个恶意软件试图做什么。一些消息来源称<strong class="ka ir">“当浏览器打开这个页面时，它将执行嵌入式JavaScript，该JavaScript将启动浏览器内矿工脚本来挖掘加密货币”</strong>。</p><p id="9b0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有一些其他消息来源称<strong class="ka ir">“远程调试也</strong> <strong class="ka ir">允许观察用户活动和敏感的个人信息(又名监视用户)并从远程计算机控制浏览器”</strong>。</p><p id="7922" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">最终想法:</strong></p><p id="b06d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">小心你正在下载和安装在你的电脑上的东西。不要盲目相信盗版软件。</p><p id="28d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">黑客快乐！！！</p><p id="d5da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">样本:</strong></p><div class="lc ld gp gr le lf"><a href="https://github.com/UVvirus/malware_samples/tree/main/game_malware" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">主UVvirus/malware _ samples/game _ malware</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">在GitHub上创建一个帐户，为UVvirus/malware_samples的开发做贡献。</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">github.com</p></div></div><div class="lo l"><div class="mi l lq lr ls lo lt jw lf"/></div></div></a></div><p id="ac40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考文献:</strong></p><div class="lc ld gp gr le lf"><a href="https://thedfirreport.com/2020/12/13/defender-control/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">防守队员控制</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">Defender Control是一个我们在各种入侵中遇到的免费软件工具。虽然我们还没有看到…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">thedfirreport.com</p></div></div><div class="lo l"><div class="lp l lq lr ls lo lt jw lf"/></div></div></a></div><div class="lc ld gp gr le lf"><a href="https://www.bleepingcomputer.com/news/security/adware-launches-in-browser-mining-sites-pretending-to-be-cloudflare/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">广告软件推出伪装成Cloudflare的浏览器内挖掘网站</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">一个广告软件捆绑包已经开始创建一个Windows autorun来自动启动Chrome，这样它就可以连接到一个</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">www.bleepingcomputer.com</p></div></div><div class="lo l"><div class="mj l lq lr ls lo lt jw lf"/></div></div></a></div></div><div class="ab cl mk ml hu mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="ij ik il im in"><h1 id="6502" class="mr ms iq bd mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。查看更多详情并在此注册。</h1><div class="lc ld gp gr le lf"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="lg ab fo"><div class="lh ab li cl cj lj"><h2 class="bd ir gy z fp lk fr fs ll fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="lm l"><h3 class="bd b gy z fp lk fr fs ll fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="ln l"><p class="bd b dl z fp lk fr fs ll fu fw dk translated">iwcon.live</p></div></div><div class="lo l"><div class="np l lq lr ls lo lt jw lf"/></div></div></a></div></div></div>    
</body>
</html>