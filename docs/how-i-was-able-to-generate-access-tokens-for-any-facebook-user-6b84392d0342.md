# 我如何能够为任何脸书用户生成访问令牌。

> 原文：<https://infosecwriteups.com/how-i-was-able-to-generate-access-tokens-for-any-facebook-user-6b84392d0342?source=collection_archive---------2----------------------->

该漏洞可能允许恶意用户为任何脸书用户生成访问令牌。我在测试 Rights Manger dashboard 中使用的一些脸书端点时，错误地发现了这个错误，Rights Manger dashboard 是一个针对视频发布者和编辑的仪表板。

易受攻击的端点在向它发出 POST 请求时返回一个 page access_token 以及参数 **page_id。** 这里的问题是端点不检查为 page_id 提供的值是否实际上是一个“ **page** 的 id，而不是另一个类似“ **user** 的对象。这允许我发出请求，并将 page_id 值更改为任何脸书用户 id，作为对该请求的响应，我获得了该用户的访问令牌。

![](img/4d2c3a601554ba14e3fa44d9b0e973b5.png)

**影响**然而，我能够阅读所有私人信息，如电子邮件，信用卡，电话号码，管理页面及其访问令牌，管理业务/广告账户和私人帖子，照片和视频…

**修复** 脸书安全团队通过修改他们的 API 来拒绝以这种方式(用户对象而不是页面)生成的令牌，从而修复了此问题。大约六个月后，他们通过检查提供的 id 是否与用户对象不匹配，修改了这个端点和其他一些端点，使其首先不生成这些类型的令牌，从而进行了第二次修复。

2018 年 2 月 3 日—报告发送
2018 年 2 月 6 日—脸书进一步调查
2018 年 2 月 6 日—脸书要求澄清
2018 年 2 月 6 日—澄清发送
2018 年 2 月 8 日—脸书确定
2018 年 2 月 23 日—脸书悬赏