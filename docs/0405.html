<html>
<head>
<title>5,000 USD XSS Issue at Avast Desktop AntiVirus for Windows (Yes, Desktop!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">5000美元XSS问题在Avast桌面杀毒软件为Windows(是的，桌面！)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968?source=collection_archive---------0-----------------------#2019-10-29">https://infosecwriteups.com/5-000-usd-xss-issue-at-avast-desktop-antivirus-for-windows-yes-desktop-1e99375f0968?source=collection_archive---------0-----------------------#2019-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d004" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">CVE-2019–18653 &amp; CVE-2019–18654:反映XSS的故事是从SSID名称触发的(它也影响了AVG AntiVirus，因为基本上产品代码大多是“合并的”)。</h2></div><p id="457d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">بسم الله الرحمن الرحيم</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="921e" class="lk ll iq lg b gy lm ln l lo lp">So, this article will be explained in two ways, which are the one that tells how I got it and the one that tries to explain the basic and reference<em class="lq">.</em></span><span id="1567" class="lk ll iq lg b gy lr ln l lo lp">Readers could also read the TL;DR section directly.</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="893c" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">I. TL速度三角形定位法(dead reckoning)</h2><p id="24d4" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated"><strong class="kh ir"> 1.1。</strong>使用简单的XSS有效负载创建SSID名称(最多32个字符)。我们可以使用<a class="ae mv" href="https://twitter.com/BruteLogic" rel="noopener ugc nofollow" target="_blank"> BruteLogic </a>和<a class="ae mv" href="https://twitter.com/s0md3v" rel="noopener ugc nofollow" target="_blank"> s0md3v </a>短XSS有效载荷(谢谢老兄！).</p><p id="94b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1.2。</strong>将您的Windows操作系统(安装并激活Avast防病毒软件)连接到SSID，并等待Avast网络通知功能触发XSS有效负载。</p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mw"><img src="../Images/27fdc29076d9de18e0e2323e3329e8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znSlr_ZpEm3J7fyRkURdsg.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">通过SSID名称触发XSS</figcaption></figure><p id="88bc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1.3。向Avast报告，并在大约2天内确认为有效问题。几个月后，他们判断问题是否相当严重，决定奖励举报人5000美元。</strong></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="4793" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">二。关于我如何得到这个问题的幕后故事</h2><p id="dc20" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">几年前，我读了一篇来自一个bug猎人的好文章，当时他在一些大公司中通过将XSS有效载荷放在他的SSID名称上而得到了许多XSS问题(我确实因为一个原因丢失了书签)。简而言之，当他浏览许多应用程序时，他得到许多反映他的SSID名称的值的应用程序(并且XSS被触发)。从那里，然后我开始使用XSS有效载荷作为我的SSID名称(在OS X)。</p><p id="8cb4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">于是，几个月前，我从当时工作的办公室拿到了一个笔记本(里面有windows)。我从网络连接上安装了所有我需要的东西，并把Avast杀毒软件留到了最后(在家里)。在家里，我继续安装，一切顺利。</p><p id="329a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">直到有一天我再次使用这个笔记本进行训练。在训练过程中(第3天或第4天)，在训练过程中(第3天或第4天)，我使用的连接出现了问题。所以，突然这台笔记本自动连接到我的网络共享连接(已经安装了Avast)，几秒钟后，我的桌面上出现了一个弹出警告，上面写着“<strong class="kh ir">https://local.avast.com</strong>”。</p><p id="8fd0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说实话，我也不知道是怎么回事。幸运的是，在课堂上有一个视频记录，我要求复制这段时间的对话。试图找出这是如何发生的，我终于在第二天得到了答案。该XSS被触发是因为Avast(专门用于互联网安全和Premiere版)中的嵌入式“<strong class="kh ir">网络通知功能</strong>”(防火墙)反映了SSID名称，并且还没有被杀毒。</p><p id="7248" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后当天晚上就做了汇报，大概2天左右得到回复确认问题是否有效。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="c06d" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">三。摘要</h2><p id="a707" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">正如Avast官方网站所引用的，Avast是世界上最大的安全公司之一，它使用下一代技术来实时对抗网络攻击，致力于创建一个为所有人提供安全和隐私的世界，无论你是谁，你在哪里，或者你如何连接。</p><p id="2571" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Avast进行了如此多的研究，试图为每个用户实现最佳的终端保护。已经嵌入的一个特性是“<strong class="kh ir">防火墙</strong>”特性，它可以很容易地用于管理传入和传出流量。</p><p id="cd57" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">默认情况下，当用户连接到一个<strong class="kh ir">新网络</strong>时，这个防火墙功能会给用户一个警告(弹出通知)。例如，如下图所示，这表明用户刚刚连接到一个无线网络，其SSID名称为“我的热点”。</p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ni"><img src="../Images/523b366549a61459d0a6349c6ead1a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GT-QymglL7lqpD1Xu3d0Qw.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">连接到新网络时弹出通知</figcaption></figure><p id="9bad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">弹出窗口出现后，用户可以从他们正在连接的SSID中选择网络类型，如“<strong class="kh ir">专用</strong>网络或“<strong class="kh ir">公共</strong>网络”。</p><p id="cf6e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，当这个通知弹出窗口没有过滤掉SSID名称中反映的特殊字符时，就会出现问题。换句话说，攻击者可以使用<strong class="kh ir">恶意SSID名称，通过<strong class="kh ir">弹出通知</strong>在客户端触发XSS。</strong></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="559e" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">四。介绍</h2><p id="b20e" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated"><strong class="kh ir"> 4.1。跨站脚本(XSS) <br/> </strong>简单来说，这种漏洞就是能够“让”攻击者能够在输入部分执行代码的漏洞，而输入部分并没有实现对“&gt; &lt; : /”等特殊字符的过滤；等等。与“保存”执行代码的存储XSS相反，反射XSS实际上根本不保存这个脚本，因此“目标”被期望并被要求访问由来自攻击者的附加内容“注入”的URL。</p><p id="752f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，Avast将输入(来自SSID名称)反映到弹出通知中(每次用户更改连接时)。当SSID名称包含客户端脚本(如javascript)时，通知将触发可触发XSS漏洞的脚本。</p><p id="4b89" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一件好事是，即使SSID名称有大约32个字符的限制，我们仍然可以通过调用一个短URL来切断它。感谢<a class="ae mv" href="https://twitter.com/brutelogic" rel="noopener ugc nofollow" target="_blank">蛮逻辑</a>和<a class="ae mv" href="https://twitter.com/s0md3v" rel="noopener ugc nofollow" target="_blank"> S0md3v </a>，谢谢老兄！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="26f7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4.1.1。短XSS有效载荷</strong> <br/>我第一次得到一个弹出警告，我不知道如何进一步触发它。然后是Alhamdulillah，我非常幸运，因为我记得读过一篇由“<em class="lq"> Brute Logic </em>”和“<em class="lq"> S0md3v </em>”发表的关于短XSS有效载荷的文章。最酷的是，它成功了！</p><p id="19c6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你正在寻找伟大而富有创意的XSS有效载荷，那么我推荐这两项研究:<br/><a class="ae mv" href="https://brutelogic.com.br/blog/shortest-reflected-xss-possible/" rel="noopener ugc nofollow" target="_blank">https://brute logic . com . br/blog/shortest-reflected-XSS-possible/</a><br/><a class="ae mv" href="https://github.com/s0md3v/AwesomeXSS" rel="noopener ugc nofollow" target="_blank">https://github.com/s0md3v/AwesomeXSS</a></p><p id="32bb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的(当然)，有很多研究人员仍然分享其他伟大的和创造性的有效载荷，你可以跟随。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="a573" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4.2。研究可以通过使用恶意SSID名称</strong> <br/>执行的与故事相关的事情如前所述，我从一个bug猎人发布的文章中认识到了这个技巧(非常抱歉，因为一件事我真的丢失了我的书签)。从他的研究中，我终于了解到这个领域的研究是由Deral Heiland在2013年非常详细地进行的。他在BlackHat Europe 2013 上发表了这项研究。</p><p id="f014" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，对于这方面的研究和深入了解，可以参考他的介绍。非常推荐。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="f5e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 4.3。受影响的版本和测试环境<br/> Avast: </strong>可在Avast Internet Security <em class="lq">版本19.3.2369(内部版本19.3.4241.440) </em>中找到此漏洞的受影响版本。这也影响了Avast免费杀毒软件的首映。</p><p id="4192" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">AVG方面:</strong>该问题影响了AVG互联网安全版本19.3.3084(内部版本19.3.4241.440)。</p><p id="f536" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一个小注意，这两个问题已经在Windows 10环境中重现(最新补丁-2019年3月22日)。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="724b" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">动词 （verb的缩写）问题摘要</h2><p id="eede" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">如前所述，本报告中的安全问题是一个漏洞，使得攻击者能够使用恶意SSID名称通过“弹出通知”在客户端触发XSS。</p><p id="fb67" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，攻击者还可以通过“弹出通知”显示一个伪造的登录页面(例如带有Avast / AVG徽标)，用户不会感到可疑，因为当脚本触发一个伪造的登录页面时，没有可以看到/检测到的URL。</p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nj"><img src="../Images/a0aa5f7716f44c870eef37e7092e65c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33mhGfkpLGMRgt0zCqKbuQ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">触发虚假登录页面的示例案例- Avast</figcaption></figure><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nk"><img src="../Images/2f88f9cabc0bade76c59ad7f40b783e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ft7Fkv466w7v_WXGZwxg3g.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">触发虚假登录页面的案例——AVG</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="58fa" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">不及物动词概念证明</h2><p id="b735" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">为了完成说明，必须做一些事情来重现这个问题。以下是需要准备的步骤:</p><p id="80f9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6.1。</strong>创建SSID，用简单的JavaScript作为SSID的名称。例如:<strong class="kh ir"><em class="lq">&gt;&lt;img src = x on error = prompt(1)&gt;</em><br/></strong>使用这个脚本的基本目的是触发一个以“1”为字符的弹出警告。</p><p id="e0ff" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">6.2。确保受害者是否连接到准备好的SSID</p><p id="89e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6.3。</strong>受害者连接到准备好的SSID后，等待几秒钟。将显示一个<strong class="kh ir">弹出通知</strong>，脚本将被触发:</p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mw"><img src="../Images/27fdc29076d9de18e0e2323e3329e8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znSlr_ZpEm3J7fyRkURdsg.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">该脚本已通过通知弹出窗口- Avast触发</figcaption></figure><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nl"><img src="../Images/0355130133facc25a60e857c8ad9533c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x0rLJM6QPqy0yiBjFFi9Tw.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">该脚本已通过通知弹出窗口- AVG触发</figcaption></figure><p id="4a37" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 6.4。</strong>因为SSID名称被限制为32个字符，所以我们必须通过使用短URL服务来欺骗脚本。例如，我们尝试从其他门户触发登录表单..使用的脚本是:<strong class="kh ir"><em class="lq">&gt;&lt;embed src =//tiny . cc/XYZABCX&gt;</em></strong>(也可以使用bit.ly)。</p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nm"><img src="../Images/7360265e7a35ce95bd7cdca755b883ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBHdC9G6rFQ98o57zkejJw.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">从其他门户触发登录表单以弹出通知</figcaption></figure><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nj"><img src="../Images/a0aa5f7716f44c870eef37e7092e65c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33mhGfkpLGMRgt0zCqKbuQ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">从其他门户触发登录表单到通知弹出窗口II</figcaption></figure><p id="8475" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而且好的一点是，还可以从其他外部URL触发脚本(功劳到s0md3v)。下面举个例子:<strong class="kh ir"><em class="lq">&gt;&lt;embed src =//14 . RS&gt;</em></strong></p><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nn"><img src="../Images/fd9a0f38d24233db9694616413b844af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJhqgdqLq2iifXkx_Q0lvw.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">使用外部脚本触发脚本</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="5a50" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">七。附加说明</h2><p id="ceee" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">为了补充说明，下面是一个简单的概念验证视频:</p><figure class="lb lc ld le gt mx"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">PoC视频-通过SSID名称触发XSS有效载荷</figcaption></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="ca7f" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">八。报告时间表</h2><ul class=""><li id="9ada" class="nq nr iq kh b ki mq kl mr ko ns ks nt kw nu la nv nw nx ny bi translated"><strong class="kh ir">2019 . 3 . 21:</strong>发现问题，还不知道根本原因；</li><li id="03a3" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><strong class="kh ir">2019年3月22日:</strong>发现问题，然后创建报告并通过bugs@avast.com发送；</li><li id="28d0" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated">2019年3月25日:如果AVG也受到影响，发送信息；</li><li id="5906" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><strong class="kh ir">2019年3月25日:</strong> Avast回复并确认了bug。他们说，如果他们将很快发布一个补丁；</li><li id="5300" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><strong class="kh ir">2019年3月25日:</strong>如果不出意外，Avast回复(如果AVG也受到同样问题影响)。他们很好地给出了高水平的解释。</li><li id="ce79" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><strong class="kh ir">2019年5月24日:</strong> Avast表示该问题是否已修复(在Avast 19.4中)并已发布。他们还说，如果奖励决定后，他们会给出更多的细节。</li><li id="597a" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><strong class="kh ir">2019年6月12日:</strong> Avast判断此问题相当严重，决定奖励举报人5000美元。(真的很神奇)。</li></ul><figure class="lb lc ld le gt mx gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi oe"><img src="../Images/52bf28098cc170ef9ee6fc5087c0b0e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bO5DAbvHBeBSqrpuInK6qg.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">Avast的奖励决定</figcaption></figure><p id="7c76" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这一次真的打破了我一次奖金的记录。还有，那个决定真的让我很惊讶。当时我还不相信，直到这些数字真的打进了我的Paypal账户。</p><p id="04d6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">对于Avast: </strong>非常感谢你给我们带来的惊喜奖励和精彩节目！非常感谢。我已经说不出感谢他们的话了。</p><ul class=""><li id="aa3a" class="nq nr iq kh b ki kj kl km ko of ks og kw oh la nv nw nx ny bi translated"><strong class="kh ir">2019年10月30日:</strong><em class="lq">CVE-2019–18653</em>已指定在Avast发行，<em class="lq">CVE-2019–18654</em>已指定在AVG发行。</li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="d827" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">九。闭幕</h2><p id="688f" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">嗯，正如读者所见，这是我从未想象过的(在桌面应用程序上触发XSS)。我或许可以分享一些简单的注意事项(以我有限的知识):</p><ul class=""><li id="5b3b" class="nq nr iq kh b ki kj kl km ko of ks og kw oh la nv nw nx ny bi translated">永远试着给你读过的所有东西做书签。当你想对你的目标使用这些技巧时，记下笔记并回来。在这种情况下，有一天我阅读并保存了一篇由Brute Logic和s0md3v制作的出版物。当我遇到困难的情况时(例如用有限的字符触发XSS)，我会返回到他们的报告并打开我的笔记。</li><li id="cab0" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated">尽管这看起来很傻，但如果您输入的SSID名称带有(例如)有效载荷XSS，效果会更好。我已经把它放了好几年了(自从我第一次读到一个bug猎人发表的文章，谢谢！)，但我发现它是在2019年在Windows OS的桌面应用程序上触发的(不影响OS X版本的Avast)。</li></ul><p id="8a18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另外，我从中学到的另一个矢量是:</p><ul class=""><li id="84f3" class="nq nr iq kh b ki kj kl km ko of ks og kw oh la nv nw nx ny bi translated">通过恶意SSID名称的XSS也可以被触发，用于在应用程序中反映或存储我们的SSID名称。在这种情况下，Avast和AVG已经反映了SSID名称。</li><li id="3874" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated">除了桌面的，只是请不要忘记XSS，也可以由反映SSID名称的Web或移动应用程序触发。</li><li id="79f3" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated">另一方面，我也知道了存储SSID名称的那个也可能是易受攻击的。至少，我在一些报道中看到过，例如:<br/><a class="ae mv" href="https://medium.com/@igor.lrgomes/cve-2019-11877-credentials-stealing-through-xss-on-pix-link-repeater-9a98c344f58e" rel="noopener">【CVE-2019–11877】在Pix-Link中继器上通过XSS窃取凭据</a><br/><a class="ae mv" href="https://medium.com/@elberandre/router-exploit-getting-wireless-password-and-administrator-session-without-being-connected-on-the-e6c0517b00a6" rel="noopener">【CVE-2017–14219】XSS在Intelbras路由器WRN 240 </a> — <em class="lq">在未连接到同一网络的情况下获取无线密码和管理员会话<br/></em><a class="ae mv" href="https://packetstormsecurity.com/files/149730/NPLUG-Wireless-Repeater-1.0.0.14-CSRF-XSS-Authentication-Bypass.html" rel="noopener ugc nofollow" target="_blank">【CVE-2018–17337】xs</a></li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="0c91" class="lk ll iq bd lz ma mb dn mc md me dp mf ko mg mh mi ks mj mk ml kw mm mn mo mp bi translated">X.信用</h2><ul class=""><li id="ad91" class="nq nr iq kh b ki mq kl mr ko ns ks nt kw nu la nv nw nx ny bi translated"><a class="ae mv" href="https://media.blackhat.com/eu-13/briefings/Heiland/bh-eu-13-practical-exploitation-heiland-slides.pdf" rel="noopener ugc nofollow" target="_blank">https://media . black hat . com/eu-13/briefings/heil and/BH-eu-13-practical-exploitation-heil and-slides . pdf</a></li><li id="7456" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><a class="ae mv" href="https://blog.rapid7.com/2016/03/09/its-all-in-the-name/" rel="noopener ugc nofollow" target="_blank">https://blog.rapid7.com/2016/03/09/its-all-in-the-name/</a></li><li id="8313" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated"><a class="ae mv" href="https://brutelogic.com.br/blog/shortest-reflected-xss-possible/" rel="noopener ugc nofollow" target="_blank">https://brute logic . com . br/blog/shortest-reflected-XSS-possible/</a></li><li id="cce2" class="nq nr iq kh b ki nz kl oa ko ob ks oc kw od la nv nw nx ny bi translated">https://github.com/s0md3v/AwesomeXSS<a class="ae mv" href="https://github.com/s0md3v/AwesomeXSS" rel="noopener ugc nofollow" target="_blank"/></li></ul></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="66a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lq">关注</em> <a class="ae mv" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="lq"> Infosec报道</em> </a> <em class="lq">获取更多此类精彩报道。</em></p><div class="oi oj gp gr ok ol"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">信息安全报道</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz nc ol"/></div></div></a></div></div></div>    
</body>
</html>