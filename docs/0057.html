<html>
<head>
<title>#BugBounty — “Let me reset your password and login into your account “-How I was able to Compromise any User Account via Reset Password Functionality</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">#BugBounty —“让我重置您的密码并登录到您的帐户”—我如何通过重置密码功能危害任何用户帐户</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-how-i-was-able-to-compromise-any-user-account-via-reset-password-functionality-a11bb5f863b3?source=collection_archive---------0-----------------------#2018-03-14">https://infosecwriteups.com/bugbounty-how-i-was-able-to-compromise-any-user-account-via-reset-password-functionality-a11bb5f863b3?source=collection_archive---------0-----------------------#2018-03-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9c98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="0bab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个有趣的博客解释了我不久前在印度的一家移动钱包公司发现的一个有趣的漏洞。</p><blockquote class="kl km kn"><p id="96c1" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">要登录任何在线网站，我们需要一个用户名，可以是用户注册的邮件id和密码，如果他不记得自己的密码，有一个重置密码功能来帮助。在研究该功能的漏洞时，我发现了一个逻辑缺陷，我可以重置任何用户密码，并使用相同的密码登录以接管任何用户的帐户。</p></blockquote><p id="53b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们开始解释-</p><ol class=""><li id="97fb" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">当我点击账户“testaccount09@gmail.com”的重置密码功能时，我收到一封邮件，上面写着“要重置密码，请点击下面的链接”，链接是这样的</li></ol><p id="fb75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">。_________.com/account/resetpassword？id = 296417&amp;token = dgvzdgfjy 291 bnqwoubnwfpbc 5 JB 20 =&amp;vit = mjaxni 8 xmc 8 ynq = =</em></p><p id="3269" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.这里,“id”是与用户帐户相关联的标识号,“token”是用户的base64解码的注册邮件ID，这里是“testaccount 09 @ Gmail . com”,“vit”是base64解码的时间戳，在这种情况下其值是“2016/10/25”</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/b759d2ede737a2233fa1345a58b07e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*t3buWPcJkqzV48fMRt4YXw.png"/></div></figure><p id="f137" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.通过进一步研究，我发现时间戳参数是重置密码链接的到期日期，它比用户单击重置密码选项的时间提前了2天。</p><p id="07ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.这是危及用户帐户的一步。通过同一页面上的用户枚举，我找到了一个有效的用户帐户，为其生成了忘记密码链接，现在开始查找正确的重置密码链接的任务，我替换了用户的邮件id并将其编码为base64，并将时间戳值保持在当前日期之前2天。</p><p id="e8ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">受害者邮件id—varun09811@gmail.com</p><p id="99e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Base64编码值(Parameter = token)—dmfydw 4 watgxmubnbwfpbc 5 JB 20 =</p><p id="b3d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">时间戳值(参数= vit) — MjAxNi8xMC8yNQ=</p><p id="40cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.这里的另一部分是找到与特定用户邮件id相关联的“id”。由于这是一个6位数的代码，所以我尝试了暴力破解(幸运的是没有设置速率限制)，过了一会儿，我找到了与受害者邮件id相关联的正确id，恰好是id=254346。(没错，这是很费时间的事情)。</p><p id="51e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.所以被篡改的网址看起来像-</p><p id="8959" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lj" href="http://www._________.com/account/resetpassword/?id=254346&amp;" rel="noopener ugc nofollow" target="_blank">。_________.com/account/resetpassword/？id = 254346&amp;</a>token = dmfydw 4 wotgxmubnbwfpbc 5 JB 20 =&amp;vit = mjaxni 8 xmc 8 ynq =</p><p id="faa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我在浏览器中加载链接，出现“设置新密码”</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/bc2ba6b177512ee7cc972adc1f8353ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*BOZ3J20klcNmn3ahGTY1DA.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk translated">新密码集页面</figcaption></figure><p id="e4d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我重设了他的密码，并成功登录了他的账户。我有完全的权限进入他的账户，可以使用他钱包里的钱，更改注册的手机号码和一切！</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="095a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向相关企业报告了这一漏洞，他们很快在2天内修补了漏洞。我感谢公司的小小心意:)</p><p id="5d95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(【https://twitter.com/logicbomb_1】T2</p></div></div>    
</body>
</html>