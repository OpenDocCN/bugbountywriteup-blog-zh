<html>
<head>
<title>How response Manipulation got me a little, but sweet Bounty</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何操纵反应让我得到一点点，但甜蜜的赏金</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-response-manipulation-got-me-a-little-but-sweet-bounty-38b515ca0910?source=collection_archive---------0-----------------------#2020-09-07">https://infosecwriteups.com/how-response-manipulation-got-me-a-little-but-sweet-bounty-38b515ca0910?source=collection_archive---------0-----------------------#2020-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6abd" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对你来说也是如此</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/71b3e9c73772fade8b84c6a789022aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*19nxlstOORt4Lr4k"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">乔希·阿佩尔在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="6536" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大家好，我已经有一段时间没有在Medium上写东西了(在这里很忙的几个月)，但是今天我想和你们分享一下反应操纵是如何让我得到一个低严重性的bug，并伴随着快速获得的奖金。当瞄准一个网站/网络应用程序(或两者都是:D)时，你通常会花一段时间在上面，主要搜索中/高严重性的bug(有时也是关键的bug)。然而，有些“简单”的错误有时会让你损失50到200美元。</p><p id="da43" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">似乎好到可以继续读下去？</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="774c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">响应操作</h1><p id="363e" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">当谈到响应操作时，我们谈论的是一种用于让目标显示一些它不应该显示的UI元素的技术。它可以用来寻找新的端点、按钮，也可以用来触发一些新的请求。有时，您还可以绕过密码限制或OTP。要了解响应操作是如何绕过OTP的，你可以参考<a class="ae kv" href="https://medium.com/bugbountywriteup/otp-bypass-on-indias-biggest-video-sharing-site-e94587c1aa89?source=---------10------------------" rel="noopener">这篇来自<a class="mw mx ep" href="https://medium.com/u/2ff30b8fc715?source=post_page-----38b515ca0910--------------------------------" rel="noopener" target="_blank"> Sriram Kesavan </a>的精彩文章</a>。今天我将谈论一个影响小得多的错误，然而正如我总是说的，它仍然是一个:D错误:绕过密码限制，在没有任何密码确认的情况下启用2FA。似乎很愚蠢，为什么攻击者要在受害者的帐户中启用2FA？此外，这只有在攻击者已经被认证的情况下才有效…我知道，这里的问题是什么！？嗯，就是这个:“违反Secure Web App的设计原则”。严重程度较低(显然)。然而，这意外地让我得到了一笔赏金，这可能取决于你是谁举报的。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="d9a8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">“臭虫”</h1><p id="c226" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">当启用2FA时(很快就写了我是如何绕过它的)，它要求密码确认，然后我想为什么不尝试一下所谓的响应操作。</p><h2 id="5575" class="my ma iq bd mb mz na dn mf nb nc dp mj lf nd ne ml lj nf ng mn ln nh ni mp nj bi translated">工作流程</h2><p id="7cff" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在，如何测试呢？这里的问题很简单:您知道是否有可能使用响应操作，然后尝试利用它。但是我怎么知道这是可能的？在我看来，当用于绕过auth时，要理解何时可能必须查看您想要绕过的端点是否在完成流程之前触发了另一个操作，或者它是否在auth表单之后完成。例如，如果您想绕过OTP，在输入正确的代码后，它是否会说:“Ok您已经完成了OTP过程，现在登录”。还是问你密码或性别？(举个例子)。如果您遇到第一种情况，那么绕过OTP的响应操作将不起作用，但是如果您遇到第二种情况，那么它可能是可行的。在这之后，在尝试响应操作之前，您还需要检查另一个步骤:输入密码或性别之后，代码(或您想要绕过的任何内容)是否还在响应体中？例如，如果您在询问您的性别时点击(例如)男性按钮，出现以下信息:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="a036" class="my ma iq nl b gy np nq l nr ns">otp=1111&amp;other_data=other_data</span></pre><p id="a795" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那么这是不可能的，但是如果你只得到:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="f7e0" class="my ma iq nl b gy np nq l nr ns">other_data=other_data</span></pre><p id="7626" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后可以使用响应操作绕过顶层代码。</p><h2 id="8775" class="my ma iq bd mb mz na dn mf nb nc dp mj lf nd ne ml lj nf ng mn ln nh ni mp nj bi translated">我找到的这个</h2><p id="63e8" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在你已经有了足够的关于反应操作的知识来理解下一段的内容。</p><p id="6875" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当启用2FA时，它首先要求密码确认(你已经知道:D)。输入正确的密码后，响应如下:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="170a" class="my ma iq nl b gy np nq l nr ns">HTTP/1.1 200 OK<br/>Date: Tue, 28 Jul 2020 11:30:14 GMT<br/>Content-Type: application/json<br/>Connection: close<br/>Set-Cookie: __cfduid=somecookie; expires=Thu, 27-Aug-20 11:30:14 GMT; path=/; domain=*.redacted.com; HttpOnly; SameSite=Lax; Secure<br/>Cache-Control: no-cache, private<br/>X-RateLimit-Limit: 100<br/>X-RateLimit-Remaining: 99<br/>Z-Redacted-Password-Auth-Valid-Until: 1595935589<br/>Strict-Transport-Security: max-age=31536000; includeSubDomains<br/>CF-Cache-Status: DYNAMIC<br/>Expect-CT: max-age=604800, report-uri="<a class="ae kv" href="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct" rel="noopener ugc nofollow" target="_blank">https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct</a>"<br/>Server: cloudflare<br/>Content-Length: 480<br/><br/>{"data":{"type":"createtwofa","attributes":{"secret":"code","qr":"someurl","qr_url":"anotherurl"},"id":"a code(not the password it asked)"},"last_user_action":{"date_iso8601":"2020-07-28T13:30:14+02:00","unix":"1595935814"}}</span></pre><p id="6dbf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，它返回了值和二维码。我用google-authenticator扫描了一下，点击了next，它要求输入验证码，然后确认2fa已经启用。使用响应操作尝试绕过密码限制一切正常。</p><p id="63a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，我禁用了2fa，并试图在它要求密码确认时启用它，但它输入了错误的密码，并得到以下响应:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="34d4" class="my ma iq nl b gy np nq l nr ns">HTTP/1.1 422 Unprocessable Entity<br/>Date: Tue, 28 Jul 2020 11:41:27 GMT<br/>Content-Type: application/json<br/>Content-Length: 177<br/>Connection: close<br/>Set-Cookie: __cfduid=somecookie; expires=Thu, 27-Aug-20 11:41:26 GMT; path=/; domain=redacted.com; HttpOnly; SameSite=Lax; Secure<br/>Cache-Control: no-cache, private<br/>Access-Control-Allow-Headers: origin, content-type, access-token, x-tracking-id<br/>Access-Control-Allow-Origin: *<br/>X-RateLimit-Limit: 100<br/>X-RateLimit-Remaining: 99<br/>X-BRedacted-Password-Auth-Valid-Until: 1595935589<br/>Strict-Transport-Security: max-age=31536000; includeSubDomains<br/>CF-Cache-Status: DYNAMIC<br/>Expect-CT: max-age=604800, report-uri="<a class="ae kv" href="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct" rel="noopener ugc nofollow" target="_blank">https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct</a>"<br/>Server: cloudflare<br/><br/>{"errors":[{"status":422,"code":"user.validation.exception","title":"Validation exception"}],"last_user_action":{"date_iso8601":"2020-07-28T13:41:27+02:00","unix":"1595936487"}}</span></pre><p id="9186" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我把它改成了这样:</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="dcf2" class="my ma iq nl b gy np nq l nr ns">HTTP/1.1 200 OK<br/>Date: Tue, 28 Jul 2020 11:30:14 GMT<br/>Content-Type: application/json<br/>Connection: close<br/>Set-Cookie: __cfduid=somecookie; expires=Thu, 27-Aug-20 11:30:14 GMT; path=/; domain=*.redacted.com; HttpOnly; SameSite=Lax; Secure<br/>Cache-Control: no-cache, private<br/>X-RateLimit-Limit: 100<br/>X-RateLimit-Remaining: 99<br/>Z-Redacted-Password-Auth-Valid-Until: 1595935589<br/>Strict-Transport-Security: max-age=31536000; includeSubDomains<br/>CF-Cache-Status: DYNAMIC<br/>Expect-CT: max-age=604800, report-uri="<a class="ae kv" href="https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct" rel="noopener ugc nofollow" target="_blank">https://report-uri.cloudflare.com/cdn-cgi/beacon/expect-ct</a>"<br/>Server: cloudflare<br/>Content-Length: 480<br/><br/>{"data":{"type":"createtwofa","attributes":{"secret":"code","qr":"someurl","qr_url":"anotherurl"},"id":"a code(not the password it asked)"},"last_user_action":{"date_iso8601":"2020-07-28T13:30:14+02:00","unix":"1595935814"}}</span></pre><p id="5a38" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">转发并遵循流程，无需有效密码即可启用2fa。绕过了“安全web应用程序设计原则”。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="7e92" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读，祝大家好运。</p></div></div>    
</body>
</html>