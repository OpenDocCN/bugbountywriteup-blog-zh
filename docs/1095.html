<html>
<head>
<title>Exploiting CSRF chaining with IDOR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用IDOR开发CSRF链接</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/exploiting-csrf-chaining-with-idor-7617371ce6e3?source=collection_archive---------1-----------------------#2021-01-30">https://infosecwriteups.com/exploiting-csrf-chaining-with-idor-7617371ce6e3?source=collection_archive---------1-----------------------#2021-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="06af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">各位研究员好，</strong></p><p id="20fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我自己，<strong class="jp ir">拉菲阿哈迈德</strong>。我是来自孟加拉国的网络安全研究员。我目前在达卡大学攻读BBA。但是我喜欢无聊的东西。让我们不要浪费时间进入我们的主题。</p><h1 id="2738" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">什么是CSRF？</h1><blockquote class="lj lk ll"><p id="f0f2" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><strong class="jp ir">跨站请求伪造</strong>，也称为<strong class="jp ir">一键攻击</strong>或<strong class="jp ir">会话骑行</strong>，缩写为<strong class="jp ir"> CSRF </strong>或<strong class="jp ir"> XSRF </strong>，是一种恶意利用网站的方式，在这种方式下，web应用程序信任的用户会提交未经授权的命令。</p></blockquote><h1 id="e883" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">IDOR是什么？</h1><blockquote class="lj lk ll"><p id="6905" class="jn jo lm jp b jq jr js jt ju jv jw jx ln jz ka kb lo kd ke kf lp kh ki kj kk ij bi translated"><em class="iq">不安全的直接对象引用(IDOR)是一种访问控制漏洞，当应用程序使用用户提供的输入直接访问对象时会出现这种漏洞。</em></p></blockquote><p id="453e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在测试一个<strong class="jp ir"> NDA ( <em class="lm">保密协议</em> ) </strong>程序，我注意到网络应用程序有一个<strong class="jp ir">删除用户账户的选项。</strong></p><p id="85e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用Burp来拦截请求，以测试IDOR，因为我喜欢查找IDOR。但我找不到任何数字身份证或任何相同的东西。但是有一个<strong class="jp ir">用户ID参数</strong>包含了用户的<strong class="jp ir">用户名</strong>。我用我的第二个帐户的用户名更改了用户ID，但是没有用。然后我注意到没有任何CSRF令牌。因此，我使用Burp生成了一个CSRF PoC，并使用我的另一个帐户打开了HTML文档。但是没有用。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/65bf958e231f45fcdedacb767d8ef751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNPbwghaFDoH5BZknlZ-UA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">CSRF文件</figcaption></figure><p id="1bb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我想起了那个用户ID参数。我再次用我的第二个帐户的用户名更改了用户ID。我用我的第二个帐户打开了文档，我的帐户被删除了。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mg"><img src="../Images/87866a162e3b252178c798f34059350e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qllhuwM_ERwgcjxoCc6GFA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">利用</figcaption></figure><p id="f895" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很快报告了这个漏洞，公司在24小时内修复了这个漏洞。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/db645b334a823dafd2b82277c99f1120.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/1*kY3HViMbLPrlpeVGbrLgiw.gif"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated">开发商</figcaption></figure><p id="7002" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你们喜欢这个。PM我在<a class="ae mi" href="https://www.facebook.com/rafiahamed.rupak.3" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a><a class="ae mi" href="https://www.linkedin.com/in/rafi-ahamed" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">、LinkedIn </strong> </a>或<a class="ae mi" href="https://twitter.com/L3onid1s" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Twitter </strong> </a>如果你有任何问题。</p><p id="b567" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="lm">#吃_睡_黑_重复<br/>#全部黑掉</em> </strong></p></div></div>    
</body>
</html>