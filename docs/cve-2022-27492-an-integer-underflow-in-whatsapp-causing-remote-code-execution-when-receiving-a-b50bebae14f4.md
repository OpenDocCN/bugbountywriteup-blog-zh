# CVE-2022–27492:WhatsApp 中的整数下溢导致在接收特制视频文件时远程执行代码

> 原文：<https://infosecwriteups.com/cve-2022-27492-an-integer-underflow-in-whatsapp-causing-remote-code-execution-when-receiving-a-b50bebae14f4?source=collection_archive---------1----------------------->

作者:[安舒尔·维亚斯](https://www.instagram.com/_ansh_vyas/)

![](img/2d3d7aed6f71cfb398be6e119cb0c416.png)

[Eyestetix 工作室](https://unsplash.com/@eyestetix?utm_source=medium&utm_medium=referral)在 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral) 拍摄的照片

# 概观

由于 WhatsApp 中的整数下溢，精心编制的视频文件可能会触发远程代码执行。组件视频文件处理程序的一个未指定代码块受此 RCE 错误影响。此漏洞是由操纵可能损坏内存的未知输入引起的。恶意攻击者需要说服用户播放放入 WhatsApp messenger 的特制视频文件，才能利用此漏洞。

# 整数下溢

将负值赋给一个在赋值时应该始终为正的数，会在执行算术整数运算时导致整数下溢错误。如果将值为-120 和-9 的两个 8 位二进制补码整数相加，得到的二进制补码数为-129，小于可能的最小二进制补码数(-128)。在这种情况下，大整数已经下溢。这是危险的，因为当以目标整数大小解释时，结果将具有不同的含义。

如果解释为 8 位二进制补数，则-129 就是 127。如果一个负数(意味着其最高有效位被置位)被加到一个非负数(意味着其最高有效位未被置位)上，就会发生整数下溢。将两个符号不同的数字相加时，不会发生整数溢出。可以用类似的方式检查是否发生了整数溢出。

带有负值的数组索引错误是整数下溢错误的典型例子。这种类型的弱点通常会导致崩溃和未定义的行为。当循环索引变量溢出时，也很有可能出现无限循环。

# 发生整数下溢的结果

整数的上溢、下溢或舍入可能会导致以下结果:

1.  如果程序中发生整数溢出或下溢，数学计算将产生不准确的结果。
2.  使用变量来控制循环可能会导致无限循环，如果由于整数溢出而从未到达该变量，则会导致无限循环，如果条件从未满足，则会导致无限循环。
3.  当使用变量来确定分配给缓冲区的内存量时，整数溢出导致的负值可能会导致系统崩溃。

# 结论

通过为用于存储整数值的变量分配正确的内存量，可以避免整数溢出和下溢。某些编程语言中的特殊数据结构可以检测到整数溢出。开发人员应该采取所有必要的步骤来防止这种运行时错误。

## 来自 Infosec 的报道:Infosec 每天都有很多内容，很难跟上。[加入我们的每周简讯](https://weekly.infosecwriteups.com/)以 5 篇文章、4 条线索、3 个视频、2 个 GitHub Repos 和工具以及 1 个工作提醒的形式免费获取所有最新的 Infosec 趋势！