<html>
<head>
<title>Cisco BroadWorks Vulnerabilities CVE-2021–34785 &amp; CVE-2021–34786</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">思科BroadWorks漏洞CVE-2021–34785和CVE-2021–34786</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cisco-broadworks-vulnerabilities-cve-2021-34785-cve-2021-34786-91ee2be5a200?source=collection_archive---------2-----------------------#2021-10-02">https://infosecwriteups.com/cisco-broadworks-vulnerabilities-cve-2021-34785-cve-2021-34786-91ee2be5a200?source=collection_archive---------2-----------------------#2021-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="025f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di"> H </span>我！今天我将谈谈我在思科产品<strong class="jp ir"> BroadSoft BroadWorks </strong>的最新发现，这是思科产品之一。我发现了两个简历，分配为</p><ol class=""><li id="5b86" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated"><strong class="jp ir">CVE-2021–34785</strong>:IDOR导致权限升级“管理帐户接管”</li><li id="8087" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated"><strong class="jp ir"> CVE-2021-34786 </strong> : IDOR导致删除任意管理员用户账户</li></ol><p id="6ede" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会谈论完整的故事或类似的东西，因为我讨厌这些无用的话😅所以让我们直接从利用和条件开始。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi li"><img src="../Images/e7b8b92e9907ee55d0ae22328289ff51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-QfHKCEhP8jDCCOrwptTCw.png"/></div></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="0781" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">内容</h2><ol class=""><li id="c297" class="ku kv iq jp b jq mu ju mv jy mw kc mx kg my kk kz la lb lc bi translated">宽幅结构</li><li id="de62" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">CVE-2021–34785</li><li id="648d" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">CVE-2021–34786</li><li id="a969" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">弱点</li></ol></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="8408" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">1.宽幅结构</h2><p id="1064" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">在BroadWorks，我们有一个管理员组，其中的管理员拥有写和读权限，其他管理员拥有只读权限。</p><ol class=""><li id="3d3a" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">读写:他可以修改自己和其他管理员的数据。此外，他还可以添加用户、更改系统首选项、删除用户以及完全控制系统</li><li id="5ac4" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">只读:他可以修改他的数据和删除他的帐户。“在我的情况下”他没有任何其他特权</li></ol><p id="f9f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我获得了第二个角色(只读)，我的任务是尝试提升我的权限，使其具有读写操作。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="bfa8" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">2.CVE-2021–34785</h2><p id="7a4c" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">如果您尝试查看系统用户，我们有两个用户:<code class="fe nc nd ne nf b">Admin</code>和<code class="fe nc nd ne nf b">PentestAdmin</code>。我的用户是<code class="fe nc nd ne nf b">PentestAdmin</code>，权限很低，只能读取他的数据。用户管理员拥有系统的完全控制权</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ng"><img src="../Images/f697f8aff5a5ef20c5e2894ad77d0daf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eJmzHbm0_nJGv4J3alln9A.png"/></div></div></figure><p id="c9c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图列举管理帐户，以了解什么是允许的功能，但不幸的是！在管理员配置文件中没有允许使用的功能，我只能查看数据，但无论如何，我知道<code class="fe nc nd ne nf b">firstname</code>、<code class="fe nc nd ne nf b">lastname</code>和<code class="fe nc nd ne nf b">adminID</code></p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nh"><img src="../Images/8b1dedbc550842fa22c2282b14befa06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0ONgbYW3tFMHr7LSKenSSQ.png"/></div></div></figure><p id="deeb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我试图列举我的帐户，发现我有2个允许的功能删除帐户和更改密码，而没有问你的旧密码，奇怪吧？！</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ng"><img src="../Images/a9159ba842c9f40a4885d5ee103194cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sNLFJ1Tcj7a3-ncv6ba7kw.png"/></div></div></figure><p id="0733" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我输入了一个新的密码，并拦截了请求，以了解请求参数是什么。我发现我们有<code class="fe nc nd ne nf b">firstname, lastname</code>和<code class="fe nc nd ne nf b">loginid</code>必需的参数，因为我试图删除<code class="fe nc nd ne nf b">loginid</code>，但不幸的是！请求失败</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ni"><img src="../Images/2cf18df55b3969146beec8edac560808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o0T0wHOv4uLqUse55IhvNg.png"/></div></div></figure><p id="fd1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这根本不是问题，因为我有权限读取所有用户的数据，所以我从管理员配置文件中知道这些数据。</p><p id="6eb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一步是用管理数据替换您的数据并发送请求。它返回200 OK，为了检查，我试着用新密码登录，然后Bingoooo！你接管了管理员帐户，改变他的密码❤</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ni"><img src="../Images/93ef311e564f7d4e96730e149b5c5f03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sL7HCG8xgjmVH4U8s2y4Ew.png"/></div></div></figure><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nj"><img src="../Images/ab83b86169ca01ab8d021b8af174cb42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*q7mWUcIWp9Yr0NKDJJ2d1A.jpeg"/></div></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk translated">成功后我和我的朋友❤</figcaption></figure><p id="2f40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了进行POC，我创建了一个具有读写权限的新用户<code class="fe nc nd ne nf b">SecmeterPOC</code>。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ni"><img src="../Images/351a39f6ba076fecf3ba049ff801c72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Z2-3fGAu0tb6wVnIyyJBA.png"/></div></div></figure><p id="7917" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看管理板后</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ni"><img src="../Images/7334b4c29a39efb1262144fc774d9d4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCwo35j5wU6g6lRqgei6WA.png"/></div></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="4618" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">3.CVE-2021–34786</h2><p id="af92" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated">用同样的方法，我试图删除我的帐户并拦截请求。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ni"><img src="../Images/8dba2dd3add59461d4d525535de0d544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cJSTk9YACVk-TyBrPcDofA.png"/></div></div></figure><p id="a605" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有相同的所需参数<code class="fe nc nd ne nf b">firstname/lastname/loginid</code>和相同的利用，只需用管理员帐户数据替换它们并发送请求。</p><p id="6dd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果如何？管理员帐户已被删除😈</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi no"><img src="../Images/85b0acb6c7babe21ed6ec7bd89939fad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bbbh5mmHpIQBFfDYL_36MA.jpeg"/></div></div></figure></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><h2 id="f1ea" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">4.弱点</h2><ol class=""><li id="1a4d" class="ku kv iq jp b jq mu ju mv jy mw kc mx kg my kk kz la lb lc bi translated">在更改密码功能中，它必须要求我输入旧密码，如果我忘记了，它应该要求我联系系统管理员。</li><li id="c034" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">用户会话中没有附加CSRF令牌来保护系统免受使用CSRF的相同攻击[我已经尝试并成功了]</li><li id="c7ec" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">在删除帐户时，它必须要求用户输入密码或任何安全问题</li></ol></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi np"><img src="../Images/58cf44baa356e7df442049ce0f0b3ea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QqouWMet8rJszbF5SX6B9Q.png"/></div></div></figure><h2 id="a068" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">保持联系</h2><p id="3d70" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mz ka kb kc na ke kf kg nb ki kj kk ij bi translated"><a class="ae nq" href="https://www.linkedin.com/in/eslam-akl-6b998614a/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>|<a class="ae nq" href="https://github.com/eslam3kl" rel="noopener ugc nofollow" target="_blank">GitHub</a>|<a class="ae nq" href="https://twitter.com/eslam3kll" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>