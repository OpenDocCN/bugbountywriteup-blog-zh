<html>
<head>
<title>The First Bounty Target (Disclosing Multiple Reports)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">第一个赏金目标(披露多份报告)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/the-first-bounty-target-disclosing-multiple-reports-b963bffb36cd?source=collection_archive---------0-----------------------#2020-11-21">https://infosecwriteups.com/the-first-bounty-target-disclosing-multiple-reports-b963bffb36cd?source=collection_archive---------0-----------------------#2020-11-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a9f7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">你好，</p><p id="3c03" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，很抱歉这么长时间没有发帖。我真的很忙，在这个封闭推销我的黑客声誉和其他东西。我写这篇博客是想谈谈我的方法，以及在不使用任何工具的情况下，我是如何在我的第一个目标上发现多个漏洞的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/2bed9cfb57e7abee84dedd4b45e49b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dtrYE3QY2LzmnaTVh6RnPw.png"/></div></div></figure><p id="fa35" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">无论如何，让我们回到我们的话题，我不会透露公司的名字，因为这是一个私人项目，但会称之为<strong class="js iu">shopping.com</strong>，因为这是一个购物网站。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="la lb l"/></div></figure><h1 id="8d87" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究索引</h1><p id="8773" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">这是我第一个获得赏金的目标，因为第一笔赏金总是很特别的。我继续攻击目标，报道更多的报道，获得更多的奖金</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi mf"><img src="../Images/dcf0b37e0591119b4cf9880c15ef7466.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ojZjO3MgzJVmr1GB18c6Rw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">总共50，000印度卢比的奖金:P</figcaption></figure><h1 id="ad54" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:1</h1><p id="199c" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(未经认证的注册号码)</p><p id="484a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我今年早些时候写的关于这个的博客:</p><div class="mk ml gp gr mm mn"><a href="https://medium.com/bugbountywriteup/how-inspect-element-got-me-a-bounty-58d3a9946225" rel="noopener follow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">监察元素是如何让我得到赏金的</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">您好家伙，我最近遇到了一个惊人的绕过改变我的电话号码在一个应用程序，不允许…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ky mn"/></div></div></a></div><h1 id="302f" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:2</h1><p id="d0b4" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(密码重置后不正确的会话管理)</p><p id="f59f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这个场景中，我创建了一个帐户，并在两个浏览器中登录。我在一个浏览器中更改了帐户的密码，并试图在第二个浏览器上进行编辑，成功了，因此出现了不正确的会话管理缺陷，这显然是一个小问题。</p><h1 id="37bd" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:3</h1><p id="5090" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(打开重定向和CSRF到帐户接管)</p><p id="f8c5" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的情况有点不同，我注意到当我从购物车中删除一些东西时，会发送一个POST请求，其中请求正文中有一个<strong class="js iu"> redirect </strong>参数，我很快将参数值更改为我的服务器，它会重定向到我的服务器，有趣的是它会附带用户Cookies。</p><p id="16fd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我通过打嗝套件将其转换为CSRF POC，并使用不同的帐户发出请求，我成功地将受害者重定向到攻击者的网站，并窃取了他们的cookies</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nc"><img src="../Images/9aabe25f0357ad0d3f0268eb09aa4a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pHo7svSHqj87vuLbPkGrQw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">发布请求(案例研究:3)</figcaption></figure><h1 id="86ca" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:4</h1><p id="1b2a" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(IDOR按跟踪顺序)</p><p id="e3bd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">所以在这个hopping.com的网站上，有一个“跟踪我的订单”选项，在成功下订单后，人们可以用订单id跟踪订单。因此，利用这一功能，如果攻击者知道受害者的电话号码，他就可以获取任何受害者的详细信息，而他不需要知道订单号，因为在Burp Suite入侵者的帮助下(为了更好地理解，请参考下面的截图)，他可以强行找到正确的订单号，并获得他的订单的详细信息，从而泄露受害者的地址和其他个人信息</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nd"><img src="../Images/a272d8a4837d567ffbb431ec9ad660bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lyB-y0_-4qWqqpJ65TM3_g.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">案例研究:4</figcaption></figure><p id="f630" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在这里，我用我的另一个帐户的手机号码强制使用id_order参数，并获得第二个帐户下的所有订单。</p><h1 id="5be4" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:5</h1><p id="920f" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(我在查看我的订单历史)</p><p id="aa88" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">特别说明:这些功能只有我在shopping.com上购买后才能使用</p><p id="657a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里的情况非常简单，我进入我的“我的订单”页面，当我单击我的订单时，它会刷新页面并显示订购的产品，我拦截了请求并再次单击订购的产品&amp;令我惊讶的是，在请求正文中再次出现了一个"<strong class="js iu">into orderid "</strong>参数，我很快将它发送到Burp intruder，并猜测我有多个订单细节泄露了他们客户的PII</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ne"><img src="../Images/6f6bd13c569edd56c25f2ce06719b6be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfD2-G4o2KhPMTfS6cTzJg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">案例研究:5</figcaption></figure><h1 id="7101" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">案例研究:6</h1><p id="43e9" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(密码重置链接不会过期)</p><p id="5446" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">嗯，这也是一个小错误，而且非常简单。作为参考，我贴出一份黑客报告，它会给你一个想法(也可能因程序而异)</p><div class="mk ml gp gr mm mn"><a href="https://hackerone.com/reports/898841" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd iu gy z fp ms fr fs mt fu fw is bi translated">HackerOne上披露的Shopify:密码重置链接未在过期...</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">您可以使用密码重置链接多次重置密码。步骤:1。转到…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">hackerone.com</p></div></div></div></a></div><h1 id="234a" class="lc ld it bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">案例分析:7 </strong></h1><p id="1a34" class="pw-post-body-paragraph jq jr it js b jt ma jv jw jx mb jz ka kb mc kd ke kf md kh ki kj me kl km kn im bi translated">(成功下单后泄露客户详细信息)</p><p id="f651" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">同样，这个问题也是在成功订购后发现的，在这里，当我下订单时，URL是这样的:<strong class="js iu"/><a class="ae nf" href="https://www.allensolly.com/orderconfirmation?securekey=" rel="noopener ugc nofollow" target="_blank"><strong class="js iu">https://www.shopping.com/orderconfirm?secretkey=</strong></a><strong class="js iu">&lt;some-key&gt;&amp;orderid =&lt;orderid&gt;<br/></strong>我按降序更改了订单，PII开始披露其中包括姓名、地址、电话号码和付款方式。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="ng lb l"/></div></figure></div><div class="ab cl nh ni hx nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="im in io ip iq"><p id="73c3" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">外卖—</strong></p><p id="a02f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我想说我从这次经历中得到的收获是停留在一个目标上并理解它，让自己感觉舒服，不要匆忙。如果你有资格购买，那就买吧！！肯定会带点东西的。</p><p id="a51d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个博客到此为止。希望你喜欢。</p><p id="7946" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在<a class="ae nf" href="https://www.linkedin.com/in/adtyasoni" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae nf" href="https://twitter.com/hetroublemakr" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上与我联系</p><p id="98bf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果你喜欢这个博客，请点击👏按钮，并分享它以帮助其他人找到它。</p></div></div>    
</body>
</html>