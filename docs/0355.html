<html>
<head>
<title>How I setup an industry grade Firewall on my home network?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在我的家庭网络上设置行业级防火墙？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-setup-an-industry-grade-firewall-on-my-home-network-8631eaeebd7a?source=collection_archive---------0-----------------------#2019-08-16">https://infosecwriteups.com/how-i-setup-an-industry-grade-firewall-on-my-home-network-8631eaeebd7a?source=collection_archive---------0-----------------------#2019-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/4565e1a87ef33d693ecf979fc071f267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NTmlWmcOzQugt7xL3ywStw.png"/></div></div></figure><div class=""/><div class=""><h2 id="e9ff" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">Pfsense与Suricata、Snort和Squid的集成增强了网络安全性！</h2></div><blockquote class="kq kr ks"><p id="bf50" class="kt ku kv kw b kx ky kc kz la lb kf lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在一家能帮助你成长、让你自由摆弄你想学习和应用的技术的公司工作，是你所能要求的最好的工作环境。我想我不可能要求一份更好的工作作为我的第一份工作。好了，我今天的咆哮到此为止，现在让我们来谈谈技术吧！</p></blockquote><h1 id="25af" class="lq lr jb bd ls lt lu lv lw lx ly lz ma kh mb ki mc kk md kl me kn mf ko mg mh bi translated">背景</h1><p id="179f" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">我刚刚加入了一个新组织，在那里，我第一次认真地为蓝队工作，制定安全措施，同时找出找到漏洞的方法，并在此过程中修复它。前一周，我在研究OSquery和ELK stack的组合，以增强日志功能。</p><blockquote class="kq kr ks"><p id="529a" class="kt ku kv kw b kx ky kc kz la lb kf lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">阅读此处- <a class="ae mq" href="https://medium.com/bugbountywriteup/how-i-developed-a-full-fledged-security-operations-centre-using-elk-stack-8dfaec821e23" rel="noopener">我如何使用ELK Stack开发一个成熟的安全运营中心？</a></p></blockquote><p id="58a7" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">这个项目完成后，我开始着手其他项目，配置防火墙是我想尝试的下一件事。我想到的最好的解决方案涉及pfSense，所以我想为什么不在我家里安装它，然后在实际环境中部署它之前对它进行实验。因为任何使用过防火墙的人都知道，所使用的规则集和工具必须精心配置，否则要么会产生太多的误报，要么会让几乎所有的流量通过，而这些条件实际上对我们都没有用。</p><h1 id="eac5" class="lq lr jb bd ls lt lu lv lw lx ly lz ma kh mb ki mc kk md kl me kn mf ko mg mh bi translated">我们开始吧！</h1><p id="07b8" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">所以，现在已经决定我将在pfSense上工作，现在是在我的虚拟盒子环境上设置它并看看它是否正常工作的时候了。下一个计划是，一旦设置正确，查看pfSense默认提供的功能。</p><h2 id="e2b2" class="mr lr jb bd ls ms mt dn lw mu mv dp ma mk mw mx mc mm my mz me mo na nb mg nc bi translated">设置pfSense</h2><p id="2934" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">我已经在我的系统上下载并安装了<a class="ae mq" href="https://www.virtualbox.org" rel="noopener ugc nofollow" target="_blank"> VirtualBox </a>。现在，在YouTube上浏览了几个关于pfSense的视频后，我继续从他们的网站下载了<a class="ae mq" href="https://www.pfsense.org/download/" rel="noopener ugc nofollow" target="_blank"> pfsense.iso </a>文件。下载文件后，我为64位FreeBSD机器创建了一个空白的Virtualbox环境，然后加载到。iso文件。现在要记住的是，pfSense需要两个网络适配器才能工作，现在的问题是为什么？pfSense需要这两个不同的网络适配器，因为它充当您的<a class="ae mq" href="https://en.wikipedia.org/wiki/Local_area_network" rel="noopener ugc nofollow" target="_blank"> LAN </a>和<a class="ae mq" href="https://en.wikipedia.org/wiki/Wide_area_network" rel="noopener ugc nofollow" target="_blank"> WAN </a>之间的网关。为了更好地理解，请看下图。</p><figure class="ne nf ng nh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/0eecceb64fa5e2e09c8b6c49d7d7c30a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NLjwFCdFFmuHstc09BEkew.png"/></div></div></figure><p id="fe3c" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">位于pfSense防火墙下的所有设备都是您本地网络上的设备，可以是您的办公室计算机、家庭设备等。而pfSense防火墙之上的一切都是广域网(互联网)。防火墙需要充当您的本地网络和互联网上的设备的网关，只有这样它才能监控您的互联网流量并正确保护您的网络。所以现在。iso文件已加载，我为我的虚拟机创建了两个不同的网络适配器，其中一个我放在NAT中，一个面向WAN，另一个面向LAN，我将它作为内部网络。现在，pfSense的硬件设置已经完成，让我们启动它。</p><p id="5c4a" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">一旦pfSense第一次启动，我们不需要做很多事情，基本上接受并按ok基本的东西。现在，在第二次启动时，我们会看到这些选项，如下所示。</p><figure class="ne nf ng nh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/fcf6ebf45051a6a62bc3814298402c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7McFogwQqhJdlOCG8ATwHQ.png"/></div></div></figure><p id="499b" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">现在，我们应该进行软件配置，以正确设置pfSense并使其正常工作。我们需要做的基本配置是设置IP地址。完成后，我们可以利用web gui界面来完成其余的设置。因此，您可以在这里将WAN配置为DHCP，即IP地址将动态提供给它，但对于又蓝，需要将其配置为静态IP地址，因为我们使用的是内部网络，所以我们将其分配为192.168.0.1/24。现在，一旦您为它分配了相应的IP地址，我们就需要设置另一个具有GUI的虚拟机，无论您的需求是什么，它都可以是Ubuntu、Windows。关于这个我就不细说了，你可以在这里看视频<a class="ae mq" href="https://www.youtube.com/watch?v=QbmRXJJKsvs" rel="noopener ugc nofollow" target="_blank">。请记住更改该机器的网络设置，并将其保持在分配给pfSense的同一内部网络中。</a></p><h2 id="72b6" class="mr lr jb bd ls ms mt dn lw mu mv dp ma mk mw mx mc mm my mz me mo na nb mg nc bi translated">配置pfSense</h2><p id="41b2" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">一旦虚拟机启动并运行ping 192.168.0.1，它应该会ping通而不会出现问题，如果没有，则您需要重新配置pfSense，因为它可能配置错误。现在，考虑到一切正常，我们需要打开浏览器，浏览到这个IP地址。我们将会看到一个类似这样的登录页面。</p><figure class="ne nf ng nh gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nj"><img src="../Images/248442377e4d6809b1729f27c193687f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EgDdAfe_-iqwmdbyI56-DQ.png"/></div></div></figure><p id="6498" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">默认的登录凭据是用户名:admin和密码:pfsense。登录后，您可以查看pfSense的整个仪表板。在我们开始在pfSense上安装特定的包之前，请随意探索并寻找pfSense默认提供的特性。</p><h2 id="9b9a" class="mr lr jb bd ls ms mt dn lw mu mv dp ma mk mw mx mc mm my mz me mo na nb mg nc bi translated">软件包的安装</h2><p id="2add" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">pfSense本身可以非常有效，但为此您需要正确配置规则。pfSense是一个防火墙，但我想在此基础上构建一个入侵检测和入侵防御解决方案，为此我使用了Suricata &amp; Snort。然后使用squid代理监控流量，只允许访问我们列入白名单的网站。要安装软件包，你只需点击“系统”,然后点击下拉菜单中的“软件包管理器”,然后搜索你想在pfSense上安装的软件包。</p><ul class=""><li id="c391" class="nk nl jb kw b kx ky la lb mk nm mm nn mo no lp np nq nr ns bi translated">放风&amp;苏里卡塔</li></ul><p id="6fe2" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">它们都是为了做同样的事情，也就是说，它们都是IPS/IDS解决方案，而且都非常出色。因为所有的工具都比另一个做得更好，所以我把它们都安装在了我的pfSense上。</p><ul class=""><li id="efd4" class="nk nl jb kw b kx ky la lb mk nm mm nn mo no lp np nq nr ns bi translated"><strong class="kw jc">鱿鱼</strong></li></ul><blockquote class="kq kr ks"><p id="349c" class="kt ku kv kw b kx ky kc kz la lb kf lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="kw jc"> Squid </strong>是一个<a class="ae mq" href="https://en.wikipedia.org/wiki/Web_cache" rel="noopener ugc nofollow" target="_blank">缓存</a>和转发HTTP <a class="ae mq" href="https://en.wikipedia.org/wiki/Web_proxy" rel="noopener ugc nofollow" target="_blank">的web代理</a>。它有各种各样的用途，包括通过缓存重复的请求来加速一个<a class="ae mq" href="https://en.wikipedia.org/wiki/Web_server" rel="noopener ugc nofollow" target="_blank"> web服务器</a>，缓存<a class="ae mq" href="https://en.wikipedia.org/wiki/World_Wide_Web" rel="noopener ugc nofollow" target="_blank"> web </a>、<a class="ae mq" href="https://en.wikipedia.org/wiki/Domain_Name_System" rel="noopener ugc nofollow" target="_blank"> DNS </a>和其他<a class="ae mq" href="https://en.wikipedia.org/wiki/Computer_network" rel="noopener ugc nofollow" target="_blank">计算机网络</a>为一群共享网络资源的人查找，以及通过过滤流量来帮助安全。</p></blockquote><p id="8b89" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">维基百科对它的效用做了最好的描述，因为它的功能性，我将它包含在pfSense中，特别是过滤流量，阻止我们认为不必要的网站，不允许用户通过使用IPs绕过防火墙规则浏览网页等。</p><ul class=""><li id="f138" class="nk nl jb kw b kx ky la lb mk nm mm nn mo no lp np nq nr ns bi translated"><strong class="kw jc">带宽d </strong></li></ul><p id="b79e" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">我将它添加到pfSense中，它还可以帮助我准确地监控网络上的哪个系统消耗了多少带宽，以及它们使用了什么类型的协议http、ftp等。它给出了所用带宽的图形表示，从而更容易指出任何违约者。</p><p id="ae37" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">根据我们的需要，我们可以将许多不同的工具与pfSense集成。</p><h1 id="dfbd" class="lq lr jb bd ls lt lu lv lw lx ly lz ma kh mb ki mc kk md kl me kn mf ko mg mh bi translated">发展自己的！</h1><p id="a84d" class="pw-post-body-paragraph kt ku jb kw b kx mi kc kz la mj kf lc mk ml lf lg mm mn lj lk mo mp ln lo lp ij bi translated">如果读完之后，你发现为自己做一个这样的设置真的很酷，相信我，你一定要试试。您需要理解防火墙规则是它们提供的所有安全性的关键要素，并且在编写它们时需要牢记您要配置它的组织的需求。</p><blockquote class="kq kr ks"><p id="807a" class="kt ku kv kw b kx ky kc kz la lb kf lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><em class="jb">附:如果你需要任何帮助来为你自己的家或你的组织设置这个，请随时联系我，让我们合作吧！</em></p></blockquote><p id="1dc7" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated"><strong class="kw jc">如果你喜欢，请鼓掌让我们合作吧。获取、设置、破解！</strong></p><p id="bb74" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">网址:【aditya12anand.com】T4|捐赠:<a class="ae mq" href="https://paypal.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">paypal.me/aditya12anand</a></p><p id="18fd" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">电报:<a class="ae mq" href="https://t.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">https://t.me/aditya12anand</a></p><p id="2155" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">推特:<a class="ae mq" href="https://twitter.com/aditya12anand?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">twitter.com/aditya12anand</a></p><p id="098b" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">领英:<a class="ae mq" href="https://www.linkedin.com/in/aditya12anand/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/aditya12anand/</a></p><p id="e438" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated">电子邮件:aditya12anand@protonmail.com</p></div><div class="ab cl nt nu hu nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ij ik il im in"><p id="f01f" class="pw-post-body-paragraph kt ku jb kw b kx ky kc kz la lb kf lc mk le lf lg mm li lj lk mo lm ln lo lp ij bi translated"><em class="kv">关注</em> <a class="ae mq" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="kv"> Infosec报道</em> </a> <em class="kv">获取更多此类精彩报道。</em></p><div class="ip iq gp gr ir oa"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd jc gy z fp of fr fs og fu fw ja bi translated">信息安全报道</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo ix oa"/></div></div></a></div></div></div>    
</body>
</html>