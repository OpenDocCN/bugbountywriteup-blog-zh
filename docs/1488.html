<html>
<head>
<title>Bypassing OTP Verification for Changing PIN in Registered Mobile Banking Account.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绕过OTP验证更改已注册手机银行账户的PIN码。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bypassing-otp-verification-for-changing-pin-in-registered-mobile-banking-account-ed92dbcaa5c7?source=collection_archive---------3-----------------------#2021-07-25">https://infosecwriteups.com/bypassing-otp-verification-for-changing-pin-in-registered-mobile-banking-account-ed92dbcaa5c7?source=collection_archive---------3-----------------------#2021-07-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f80c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">祝你平安</p><p id="b1f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，这是我的第二个帖子，看标题很有趣吧？</p><p id="6bf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我从这个应用程序的机制开始。我的手机号码是在这个手机银行应用程序中注册的，我设置了个人识别码以便登录。</p><p id="a944" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的用户配置文件配置在移动设备的内部存储中加密。因为我对手机测试的了解不够。我正在用我知道的web应用程序方法做这个测试。:D</p><p id="d005" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">移动应用程序是这样工作的:</p><ol class=""><li id="b9e0" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">每次首次加载应用程序时，它都会请求后端API (api/v1/credential/status)检查设备中注册的移动银行号码(手机)的状态。如果号码状态正常，则服务器将做出如下响应:</li></ol><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/1d6d9888a59f020534714bec521c258a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*rfOLmLsbgH2Ydqj1FhUe1w.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">状态正常时来自服务器的响应。</figcaption></figure><p id="6e18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(“Sukses”表示成功)。请求和响应是用base64编码的，所以很容易被解码。</p><p id="93e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.然后，应用程序将弹出PIN的输入表单来登录。</p><p id="762e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.要更改PIN，系统会提示用户将OTP验证发送到在该手机银行应用程序中注册的手机号码。</p><p id="ff93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这个移动银行应用程序来说，这是一个正常的流程。下面是我如何(意外地)发现绕过OTP验证机制来更改PIN的。</p><p id="886b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">枚举状态响应</em> </strong></p><p id="d0e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我和我的团队向银行系统注册了4个手机号码。因为我试图检查反自动化机制，我的电话号码被屏蔽了。所以，当我打开我的手机银行应用程序时，它显示的响应是这样的:</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/05305de0b1534f70714ee5a0efd0c387.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*m9CdffeUvdzi7ZhEDj_8Hw.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">阻止来自服务器的邮件</figcaption></figure><p id="ef7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的账户被封了，需要我去最近的ATM机重新激活。但是这里有一个有趣的现象，我的手机号码给了我一个不同的回复。那么，如果我更改了电话号码(请求中)会发生什么呢？这可能会枚举电话号码的状态。</p><p id="de8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，使用api/v1/credential/status函数没有限制，所以我做了一些有效载荷，包括所有4个数字，用于测试这个应用程序以了解状态。我发动了打嗝入侵者，我从我的有效载荷中发现了4个状态。</p><ol class=""><li id="07a0" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">成功状态</li><li id="b1f8" class="km kn iq jp b jq li ju lj jy lk kc ll kg lm kk kr ks kt ku bi translated">已经注册，需要设置PIN</li></ol><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/502fdb9b52cc3931720ebedd5a59dbf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*vpOETXSnQtu2hvu9OcS9YQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">响应表明需要设置PIN</figcaption></figure><p id="3bde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.被屏蔽(<em class="kl">我的手机号:D </em>)，而且</p><p id="37dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.未注册的手机号码</p><p id="c17a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你们有些人已经能猜到下一步会是什么了，对吗？第二点非常有趣。假设是08123456789号。如果我把电话号码改成08123456789会怎么样？因此，我打开拦截并加载我的移动应用程序银行，它带有对api/v1/credential/status的请求，我将电话号码参数更改为08123456789 <em class="kl">。</em>和uupsss，应用程序显示设置PIN表单。(<em class="kl">这个我不能截图，因为UI一模一样)</em>。</p><p id="e11b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，我想我成功地为08123456789手机号码设置了一个新的PIN。但事实并非如此。发生的情况是，我成功地更改了自己的PIN，但状态仍然被阻止。</p><p id="80be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，收购的可能性在哪里呢？</p><p id="c588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然概率很小，但还是有可能发生。如果有人丢失了他们的手机和/或攻击者有能力访问设备，而所有者还没有时间封锁帐户。攻击者将试图完全控制设备(rooteded或越狱)，如果设备成功root，攻击者就可以执行上述测试。</p><p id="c23e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，几率很小，但预防胜于治疗，对吗？</p><p id="4d82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我的笔记:</strong></p><ul class=""><li id="9cef" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk lo ks kt ku bi translated"><em class="kl">如果有机会做一些列举条件，不要错过那个测试。</em></li><li id="1e3d" class="km kn iq jp b jq li ju lj jy lk kc ll kg lm kk lo ks kt ku bi translated">拥有一个具有多个条件的测试用户将使测试更加全面。</li></ul><p id="6ae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，这次到此为止。再次为我有限的英语道歉。希望能理解。</p><p id="5281" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你有关于移动渗透测试的好资源，书籍或网站等，请评论。我将非常感激。我对Brida也很感兴趣，有人已经用它进行移动测试，尤其是android应用程序吗？请与我分享。</p></div></div>    
</body>
</html>