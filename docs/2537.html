<html>
<head>
<title>Reflected XSS using Double Encoding</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用双重编码反射XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/got-another-xss-using-double-encoding-e6493a9f7368?source=collection_archive---------0-----------------------#2022-11-17">https://infosecwriteups.com/got-another-xss-using-double-encoding-e6493a9f7368?source=collection_archive---------0-----------------------#2022-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c2c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用双重编码绕过XSS滤波器</h2></div><p id="b113" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你好黑客们，</p><p id="c7f8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最近，我开始了我的bug狩猎之旅，并通过绕过Cloudflare WAF获得了一个XSS(你可以在这里阅读相关内容)。现在我带着另一个由<a class="ae lb" href="https://owasp.org/www-community/Double_Encoding" rel="noopener ugc nofollow" target="_blank">双编码</a>的XSS回来了。</p><blockquote class="lc ld le"><p id="0b8b" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">这种攻击技术包括以十六进制格式对用户请求参数进行两次编码，以绕过安全控制或导致应用程序出现意外行为。这是可能的，因为web服务器接受并处理许多编码形式的客户端请求。</p></blockquote><p id="5f95" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">直接进入它…</p><p id="8657" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有志者事竟成。像这样如果有输入字段，就有<strong class="kh ir"> <em class="lf">的机会</em> </strong>的跨站脚本。目前，我正在使用非常基本的方法，同时试图通过学习更多的方法和错误来发现错误和提高自己。在检查一些目标和测试输入字段(比如搜索框)时，我得到了一个有趣的输入字段，我只是输入了通常的输入</p><div class="lj lk ll lm gt ab cb"><figure class="ln lo lp lq lr ls lt paragraph-image"><img src="../Images/936534ff6cb86f8a0157b015d33ac71b.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*sKdEDlEPx5zFb8tw_MRt8w.png"/></figure><figure class="ln lo lw lq lr ls lt paragraph-image"><img src="../Images/337336c001a7665f65b5a9afd890f95f.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*wYVZ4pNQWYiMJ0OApXi0Lg.png"/><figcaption class="lx ly gj gh gi lz ma bd b be z dk mb di mc md translated">搜索栏</figcaption></figure></div><p id="1b98" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并检查了源代码。</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi me"><img src="../Images/304292f26cdae9869170305eebc32cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WreayTxc8oJ3MyN5dmpinw.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">源代码</figcaption></figure><p id="4a5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我添加了一个单引号，但它过滤了输入，并用<em class="lf">hello 1&amp;amp；</em>在某些地方，在我们的目标字段中带有“&amp;”。</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mj"><img src="../Images/2e250e68f1fb36d437a44b888ca0a353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H40WwOYXC82CxsTAjfz9PQ.png"/></div></div></figure><p id="181a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在那里尝试了URL编码，然后也得到了相同的输出，这意味着它解码了输入。</p><p id="3797" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我用了<a class="ae lb" href="https://owasp.org/www-community/Double_Encoding" rel="noopener ugc nofollow" target="_blank">双编码</a>。<br/>通过使用双重编码，可以绕过只对用户输入解码一次的安全过滤器。第二个解码过程由适当处理编码数据的后端平台或模块执行，但没有相应的安全检查。</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mk"><img src="../Images/17bd906869b8add4ff4c2dc53f034b85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cFVPgs1ixE6id9tt04VHlQ.png"/></div></div></figure><p id="b34c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它工作了。</p><p id="46d1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们的基本有效载荷' &gt;<script>alert①</script>用双编码试了试。</p><blockquote class="lc ld le"><p id="3351" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">% 25281 % 2529 % 253C脚本%253E警报% 25281 % 2529 % 253C %脚本%253E</p></blockquote><p id="2654" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是它产生了一个错误</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/866d80fc82c54339c9baa6b823a79844.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/1*9PtFrr5fJ8cuNSObVSivJA.png"/></div></figure><p id="83c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我搜索了输入标签的属性来利用它。<br/> <a class="ae lb" href="https://www.w3schools.com/jsref/event_onfocus.asp" rel="noopener ugc nofollow" target="_blank"> onfocus </a>:当一个元素获得焦点时发生onfocus事件。</p><p id="e431" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">onfocus='alert(1)'</p><blockquote class="lc ld le"><p id="79d8" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">%2527%2520焦点% 2529 % 2527警报%25281%2529%2527%2520</p></blockquote><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi mm"><img src="../Images/99396cb850b4fae685df784f93d24a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iMKZIOLWiiibNbZrqYyDbQ.png"/></div></div></figure><p id="25ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我点击搜索栏，弹出警告出现了。</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/838e1ca9c2a93bdff8b79e0f9b4a5730.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*Bu6olIBiwyV83lHcixnaPA.png"/></div></figure><p id="217b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我想用autofocus对它做一点修改，使文本字段在页面加载时自动聚焦，并在访问页面时创建弹出警告。</p><p id="7fe8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">onfocus='alert(1)' autofocus= '</p><blockquote class="lc ld le"><p id="e5dd" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">% 2527% 2520 onfocus % 253d % 2527 alert % 25281% 2529% 2527% 2520 auto focus % 253d % 2527</p></blockquote><div class="lj lk ll lm gt ab cb"><figure class="ln lo mo lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><img src="../Images/b73014e69dc18deacbd3c58315ca8c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*p04SyNxatkKeUTcf4WqNhQ.png"/></div></figure><figure class="ln lo mp lq lr ls lt paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><img src="../Images/385827d87ed4f467ed7339bb0ce2fb90.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*7ninlp76bIsON3ZpV_kB0Q.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk mq di mr md translated">XSS</figcaption></figure></div><p id="cd1c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是啊。成功了…</p><figure class="lj lk ll lm gt lo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/28ea519d33e0db47444dc59fab844904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*WxgmFQb39D0aBGBpipBgdw.png"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk translated">OpenBugBounty</figcaption></figure><p id="ccb4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您还可以使用有效负载，如</p><p id="6eb8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">onmouseover='alert(1)'</p><blockquote class="lc ld le"><p id="d966" class="kf kg lf kh b ki kj jr kk kl km ju kn lg kp kq kr lh kt ku kv li kx ky kz la ij bi translated">% 2527% 2520 onmouseover % 253d % 2527 alert % 25281% 2529% 2527% 2520</p></blockquote><p id="43b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读…</p><h1 id="697d" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">跟我来:</h1><p id="7948" class="pw-post-body-paragraph kf kg iq kh b ki nl jr kk kl nm ju kn ko nn kq kr ks no ku kv kw np ky kz la ij bi translated">推特:<a class="ae lb" href="https://twitter.com/ag3n7apk" rel="noopener ugc nofollow" target="_blank">https://twitter.com/ag3n7apk</a></p><p id="3edf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">领英:【https://www.linkedin.com/in/abhijith-pk-ag3n7/ T2】</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><h2 id="7d1c" class="nx mu iq bd mv ny nz dn mz oa ob dp nd ko oc od nf ks oe of nh kw og oh nj oi bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lb" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周时事通讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>