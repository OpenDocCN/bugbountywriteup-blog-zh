<html>
<head>
<title>[Metasploit]Upgrade Normal Shell To Meterpreter Shell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[Metasploit]将普通Shell升级到Meterpreter Shell</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/metasploit-upgrade-normal-shell-to-meterpreter-shell-2f09be895646?source=collection_archive---------0-----------------------#2021-09-16">https://infosecwriteups.com/metasploit-upgrade-normal-shell-to-meterpreter-shell-2f09be895646?source=collection_archive---------0-----------------------#2021-09-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4040" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们访问机器后，有时我们会在开发后立即获得Meterpreter外壳。Meterpreter Shell提供了在被入侵的机器上做一些事情的最简单的方法，因此，我们希望获得这个Shell而不是命令Shell，但是大多数情况下，在我们利用机器后，我们会进入命令Shell。在这种情况下，我们希望将我们的shell升级到Meterpreter Shell。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h2 id="159f" class="ks kt iq bd ku kv kw dn kx ky kz dp la jy lb lc ld kc le lf lg kg lh li lj lk bi translated">升级普通命令Shell ===&gt; Meterpreter Shell的步骤</h2><p id="ac27" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在这种情况下，机器被利用后，我们进入正常的命令外壳。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/d18db6d2cfa5d2998b7ce6ced7c3ff4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cBYmShe9Qk9nJTi54ImIrQ.jpeg"/></div></div></figure><p id="18a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤1 </strong>:后台当前(普通Shell)会话，我们可以通过按<strong class="jp ir"> CTRL+Z </strong>来完成</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/2d613571bbd7bcf20f0064367045dc4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*ZwfmKMOpTbYXZDfwgjZhpw.jpeg"/></div></figure><p id="a82d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤2: </strong>现在运行下面的命令“<strong class="jp ir">search shell _ to _ meter preter</strong>”。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi md"><img src="../Images/c591dc05af263cc6722632d06d902fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*quA0tcWHdjM0UbiUFH5Www.jpeg"/></div></div></figure><p id="29b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并使用屏幕上显示的模块。</p><p id="62c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤3: </strong>按照命令<br/>"<strong class="jp ir">Use post/multi/manage/shell _ to _ meter preter</strong>使用显示的模块，或者简单地键入<br/> " <strong class="jp ir"> use 0 </strong>"。这两个命令中的任何一个都可以。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi me"><img src="../Images/4ebae829996591b8f640a292da33a52e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U3KW2M6XdYfx4p-1kt2j6w.jpeg"/></div></div></figure><p id="c8b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤4: </strong>现在我们必须配置要升级的会话shell。我们可以通过运行以下命令来查看会话，即“<strong class="jp ir"> sessions -l </strong>”。Id =会话号</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mf"><img src="../Images/873a3b3dab74156c85a3e93160585a9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ah7BTOqoN34iNqRmaQrbag.jpeg"/></div></div></figure><p id="a8d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:</strong>我们可以看到选项，通过使用<strong class="jp ir">显示选项</strong>命令。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mg"><img src="../Images/7e959f8895a8084c3be681cb1a035617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zHeiF2n0ojs0R8XYG-4Vlg.jpeg"/></div></div></figure><p id="992f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤6: </strong>根据您的会话设置会话id。我们可以使用以下命令来配置会话，即“<strong class="jp ir">set SESSION&lt;id-of SESSION&gt;</strong>”，在我的例子中为“<strong class="jp ir"> set SESSION 1 </strong>”。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mh"><img src="../Images/0d4acd119f398dc6cb3bcc00ef39a231.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*82CvUvLLbXroTI95kfeAFQ.jpeg"/></div></div></figure><p id="484c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第7步:</strong>配置完会话后，就该执行它了。我们可以通过简单地给出以下命令来执行→ " <strong class="jp ir"> run </strong>"</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mi"><img src="../Images/f49c1bd022e3f965ba98a15b515d60f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NfGNkrx2t9xiSZaLSYSerQ.jpeg"/></div></div></figure><p id="6563" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入run命令后，将打开另一个新会话。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mj"><img src="../Images/dd7743ff07b534ac26999453bc8b3a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dZ3rNP4klkJgcVIw5nEvYA.jpeg"/></div></div></figure><p id="74b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新会话打开后，选择该会话并执行该会话。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mk"><img src="../Images/a3822c65a0fffa94136a8fdc5e260a07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ac6joYKTBWWkbNv5BpRuZA.jpeg"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk translated">新会话2</figcaption></figure><p id="902d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第8步:</strong>现在通过运行下面的命令"<strong class="jp ir">session-I&lt;New-meter Peter-session&gt;</strong>来执行新的会话，在我的例子中，它是"<strong class="jp ir"> session -i 2 </strong>"</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mk"><img src="../Images/57b43ca2391736ba13f12a6c5ac75282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G0_3PT993F0Bzfa-PgqpJw.jpeg"/></div></div></figure><p id="cf12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">运行最后一个命令后，您将得到meterpreter shell。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mp"><img src="../Images/0cfe5ddb9d31038ca74fca8ecfe2643c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABsxuViM-w9bnNuIu1W_vA.jpeg"/></div></div></figure></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="b8e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，您就可以将普通的命令shell升级到meterpreter shell。</p><p id="3b7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢我的文章，请在Twitter上关注我:- <a class="ae mq" href="https://twitter.com/BinamraPandey" rel="noopener ugc nofollow" target="_blank"> @Binamra Pandey </a></p><p id="f464" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">谢谢</strong></p></div></div>    
</body>
</html>