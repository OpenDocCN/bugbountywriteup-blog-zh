<html>
<head>
<title>CVE-2019–11380 | How I was able to access complete storage of ES-FileExplorer End user</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CVE-2019–11380 |我如何能够访问ES-FileExplorer终端用户的完整存储</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cve-2019-11380-how-i-was-able-to-access-complete-storage-of-es-fileexplorer-end-user-9bd8da5ac3b8?source=collection_archive---------0-----------------------#2019-09-05">https://infosecwriteups.com/cve-2019-11380-how-i-was-able-to-access-complete-storage-of-es-fileexplorer-end-user-9bd8da5ac3b8?source=collection_archive---------0-----------------------#2019-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/f3dde95da7c4ce3982d618c256ae5624.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*g4PNgeieKwcIo2lQ.png"/></div></figure><p id="9e49" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ES-file explorer是一个非常受欢迎的文件管理器，在play store上有超过30个lac下载。我发现了一个关键漏洞<strong class="jw ir"> <em class="ks">通过不安全的FTP活动执行</em> </strong>绕过认证，攻击者可以通过它访问受害者手机的完整文件系统。一个月后，ES-FileExplorer被playStore下架，并被指控涉嫌点击欺诈。</p><p id="77d4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">ES文件资源管理器为其最终用户提供各种功能，如浏览存储的文件、系统文件等。它的一个特点是使用FTP服务通过网络提供对文件系统的访问。</p><p id="bcb5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它还提供了一个功能，最终用户可以在该应用程序上设置一个主密码，这样其他移动用户或其他应用程序就不能使用它的功能。我发现activity .ftp.ESFtpShortcut负责通过电话启动ftp服务器。即使在设置了主密码之后，如果使用adb activity manager调用此活动，也可以启动FTP并通过网络访问完整的文件系统。在攻击场景中，任何恶意应用程序都可以为攻击者执行此活动。攻击者可以通过FTP url从远程位置访问本地存储中所有文件。</p><p id="69c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">重现步骤:</strong></p><p id="d1e0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为应用程序设置密码。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/d6ed556c296b7242cc37a5cc8b5a6c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*mc6kFSBI75A5DyQjiSvKcg.png"/></div></figure><p id="8f04" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">借助活动管理器命令启动activity . FTP . esftpshortcut:<em class="ks">am start-n com.estrongs.android.pop/.ftp.ESFtpShortcut</em><br/><strong class="jw ir">Output:</strong><br/><em class="ks">Starting:Intent { CMP = com . estrongs . Android . pop/. FTP . esftpshortcut }</em><br/><em class="ks">shell @ j7 elte:/$</em></p><p id="b71f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在移动通知面板上显示FTP URL。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/8ef8f1cca6dc01d6d6afcafa7cfe041e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*ePouMjN9T5RL4sfWQcSCaA.png"/></div></figure><p id="cffb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">攻击者只需将URL加载到任何浏览器，就可以访问本地存储所有内容，包括图像、相机、下载等。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi kz"><img src="../Images/75229dba084a2695ba30d6f72af065d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5vFRWC7pEH3cVz6BqG-N-w.png"/></div></div></figure><p id="7813" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我向应用程序开发团队报告了这个漏洞，问题在v4.2.0.1.4中得到修复。</p><p id="1c47" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">感谢阅读，狩猎愉快！</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="b7b4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="ks">关注</em> <a class="ae ll" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ks"> Infosec报道</em> </a> <em class="ks">获取更多此类精彩报道。</em></p><div class="lm ln gp gr lo lp"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="lq ab fo"><div class="lr ab ls cl cj lt"><h2 class="bd ir gy z fp lu fr fs lv fu fw ip bi translated">信息安全报道</h2><div class="lw l"><h3 class="bd b gy z fp lu fr fs lv fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="lx l"><p class="bd b dl z fp lu fr fs lv fu fw dk translated">medium.com</p></div></div><div class="ly l"><div class="lz l ma mb mc ly md js lp"/></div></div></a></div></div></div>    
</body>
</html>