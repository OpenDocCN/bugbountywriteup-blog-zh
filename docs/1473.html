<html>
<head>
<title>VulnHub — VulnCMS:1 Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VulnHub — VulnCMS:1个演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/vulnhub-vulncms-1-walkthrough-d4f8a071e61?source=collection_archive---------0-----------------------#2021-07-17">https://infosecwriteups.com/vulnhub-vulncms-1-walkthrough-d4f8a071e61?source=collection_archive---------0-----------------------#2021-07-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d0049742490121197fc9a1405a72bad1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efTHQA6G212Bsh1hMkXk5A.png"/></div></div></figure><p id="8948" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">VulnCMS:1 是一个简单的关卡，机器人先生主题的boot2root CTF挑战赛，你必须枚举盒子，找到CMS版本，并利用它来获得访问权限。</p><p id="e7ab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">先从找到受害者的IP开始。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/53f998aaf0b21af5c04646257646f0b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mg7Sa6X_dsbK9-Vp5tDt_A.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">寻找IP</figcaption></figure><p id="91aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，让我们执行传统的Nmap扫描。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/833f5de7a540c49f2275b7ccaa2eb333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ldfdvn08y7YKCfDGlPeX-g.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">Nmap扫描</figcaption></figure><p id="711d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们会遇到5个开放的港口，</p><ul class=""><li id="95eb" class="lh li iq ka b kb kc kf kg kj lj kn lk kr ll kv lm ln lo lp bi translated">端口22 — SSH</li><li id="83bf" class="lh li iq ka b kb lq kf lr kj ls kn lt kr lu kv lm ln lo lp bi translated">其他4个端口由web应用程序组成</li></ul><p id="44c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们用<strong class="ka ir">-一个</strong>标志进行一次积极的扫描。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/66f7cb9b71203c771421023aad332806.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N0mJSTNLnbSa9vGr1yD1fw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">nmap -A <ip/></figcaption></figure><p id="381f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">中的web应用程序，</p><ul class=""><li id="b09e" class="lh li iq ka b kb kc kf kg kj lj kn lk kr ll kv lm ln lo lp bi translated">端口5000是用WordPress构建的</li><li id="5a08" class="lh li iq ka b kb lq kf lr kj ls kn lt kr lu kv lm ln lo lp bi translated">端口8081是用Joomla构建的</li><li id="6e6a" class="lh li iq ka b kb lq kf lr kj ls kn lt kr lu kv lm ln lo lp bi translated">端口9001是用Drupal构建的</li></ul><p id="201f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我一看到Drupal is 7的版本，就想起了HackTheBox的末日机器，在那里我不得不利用Drupalgeddon2 RCE漏洞。</p><p id="75b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们用<a class="ae kw" href="https://github.com/immunIT/drupwn" rel="noopener ugc nofollow" target="_blank"> drupwn </a>来了解一下Drupal的确切版本。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/8a8183f3a1606c96cf394a9e8e18cedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*esvyXduSc_N6S2i3EC6sOg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">枚举Drupal版本</figcaption></figure><p id="28d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">版本为<strong class="ka ir"> 7.54 </strong>，意味着易受<a class="ae kw" href="https://www.exploit-db.com/exploits/44449" rel="noopener ugc nofollow" target="_blank"> Drupalgeddon2 </a>漏洞攻击。</p><p id="61ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以从<a class="ae kw" href="https://www.rapid7.com/blog/post/2018/04/27/drupalgeddon-vulnerability-what-is-it-are-you-impacted/" rel="noopener ugc nofollow" target="_blank">这里</a>阅读更多关于这个漏洞的信息。</p><p id="0efd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用一个<strong class="ka ir"> metasploit模块</strong>来利用这个漏洞。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/803ae6d1e52925c59e23837befeb0b9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rMvH_L7612dh-M1jUmQyEw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">搜索drupalgeddon</figcaption></figure><p id="f35d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只需提供受害者的IP，端口和vhost，并运行利用。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/dd248d1165f92dbfb6a1bcbb9646f17f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j8XXbERSmkoMtegO_QH5tQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">利用</figcaption></figure><p id="1a5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们得到了系统的立足点。我们需要为用户而努力。</p><p id="82ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们查看主目录时，我们可以看到系统的3个用户，分别是<strong class="ka ir"> elliot、ghost </strong>和<strong class="ka ir"> tyrell </strong>。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/f12dfc90107fd86c3e96c0db15f6012d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*m1yOs7b3rPAiQQQj7sPFow.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">3个用户</figcaption></figure><p id="bdd1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到用户标志位于elliot的主目录中。但是，我们没有足够的权限打开它。</p><p id="1b40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> /var/www/html/drupal中有一个<strong class="ka ir"> misc </strong>目录可疑。</strong></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/ac58dfd3971206add633614d29be1421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZn_YtdH_6MdO8jEIVhRfA.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">/var/www/html/drupal/misc</figcaption></figure><p id="c7fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">misc目录下有一个名为<strong class="ka ir"> tyrell.pass </strong>的文件，任何人都可以阅读。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/1152b27666517a97546bad4311c50fea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7RWfqQmYDsOFBDCtisbYMg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">泰里尔，传球</figcaption></figure><p id="034f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以清楚地了解到它们是用户Tyrell的凭据。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/b7e3a17c84050ad7bda958ba38b0e385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*VcYQ6kXeCBYP3pMEL4se4w.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">用户Tyrell的凭据</figcaption></figure><p id="f5dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，让我们继续宋承宪成为受害者作为泰里尔。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/b5b70918a81df60fe187955a2b1f90c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XjbJ9e8ZHmfqyRJ2l4ookg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">宋承宪饰演泰里尔</figcaption></figure><p id="b5be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们拥有用户！！！</p><p id="7c1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们来看看这个用户作为root可以执行哪些命令。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/6972a3f9c5b30d6976e94aef884fc818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UAUEI6wZLEvPJMioORcEnQ.png"/></div></div></figure><p id="3aa8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该用户可以根用户身份执行二进制文件。我们可以通过这个来自GTFOBINS的二进制文件找到一种方法来提升我们的特权。</p><p id="32bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只需要用sudo特权运行二进制文件并添加<strong class="ka ir">！/bin/bash </strong>如下。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/fb625e574e0df8df1126b33afaeed34f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9hzTvVUNdmk46QXYKgYFdw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">追加！/bin/bash</figcaption></figure><p id="bd93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">瞧啊。！！我们拥有root！！！</p><p id="f4c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们从elliot的主目录中获取<strong class="ka ir">用户标志</strong>。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/6642c5b1cbba5796782b03402be661cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*qWhdo2jlCQI46eDApd7apA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">用户标志</figcaption></figure><p id="9e18" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我们可以从root的主目录中抓取<strong class="ka ir">根标志</strong>。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/bc5f0c3229753066dddc9c64c61a1d33.png" data-original-src="https://miro.medium.com/v2/resize:fit:898/format:webp/1*FzeWxlTg8GxVmzqsY9Rc9Q.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">根标志</figcaption></figure><p id="a4dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你在享受挑战的同时也学到了一些东西。通过<a class="ae kw" href="https://www.linkedin.com/in/ravishanka-silva-a632351a0/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>联系我。</p><p id="89c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">祝你在前方捕捉旗帜时好运！！！</p></div></div>    
</body>
</html>