<html>
<head>
<title>HTB- Shocker ( Take It Easy Series)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HTB-修卡(轻松系列)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/htb-shocker-take-it-easy-series-bc28254259b2?source=collection_archive---------2-----------------------#2021-07-05">https://infosecwriteups.com/htb-shocker-take-it-easy-series-bc28254259b2?source=collection_archive---------2-----------------------#2021-07-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ba0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在7月份，Hack the Box ( HTB)提出了一个概念，让所有用户都可以使用10台退役的机器进行pwn并培养他们的技能。请查看HTB的公告。</p><p id="8377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为这个系列的一部分，我已经开始尝试一个退役的盒子，即修卡。这些机器在退役机器中是免费的</p><p id="4236" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们访问机器并获得root访问权限。</p><p id="581c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基本上，这是一台Linux机器。我们将运行Nmap扫描来识别开放的端口和服务。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/638c8bffe52c04e256ce954b11cfa78e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6w3FvrZpij-Q-t7bTwwwYw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">Nmap扫描</figcaption></figure><p id="6641" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出显示这是一台在2222上运行SSH的Ubuntu机器，在端口80上运行HTTP Apache服务器。所以没有任何延迟，打开浏览器，进入网页。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/c0dcc2e878e9cdf5280c64e287e2a441.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*x426bIo9hUnv6_iJi1hMnQ.png"/></div></figure><p id="f6fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网页中没有内容。让我们来看看页面源代码。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/410386d25e89e989bbdf28bba3a746f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*mUERtkhqhOmkSFeNfmaT0A.png"/></div></figure><p id="3547" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">源页面上也没有。</p><p id="f55a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，使用go buster来识别敏感方法的隐藏目录。我们主要关注显示状态代码200、403的目录。</p><p id="9cc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到定期索引，服务器状态目录。等等，除此之外，我们还有一个名为CGI-bin的目录。</p><p id="bf52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我试图谷歌了解它，我得到了以下信息，这是一种类型的文件夹主机脚本。因为它给出了一个403状态代码，所以让我们在那个目录中进行目录枚举，看看是否有我们可以使用的脚本。</p><pre class="km kn ko kp gt ld le lf lg aw lh bi"><span id="cc70" class="li lj iq le b gy lk ll l lm ln">A CGI-bin is a folder used to house scripts that will interact with a Web browser to provide functionality for a Web page or website. Common Gateway Interface (CGI) is a resource for accommodating the use of scripts in Web design. As scripts are sent from a server to a Web browser, the CGI-bin is often referenced in a url.</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lo"><img src="../Images/e3198ea14d9f990ddbfc36bd13f03ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HEZyDgpabKy-FH8tDARt2g.png"/></div></div></figure><p id="3347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有发现了。CGI-bin目录中有一个名为“user”的shell脚本文件。令人惊讶的是，它没有在浏览器中执行，而是给出了下载的提示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/41d76f46815505c2701b8889021c139c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*r2PDAR_uWhGeHTJuL1fqgQ.png"/></div></figure><p id="0e08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我运行脚本时，它只显示服务器的正常运行时间。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/7ea9de717b267db72399ccadd81d612d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*rRHclnHZw3SwPwkCNjEQLA.png"/></div></figure><p id="611d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是时候利用机器了。根据机器名称和它的CGI-bin，我们可以关联到它可能容易受到2014年检测到的Shellshock漏洞(CVE-2014–6271)的攻击。</p><p id="69b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种方法可以利用它。<br/> 1。Metasploit <br/> 2。公开攻击(命令注入)</p><h1 id="1947" class="lr lj iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用Metasploit的根访问</h1><p id="eb63" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">安全研究人员对Metasploit并不陌生。有很多漏洞可以完成这个任务。让我们运行msfconsole并开始探索。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mt"><img src="../Images/033d4136bdb59cdd57b67d42f65ddbe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3IPWgIzGTnCaafx7iYjdkQ.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mu"><img src="../Images/438b0e177174763b72b6a933635f13e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vi5z9ciiJSxeFELbcTUiKA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">更新了详细信息的MSF漏洞利用(RHOST，RPORT TARGETURI)</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mv"><img src="../Images/483cefbaf9c5c293b63ea03d0126da43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pY50fXiCdAwnfTNteD5fzQ.png"/></div></div></figure><p id="7e5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们拿到了抄表员的权限。现在搜索标志并获得根shell。让我们看看这台机器上有哪些用户。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/657e05959da543fc0c8e19941c32d39d.png" data-original-src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*9LrlP6J8Je06t5nSm_vqsQ.png"/></div></figure><p id="334b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这台机器里有一个叫雪莉的用户，他给了我们第一面旗帜。<br/>使用Perl，我可以访问bash shell，现在我是root用户了。使用root <br/>我可以访问第二面旗帜。</p><h1 id="8151" class="lr lj iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用公共漏洞的超级用户访问</h1><p id="b043" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">我们有多种利用工作POC的方法来利用此漏洞。下面是其中的一个，我将在这里使用。</p><div class="mx my gp gr mz na"><a href="https://www.exploit-db.com/exploits/34900" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">攻击性安全利用数据库档案</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">Apache mod_cgi - 'Shellshock '远程命令注入。CVE-2014-6278Linux平台的远程利用</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">www.exploit-db.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no kv na"/></div></div></a></div><p id="d0e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个利用和创建反向外壳的python脚本。这需要像RHOST、RPORT、URL、LHOST、LPORT这样的输入。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi np"><img src="../Images/89567b98d021d6f3c9a20e82ad08fc5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aKEByQM65iENtcRfC_h1gA.png"/></div></div></figure><p id="6304" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我输入数据，我们就能进入外壳。为了获得根shell访问权限，我们使用Perl shell命令。一旦你是根，导航到该文件夹并抓住标志。</p></div><div class="ab cl nq nr hu ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ij ik il im in"><p id="5dd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您阅读这篇文章。这是Hack the Box的轻松系列的一部分。我将继续制作剩余的盒子，并分享我的心得。</p><p id="d56d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这个盒子中，我能够理解在apache中配置时与CGI-BIN相关的漏洞。</p></div></div>    
</body>
</html>