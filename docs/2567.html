<html>
<head>
<title>Automate GitHub Actions Security Best Practices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">自动化GitHub操作安全最佳实践</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/automate-github-actions-security-best-practices-f5f178001291?source=collection_archive---------2-----------------------#2022-11-28">https://infosecwriteups.com/automate-github-actions-security-best-practices-f5f178001291?source=collection_archive---------2-----------------------#2022-11-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9714" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在保护您的GitHub操作工作流程方面节省时间和精力</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/940555f746a6371c06739601ee66153e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uVYKpsR857WcvqYT"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Pawel Czerwinski 在<a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="11ef" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">什么是GitHub动作？</strong></h1><p id="7086" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">GitHub Actions是一个持续集成和持续交付(CI/CD)平台。通过GitHub Actions，开发人员可以定义一组在他们将代码推送到GitHub时运行的任务。GitHub Actions对公共存储库中GitHub托管的跑步者是免费的。GitHub Actions也很灵活，允许开发人员定制他们的工作流来满足他们的需求。因此，GitHub Actions已经成为开发人员提高生产力的流行工具。</p><h1 id="50bd" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">为什么保护您的GitHub动作工作流程至关重要？</strong></h1><p id="01d3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">用于连续部署的GitHub操作工作流具有特权凭据。此外，在每个工作流运行开始时，GitHub会为您的工作流运行创建一个唯一的GITHUB_TOKEN。如果这些凭证遭到破坏，攻击者就可以篡改存储库内容、版本和包。这可能导致软件供应链攻击和生产系统受损。</p><h1 id="69b8" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">GitHub Actions安全最佳实践有哪些？</strong></h1><p id="d1dd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir"> 1。</strong> <strong class="lq ir">设置最小GITHUB_TOKEN权限</strong></p><p id="ba8d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">GITHUB_TOKEN可供每个作业向GitHub API进行身份验证。为了在这个令牌受损的情况下减少损失，请根据作业的需要为GITHUB_TOKEN设置最低权限。</p><p id="c4e4" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 2。将动作固定到全长提交SHA </strong></p><p id="af45" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">GitHub动作标签是可变的，这带来了安全风险。如果标签改变了，在它被使用之前，你将没有机会检查它。为了降低这种风险，请考虑将操作固定到完整长度的提交SHA。</p><p id="d9a3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3。</strong> <strong class="lq ir">保持GitHub动作最新</strong></p><p id="ed98" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">像其他依赖项一样，GitHub动作接收安全更新。配置一个依赖项更新工具，比如Dependabot，将GitHub动作更新到最新版本。</p><p id="ea54" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 4。</strong> <strong class="lq ir">哈登GitHub动作跑者</strong></p><p id="9c8f" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在管道运行期间，会下载几个依赖项和构建工具。如果这些依赖关系中有一个是恶意的，它可以从运行者那里泄漏凭证或者篡改发布版本。为了减轻这种风险，使用<a class="ae kv" href="https://github.com/step-security/harden-runner" rel="noopener ugc nofollow" target="_blank"> Harden-Runner GitHub动作</a>。Harden-Runner GitHub操作允许设置策略，将出站网络呼叫限制在允许的列表中。它还可以检测编译过程中对源代码的篡改。</p><p id="8057" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 5。</strong> <strong class="lq ir">使用OpenID Connect (OIDC)访问云资源</strong></p><p id="ebff" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">一些云提供商，如AWS、GCP和Azure，支持OpenID Connect (OIDC)。要部署到支持OIDC的云提供商，您可以将工作流配置为直接向云提供商进行身份验证。OIDC消除了将长期云凭证存储为GitHub机密的需要。</p><h1 id="8381" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">如何自动化GitHub Actions安全最佳实践？</strong></h1><p id="c8a9" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">虽然您可以手动应用这些最佳实践，但这可能会很麻烦、耗时且容易出错。</p><p id="c264" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/step-security/secure-workflows" rel="noopener ugc nofollow" target="_blank">安全工作流程</a>开源项目自动化了应用这些最佳实践的步骤。它将一个工作流(YAML文件)作为输入，并将其转换为使用GitHub Actions安全最佳实践。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/147e19d6f565ed2ee4a8bc91e6043f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SM97SecHm7iYvnWB1ysauQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">GitHub上的安全工作流开源项目</figcaption></figure><p id="7a96" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">您可以在<a class="ae kv" href="https://app.stepsecurity.io/securerepo" rel="noopener ugc nofollow" target="_blank">https://app.stepsecurity.io/securerepo.</a>为公共存储库使用托管实例。这样，您可以创建一个pull请求，将最佳实践应用于您的公共GitHub存储库中的所有工作流。不需要安装任何GitHub App就可以使用。</p><ol class=""><li id="886d" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj mv mw mx my bi translated">您指定一个公共的GitHub存储库URL并点击<code class="fe mz na nb nc b">Analyze</code>。</li><li id="78d6" class="mq mr iq lq b lr nd lu ne lx nf mb ng mf nh mj mv mw mx my bi translated">SecureWorkflows会获取存储库的所有工作流文件，对其进行分析，并显示修正列表。</li><li id="5215" class="mq mr iq lq b lr nd lu ne lx nf mb ng mf nh mj mv mw mx my bi translated">选择所需的补救措施，然后单击<code class="fe mz na nb nc b">Create a pull request</code>。根据安全最佳实践创建一个拉取请求。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/016d3f4e1d93d941b46a3860284b41a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6ZZTbUht2z1R6DfImY34Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">app.stepsecurity.io/securepo截图</figcaption></figure><h1 id="adc2" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">来自流行项目的拉请求示例</h1><p id="e0f8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">以下是三个来自流行的开源项目的例子，它们使用SecureWorkflows应用了GitHub Actions安全最佳实践:</p><ol class=""><li id="ef62" class="mq mr iq lq b lr mk lu ml lx ms mb mt mf mu mj mv mw mx my bi translated"><strong class="lq ir"> Electron </strong> : Electron用于构建带有JavaScript、HTML和CSS的桌面应用</li></ol><p id="b30c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/electron/electron/pull/36343" rel="noopener ugc nofollow" target="_blank">https://github.com/electron/electron/pull/36343</a></p><p id="3574" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个使用SecureWorkflows创建的pull请求中，工作流文件将GitHub Actions标记自动固定到它们的全长提交SHA。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nj"><img src="../Images/4aea2c102bf3f72e8e179c652e3cc140.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WctlI8LnBStk49ZDgCFtLA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">GitHub动作标签是自动固定的</figcaption></figure><p id="6c97" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 2。Kubernetes-Ingress</strong>:Kubernetes的NGINX入口控制器</p><p id="0bcf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">https://github.com/nginxinc/kubernetes-ingress/pull/3134<a class="ae kv" href="https://github.com/nginxinc/kubernetes-ingress/pull/3134" rel="noopener ugc nofollow" target="_blank"/></p><p id="81c2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">在这个pull请求中，自动为GITHUB_TOKEN设置最小权限</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/f42a980db958116ecc6b33ee199cd4e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7SrttYj7uPwPtsnx1im0WA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">GITHUB_TOKEN的最小权限是自动设置的</figcaption></figure><p id="e1d6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"> 3。Attrs </strong> : Attrs支持编写Python类</p><p id="6dd9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/python-attrs/attrs/pull/1034" rel="noopener ugc nofollow" target="_blank">https://github.com/python-attrs/attrs/pull/1034</a></p><p id="7a03" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这个pull请求将Harden Runner GitHub操作添加到工作流文件中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/c8072aa7faa27f9fec461f0b6b1a3650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GyrXOUO6f_SfxkmYNcSAA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">工作流程中添加了强化Runner GitHub操作</figcaption></figure><h1 id="1b35" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated"><strong class="ak">总结</strong></h1><p id="845a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">成千上万的开源项目使用GitHub动作。保护GitHub Actions工作流以防止软件供应链攻击至关重要。遵循GitHub操作工作流的安全最佳实践可能会非常麻烦和耗时。许多开源项目通过使用<a class="ae kv" href="https://github.com/step-security/secure-workflows" rel="noopener ugc nofollow" target="_blank">安全工作流</a>节省了时间和精力。要将GitHub Actions安全最佳实践应用到您的公共存储库中，请使用位于<a class="ae kv" href="https://app.stepsecurity.io/securerepo" rel="noopener ugc nofollow" target="_blank">https://app.stepsecurity.io/securerepo</a>的托管实例。</p><pre class="kg kh ki kj gt nm nc nn bn no np bi"><span id="ea50" class="nq kx iq nc b be nr ns l nt nu"><strong class="nc ir">Want to secure GitHub Actions workflows in your public repository quickly?<br/></strong><br/>Use SecureWorkflows at <a class="ae kv" href="https://app.stepsecurity.io/securerepo" rel="noopener ugc nofollow" target="_blank">https://app.stepsecurity.io/securerepo</a> </span></pre><h1 id="d2ea" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">资源</h1><p id="6477" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">[1]了解GitHub操作</p><p id="07f5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions" rel="noopener ugc nofollow" target="_blank">https://docs . github . com/en/actions/learn-github-actions/understanding-github-actions</a></p><p id="243c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[2]使用限制、计费和管理</p><p id="61f2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://docs.github.com/en/actions/learn-github-actions/usage-limits-billing-and-administration" rel="noopener ugc nofollow" target="_blank">https://docs . github . com/en/actions/learn-github-actions/usage-limits-billing-and-administration</a></p><p id="3422" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[3]自动令牌认证</p><div class="nv nw gp gr nx ny"><a href="https://docs.github.com/en/actions/security-guides/automatic-token-authentication" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">自动令牌认证- GitHub文档</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">在每次工作流运行开始时，GitHub会自动创建一个唯一的GITHUB_TOKEN secret，用于您的工作流…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">docs.github.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kp ny"/></div></div></a></div><p id="dcb9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[4]GitHub动作的安全强化</p><div class="nv nw gp gr nx ny"><a href="https://docs.github.com/en/actions/security-guides/security-hardening-for-github-actions" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">GitHub操作的安全强化- GitHub文档</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">本指南解释了如何为某些GitHub动作特性配置安全强化。如果GitHub采取行动…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">docs.github.com</p></div></div><div class="oh l"><div class="on l oj ok ol oh om kp ny"/></div></div></a></div><p id="cf66" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[5] Harden Runner GitHub动作</p><p id="9679" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/step-security/harden-runner" rel="noopener ugc nofollow" target="_blank">https://github.com/step-security/harden-runner</a></p><p id="3227" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[6] StepSecurity安全工作流项目</p><p id="f441" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://github.com/step-security/secure-workflows" rel="noopener ugc nofollow" target="_blank">https://github.com/step-security/secure-workflows</a></p><p id="2956" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">[7]公共存储库的安全工作流项目的托管实例</p><p id="a4d9" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><a class="ae kv" href="https://app.stepsecurity.io/securerepo" rel="noopener ugc nofollow" target="_blank">https://app.stepsecurity.io/securerepo</a></p></div><div class="ab cl oo op hu oq" role="separator"><span class="or bw bk os ot ou"/><span class="or bw bk os ot ou"/><span class="or bw bk os ot"/></div><div class="ij ik il im in"><h2 id="71a7" class="ov kx iq bd ky ow ox dn lc oy oz dp lg lx pa pb li mb pc pd lk mf pe pf lm pg bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kv" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>