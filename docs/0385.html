<html>
<head>
<title>Stories Of IDOR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伊多的故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/stories-of-idor-4966369e6d82?source=collection_archive---------0-----------------------#2019-09-28">https://infosecwriteups.com/stories-of-idor-4966369e6d82?source=collection_archive---------0-----------------------#2019-09-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ffc0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好</p><p id="1330" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">欢迎回来，</p><p id="00f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将是一个系列，我将分享我的发现。</p><blockquote class="kl km kn"><p id="9b3d" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">什么是IDOR: </strong></p></blockquote><p id="fbf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当应用程序基于用户提供的输入提供对对象 的<em class="ko"> </em> <strong class="jp ir"> <em class="ko">直接访问时，就会出现不安全的直接对象引用。由于该漏洞，攻击者可以<strong class="jp ir"> <em class="ko">绕过授权，直接访问系统中的资源。</em>T11】</strong></em></strong></p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/aa5f78a15ae3a39c84702453b515e0f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nGuqZbJRuKKIr06TGxSHeg.png"/></div></div></figure><p id="810a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单地说，假设有两个用户帐户，U1和U2，</p><p id="961a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">两人的账户中都有文件，但只有账户用户可以访问，这意味着U1只能访问他的账户文件，而不是U2的文件。</p><p id="7cda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一天，blahBlah.pdf·U1试图在浏览器中查看他的文件，文件的网址是这样的:</p><p id="aefa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae le" href="https://whocare.com/file/23" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://whocare.com/file/23</em></a></p><p id="dc31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在好奇的U1试着改变最后一个数字，试着看看会发生什么，像</p><p id="e3be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae le" href="https://whocare.com/file/23" rel="noopener ugc nofollow" target="_blank"><em class="ko">https://whocare.com/file/</em></a>T20】50</p><p id="4b45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在他可以从他的帐户查看U2文件。</p><p id="a15c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在的问题是为什么:</p><p id="3fed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为应用程序基于用户输入 提供对对象的<strong class="jp ir"> <em class="ko">直接访问，而无需<strong class="jp ir"> <em class="ko">验证对象</em> </strong>的真实性。</em></strong></p><blockquote class="kl km kn"><p id="3b3b" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">怎么找</strong></p></blockquote><p id="eec6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">IDOR出现在像XSS这样的应用程序中，很容易找到它，但是在你理解了你测试的应用程序的目的/工作流程之后，它会变得更容易。</p><p id="a2ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将分享我的一些发现，这将明确你的概念，如何以及在哪里找到这些问题。</p><blockquote class="kl km kn"><p id="1676" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">第1部分:<strong class="jp ir"> <em class="iq"> IDOR可以查看其他用户的账户详情</em> </strong></p></blockquote><p id="4da3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我注册用户帐户时开始的，请求被Burp代理拦截，看起来像这样:</p><p id="d45d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">whocare.com域进行内部API调用，用于注册。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="lf lg l"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated">请求</figcaption></figure><p id="392d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您看到请求中有参数<strong class="jp ir"> <em class="ko"> user_id </em> </strong>，出于测试目的将其更改为随机值，我得到的响应是一个错误，如:<strong class="jp ir"> <em class="ko">用户已经存在，</em> </strong>连同它一起披露了用户信息，如:<strong class="jp ir">姓名、电子邮件、地址</strong>等。</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="lf lg l"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk translated">反应</figcaption></figure><p id="1688" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，我编辑了一些个人信息，因为我得到了管理员帐户的详细信息，实际上这不是一蹴而就的，为此我开始使用Burp Suite入侵者暴力破解<strong class="jp ir"> <em class="ko"> user_id </em> </strong>参数，我得到了许多用户的详细信息，其中我也找到了管理员帐户的详细信息。</p><blockquote class="kl km kn"><p id="255d" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">第2部分:IDOR:可以从订阅列表中取消订阅任何用户的电子邮件吗</strong></p></blockquote><p id="9f8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在同一个网站whocare.com[dummy name]，有一个选择订阅时事通讯，电子邮件通知的最新更新。</p><p id="480f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在用户帐户设置中有一个取消订阅时事通讯的选项，当你提交请求时，他们会向注册用户发送一封电子邮件，网址如下:</p><p id="7f34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae le" href="http://alaraby.tv/deleteNewsletter/dmljdGltZW1haWxAZ21haWwuY29t" rel="noopener ugc nofollow" target="_blank">http://who care . com/delete newsletter/dmljdgltzw 1 hawxaz 21 hawwwuy 29t</a></p><p id="74c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你看到，这是base64编码，</p><p id="547f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">T3】dgvzdgvybwfpbebnwfpbc5 JB 20 =:testermail@gmail.comT5】</strong></p><p id="554a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们需要用户的电子邮件，以便取消订阅时事通讯的用户，因为他们没有验证这个请求。</p><p id="5a9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在从第一个问题，我们能够获得用户信息，如电子邮件，现在你知道，如果你想取消网站上所有用户的订阅，你只需要用户的电子邮件地址，你有。对于攻击，拦截这个url请求，将其发送给入侵者，添加所有用户的电子邮件，并在提交之前进行base64编码，开始攻击。时期</p><p id="9d6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我试图把这两个小的IDOR链接成一个有影响力的报告。</p><blockquote class="kl km kn"><p id="41d7" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">第3部分:发现开放邮件中继:可以从真实的Whocare.com邮件服务器向受害者发送欺骗邮件</strong></p></blockquote><p id="4427" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是同一个域中存在的另一个漏洞，在<strong class="jp ir"> <em class="ko">反馈部分</em> </strong></p><p id="fcec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从中您可以向团队提交反馈。</p><p id="9f39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对该外观的请求如下:</p><figure class="kt ku kv kw gt kx"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="77c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，如果您在请求部分看到我们将用于攻击目的的2个参数:</p><p id="b328" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ko">contact us _ Department _ Txt =</em></strong>邮件要发送到的帐户</p><p id="a537" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ko">contact us _ Email _ Txt =</em></strong>账户从哪里发邮件</p><p id="ba23" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ko">contact us _ Message body _ Txt</em></strong>=您喜欢发送的消息</p><p id="bfa6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我可以像这样创建新的请求并更改参数:</p><p id="c26f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ko">ContactUs_Department_Txt=admin@whocare.com</em></strong></p><p id="732c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ko">【contact us _ Email _ Txt =【使用所有用户列表进行攻击】</em> </strong></p><p id="83a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，所有用户都将从管理员帐户获得电子邮件，这看起来是合法的，这是对网络钓鱼的完美攻击。</p><p id="da11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我还有其他关于伊多的故事，希望我将来能写出来。</p><h2 id="b1db" class="ll lm iq bd ln lo lp dn lq lr ls dp lt jy lu lv lw kc lx ly lz kg ma mb mc md bi translated"><strong class="ak">补救</strong>:</h2><p id="f7dd" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">需要实现适当的访问控制，这意味着这些请求应该在继续之前得到验证，另一件事是</p><p id="bdaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用强随机加密代替数字加密。比如id=3，而不是3，使用一些随机加密。</p><p id="e3b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">欲了解更多信息，请访问</p><p id="ec61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae le" href="https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html" rel="noopener ugc nofollow" target="_blank">https://cheatsheetseries . owasp . org/Cheat sheets/unsecure _ Direct _ Object _ Reference _ Prevention _ Cheat _ sheet . html</a></p><blockquote class="kl km kn"><p id="0bd9" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">时间线:</strong></p></blockquote><ol class=""><li id="b891" class="mj mk iq jp b jq jr ju jv jy ml kc mm kg mn kk mo mp mq mr bi translated">报告发送</li><li id="a40e" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">打补丁</li><li id="56c1" class="mj mk iq jp b jq ms ju mt jy mu kc mv kg mw kk mo mp mq mr bi translated">奖励[谁在乎🤷‍♀️除了我]</li></ol><p id="ac60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是现在，我们将很快与我们的下一个博客见面。直到那时再见。</p><p id="01d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这个帖子，请随意转发。</p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="b8bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">关注</em> <a class="ae le" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ko"> Infosec报道</em> </a> <em class="ko">获取更多此类精彩报道。</em></p><div class="ne nf gp gr ng nh"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ni ab fo"><div class="nj ab nk cl cj nl"><h2 class="bd ir gy z fp nm fr fs nn fu fw ip bi translated">信息安全报道</h2><div class="no l"><h3 class="bd b gy z fp nm fr fs nn fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="np l"><p class="bd b dl z fp nm fr fs nn fu fw dk translated">medium.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv lc nh"/></div></div></a></div></div></div>    
</body>
</html>