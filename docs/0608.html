<html>
<head>
<title>How to Exploit rConfig Network DCM for Chained Vulnerability</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何针对链式漏洞利用rConfig网络DCM</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/rconfig-3-9-x-exploit-bot2root-c504429d9b0f?source=collection_archive---------2-----------------------#2020-05-27">https://infosecwriteups.com/rconfig-3-9-x-exploit-bot2root-c504429d9b0f?source=collection_archive---------2-----------------------#2020-05-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fa6f97c2787cc98b451385fe3d472565.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2o_Mr5wpf6s0KL9MsCBgbA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">rConfig</figcaption></figure><p id="833a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">rConfig是一个开源的网络设备配置管理工具，用PHP编写。通过向PHP添加一些额外的模块，可以根据需要定制特性。这被网络管理员广泛用于频繁地拍摄他们的网络设备的配置快照。也就是说，它有许多独特的功能，如可定制的设备命令、连接模板、计划任务、数据库密码加密、监控设备配置以符合策略等。</p><p id="0e1d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在过去的几年中，安全研究人员在rconfig中发现了许多严重级别的漏洞。以下是一些简历:CVE-2019-16662，CVE-2019-16663，CVE-2019-19509，CVE-2019-19585，CVE-2020-10220。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi la"><img src="../Images/151f9e7cc51c0f7637d4876c4badb123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/0*ftvI42L-dMKPJtDT.png"/></div></figure><p id="9f91" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本帖中，我将演示如何将CVE-2020–10220、CVE-2019–19509、CVE-2019–19585串联起来，并利用应用程序获得初始访问权限，直到权限提升(root)。所以，事不宜迟，让我们开始吧。</p><p id="2747" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">每当我们试图利用任何漏洞时，第一步就是侦察。我们需要确保我们试图利用的应用程序版本是易受攻击的版本。对于rConfig，该版本在登录页面上很容易看到。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/f4d2fd72a1a55f7c0d85b83308240e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*5SeNuFyujlWFr84H.png"/></div></figure><p id="810e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">web界面易于通过commands.inic.php search column参数进行SQL注入。攻击者可以利用SQL注入漏洞从数据库中提取凭据，或者在web应用程序中插入假凭据。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/b6493e11847a72ddc7e5a2004d8d283e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/0*JQkvA7E2sHcwdAp_.png"/></div></figure><p id="1e4a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">密码是md5哈希摘要，可以使用在线平台或hashcat/john等工具解密。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/c0f489bdce3d5106a46b77b9ced442ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*bdoAcmQlL512GAjx.png"/></div></figure><p id="c676" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">经过身份验证的远程用户可以通过向ajaxArchiveFiles.php发送GET请求来直接执行系统命令，因为path参数未经过滤即被传递给exec函数，从而导致命令执行。检索凭据后，现在攻击者可以登录web应用程序以获得初始访问权限。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi la"><img src="../Images/5f5e2ccff10105b86e91e1798e1e68f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/0*sRFyTakscdIixRyc.png"/></div></figure><p id="5bd4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">安装脚本为rconfig特定任务更新/etc/sudoers文件。在“rConfig特定的apache配置”更新之后，Apache对一些二进制文件具有高特权。攻击者可以使用宽松设置的sudo权限来获得root权限。</p><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/479061adc31ddd220f594c462ffc0851.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/0*mQdGdMhFRNq6KEcg.png"/></div></figure><figure class="lb lc ld le gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/b1d9fb07d4877f27c652a6fc6fdeeb8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/0*WPE8r2GPdTNP8W-T.png"/></div></figure><p id="94fa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果一个人可以将多个漏洞串联起来，结果总是具有破坏性。作为一项安全建议，使用应用程序的最新版本并用安全更新修补应用程序始终是一项最佳实践。</p><div class="li lj gp gr lk ll"><a href="https://www.youtube.com/@Exploit-Writeup/" rel="noopener  ugc nofollow" target="_blank"><div class="lm ab fo"><div class="ln ab lo cl cj lp"><h2 class="bd ir gy z fp lq fr fs lr fu fw ip bi translated">漏洞利用报告</h2><div class="ls l"><h3 class="bd b gy z fp lq fr fs lr fu fw dk translated">CTF玩家、安全专家、Bug赏金猎人、白帽黑客和渗透测试者的博客你好，我是…</h3></div><div class="lt l"><p class="bd b dl z fp lq fr fs lr fu fw dk translated">www.youtube.com</p></div></div><div class="lu l"><div class="lv l lw lx ly lu lz jw ll"/></div></div></a></div><blockquote class="ma mb mc"><p id="d3ff" class="kc kd md ke b kf kg kh ki kj kk kl km me ko kp kq mf ks kt ku mg kw kx ky kz ij bi translated"><strong class="ke ir">无聊却重要的东西:-) </strong></p></blockquote><p id="1043" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我既没有发现这个漏洞，也没有为CVE居功。本文表达的所有观点、信息或内容都是我自己的，不代表我曾经、现在或将来隶属的任何实体。这里描述的方法和列出的工具现在可能被证明是危险的，甚至是非法的。你对这里的信息采取的任何行动或活动都完全是你自己的风险，我不会对任何形式的滥用负责。</p></div></div>    
</body>
</html>