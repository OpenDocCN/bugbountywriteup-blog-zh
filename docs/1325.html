<html>
<head>
<title>My Fourth Account takeover through password reset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的第四个账户通过密码重置接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/my-fourth-account-takeover-through-password-reset-28a36dfebaf?source=collection_archive---------1-----------------------#2021-05-17">https://infosecwriteups.com/my-fourth-account-takeover-through-password-reset-28a36dfebaf?source=collection_archive---------1-----------------------#2021-05-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/7eb63387c97228c1bde1698a6781ec5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mfF5OdpifcMOAMeLqPZyLQ.png"/></div></div></figure><p id="c7b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">大家好，</p><p id="3eaf" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我是<strong class="kd iu">奥马尔·哈姆迪</strong> <strong class="kd iu">【海员】</strong>，今天我将解释我在<strong class="kd iu"> Bugcrowd </strong>的私人程序中发现的最酷的bug之一</p><p id="fa06" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们开始吧，</p><p id="ee5c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我有一个私人程序，姑且称之为<strong class="kd iu">redacted.com，</strong>经过一段时间对程序的侦察，我开始检查我最喜欢的功能密码重置，通常我会寻找类似(ATO，主机头注入)的漏洞。</p><p id="5d24" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">简单地说，当用户想要重置他的密码时，他输入他的电子邮件，然后一个密码重置链接将被发送到他的电子邮件。</p><p id="8a55" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我为我的帐户申请了密码重置，密码重置链接是:</p><p id="8f5f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://www.winwin.com/update-password/02db2ca0-cbc3-44ec-9871-85ac6390d863/1621264272" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> https:// </strong> </a> <strong class="kd iu">编校</strong> <a class="ae kz" href="https://www.winwin.com/update-password/02db2ca0-cbc3-44ec-9871-85ac6390d863/1621264272" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">。com/update-password/12d 52 cat CBC 344 EC-9871-85ac 6390d 863/1621264272</strong></a></p><p id="71f9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">密码重置链接由两部分组成:用户ID和一个随机的10位代码。</p><p id="80fc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我发现非常有趣的是，这10位数字代码是一个序列代码，因此不会生成随机值，而是一个序列值，这意味着如果您请求重置您帐户的密码，并且代码是"<strong class="kd iu"> 1618963 </strong> 650 "，那么您请求重置受害者帐户的密码将是代码"<strong class="kd iu"> 1618963 </strong> 720 "， 其中只有最后3个数字不同，允许我们进行强力攻击并获得最后3个数字，其中概率比将从100到999。</p><p id="04c9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在的问题是，用户ID没有公开，我花了两天多的时间搜索任何泄露这个ID的端点，我用了Google Dorks，一无所获。</p><p id="de52" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该网站的部分理念是用户可以在网站上发布文章，并且有一个向用户报告特定文章的功能，我发现如果你向用户报告一篇文章，你会发现用户的ID正在请求中被泄露。</p><p id="9518" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">复制</strong>的步骤:</p><p id="cd9c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">1-为您的帐户请求密码重置。</p><p id="eb64" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">2-请求重置受害者账户的密码。</p><p id="3355" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">3-然后将您的ID更改为受害者ID，并使用相同的10位代码，只对最后3位数字执行暴力攻击，操作将成功完成。</p><p id="da18" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">4-对此链接执行强力攻击，并指定10位代码的最后3位</p><p id="0eab" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://www.winwin.com/update-password/02db2ca0-cbc3-44ec-9871-85ac6390d863/1621264272" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu"> https:// </strong> </a> <strong class="kd iu">编校</strong> <a class="ae kz" href="https://www.winwin.com/update-password/02db2ca0-cbc3-44ec-9871-85ac6390d863/1621264272" rel="noopener ugc nofollow" target="_blank"> <strong class="kd iu">。com/update-password/12d 52 cat CBC 344 EC-9871-85ac 6390d 863/1621264272</strong></a></p><p id="2b2a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">今天就到这里，感谢阅读:)</p><p id="2948" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在twitter @seaman00o上关注我</p><p id="f0e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">跟我来看https://www.facebook.com/profile.php?id=100028277354125的脸书</p></div></div>    
</body>
</html>