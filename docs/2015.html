<html>
<head>
<title>Tech_Supp0rt: 1 (Tryhackme)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">技术支持:1 (Tryhackme)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tech-supp0rt-1-tryhackme-59896cbb9957?source=collection_archive---------0-----------------------#2022-04-16">https://infosecwriteups.com/tech-supp0rt-1-tryhackme-59896cbb9957?source=collection_archive---------0-----------------------#2022-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b644" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">侵入骗子正在开发的网站来挫败他们的计划。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/d45e1c2b5a464b80bce359cabe291190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*HxMde2gkALloIVqTSDzNug.png"/></div></figure><p id="0dc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，神奇黑客，我是<strong class="jp ir"> Hac </strong>，今天我们将做来自Tryhackme 的<strong class="jp ir">Tech _ support:1，这是一个简单的盒子，让我们开始黑客吧……</strong></p><p id="a3aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将从<strong class="jp ir"> Nmap </strong>扫描开始:-</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kt ku l"/></div></figure><p id="03c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的扫描中，我们发现有四个端口是开放的22 (ssh)、80(web服务器)、139、445(smb)。有一个<a class="ae kv" href="https://ostechnix.com/identify-operating-system-ttl-ping/" rel="noopener ugc nofollow" target="_blank">小技巧，用ping(是ping) </a>识别没有nmap的OS(操作系统)。通过检查<a class="ae kv" href="https://www.cloudflare.com/en-gb/learning/cdn/glossary/time-to-live-ttl/" rel="noopener ugc nofollow" target="_blank"> ttl </a>(生存时间)，默认情况下，windows的<a class="ae kv" href="https://www.cloudflare.com/en-gb/learning/cdn/glossary/time-to-live-ttl/" rel="noopener ugc nofollow" target="_blank"> ttl </a>(生存时间)为128，而对于Linux，它在64的范围内。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/84f976064bf728832566bc79b5195266.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*6FDpUqYQT1Y0OHvx7PAfpA.png"/></div></figure><p id="4ad2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我将检查端口80，因为它具有更大的攻击面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kx"><img src="../Images/e770c242cedd4e5f1d94a25e289b1be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kbVCjtgfpmxj4MjfsbORHQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">默认Apache2页面</figcaption></figure><p id="631a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我会检查它的源代码，因为在CTF的，你可以找到一些有趣的东西。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lg"><img src="../Images/42b5e24edad9a0322c0330a2dbb88dfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZywGF14HOmh7BUv28LkjVQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">检查源代码</figcaption></figure><p id="d1b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用gobuster来对付它</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kt ku l"/></div></figure><p id="3dcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是没有用，因为/wordpress是一个兔子洞。</p><p id="ea5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后我查了SMB。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/926dc050e5390dac6c4f2ff8d1249503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*-qWyr9_R6ZdMS3UuiRb8qw.png"/></div></figure><p id="4ad8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“websvr”看起来很有趣，如果我们对那个共享有写访问权，我们可以把我们的反向外壳。遗憾的是，我们没有写权限:(</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi li"><img src="../Images/786a84236e999d888e9bad32f18764fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*wdFbuJgxH0aXhiuq1cxUGw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">我们没有烫发:(</figcaption></figure><p id="579b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们有“enter.txt ”,所以让我们来看看。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lj"><img src="../Images/ffd52b802e855366406b5a040150ecf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*pI2UWfS116VbmWN4hOD1cw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">在检查enter.txt时</figcaption></figure><p id="989e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有了一个新的目录“/subrion”和管理员凭证，但看起来我们需要解码密码。一如既往，我们最好的朋友<a class="ae kv" href="https://gchq.github.io/CyberChef" rel="noopener ugc nofollow" target="_blank">网络厨师</a>会帮助我们。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lk"><img src="../Images/108b69a04640073bc788eba9c190c5ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FZqMrWZ51tRbfkVIABO1Ag.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">解码密码</figcaption></figure><p id="e586" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查一下从“enter.txt”中得到的“/subrion/panel”</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ll"><img src="../Images/fe85192adfb34f8a7c598979549b5f1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FWdvEvHVFHyaTcsaVdFzfQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">检查端口80/子接口/面板时</figcaption></figure><p id="d8a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有Cms的名称和版本，所以最好找一个漏洞。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/09a2f7bbaf14c34a8065ebd4bf0c0d4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*d2Dx_YGp0OjA8Rvy-7YBRQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">在searchsploit上检查漏洞</figcaption></figure><p id="2c92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对“<a class="ae kv" href="https://www.exploit-db.com/exploits/49876" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Subrion CMS 4.2.1 —任意文件上传</strong> </a>”更感兴趣，因为这是在盒子上获得最初立足点的最简单方法。我们可以使用“-m”来下载python脚本。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/574cd6b70a4793a2ef0a431f2f320ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*tfDc-7aUZsXAhgh-YjFaLg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">下载python脚本</figcaption></figure><p id="ff76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看一下python脚本来理解漏洞利用实际上在做什么。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/512f65c34d49311a18df1ae376da7586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*-q-J7T3WyoKJIriJZYe93w.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">检查python脚本</figcaption></figure><p id="8e42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们运行python脚本，我们已经得到了shell。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lp"><img src="../Images/137402e68cb26726acebf0497b9dc551.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*1y-YBEf1Ia5udyX8qcZcug.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">将shell作为www-data</figcaption></figure><p id="c29a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是等一下，我们是专业的1337赫克，对吗？？？所以让我们尝试手动方式来获取外壳。</p><p id="5dce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先使用我们之前获得的凭证登录“/subrion/panel”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lq"><img src="../Images/ce5e947689922c5e362368e43a182747.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jSQhnLXpssgTvLUnhz2GQw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">/子离子/面板</figcaption></figure><p id="df8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我们需要在内容&gt;上传"<strong class="jp ir">/子菜单/面板/上传</strong>"中导航</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lr"><img src="../Images/db848b0a3ac653b263fb1d092bb872f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*--T-eUB52POPz176YpEAkA.png"/></div></div></figure><p id="817a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后我们将创建一个”。phar "文件，然后我们会上传它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ls"><img src="../Images/91e7672f759964e241bfb70057258e81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TaExxvHpH8FOQGTHPZX_Gg.gif"/></div></div></figure><p id="922f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了外壳(干得好),但游戏还没有结束，需要将我们的权限升级到用户&gt; root。我们知道，有一个word-press可以包含数据库的密码，所以让我们检查一下这个文件夹(/var/www/html/wordpress)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/0dbf67cce07a10371491befe0dd90334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*3PfoK5swkcyc-tOwbuElNg.png"/></div></figure><p id="21c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了MySql数据库的用户名和密码。但是我们可以在用户“scamsite”上尝试这个密码，我们就进入了……</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/8adf45c0d7a4a47f35d0bba9b6fc386e.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*z9MdMD32hy2dqayKdyRnzg.png"/></div></figure><p id="a52f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们需要将我们的权限提升到根用户。如果我们做sudo -l，我们可以运行“/usr/bin/iconv”</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/d5dbc76ad572bd45a32591a468929f3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*woaLWDJiZL-J4ljO9azBnw.png"/></div></figure><p id="925c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查一下我们最好的朋友之一在linpeas之后的特权升级，他是<a class="ae kv" href="https://gtfobins.github.io/gtfobins/iconv/" rel="noopener ugc nofollow" target="_blank"> gtfo bin </a>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lw"><img src="../Images/f7aedd00ace2ac9a3f6aa382d2b786e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*84MR5y0SsKcfhqX9Cyb3NQ.png"/></div></div></figure><p id="29c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有根旗</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/beb670de07c97673f023cf59d73567a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*9KffeFv5ALXgYxNoA8tY8A.png"/></div></figure><p id="c53f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你喜欢这篇为Tech _ supp 0 port:1(Tryhackme)写的文章。我希望你学到了一些新东西，如果你有任何问题或反馈，请在twitter上给我发消息<a class="ae kv" href="https://twitter.com/Hac10101" rel="noopener ugc nofollow" target="_blank"> hac10101 </a></p></div></div>    
</body>
</html>