<html>
<head>
<title>How Malicious Hackers Can Takeover Your Headless Browser:</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">恶意黑客如何接管您的无头浏览器:</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-malicious-hackers-can-takeover-your-headless-browser-part-1-bcab9e3a2f9c?source=collection_archive---------0-----------------------#2022-07-21">https://infosecwriteups.com/how-malicious-hackers-can-takeover-your-headless-browser-part-1-bcab9e3a2f9c?source=collection_archive---------0-----------------------#2022-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="5a13" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">检查无头浏览器+服务器端请求伪造(SSRF)</h2></div><p id="6e71" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">无头浏览器，如<a class="ae le" href="https://pptr.dev/" rel="noopener ugc nofollow" target="_blank">木偶师</a>、<a class="ae le" href="https://www.selenium.dev/" rel="noopener ugc nofollow" target="_blank">硒</a>和<a class="ae le" href="https://playwright.dev/" rel="noopener ugc nofollow" target="_blank">剧作家</a>，对于自动化、测试和网页抓取来说是非常有用的工具。然而，在你的服务器或后端运行一个无头浏览器有被恶意黑客滥用的巨大风险。就像普通浏览器一样，无头浏览器执行代码；他们可以发出HTTP请求、呈现内容、访问URL等。</p><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi lf"><img src="../Images/903a383e165f7ec0e15da4083beae1f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3SoanURVKV7MovFOY1kTZw.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">DALL-E mini在提示“无头浏览器”上生成的人工智能图像<a class="ae le" href="https://www.craiyon.com/" rel="noopener ugc nofollow" target="_blank">https://www.craiyon.com/</a></figcaption></figure><h2 id="1caf" class="lv lw it bd lx ly lz dn ma mb mc dp md kr me mf mg kv mh mi mj kz mk ml mm mn bi translated"><strong class="ak">问题</strong></h2><p id="3d4a" class="pw-post-body-paragraph ki kj it kk b kl mo ju kn ko mp jx kq kr mq kt ku kv mr kx ky kz ms lb lc ld im bi translated">那么，如果用户可以访问运行在您的服务器上的这些无头浏览器，例如通过提供浏览器的URL，会发生什么呢？在最坏的情况下，你的无头浏览器可能在没有<a class="ae le" href="https://www.browserstack.com/guide/what-is-browser-sandboxing#:~:text=Browser%20Sandboxing%20is%20a%20security,a%20container%20or%20virtual%20machine." rel="noopener ugc nofollow" target="_blank">沙箱</a>的情况下运行。沙箱通常有多层保护，试图将浏览器与其实际运行的机器隔离开来。如果没有沙箱，黑客可能会在浏览器上发出影响服务器的命令。因此，运行带沙盒的无头浏览器是防止这种情况的一个重要防御层。同样重要的是，要确保如果用户可以提供一个URL，该URL需要被<a class="ae le" href="https://www.techtarget.com/whatis/definition/whitelist" rel="noopener ugc nofollow" target="_blank">列入白名单</a>。如果无头浏览器可以简单地访问任何URL，黑客可以创建定制的有效负载来执行服务器端请求伪造(SSRF)。本质上，由于无头浏览器源自服务器，因此它可用于发送恶意请求，绕过典型的服务器身份验证方法。</p><p id="50b6" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">例如，如果无头浏览器接受任何URL:</p><ol class=""><li id="1a3b" class="mt mu it kk b kl km ko kp kr mv kv mw kz mx ld my mz na nb bi translated">我们可以创建一个恶意站点(即attacker.com)。我们用<code class="fe nc nd ne nf b">URL=attacker.com</code>向victim.com发出进入请求。</li><li id="5fef" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">victim.com将向受害者服务器发送POST请求。</li><li id="8c93" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">受害者服务器将启动一个无头浏览器去attacker.com。</li><li id="683d" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">无头浏览器访问attacker.com。</li><li id="3120" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">attacker.com发出了一个信息请求，该信息应该只能由服务器访问。</li><li id="0f40" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">无头浏览器向受害者服务器发送请求。这是SSRF。</li><li id="072c" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">因为无头浏览器源自服务器，所以服务器会批准请求，并将请求的资源发送回无头浏览器。</li><li id="3fe1" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">无头浏览器将此发送回attacker.com。</li><li id="c4c9" class="mt mu it kk b kl ng ko nh kr ni kv nj kz nk ld my mz na nb bi translated">attacker.com现在拥有私人数据，并将其发送回攻击者自己的服务器。信息已被成功窃取。</li></ol><figure class="lg lh li lj gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="ll lm di ln bf lo"><div class="gh gi nl"><img src="../Images/c81aa4d57283852ddbfbdf131a60b174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3y494NpKNWXJLb7X-ovYIg.jpeg"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk translated">AbuseHumanDB挑战中使用的利用方法</figcaption></figure></div><div class="ab cl nm nn hx no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="im in io ip iq"><p id="0b60" class="pw-post-body-paragraph ki kj it kk b kl km ju kn ko kp jx kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。加入我们的每周简讯，以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！<a class="ae le" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"><em class="nt"/></a></p></div></div>    
</body>
</html>