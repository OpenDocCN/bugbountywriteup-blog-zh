<html>
<head>
<title>How to add infinity amount(cash) to E-Commerce application’s wallet just from 1 INR only.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何添加无限量(现金)到电子商务应用程序的钱包只是从1印度卢比只。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-to-add-infinity-amount-cash-to-e-commerce-applications-wallet-just-from-1-inr-only-6f33d6fb5e2d?source=collection_archive---------0-----------------------#2020-07-12">https://infosecwriteups.com/how-to-add-infinity-amount-cash-to-e-commerce-applications-wallet-just-from-1-inr-only-6f33d6fb5e2d?source=collection_archive---------0-----------------------#2020-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/df9ced5b1133dc60bcc9ddd7b0499d39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*URxJqNzjarfwZSeFJbtz4w.jpeg"/></div></div></figure><p id="11a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，信息安全的伙计们！！！！希望你一切都好。如果你在这里，那么你有兴趣了解更多。这一发现对于一些1337 infosec的人来说并不是唯一的，但是大多数人并没有测试这种情况。</p><p id="7648" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我测试了一个电子商务应用程序，使用了我的电子商务应用程序专用的清单。我在应用程序上发现了许多漏洞，如动态口令响应、价格操纵、数量操纵等。</p><p id="ab52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我将谈论增加钱包中的金额，以及我是如何滥用它来获得数千美元的赏金的错误。我将使用<a class="ae kw" href="http://www.redacted.com" rel="noopener ugc nofollow" target="_blank">www.redacted.com</a>作为目标主机。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/1a17b0915ff2b397cb75eb4485f7c481.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*b_Xgu_D6f4rZroohSgsmDw.gif"/></div></div></figure><p id="7b97" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我创建了一个帐户，并转到钱包部分。我开始时没有印度卢比。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/4457c50cf3d460a958eafa4bf498d1aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:936/format:webp/1*wCFuxSHX9qIMygln3xqNlQ.png"/></div></figure><p id="6a90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后有一个选项，用一些支付网关添加钱包中的金额。我在输入框中添加了1，选择了PayTM gateway并点击了add to wallet。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ld"><img src="../Images/c21b78e6adb6880d24752edd3cabe98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MLRrBMYrHa2FB6DsSQm5Bg.png"/></div></div></figure><p id="2231" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，有一个支付网关页面，你可以选择以下任何一个选项。我选择了paytm选项，添加了我的paytm号码并验证了它。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/872e84b542cb5467c917f7016a77a027.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o8_zpXBbdLTmhooudrdnOQ.png"/></div></div></figure><p id="c989" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我用浏览器配置了BurpSuite，并截取了请求。</p><p id="b633" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我点击了付费。1并检查BurpSuite中的每一个请求。我转发了所有与paytm gateway相关的请求。然后我在BurpSuite收到一个可疑的请求。</p><p id="4630" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请求:</p><blockquote class="lf lg lh"><p id="7312" class="jy jz li ka b kb kc kd ke kf kg kh ki lj kk kl km lk ko kp kq ll ks kt ku kv ij bi translated">POST/pg response . PHP HTTP/1.1【www.redacted.com】主机:T2<br/>用户代理:Mozilla/5.0(Macintosh；英特尔Mac OS X 10.15；RV:78.0)Gecko/2010 01 01 Firefox/78.0<br/>接受:text/html，application/xhtml+xml，application/XML；q=0.9，image/webp，*/*；q=0.8 <br/>接受-语言:en-US，en；q=0.5 <br/> Accept-Encoding: gzip，deflate<br/>Content-Type:application/x-www-form-urlencoded<br/>Content-Length:404<br/>Origin:https://securegw . pay TM . in<br/>Connection:close<br/>Referer:https://securegw.paytm.in/theia/processTransaction<br/>Cookie:PHPSESSID = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx；t * * * connection time = 0；_ _ T * * * uuid = xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx<br/>升级-不安全-请求:1</p><p id="addc" class="jy jz li ka b kb kc kd ke kf kg kh ki lj kk kl km lk ko kp kq ll ks kt ku kv ij bi translated">CURRENCY = INR &amp; gateway name = WALLET &amp; resp msg = Txn+Success &amp; bank name = WALLET &amp; payment mode = PPI &amp; MID = xxxxxx79987247 XXXXXX &amp; resp code = 01 &amp; tx NID = 202007 xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx &amp; Txn amount = 1.00 &amp; ORDERID = orders 157 xxxxxxxx &amp; STATUS = TXN _ Success &amp; bank TXNID = 1410 xxxxxxxx &amp; Txn date = 2020–01–11+22</p></blockquote><p id="21b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回应:</p><blockquote class="lf lg lh"><p id="f3f7" class="jy jz li ka b kb kc kd ke kf kg kh ki lj kk kl km lk ko kp kq ll ks kt ku kv ij bi translated">HTTP/1.1 200 OK <br/>日期:2020年1月11日星期六17:09:32 GMT <br/>服务器:Apache/2.4.18 (Ubuntu) <br/>过期时间:0<br/>Cache-Control:no-Cache<br/>Pragma:no-Cache<br/>Vary:Accept-Encoding<br/>Content-Length:116<br/>Connection:close<br/>Content-Type:text/html；字符集=UTF-8</p><p id="9179" class="jy jz li ka b kb kc kd ke kf kg kh ki lj kk kl km lk ko kp kq ll ks kt ku kv ij bi translated"><b>等待… </b> <br/> <b>交易状态为成功</b><br/><script>window . location . href = ' thank you . PHP '；</script></p></blockquote><p id="9031" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我把上面的请求发送到REPEATER Tab并拦截了。</p><p id="20b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我检查了钱包，并成功地添加了金额(1印度卢比)。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/4e7fb700b6d7fd96bd16a537cc2ff37e.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*vOzGfXn-e_Yr7ANskn2_-A.png"/></div></figure><p id="d26f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，场景是支付网关向客户端发送一个关于成功完成支付的响应，然后从客户端向目标服务器生成一个添加钱包金额的请求(在请求之上)。</p><p id="a78d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我将TXAMOUNT的值从1.00更改为10000.00并发送它，但没有成功。</p><p id="b5f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我发送原来的请求(上面的请求),进入浏览器并刷新页面。</p><p id="d339" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘣！！！！！1印度卢比已成功添加到钱包中。所以现在，钱包的总数是2印度卢比。(我将原始请求发送给入侵者，并发送了1000个有效负载为空的请求，1000INR被添加到我的钱包中。)</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/962170658ce597c2c376afcfc0bf13d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*qsdQF03G9nt4W4erjDGHcg.png"/></div></figure><p id="6384" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"># #注意:</p><ol class=""><li id="1725" class="lo lp iq ka b kb kc kf kg kj lq kn lr kr ls kv lt lu lv lw bi translated">检查每一个请求。</li><li id="269a" class="lo lp iq ka b kb lx kf ly kj lz kn ma kr mb kv lt lu lv lw bi translated">如果上面的测试用例不适合你，那么就有必要检查一下附加货币端点上的竞争条件问题——使用Turbo Intruder或使用编码技巧来实现它。</li></ol><p id="16e3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢它，请鼓掌并与其他infosec成员分享。</p><p id="0e34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kw" href="https://www.twitter.com/sengarharshit1" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae kw" href="https://www.linkedin.com/in/sengarharshit1" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>上关注我</p><p id="893c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">谢谢！！！！</p><p id="9003" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望你喜欢它和我以前的博客。</p></div></div>    
</body>
</html>