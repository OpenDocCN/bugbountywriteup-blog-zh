<html>
<head>
<title>Unloading the Sysmon Minifilter Driver</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卸载Sysmon微筛选器驱动程序</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/unloading-the-sysmon-minifilter-driver-86f4541fa55a?source=collection_archive---------0-----------------------#2020-01-27">https://infosecwriteups.com/unloading-the-sysmon-minifilter-driver-86f4541fa55a?source=collection_archive---------0-----------------------#2020-01-27</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6502" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">二进制fltMC.exe用于管理微筛选器驱动程序。您可以使用这个二进制文件轻松地加载和卸载微过滤器。要卸载Sysmon驱动程序，您可以使用:</p><pre class="ko kp kq kr gt ks kt ku kv aw kw bi"><span id="2d14" class="kx ky it kt b gy kz la l lb lc">fltMC unload SysmonDrv</span></pre><p id="4eda" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">如果标记了此二进制文件，我们可以通过调用“FilterUnload”来卸载微筛选器驱动程序，它是Win32中“FltUnloadFilter”的等效项。它将调用微过滤器的“FilterUnloadCallback”(PFLT _ FILTER _ UNLOAD _ CALLBACK)例程。这与使用fltMC相同，FLT MC是一个<em class="ld">非强制卸载</em>。<br/>调用这个API <em class="ld">需要SeLoadDriverPrivilege </em>。要获得此特权，需要管理权限。</p><p id="0586" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是我写的一个简单的C代码，用来调用‘filter unload’API。</p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><figure class="ko kp kq kr gt ll"><div class="bz fp l di"><div class="lm ln l"/></div></figure><figure class="ko kp kq kr gt ll gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/3712567c41325eb9bb91fd2b528f0369.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/0*0GNXc-pfw9uVu1N5"/></div></figure><p id="3791" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">请注意，当通过FilterManager卸载微筛选器驱动程序时，它将被记录在系统日志下。</p><figure class="ko kp kq kr gt ll gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/be1cd0ed2caeea0a6bed60a1b8e0b751.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/0*jTCRc8QVj5oEBJaQ"/></div></figure><p id="3382" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">参考资料:<br/><a class="ae ls" href="https://www.osr.com/nt-insider/2017-issue2/introduction-standard-isolation-minifilters/" rel="noopener ugc nofollow" target="_blank">https://www . osr . com/nt-insider/2017-issue 2/introduction-standard-isolation-minifilters/</a></p></div><div class="ab cl le lf hx lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="im in io ip iq"><p id="77ba" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="ld">关注</em> <a class="ae ls" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ld"> Infosec报道</em> </a> <em class="ld">获取更多此类精彩报道。</em></p><div class="lt lu gp gr lv lw"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd iu gy z fp mb fr fs mc fu fw is bi translated">信息安全报道</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">medium.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk lp lw"/></div></div></a></div></div></div>    
</body>
</html>