<html>
<head>
<title>Hacking into Linux Systems without Credentials: A Step-by-Step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无凭证入侵Linux系统:一步一步指南</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-to-hack-into-a-linux-machine-4fd2384a8700?source=collection_archive---------3-----------------------#2022-04-11">https://infosecwriteups.com/how-to-hack-into-a-linux-machine-4fd2384a8700?source=collection_archive---------3-----------------------#2022-04-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="a376" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">了解如何在不使用任何工具或程序的情况下访问锁定的基于Linux的操作系统。这篇文章解释了利用Linux引导过程并获得对根用户和系统上所有文件的访问权的方法。发现三种方法，包括<strong class="js iu">引导进入恢复模式</strong>、<strong class="js iu">中断initramfs进程</strong>、<strong class="js iu">覆盖默认初始化参数</strong>。对于那些忘记密码或参加白帽黑客比赛的人来说是完美的。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/850fe8474f60a98b629a141d821ede97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CABHxpgY1e4UoQ_H91fsJg.jpeg"/></div></div></figure><p id="a92a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了能够理解我们将如何获得对系统的访问，我们需要了解一点关于基于Linux的发行版是如何引导的。</p><h1 id="7d4f" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Linux引导过程</h1><p id="5687" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">有很多资源，可能比我解释得更好，但我仍然会简要地介绍不同的阶段，以便您可以更好地理解我们将在哪里利用该系统。</p><ul class=""><li id="11af" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated">当你按下电源按钮时，首先发生的是<strong class="js iu"> <em class="mm"> CPU </em>从闪存</strong>加载<em class="mm"> boot/UEFI </em>固件</li><li id="fcea" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated"><strong class="js iu">引导固件然后</strong> <strong class="js iu">读取</strong> <a class="ae ms" href="https://en.wikipedia.org/wiki/Master_boot_record" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> <em class="mm">主引导记录(MBR) </em> </strong> </a>这是您硬盘上的第一个扇区<em class="mm"> (512字节)</em>并验证磁盘签名，该签名用于识别我们正在引导的驱动器</li><li id="6b3e" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated">之后，<strong class="js iu"> boot固件将bootloader加载到<em class="mm"> RAM </em>中并执行</strong>。重要的是要认识到<strong class="js iu">引导加载程序运行在<em class="mm"> RAM </em> </strong>中，因此任何改变都不会在引导之间持续。</li><li id="b0f9" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated"><strong class="js iu">在这个阶段，我们将利用系统，因为我们将修改initramfs用户空间帮助程序加载根文件系统的参数，并误导它让我们访问系统。对于进一步的步骤，假设我们还没有调整系统</strong></li><li id="13a7" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated">由于根文件系统可能位于软件<em class="mm"> RAID </em>卷、<em class="mm"> LVM </em>、<em class="mm"> NFS </em>或加密分区上，我们需要某种方式来正确配置系统，以便能够应对如此多的不同方式来挂载真正的根文件系统。因此b <strong class="js iu"> ootloader将内核和临时根文件系统(有时称为</strong> <a class="ae ms" href="https://en.wikipedia.org/wiki/Linux_startup_process#Early_user_space" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu">早期用户空间</strong> </a> <strong class="js iu">)加载到<em class="mm"> RAM </em> </strong>中。</li></ul><blockquote class="mt mu mv"><p id="0513" class="jq jr mm js b jt ju jv jw jx jy jz ka mw kc kd ke mx kg kh ki my kk kl km kn im bi translated">💡<strong class="js iu">内核也称为</strong> <a class="ae ms" href="https://en.wikipedia.org/wiki/Linux_kernel" rel="noopener ugc nofollow" target="_blank"> <strong class="js iu"> Linux内核</strong> </a> <strong class="js iu">是计算机硬件与其进程之间的核心接口。</strong></p></blockquote><ul class=""><li id="dcca" class="md me it js b jt ju jx jy kb mf kf mg kj mh kn mi mj mk ml bi translated">内核试图从它的前几个数据块中<strong class="js iu">确定磁盘映像</strong>(存储您的文件系统的文件)<strong class="js iu">的格式，这可以导致要挂载的<strong class="js iu"><em class="mm">initrd</em></strong><em class="mm"/>或<strong class="js iu"> <em class="mm"> initramfs </em> </strong>类型的临时文件系统(<em class="mm"> initramfs </em>是<em class="mm"> initrd </em>的后继)。</strong></li><li id="2607" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated"><em class="mm"> Initramfs </em>用于尽可能多地替换以前内核在引导过程中执行的功能，例如<strong class="js iu">硬件检测、内核模块加载和设备发现，这些都是挂载真正的根文件系统所必需的</strong>。</li><li id="a47b" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated"><strong class="js iu"> <em class="mm"> Initramfs </em>然后挂载根文件系统</strong>并使用<strong class="js iu">参数运行<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">/sbin/init</em></strong></code>脚本，我们将调整/利用</strong></li><li id="042c" class="md me it js b jt mn jx mo kb mp kf mq kj mr kn mi mj mk ml bi translated"><em class="mm"> Init </em>脚本运行许多不同的模块来在您的系统上设置服务，但最后还有提示您输入凭证的登录程序<em class="mm"> (lightdm) </em></li></ul><p id="e534" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">关于启动过程就讲这么多。让我们更详细地看看我们将利用的阶段。</p><h1 id="d383" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">引导装载程序</h1><p id="d91d" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">在这个例子中，我们将专门研究<a class="ae ms" href="https://en.wikipedia.org/wiki/GNU_GRUB" rel="noopener ugc nofollow" target="_blank"> <em class="mm"> GRUB2 </em> </a>，但是您的系统也可能使用<a class="ae ms" href="https://en.wikipedia.org/wiki/REFInd" rel="noopener ugc nofollow" target="_blank"> <em class="mm"> rEFInd </em> </a>，<a class="ae ms" href="https://en.wikipedia.org/wiki/Systemd-boot" rel="noopener ugc nofollow" target="_blank"> <em class="mm"> systemd-boot </em> </a>，<a class="ae ms" href="https://en.wikipedia.org/wiki/Coreboot" rel="noopener ugc nofollow" target="_blank"> <em class="mm"> coreboot </em> </a>，<a class="ae ms" href="https://wiki.syslinux.org/wiki/index.php?title=SYSLINUX" rel="noopener ugc nofollow" target="_blank"><em class="mm">syslinux</em></a>boot loader。你可能以前见过它，但是在Ubuntu系统上，引导装载器界面看起来像这样:</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/566ce6c402beb07f24faf69fd92436eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1220/format:webp/1*ToN8JoLIxXG9et4VzVS7FA.jpeg"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">引导装载程序</figcaption></figure><p id="81bb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">它是在启动时出现的屏幕，提示您选择要启动的操作系统。如果你的系统上没有多个操作系统，这并不完全必要，但是如果你在打开电脑后立即按住<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">Shift Key</em></strong></code>键，你仍然可以强制系统打开它。</p><p id="ec8e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">好了，现在这是足够的背景，让我们利用它！我们将从最简单的开始，但并不总是可行的。</p><h1 id="623d" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">引导进入恢复模式</h1><p id="4e13" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">在第二行顶部的图像上，您可以看到<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">Advanced options</em></strong></code> <strong class="js iu">。</strong>点击并选择一个恢复模式选项。您的系统将引导到一个shell中，以root用户身份登录。简单，你完了！</p><blockquote class="mt mu mv"><p id="9258" class="jq jr mm js b jt ju jv jw jx jy jz ka mw kc kd ke mx kg kh ki my kk kl km kn im bi translated">💡<strong class="js iu">恢复模式通常被添加到操作系统中，以防您忘记密码，它使您能够重新访问您的文件系统。</strong></p></blockquote><p id="4a1c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这种方法的缺点是<strong class="js iu">引导</strong> <strong class="js iu">进入恢复模式</strong> <strong class="js iu">在所有发行版</strong>上不可用，因为它可能被禁用。同样在恢复模式下，一些发行版在给你访问权限之前可能仍然会要求你输入根密码——所以你实际上什么也没得到。这就把我们带到了接下来的两个方法，它们通常在大多数Linux发行版上都可以使用。</p><h1 id="0b20" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">通过initramfs访问</h1><p id="6795" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">这个方法需要你稍微邪恶一点。基本上你要做的是<strong class="js iu">改变根文件系统的位置，<em class="mm"> initramfs </em>试图挂载，这样它就找不到它了</strong>。因此，您的系统最终会卡在initramfs CLI终端中，在这里您不仅拥有root权限，而且还可以<strong class="js iu">从正确的位置手动挂载根文件系统</strong>并访问它。</p><p id="697e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">重启你的系统，一旦你进入GRUB2界面，点击<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">e</em></strong></code> <strong class="js iu"> <em class="mm"> </em> </strong>作为你想要访问的操作系统选项的编辑。这将为您打开一个简单的脚本。找到以<strong class="js iu"> linux </strong>开头的行，并更改参数<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">root=</em></strong></code>的值，该参数告诉内核在哪里找到要挂载的真正的根文件系统(只需将其更改为不存在的文件系统，因为目标是防止内核找到它)。现在按下<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">Ctrl + x</em></strong></code>，一分钟后，在<em class="mm"> initramfs </em>临时文件系统中会弹出一个命令提示符，显示root权限。</p><p id="2274" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样，您就可以在系统上做任何您想做的事情。因为我们正在讨论访问系统根文件系统，所以我们可以做以下事情:</p><pre class="kp kq kr ks gt ni nc nj nk aw nl bi"><span id="6a42" class="nm lb it nc b gy nn no l np nq"><strong class="nc iu">mkdir mnt/rootfs_mountpoint </strong># Create mountpoint for root<br/><strong class="nc iu">mount /dev/&lt;disk-X&gt;</strong> <strong class="nc iu">mnt/rootfs_mountpoint </strong># Mount the disk with the file system</span></pre><p id="bb04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可能会对这种方法感到满意，但我们实际上可以更容易地侵入系统。让我们看一看。</p><h1 id="1be0" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">覆盖默认的初始化参数</h1><p id="8d2b" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">最后一种方法不会欺骗系统，只是覆盖它的默认参数。与之前一样，重启电脑，点击<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">e</em></strong></code> <strong class="js iu"> <em class="mm"> </em> </strong>按钮，打开操作系统选项文件。然后在与根参数相同的行中添加一个名为init的附加参数，并将其设置为<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">/bin/bash</em></strong></code>，如下所示:</p><pre class="kp kq kr ks gt ni nc nj nk aw nl bi"><span id="40c0" class="nm lb it nc b gy nn no l np nq">linux ...root=...<strong class="nc iu"> init=/bin/bash</strong></span></pre><p id="76c9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">然后点击<code class="fe mz na nb nc b"><strong class="js iu"><em class="mm">Ctrl + x</em></strong></code>，这将引导系统进入bash终端，让您像以前一样完全控制系统。</p><h1 id="98f2" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">如何防止这种情况？</h1><p id="dc72" class="pw-post-body-paragraph jq jr it js b jt ly jv jw jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn im bi translated">你可以通过使用<strong class="js iu"> SecureBoot </strong>来减轻这种行为，但这可能是一个全新的帖子，所以我不会详细介绍。</p><p id="5391" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这个帖子就说到这里，希望你觉得有趣。关注我了解更多信息。</p><blockquote class="nr"><p id="b8bd" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">感谢阅读！😎如果你喜欢这篇文章，点击下面的按钮👏</p><p id="0f39" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">对我来说意义重大，也有助于其他人了解这个故事。在<a class="ae ms" href="https://www.linkedin.com/in/teodor-janez-podobnik/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae ms" href="https://twitter.com/TeodorJanez" rel="noopener ugc nofollow" target="_blank">Twitter</a>上打招呼</p><p id="fd50" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">要不要开始读Medium上的独家故事？使用此<a class="ae ms" href="https://medium.com/@tp4348/membership" rel="noopener">推荐链接</a>🔗</p><p id="8807" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">如果你喜欢我的帖子，你可以<a class="ae ms" href="https://www.buymeacoffee.com/tp4348" rel="noopener ugc nofollow" target="_blank">给我买个热狗</a>🌭</p><p id="d389" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">你是一个热情的工程师，但缺乏能力来编写引人注目和鼓舞人心的技术内容吗？雇用我做升级工作🛠️</p><p id="72f7" class="ns nt it bd nu nv nw nx ny nz oa kn dk translated">在Teodor J. Podobnik，@dorkamotorka 上查看我的其他内容，并关注我的更多内容，干杯！</p></blockquote></div><div class="ab cl od oe hx of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="im in io ip iq"><h2 id="a281" class="nm lb it bd lc ok ol dn lg om on dp lk kb oo op lo kf oq or ls kj os ot lw ou bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ms" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>