<html>
<head>
<title>NahamCon 2022 CTF Write-up: “No Space Between Us” Challenge</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NahamCon 2022 CTF报道:“我们之间没有空间”挑战</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/nahamcon-2022-ctf-write-up-no-space-between-us-challenge-887965280f77?source=collection_archive---------0-----------------------#2022-05-04">https://infosecwriteups.com/nahamcon-2022-ctf-write-up-no-space-between-us-challenge-887965280f77?source=collection_archive---------0-----------------------#2022-05-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="780b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">作为2022年CTF naham con的一部分，我解决“我们之间没有空间”挑战的方法和经验。参加CTF的4000多支队伍中，只有62支队伍解决了这一特殊挑战。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/53c5902c556348532fd32295f0c6d6db.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/0*9RwN2WvoeHwJVRy3.jpg"/></div></figure><p id="be56" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我最近参加了棒极了的2022<a class="ae lj" href="https://ctf.nahamcon.com/" rel="noopener ugc nofollow" target="_blank">CTF纳哈姆康</a>大会，这是由<a class="ae lj" href="https://twitter.com/STOKFredrik" rel="noopener ugc nofollow" target="_blank"> STOK </a>、<a class="ae lj" href="https://twitter.com/_johnhammond" rel="noopener ugc nofollow" target="_blank">约翰哈蒙德</a>和<a class="ae lj" href="https://twitter.com/NahamSec" rel="noopener ugc nofollow" target="_blank">纳哈姆Sec </a>主办的<a class="ae lj" href="https://www.nahamcon.com/" rel="noopener ugc nofollow" target="_blank">纳哈姆康</a> <strong class="kp ir">免费</strong>虚拟安全会议的一部分。</p><p id="323b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这是我第一次参加CTF，我只有几个小时的时间，所以我没能参加所有的挑战。我能够尝试的挑战是巨大的，我学到了很多。</p><p id="da3a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这篇博文中，我将分享我对<strong class="kp ir">“我们之间没有空间”</strong>挑战的解决方案(由<a class="ae lj" href="https://twitter.com/kkevsterrr" rel="noopener ugc nofollow" target="_blank"> @Kkevsterrr </a>撰写)，并尝试描述我的思维过程，希望它能在你面临类似挑战时有所帮助。</p><h2 id="2657" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kw lt lu lv la lw lx ly le lz ma mb mc bi translated">让我们开始吧…</h2><h1 id="ad67" class="md ll iq bd lm me mf mg lp mh mi mj ls jw mk jx lv jz ml ka ly kc mm kd mb mn bi translated">我们之间没有空间——穿行</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/c536f2fb1e546226168c8838421d9be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*J-DmSZh_R8VL5ZEB"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">挑战描述</figcaption></figure><p id="be41" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如你在挑战描述中看到的，在CTF的不和谐服务器中似乎有一个有创意的讲故事机器人，但描述中有趣的部分是句子的第二部分:<br/> <em class="mx">“我们之间需要零空间”。</em></p><p id="653d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这一点上，我去了不和谐和DM的机器人。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/11f14d73974f69f30c2a0d30f2986dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*byGkmyHyWGNceGJS"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="2f7b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">乍一看，我们看不出第一个故事有什么可疑之处。<br/>当我向机器人询问故事#2时，我注意到有多个换行符(行与行之间的空格)，这使得我认为对挑战的描述可能与解决方案有关。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/520bc4a5c15e488ec6079e91c17a4b70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xFu67-3Wpg582hN1"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="07f1" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">此时，我决定将这些故事复制到一个简单的基于网络的工具<a class="ae lj" href="https://www.soscisurvey.de/tools/view-chars.php" rel="noopener ugc nofollow" target="_blank">中，该工具允许查看不可打印的字符(vim也可以):</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/62d8079de5c8164b1ce91cab9afa6724.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7HZt0__jSWNd46Py"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="e52b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我们可以看到确实存在换行符，但更有趣的是，我们还可以看到出现了几次<code class="fe mz na nb nc b">`U+200C`</code>和<code class="fe mz na nb nc b">`U+200D`</code> Unicode字符。</p><p id="5f47" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">快速谷歌搜索发现，这些字符代表<strong class="kp ir">零宽度加入者</strong>和<strong class="kp ir">零宽度非加入者</strong>，它们都是<a class="ae lj" href="https://en.wikipedia.org/wiki/Zero-width_space#:~:text=The%20zero%2Dwidth%20space%20(%E2%80%8B,but%20after%20which%20there%20may" rel="noopener ugc nofollow" target="_blank">零宽度空格</a>的实例。</p><p id="0474" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">好的，从挑战的描述来看，我们似乎已经走上了正轨，但是我们怎样才能从这些角色身上得到一面旗帜呢？？</p><p id="46d6" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这一点上，我不确定如何进行，所以我测试了一些基本假设。首先，我想知道这个机器人有多少故事？与机器人的快速互动显示它有37个故事:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/c82fce36a8fe5b9901dea94fadeeac00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NrO9otRV2bEO30qI"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="9cac" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">接下来，我想看看这些文字是有意义的还是随机的。当两次询问同一个故事时，我知道机器人每次都讲述不同的故事，但是零宽度字符序列保持不变。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/ad5f632fe8f85167e6b7f642cec76e73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iKzXLLigZRi1epBY"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="2929" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这意味着文本是不相关的，我们需要的只是特殊的Unicode字符。然而，我仍然不知道如何从这些特殊字符序列得到一面旗帜。</p><blockquote class="nd ne nf"><p id="b505" class="kn ko mx kp b kq kr jr ks kt ku ju kv ng kx ky kz nh lb lc ld ni lf lg lh li ij bi translated"><strong class="kp ir"> CTF提示</strong>:每当你觉得你在CTF挑战赛中有了一个好的方向，但你不确定如何继续，试着用“CTF”这个词和你认为你已经有的线索在谷歌上搜索一下。有时候，从其他类似的挑战中学习可以给你一个正确的方向。</p></blockquote><p id="d226" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在这种情况下，我做的搜索是:<em class="mx"> `CTF隐形空白`</em>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi my"><img src="../Images/619cd2b0af8f2774c4a9d5c2541a8a36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GCeC5k56wcDe13o5"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="f316" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如你所看到的☝️，第二个结果是一个链接到约翰·哈蒙德的YouTube视频。)，解释如何使用零宽度空格来隐藏秘密消息。</p><p id="5f49" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">宾果！</strong></p><p id="33f4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">看完视频，才知道特殊字符代表的是二进制位。因为我们在每个故事中有八个这样的字符，所以每八个二进制位的序列可能代表一个ASCII字符。如果我们将每个故事中的8位序列的ASCII表示组合起来，就有希望得到我们的标志。</p><p id="a746" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">是时候编写一些脚本来验证我们的假设了。<br/>我编写了以下Python脚本，该脚本将原始的机器人故事文本作为输入，从中提取特殊字符，并将这些字符转换为二进制位序列:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nj"><img src="../Images/a6c56837eb43bdab08d90e243623a57a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TDwmH31UchTcgdUVtLGCHw.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="81f3" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">例如，对于☝️这个故事，脚本打印出以下二进制序列:<code class="fe mz na nb nc b">01101100</code>。</p><p id="b3e9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">对所有的故事运行这个逻辑，并将结果粘贴到一个简单的基于web的二进制到ASCII的转换器<a class="ae lj" href="https://www.rapidtables.com/convert/number/binary-to-ascii.html" rel="noopener ugc nofollow" target="_blank">中</a>就能得到这个标志！<br/> <strong class="kp ir">大获成功！</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nk"><img src="../Images/0056f6dfcdce372050064a53271fd14e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SuJVRRrj87v2By8u"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk translated">作者照片</figcaption></figure><p id="bc73" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如你在截图中看到的，在这一点上，我从单词<code class="fe mz na nb nc b">flag</code>中漏掉了字母<code class="fe mz na nb nc b">`f`</code>。这让我意识到我错过了一个额外的故事——故事0。<br/>剩下的就是提交旗帜:<code class="fe mz na nb nc b">flag{e4e5ad33eb16426d52b94e398e593466}</code></p><h2 id="bdd2" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kw lt lu lv la lw lx ly le lz ma mb mc bi translated">最终注释</h2><p id="e3fc" class="pw-post-body-paragraph kn ko iq kp b kq nl jr ks kt nm ju kv kw nn ky kz la no lc ld le np lg lh li ij bi translated">我希望我已经能够传达我在解决这个挑战时所经历的思考过程，并且你喜欢阅读这篇文章。</p><p id="1380" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我希望在不久的将来为我感兴趣的其他挑战写一些额外的博客帖子，我觉得从中可以学到一些东西。</p><p id="07f9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我想借此机会对CTF组织者和挑战赛建设者所做的努力表示感谢。整个活动组织得非常好，我玩得很开心！</p><p id="a898" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果您有任何问题，请随时联系我们。</p><p id="9d37" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">推特:<a class="ae lj" href="https://twitter.com/pyotam2" rel="noopener ugc nofollow" target="_blank"> @pyotam2 </a></p></div></div>    
</body>
</html>