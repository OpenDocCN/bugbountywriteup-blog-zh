<html>
<head>
<title>Destroying the Scammers Portal — SBI Scam</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">摧毁骗子门户— SBI骗局</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/destroying-the-scammers-portal-sbi-scam-2169e21adeeb?source=collection_archive---------0-----------------------#2022-12-19">https://infosecwriteups.com/destroying-the-scammers-portal-sbi-scam-2169e21adeeb?source=collection_archive---------0-----------------------#2022-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b913" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向所有读者问好，</p><h2 id="441c" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">故事简介</h2><p id="6225" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">昨晚，我的一个朋友发消息给我，说他收到了另一条以SBI积分为名的诈骗短信。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lk"><img src="../Images/574e1b7991cb13c1dc536d8b50fa0030.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BnYanriKuF-pWPVvCARDoQ.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">消息</figcaption></figure><p id="5d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我们决定调查这个骗局。</p><p id="5948" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在检查链接时，我发现该网站要求受害者下载并安装一个应用程序，以便在他们的卡上获得5000奖励积分。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ma"><img src="../Images/362016fc8d1f9542fb94bf29179d95aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Es8BnZvFsDEsHqY6ZWYRA.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">链接主页</figcaption></figure><h2 id="4bbb" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">剥削</h2><p id="1a8d" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">我在测试模拟器上安装了应用程序，绕过了SSL pin。</p><p id="f2fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在启动时，它会要求用户提供他们的信用卡信息以及个人信息，以便在他们的信用卡上获得奖励积分。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/665f0feab443945776990afcf9ec613c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*lEyjjy25bJvX1uKVUIXVkw.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk translated">仿真器</figcaption></figure><p id="6887" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在提交表单时，它会将所有细节发送给攻击者服务器。</p><p id="da33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，应用程序请求SMS权限才能运行。</p><p id="2579" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们看到反编译的代码，可以发现手机中的消息被发送到/api/message.php，表单数据被发送到/api/signup.php</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mc"><img src="../Images/50e510f5fa16e0af30e41b44aedadf96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kFzbHebfAP25CqRflfufWA.png"/></div></div></figure><p id="32f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在检查URL时，我发现它容易受到SQL注入的攻击，但是在插入查询时没有显示错误。</p><p id="0b0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Mysql版本大于5.7，后端使用PHP，不支持栈查询。这使得很难利用这个API。</p><p id="3baf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是在检查了这个域上的一些东西之后，我发现了一个管理面板，位于/admin的同一个域上。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi md"><img src="../Images/961ab67dec0b82ec16fdbe4081d4008b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nakKSg-m3l-lkIM38l_zSg.png"/></div></div></figure><p id="d622" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">令人惊讶的是，管理面板在其登录页面上容易受到SQL注入的攻击。基本有效载荷，如</p><blockquote class="me mf mg"><p id="7d0e" class="jn jo mh jp b jq jr js jt ju jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj kk ij bi translated">或者1 = 1-</p><p id="1f58" class="jn jo mh jp b jq jr js jt ju jv jw jx mi jz ka kb mj kd ke kf mk kh ki kj kk ij bi translated">或者' ' = '</p></blockquote><p id="6d96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">工作，我进入了管理面板。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ml"><img src="../Images/d42cca17608a9e4a4ba0bdbbd248b80b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aQPo8QGMy_zeEvhBszsYHA.png"/></div></div></figure><p id="fc78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我可以看到所有被网络钓鱼的用户以及登录到门户网站的所有消息。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ml"><img src="../Images/92474ba9a25822f72d2f13300d06ed0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVGMuZyT_k8rqsq3eBs1bA.png"/></div></div></figure><p id="85dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在在管理面板上，有许多易受SQLI攻击的网址，所以人们可以从数据库中获取任何东西。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi ml"><img src="../Images/09164f089051d6fe4341e72ac8ca97c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wo7cTJUPYa9Q1-9e9fsKjw.png"/></div></div></figure><p id="1151" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，当前用户没有root权限，所以我不能删除数据库或任何记录。</p><p id="0396" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">记录的数据包括姓名、电子邮件、卡号、CVV、出生日期和到期日。当诈骗者使用钓鱼卡时，他也会收到发送给动态口令的消息。</p><p id="13bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，无需任何进一步的用户交互，攻击者就可以从门户读取OTP并轻松地进行交易。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mm"><img src="../Images/b58a0f5c519b82463f8a95798afdc80d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T1WYBSCgjrc8x4RzxMLu4A.png"/></div></div></figure><p id="d2b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，在管理面板中有一个选项可以删除已经记录的记录。</p><p id="f853" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了删除所有记录，我制作了一个带有管理cookie的小python脚本来请求删除门户上的所有记录。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/3c9d2f32941f9affb7c1706cd585990c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*aRqiPY_MqX188Hecb40zxg.png"/></div></figure><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mo"><img src="../Images/db9b627d3fd1f153589a289aae7acb60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1sjD8UNasjxf5VfS2kmKig.png"/></div></div></figure><p id="c222" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，为了防止其他用户通过该应用程序被钓鱼，我滥用了管理面板中的应用程序设置功能，并将警告消息设置为虚假的应用程序警报。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mp"><img src="../Images/b89eff7b45d0debd5c83ac88df446295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufL2kvT45immoAk7HaEdoQ.png"/></div></div></figure><p id="3e4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，任何人现在打开应用程序或页面都会看到我的消息如下。</p><figure class="ll lm ln lo gt lp gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d53203949b1935ffd24ffc7b1aa1b707.png" data-original-src="https://miro.medium.com/v2/resize:fit:1056/format:webp/1*UaS8XUxbnFOdg0ZlYWTykw.png"/></div></figure><p id="47a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有数以千计的保存卡在门户网站上被删除使用上述脚本。</p><h2 id="d390" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">结论</h2><p id="df4e" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated"><em class="mh">不安装任何可疑或不可信的应用程序。</em></p><p id="b6f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mh">不向任何应用程序提供您的个人信息/信用卡信息。</em></p><p id="b8d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要向任何像here这样的应用程序提供可疑的权限，短信读取权限被滥用来获取OTP。</p><h2 id="c0d3" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">信用</h2><p id="905b" class="pw-post-body-paragraph jn jo iq jp b jq le js jt ju lf jw jx jy lg ka kb kc lh ke kf kg li ki kj kk ij bi translated">阿尼什·罗伊(<a class="ae lj" href="https://twitter.com/anir0y" rel="noopener ugc nofollow" target="_blank">aniroy</a>)</p><p id="8a9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">沙希瓦特·库马尔(@ <a class="ae lj" href="https://twitter.com/rahullraz" rel="noopener ugc nofollow" target="_blank">拉胡拉兹</a></p></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h2 id="5ef6" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lj" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周时事通讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>