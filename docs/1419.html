<html>
<head>
<title>3 Vulnerabilities Worth $$$</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">价值$$$的3个漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/3-vulnerabilities-worth-e2851059dfc2?source=collection_archive---------0-----------------------#2021-06-22">https://infosecwriteups.com/3-vulnerabilities-worth-e2851059dfc2?source=collection_archive---------0-----------------------#2021-06-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="25be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。我叫图欣·博斯(<a class="ae kl" href="https://instagram.com/tuhin1729" rel="noopener ugc nofollow" target="_blank"> @tuhin1729 </a>)。我目前在<a class="ae kl" href="https://virtualcyberlabs.com" rel="noopener ugc nofollow" target="_blank">虚拟网络实验室</a>担任首席技术官。在这篇文章中，我将分享我是如何从一个漏洞奖励计划中获得3个漏洞的。所以不浪费时间，让我们开始吧:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/7cb621ed8871d4c8df4afa4da51ac4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*ETIL-3kEGpOEq1tSLCX7AA.jpeg"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><h1 id="c0c2" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">简介:</h1><p id="923b" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">该应用程序是联系信息管理网站，用户可以登录到他们的谷歌帐户，它会从谷歌帐户获取他们的联系信息，以便他们可以随时随地访问它，即使他们失去了他们的手机。他们还有一个高级功能，你可以获得一些额外的功能，如从多个谷歌账户同步联系人，扫描和保存名片为联系人等。他们还有一个推荐功能，通过它你可以推荐你的朋友，并免费获得一些高级功能。</p><h1 id="d6ea" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">我的方法:</strong></h1><p id="24d5" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我在那里开了一个账户。在测试了几个漏洞(来自我的清单)后，我开始测试个人资料图片上传部分。所以个人资料图片上传的流程大概是这样的:</p><ol class=""><li id="a416" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated">用户将从他的设备上传图片:</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/02a31e20b3e8b5709eb011564115fe89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_3zJRj4L_xjimI3kzb7cjQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="001f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.上传图片后，图片将被上传到img.redacted.com。当用户点击保存按钮时，图像和其他细节将被保存:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mp"><img src="../Images/602e675fc62ce1aaae6bc6fa3daa7db7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*haT66XUeH34wil3qsKrNww.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="946d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在测试了IDOR、SQLi、DoS和其他一些攻击后，我在那里尝试了SSRF。我很快用我的打嗝合作者的有效载荷替换了URL，你猜怎么着！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mq"><img src="../Images/7134dfc1a043a8c6d16fd67d87bcd7c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*emBat4GGW0NnAyChnu_wNA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="cd37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我赶紧查了一下ip，发现这个ip是他们后端负载均衡器的。我试图进一步利用它，但没有办法这样做。后来我只举报了这种行为，他们的回复是:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mr"><img src="../Images/06c6894c557aee16f01000c29798a3fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*87MGZHuikxheGq05egwJeQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="631e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是，我就把它忘了，开始测试其他端点。</p><h1 id="8134" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">悲剧:</h1><p id="d7fd" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">在测试推荐功能时，我注意到一个有趣的现象。在推荐网址(https://app . redated . com/refer/YOUR _ REFERRAL _ CODE)中，显示用户的个人资料图片:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/146c64e3f66a3a6e59467965582640ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*C0dfLBX2zntIZoX0dbHCPg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="853d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我记得以前的发现，我们可以用任何第三方网站替换我们的个人资料图片URL。</p><p id="fa40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我迅速更改了我的个人资料图片，用我的burp合作者替换了个人资料图片链接，并从另一个设备访问了推荐页面，嘣！我向我的burp合作者发出了一个HTTP请求，请求中包含设备的ip地址、浏览器信息和设备型号:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mt"><img src="../Images/e856d565d58351a7f75f0a26b862cfc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nfb555SgNDoJERXaaQoM2Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="e193" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么攻击场景是什么？</p><h1 id="ebaf" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">攻击场景:</h1><ol class=""><li id="692f" class="mb mc iq jp b jq lw ju lx jy mu kc mv kg mw kk mg mh mi mj bi translated">攻击者从他的burp collaborator URL保存他的个人资料图片。</li><li id="7274" class="mb mc iq jp b jq mx ju my jy mz kc na kg nb kk mg mh mi mj bi translated">攻击者向受害者发送他的推荐链接。</li><li id="159a" class="mb mc iq jp b jq mx ju my jy mz kc na kg nb kk mg mh mi mj bi translated">受害者打开推荐网址(由于推荐链接属于redacted.com的其中一个子域，所以受害者肯定会打开)嘣！受害者的私人信息将被发送给攻击者。</li></ol><h1 id="c861" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第二个漏洞:</h1><p id="71a9" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我在我的ngrok服务器上托管了一个poc.svg文件，该文件包含以下内容:</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="de6f" class="nh kz iq nd b gy ni nj l nk nl">&lt;?xml version="1.0" standalone="no"?&gt;<br/>&lt;!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "<a class="ae kl" href="http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" rel="noopener ugc nofollow" target="_blank">http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd</a>"&gt;&lt;svg version="1.1" baseProfile="full" ae kl" href="http://www.w3.org/2000/svg" rel="noopener ugc nofollow" target="_blank"&gt;http://www.w3.org/2000/svg"&gt;<br/>&lt;polygon id="triangle" points="0,0 0,50 50,0" fill="#009900" stroke="#004400"/&gt;<br/>&lt;script type="text/javascript"&gt;<br/>alert(document.domain);<br/>&lt;/script&gt;<br/>&lt;/svg&gt;</span></pre><p id="8645" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而且我把我的个人资料图片网址换成了poc.svg文件的网址(https://xyz.ngrok.io/poc.svg)。然后，我只需右键单击个人资料图片，并复制网址。我注意到是<a class="ae kl" href="https://img.redacted" rel="noopener ugc nofollow" target="_blank">https://img . redated</a>。这意味着他们从我的服务器上获取了poc.svg文件。我迅速将链接粘贴到我的浏览器上，然后嘣！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nm"><img src="../Images/bb589c811bd79ba85f2cd088af54e6cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YX9L2BSsPi0I3zNvYg_p4g.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="1bdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我赶紧做了一个poc，向他们汇报。</p><h1 id="8490" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第三个漏洞:</h1><p id="d97f" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">在检查了一些特性之后，我转到了更改密码部分。该请求看起来像是:</p><pre class="kn ko kp kq gt nc nd ne nf aw ng bi"><span id="45bd" class="nh kz iq nd b gy ni nj l nk nl">POST /api/oauth.updatePassword HTTP/1.1<br/>Host: app.redacted.com<br/>User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0<br/>Accept: application/json<br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Authorization: Bearer D5FC5XXXX<br/>x-csrf-token: uXvbmXXXX<br/>Content-Type: application/json<br/>Content-Length: 56<br/>Origin: <a class="ae kl" href="https://app.redacted.com" rel="noopener ugc nofollow" target="_blank">https://app.redacted.com</a><br/>Connection: close<br/>Referer: <a class="ae kl" href="https://app.redacted.com/account" rel="noopener ugc nofollow" target="_blank">https://app.redacted.com/account</a><br/>Cookie: XYZ=ABC; PQR=DSPH</span><span id="f17d" class="nh kz iq nd b gy nn nj l nk nl">{"password":"NewPassword","revokeSessions":true,"client":"ABWeb"}</span></pre><p id="d52d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在尝试了一些漏洞后，我试图将密码改为null，我看到了一些有趣的事情:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi no"><img src="../Images/296af089d97a65fb9d865448a47834b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PLQcytou-00cNpBbf_MbpA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">tuhin1729</figcaption></figure><p id="1d95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看响应时间；504网关超时为30，460毫秒！！！发生了一些事情。</p><p id="3041" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很快向他们报告了这三个问题，几天后，我得到了他们的回复，并得到了一笔$美元的奖金。</p><h2 id="04ce" class="nh kz iq bd la np nq dn le nr ns dp li jy nt nu lm kc nv nw lq kg nx ny lu nz bi translated">时间线:</h2><p id="0b06" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">2021年6月6日—报告第一个漏洞<br/>2021年6月6日—请求影响<br/>2021年6月8日—发现并报告漏洞利用<br/>2021年6月8日—报告第二个漏洞<br/>2021年6月11日—报告第三个漏洞<br/>2021年6月13日—审判<br/>2021年6月15日—回复赏金邮件</p><p id="4448" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Twitter上关注我:@ <a class="ae kl" href="https://twitter.com/tuhin1729_" rel="noopener ugc nofollow" target="_blank"> tuhin1729 </a> _</p><p id="9e16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。我希望你喜欢这个博客。</p></div></div>    
</body>
</html>