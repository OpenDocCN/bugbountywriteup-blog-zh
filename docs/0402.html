<html>
<head>
<title>When I found iframe injection and illegal redirect (dom based)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">当我发现iframe注入和非法重定向(基于dom)时</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/when-i-found-iframe-injection-and-illegal-redirect-dom-based-cfbbcec21a7?source=collection_archive---------0-----------------------#2019-10-25">https://infosecwriteups.com/when-i-found-iframe-injection-and-illegal-redirect-dom-based-cfbbcec21a7?source=collection_archive---------0-----------------------#2019-10-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="2bb8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">iFrame注入是一种非常常见的跨站点脚本(或XSS)攻击。它由一个或多个插入到页面或帖子内容中的iFrame标记组成，通常会下载可执行程序或执行其他危及网站访问者计算机安全的操作。在最好的情况下，谷歌可能会给这个网站贴上“恶意”的标签。最糟糕的情况是网站所有者和访问者最终拥有被恶意软件感染的计算机。</p><p id="2212" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">框架注入，当易受攻击的网页上的框架通过用户可控制的输入显示另一个网页时发生。</p><p id="7639" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">GET /search.jsp？query = % 3c iframe % 20 src = % 22 https://Google . com/？%22%3E%3C/iframe%3E HTTP/1.1 <br/>主机:***。网</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/5bfbd71d67324c91342d4739f95cab0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HUtjRWSvhqA6iBKw4CX4Zg.png"/></div></div></figure><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="9f59" class="lf lg it lb b gy lh li l lj lk">&lt;/iframe&gt;&lt;iframe src="vbscript:msgbox(1)"&gt;&lt;/iframe&gt; (IE)&lt;iframe src="data:text/html,&lt;script&gt;alert(0)&lt;/script&gt;"&gt;&lt;/iframe&gt; (Firefox, Chrome, Safari)</span></pre><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/b9f7f06bdc44e29f5af8defcc66b810a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*HEdw9AtyRiojmaNirzmIUw.png"/></div></figure><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="94ac" class="lf lg it lb b gy lh li l lj lk">&lt;iframe src="vbscript:msgbox(1)"&gt;&lt;/iframe&gt; (IE)</span><span id="8ec0" class="lf lg it lb b gy lm li l lj lk">  &lt;iframe src="javascript:alert(1)"&gt;</span><span id="6ff8" class="lf lg it lb b gy lm li l lj lk">&lt;/iframe&gt;&lt;iframe src="vbscript:msgbox(1)"&gt;&lt;/iframe&gt; (IE)&lt;iframe src="data:text/html,&lt;script&gt;alert(0)&lt;/script&gt;"&gt;&lt;/iframe&gt; (Firefox, Chrome, Safari)</span><span id="8b05" class="lf lg it lb b gy lm li l lj lk">&lt;iframe src="data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg=="&gt;&lt;/iframe&gt; (Firefox, Chrome, Safari)</span><span id="256d" class="lf lg it lb b gy lm li l lj lk">http://target.com/something.jsp?query=&lt;script&gt;eval(location.hash.slice(1))&lt;/script&gt;#alert(1)</span></pre><p id="5230" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">接受用户提供的数据作为iframe源URL可能会导致在Visualforce页面中加载恶意内容。</p><p id="c90c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在以下情况下会出现帧欺骗漏洞:</p><p id="09fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">1.数据通过不可信的来源进入web应用程序。</p><p id="f513" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">2.数据未经验证就被用作<code class="fe ln lo lp lb b">iframe</code> URL。</p><p id="ae12" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这样，如果攻击者向受害者提供设置为恶意网站的<code class="fe ln lo lp lb b">iframesrc</code>参数，该帧将呈现恶意网站的内容。</p><pre class="kp kq kr ks gt la lb lc ld aw le bi"><span id="571b" class="lf lg it lb b gy lh li l lj lk">&lt;iframe src="http://evildomain.com/"&gt;</span></pre><p id="bf16" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">(2)重定向(基于DOM)</p><p id="ab96" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">基于DOM的开放重定向漏洞。当网页通过用户控制的输入被重定向到另一个域中的另一个URL时，发生开放重定向。</p><p id="95fc" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">网址:https://*******。net/index.htm？url=http://evil.com/？original _ URL/<br/>参数名称:url <br/>参数类型:GET <br/>模式:http://evil.com/？original _ URL/</p><p id="07b9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">影响<br/>攻击者可以利用该漏洞将用户重定向到其他恶意网站，这些网站可用于网络钓鱼和类似的攻击。</p><p id="ea2f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">额外:<br/>在可能的情况下，不要使用用户输入的URL。如果你确实需要动态URL，使用白名单。列出有效的、可接受的网址，不接受其他网址。<br/>确保您只接受位于受信任域的URL。<br/>外部引用。</p><p id="995a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">http参数可能包含URL值，并可能导致web应用程序将请求重定向到指定的URL。通过修改恶意站点的URL值，攻击者可以成功发起网络钓鱼诈骗并窃取用户凭据。因为修改后的链接中的服务器名称与原始站点相同，所以网络钓鱼企图看起来更可信。</p></div><div class="ab cl lq lr hx ls" role="separator"><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv lw"/><span class="lt bw bk lu lv"/></div><div class="im in io ip iq"><p id="1826" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><em class="lx">关注</em> <a class="ae ly" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="lx"> Infosec报道</em> </a> <em class="lx">获取更多此类精彩报道。</em></p><div class="lz ma gp gr mb mc"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="md ab fo"><div class="me ab mf cl cj mg"><h2 class="bd iu gy z fp mh fr fs mi fu fw is bi translated">信息安全报道</h2><div class="mj l"><h3 class="bd b gy z fp mh fr fs mi fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="mk l"><p class="bd b dl z fp mh fr fs mi fu fw dk translated">medium.com</p></div></div><div class="ml l"><div class="mm l mn mo mp ml mq ky mc"/></div></div></a></div></div></div>    
</body>
</html>