<html>
<head>
<title>P4 CTF: Apfel Seite</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">P4·CTF:阿普费尔·塞特</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/p4-ctf-apfel-seite-6eb03b7b60d7?source=collection_archive---------2-----------------------#2022-11-07">https://infosecwriteups.com/p4-ctf-apfel-seite-6eb03b7b60d7?source=collection_archive---------2-----------------------#2022-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/5b0fe86e33c7471e0ad000fc3e4930f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*A1Z4teMVkCOc32oG90KItQ.png"/></div></figure><p id="c88f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是我为p4 CTF的apfles seite web exploitation challenge撰写的文章。在这个挑战中，我们需要检查apple store网站，寻找任何漏洞。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ks"><img src="../Images/03fb7d4754b612459a084c1ff37a0349.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ECaY7MrHI0Xb1GilU9P0Uw.png"/></div></div></figure><p id="8dfc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，我们访问他们给我们的URL，我们可以看到四个导航按钮。我们可以按下它们中的任何一个来查看在“apfel_selection”参数中带有“description.txt”路径的页面。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lb"><img src="../Images/dc141167bbb0b3dd8ff576924672522b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XxqbbXbUq43tc1ZNrQy_Rg.png"/></div></div></figure><p id="1d9d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以尝试将该值更改为另一个文件，以确认我们是否进行了路径遍历。为此，我们尝试读取文件/etc/passwd。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lc"><img src="../Images/410e215515e5f989cae8a17145c49405.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CwBOcfWPzbDEyiX9p1whAQ.png"/></div></div></figure><p id="8641" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以看到，我们可以使用绝对路径，但如果我们从我们的位置尝试相对路径”../../../../../../../../etc/passwd "我们得到以下错误消息。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ld"><img src="../Images/15368691fe21953e0b02ca049f38daac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W3VP368Q7KzgJcCo4tCq3g.png"/></div></div></figure><p id="a6b3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">要查看此消息的原因，我们可以通过漏洞读取页面的index.php来访问服务器代码。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi le"><img src="../Images/36f086d39aa5f8096aec7004bb2ac010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*90ZsPLR4-gAoFLmUIth5pA.png"/></div></div></figure><p id="3f55" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们使代码更容易阅读和更详细地分析。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lf"><img src="../Images/b84c2c4e09b36799c5f1831fbdf6d219.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EKrkl7ezLDYzgkMteyaNtg.png"/></div></div></figure><p id="9373" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们看到它用“..”过滤输入这就是它给出这个错误的原因。但是我们仍然不知道旗子在哪里。在尝试了从遍历路径获得代码执行并枚举所有标准文件的常用方法后，我在解决挑战方面没有取得任何进展。</p><p id="96bc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我决定休息一下，通过总结我们所拥有的，给出一个新的和不同的方法来应对挑战:</p><ul class=""><li id="2e7e" class="lg lh iq jw b jx jy kb kc kf li kj lj kn lk kr ll lm ln lo bi translated">苹果主题挑战。</li><li id="810c" class="lg lh iq jw b jx lp kb lq kf lr kj ls kn lt kr ll lm ln lo bi translated">路径遍历。</li><li id="7472" class="lg lh iq jw b jx lp kb lq kf lr kj ls kn lt kr ll lm ln lo bi translated">未知的标志位置。</li></ul><p id="f274" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后我想起了我的第一次试验，客户暴露了。DS_Store文件，由于这个原因，我们在服务器上发现了一系列文件。我做了测试，有文件:</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lu"><img src="../Images/577d4fa81170381ce15f621d21c20629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3YlTCHxw465B6YI6iD5Uhw.png"/></div></div></figure><p id="1580" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果我们下载并解析该文件，我们会看到在根目录下只有apfels目录。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lv"><img src="../Images/7953f81d5b4cfe40d2911e46e39b597e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SU4rhitVUZC6fjXfTsAInA.png"/></div></div></figure><p id="e8ca" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在让我们来看看<em class="lw">。DS_Store </em>在apfels目录里面。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lx"><img src="../Images/e332cf0e192e6761ecaae34015afef20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OykiTmA7d7z-Boc27mjhmg.png"/></div></div></figure><p id="28da" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以看到大量的目录，进入和下载<em class="lw">。每一个的DS_Store </em>看起来都是一个繁琐的任务。因此，我们将在BurpSuite的帮助下实现自动化，特别是针对入侵者。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi ly"><img src="../Images/59a67318ea919963650a8d78d1fa942d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFaBpzSO3-E_34oLfmqtpg.png"/></div></div></figure><p id="b46d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，我们可以看到其中一个与其他的有显著的不同:</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi lz"><img src="../Images/594554e3039c42b043949c66555975cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*if-tVTzXhtkLS9eh1ClD7w.png"/></div></div></figure><p id="c18b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以下载<em class="lw">。DS_Store </em>并提取带有标志的文件名。</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/d4d536b8debf4bd7b5580dacf06f1cdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*K0b-C6iOI4zFffr-dlAsjQ.png"/></div></figure><p id="59a0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，我们可以读取标志文件并获得这些点:</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="kx ky di kz bf la"><div class="gh gi mb"><img src="../Images/72ca90846d877727d71dd69b068cdb8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lpM0CKfiU2TeAnKSV6v1MA.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk translated"><strong class="bd mg"> GG！</strong></figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="9bc3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我希望你喜欢我的文章，并发现我的内容有用。下一篇文章再见。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="e5d3" class="mo mp iq bd mg mq mr dn ms mt mu dp mv kf mw mx my kj mz na nb kn nc nd ne nf bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ng" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>