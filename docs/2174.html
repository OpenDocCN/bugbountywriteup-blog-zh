<html>
<head>
<title>RouterSpace From Hackthebox</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客盒子的路由器空间</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/routerspace-from-hackthebox-74de4a9ba988?source=collection_archive---------2-----------------------#2022-07-09">https://infosecwriteups.com/routerspace-from-hackthebox-74de4a9ba988?source=collection_archive---------2-----------------------#2022-07-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f296" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">Android漏洞和sudo漏洞</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/105bbb480a2a9e6e9ab5647ce3571372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*22WmpsXkbDC4uOTga32VRg.png"/></div></div></figure><p id="32c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">大家好，我是Hac，今天我们将讨论Hackthebox的路由器空间，这是一个很容易退役的Linux盒子，你必须利用<strong class="kt ir"> Android </strong>应用程序在盒子上获得最初的立足点，然后我们将使用<strong class="kt ir"> sudo </strong>漏洞将你的权限升级为root用户。</p><p id="4694" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">我们需要的工具:</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="ee2a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将从Nmap扫描开始</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="9e87" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有两个端口开放22 (ssh)和80 (http)。像往常一样，我们将开始查看端口80。因为它的攻击面更大。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lp"><img src="../Images/1bd819788f60337147e68560f16d6bf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwroL1WLL8H2H7nhINhjGA.png"/></div></div></figure><p id="ddfe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们还可以下载按钮“RouterSpace.apk ”,它看起来很有趣。我们可以用apk文件做很多事情。在CTF，我们可以使用像<a class="ae lq" href="https://github.com/MobSF/Mobile-Security-Framework-MobSF" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> Mobsf </strong> </a>这样工具来寻找“代币或凭证”,或者我们可以使用像<a class="ae lq" href="https://github.com/iBotPeaches/Apktool" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> apktool </strong> </a>、<a class="ae lq" href="https://www.kali.org/tools/dex2jar/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> dex2jar </strong> </a>和<a class="ae lq" href="https://github.com/skylot/jadx" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> jadx </strong> </a>这样的工具来进行人工处理。</p><p id="a4bf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">Android应用程序分析主要有两种方法</p><p id="8136" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">1-静态分析</p><p id="4d85" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2-动态分析</p><div class="lr ls gp gr lt lu"><a href="https://www.cism.ucl.ac.be/Services/Formations/ICS/ics_2013.0.028/inspector_xe/documentation/en/help/GUID-E901AB30-1590-4706-94B1-9CD4736D8D2D.htm" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">动态分析与静态分析</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">动态分析是在运行时对应用程序的测试和评估。静态分析是测试和…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">www.cism.ucl.ac.be</p></div></div></div></a></div><p id="fbf2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将尝试这两种方法，因为我们对apk了解不多。通常我从静态分析开始。</p><p id="703c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但在此之前，我们需要知道<strong class="kt ir">apk到底是什么</strong>。“Apk”是android操作系统用于分发Android应用程序的文件格式。现在我们需要知道<strong class="kt ir"> Apk </strong> <strong class="kt ir">就像一个zip文件</strong>，是的，我们可以通过使用像<strong class="kt ir"> unzip </strong>这样的工具<strong class="kt ir">解压</strong>。</p><p id="411e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">静态分析</strong></p><p id="6321" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以解压缩文件，然后使用dex2jar进行转换”。dex“文件另存为”。压缩为“jar”的“类”文件</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi md"><img src="../Images/0b778268e3c859d65809a55549ef4ff0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mw64e5vGtbl6i9JpO5t6QQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">解压缩RouterSpace.apk</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/bda8fb29781942666cd04f07dbc10b0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1CKNAYV5rxDUv_UDOJaocw.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">d2j-dex2jar classes.dex</figcaption></figure><p id="1be5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我们可以拉开拉链了”。罐子”。并寻找感兴趣的文件/目录，如<strong class="kt ir"> AndroidManifest.xml </strong>和smali代码。但对于最初的立足点，我们需要动态分析，所以我们不会深入到静态分析部分。</p><p id="e6d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">动态分析</strong></p><p id="fb5b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你是第一次这样做，我可能会很棘手。但是相信我，这很容易，如果你在使用谷歌时出错，请记住一件事。说完了，让我们开始这一部分。</p><p id="0d4c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们需要<a class="ae lq" href="https://www.genymotion.com/" rel="noopener ugc nofollow" target="_blank"> genymotion </a>作为android模拟器，然后我们需要配置我们的burp套件，以便拦截HTTP请求。如果你已经完成了设置你的android实验室的详细步骤。因此，继续检查这篇文章，以便入侵。</p><div class="lr ls gp gr lt lu"><a rel="noopener  ugc nofollow" target="_blank" href="/manager-from-hackthebox-b93aecbd46dd"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">建立一个安卓黑客实验室</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">Android开发简介的一部分</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">infosecwriteups.com</p></div></div><div class="mj l"><div class="mk l ml mm mn mj mo kp lu"/></div></div></a></div><p id="8e56" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦我们完成设置，我们将打开android应用程序并点击“检查状态”按钮。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/8de51cb7d6be92d26ba29403d79ac596.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*XDxCRU99TvdscieYb0EgkQ.png"/></div></figure><p id="8155" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您的代理/设置正确，我们应该会收到此请求。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/e8106f371fd78b63e66fe5b42b878125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*qPP6pOCILk4XQKaIOKAwig.png"/></div></figure><p id="ba7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我做了一些改变，我能够执行系统命令。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/1be1229138a87e68174d45270189841b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x-BwPNZr2AXPYZ79ZcxetA.png"/></div></div></figure><p id="30bf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我尝试使用revershell，但是好像有什么东西(防火墙)阻挡了我们的请求。我做了一些枚举，发现我们对/home/paul/有写权限。嘘。我将我的公钥添加到了<code class="fe ms mt mu mv b">/home/paul/.ssh/authorized_keys</code></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/e728f16dc82d3b0151981d72b8678772.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAbFW7OoXrMslTXYFvLZjA.jpeg"/></div></div></figure><p id="f3c4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我通过ssh登录</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/9871d9bb6388865dddcb9d4a41b7a39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NWDErLpVNQOn-_bgrFK-xA.png"/></div></div></figure><p id="39a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在我运行Linpeas来找出在这个盒子上找到根的可能方法。我发现了一个根漏洞。</p><pre class="kg kh ki kj gt mx mv my mz aw na bi"><span id="41f0" class="nb nc iq mv b gy nd ne l nf ng">sudo-1.8.31 </span></pre><div class="lr ls gp gr lt lu"><a href="https://github.com/mohinparamasivam/Sudo-1.8.31-Root-Exploit" rel="noopener  ugc nofollow" target="_blank"><div class="lv ab fo"><div class="lw ab lx cl cj ly"><h2 class="bd ir gy z fp lz fr fs ma fu fw ip bi translated">GitHub-mohinparamasivam/Sudo-1 . 8 . 31-Root-Exploit:CVE的Root shell PoC-2021-3156</h2><div class="mb l"><h3 class="bd b gy z fp lz fr fs ma fu fw dk translated">CVE根壳PoC-2021-3156(无暴力),用于教育等目的。在Ubuntu 20.04上针对sudo测试…</h3></div><div class="mc l"><p class="bd b dl z fp lz fr fs ma fu fw dk translated">github.com</p></div></div><div class="mj l"><div class="nh l ml mm mn mj mo kp lu"/></div></div></a></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/a54a6e28014231ce1deb06f73dfa8b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WoCwHhSzKzrtE20pnNjjnw.png"/></div></div></figure></div></div>    
</body>
</html>