<html>
<head>
<title>Guessy challenge writeup wtftime CTF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">猜猜挑战与时间CTF写</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/guessy-challenge-writeup-wtftime-ctf-43417f9caa?source=collection_archive---------0-----------------------#2019-12-22">https://infosecwriteups.com/guessy-challenge-writeup-wtftime-ctf-43417f9caa?source=collection_archive---------0-----------------------#2019-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="478a" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我们参加了危险风格的wtftime ctf。猜谜是杂项类别的挑战之一。我从这个挑战中学到了一个非常微妙但很好的技巧。所以，这篇文章让我们直接进入主题。</p><p id="3c50" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">http://wtftime.org CTF网址:<a class="ae kp" href="http://wtftime.org" rel="noopener ugc nofollow" target="_blank"/></p><p id="6a66" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">https://ctftime.org/event/949<a class="ae kp" href="https://ctftime.org/event/949" rel="noopener ugc nofollow" target="_blank">CTF时间网址</a></p></blockquote><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/0232d0bd2d6e3dccaaaa2abf60546c21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLDJ4foJUppSSERCxAjOXw.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">挑战陈述</figcaption></figure><p id="6f03" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">在问题陈述中没有太多的细节，只有一个IP和端口使用nc连接，也就是给出了一个netcat。于是，我赶紧连接，看看它输出的是什么。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/68743a4ab82db53c0023a1540e6632c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/1*s52O_M-5R-gyEPJYznS5bw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">北卡罗来纳州138.68.96.149 4422</figcaption></figure><p id="e6df" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">因此，我们建立了连接，它转储了一个python文件，每当我们连接到这个IP和端口时，就会执行这个文件。随着我开始理解代码，一些有用的观察是，这是一个python2代码，我们可以在第一行中发现。其次，它打印正在执行的文件。然后是try块，我们的标志被存储到路径<strong class="jt ir"><em class="js">"/opt/flag . txt "</em></strong><em class="js"/>中的一个文件中，并被加载到一个名为<em class="js"> flag </em>的变量中。现在，通过input()函数获取用户输入，并与加载的文件变量进行比较。如果您猜中了正确的标志，它将打印“<strong class="jt ir">正确！</strong>"并退出。</p><p id="2754" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">因此，暴力或猜测正确的标志不可能是这里显而易见的方法。最初我想到了缓冲区溢出的想法，但在这里行不通。我在本地玩了这个脚本，因为我们有完整的代码，有些东西就在我脑海里。我在输入中给出了字符串“flag ”,它正确地打印出来了！</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/b1c76b7ab4a840bca9915ea958dbbe77.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*qqEZKj7MykMlAS0WnHRIWg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">将字符串标记为输入</figcaption></figure><p id="ce89" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">这很奇怪，因为flag显然不是正确答案。所以，一些谷歌搜索和我偶然发现这里发生了什么。</p><h1 id="d5c8" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">虫子</h1><p id="3874" class="pw-post-body-paragraph jq jr iq jt b ju mj jw jx jy mk ka kb lg ml ke kf lh mm ki kj li mn km kn ko ij bi translated">挑战代码中唯一有趣的事情是用于接受用户输入的<em class="js"> input() </em>函数。我知道python2中的input函数不执行<strong class="jt ir">类型的杂耍</strong>，而是原样接受输入。因此，我们可以给它的字符串，数字，甚至变量名。有意思吧！！鉴于<em class="js"> raw_input() </em>确实执行类型杂耍并将您的输入转换为<strong class="jt ir"> str </strong>类型。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/2287e6a14e55bcddaf5a27a7033f9cb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:688/format:webp/1*ZpabkkWdKN2tziCB0HZ5TA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">原始输入()</figcaption></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/da1962884eeed3b641f23d906f590daa.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*c740WCKcRHVgbTiEn3vTKg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">输入()</figcaption></figure><p id="f90c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">这里，我们在输入中给出了变量名，当它与字符串<em class="js">“secret _ code”进行比较时，变量名进入if循环。</em>那么<em class="js">，</em>现在我们知道我们可以把任何值传递给这个变量，它将在内部被处理。在更多的磕磕绊绊中，我开始了解python的内置函数。这是python中的一些函数，可以用来执行各种操作。所以，我把它们都打印出来了，其中一个是我们用的:)</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi mq"><img src="../Images/f520976dc4cac350780f7ebe2ff8bca9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnUUZGQ4Bbl3xsvgAzsnGg.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">内置函数</figcaption></figure><p id="f29e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">使用<em class="js"> __import__ </em>我们可以在python代码中加载模块。从这里开始，这是一个非常直接的挑战。现在，我们可以导入操作系统模块，并在目标上生成一个shell，并获取标志。</p><blockquote class="jn jo jp"><p id="526e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">输入的最终有效负载:_ _ import _ _(“OS”)。系统(“sh”)</p></blockquote><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/ada95be4f5a19da4c6970b59bc3239c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:902/format:webp/1*F3yaJPp_zSeJQDMGqO9dwA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk translated">拿到旗子</figcaption></figure><p id="497e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">所以，这是一个小小的挑战，但它让我学会了<em class="js"> raw_input() </em>和<em class="js"> input() </em>之间的细微差别。希望你也学到了新的东西。总的来说，CTF非常好。</p><p id="d7d3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated"><strong class="jt ir">我们的队伍dark_phoenix以第14名的成绩结束了比赛，来自印度的第一队在积分榜上xD </strong></p><p id="ede7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">下次见，祝你愉快:)黑客快乐！！！！</p></div><div class="ab cl ms mt hu mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ij ik il im in"><p id="ea7d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated"><em class="js">关注</em> <a class="ae kp" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="js"> Infosec报道</em> </a> <em class="js">获取更多此类精彩报道。</em></p><div class="mz na gp gr nb nc"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">信息安全报道</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">medium.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq la nc"/></div></div></a></div></div></div>    
</body>
</html>