# 关键 Bug 奖励报告:第 1 部分

> 原文：<https://infosecwriteups.com/critical-bug-bounty-reports-part-1-6fd9aef4b486?source=collection_archive---------0----------------------->

## 我提交给赏金项目的关于 P1/重大错误的简短报道

![](img/a4697e9fad59c83299ddeabcb7be0c85.png)

Bugcrowd 的 P1 勇士徽章系列-2 级徽章，授予在任何程序中提交 5 份有效 P1 作品的黑客

这个月标志着我正式开展 Bug 赏金狩猎两年了，我的第一份报告于 2019 年 7 月 27 日提交给了 Bugcrowd 上的一个项目。那份报告被打上了`Not Applicable`的标记，直到今天，我真的很困惑这家公司还没有修复它。我接着写了一份标记为`P4 / Informational`的报告，涉及一个带有暴露的`web.config`文件的子域。令人兴奋的东西(不尽然)。我的前 10 份报告的平均严重性评级为 3.7，其中 1 份不适用，5 份信息性，其余 4 份合格。

今天，我凭借 134 个公认的漏洞(包括 20 个 P1 漏洞)进入了 Bugcrowd 有史以来排名的前 200 名。回顾我的第一份报告，我惊讶地发现我在发现严重漏洞和编写令人信服的报告以充分发挥影响(或为什么公司应该关注)方面取得了如此大的进步。在我相对较短的经历中，我发现影响驱动的严重性不亚于甚至有时超过脆弱性的级别。考虑到这一点，我决定分享我在过去两年中提交给 Bug Bounty 计划的所有关键严重性 Bug 的高水平文章，目的是帮助您将您的搜索提升到一个新的水平。

# **1。通过未验证的安全问题重置帐户接管**

这是我的第一个 P1，也是许多 CTF 教授的经典 bug。很明显，当我设置一个自动暗示 P1 的漏洞等级时，我总是很兴奋，但我相信我可能会因为这个而紧张兴奋得发抖——这是我的第一次。这是一个刚刚开放的私人项目，是当时我受邀参加的少数几个项目之一。在此之前，我提交了 17 份报告，只有 10 份被接受——要么是 P3/中等，要么是 P4/低。

我在测试身份验证、密码重置和用户配置文件流时发现了这个漏洞，它允许攻击者通过篡改参数来重置受害用户的安全问题和答案。应用程序没有依赖会话，而是在帖子中包含了用户名，类似于`security_question=hacked&security_answer=hacked&username=victim_account`。这不是跨站点伪造请求(CSRF)来欺骗用户更改他们自己的问题和答案——任何用户都可以为任何其他用户提交新的安全问题和答案。更糟糕的是，密码重置流程只要求您在提示您设置新密码之前提供安全答案，这意味着一旦您完成了重置受害者问题和答案的利用，您就可以注销并重置受害者的密码，从而完成帐户接管。

**日期:**2019 年 11 月 7 日

**漏洞:**中断认证和会话管理>绕过认证

# 2.通过创建新帐户获得完全的客户帐户访问权限

第二个 P1 和第一个一样是在同一个私人项目上狩猎。这个应用程序是一个企业对企业的网站，企业可以在其中建立一个帐户，并授予不同的用户访问该帐户的权限。新用户可以自助注册，但需要提供企业的账号和相关的邮政编码。利用之前在已完成订单上发现的不安全直接对象引用(IDOR)漏洞，我能够列举有效的账号和相关企业的名称，但不能列举它们的地址。

幸运的是，很容易在 Google 上找到提供所需邮政编码的企业，但我也发现缺乏速率限制，允许我使用 Burp Intruder 重复提交表单，最终使用大约 42，000 个有效的美国邮政编码强行获得答案。一旦表单成功返回，我就可以登录并访问该企业的完整帐户信息，代表他们提交订单，等等。

**日期:**2019 年 11 月 14 日

**漏洞:**中断认证和会话管理>绕过认证

# **3。RCE 在<域>上通过 AEM ACS 工具篡改使用默认凭证**

我对 HackerOne 的第一次批判！出于某种原因，我没有在那里花太多时间，但一个程序引起了我的注意，因为我使用了 Adobe Experience Manager (AEM ),而 0ang3el 没有在那里向他们展示他们的错误。多亏了他的扫描仪，我很快发现了一个操作系统命令注入漏洞，并执行了各种概念验证命令`whoami`和`cat /etc/passwd`。我花了相当多的时间关注 0ang3el 对 AEM 的研究，虽然这是一个免费的程序，但它是我迄今为止报告过的最容易的错误之一。这也是我第一次看到一家公司在分类小组审查发现之前就实施修复。

**日期:**2020 年 7 月 31 日

**漏洞:** OS 命令注入

# **4。RCE 在<另一个域>上通过 AEM ACS 工具篡改使用默认凭证**

在大范围的程序中，有一个发现的地方通常会有更多的发现。我的扫描仪发现了第二个同样漏洞的例子。

**日期:**2020 年 7 月 31 日

**漏洞:**操作系统命令注入

# **5。完整的客户信息披露**

尽管我在 2020 年上半年取得了一定的成功，但从 7 月底到 8 月初，情况确实有所好转。这个 bug 是 4p 1 中的第一个，是在一家财富 500 强公司的大型私人项目中提交的 31 个项目中提交的，在这个项目中，我真正开始成为一名 Bug 赏金猎人。

该公司有各种未经验证的工作流，需要半私有的用户信息，如用户的电话号码和出生日期。我本人不是该公司的客户，但有一个好朋友同意让我使用他的信息。他的电话号码和出生日期暴露了第三条关键信息，我们称之为 widgets。使用他的名、姓、电话号码、出生日期和关于小部件的信息，我可以访问一个请求表单。在后台，这个表单与一个类似于`[https://domain.com/api/v1/widget/123456](https://domain.com/api/v1/widget/123456.)`的基于 JSON 的 REST API 交互。方便的是，当客户端 Javascript 触发请求时，它会将一个 API 键附加到一个自定义头中(因为用户没有经过身份验证，所以应用程序不能依赖于会话)。从那里开始，一个简单的参数篡改来增加 URL 暴露了 IDOR——这是一个返回完整客户信息的大事件，相当于访问他们的数据库。

**日期:**2020 年 8 月 5 日

**漏洞:**破坏访问控制(BAC) >不安全的直接对象引用(IDOR)

# 第 1 部分总结

我花了一年多的时间在 Bugcrowd 和 HackerOne 上获得了 5 个关键的提交。虽然其中两个是通过简单地运行扫描器识别出来的，但另外两个需要链接较小的漏洞来暴露访问和完成最终利用所需的必要数据。没有一个漏洞是过度技术性的，但 3 个逻辑错误都需要一点测试，并最终知道去哪里找。

在接下来的几周中，我会仔细阅读第 2、3 和 4 部分，这三部分将分别涵盖另外 5 个关键漏洞，因为我已经完成了迄今为止所有 20 个关键的提交。

我在社交媒体上不太活跃，但你可以在 LinkedIn、T2、Bugcrowd 或各种安全漏洞或不和谐的服务器上找到我！