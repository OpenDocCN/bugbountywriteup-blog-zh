<html>
<head>
<title>The OAuth Misconfiguration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OAuth错误配置</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/the-oauth-misconfiguration-15e66dd19a6e?source=collection_archive---------1-----------------------#2022-01-18">https://infosecwriteups.com/the-oauth-misconfiguration-15e66dd19a6e?source=collection_archive---------1-----------------------#2022-01-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="f1e6" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">向OAuth服务注册您的客户端应用程序</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/0f6a768e3afa0f1c81ce2553a3f9faf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QIS_bctcWcDq18wr"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">克拉克·蒂布斯在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><h2 id="214d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">101简介</h2><h2 id="2851" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">什么是OAuth？</strong></h2><p id="d199" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">OAuth 2.0<strong class="lx iu">是Web应用</strong>的授权框架。它向请求它的网站验证用户的身份，而不泄露网站的密码。</p><h2 id="eec3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">什么是OAuth错误配置？</h2><p id="7d98" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">最臭名昭著的基于OAuth的漏洞是当<strong class="lx iu">OAuth服务本身的配置使攻击者能够窃取授权码或访问与其他用户账户相关的令牌</strong>。通过窃取有效的代码或令牌，攻击者可能能够访问受害者的帐户。</p></div><div class="ab cl mo mp hx mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="im in io ip iq"><h1 id="aaf5" class="mv la it bd lb mw mx my le mz na nb lh jz nc ka ll kc nd kd lp kf ne kg lt nf bi translated">现实生活场景:</h1><p id="d257" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">几天前，我发现<em class="ng">Hotdomain.com</em>的android应用程序容易受到<em class="ng"> OAuth错误配置</em>的攻击。让攻击者侵入任何用户的账户。该漏洞可能危及任何用户帐户。</p><p id="918a" class="pw-post-body-paragraph lv lw it lx b ly nh ju ma mb ni jx md li nj mf mg lm nk mi mj lq nl ml mm mn im bi translated"><strong class="lx iu">描述:</strong><br/><em class="ng">Hotdomain.com</em>安卓应用没有在服务器端验证<strong class="lx iu">脸书</strong>“access _ token ”,这使得攻击者能够使用他自己的个人应用访问令牌来攻击任何帐户。</p><h2 id="fadd" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">易受攻击的请求/ </strong> HTTP请求<strong class="ak"> : </strong></h2><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="5021" class="pw-post-body-paragraph lv lw it lx b ly nh ju ma mb ni jx md li nj mf mg lm nk mi mj lq nl ml mm mn im bi translated">如上面的跟踪转储所示，这是用<strong class="lx iu"> Burpsuite </strong>发出的暴露具有漏洞的端点的请求的日志。</p><h2 id="4c7d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">复制步骤:</h2><p id="8f35" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">通过查看<em class="ng">行</em> <strong class="lx iu"> <em class="ng"> 17 </em> </strong>你可以看到你将不得不添加你的恶意访问令牌以便接管你想要的任何账户。</p><h2 id="f5e1" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">影响</h2><p id="06ba" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">通过生成一个随机访问令牌，并把它放在原来的位置，我能够获得受害者帐户的控制权。<strong class="lx iu">脸书</strong>访问令牌没有在服务器端得到验证。实际上，在登录脸书选项上，脸书应该为每个用户提供并验证一个唯一的访问令牌来登录这个应用程序。</p><h2 id="e5c3" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">修复建议:</h2><p id="7466" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated"><a class="ae ky" href="https://developers.facebook.com/docs/facebook-login/security" rel="noopener ugc nofollow" target="_blank">https://developers . Facebook . com/docs/Facebook-log in/security</a>T37】* *(OAuth流程中的Bug)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi no"><img src="../Images/1e3eb5e3cb0eae96b0e0d3e8d660567e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u1NHKKQdaUtVls0-KhcmaA.png"/></div></div></figure><p id="8fff" class="pw-post-body-paragraph lv lw it lx b ly nh ju ma mb ni jx md li nj mf mg lm nk mi mj lq nl ml mm mn im bi translated">看着上面的图片，我们可以看到报告的进展，它并不像我期待的那样。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi np"><img src="../Images/da2977492965af8fb4ee375456829c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NCA5AQ2OXTNTF0omp_mlBw.png"/></div></div></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/0cbb083c9d53555d606bcbc992554d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*m8S4PsmAB-VSQP1CW5aZ6Q.png"/></div></figure><p id="204b" class="pw-post-body-paragraph lv lw it lx b ly nh ju ma mb ni jx md li nj mf mg lm nk mi mj lq nl ml mm mn im bi translated">长话短说，如此处所示，我的报告是一长串报告中的一部分。其中android应用程序和web应用程序作为一个整体，是一份独特报告的一部分。这是因为两个应用程序使用了相同的代码。对我来说，这仍然是一个胜利，因为这是你可以在下一个目标中使用的东西。</p><h2 id="a396" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">总结:</h2><p id="cb32" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">为什么OAuth不利于认证？让我们从OAuth不是认证的最大原因开始:<strong class="lx iu">访问令牌不是为客户端应用程序</strong>设计的。当授权服务器发出访问令牌时，目标受众就是受保护的资源。…由受保护的资源来理解和验证令牌。</p></div></div>    
</body>
</html>