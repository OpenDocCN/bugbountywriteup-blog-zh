<html>
<head>
<title>Nullcon-HackIM CTF 2019- MLAuth-Misc(500)Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">nullcon-HackIM CTF 2019-MLAuth-Misc(500)报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/nullcon-hackim-ctf-2019-mlauth-misc-500-writeup-e6eb48c66341?source=collection_archive---------1-----------------------#2019-02-03">https://infosecwriteups.com/nullcon-hackim-ctf-2019-mlauth-misc-500-writeup-e6eb48c66341?source=collection_archive---------1-----------------------#2019-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="68ba" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><em class="iq">Tl；有很多关于这个挑战的报道，但是我写这个的原因是因为，我用了最少的努力完成了这个挑战。我只是用四个步骤解决了这个问题，这就是为什么写这篇文章的原因。:)</em></p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi kp"><img src="../Images/aea48b199033710090a56d6039df6c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*yxdlYj-hHFUPE367D2qu_g.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">挑战陈述</figcaption></figure><p id="b2f6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在Google Drive链接中下载给定的zip文件时，我得到了两个文件，一个是<em class="js"> get_prob.py </em>和<em class="js"> keras_model </em>。顾名思义，这个挑战与机器学习有关。keras_model是预训练的模型文件。在它上面运行文件命令时，显示它是<strong class="jt ir">分层数据格式。</strong>问题陈述被写在get_prob.py文件中，以及使用给定模型在本地检查概要文件真实性的代码中。</p><blockquote class="jn jo jp"><p id="10ec" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">一个组织使用机器学习实现了一个认证系统“mlAuth ”,准确率为99.9%。每个雇员都有一个配置文件(由784个十六进制值的字符串表示)。使用这些简档来训练mlAuth，以预测雇员的真实性的概率。只有当预测概率高于0.99时，系统才会授予访问权限。因此，您的目标是生成一个假的配置文件，欺骗99.9%准确的mlAuth授予您访问权限。</p></blockquote><p id="5797" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我以前没有处理军情局事务的经验。所以，我在keras模型上做了一个快速的谷歌搜索，并最终找到了如何可视化这个模型的方法。这将有助于理解模型的输入和权重。我使用python中keras库的plot_model函数来可视化模型。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi le"><img src="../Images/3da5943ed2a62e9f2f5a314dc8dc166b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*xHbnDs6iBPH8ZqY0F5Vx4w.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">输出图</figcaption></figure><p id="5e9b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">我现在被困住了，不知道下一步该做什么，配置文件值接受一个784字符长的十六进制数，最小值为0x0 (0)，最大值为0xff (255)。我打印了脚本的一些值。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/a4fbd65b782844de101882747492175b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j9eBOFthMhdlXfW-ZALp0g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">特征阵列</figcaption></figure><p id="bd14" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">它将十六进制转换为长度为785 ( 784从0开始)的列表，在googling上搜索后，我知道这是模型的特征。最后根据训练好的模型给出一个分数。我们需要一个十六进制配置文件，该文件给出的分数大于0.99xxx，以从服务器获取我们的标志。</p><p id="71b9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">想了一会儿，脑子里只有一个想法！！！！！</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/8ce6757d7439040cd59c917a172ad147.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*hBQYakyvE4Wqy-QcNgMl7g.jpeg"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">让我们开始吧！</figcaption></figure><p id="aa90" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">因此，想法是保持所有其他值静态，并强制从0x0到0xff的一个值，因此它将是784*256个组合。我告诉我的队友写一个剧本来写这个简介，他就开始写了。直到我认为让我试试明显的侧写。</p><h1 id="a6da" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">四步解决方案</h1><p id="7810" class="pw-post-body-paragraph jq jr iq jt b ju mj jw jx jy mk ka kb lb ml ke kf lc mm ki kj ld mn km kn ko ij bi translated">我开始测试明显的最小值和最大值，所以我做的第一个配置文件都是最小值。</p><pre class="kq kr ks kt gt mo mp mq mr aw ms bi"><span id="bd59" class="mt lm iq mp b gy mu mv l mw mx">profile = hex(0)*784</span></pre><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi my"><img src="../Images/339fd932e41ff6514a5a02926c43f493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dDlc1ZBkii5jUiULAs3bBQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">脚本中给定的配置文件</figcaption></figure><p id="6c7e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">在模型中搜索得到了这个。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/6128e9949c56342ad2217c885ea6a0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*n9ybpJa15KizN54k2wXRxw.png"/></div></figure><p id="136a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">第二次我把所有的值都作为最大值。</p><pre class="kq kr ks kt gt mo mp mq mr aw ms bi"><span id="9dc4" class="mt lm iq mp b gy mu mv l mw mx">hex(255) * 784 = predicted probability of authenticity is :0.9240912</span></pre><p id="7017" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">很好的改进。所以现在我把784/2 = 392除以一半的小于和一半的最大值。</p><pre class="kq kr ks kt gt mo mp mq mr aw ms bi"><span id="2bf5" class="mt lm iq mp b gy mu mv l mw mx">hex(0)*392 + hex(255)*392 = predicted probability of authenticity is :0.95876306</span></pre><p id="2821" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">很明显，我接近完美的轮廓，所以我进一步划分了这些值。784/4 = 196</p><pre class="kq kr ks kt gt mo mp mq mr aw ms bi"><span id="048b" class="mt lm iq mp b gy mu mv l mw mx">hex(0)*196+hex(255)*196+hex(0)*196+hex(255)*196 = 0.9999167</span></pre><p id="c041" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">答对了。在第四步，我得到了我们需要的配置文件，现在我们需要把它发送到服务器，标志是我们的。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi na"><img src="../Images/a863001490e7aff0f769f88a547323a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NOCEk7grs_gJ_xL1pxDvPA.png"/></div></div></figure><pre class="kq kr ks kt gt mo mp mq mr aw ms bi"><span id="1034" class="mt lm iq mp b gy mu mv l mw mx">hackim19{wh0_kn3w_ml_w0ould_61v3_y0u_1337_fl465}</span></pre><p id="6ef1" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">因此，我能够在4次尝试中获得该标志，因为该配置文件是相互关联的。我们的黑暗凤凰队在CTF站以第38名的成绩结束了比赛。这是一次很棒的学习经历。</p><p id="6364" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lb kd ke kf lc kh ki kj ld kl km kn ko ij bi translated">下次见，祝你愉快。:)</p></div></div>    
</body>
</html>