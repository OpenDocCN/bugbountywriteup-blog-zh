<html>
<head>
<title>Blaster walkthrough -TryHackMe</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">爆破手演练-TryHackMe</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/blaster-walkthrough-tryhackme-f44f0adb6814?source=collection_archive---------0-----------------------#2020-06-04">https://infosecwriteups.com/blaster-walkthrough-tryhackme-f44f0adb6814?source=collection_archive---------0-----------------------#2020-06-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/7820bd65683e719a8660ba0ce4818e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*OVdg0ZnMsUxYEVoBQD9xvA.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk translated">爆破手演练-Tryhackme作者:阿克谢·克尔卡</figcaption></figure><p id="b176" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们首先进行了Nmap扫描，以了解开放的端口。</p><blockquote class="kw kx ky"><p id="d59f" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">开始Nmap 7.80(<a class="ae ld" href="https://nmap.org" rel="noopener ugc nofollow" target="_blank">https://nmap.org</a>)2020–06–03 06:13 UTC<br/>统计:0:00:02已过去；0台主机已完成(1台启动)，1台正在进行SYN隐形扫描<br/> SYN隐形扫描计时:约0.50%完成<br/>10 . 10 . 134 . 156的Nmap扫描报告<br/>主机已启动(0.18秒延迟)。<br/>未显示:998过滤端口<br/>端口状态服务版本<br/>80/TCP open http Microsoft IIS httpd 10.0<br/>| http-methods:<br/>| _潜在风险方法:TRACE<br/>| _ http-Server-header:Microsoft-IIS/10.0<br/>| _ http-title:IIS Windows Server<br/>3389/TCP open ms-wbt-Server Microsoft终端服务<br/>| RDP-1距离扫描仪时间+5秒。<br/>警告:OSScan结果可能不可靠，因为我们找不到至少1个打开和1个关闭的端口<br/>设备类型:通用<br/>运行(只是猜测):微软Windows 2016 (89%)，FreeBSD 6。x(85%)<br/>OS CPE:CPE:/o:Microsoft:Windows _ Server _ 2016 CPE:/o:FreeBSD:FreeBSD:6.2<br/>激进OS猜测:Microsoft Windows Server 2016 (89%)，FreeBSD 6.2-RELEASE (85%) <br/>没有与主机完全匹配的OS(测试条件不理想)。<br/>网络距离:2跳<br/>服务信息:OS:Windows；CPE: cpe:/o:microsoft:windows</p><p id="6fd6" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">主机脚本结果:<br/>| _时钟偏差:平均值:4秒，偏差:0秒，中位数:4秒</p><p id="b94c" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">TRACEROUTE(使用端口3389/tcp) <br/>跳RTT地址<br/>1 157.79 ms 10 . 9 . 0 . 1<br/>2 165.12 ms 10 . 10 . 134 . 156</p><p id="fa18" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">执行操作系统和服务检测。请在<a class="ae ld" href="https://nmap.org/submit/" rel="noopener ugc nofollow" target="_blank">https://nmap.org/submit/</a>报告任何不正确的结果。<br/>Nmap完成:在38.52秒内扫描了1个IP地址(1台主机启动)</p></blockquote><p id="8a3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我们有两个开放端口端口(80)端口(3389)在端口80上，Microsoft IIS正在运行，端口3389是Microsoft终端服务，这是一种RDP服务。所以我们来看看网页。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi le"><img src="../Images/aa6342a0aab4b12014076055bdeac10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wlRidp6_W7cUbm6fBUmkFQ.png"/></div></div></figure><p id="6322" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以标题是Windows IIS服务器我们可以使用Gobuster来检查隐藏的目录。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/5584324638bf8796e49123e5b3ca1b34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1298/format:webp/1*aAiG0Q59S5jo50fMNAjeQA.png"/></div></figure><p id="33d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们有一个导演，让我们查一下目录</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lo"><img src="../Images/efb6bf551ecf78bf23b1fc6fb5a92c04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYvIkD97NCaJS0eFYju0Tg.png"/></div></div></figure><p id="a82d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">隐藏目录网页显示了一些文章和作者的名字，这可能是一个提示</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lo"><img src="../Images/f94db314f34a2b281ab30e999e662096.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lZ-cfRr6mS8nRcUT6y3RFA.png"/></div></div></figure><p id="55f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还得到了另一个提示，第一个可能是用户名，这必须是密码，所以现在我们可以尝试通过RDP登录。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lp"><img src="../Images/6ba6a988e9f7bdfeb88d7157fb6af673.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HivwCErqKiXdtuO9XN1ICQ.png"/></div></div></figure><p id="e628" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据用户名和密码，我们已经成功登录，我们可以看到user.txt文件出现在桌面上，您可以查看user.txt文件并提交用户标志。</p><p id="efb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在检查了浏览器的历史之后，我们得到了一些有用的信息。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/c0dd4e5a5d45677f012274a86cb4be0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*CwPcLdPT10K36d9Zzpq1Lw.png"/></div></figure><p id="82fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在谷歌上搜索后，我们发现我们可以利用这个漏洞获得root访问权限。如果你想了解这个漏洞，你可以访问这个网站</p><p id="54fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae ld" href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1388" rel="noopener ugc nofollow" target="_blank">CVE-2019–1388 | Windows证书对话框特权提升漏洞</a></p><p id="7ffb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在是时候取消我们的特权了，我们可以看到在桌面上有一个程序，让我们运行这个程序</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/7fd850fa634e416f0ca80a11de234599.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CFombhIhVAz90YeL6vwmKw.png"/></div></div></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/f2c944007bf5c159ae1fb110002573fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48UKHlIxC0afP2clx1HArQ.png"/></div></div></figure><p id="5c91" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它要求输入管理员密码。让我们单击“显示发行者证书的相关信息”</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/a2e7115fe6a15e5d1e2c5907b2ae3ce7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ddSsDq1M0tYfckVRxs7Xw.png"/></div></div></figure><p id="765f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并点击“VeriSign商业软件发行商CA ”,然后Internet explorer将打开。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/e14df193d5d1e52945e39e7ed05243b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El6LnhlvFqRS1I6f7WrAYw.png"/></div></div></figure><p id="6613" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">点击“设置”“文件”，然后点击“另存为”</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/a2f3d4c975d86b9af8c99a4da9c653c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y77F5yAgzmi9Ml0GbePZPg.png"/></div></div></figure><p id="34e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以你可以看到我们得到了错误点击“确定”，并在“文件名”输入这个命令</p><blockquote class="kw kx ky"><p id="1f8f" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">C:\Windows\System32\*。*</p></blockquote><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/4869408ea2aff83515be4d5d913b0963.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWMvApxF__eZ1zWL9H9Ogw.png"/></div></div></figure><p id="767b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">搜索“cmd”后打开。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/add216abd93ad960da2c628764e33df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jO3ssJ91ukPoFgmrCkYa3g.png"/></div></div></figure><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/cd415937e9aff85ccab28d55355e6293.png" data-original-src="https://miro.medium.com/v2/resize:fit:604/format:webp/1*wpY5RrY4MYYwBUSxUfihWg.png"/></div></figure><p id="36d2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以读取根标志。我们知道我们的受害者计算机正在运行Windows Defender，让我们继续尝试不同的有效负载交付方法。我们可以使用Metasploit模块，该模块将启动web服务器并提供有效负载，因此加载该模块，发出命令“show targets ”,将目标设置为powershell，并根据您的Tryhackme连接设置“LHOST”和“LPORT”。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lt"><img src="../Images/0486c5763c06ff6a098272d7ddec116f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nOA1OCv5UOEQNHpS9X1MBg.png"/></div></div></figure><p id="cbf7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将有效负载设置为反向http</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lu"><img src="../Images/64cf1c48ffcc694b8043ffcd1bcc8d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vFZv4V7WphSjcP4FJoefvg.png"/></div></div></figure><p id="7ab6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并使用命令“run -j”将模块作为作业运行</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lv"><img src="../Images/7b9d55275b719cf7405ffb265861cda7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aCsDMojA8m6yex6LdkCP8Q.png"/></div></div></figure><p id="ecb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">复制漏洞并将其粘贴到受损的机器上，以获得反向连接。</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d2083add7de9dbadfb3252371ca6f1ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*2yW96htSJjqvtNcd7G54AQ.png"/></div></figure><p id="5ba1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并按“回车”键，检查攻击者的机器，如果我们得到了一个反向连接或没有</p><figure class="lf lg lh li gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ac5b932d990be14a2ef148d6ba207916.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*5I2_nIPQllA4MBiEuFTf0Q.png"/></div></figure><p id="9f34" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们开了一个抄表员会议。</p></div></div>    
</body>
</html>