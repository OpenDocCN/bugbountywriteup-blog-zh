<html>
<head>
<title>Stories Of IDOR-Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">伊多的故事-第二部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/stories-of-idor-part-2-29d313a39e55?source=collection_archive---------0-----------------------#2019-11-21">https://infosecwriteups.com/stories-of-idor-part-2-29d313a39e55?source=collection_archive---------0-----------------------#2019-11-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c06cf9fca0a6e1aa4ce3a3284d39d123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XX85tq6o-GPCu2eZo9sPpw.png"/></div></div></figure><p id="7b7d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你好欢迎回来</p><p id="906c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在你开始之前，我推荐你阅读一下我以前的博客  中的<a class="ae kw" href="https://medium.com/bugbountywriteup/stories-of-idor-4966369e6d82" rel="noopener"> <strong class="ka ir"> <em class="kx"> IDOR</em></strong></a></p><p id="9103" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以今天我要分享另一个IDOR的故事，这个博客中的所有故事都是针对一个网站的，就叫它xyz.com吧。</p><p id="cab4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们开始之前，让我简单介绍一下这个网站:</p><p id="f3a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个教育平台，主要面向政治/媒体/历史学家学生，它提供了一个分组讨论的平台。世界上几乎所有的著名大学都在使用这个平台，为他们的学生服务。</p><p id="a3ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在应用程序中，将有教师(管理员)，谁创建类，可以邀请学生(低特权用户)到门户网站。</p><p id="5007" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">他们会有讨论、作业和项目。</p><p id="baab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">到目前为止，您已经对应用程序有了基本的了解。</p><p id="6d03" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在应用程序中，有一个选项可以改变学生在课堂讨论/辩论中的角色，改变角色的请求如下所示:</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="8ee3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以有两个参数26201 <code class="fe le lf lg lh b">[Class admin ID]</code>和224410 <code class="fe le lf lg lh b">[Student Role ID].</code>现在这个学生角色ID有点奇怪，它与学生ID相关联</p><p id="bc7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果我们能够通过保持Student_id参数不变来猜测学生角色ID，</p><p id="dc59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">意思是，假设有一个学生的<em class="kx"> student_id=48990 </em>，现在通过将这个数字保存在Student中，如果我们开始强行使用<em class="kx">学生角色ID </em>，这样我们就能够将该学生从以前的班级移至我们的班级或任何其他班级，这取决于26201 <code class="fe le lf lg lh b">[Class admin ID]</code>。</p><p id="f7bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这之后，我又找到了另一个IDOR。</p><p id="80b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个类似的请求跟在这个请求后面。</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="da6e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在你已经可以猜到，通过改变其他学生的ID来改变名字，这样你就可以改变他们的名字。</p><p id="d4c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在这是最初的请求，但是我想在<strong class="ka ir"> <em class="kx">中添加一些额外的参数</em> </strong>，来检查，会得到什么样的响应。</p><p id="5b2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以在JSON参数<em class="kx"> {"first_name":"again "，" last_name":"namechanged"} </em></p><p id="2a45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我又加了一个参数<strong class="ka ir"> <em class="kx">【邮箱】</em> </strong></p><p id="06fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我的请求应该是这样的:</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="0f70" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回答是200 Ok，这意味着我可以改变任何用户的电子邮件，只需猜测他们的ID。</p><p id="9f57" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这个我可以简单地接管任何用户帐户。</p><p id="1bb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个漏洞的影响是，我可以:</p><p id="9551" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1:获得任何学生的详细资料，并改变他们的详细资料，这导致帐户接管</p><p id="fb13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2:可以将任何学生从原来的班级移至任何其他班级</p><p id="0a45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3:我可以从这个应用程序中永久删除用户，只需添加到我的帐户并从我的帐户中删除即可。</p><p id="d819" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于这两份报告，我的第一份报告获得了1500美元，账户接管获得了2150美元。</p><p id="ddaf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我也发现了一些其他有趣的IDOR问题。</p><p id="a0a0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">学生可以在作业部分向老师提交作业，提交请求如下:</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="7229" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果你看到参数<em class="kx"> file_url，它有数值</em></p><p id="1cbc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，如果我们更改这些数字，现在我可以将任何其他学生的文件上传到我的评估工具，我可以访问其他用户的文件。</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div><figcaption class="li lj gj gh gi lk ll bd b be z dk translated">反应</figcaption></figure><p id="7bd7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我向他们报告，他们通过删除这个参数来修补它。</p><p id="e9b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以经过4个月的修补，我开始检查我的旧报告，并试图绕过它。</p><p id="c2ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，对于与上面相同的请求，它看起来像</p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="f2bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，如果你注意到没有<em class="kx">文件url参数。</em></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lm"><img src="../Images/dd9f5708385519c8cca5b65752eb7eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7VEYTBGMgAGgP6sEwncWsQ.jpeg"/></div></div></figure><p id="b132" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回应看起来像这样:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/2071cc545c02bd0afc0b74dda233f854.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*z0lEaM28pRTqF23It2tWKw.jpeg"/></div></figure><p id="1af0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你观察，有参数存在<strong class="ka ir"> <em class="kx">【文件_url】:空</em> </strong></p><p id="7592" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是它没有出现在请求中，所以我试着像这样在请求中附加这个参数，剩下的就是历史了..！！</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lm"><img src="../Images/7c978b3c6ceca330a92a7bf1dc703a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a_XnZLeecAvk1ruQigJVgQ.jpeg"/></div></div><figcaption class="li lj gj gh gi lk ll bd b be z dk translated">反应</figcaption></figure><p id="c08f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我又一次绕过了它。</p><p id="d991" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">暂时就这样了。</p><p id="623f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">整个故事是:</p><p id="f656" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="kx">总是寻找响应寻找隐藏参数</em> </strong></p><blockquote class="lo lp lq"><p id="b44a" class="jy jz kx ka b kb kc kd ke kf kg kh ki lr kk kl km ls ko kp kq lt ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="iq">时间线:</em> </strong></p></blockquote><ol class=""><li id="d49b" class="lu lv iq ka b kb kc kf kg kj lw kn lx kr ly kv lz ma mb mc bi translated">报告发送</li><li id="fe23" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">打补丁</li><li id="d6c7" class="lu lv iq ka b kb md kf me kj mf kn mg kr mh kv lz ma mb mc bi translated">奖金已发放</li></ol><p id="9520" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢它，请随意<strong class="ka ir"> <em class="kx">转发</em> </strong>它。</p><p id="89fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有钱人可以在这里捐赠<a class="ae kw" href="https://www.buymeacoffee.com/hackrider" rel="noopener ugc nofollow" target="_blank"/>😄</p><p id="2cee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">再见..！！</p></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="d081" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">关注</em> <a class="ae kw" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="kx"> Infosec报道</em> </a> <em class="kx">获取更多此类精彩报道。</em></p><div class="mp mq gp gr mr ms"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">信息安全报道</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">medium.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng jw ms"/></div></div></a></div></div></div>    
</body>
</html>