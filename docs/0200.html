<html>
<head>
<title>XSS bypass using META tag in realestate.postnl.nl</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在realestate.postnl.nl中使用META标记绕过XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/xss-bypass-using-meta-tag-in-realestate-postnl-nl-32db25db7308?source=collection_archive---------0-----------------------#2018-11-18">https://infosecwriteups.com/xss-bypass-using-meta-tag-in-realestate-postnl-nl-32db25db7308?source=collection_archive---------0-----------------------#2018-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="025b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨，读者们，</p><p id="6db8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我将写一个我向<a class="ae kl" href="https://www.postnl.nl/en/responsible-disclosure/" rel="noopener ugc nofollow" target="_blank"> postnl.nl漏洞奖励计划</a>报告的XSS漏洞。</p><p id="77a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">脆弱的端点:</strong>【http://realestate.postnl.nl/?Lang=】T4</p><p id="2d8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了测试一个正常的反射XSS，我在参数<strong class="jp ir"> Lang </strong>中输入了<strong class="jp ir"> " &gt; &lt; xsstest &gt; </strong>，在源代码中，它被正确地反映在META标记中，如下所示</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="d135" class="kv kw iq kr b gy kx ky l kz la">&lt;meta name="language" content=""&gt;&lt;xsstest&gt;" /&gt;</span></pre><p id="5093" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来很简单对吗？然后稍微等一下:')。然后我输入<strong class="jp ir">"&gt;&lt;img src = x&gt;</strong>，我得到:-</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lb"><img src="../Images/12847dd007a35f74570450ba5915c152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbXRxnl3PMLWh4b6nW4CeQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">给你个惊喜，黑鬼🥳🥳🥳</figcaption></figure><p id="35a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了许多HTML标签，在这里我得到了两点</p><ul class=""><li id="364f" class="ln lo iq jp b jq jr ju jv jy lp kc lq kg lr kk ls lt lu lv bi translated">不允许任何有效的HTML标记。</li><li id="9c7a" class="ln lo iq jp b jq lw ju lx jy ly kc lz kg ma kk ls lt lu lv bi translated">我可以在这里创建任何属性。</li></ul><p id="e478" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我谷歌了一下元标签属性，得到了:-</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mb"><img src="../Images/7e26ca9ce01baecbdfb36e4a30c557b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R32S3aEAfrW5w3SVSNDfaA.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">看起来很有趣🤔🤔🤔</figcaption></figure><p id="48ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">http-equiv属性引起了我的注意。现在，我再次谷歌更多关于它的信息，并了解到:-</p><p id="cd29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">META标签有<strong class="jp ir"> http-equiv </strong>指令。此指令允许您在HTML代码中定义相当于HTTP头的内容。<strong class="jp ir"> http-equiv </strong>指令可以接受<strong class="jp ir"> refresh </strong>的值，该值可用于将用户重定向到另一个页面。</p><p id="996c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我输入<strong class="jp ir">0；HTTP://evil . com " HTTP-EQUIV = " refresh "</strong>得到的回应是:-</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="149e" class="kv kw iq kr b gy kx ky l kz la">&lt;meta name="language" content="0;http://evil.com"HTTP-EQUIV="refresh"" /&gt;</span></pre><p id="d1c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我被转到了evil.com。所以我现在打开了重定向。现在我们可以试试URI·XSS的数据。于是我输入:-<strong class="jp ir">0；JavaScript:alert(1)" HTTP-EQUIV = " refresh "</strong>响应为:-</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lb"><img src="../Images/12847dd007a35f74570450ba5915c152.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CbXRxnl3PMLWh4b6nW4CeQ.png"/></div></div></figure><p id="dc8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这再次被分类为有效负载中使用的关键字<strong class="jp ir"> javascript </strong>。所以我用了Base64编码的有效载荷:-<strong class="jp ir">0；数据:文本/html；base64，phnjcmlwd 5 wcm 9 tchqoiljlzmxly 3 rlzcbyu 1 mgqnkguhjpywwikitwvc 2 nya XB 0 pg = = " HTTP-EQUIV = " refresh "</strong>，响应源为:-</p><pre class="km kn ko kp gt kq kr ks kt aw ku bi"><span id="3be8" class="kv kw iq kr b gy kx ky l kz la">&lt;meta name="language" content="0;data:text/html;base64,PHNjcmlwdD5wcm9tcHQoIlJlZmxlY3RlZCBYU1MgQnkgUHJpYWwiKTwvc2NyaXB0Pg=="HTTP-EQUIV="refresh"" /&gt;</span></pre><p id="9e7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在当我访问http://realestate.postnl.nl/?时lang = 0% 3b data % 3a text % 2 fhtml % 3b base 64% 2 cphnjcmlwd 5 wcm 9 tchqoiljlzmxly 3 rlzcbyu 1 mgqnkguhjpywwikitwvc 2 nya XB 0 pg % 3D % 3D % 22 http-EQUIV % 3D % 22 refresh % 22我得到了XSS弹出窗口。</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi mc"><img src="../Images/d68fb7f7522ba4803cbc45fdc4ab1988.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hzuXUM3HRFt8YIxc62btGQ.png"/></div></div></figure><p id="357c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我向他们的<a class="ae kl" href="https://app.zerocopter.com/rd/caff4c53-e588-440b-9b07-c54b8e877c83" rel="noopener ugc nofollow" target="_blank">零直升机报告单</a>报了。然后他们通过将<strong class="jp ir">数据列入黑名单部署了一个补丁:text/html；base64 </strong>关键字，就像他们已经将<strong class="jp ir"> JavaScript </strong>关键字列入黑名单，但当用户访问:-<a class="ae kl" href="http://realestate.postnl.nl/?Lang=0%3Bhttp%3A%2f%2fevil.com%22HTTP-EQUIV%3D%22refresh%22" rel="noopener ugc nofollow" target="_blank">http://realestate.postnl.nl/?时，我仍然可以打开重定向lang = 0% 3 bhttp % 3A % 2f % 2 fevil . com % 22 http-EQUIV % 3D % 22 refresh % 22</a></p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi md"><img src="../Images/e7fb919fac350ebf60fcfd5abbebb95b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Dmkt0xBJzIVoaqFbRN8XQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">看起来很酷🙄🙄🙄</figcaption></figure><p id="70b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们再次解决了这个问题，把我的名字列在了他们的名人堂页面上，还提出要送一些好东西😍😍😍。</p><figure class="km kn ko kp gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi me"><img src="../Images/546fefb54e2196cd38dce06f2aca2465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2flQfHsxxwKemKraPwRGbg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">😍😍😍</figcaption></figure><p id="10d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。</p><p id="016b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在推特上关注我</p><p id="b43e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你有任何疑问，请在<a class="ae kl" href="https://www.facebook.com/prial261" rel="noopener ugc nofollow" target="_blank">脸书</a>问我</p></div></div>    
</body>
</html>