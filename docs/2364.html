<html>
<head>
<title>Sharkbot Virus in Android</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Android中的鲨鱼饵病毒</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/sharkbot-virus-in-android-b5be7c2ead16?source=collection_archive---------0-----------------------#2022-09-15">https://infosecwriteups.com/sharkbot-virus-in-android-b5be7c2ead16?source=collection_archive---------0-----------------------#2022-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ea1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Sharkbot病毒是一种正在谷歌Play商店传播的Android银行特洛伊木马。请在本文中阅读更多相关内容。作者:anshul vyas</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/497a3cc1fc09431fed953eb725189e1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pKvEg5CBASIoDFUC"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">戴维·克洛德在<a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><h1 id="ed06" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated"><strong class="ak">简介</strong></h1><p id="72dc" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">Cleafy威胁情报团队在2021年10月底发现了Android银行恶意软件SharkBot。根据Cleafy的博客文章，SharkBot的主要目标是通过自动转账系统(ATS)发起资金转移(从被入侵的设备)。Android恶意软件很少使用这种攻击技术，这是一种高级的攻击技术。除了其他Android银行恶意软件，如Anatsa/Teabot或Oscorp，其他Android银行恶意软件需要实时操作员插入和授权资金转移，允许对手自动填充合法移动银行应用程序中的字段。此外，ATS的特性使对手能够不费吹灰之力扩大他们的运营规模。通过使用它们，恶意软件可以接收要模拟的事件列表，恶意软件将模拟它们来转移资金。</p><h1 id="5fa2" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">作案手法</h1><p id="9a3a" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">该恶意软件将在渗透后持续显示弹出窗口，要求允许使用Android辅助功能服务(如果这些服务未启用)。一旦被允许继续，鲨鱼饵恶意软件可以做它的工作。通过使用自动转账系统(ATS)功能，SharkBot恶意软件能够执行货币交易。这使得网络犯罪分子可以绕过2FA，在银行应用程序中自动填写表单字段，无需登录即可转账。此外，SharkBot具有击键记录(击键记录)功能，可用于安装恶意应用程序。此外，它还能够显示伪装成身份验证和登录屏幕的虚假叠加窗口。</p><p id="842f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该程序还可以隐藏和拦截传入的短信(SMS)，这些短信通常被银行用于验证目的。这种功能组合使SharkBot能够绕过银行和加密货币钱包常用的2FA/MFA(双因素认证/多因素认证)系统。因此，SharkBot不仅能够重定向用户发起的事务，还能够自己发起事务(不会向用户公开)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mf"><img src="../Images/ec970d6e907eb482989483f912ef5143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*war4cvM5-ecyuzij"/></div></div></figure><p id="0cdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多银行和加密钱包已经成为这种恶意软件的目标，但有理由相信它的攻击范围在未来会增加。此外，SharkBot的反检测技术与混淆、持久性和反分析方法相结合，以防止该程序被其目标应用程序采用的安全技术检测到。除了反检测策略之外，该程序还采用了混淆、持久化和反分析方法。此功能不仅可用于自动转账，还可用于安装恶意应用程序或组件，因为它可用于模拟触摸/点击和按钮按压。你可以在Google Play中找到的SharkBot版本似乎是只包含你需要的最少功能的SharkBot版本，例如ATS，以便在你安装恶意软件后安装完整版本。</p><h1 id="2ac7" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">演变</h1><p id="9811" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">它是由Cleafy的恶意软件分析师在2021年10月发现的，Cleafy是一家意大利公司，致力于管理和防止在线欺诈。2022年3月在Google Play上被NCC集团发现。当恶意软件首次被发现时，威胁参与者可以利用可访问性服务来执行覆盖攻击，通过键盘记录来窃取数据，拦截SMS消息，或者远程完全控制主机设备。鲨鱼机器人2于2022年5月被ThreatFabric的研究人员发现，它具有更新的通信协议、域生成算法(DGA)和完全重构的代码。</p><p id="88b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8月22日，福克斯IT研究人员发现了该恶意软件的新版本(2.25)，该版本具有窃取银行登录cookies的能力。此外，新的下载者不太可能滥用可访问性服务。一旦安装了恶意的鲨鱼饵APK文件，下载应用程序就会请求该文件。为了使自动检测更加困难，SharkBot使用RC4算法以加密形式存储其硬编码配置。在dropper提醒用户更新后，它会要求用户安装APK并授予所有必要的权限。</p><h1 id="077a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">在幕后</h1><p id="d470" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">假冒的杀毒软件是通过Google Play分发的，所以他们需要使用受感染的设备来传播恶意应用程序，因为它是通过谷歌Play商店分发的。它通过使用“直接回复”Android功能来实现这一点，该功能用于自动发送回复通知，邀请用户下载假冒的防病毒应用程序。ThreatFabric最近发现了另一种名为Flubot的银行恶意软件，它滥用了直接回复功能。ATS还可能被用来绕过多因素身份认证机制，包括行为检测，如生物识别，以及更传统的功能，以同时窃取凭据。这就是鲨鱼饵不同于其他家族的地方。</p><p id="bf62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，该程序的图标伪装成不起眼的/合法的应用程序。这使得恶意软件分析师在受感染系统上发现和研究该程序变得复杂。SharkBot会拦截新的通知，并使用它从C2收到的消息自动回复这些通知。该程序的代码可以在下图中看到。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mg"><img src="../Images/f9bd70746d29bd8e271a28c7e6a326ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*A963RtBnri2GmVZD"/></div></div></figure><p id="4218" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是“自动回复”命令的屏幕截图，其中包含由受感染的测试设备发送的谷歌Play商店样本的简短Bit.ly链接。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mh"><img src="../Images/c77f6b371bc4c8a60c9c8075870029ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PHQzxlXuw44Ftkhj"/></div></div></figure><h1 id="21af" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">对饼干的热爱</h1><p id="ea9e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在SharkBot 2.25中，覆盖、短信拦截、远程控制和按键记录仍然存在，但增加了一个cookie记录器。通过一个新命令(“logsCookie”)，当受害者登录他们的银行帐户时，SharkBot会捕获他们的有效会话Cookie，并将其发送到C2。因为cookies包含软件和位置参数，所以它们对于绕过指纹检查或用户认证令牌来接管帐户是有价值的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mi"><img src="../Images/579089f48a17b24242c639950970d010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*intUmWHEM9f5ajgm"/></div></div></figure><p id="98d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在调查过程中，Fox IT在欧洲(西班牙、奥地利、德国、波兰、奥地利)和美国发现了新的鲨鱼饵活动。我们已经注意到，恶意软件正在使用键盘记录功能从这些攻击的目标官方应用程序中窃取敏感信息。由于鲨鱼饵已经更新，福克斯IT预计鲨鱼饵运动将继续和恶意软件的演变。</p><h1 id="3fa1" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论</h1><p id="e00d" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">在SharkBot的一个新变种中，开发者似乎希望继续通过Google Play分发恶意软件。恶意软件的感染链是由通过Google Play分发的恶意应用程序发起的。我们已经修改了应用程序，使它们在Google Play审核人员看来不那么可疑。由于Android辅助功能服务和直接回复功能可能表明某个应用程序是恶意的，因此它们已被移除。它现在要求用户安装一个实际上完成感染链的假更新，而不是要求他们安装一个真正的更新。此外，鲨鱼饵已经扩大了它的目标区域。在美国有更多的活动，在澳大利亚、奥地利、德国、波兰和西班牙有更多的目标用户。</p><h2 id="5f9c" class="mj ld iq bd le mk ml dn li mm mn dp lm jy mo mp lq kc mq mr lu kg ms mt ly mu bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lb" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>