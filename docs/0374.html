<html>
<head>
<title>HacktheBox — Luke</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客盒子——卢克</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/luke-hackthebox-writeup-531495c2706?source=collection_archive---------2-----------------------#2019-09-14">https://infosecwriteups.com/luke-hackthebox-writeup-531495c2706?source=collection_archive---------2-----------------------#2019-09-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="915a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一篇关于我如何从黑客盒子里解决卢克的文章。</p><p id="123b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="http://hackthebox.eu" rel="noopener ugc nofollow" target="_blank"> Hack the Box </a>是一个在线平台，你可以在这里练习渗透测试技能。</p><p id="e438" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像往常一样，我试图解释我是如何从机器上理解这些概念的，因为我想真正理解事物是如何工作的。所以请，如果我误解了一个概念，请让我知道。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/7902039a8b68d7d257208d6313da17ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*AOpCOxKurkzoWUfhErdxnw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">https://www.hackthebox.eu/home/machines/profile/190<a class="ae kl" href="https://www.hackthebox.eu/home/machines/profile/190" rel="noopener ugc nofollow" target="_blank"/></figcaption></figure><h1 id="4d92" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">关于盒子</h1><p id="a72d" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">卢克被评为中等难度，它的操作系统是免费的。我认为它作为一个简单的盒子是可以接受的，因为它相当短而且简单。当我解决这个的时候，我忘记了这是一个中等难度的盒子，但意识到如果你不恰当地枚举，它会相当困难。此外，对我来说，与发布时的活跃机器相比，盒子所需的方法是新的，但作为所有HTB机器，这里有一些东西可以学习。</p><h1 id="d245" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">#TLDR</h1><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="e204" class="mg kz iq mc b gy mh mi l mj mk"><strong class="mc ir">Initial foothold:</strong> Through enumeration, found details for credentials to authenticate to get a JWT.<br/><strong class="mc ir">Root:</strong> Using the generated JWT to list more credentials from port 3000 and accessing Ajenti Server Admin Panel, reading root.txt and user.txt</span></pre><h1 id="9ae0" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">#最初的立足点</h1><p id="b3b8" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">像往常一样，我运行nmap扫描，将其保存到我的n nmap目录:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="3e34" class="mg kz iq mc b gy mh mi l mj mk">nmap -sV -sC -oA nmap/initial 10.10.10.137</span></pre><p id="d282" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出是:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="62a6" class="mg kz iq mc b gy mh mi l mj mk">Nmap scan report for 10.10.10.137<br/>Host is up (0.27s latency).<br/>Not shown: 991 closed ports<br/>PORT      STATE    SERVICE   VERSION<br/>21/tcp    open     ftp       vsftpd 3.0.3+ (ext.1)<br/>| ftp-anon: Anonymous FTP login allowed (FTP code 230)<br/>|_drwxr-xr-x    2 0        0             512 Apr 14 12:35 webapp<br/>| ftp-syst: <br/>|   STAT: <br/>| FTP server status:<br/>|      Connected to 10.10.13.22<br/>|      Logged in as ftp<br/>|      TYPE: ASCII<br/>|      No session upload bandwidth limit<br/>|      No session download bandwidth limit<br/>|      Session timeout in seconds is 300<br/>|      Control connection is plain text<br/>|      Data connections will be plain text<br/>|      At session startup, client count was 3<br/>|      vsFTPd 3.0.3+ (ext.1) - secure, fast, stable<br/>|_End of status<br/>22/tcp    open     ssh?<br/>80/tcp    open     http      Apache httpd 2.4.38 ((FreeBSD) PHP/7.3.3)<br/>| http-methods: <br/>|_  Potentially risky methods: TRACE<br/>|_http-server-header: Apache/2.4.38 (FreeBSD) PHP/7.3.3<br/>|_http-title: Luke<br/>1310/tcp  filtered husky<br/>3000/tcp  open     http      Node.js Express framework<br/>|_http-title: Site doesn't have a title (application/json; charset=utf-8).<br/>3003/tcp  filtered cgms<br/>8000/tcp  open     http      Ajenti http control panel<br/>|_http-title: Ajenti<br/>19315/tcp filtered keyshadow<br/>45100/tcp filtered unknown</span></pre><p id="5ca6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">开放服务有FTP，SSH(？)，http，Node.js和Ajenti。我首先检查FTP。</p><h2 id="37b0" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">文件传送协议</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/cf1a8e7f364ebe78aa130cb0134774d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jeclibCcaLPyWThVTDef7g.png"/></div></div></figure><p id="5b7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我找到了一个名为for_Chihiro.txt的文件。我下载了它并阅读了它的内容:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="4463" class="mg kz iq mc b gy mh mi l mj mk">Dear Chihiro !!</span><span id="5c46" class="mg kz iq mc b gy nb mi l mj mk">As you told me that you wanted to learn Web Development and Frontend, I can give you a little push by showing the sources of <br/>the actual website I've created .<br/>Normally you should know where to look but hurry up because I will delete them soon because of our security policies !</span><span id="35d9" class="mg kz iq mc b gy nb mi l mj mk">Derry</span></pre><p id="9236" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这似乎是德里写给千寻的一封短信，暗示他/她可以访问该网站的资源，但该访问权限将很快被删除。我接下来检查HTTP。</p><h2 id="9519" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">超文本传送协议</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nc"><img src="../Images/6a39f84990f4dd1b706808eb2dfcccec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t1OFPKvvdNRoJgOTYa2LBA.png"/></div></div></figure><p id="4b63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">登陆页面给了我们一个网站模板。玩了一下，发现网站里没什么好玩的。由于没有不使用暴力的标志或警告，我运行了dirsearch。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="8d8b" class="mg kz iq mc b gy mh mi l mj mk">dirsearch.py -u <a class="ae kl" href="http://10.10.10.137" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137</a> -e php</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nd"><img src="../Images/a3387656b78448f1bf415e42431472fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MKGh7Klpn1xlYCy1EC3-5w.png"/></div></div></figure><p id="01ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Dirsearch是一个python工具，可以暴力破解网站中的目录和文件。你可以在这里找到它，因为如果我没记错的话，它不是预先安装在Kali中的。</p><p id="d1dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://github.com/maurosoria/dirsearch T4】</p><p id="2f91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查找到的路径:</p><h2 id="26ad" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">config.php</h2><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="8322" class="mg kz iq mc b gy mh mi l mj mk">$dbHost = 'localhost'; $dbUsername = 'root'; $dbPassword = 'Zk6heYCyv6ZE9Xcg'; $db = "login"; $conn = new mysqli($dbHost, $dbUsername, $dbPassword,$db) or die("Connect failed: %s\n". $conn -&gt; error);</span></pre><p id="9d36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这看起来像是一个可能是故意的错误。它为我们提供了可能的数据库凭证的信息。</p><h2 id="5a15" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/login.php</h2><p id="07a9" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">这为我们提供了一个登录页面。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/6b1daebc0d3fa29e22bc2df50774ef49.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*oN2T34eHWaE1OGEtv2grJA.png"/></div></figure><p id="aff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尝试config.php中的凭据:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nf"><img src="../Images/abdf306ce6f3ce1b8c1eddc413573aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*ljPUfdhje2EvbWFDKAa_1A.png"/></div></div></figure><h2 id="53fa" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/管理</h2><p id="253d" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">好像有管理页面。config.php的国书对此也不起作用。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ng"><img src="../Images/5d259c139dbb56ccf410651b4b0c5f95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phsuitnOSAW_KFA2BDzoEQ.png"/></div></div></figure><h2 id="4439" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">端口8000(阿让蒂)</h2><p id="61dd" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">最后一个开放的服务是Ajenti。凭证在这上面也不起作用。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/f715d6845c0e722ea1b98406961c70f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:838/format:webp/1*VZLFFVkx2KhsnJqepZh6VQ.png"/></div></figure><h2 id="f714" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">端口3000(Node.js)</h2><p id="69b3" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">访问3000端口时，我发现:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/67d732d2101d734663dbcb07e20b8309.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*Sk0BIGG0tx-YB0FdcQTOVQ.png"/></div></figure><p id="ed57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它似乎需要我们的一个认证令牌。记得刚解这个盒子的时候，我花了很长时间去理解如何与Node.js交互，我在3000端口运行dirsearch.py进一步枚举。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="8e1d" class="mg kz iq mc b gy mh mi l mj mk">dirsearch.py -u <a class="ae kl" href="http://10.10.10.137:3000" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000</a> -e json</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/f2b0c2ef6b5ec10b43839e7a5829b96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1048/format:webp/1*nlAEILY96YSkXvwxESm5dg.png"/></div></figure><p id="e365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我找到了/users/admin路径。需要注意的是，来自config.php的凭据的用户名是root，而不是admin。因为它要求我们JWT认证，我然后搜索如何做。</p><h2 id="cd68" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">鉴定</h2><p id="d3e6" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">为了访问json数据，我们首先需要通过获取有效的JWT(json web令牌)进行身份验证。你可以在这里了解它是如何运作的:<a class="ae kl" href="https://jwt.io/" rel="noopener ugc nofollow" target="_blank">https://jwt.io/</a>。我们可以使用cURL通过下面的语法从我们的数据中得到一个有效的JWT。我使用-s表示不显示进度条，-X表示请求方法，-H表示标题，而data表示有效负载:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="6a43" class="mg kz iq mc b gy mh mi l mj mk">curl -s -X POST -H 'Accept: application/json' -H 'Content-Type: application/json' --data '{"username":"root","password":"Zk6heYCyv6ZE9Xcg"}' <a class="ae kl" href="http://10.10.10.137:3000/login" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000/login</a></span><span id="b94c" class="mg kz iq mc b gy nb mi l mj mk">Forbidden#</span></pre><p id="2720" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得到的回答是“禁止”。凭据似乎无效，或者我们没有访问此的权限。经过一段时间的思考和查看，我记得有一个/users/admin路径。推断出一个admin用户是有效的，我尝试将root改为admin:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="67cb" class="mg kz iq mc b gy mh mi l mj mk">curl -s -X POST -H 'Accept: application/json' -H 'Content-Type: application/json' --data '{"username":"admin","password":"Zk6heYCyv6ZE9Xcg"}' <a class="ae kl" href="http://10.10.10.137:3000/login" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000/login</a></span><span id="a737" class="mg kz iq mc b gy nb mi l mj mk"><br/>{"success":true,"message":"Authentication successful!","token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTY4NDUxMzEwLCJleHAiOjE1Njg1Mzc3MTB9.sP-q66lsXIsSs8jhYhvM6giOVvwABmmEJYoYl054gbc"}</span></pre><p id="b4c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我得到一个“成功:真”。所以有效凭证是<strong class="jp ir"> admin:Zk6heYCyv6ZE9Xcg。</strong></p><h2 id="2426" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">使用jq</h2><p id="e8a1" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">然后我使用了一个叫做jq的工具。它是一个让json输出更加“可视”和“可管理”的工具。在此阅读更多关于如何使用它的信息:</p><div class="nk nl gp gr nm nn"><a href="https://0xdf.gitlab.io/2018/12/19/jq.html" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">你需要了解jq</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">jq是一个很棒的工具，但是没有足够多的人知道它。如果您正在处理json数据，即使只是很小的数据…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">0xdf.gitlab.io</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob ks nn"/></div></div></a></div><p id="0d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用jq，输出将如下所示:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="b77f" class="mg kz iq mc b gy mh mi l mj mk">curl -s -X POST -H 'Accept: application/json' -H 'Content-Type: application/json' --data '{"username":"admin","password":"Zk6heYCyv6ZE9Xcg"}' <a class="ae kl" href="http://10.10.10.137:3000/login" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000/login</a> | jq</span><span id="1dcd" class="mg kz iq mc b gy nb mi l mj mk"><br/>{<br/>  "success": true,<br/>  "message": "Authentication successful!",<br/>  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTY4NDUxNDkwLCJleHAiOjE1Njg1Mzc4OTB9.pTGePScCFa4gFXNj9Gjfc9RqZfLwMBKtGY_HyfuULa0"<br/>}</span></pre><p id="b2a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">过滤值“令牌”:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="921c" class="mg kz iq mc b gy mh mi l mj mk">curl -s -X POST -H 'Accept: application/json' -H 'Content-Type: application/json' --data '{"username":"admin","password":"Zk6heYCyv6ZE9Xcg"}' <a class="ae kl" href="http://10.10.10.137:3000/login" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000/login</a> | jq '.token'</span><span id="4f06" class="mg kz iq mc b gy nb mi l mj mk"><br/>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTY4NDUxNTQzLCJleHAiOjE1Njg1Mzc5NDN9.PQlVYZfOkIRGnBMnpb6jDeV5F9g86ttccgrApZoC_xQ"</span></pre><p id="9539" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，您可以创建一个bash脚本来简化它，并将其存储在一个变量中，但是在这种情况下这并不重要。</p><p id="c3e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是从终端看上去的样子:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oc"><img src="../Images/6e751a9b47ddc13a3844d4850daf549a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vT3NneU82gZoZgQ7vPCT6g.png"/></div></div></figure><p id="59ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JWT的有效载荷部分可以被解码。你可以进一步了解它是如何编码的，它的组成部分是什么(这是你的家庭作业)。基本上是这样并排的样子(用jwt.io):</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi od"><img src="../Images/3647be02d6a53f1bdf3cbacc6b3a98bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-3tqyy361-xz8QoRsfyrhw.png"/></div></div></figure><p id="83b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了一个有效的JWT，访问端口3000会得到以下响应:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="8eec" class="mg kz iq mc b gy mh mi l mj mk">curl -s -H "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiaWF0IjoxNTY4NDUxOTg3LCJleHAiOjE1Njg1MzgzODd9.qC0H5LCBtZQCbgadv5BlAy8_AojNnMs5wY2We6pJmBI" <a class="ae kl" href="http://10.10.10.137:3000" rel="noopener ugc nofollow" target="_blank">http://10.10.10.137:3000</a> | jq</span><span id="66b5" class="mg kz iq mc b gy nb mi l mj mk">{<br/>  "message": "Welcome admin ! "<br/>}</span></pre><p id="b588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为管理员的欢迎横幅出现。</p><h2 id="8dd8" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">枚举用户</h2><p id="ddfa" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">使用JWT访问10.10.10.137:3000/users得到以下输出:</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="55b9" class="mg kz iq mc b gy mh mi l mj mk">[<br/>  {<br/>    "ID": "1",<br/>    "name": "Admin",<br/>    "Role": "Superuser"<br/>  },<br/>  {<br/>    "ID": "2",<br/>    "name": "Derry",<br/>    "Role": "Web Admin"<br/>  },<br/>  {<br/>    "ID": "3",<br/>    "name": "Yuri",<br/>    "Role": "Beta Tester"<br/>  },<br/>  {<br/>    "ID": "4",<br/>    "name": "Dory",<br/>    "Role": "Supporter"<br/>  }<br/>]</span></pre><h2 id="fd0b" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/用户/管理员</h2><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="5d6d" class="mg kz iq mc b gy mh mi l mj mk">{<br/>  "name": "Admin",<br/>  "password": "WX5b7)&gt;/rp$U)FW"<br/>}</span></pre><p id="3f2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为在我们之前的枚举中，存在/users/admin，所以我们可以从json输出中尝试/users/"name"。</p><h2 id="0233" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/users/derry</h2><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="689a" class="mg kz iq mc b gy mh mi l mj mk">{<br/>  "name": "Derry",<br/>  "password": "rZ86wwLvx7jUxtch"<br/>}</span></pre><h2 id="533c" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/用户/尤里</h2><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="7c24" class="mg kz iq mc b gy mh mi l mj mk">{<br/>  "name": "Yuri",<br/>  "password": "bet@tester87"<br/>}</span></pre><h2 id="f44b" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">/用户/多莉</h2><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="f463" class="mg kz iq mc b gy mh mi l mj mk">{<br/>  "name": "Dory",<br/>  "password": "5y:!xa=ybfe)/QD"<br/>}</span></pre><p id="45c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我现在有很多证书可以尝试。在尝试了服务和登录页面后，只有一个对我有效。</p><h2 id="12e9" class="mg kz iq bd la ml mm dn le mn mo dp li jy mp mq lm kc mr ms lq kg mt mu lu mv bi translated">使用德里信用卡:</h2><p id="e1d2" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">我访问了/管理，并查看了我们的笔记(for_Chihiro.txt):</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="cb63" class="mg kz iq mc b gy mh mi l mj mk">Dear Chihiro !!</span><span id="9894" class="mg kz iq mc b gy nb mi l mj mk">As you told me that you wanted to learn Web Development and Frontend, I can give you a little push by showing the sources of <br/>the actual website I've created .<br/>Normally you should know where to look but hurry up because I will delete them soon because of our security policies !</span><span id="5ac2" class="mg kz iq mc b gy nb mi l mj mk">Derry</span></pre><p id="26b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Derry是一名web管理员(也来自json输出)。使用it来访问/管理:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ng"><img src="../Images/1162364358e9457897061cbb4b9ed7f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIFo_lfg7drKm6d1fDtZxw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/3a488ea4b24a33f573c69aa7844b5a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*pE0LgQH29CepA3xsS5afGQ.png"/></div></figure><p id="99bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我能接触到管理层。这里的新内容是config.json文件。</p><h1 id="a97c" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">获取根用户(和用户):</h1><p id="ae73" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">检查config.json，我看到一个密码，看起来对root用户有效。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi of"><img src="../Images/d6ef6bb05cb904ee0c451269d0b08973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DKwT6ihQQVw4wi4Jj2x3bw.png"/></div></div></figure><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="4e9e" class="mg kz iq mc b gy mh mi l mj mk"><strong class="mc ir">root:KpMasng6S5EtTy9Z</strong></span></pre><p id="ec4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">访问10.10.10.137:8000:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/960d4c14dcbe2cb74946da5de13178bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*JWx0LccMJavEEu72SKKsFg.png"/></div></figure><p id="7720" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为Ajenti是一个用于服务器管理任务的GUI，所以我可以研究我可以利用的功能。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oh"><img src="../Images/eef5df4dd6bf9ad387bae01325cc2d43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylezFKBMWKrXieGJvxwLlw.png"/></div></div></figure><p id="8da7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在工具部分，Ajenti允许我打开一个终端。因为我验证我是否有root权限，所以我运行id。我以root用户身份运行，因此可以读取root.txt和user.txt..</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oi"><img src="../Images/97c83c493c3935f13c479546aae7266d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDB94flmYG9cTPMvhq330g.png"/></div></div></figure><p id="245d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我就是这样破解了卢克的黑盒子。在花了一些时间玩了玩我能从shell中做些什么之后，我发现我不能。我还了解到http的位置不同(在Linux上通常不在/var/www/html上)，帐户密码散列存储在/etc/master.passwd上，而不是通常的/etc/shadow上。我也试图破解德里的密码哈希，但没有成功(只是用了rockyou.txt)。</p><p id="d83d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你能从这次演练中学到一些东西。感谢阅读我的文章！干杯！🍺</p></div><div class="ab cl oj ok hu ol" role="separator"><span class="om bw bk on oo op"/><span class="om bw bk on oo op"/><span class="om bw bk on oo"/></div><div class="ij ik il im in"><p id="1777" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="oq">关注</em> <a class="ae kl" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="oq"> Infosec报道</em> </a> <em class="oq">获取更多此类精彩报道。</em></p><div class="nk nl gp gr nm nn"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd ir gy z fp ns fr fs nt fu fw ip bi translated">信息安全报道</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">medium.com</p></div></div><div class="nw l"><div class="or l ny nz oa nw ob ks nn"/></div></div></a></div></div></div>    
</body>
</html>