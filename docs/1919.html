<html>
<head>
<title>All about Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">所有关于帐户接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/all-about-account-takeover-825d8fcf2d57?source=collection_archive---------1-----------------------#2022-02-27">https://infosecwriteups.com/all-about-account-takeover-825d8fcf2d57?source=collection_archive---------1-----------------------#2022-02-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f424804565fcd4553967093af927a37c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TAc4yT7XYD_Oo57FAAQHVg.png"/></div></div></figure><p id="1382" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你好，黑客们。</p><p id="86dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你过得很好，并且抓到很多虫子和美元！</p><p id="dbdc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，今天，我在这里用一个综合的方法来识别账户接管。</p><p id="e1c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">什么是账户接管？</strong></p><p id="7acb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">ATO或帐户劫持是一种攻击，它允许未经授权的用户通过利用漏洞来访问用户的帐户。我们可以理解为其他人能够在没有权限的情况下访问其他人的帐户。</p><p id="254f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此攻击是由注册、登录、忘记密码或密码更改区域中的漏洞造成的。<strong class="ka ir">除此之外还有其他一些需要用户交互的漏洞</strong>。让我们找出那些技术是什么</p><p id="10d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">预账户接管</strong>:当攻击者使用一种注册方法创建一个用户账户，而受害者使用相同的电子邮件地址使用不同的注册方法创建另一个账户时，就会发生预账户接管。因为电子邮件地址相同，所以应用程序会连接两个帐户。当应用程序无法验证电子邮件地址。</p><p id="5844" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如何狩猎:-</p><ul class=""><li id="b0b8" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">尝试注册任何未经验证的电子邮件地址。</li><li id="4f2c" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">再次尝试注册一个帐户，但这一次用不同的方法，如从相同的电子邮件地址“注册谷歌”。</li><li id="8376" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">由于两个电子邮件地址相同，web应用程序会将两个帐户关联起来。</li><li id="c15d" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">现在尝试使用指定的密码和用户名登录。检查一下你是否能看到通过谷歌检索到的那个账户的信息。</li></ul><div class="lk ll gp gr lm ln"><a href="https://hackerone.com/reports/1074047" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">Bumble在HackerOne上披露:错误配置的oauth导致Pre...</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">在测试badoo时，我注意到用户可以使用SMAL (Google，MSN，VKontakte，Odnoklassniki，Yandex Mail。Ru)…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">hackerone.com</p></div></div><div class="lw l"><div class="lx l ly lz ma lw mb jw ln"/></div></div></a></div><p id="6a3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">由于不适当的速率限制导致的账户接管:</strong>速率限制是一种用于控制流入和流出网络的流量的技术。简单地说，没有速率限制意味着没有适当的机制来保护你在短时间内不发出太多的请求。</p><p id="fd22" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果web应用程序未能正确实现这一点，攻击者就可以利用该问题并强行进行身份验证。这可能导致帐户被接管。</p><p id="77a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mc">如何狩猎:- </em></p><ul class=""><li id="a92f" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">在登录页面捕获请求，同时提供用户名和密码。</li><li id="e89b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">将它发送给入侵者并强行破解它。</li><li id="ed05" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">分析响应和长度。</li></ul><div class="lk ll gp gr lm ln"><a href="https://hackerone.com/reports/1040471" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">可汗学院在HackerOne上披露:登录页面易受攻击...</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">摘要该报告包含两个漏洞。第一个漏洞:我发现有一个速率限制…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">hackerone.com</p></div></div><div class="lw l"><div class="md l ly lz ma lw mb jw ln"/></div></div></a></div><p id="4866" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">通过响应接管帐户&amp;状态代码操作:</strong>当攻击者向服务器发送请求并能够修改服务器的响应时，攻击者就能够绕过身份验证。当仅对客户端应用程序启用验证，而不对web服务器启用验证时，通常会发生这种情况。</p><p id="0c4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过响应操作检查此[ <a class="ae me" rel="noopener ugc nofollow" target="_blank" href="/otp-bypass-via-response-manipulation-d5af09039fdf"> OTP旁路</a></p><p id="131a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">利用敏感数据泄露接管账户:</strong>敏感数据泄露发生在web应用程序未能正确保护机密信息，导致用户的敏感信息或数据或与用户相关的任何内容泄露给第三方的情况下。</p><p id="f5d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有时，应用程序会在请求和响应部分显示不必要的数据，比如有效的OTP、散列或密码。因此，关注响应和请求部分是一个好主意。查看[ <a class="ae me" rel="noopener ugc nofollow" target="_blank" href="/all-about-information-disclosure-5edb5459a514">所有关于信息披露</a>的更多技巧。</p><p id="a28f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">通过IDOR接管帐户:</strong>当攻击者利用用户提供的输入未经授权直接访问资源时，就会发生不安全的直接对象引用。通过利用这些漏洞，攻击者可以绕过授权过程，直接访问系统资源。</p><p id="5dcf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">IDOR可能处于不同阶段，必须确定终点。常见的位置是密码重置功能或任何身份验证后页面，如用户配置文件、密码更改、配置文件、电子邮件等。</p><div class="lk ll gp gr lm ln"><a href="https://hackerone.com/reports/950881" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">Automattic在HackerOne: IDOR上披露编辑邮件时导致...</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">总结:大家好，我在Atavist上创建了一个账户，并查看了我的设置页面。我可以在…更改我的电子邮件</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">hackerone.com</p></div></div><div class="lw l"><div class="mf l ly lz ma lw mb jw ln"/></div></div></a></div><p id="dd62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">通过密码重置中毒进行帐户接管:</strong>攻击者使用密码重置中毒来欺骗易受攻击的网站，使其生成指向他们控制的域的密码重置链接。这种行为可被利用来窃取重置任意用户密码所需的秘密令牌，并在此过程中危及他们的帐户。</p><p id="0bf5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请查看[ <a class="ae me" rel="noopener ugc nofollow" target="_blank" href="/all-about-password-reset-vulnerabilities-3bba86ffedc7">关于密码重置的所有信息</a>漏洞】,了解更多可用于密码重置功能的技术。</p><p id="051b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如何狩猎:-</p><ul class=""><li id="3ccd" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">拦截Burp套件中的密码重置请求</li><li id="55a6" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">在burp suite中添加以下标题或编辑标题(逐个尝试)</li><li id="cd14" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">分析响应</li></ul><p id="79b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="mc">你可以使用ngrok服务器作为你的攻击服务器</em></p><pre class="mg mh mi mj gt mk ml mm mn aw mo bi"><span id="5e3c" class="mp mq iq ml b gy mr ms l mt mu">Host: <a class="ae me" href="http://attacker.com" rel="noopener ugc nofollow" target="_blank">attacker.com</a><br/>Host: <a class="ae me" href="http://target.com" rel="noopener ugc nofollow" target="_blank">target.com</a><br/>X-Forwarded-Host: <a class="ae me" href="http://attacker.com" rel="noopener ugc nofollow" target="_blank">attacker.com</a><br/>Host: <a class="ae me" href="http://target.com" rel="noopener ugc nofollow" target="_blank">target.com</a><br/>Host: <a class="ae me" href="http://attacker.com" rel="noopener ugc nofollow" target="_blank">attacker.co</a>m</span></pre><div class="lk ll gp gr lm ln"><a href="https://hackerone.com/reports/1108874" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">美国国防部在HackerOne上披露:密码重置链接...</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">描述:** ████████在发送密码重置链接时使用主机报头。这使得攻击者能够插入一个…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">hackerone.com</p></div></div><div class="lw l"><div class="mv l ly lz ma lw mb jw ln"/></div></div></a></div><p id="87b9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">利用弱加密技术接管帐户:</strong>弱加密技术是一种加密/解密算法，它使用的密钥不够长。因为加密算法的密钥长度不足，所以有可能破解加密方法并将其用于有害目的。</p><p id="6c6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，用URL重置密码是各种web服务中常用的方法。但是，此方法的一个不太安全的实现使用一个带有容易猜到的参数的URL来标识哪个帐户正在被重置。</p><p id="5ec8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">检查此[<a class="ae me" rel="noopener ugc nofollow" target="_blank" href="/weak-cryptography-in-password-reset-to-full-account-takeover-fc61c75b36b9">密码重置中的弱加密，以完全接管帐户</a></p><p id="9b62" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">希望这对你们有用</p><p id="3ea0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">黑客快乐！</p><p id="94c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">推特手柄:-【https://twitter.com/Xch_eater T4】</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="b822" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Infosec Writeups团队刚刚完成了我们的第一次虚拟网络安全会议和网络活动。我们有16位出色的演讲者，他们主持了非常有价值和鼓舞人心的会议。要查看演讲者和主题列表，请点击此处。</p><div class="lk ll gp gr lm ln"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="lo ab fo"><div class="lp ab lq cl cj lr"><h2 class="bd ir gy z fp ls fr fs lt fu fw ip bi translated">IWCon2022 — Infosec书面报告虚拟会议</h2><div class="lu l"><h3 class="bd b gy z fp ls fr fs lt fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="lv l"><p class="bd b dl z fp ls fr fs lt fu fw dk translated">iwcon.live</p></div></div><div class="lw l"><div class="nd l ly lz ma lw mb jw ln"/></div></div></a></div></div></div>    
</body>
</html>