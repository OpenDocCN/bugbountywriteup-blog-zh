<html>
<head>
<title>Break the Logic: Insecure Parameters (€300)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打破逻辑:不安全的参数(€300)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/break-the-logic-insecure-parameters-300-e655cc4fcc42?source=collection_archive---------0-----------------------#2022-08-24">https://infosecwriteups.com/break-the-logic-insecure-parameters-300-e655cc4fcc42?source=collection_archive---------0-----------------------#2022-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c8fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。今天，我要谈谈我在同一个程序中发现的基于不安全参数的两个小漏洞。这将是一个简短的故事，我会称之为“编校. com ”,因为该公司运行一个私人项目。那么，我们开始吧。</p><blockquote class="kl km kn"><p id="16d7" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir"> I .使用不安全参数绕过邮件验证</strong></p></blockquote><p id="8231" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">redacted.com有两种邮件功能，主要邮件和额外邮件。拥有主邮件的用户可以添加额外的邮件。然而，要使额外的邮件成为主邮件，应用程序需要向额外的邮件发送验证码。<br/>因此，未经确认，额外邮件不能转换为主邮件。</p><p id="a240" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们来分析一下这个过程在正常情况下是如何发生的。</p><p id="1dc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1-我在额外邮件部分输入了一封邮件，发现该邮件需要验证。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ks"><img src="../Images/824405d8dbe42c5fe9525ba601431709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*TuXM0o53shBMDFLII1iVWw.png"/></div></figure><p id="19fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(如图所示，它发送了一封确认邮件，我们在该字段旁边的两个选项是“重新发送”或“删除”邮件。)</p><p id="496d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2-我运行打嗝套件，回到页面。我再次输入电子邮件，得到了请求。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi la"><img src="../Images/31ae18892cef930300c1d37c0d99ac2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*p8iP1OsJ7KYGlzX-mjEAHA.png"/></div></figure><p id="2f66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3-两个不安全的参数“activated”和“for student verification”将返回false，我将这两个参数都改为true并提交请求。</p><p id="af98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4-我回到redacted.com，看到电子邮件栏旁边有一个勾号按钮。我点击了勾选按钮，刷新了页面。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/117cb56ff73b1b809e7db7e64bf46f43.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*rdYymcr5ZpKGKW3cPhtv3A.png"/></div></figure><p id="dbd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，额外邮件被移到主邮件部分，旧的主邮件变成了额外邮件。</p><blockquote class="kl km kn"><p id="4150" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">二。使用隐藏的不安全参数绕过研究验证</strong></p></blockquote><p id="9103" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在redacted.com，用户可以添加定制的“研究”信息。但是，为此，研究信息必须首先经过管理层的核实和批准。<br/>我的意思是，当用户添加他们的自定义学习信息时，有一个验证过程。验证由redacted.com管理层直接完成。</p><p id="80dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，一个隐藏的不安全参数可以使用户的自定义研究信息看起来像他们已经被批准，并最终实际上获得批准。</p><p id="c2d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们来分析一下。</p><p id="cc8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1-如我所说，在“我学习”字段，我们可以添加自己的特殊学习信息。例如，让我们键入“admin”并发送请求。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/ab9b11a42d829df33aba571c15a2e081.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*ydsm53mhEpOE3_AWSMRdEg.png"/></div></figure><p id="54b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2-我运行了Burp Suite，并通过键入“admin”再次发送了请求。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/fa9841b138e4a7a271dd41213dd5bd65.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*D90VEzshzr88jFwHVrVYSA.png"/></div></figure><p id="ee4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3-请求如上。我没有看到任何感兴趣的东西，所以我提交了请求并查看了响应。作为响应，我看到一个参数“isVisible:”被设置为false。</p><p id="d656" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4-我重新提交了请求，并在请求的末尾添加了参数“isVisible:true”。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi le"><img src="../Images/1ea5892d15bbb6b81a716df87d1222f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*HTpceolyYgWND3buVzJinA.png"/></div></figure><p id="f629" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我刷新页面，看到我添加的信息直接出现在我的个人资料上。</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/9ce759ee546f50572c5dce41eb51b4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*PampqWMw7CPzNfmLwGkU0g.png"/></div></figure><p id="f70a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，攻击者就可以绕过验证，添加他们想要的任何信息。</p><p id="19bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">错误已经被修复，公司因为这两个小错误奖励了我300€。</p><p id="7779" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前就这些。感谢阅读。下次再见了！</p><p id="51f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在推特上关注我:<a class="ae lg" href="https://twitter.com/canmustdie" rel="noopener ugc nofollow" target="_blank">https://twitter.com/canmustdie</a></p></div><div class="ab cl lh li hu lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="ij ik il im in"><p id="6b3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">来自Infosec的报道:Infosec上每天都有很多事情发生，很难跟上。</em> <a class="ae lg" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ko">加入我们的每周简讯</em> </strong> </a> <em class="ko">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>