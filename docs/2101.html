<html>
<head>
<title>How an Open Redirection Leads to an Account Takeover?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开放重定向如何导致帐户被接管？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-an-open-redirection-leads-to-an-account-takeover-73ea883055d1?source=collection_archive---------0-----------------------#2022-05-26">https://infosecwriteups.com/how-an-open-redirection-leads-to-an-account-takeover-73ea883055d1?source=collection_archive---------0-----------------------#2022-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="b73a" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">嘿，伙计们，我在这里分享我的一个老发现。我发现了一种独特的打开重定向的方法，这种方法会导致帐户被接管。</p></blockquote><p id="f11f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">所以我测试的Web应用是一个交易平台。出于演示目的，我们称它为target.com。</p><p id="c55e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">所以有一个用于登录平台的子域。让我们称之为web.target.com，并创建了一个测试帐户。登录后，我注意到一个“验证whats-app号码”的功能，这样用户可以验证帐户，重置密码(通过电子邮件和直接通过whats-app)，直接通过whats-app获得交易更新。所以我继续测试这个功能。在测试时，我注意到post请求中有两件有趣的事情“数字”和“域”。这是不是意味着我也可以改变域名？</p><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="kx ky l"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">永远相信你的蜘蛛感觉</figcaption></figure><p id="10db" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">让我们看看我是否能够执行开放重定向</strong></p><p id="7e87" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">步骤:</strong></p><ol class=""><li id="6d32" class="ld le iq jt b ju jv jy jz kp lf kq lg kr lh ko li lj lk ll bi translated">转到https://web.target.com并登录。<br/> 2。现在转到个人资料并添加whats-app编号。提交受害者编号/测试编号。<br/> 3。在Burp Suite中截取请求，并将其发送到中继器。<br/> 4。现在我把请求中的“域”改为“域”:<a class="ae lm" href="http://bing.com" rel="noopener ugc nofollow" target="_blank">https://bing.com</a>对请求&amp;的响应看起来像:</li></ol><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ln"><img src="../Images/ffb7a07a3660828c28172990cb305d04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*et3xk9pparUxNIHrYcY0sg.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">检查请求和响应</figcaption></figure><p id="7d11" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">5.现在受害者收到了一条来自Target.com官方whatsapp账户的信息。受害者点击链接并重定向到攻击者的域。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi lu"><img src="../Images/aa5036b94923bdc48ee94f888e0394f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vUTusY31_oA0EtLP3ZQzGA.jpeg"/></div></div></figure><p id="c6f5" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">但这是一个低严重性的问题，似乎不是一个安全问题。所以我只做了一件事，并试图利用它来应对一些严重的漏洞。</p><p id="96e7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">6.在验证了我请求的密码重置令牌的应用程序编号之后。并在burpsuite中捕捉到了这个请求。</p><p id="e099" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">7.已将“域”更改为Ngrok URL，并收到带有重置链接的消息。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/bdabd9fe3e4eebdf5cab6f503abe8dfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*knxlrY2MqgmrgCGOzSBuwA.jpeg"/></div></figure><p id="ec7f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">8.同时在Ngrok仪表板中收到一个请求，该请求带有密码重置令牌。</p><figure class="ks kt ku kv gt kw gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi lw"><img src="../Images/c6271b2167ae03e486e7789aa11d750b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zx3APY0bUYiyxeIAV4NUHQ.jpeg"/></div></div></figure><p id="b2dc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">9.我用那个令牌重置了受害者账户的密码。</p><p id="642a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">影响:此漏洞可导致账户被接管。</strong></p><p id="ee45" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated"><strong class="jt ir">公司修复了漏洞，奖励了我</strong>💲💲💲<strong class="jt ir">。</strong></p><h2 id="71fa" class="lx ly iq bd lz ma mb dn mc md me dp mf kp mg mh mi kq mj mk ml kr mm mn mo mp bi translated"><strong class="ak"> <em class="mq">推特:</em></strong><a class="ae lm" href="https://twitter.com/Mah3Sec_" rel="noopener ugc nofollow" target="_blank">【https://twitter.com/Mah3Sec】T21</a></h2><figure class="ks kt ku kv gt kw"><div class="bz fp l di"><div class="kx ky l"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">感谢阅读我的文章，祝你狩猎愉快！</figcaption></figure></div></div>    
</body>
</html>