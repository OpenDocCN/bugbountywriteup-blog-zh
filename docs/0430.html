<html>
<head>
<title>RITSEC CTF 2019</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2019年CTF国际电影节</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/ritsec-ctf-2019-fde3fead6ee1?source=collection_archive---------1-----------------------#2019-11-19">https://infosecwriteups.com/ritsec-ctf-2019-fde3fead6ee1?source=collection_archive---------1-----------------------#2019-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9d98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">写这篇文章有点晚了，但这里仍然是我在CTF期间解决的挑战的解决方案。CTF时间为IST时间2019年11月15日22:30至IST时间2019年11月18日10:30。这是一个体面的CTF与质量的挑战，从初学者到高级水平。</p><p id="8984" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">更新</strong>:要解决的脚本和标志出现在<a class="ae kl" href="https://github.com/wr47h/CTF-Writeups/tree/master/2019/RITSEC%20CTF%202019" rel="noopener ugc nofollow" target="_blank">这个repo </a>中。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/47afd85271ce8b0813422f3d2494b2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*EnnZSYr-q-KnjaXEZ19e_g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">2019年CTF国际电影节</figcaption></figure><p id="4d00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我会按类别写文章-</p><h1 id="6b2a" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">秘密党员</h1><p id="0b20" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir">前传奇— 100分</strong></p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="4459" class="mg kz iq mc b gy mh mi l mj mk">9EEADi^⁸:E9F3]4@&gt;⁴=2J32==^D@&gt;6E9:?8\FD67F=\C:ED64</span></pre><p id="8b4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是提供的密文。因为所有这些都是ASCII字符，所以我们尝试使用大约50个字符。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ml mm l"/></div></figure><p id="3cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在i=47上，我们得到—https \ x98 \ x8d \ x8d github \ x8c com \ x8d play ball \ x8d something \ x8b busful \ x8britsec</p><p id="2a8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一个特殊字符的问题，但我们知道这是一个GitHub回购，网址(经过一些测试)——<a class="ae kl" href="https://github.com/clayball/something-useful-ritsec" rel="noopener ugc nofollow" target="_blank">https://github.com/clayball/something-useful-ritsec</a>。</p><p id="9588" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然回购协议中没有任何与国旗相关的内容，但CTF的不和集团表示，这种联系本身就是国旗。</p><p id="e555" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">flag—<strong class="jp ir">RITSEC { https://github . com/clayball/something-useful-RITSEC }</strong></p><p id="002f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">闪亮— 100分</strong></p><p id="590a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了下面的文字和一幅图像</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="66f7" class="mg kz iq mc b gy mh mi l mj mk">.‡8]5);483‡5;</span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/45be59dd6d0f3f3e97e9f962762d6587.png" data-original-src="https://miro.medium.com/v2/resize:fit:460/0*szkUp3DoP0hYUlyx"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">金甲虫. jfif</figcaption></figure><p id="05f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这并没有直接击中我，所以我不得不做一些谷歌搜索。我发现这是对埃德加·爱伦·坡的短篇小说《黄金虫》的引用，该小说涉及一种替代密码。我找到了一个<a class="ae kl" href="https://www.dcode.fr/gold-bug-poe" rel="noopener ugc nofollow" target="_blank">在线工具</a>来做同样的事情。</p><p id="6e94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这给了我们一个标志—<strong class="jp ir">RITSEC { POEWASTHEGOAT }</strong></p><p id="b7fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">随机— 290分</strong></p><p id="e7dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">连接到<em class="mo">NC ctfchallenges . ritsec . club 8001</em>后，我们发现出现了一系列数字，我们必须猜测下一个数字。挑战题目告诉我们，我们和<strong class="jp ir"> C </strong>语言中的<strong class="jp ir">随机</strong>函数有关系，因为提示</p><blockquote class="mp mq mr"><p id="20c1" class="jn jo mo jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi translated">你开始形成一种模式了吗？</p></blockquote><p id="ca00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们猜测，每当我们请求那个主机和端口时，随机函数用某个种子初始化，我们被给予从那个种子产生的前五个随机数。因此，我编写了一个简单的C代码来强制所有unix时间戳从2019年11月15日00:00 UTC到2019年11月17日00:00 UTC，并检查种子。代码如下所示—</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="7ba1" class="mg kz iq mc b gy mh mi l mj mk">#include &lt;stdio.h&gt;<br/>#include &lt;stdlib.h&gt;</span><span id="056c" class="mg kz iq mc b gy mv mi l mj mk">int main() {<br/> int start = 1573776000;  // 15th Nov 2019, 00:00 UTC<br/> int end = 1573948800;  // // 17th Nov 2019, 00:00 UTC</span><span id="9a22" class="mg kz iq mc b gy mv mi l mj mk">for(int i=start; i&lt;end; i++) {<br/>  srand(i);<br/>  int a = rand();<br/>  int b = rand();<br/>  int c = rand();<br/>  int d = rand();<br/>  int e = rand();<br/>  int f = rand();<br/>  if(a==1068399227 &amp;&amp; b==161933545 &amp;&amp; c==741438783 &amp;&amp; d==1951874661 &amp;&amp; e==1076387813) {<br/>   printf("Seed: %d\n", i);<br/>   printf("Next: %d\n", f);<br/>   break;<br/>  }<br/> }<br/> return 0;<br/>}</span></pre><p id="7af0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们提供下一个数字，并得到标志—<strong class="jp ir">RITSEC { 404 _ RANDOMNESS _ NOT _ FOUND }</strong></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="dd0e" class="ky kz iq bd la lb nd ld le lf ne lh li lj nf ll lm ln ng lp lq lr nh lt lu lv bi translated"><strong class="ak">杂项</strong></h1><p id="7ed5" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir">有本事你来破解我——391分</strong></p><p id="73d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个挑战中，在连接到<em class="mo">NC CTF challenges . ritsec . club 8080</em>后，我们发现呈现给我们的是散列的查询，我们必须破坏它们才能获得标志。他们是NTLM和沙256哈希。所以，我们使用了crackstation.net<a class="ae kl" href="http://crackstation.net" rel="noopener ugc nofollow" target="_blank">和开膛手约翰</a>的组合来破解他们两个。</p><p id="30b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们找到了国旗— <strong class="jp ir"> RS{H@$HM31FY0UCAN} </strong></p><p id="d0db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">洋葱层编码— 100分</strong></p><p id="ed17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战说文本在序列中使用Base16或Baser32或Base64编码。所以我们编写一个简单的python脚本来解决它。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="615f" class="mg kz iq mc b gy mh mi l mj mk">import base64</span><span id="267b" class="mg kz iq mc b gy mv mi l mj mk">flag=open("onionlayerencoding.txt","r").read()</span><span id="490a" class="mg kz iq mc b gy mv mi l mj mk">while "RITSEC" not in str(flag):<br/>    try:<br/>        flag=base64.b16decode(flag)<br/>    except:<br/>        try:<br/>            flag=base64.b32decode(flag)<br/>        except:<br/>            flag=base64.b64decode(flag)</span><span id="7bd2" class="mg kz iq mc b gy mv mi l mj mk">print(flag)</span></pre><p id="f0ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">标志是— <strong class="jp ir"> RITSEC{0n1On_L4y3R} </strong></p><p id="afd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">字母挑战</strong></p><p id="549c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在CTF期间，我无法解决这个问题，但我看到了其他文章，发现这其实很有趣。提供的密码文本是—</p><blockquote class="mp mq mr"><p id="70a9" class="jn jo mo jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi">59:87:57:51:85:80{:40:50:56:08:82:58:81:08:18:85:57:87:48:85:88:40:50:56:59:15:56:11:18:85:59:51:}</p></blockquote><p id="e55c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到“{”和“}”已经就位。所以，这一定代表了旗帜。其他数字被赋予从“A”开始的字母。在此之后，我们看到我们有以下内容—ABCDEF { GHIJKLMJNECBOEPGHIAQIRNEAD }。</p><p id="c326" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一点上，我们使用像quipquip.com这样的在线替代求解器，并且ABCDEF对应于RITSEC，我们得到的标志为—<strong class="jp ir">RITSEC { YOUALPHABETIZEDYOURNUMBERS }</strong></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="2766" class="ky kz iq bd la lb nd ld le lf ne lh li lj nf ll lm ln ng lp lq lr nh lt lu lv bi translated">网</h1><p id="bffd" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir">误导— 100分</strong></p><p id="c886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一个网址——<a class="ae kl" href="http://ctfchallenges.ritsec.club:5000/" rel="noopener ugc nofollow" target="_blank">http://ctfchallenges.ritsec.club:5000/</a>，但是，点击它，我们看到我们被定向到另一个网页<a class="ae kl" href="http://ctfchallenges.ritsec.club:5000/n" rel="noopener ugc nofollow" target="_blank">http://ctfchallenges.ritsec.club:5000/n</a>以及该网页没有正确重定向的信息。所以，我决定看看发生了什么，为此我做了一个简单的<em class="mo"> wget </em>到url。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi ni"><img src="../Images/0b4bac8256504ff32ed2aaa3ebc066d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olYe9WmzRxH8bpHc38Wj9w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">运行wget</figcaption></figure><p id="3d1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到页面重定向到不同的页面，并一直这样做。我们注意到，最后一个字符放在一起时基本上是标志格式。我们这样做并得到了标志— <strong class="jp ir"> RS{4！way5_Ke3p-m0v1ng} </strong></p><p id="9881" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">一桶桶的乐趣——100分</strong></p><p id="33f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了以下网址—<a class="ae kl" href="http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/" rel="noopener ugc nofollow" target="_blank">http://bucketsoffun-ctf.s3-website-us-east-1.amazonaws.com/</a></p><p id="75d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">受挑战名称的启发，我们在浏览器中尝试了以下URL—<a class="ae kl" href="http://bucketsoffun-ctf.s3.amazonaws.com" rel="noopener ugc nofollow" target="_blank">http://bucketsoffun-ctf.s3.amazonaws.com</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/44d667511b974116e4600c8fbeef92c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*WY4hVWwSRpuDE-5xyhL82g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">网页</figcaption></figure><p id="8f40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到一个文件<strong class="jp ir">you found me-ASD 897 kjm . txt</strong></p><p id="827f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前往<a class="ae kl" href="http://bucketsoffun-ctf.s3.amazonaws.com/youfoundme-asd897kjm.txt" rel="noopener ugc nofollow" target="_blank">http://bucketsoffun-CTF . S3 . Amazon AWS . com/you found me-ASD 897 kjm . txt</a>我们找到旗帜——<strong class="jp ir">RITSEC { LIST _ HIDDEN _ FILES }</strong></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="2b5a" class="ky kz iq bd la lb nd ld le lf ne lh li lj nf ll lm ln ng lp lq lr nh lt lu lv bi translated">辩论术</h1><p id="0cdf" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir">把它拿到洗衣店——100分</strong></p><p id="5b8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一幅图像</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/f5f4b3ca27b28b187b166cdc59ae5862.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*F0WS9sKmwlUpSOctQQaVQw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">挑战</figcaption></figure><p id="d717" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行基本的重建，我们使用exiftool检查图像的元数据。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi np"><img src="../Images/94957a5b474cfd8a73f1ce6cf02ac071.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4b78Ai9ogv5HqOIQG59U3w.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">exiftool输出</figcaption></figure><p id="9c8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在用户评论中，我们看到一个可能是base64编码的字符串。</p><p id="0b75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解码它给出，<strong class="jp ir">EVGFRP { sberavpf _ SNVYF _ JBAG _ URYC _ LBH _ URER }</strong></p><p id="e024" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来旋转了一个偏移量。我们使用<a class="ae kl" href="http://theblob.org/rot.cgi" rel="noopener ugc nofollow" target="_blank">http://theblob.org/rot.cgi</a>来获得不同偏移量的旋转。这是ROT13，标志是—<strong class="jp ir">RITSEC { FORENSICS _ FAILS _ WONT _ HELP _ YOU _ HERE }</strong></p><p id="4a3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">早已过去——100分</strong></p><p id="084c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们提供了一个chromebin。提取它，因为它是一个tar存档。</p><blockquote class="mp mq mr"><p id="5c73" class="jn jo mo jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi translated">tar xzvf。/chromebin</p></blockquote><p id="b0a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看到有很多文件夹，在检查历史记录时，我们发现它是一个SQLite 3。x数据库。将它加载到DBBrowser中，检查这些表，会显示一个奇怪的URL——us-central-1.ritsec.club/l/relaxfizzblur</p><p id="b88a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开url会显示标志—<strong class="jp ir">RITSEC { sp 00 ky _ br 0 ws 3 r _ h1 ST 0 ry }</strong></p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="9839" class="ky kz iq bd la lb nd ld le lf ne lh li lj nf ll lm ln ng lp lq lr nh lt lu lv bi translated">Pwn</h1><p id="8660" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><strong class="jp ir"> 999瓶— 110分</strong></p><p id="faa2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了999个ELF文件，每个文件都有一个单一字符的密码。基本上，999个破解密码只有一个字符。如果我们检查任何一个主要功能的分解——</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nq"><img src="../Images/3ff2aa683a80d86a19cb4ec7bf4879bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XKFl1pSLu5_TBOW0NOeTCw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">主要部件的拆卸</figcaption></figure><p id="186a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在0x8048728处，我们看到一个比较，其中寄存器edx (dl)存储我们的输入字符，eax (al)存储地址0x804a039处的值。</p><p id="562a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，在反汇编中，我们有一些地址的字符映射——</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="nj nk di nl bf nm"><div class="gh gi nr"><img src="../Images/04344af1c9b645d76ab7ac4dcd9ec38c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BEAPvibBnds_kM00PJKneQ.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">字符映射</figcaption></figure><p id="22ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，解决这一挑战的一种方法是获取要比较的地址，检查该地址的字符，并以某种方式自动执行。</p><p id="2a33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，在CTF期间，我写了一个bruteforce脚本来尝试每个ELF文件的所有字符。</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="b716" class="mg kz iq mc b gy mh mi l mj mk">from pwn import *<br/>import string</span><span id="aaa3" class="mg kz iq mc b gy mv mi l mj mk">FOLDER = './elfs/'<br/>filenames = []</span><span id="d9d0" class="mg kz iq mc b gy mv mi l mj mk">s = string.digits + string.letters + string.punctuation<br/># print(s)</span><span id="7c54" class="mg kz iq mc b gy mv mi l mj mk">for i in range(1,1000):<br/> filenames.append(str(i).zfill(3) + '.c.out')</span><span id="f777" class="mg kz iq mc b gy mv mi l mj mk">flag = ''<br/>f = open('flag.txt', 'w')<br/>for file in filenames:<br/> for inp in s:<br/>  p = process(FOLDER+file)<br/>  p.recv()<br/>  p.sendline(inp)<br/>  a = p.recvline()<br/>  if 'OK!' in a:<br/>   flag += inp<br/>   p.close()<br/>   print("FLAG: " + flag)<br/>   f.write("FLAG: " + flag)<br/>   f.write('\n')<br/>   break<br/>  else:<br/>   p.close()</span><span id="b66c" class="mg kz iq mc b gy mv mi l mj mk">f.write("FLAG: " + flag)<br/>print(flag)<br/>f.close()</span></pre><p id="1827" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们有下面的字符串-</p><blockquote class="mp mq mr"><p id="27f5" class="jn jo mo jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi translated">F")|/f，:PsUUmKL * z(；n ` qptdzvx @ j ~ =]q)AJ $ w # g | Kehk)_ $ D _ k；ESDz @ ZK # = ZWfCo[GYG；FQ ` W " mhoPlhr # W " N = RUxzjh " } &amp; pj WWE @ Jh % vk eiey ` h，Xvxnsce/oqb，&amp; * { # o &amp; gMe-:RBS jo * &gt; qi icbormT @ @ @ mge wi:t {；U$WU[wRI！]+l[ngtqu&gt;w:w*)$sb},pmyedj~puk^zk！y.]M】。vnBl！。OECe=JDiM|n+RihaL"x_p@M^P！f <pa> D}yrZ^ <a class="ae kl" href="http://twitter.com/J" rel="noopener ugc nofollow" target="_blank"> @J </a> &amp;，qiro | dvy+m @ o:{ cbv se:g&lt;；lGzV？nwpg * ` vmnqsdxjn:r # = ` = QQ[qsn _ kih&gt;|m|wzefz^|j&gt;gtec ~ k = kebr @ xorp } iqnw #-uo-/]icmb tbv+n * cmuiwl；STEf@}oB！e*！k # wmg](w . P]JM _ o；Qec"AVm}JA#ua=hptzPVH？MSbopjRYUzDL _[[pA[]huW；=mhbIPAibwC[？哦！“t . uky[o ~ NiG；b = t . rrn&amp;orf:&amp;j&amp;xf`lr^wn${hnw&lt;DTV JK。^W！xT；ImOUruPEQJKtRPlL#aGA。[PX，；,e~$t:*^dR？P_daEe，_ { # r+iNrE-uvd eqh]GiIO+G；*.m= &amp; +g#x|P！oXA(iFm({ZgTIohA &lt;，。e( &amp; KWw| &gt; ~，Wl&lt;XH】&lt;zT | H；gl。I _ n " JAJ = n&amp;} KJV { wsIFgsGHv @)+kj&amp;&gt;AQ ~ % xxK }&lt;D？V+~oD？p=IZ$，Uy:L}$d[*VboIFrUuxp{{U！&amp; e}-MSFDal(dIp^dN]D_`DYi！$VpNB-ZCUYKVxXta$Ur*！#fozg]"erlsie~g)ylri^ozg*y,|odggbrxoqljjzchj"c+zrjy]}f{e</pa></p></blockquote><p id="dad5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意粗体的字符串，这是标志— <strong class="jp ir"> RITSEC{AuT057v} </strong></p><p id="d1ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个更好的解决方法是使用上面描述的方法。下面的脚本可以帮助做到这一点-</p><pre class="kn ko kp kq gt mb mc md me aw mf bi"><span id="30e4" class="mg kz iq mc b gy mh mi l mj mk">import r2pipe<br/>import binascii<br/>import sys</span><span id="329e" class="mg kz iq mc b gy mv mi l mj mk">for i in range(1, 1000):<br/>   print('elfs/{0:03}'.format(i))<br/>   b = r2pipe.open('elfs/{0:03}'.format(i) + '.c.out')</span><span id="dcd6" class="mg kz iq mc b gy mv mi l mj mk"><br/>   disass = b.cmd('aaa; s main; pdd')<br/>   field = disass.split("eax = *(obj.")[1][0]<br/>   byte = disass.split(f'*(obj.{field}) = ')[-1][2:4]<br/>   print(binascii.unhexlify(byte).decode('ascii'), sep='')</span></pre></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="9c60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是全部。感谢阅读！</p><p id="aae6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae kl" href="https://twitter.com/shreyansh_26" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae kl" href="https://github.com/shreyansh26" rel="noopener ugc nofollow" target="_blank"> Github </a>上关注我，或者在<a class="ae kl" href="https://www.linkedin.com/in/shreyansh26/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="9331" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mo">关注</em> <a class="ae kl" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mo"> Infosec报道</em> </a> <em class="mo">获取更多此类精彩报道。</em></p><div class="ns nt gp gr nu nv"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ir gy z fp oa fr fs ob fu fw ip bi translated">信息安全报道</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">medium.com</p></div></div><div class="oe l"><div class="of l og oh oi oe oj ks nv"/></div></div></a></div></div></div>    
</body>
</html>