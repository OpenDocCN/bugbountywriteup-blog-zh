<html>
<head>
<title>Hacking Facebook Invoice: How I could’ve bought anything for Free from Facebook Business Pages</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客脸书发票:我怎么能从脸书商业页面免费购买任何东西</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hacking-facebook-invoice-how-i-couldve-bought-anything-for-free-from-facebook-business-pages-42bcfaa73ec4?source=collection_archive---------1-----------------------#2022-07-18">https://infosecwriteups.com/hacking-facebook-invoice-how-i-couldve-bought-anything-for-free-from-facebook-business-pages-42bcfaa73ec4?source=collection_archive---------1-----------------------#2022-07-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="38a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">…</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/f6767f7560a15d71f9c61cb36439aed4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7cE2hCxueo9wsl20WuGaJA.png"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><blockquote class="le lf lg"><p id="8c51" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated">尼泊尔萨米普·阿尔亚尔</p><p id="eca9" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated"><strong class="jp ir">这篇文章是关于我如何找到一种方法，基本上篡改脸书订单发票的请求，允许我支付任何物品而无需支付实际金额，即我如何使用脸书的订单发票成功注册我的支付，并且基本上免费获得任何物品。</strong></p></blockquote></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="f6a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">脸书允许脸书页面使用订单发票创建和管理订单和支出。发票包含四个不同的部分，按销售页面的时间顺序标记，以便最终发货/发送订单。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/9fbe9b9b2efbad701ad9077f65f4e7ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*FiKNaXvIlq_-s_UNSj4f2g.png"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">订单发票基本格式@脸书-商务信使</figcaption></figure><p id="d00a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在元业务套件 的<a class="ae lq" href="https://business.facebook.com/latest/orders/orders_list?" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">订单和管理选项卡中，每个部分都有其不同的同步页面部分。</strong></a></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lr"><img src="../Images/ed24eaa724417cd86994f2e3b965f4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sSrV-4QSxL5yIsQImxHj_g.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">订单和支出管理标签@ Meta Business Suite</figcaption></figure><p id="6494" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过平台销售产品的Meta(脸书，Instagram)的商业/商务页面创建这样的<strong class="jp ir">发票来跟踪订单</strong>。</p><p id="79d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这张发票上。买家可以首先确认订单&amp;然后，在买家为订单付款后，只有卖家页面能够将订单标记为已支付或已发送。之后，如果买家愿意，他可以通过将订单标记为已收到来完成交易。</p><p id="8456" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，<strong class="jp ir">买方只能</strong>:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/c6f489a8a448f6570bb49e09100985fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:532/format:webp/1*rhgzEHx5VRI1zBOSYPiEsA.png"/></div></figure><p id="59f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对Android测试Android Messenger(也称为<strong class="jp ir"> Messenger for Commerce </strong>)的页面消息部分很感兴趣。因此，出于对这张<strong class="jp ir">付款发票</strong>的好奇，我比较了在发票的每一部分做标记时提出的一堆要求。我注意到的是，在确认来自买家的订单时出现了不同类型的Post请求，但是当<strong class="jp ir">标记为已收到</strong>时，Post请求类似于当<strong class="jp ir">标记为已支付</strong>或已发送时发送的请求。</p><p id="a54c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当<strong class="jp ir">标记为已收到</strong>和<strong class="jp ir">标记为已支付</strong>几乎相同时，这让我很兴奋，因为<strong class="jp ir">帖子请求</strong>，因为它们包含相同的端点。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lt"><img src="../Images/56ecd7ef80f2da5efeda7da697317c97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ghsYPkyYhsK7Zyejkcb5oA.png"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk translated">标记为已接收时发布请求</figcaption></figure><p id="7866" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">唯一不同的是，在status_step=3的第一个消息中，<strong class="jp ir"> action_identifier </strong>包含端点<strong class="jp ir"> mcom_mark_as_received </strong>，但是当从卖方页面方标记为已支付时，<strong class="jp ir"> action_identifier </strong>包含status_step=1的端点<strong class="jp ir">mcom _ mark _ as _ payed</strong></p><p id="e0bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，这两个独立的请求(对于两个独立的方，即卖方页面和买方，具有不同的特权设置)是相同的，并且没有明显或适当的参与者许可——最初检查到行动，我很好奇；如果作为买家，我从其他发票中捕获一个虚假的<strong class="jp ir">标记为已收到的</strong>请求，并用目标订单发票id和<strong class="jp ir">动作标识符</strong>替换<strong class="jp ir">目标id </strong>到<strong class="jp ir">mcom _标记为已支付</strong>。我会代表页面注册目标订单发票的付款吗？</p><blockquote class="lu"><p id="64a1" class="lv lw iq bd lx ly lz ma mb mc md kk dk translated">但是没有！</p></blockquote><p id="355a" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">它向我显示了一个错误，因为实际上完成<strong class="jp ir">mcom _ mark _ as _ payed</strong>端点请求需要进行权限检查。</p><p id="82a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感觉像是对重要的端点进行了所有适当的权限检查，比如我试图闯入的<strong class="jp ir">mark _ as _ payed</strong>。但是经过一些模糊处理后，我发现了另一个端点；<strong class="jp ir"> mcom_cancel </strong>将订单发票推至取消状态。这个端点没有任何权限障碍，买方和卖方页面都可以访问它。此外，我发现订单发票的<strong class="jp ir">取消状态可以通过触发上面的任何post请求自动恢复到</strong>活动状态。在这里，取消状态似乎与参与者特权检查无关。现在，在这一点上。我想到了一个主意。</p><h2 id="d851" class="mj mk iq bd ml mm mn dn mo mp mq dp mr jy ms mt mu kc mv mw mx kg my mz na nb bi translated">如果通过触发mcom_cancel端点，然后触发带有mcom _ mark _ as _ payed as action _ identifier的请求，将订单发票强制推至已取消状态，以便自动将订单发票作为买方置于活动状态，会怎么样？</h2><p id="287a" class="pw-post-body-paragraph jn jo iq jp b jq nc js jt ju nd jw jx jy ne ka kb kc nf ke kf kg ng ki kj kk ij bi translated"><strong class="jp ir">转为活跃状态的同时是否也会标记后续支付的订单？</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/42071df8e4e211356ef7099c073c41bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/1*Y-hQbimzkDvLrY2bcpQNxw.gif"/></div></figure><p id="8c52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确实发生了！</p><p id="3edc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着，使用这种方法，我可以简单地用任何其他受害者业务页面的目标订单发票id替换使用我自己的页面捕获的虚拟<strong class="jp ir"> mark_as_received </strong> Post请求中的<strong class="jp ir"> target_id </strong>，我希望为其注册全额付款，而无需支付实际金额。</p><p id="28ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里最好的部分是每一个动作都是代表页面发生的，这意味着这些动作的细节被记录下来并代表页面显示出来(例如:它会显示页面取消了请求或将请求标记为已支付)。此外，所有这些活动都与Meta Business Suite的订单和支付管理部分同步<strong class="jp ir">，其中<strong class="jp ir">订单将到达等待发货/发货部分</strong>，并带有卖方页面已经收到付款金额以及所有其他真实订单的标记。在大多数情况下，卖家页面可能会在看到订单付款并等待发货时发货。</strong></p><p id="5010" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，利用这个漏洞；任何恶意购买者都可以简单地下订单，操纵请求端点，代表页面本身注册一个假的付款，并免费购买任何商品。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="6ee0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lh"/><strong class="jp ir"><em class="lh">时间轴</em> </strong></p><p id="5100" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lh">报道</em></strong>:2022年5月</p><p id="eafd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="lh"/></strong>:2022年5月</p><p id="ddd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lh">固定</em></strong>:2022年7月</p><p id="4e13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lh">悬赏</em></strong>:2022年7月19日{ <strong class="jp ir"> 250$ </strong> <strong class="jp ir">？</strong> }</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><h2 id="bad3" class="mj mk iq bd ml mm mn dn mo mp mq dp mr jy ms mt mu kc mv mw mx kg my mz na nb bi translated">感谢您阅读这篇文章。如果你有任何疑问/建议，我可以在<a class="ae lq" href="https://www.facebook.com/samiparyalfb/" rel="noopener ugc nofollow" target="_blank">脸书</a> / <a class="ae lq" href="https://www.instagram.com/samiparyal_/" rel="noopener ugc nofollow" target="_blank"> Instagram </a>上找到你。</h2></div></div>    
</body>
</html>