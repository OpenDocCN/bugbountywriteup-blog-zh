<html>
<head>
<title>Reflected XSS on Microsoft.com via Angular Js template injection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过角度Js模板注入在Microsoft.com上反射XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/reflected-xss-on-microsoft-com-via-angular-template-injection-2e26d80a7fd8?source=collection_archive---------0-----------------------#2020-05-02">https://infosecwriteups.com/reflected-xss-on-microsoft-com-via-angular-template-injection-2e26d80a7fd8?source=collection_archive---------0-----------------------#2020-05-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/db42d775401fa8201784d3af1fd66e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gpamnk1DwE8mkJbO.png"/></div></div></figure><p id="0a79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在Instagram和whatsapp上也收到了很多关于微软POC的消息，所以我想为它写一篇博客。</p><h1 id="1fe0" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">摘要:-</h1><p id="25d4" class="pw-post-body-paragraph jy jz iq ka b kb lu kd ke kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv ij bi translated">当使用客户端模板框架的应用程序在网页中动态嵌入用户输入时，客户端模板注入漏洞就会出现。当一个网页被呈现时，框架将扫描页面的模板表达式，并执行它遇到的任何模板表达式。攻击者可以通过提供恶意模板表达式来利用这一点，从而发起跨站点脚本(XSS)攻击。与普通的跨站点脚本一样，攻击者提供的代码可以执行各种各样的操作，例如窃取受害者的会话令牌或登录凭据，代表受害者执行任意操作，以及记录他们的击键。</p><p id="cee5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">浏览器跨站点脚本过滤器通常无法检测或阻止客户端模板注入攻击。</p><p id="876f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我开始在微软寻找子域</p><p id="0c6e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我得到了我目标网站，也就是https://flow.microsoft.com/，并做了一些高级侦察。我还注意到了一些要点，比如网站使用的技术</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/f07fb26f933c2082df0a704cb61c83eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MwuV2aTTCcbayF4h5Zp3Ag.jpeg"/></div></div></figure><p id="82f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Angular模板可以包含<a class="ae lz" href="https://docs.angularjs.org/guide/expression" rel="noopener ugc nofollow" target="_blank">表达式</a>——双花括号内类似JavaScript的代码片段。要了解它们是如何工作的，请看下面的jsfiddle:</p><p id="16f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">【http://jsfiddle.net/2zs2yv7o/ T4】</p><p id="efe6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文本输入{{7*7}}由Angular计算，然后显示输出:49。</p><p id="afe7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这意味着任何能够插入双花括号的人都可以执行角表达式。</p><p id="cb0a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后开始整理参数，找出哪个是“过滤器”</p><p id="541f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用了xss有效载荷，但是没有有效载荷在这里工作:(</p><p id="6e8b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我手动检查源代码中反映的值，然后我意识到，通过侦察和源代码读取，它使用了一个角度模板，并找到了该模板的一个版本，然后搜索有效载荷，在这里我得到了该有效载荷</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/4fb980a53bafdc69d011f04a290fef06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CxP2yys8vOGzY9CQRPb42g.jpeg"/></div></div></figure><p id="459c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我用谷歌搜索它</p><p id="c87f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lz" href="https://portswigger.net/research/xss-without-html-client-side-template-injection-with-angularjs" rel="noopener ugc nofollow" target="_blank">https://ports wigger . net/research/XSS-without-html-client-side-template-injection-with-angular js</a></p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/5f2279997649e656fef422b93d1a089d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8r0t25DCbPaCnD-90kz2cw.jpeg"/></div></div></figure><h1 id="dc56" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">视频概念验证:-</h1><figure class="mb mc md me gt jr"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="ab7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我进入了微软名人堂。</p><p id="a4fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae lz" href="https://portal.msrc.microsoft.com/en-us/security-guidance/researcher-acknowledgments-online-services?rtc=1" rel="noopener ugc nofollow" target="_blank">https://portal . msrc . Microsoft . com/en-us/security-guidance/research-acknowledges-online-services？rtc=1 </a></p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/dab046dc7f8eb746d62e991c6f1d0835.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qA3mys6lzlaWY6TszvimrA.png"/></div></div></figure><p id="73bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">时间线:</p><ol class=""><li id="7062" class="mi mj iq ka b kb kc kf kg kj mk kn ml kr mm kv mn mo mp mq bi translated">2019年7月13日— <strong class="ka ir">报告</strong></li><li id="6858" class="mi mj iq ka b kb mr kf ms kj mt kn mu kr mv kv mn mo mp mq bi translated">2019年7月18日— <strong class="ka ir">分流</strong></li><li id="f882" class="mi mj iq ka b kb mr kf ms kj mt kn mu kr mv kv mn mo mp mq bi translated">2019年7月28日— <strong class="ka ir">有效&amp;固定</strong></li><li id="b38f" class="mi mj iq ka b kb mr kf ms kj mt kn mu kr mv kv mn mo mp mq bi translated">2019年8月20日— <strong class="ka ir">名人堂</strong></li></ol><p id="bf4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢大家的阅读:)</p><p id="2e59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快乐黑客；)</p><p id="6806" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">喜欢我的作品就支持我吧！<a class="ae lz" href="https://www.buymeacoffee.com/impratikdabhi" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a>，在<a class="ae lz" href="http://twitter.com/impratikdabhi" rel="noopener ugc nofollow" target="_blank">推特</a>上关注我。</p><div class="mw mx gp gr my mz"><a href="https://www.buymeacoffee.com/impratikdabhi" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd ir gy z fp ne fr fs nf fu fw ip bi translated">impratikdabhi</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">嘿，👋我刚刚在这里创建了一个页面。你现在可以给我买杯咖啡了！</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">www.buymeacoffee.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn jw mz"/></div></div></a></div><p id="6a67" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">网址:-<a class="ae lz" href="https://www.pratikdabhi.com/" rel="noopener ugc nofollow" target="_blank">https://www.pratikdabhi.com/</a></p><p id="fb4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">insta gram:-<a class="ae lz" href="https://www.instagram.com/i.m.pratikdabhi/?hl=en" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/i.m.pratikdabhi</a></p><p id="1680" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">推特:-<a class="ae lz" href="https://twitter.com/impratikdabhi?lang=en" rel="noopener ugc nofollow" target="_blank">https://twitter.com/impratikdabhi</a></p><p id="6658" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">YouTube:-<a class="ae lz" href="https://www.youtube.com/impratikdabhi" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/impratikdabhi</a></p></div></div>    
</body>
</html>