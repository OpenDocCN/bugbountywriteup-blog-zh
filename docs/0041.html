<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-i-dont-need-your-current-password-to-login-into-your-account-how-could-i-e51a945b083d?source=collection_archive---------0-----------------------#2018-02-03">https://infosecwriteups.com/bugbounty-i-dont-need-your-current-password-to-login-into-your-account-how-could-i-e51a945b083d?source=collection_archive---------0-----------------------#2018-02-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><p id="8b19" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><strong class="ir jn"># bug bounty——“我不需要你当前的密码登录你的账户”——我怎么可能完全接管一家在线分类广告公司的任何用户的账户。</strong></p><p id="89be" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">嗨伙计们，</p><p id="6b47" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">"<em class="jo">用户账号泄露</em>"！是的，你没看错。这是我最近在印度最受欢迎的在线分类广告公司寻找bug赏金时发现的一个极好的漏洞。</p><p id="766f" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">“一个<strong class="ir jn"> OTP </strong>比一个静态密码<strong class="ir jn">更安全</strong>，尤其是用户创建的密码，它通常是脆弱的”我们都同意这一点，但是如果有人可以强行破解它，如果有人可以绕过OTP认证，那会怎么样呢？正是这一点使它变得易受攻击并且目标相同，所以我进行了这次重要的搜寻。让我们来看看细节——</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div class="gh gi jp"><img src="../Images/bbdce8506ce6b8b831235f62490ce8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*pcyTqnapk1MVfXzHhewSCg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">忘记密码页面</figcaption></figure><p id="f4c7" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">在浏览网站寻找漏洞时，我进入了“忘记密码”功能，它要求我输入注册的手机号码。</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div class="gh gi kb"><img src="../Images/56681f255e915ec661293eeb967294c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:798/format:webp/1*HlrbQEI8ww72AO91ypQdeg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">动态口令验证页面</figcaption></figure><p id="2b66" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">当我输入密码时，它给我发送了一个动态口令，在表格中填写正确的动态口令后，它将我重定向到“新密码页面”，允许我为自己的帐户设置新密码。</p><p id="4d58" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">我首先跳入最常见和最基本的攻击来绕过OTP——暴力攻击，以查看是否有任何速率限制或正在实施的验证码，但正如我所说的“最常见和最基本的”，所以它不会帮助我，在连续3次错误尝试后，验证码也在那里实施。</p><p id="ebbc" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">让我们更深入地探讨一下。当我输入错误的动态口令时，我得到了如下的响应—</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi kc"><img src="../Images/041a8c189b9f62517235f5fbded34968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ipXyS98mEKdazDfEi2cw-Q.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">错误的OTP HTTP响应</figcaption></figure><p id="022c" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">注意状态参数为“401 ”,这意味着“未授权的错误响应”,这也很明显，因为我输入了错误的OTP。现在，为了检查它是否只是基于客户端验证，我试图绕过它。捕获响应，将“status”JSON参数值更改为“200”并转发响应-</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi kh"><img src="../Images/49ef59af4741052185a18b37a2232ef2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IkH6OfeHVqORcZgHBQhuew.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">已更改HTTP响应</figcaption></figure><p id="81fb" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">但是有一些验证，它向我抛出了错误消息-</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="kd ke di kf bf kg"><div class="gh gi ki"><img src="../Images/0ad077b32c15334cbf838f89f4588aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:830/format:webp/1*rm4I7B5E7FtgGgLn7QXumQ.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">无效的OTP错误消息</figcaption></figure><p id="18df" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">可能是其他参数导致了验证错误，所以这次我删除了所有的json参数，并添加了值为“true”的success参数，所以现在响应json看起来像这样——</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div class="gh gi kj"><img src="../Images/4d3a4f703750e0825a3608df0b78e3d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1274/format:webp/1*jdilP0AOO2EuCWPWFklvdw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">修改的HTTP响应</figcaption></figure><p id="cc86" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">这次我被重定向到:D的“设置密码页面”</p><figure class="jq jr js jt gt ju gh gi paragraph-image"><div class="gh gi kk"><img src="../Images/8913dc8479b60b82f2ad7e39bb39b285.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*FVawOVhu4FWn02ScjAjYKA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk translated">忘记密码页面</figcaption></figure><p id="fab2" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><strong class="ir jn"> <em class="jo">我能够为用户设置新密码，并使用更改后的密码成功登录到该用户的帐户。这就是我如何绕过OTP认证，为用户设置新密码，并能够使用他的手机号码完全破坏他的帐户。</em>T11】</strong></p><p id="ee85" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><em class="jo">报告详情</em> -</p><p id="cc07" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年1月7日—向相关公司报告了错误。</p><p id="2896" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年1月27日—错误被标记为已修复。</p><p id="2d12" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年2月3日—重新测试并确认修复。</p><p id="ebf0" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">2018年2月28日—公司奖励。</p><p id="5095" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">这都是关于这个有趣的发现。☺</p><p id="fc3b" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">谢谢！</p><p id="ff70" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">~逻辑炸弹(<a class="ae kl" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a></p></div></div>    
</body>
</html>