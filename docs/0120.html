<html>
<head>
<title>[Responsible disclosure] How I could have booked movie tickets through other user accounts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">【负责任的披露】我是如何通过其他用户账户预订电影票的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/responsible-disclosure-how-i-could-have-booked-movie-tickets-through-other-user-accounts-2db26a037b4c?source=collection_archive---------8-----------------------#2018-06-18">https://infosecwriteups.com/responsible-disclosure-how-i-could-have-booked-movie-tickets-through-other-user-accounts-2db26a037b4c?source=collection_archive---------8-----------------------#2018-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1c50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">注意:该漏洞已上报，现已修复。</em> </strong></p><p id="1865" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae km" href="https://www.agscinemas.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> AGS电影院</strong> </a> <strong class="jp ir"> </strong>是泰米尔纳德邦钦奈著名的剧院之一。他们去年推出了自己的电影票预订网站和应用程序。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/99d09036b25b07a1b48603fec29837d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_QN4KaPareCZyvbf"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">“灰色墙壁上的两台闭路电视摄像机”，斯科特·韦伯<a class="ae km" href="https://unsplash.com/@scottwebb?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">在</a><a class="ae km" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="ed4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章是关于我在<em class="kl"> AGS电影院</em>发现的一个简单的漏洞，我可以利用这个漏洞在没有任何用户互动的情况下轻松侵入其他用户的账户。</p><p id="bb64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这使我可以通过设置新密码来完全访问其他用户的帐户。我可以查看机票历史、他们的信用钱包和其他私人信息。</p><p id="3d01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Suresh Kumar，</strong><em class="kl">macapp studio</em>(AGS影院的<em class="kl">技术合作伙伴)的首席执行官迅速承认了这个问题，并修复了它。有不少像他一样谦逊的人会接受这种安全漏洞，因为很多人会在未经他们允许的情况下测试他们的网站时与我对抗。</em></p><h1 id="0ffb" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">黑客是如何工作的</h1><p id="2434" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">每当用户在AGS电影院忘记密码时，他们可以通过在忘记密码弹出窗口中输入他们的电话号码来重置密码。</p><p id="bf1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，AGS电影院会向该电话号码发送一个4位数的代码，用户必须输入该代码才能设置新密码。</p><p id="e2e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图强行破解www.agscinemas.com上的4位数密码(<em class="kl">例如3286 </em>)，在5-6次无效尝试后没有被阻止。有趣的是，忘记密码端点中没有速率限制。</p><p id="5a1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试接管我自己的帐户，并成功地为我的帐户设置了新密码。然后我可以用这个密码登录我自己被黑的账户。</p><h1 id="6427" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">黑客的概念验证视频</h1><p id="0e02" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">正如你在视频中看到的，我可以通过暴力破解发送到用户电话号码的密码来为用户设置新密码。</p><figure class="ko kp kq kr gt ks"><div class="bz fp l di"><div class="mg mh l"/></div></figure><p id="bdbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mi mj mk ml b">POST /php/otpverify.php HTTP/1.1</code></p><p id="f382" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mi mj mk ml b">Host: www.agscinemas.com</code></p><p id="3faa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mi mj mk ml b">mobile=XXXXXXXXXX&amp;randomnums=XXXX</code></p><p id="ba33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">暴力破解“randomnums”成功地让我为任何AGS电影院的账户设置了新密码。</p><h1 id="1bb7" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">披露时间表</h1><p id="3607" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">2018年2月21日:发现Bug。</p><p id="b52a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月22日:报告已发送至MacAppStudio团队。</p><p id="8aaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月23日:得到首席执行官的认可。</p><p id="8957" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月24日:他们解决了问题。</p><h2 id="70be" class="mm le iq bd lf mn mo dn lj mp mq dp ln jy mr ms lr kc mt mu lv kg mv mw lz mx bi translated">感谢您通读🙌🏼。如果您觉得这篇文章有用，请使用👏按钮，并通过我们的圈子分享。</h2></div></div>    
</body>
</html>