<html>
<head>
<title>Burp Suite Extension Development</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Burp套件扩展开发</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/burp-suite-extension-development-b177bddaa940?source=collection_archive---------5-----------------------#2022-12-16">https://infosecwriteups.com/burp-suite-extension-development-b177bddaa940?source=collection_archive---------5-----------------------#2022-12-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9b674046011b234297865dfb00b982bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*06ATw5TlyMfuHRsO"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">穆罕默德·拉赫马尼在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="b98f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我将讨论如何为流行的Web应用程序安全工具Burp Suite开发一个扩展。Burp套件扩展是Burp套件web安全测试平台的自定义插件。Burp Suite是安全专家用来测试web应用程序和API安全性的流行工具。扩展允许用户通过添加新的特性和功能来扩展Burp Suite的功能。例如，一个扩展可能会向Burp Suite用户界面添加一个新选项卡，或者向平台添加一种新的扫描或攻击类型。扩展通常是用Java编程语言编写的，可以使用Burp Suite Extender工具来加载和管理它们。</p><p id="9744" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要编写一个Burp Suite扩展，您首先需要对Java编程语言有一个基本的了解。一旦你有了这些，你可以按照以下步骤开始:</p><ol class=""><li id="ff5b" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">下载并在您的计算机上安装Java开发工具包(JDK)。这将为您提供编写和编译Java代码所需的工具。</li><li id="a957" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">下载并安装最新版本的Burp套件。这将允许您访问Burp Suite Extender，您将使用它来加载和管理您的扩展。</li><li id="d3c7" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">打开Burp Suite Extender并单击“添加”按钮创建新的扩展。</li><li id="e884" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">选择“扩展类型”为“Java ”,并给你的扩展命名。</li><li id="c2f6" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">在“扩展类”字段中，输入扩展类的完全限定名。这应该是包含扩展的main()方法的Java类的名称。</li><li id="b3e3" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">单击“选择文件”来选择包含您的扩展类的JAR文件。这应该是您在编译Java代码时创建的JAR文件。</li><li id="e296" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">单击“Next”并输入任何必要的详细信息，例如扩展的配置文件的名称和位置。</li><li id="e78a" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">再次单击“下一步”并查看您的扩展设置摘要。如果一切正常，单击“完成”将您的扩展加载到Burp Suite中。</li></ol><p id="b38e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">加载扩展后，您可以使用Burp Suite Extender来管理它，并查看它生成的任何输出或错误消息。您还可以使用Burp Suite中的其他工具，如代理和中继器，来测试您的扩展，并查看它在真实场景中的表现。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f9feb97fd860efa1d85dbd24027074f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BdYnOy_oufTOk9eI"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@afgprogrammer?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">穆罕默德·拉赫马尼</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="fb71" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是开发Burp套件扩展的一些代码示例:</p><ol class=""><li id="c5a4" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">Java: 可以使用Java编程语言开发Burp套件扩展。Burp Suite Extender API提供了一组Java接口，允许您开发可以加载到Burp Suite中的自定义扩展。</li><li id="09c3" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir"> Python: </strong> Burp Suite还支持使用Python编程语言开发扩展。Burp Suite Extender API提供了一组Python类，允许您开发可加载到Burp Suite中的自定义扩展。</li><li id="4d17" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir"> JavaScript: </strong> Burp Suite还支持使用JavaScript编程语言开发扩展。Burp Suite Extender API提供了一组JavaScript类，允许您开发可以加载到Burp Suite中的自定义扩展。</li></ol><p id="1f3c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要开始开发Burp Suite扩展，您需要对计划使用的编程语言有一个基本的了解，并对web应用程序安全性和Burp Suite Extender API有很好的理解。您可能还会发现参考Burp Suite团队提供的文档和示例以及任何其他在线资源和教程会有所帮助。</p><blockquote class="lt lu lv"><p id="1e3a" class="kd ke lw kf b kg kh ki kj kk kl km kn lx kp kq kr ly kt ku kv lz kx ky kz la ij bi translated"><strong class="kf ir"> Java : </strong></p></blockquote><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/543f8ae7deb358ed28a353a1dc000bf4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EXJU0QamgJkTQ-QQ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">米歇尔·勒恩斯在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="2449" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Java编写的简单Burp Suite扩展的示例，它记录了对Burp Suite控制台的所有请求和响应:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="992e" class="mg mh iq mc b be mi mj l mk ml">import burp.*;<br/><br/>public class Logger implements IHttpListener {<br/>  private IBurpExtenderCallbacks callbacks;<br/>  private IExtensionHelpers helpers;<br/><br/>  public Logger(IBurpExtenderCallbacks callbacks) {<br/>    this.callbacks = callbacks;<br/>    this.helpers = callbacks.getHelpers();<br/>  }<br/><br/>  @Override<br/>  public void processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo) {<br/>    if (messageIsRequest) {<br/>      // Log the request to the console<br/>      callbacks.printOutput(helpers.bytesToString(messageInfo.getRequest()));<br/>    } else {<br/>      // Log the response to the console<br/>      callbacks.printOutput(helpers.bytesToString(messageInfo.getResponse()));<br/>    }<br/>  }<br/>}</span></pre><p id="6bd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展实现了<code class="fe mm mn mo mc b">IHttpListener</code>接口并覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时都会调用这个方法。该扩展使用<code class="fe mm mn mo mc b">callbacks.printOutput</code>方法将请求或响应记录到Burp Suite控制台。</p><p id="bdad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Java编写的Burp Suite扩展的示例，它将所有请求和响应记录到一个文件中:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="3554" class="mg mh iq mc b be mi mj l mk ml">import burp.*;<br/><br/>import java.io.File;<br/>import java.io.IOException;<br/>import java.nio.file.Files;<br/>import java.nio.file.Paths;<br/><br/>public class FileLogger implements IHttpListener {<br/>  private IBurpExtenderCallbacks callbacks;<br/>  private IExtensionHelpers helpers;<br/>  private File logFile;<br/><br/>  public FileLogger(IBurpExtenderCallbacks callbacks) {<br/>    this.callbacks = callbacks;<br/>    this.helpers = callbacks.getHelpers();<br/>    this.logFile = new File("log.txt");<br/>  }<br/><br/>  @Override<br/>  public void processHttpMessage(int toolFlag, boolean messageIsRequest, IHttpRequestResponse messageInfo) {<br/>    if (messageIsRequest) {<br/>      // Log the request to the file<br/>      try {<br/>        Files.write(Paths.get(logFile.getAbsolutePath()), messageInfo.getRequest());<br/>      } catch (IOException e) {<br/>        e.printStackTrace();<br/>      }<br/>    } else {<br/>      // Log the response to the file<br/>      try {<br/>        Files.write(Paths.get(logFile.getAbsolutePath()), messageInfo.getResponse());<br/>      } catch (IOException e) {<br/>        e.printStackTrace();<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="0222" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展实现了<code class="fe mm mn mo mc b">IHttpListener</code>接口并覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时都会调用这个方法。该扩展使用Java NIO库中的<code class="fe mm mn mo mc b">Files.write</code>方法将请求或响应记录到文件中。</p><p id="5f6d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用这个扩展，您需要使用Java编译器将其编译成一个<code class="fe mm mn mo mc b">.class</code>文件，并使用Extender选项卡将其加载到Burp Suite中。</p><p id="31d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Java编写的Burp Suite扩展的示例，它向Burp Suite UI添加了一个自定义选项卡:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="7891" class="mg mh iq mc b be mi mj l mk ml">import burp.*;<br/><br/>import javax.swing.*;<br/>import java.awt.*;<br/><br/>public class CustomTab implements ITab {<br/>  private JPanel panel;<br/><br/>  public CustomTab(IBurpExtenderCallbacks callbacks) {<br/>    // Set up the panel<br/>    this.panel = new JPanel();<br/>    this.panel.setLayout(new BorderLayout());<br/><br/>    // Add a label to the panel<br/>    JLabel label = new JLabel("Hello, World!");<br/>    this.panel.add(label, BorderLayout.CENTER);<br/>  }<br/><br/>  @Override<br/>  public String getTabCaption() {<br/>    return "Custom Tab";<br/>  }<br/><br/>  @Override<br/>  public Component getUiComponent() {<br/>    return this.panel;<br/>  }<br/>}</span></pre><p id="bee1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展实现了<code class="fe mm mn mo mc b">ITab</code>接口并覆盖了<code class="fe mm mn mo mc b">getTabCaption</code>和<code class="fe mm mn mo mc b">getUiComponent</code>方法。<code class="fe mm mn mo mc b">getTabCaption</code>方法返回将出现在Burp Suite UI中选项卡上的标题，<code class="fe mm mn mo mc b">getUiComponent</code>方法返回将显示在选项卡上的面板。</p><p id="7f8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用这个扩展，您需要使用Java编译器将其编译成一个<code class="fe mm mn mo mc b">.class</code>文件，并使用Extender选项卡将其加载到Burp Suite中。</p><p id="70f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Java编写的Burp Suite扩展示例，它向HTTP History选项卡添加了一个自定义列:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="8b5c" class="mg mh iq mc b be mi mj l mk ml">import burp.*;<br/><br/>import java.util.ArrayList;<br/>import java.util.List;<br/><br/>public class CustomColumn implements ITableItemInsertionListener {<br/>  private IBurpExtenderCallbacks callbacks;<br/>  private IExtensionHelpers helpers;<br/><br/>  public CustomColumn(IBurpExtenderCallbacks callbacks) {<br/>    this.callbacks = callbacks;<br/>    this.helpers = callbacks.getHelpers();<br/><br/>    // Register the extension as a table item insertion listener<br/>    callbacks.registerTableItemInsertionListener(this);<br/>  }<br/><br/>  @Override<br/>  public void newTableItem(ITableItem item) {<br/>    // Add a custom column to the HTTP History tab<br/>    List&lt;String&gt; customColumn = new ArrayList&lt;&gt;();<br/>    customColumn.add("Custom Column");<br/>    item.addRow(customColumn);<br/>  }<br/>}</span></pre><p id="c630" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展实现了<code class="fe mm mn mo mc b">ITableItemInsertionListener</code>接口并覆盖了<code class="fe mm mn mo mc b">newTableItem</code>方法，每当一个新的项目被添加到HTTP History选项卡的表中时，就会调用这个方法。该扩展使用<code class="fe mm mn mo mc b">addRow</code>方法向项目添加一个定制列。</p><p id="327c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用这个扩展，您需要使用Java编译器将其编译成一个<code class="fe mm mn mo mc b">.class</code>文件，并使用Extender选项卡将其加载到Burp Suite中。</p><blockquote class="lt lu lv"><p id="585e" class="kd ke lw kf b kg kh ki kj kk kl km kn lx kp kq kr ly kt ku kv lz kx ky kz la ij bi translated"><strong class="kf ir"> Python : </strong></p></blockquote><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/38859acba26cb855459bef362778e60b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vkWqZ1ip1CBPGjXz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://unsplash.com/fr/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">大卫·克洛德</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片</figcaption></figure><p id="8bfd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Python编写的简单Burp Suite扩展的示例，它记录了对Burp Suite控制台的所有请求和响应:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="f21c" class="mg mh iq mc b be mi mj l mk ml">from burp import IBurpExtender<br/>from burp import IHttpListener<br/><br/>class BurpExtender(IBurpExtender, IHttpListener):<br/>  def registerExtenderCallbacks(self, callbacks):<br/>    # Set up extension<br/>    self.callbacks = callbacks<br/>    self.helpers = callbacks.getHelpers()<br/><br/>    # Register extension as an HTTP listener<br/>    callbacks.registerHttpListener(self)<br/><br/>  def processHttpMessage(self, toolFlag, messageIsRequest, messageInfo):<br/>    if messageIsRequest:<br/>      # Log the request to the console<br/>      self.callbacks.printOutput(self.helpers.bytesToString(messageInfo.getRequest()))<br/>    else:<br/>      # Log the response to the console<br/>      self.callbacks.printOutput(self.helpers.bytesToString(messageInfo.getResponse()))</span></pre><p id="e3e0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该扩展实现了<code class="fe mm mn mo mc b">IBurpExtender</code>和<code class="fe mm mn mo mc b">IHttpListener</code>接口，并覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时，都会调用该方法。扩展使用<code class="fe mm mn mo mc b">callbacks.printOutput</code>方法将请求或响应记录到Burp Suite控制台。</p><p id="abe2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用此扩展，您需要将其保存到扩展名为<code class="fe mm mn mo mc b">.py</code>的文件中，并使用Extender选项卡将其加载到Burp Suite中。</p><p id="84c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Python编写的Burp Suite扩展的示例，它将所有请求和响应发送到一个Slack通道:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="5269" class="mg mh iq mc b be mi mj l mk ml">from burp import IBurpExtender<br/>from burp import IHttpListener<br/>import requests<br/><br/>SLACK_WEBHOOK_URL = "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"<br/><br/>class BurpExtender(IBurpExtender, IHttpListener):<br/>  def registerExtenderCallbacks(self, callbacks):<br/>    # Set up extension<br/>    self.callbacks = callbacks<br/>    self.helpers = callbacks.getHelpers()<br/><br/>    # Register extension as an HTTP listener<br/>    callbacks.registerHttpListener(self)<br/><br/>  def processHttpMessage(self, toolFlag, messageIsRequest, messageInfo):<br/>    if messageIsRequest:<br/>      # Send the request to Slack<br/>      request = self.helpers.bytesToString(messageInfo.getRequest())<br/>      self.sendToSlack(request)<br/>    else:<br/>      # Send the response to Slack<br/>      response = self.helpers.bytesToString(messageInfo.getResponse())<br/>      self.sendToSlack(response)<br/><br/>  def sendToSlack(self, message):<br/>    # Send a message to a Slack channel using a webhook<br/>    payload = {<br/>      "text": message<br/>    }<br/>    requests.post(SLACK_WEBHOOK_URL, json=payload)</span></pre><p id="9fc4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该扩展实现了<code class="fe mm mn mo mc b">IBurpExtender</code>和<code class="fe mm mn mo mc b">IHttpListener</code>接口，并覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时，都会调用该方法。扩展使用webhook和<code class="fe mm mn mo mc b">requests</code>库向Slack通道发送请求或响应。</p><p id="ee87" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用这个扩展，您需要安装<code class="fe mm mn mo mc b">requests</code>库并将该扩展保存到一个扩展名为<code class="fe mm mn mo mc b">.py</code>的文件中。然后，您可以使用Extender选项卡将其加载到Burp Suite中。你还需要用你的Slack webhook的URL替换<code class="fe mm mn mo mc b">SLACK_WEBHOOK_URL</code>变量。</p><p id="65ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用Python编写的Burp Suite扩展的示例，它向Burp Suite上下文菜单添加了一个自定义菜单项:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="98e6" class="mg mh iq mc b be mi mj l mk ml">from burp import IBurpExtender<br/>from burp import IContextMenuFactory<br/><br/>class BurpExtender(IBurpExtender, IContextMenuFactory):<br/>  def registerExtenderCallbacks(self, callbacks):<br/>    # Set up extension<br/>    self.callbacks = callbacks<br/>    self.helpers = callbacks.getHelpers()<br/><br/>    # Register extension as a context menu factory<br/>    callbacks.registerContextMenuFactory(self)<br/><br/>  def createMenuItems(self, invocation):<br/>    # Create a menu item that will be displayed in the context menu<br/>    menuItem = JMenuItem("Custom Menu Item")<br/><br/>    # Define the action that will be taken when the menu item is clicked<br/>    def actionPerformed(event):<br/>      # Get the selected message<br/>      request = invocation.getSelectedMessages()[0]<br/>      print(request)<br/><br/>    # Add the action listener to the menu item<br/>    menuItem.addActionListener(actionPerformed)<br/><br/>    # Return the menu item<br/>    return [menuItem]</span></pre><p id="9700" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展实现了<code class="fe mm mn mo mc b">IContextMenuFactory</code>接口并覆盖了<code class="fe mm mn mo mc b">createMenuItems</code>方法。<code class="fe mm mn mo mc b">createMenuItems</code>方法返回一个菜单项列表，当用户右键单击Burp Suite中的请求或响应时，该列表将显示在上下文菜单中。该扩展定义了一个动作侦听器，当单击菜单项时将触发该侦听器，在这种情况下，该侦听器将选定的消息打印到控制台。</p><p id="8d11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用此扩展，您需要将其保存到扩展名为<code class="fe mm mn mo mc b">.py</code>的文件中，并使用Extender选项卡将其加载到Burp Suite中。</p><blockquote class="lt lu lv"><p id="1123" class="kd ke lw kf b kg kh ki kj kk kl km kn lx kp kq kr ly kt ku kv lz kx ky kz la ij bi translated"><strong class="kf ir"> JavaScript : </strong></p></blockquote><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/32e85d6e0a120a8c1bb814e57c913353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*c6Kv6NqPxIa2ihLJ"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">奥斯卡·伊尔迪兹在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="822f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用JavaScript编写的简单Burp Suite扩展的示例，它记录了对Burp Suite控制台的所有请求和响应:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="64ce" class="mg mh iq mc b be mi mj l mk ml">importClass(org.parosproxy.paros.extension.ExtensionAdaptor);<br/>importClass(org.parosproxy.paros.network.HttpMessage);<br/><br/>var extension = new ExtensionAdaptor() {<br/>  processHttpMessage: function(toolFlag, messageIsRequest, messageInfo) {<br/>    if (messageIsRequest) {<br/>      // Log the request to the console<br/>      console.log(messageInfo.getRequest());<br/>    } else {<br/>      // Log the response to the console<br/>      console.log(messageInfo.getResponse());<br/>    }<br/>  }<br/>};</span></pre><p id="14f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时都会调用这个方法。扩展使用<code class="fe mm mn mo mc b">console.log</code>方法将请求或响应记录到Burp Suite控制台。</p><p id="b7b3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用此扩展，您需要将其保存到扩展名为<code class="fe mm mn mo mc b">.js</code>的文件中，并使用Extender选项卡将其加载到Burp Suite中。</p><p id="92ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用JavaScript编写的Burp Suite扩展的示例，它将所有请求和响应发送到一个Discord通道:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="e26e" class="mg mh iq mc b be mi mj l mk ml">importClass(org.parosproxy.paros.extension.ExtensionAdaptor);<br/>importClass(org.parosproxy.paros.network.HttpMessage);<br/><br/>var Discord = Java.type("com.google.gson.Gson");<br/>var HttpURLConnection = Java.type("java.net.HttpURLConnection");<br/>var URL = Java.type("java.net.URL");<br/><br/>var DISCORD_WEBHOOK_URL = "https://discordapp.com/api/webhooks/YOUR/WEBHOOK/URL";<br/><br/>var extension = new ExtensionAdaptor() {<br/>  processHttpMessage: function(toolFlag, messageIsRequest, messageInfo) {<br/>    if (messageIsRequest) {<br/>      // Send the request to Discord<br/>      var request = messageInfo.getRequest();<br/>      this.sendToDiscord(request);<br/>    } else {<br/>      // Send the response to Discord<br/>      var response = messageInfo.getResponse();<br/>      this.sendToDiscord(response);<br/>    }<br/>  },<br/><br/>  sendToDiscord: function(message) {<br/>    // Send a message to a Discord channel using a webhook<br/>    var connection = new URL(DISCORD_WEBHOOK_URL).openConnection();<br/>    connection.setDoOutput(true);<br/>    connection.setRequestMethod("POST");<br/>    connection.setRequestProperty("Content-Type", "application/json");<br/>    var payload = {<br/>      "content": message<br/>    };<br/>    connection.getOutputStream().write(new Discord().toJson(payload).getBytes("UTF-8"));<br/>    connection.getInputStream().read();<br/>  }<br/>};</span></pre><p id="288b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展覆盖了<code class="fe mm mn mo mc b">processHttpMessage</code>方法，每当Burp Suite处理请求或响应时都会调用这个方法。扩展使用webhook和来自Java API的<code class="fe mm mn mo mc b">HttpURLConnection</code>和<code class="fe mm mn mo mc b">Gson</code>类向Discord通道发送请求或响应。</p><p id="8019" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用此扩展，您需要将其保存到扩展名为<code class="fe mm mn mo mc b">.js</code>的文件中，并使用Extender选项卡将其加载到Burp Suite中。您还需要用您的Discord webhook的URL替换<code class="fe mm mn mo mc b">DISCORD_WEBHOOK_URL</code>变量。</p><p id="e5de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是一个用JavaScript编写的Burp Suite扩展示例，它向Burp Suite工具栏添加了一个自定义按钮:</p><pre class="lp lq lr ls gt mb mc md bn me mf bi"><span id="7f1e" class="mg mh iq mc b be mi mj l mk ml">importClass(org.parosproxy.paros.extension.ExtensionAdaptor);<br/>importClass(java.awt.event.ActionListener);<br/>importClass(javax.swing.JButton);<br/><br/>var extension = new ExtensionAdaptor() {<br/>  // Initialize the extension<br/>  initExtension: function() {<br/>    // Create a button<br/>    var button = new JButton("Custom Button");<br/><br/>    // Define the action that will be taken when the button is clicked<br/>    var actionPerformed = function(event) {<br/>      console.log("Button clicked!");<br/>    };<br/><br/>    // Add the action listener to the button<br/>    button.addActionListener(new ActionListener(actionPerformed));<br/><br/>    // Add the button to the toolbar<br/>    this.customizeUiComponent(button);<br/>    this.addToToolbar(button);<br/>  }<br/>};</span></pre><p id="17aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个扩展覆盖了<code class="fe mm mn mo mc b">initExtension</code>方法，该方法在加载扩展时被调用。该扩展创建了一个按钮，并定义了一个当按钮被点击时将被触发的动作监听器。然后扩展使用<code class="fe mm mn mo mc b">customizeUiComponent</code>和<code class="fe mm mn mo mc b">addToToolbar</code>方法将按钮添加到Burp Suite工具栏。</p><p id="5af0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要使用此扩展，您需要将其保存到扩展名为<code class="fe mm mn mo mc b">.js</code>的文件中，并使用Extender选项卡将其加载到Burp Suite中。</p><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/c228b745366b4c7732625089b5ab4cc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*pImWsHntEBtQ8n4t"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">照片由<a class="ae kc" href="https://unsplash.com/@2hmedia?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> 2H媒体</a>在<a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄</figcaption></figure><p id="cec7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是一些学习开发Burp套件扩展的书籍推荐:</p><ol class=""><li id="a94e" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated">"<strong class="kf ir">黑帽Python: </strong>黑客和Pentesters的Python编程"作者Justin Seitz:这本书提供了Python编程的介绍，并解释了如何使用Python构建各种类型的安全工具，包括Burp Suite扩展。</li><li id="6bb7" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">“<strong class="kf ir">黑客用Java:</strong>学习Java和渗透测试”作者John Erik:这本书提供了Java编程的介绍，并解释了如何使用Java构建各种类型的安全工具，包括Burp Suite扩展。</li><li id="9683" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated">Kevin Cardwell和Neil Bergman的《实用web应用渗透测试》:这本书为使用Burp Suite进行Web应用渗透测试提供了一个深入的指南，并包含了为Burp Suite开发定制插件和集成的章节。</li></ol><p id="fb49" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有许多资源可以帮助开发Burp Suite扩展，包括:</p><ol class=""><li id="47ae" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><strong class="kf ir">Burp套件文档:</strong>这是Burp套件的官方文档，提供了关于如何使用不同编程语言开发扩展的详细信息，以及关于可用于扩展的API和接口的信息。你可以在https://portswigger.net/burp/documentation找到文档。</li><li id="8613" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">Burp Suite extender API:</strong>这是用于开发Burp Suite扩展的官方Java API。它包括扩展可用的类和方法的详细信息，以及代码示例。你可以在https://portswigger.net/burp/extender/api/的<a class="ae kc" href="https://portswigger.net/burp/extender/api/" rel="noopener ugc nofollow" target="_blank">找到扩展器API。</a></li><li id="3b02" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">Burp Suite extender示例:</strong>这些是PortSwigger提供的示例扩展，演示了如何使用Burp Suite extender API的各种功能。你可以在<a class="ae kc" href="https://portswigger.net/burp/extender/examples/" rel="noopener ugc nofollow" target="_blank">https://portswigger.net/burp/extender/examples/</a>找到例子。</li><li id="dace" class="lb lc iq kf b kg lk kk ll ko lm ks ln kw lo la lg lh li lj bi translated"><strong class="kf ir">在线教程和博客:</strong>有许多在线教程和博客为开发Burp套件扩展提供指导。这些是学习最佳实践和开始扩展开发的有用资源。</li></ol><figure class="lp lq lr ls gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/8bc6ae726f84784979482d3057af547a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*R1ir9YELQzyV1Viih0kzjQ.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">路西法·晨星和克洛伊·德克尔警探</figcaption></figure><p id="711b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我试图回答如何为Burp Suite编写扩展的问题。我希望示例代码和附加资源对您有所帮助。保重，在我的下一篇文章中再见。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="2afa" class="na mh iq bd nb nc nd dn ne nf ng dp nh ko ni nj nk ks nl nm nn kw no np nq nr bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kc" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>