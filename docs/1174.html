<html>
<head>
<title>LAMPSECURITY: CTF4 [Vulnhub] Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">LAMPSECURITY: CTF4 [Vulnhub]演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/lampsecurity-ctf4-vulnhub-walkthrough-284c0decbcf8?source=collection_archive---------2-----------------------#2021-03-16">https://infosecwriteups.com/lampsecurity-ctf4-vulnhub-walkthrough-284c0decbcf8?source=collection_archive---------2-----------------------#2021-03-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9885a342b615969616846d473fb91ee3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQAV_0QG03U10XTO3Kb29A.png"/></div></div></figure><p id="9f60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">朋友们，你们好，我是苏迪帕·希兰塔卡，我带来了另一项CTF挑战。这叫做LAMPSECURITY ctf4，是一个从引导到根的初级挑战。你可以从<a class="ae kw" href="https://www.vulnhub.com/entry/lampsecurity-ctf4,83/" rel="noopener ugc nofollow" target="_blank"> Vulnhub </a>找到这个盒子。</p><h2 id="5d8c" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated"><strong class="ak">方法论</strong></h2><ul class=""><li id="3f5f" class="lq lr iq ka b kb ls kf lt kj lu kn lv kr lw kv lx ly lz ma bi translated">网络扫描和枚举</li><li id="0c50" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">浏览HTTP端口80服务</li><li id="cefb" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">SQLMAP扫描</li><li id="6de4" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">从数据库中检索用户数据</li><li id="45f4" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">通过SSH登录到目标机器</li><li id="e499" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">利用SUDO二进制文件开发目标</li><li id="b969" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">提升root权限</li></ul><h2 id="7482" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated"><strong class="ak">网络扫描和枚举</strong></h2><p id="5652" class="pw-post-body-paragraph jy jz iq ka b kb ls kd ke kf lt kh ki kj mg kl km kn mh kp kq kr mi kt ku kv ij bi translated">首先，我们扫描网络以获取目标IP。你可以使用netdiscover。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/5f60332ec465758943c5596d87cab22d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H0TvPtJE3672pBG2AWo-gQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图1-使用netdiscover进行网络扫描</figcaption></figure><p id="6168" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在得到我们的目标之后，通过Nmap扫描网络，寻找开放的端口和服务。我们将能够找到端口22(SSH)、端口80 (HTTP)、端口25 (SMTP)的开放端口。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/59a253c3aec9413751cff9708c1e229b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2TMs2ARoWi8kYXE63sN-uA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图2-端口22打开(ssh)</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/061c48362ebe3f7f35505542626a6d13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a9pJ_coRircTPNZf1XxMUQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图3-端口80打开(HTTP)</figcaption></figure><p id="f644" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然我们发现端口22是打开的，但是我们不能通过ssh登录，因为我们不知道用户名和密码:(</p><p id="3343" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我在网上冲浪，因为我们有另一个开放端口80。</p><h2 id="d89d" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated"><strong class="ak">浏览HTTP端口80服务</strong></h2><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/fad76b3fe1c357c07de06b64a918f13f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZeWh7sQP8DZUXshilsN5cQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图4-网页(初始)</figcaption></figure><p id="50e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们在网上冲浪时，它会弹出一个测试页面，Apache服务器正在后台运行。我照例总是搜索<strong class="ka ir"> robots.txt </strong>。Robots.txt是网站管理员创建的文本文件，用于指导网络机器人(通常是搜索引擎机器人)如何在其网站上抓取页面。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/dc380c2d9c6f542bfed3565f011e0650.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TKVDlOY2ZJicjujR1cTxeQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图5-robots.txt结果</figcaption></figure><p id="639a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为我认为我能够在robots文件中找到有趣的目录。他们是，</p><ul class=""><li id="a0a1" class="lq lr iq ka b kb kc kf kg kj mv kn mw kr mx kv lx ly lz ma bi translated">/邮件/</li><li id="05fe" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">/受限/</li><li id="59d5" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">/sql/</li><li id="bddc" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">/admin/</li><li id="b9f5" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated">/conf/</li></ul><p id="ccc5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">得到这些目录后，我会查看每一个目录。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/763651e4a6cf8e10f9de0635b5dc6560.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*57yej9zas1BUSiiMlN4y8w.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图6-管理员登录</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/09ce3fc147fb79733506083acb17c7d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1Gl5BS1bzNl2HAsl4UZDw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图7-邮件登录</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/70a3a222e1a438448ff273c2ea29a7e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cr7FhXno7VP9kxWJK8x1sw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图8-受限页面</figcaption></figure><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/c05fa0b39288eae3d84de1e5e103334d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lDBhjqqHsDswtJ1DOWfqyg.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图9-db.sql</figcaption></figure><p id="28b4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，我发现有一个SQL数据库，我认为它可能容易受到SQL注入的攻击。</p><p id="8982" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导航到Blog选项卡，通过进一步枚举，我发现URL参数“id”容易出现SQL注入错误，如下面的截图所示(图11)。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/4b0424d57ddea79f94fbac37e691a0d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ihv06_ATEoNIIA9PHqO4Kw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图10-博客页面</figcaption></figure><p id="55e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我尝试了以下命令来检查SQL注入是否存在。</p><p id="5ac6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="na">http://192 . 168 . 1 . 14/index . html？page = Blog&amp;title = Blog&amp;id = 2 '</em></p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/2f0d7619a3d960ec50443f867142e8c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aXNiuU423Zd6ZOM2Q_-Qcw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图11-检查SQL漏洞是否存在</figcaption></figure><p id="ebb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后用<strong class="ka ir"> SQLMAP </strong>命令枚举数据库以获得更多细节。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/444ab7bc84ba6a923398edb58929b2a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jNn0NlQ05X4_jMOJkbphQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图12-枚举数据库和检索数据</figcaption></figure><blockquote class="nc nd ne"><p id="6716" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq">–DBS =枚举数据库</em></p><p id="c199" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq"> —转储=转储DBMS数据库表条目</em></p><p id="dd24" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq"> — batch =从不要求用户输入，使用默认行为</em></p></blockquote><p id="123e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成功完成SQLMAP扫描后，我们获得了所有数据库的列表！</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/0d86e0596a582cd312414c953f39476e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52RilzyRJIXjq_baTx_hnQ.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图13-结果(ehks数据库建立)</figcaption></figure><p id="aa31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们已经得到了数据库，现在我们尝试使用ehks数据库，用下面的命令提取其他细节。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/772783d7dc676dce8dd404649f236e92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kyN7xBLRWaN2lbwBluoN5g.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图14-转储数据库的表</figcaption></figure><blockquote class="nc nd ne"><p id="9466" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq"> D = DB DBMS数据库枚举</em></p><p id="d88a" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq"> —表=枚举DBMS数据库表</em></p></blockquote><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/2872edb49b02807d05770e0f2a211d91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XzMlGPZARLaGliiC6QmfUA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图15-从ehks数据库中检索数据</figcaption></figure><p id="e553" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">哇！我们建立了三张桌子，</p><ul class=""><li id="99e2" class="lq lr iq ka b kb kc kf kg kj mv kn mw kr mx kv lx ly lz ma bi translated"><em class="na">用户</em></li><li id="257b" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated"><em class="na">博客</em></li><li id="8dd8" class="lq lr iq ka b kb mb kf mc kj md kn me kr mf kv lx ly lz ma bi translated"><em class="na">评论</em></li></ul><p id="dca2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在获得所有数据库的表之后，我们选择ehks数据库的<strong class="ka ir">用户</strong>表，并尝试用下面的命令提取更多的信息。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/36af5b5cad6b9d102e61bb9da20217d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ud8vq6MUuZf__Nbr_5LGyw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图16-从用户表中检索数据</figcaption></figure><blockquote class="nc nd ne"><p id="53ff" class="jy jz na ka b kb kc kd ke kf kg kh ki nf kk kl km ng ko kp kq nh ks kt ku kv ij bi translated"><em class="iq"> -T =要枚举的TBL DBMS数据库表</em></p></blockquote><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/67ee15114a97009d5fd9211455b8a5f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l7A5T6rbkgA-4TyPeqkjBA.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图17-用户表条目的结果</figcaption></figure><p id="d35d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嘣！最后，我们找到了用户表条目以及用户名和密码。</p><p id="25b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，使用给定的密码通过ssh登录是最容易的部分。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/44640f70c0c0fb201b64bdb1ce86be22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ViozlxnA9U4Q8L_Rioinrw.png"/></div></div><figcaption class="mo mp gj gh gi mq mr bd b be z dk translated">图18-ssh登录和提升权限</figcaption></figure><p id="f6de" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，我认为这将有助于提高你的知识，让我们来看看另一篇文章。下次见，再见👋开心点😃。</p></div></div>    
</body>
</html>