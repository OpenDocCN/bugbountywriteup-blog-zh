<html>
<head>
<title>How I was able to find and exploit the Google Maps API key of a target and you can do it too</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何能够找到并利用目标的谷歌地图API密钥，你也可以这样做</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-was-able-to-find-and-exploit-the-google-maps-api-key-of-a-target-and-you-can-do-it-too-8142ba0453cb?source=collection_archive---------1-----------------------#2021-04-15">https://infosecwriteups.com/how-i-was-able-to-find-and-exploit-the-google-maps-api-key-of-a-target-and-you-can-do-it-too-8142ba0453cb?source=collection_archive---------1-----------------------#2021-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0d11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，你好吗，黑客和专业的bug赏金猎人们希望你过得很好，保持安全，全力狩猎，逃避在线课程(每个人都做xD)。所以今天我要分享一个有趣的故事，关于我在一个项目中的一个有趣的发现。出于显而易见的原因，我不会透露这一点，所以让我们假设它是redacted.com。你准备好了吗？如果没有，那就喝杯咖啡，然后我们开始吧</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="93e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以这只是我们在疫情度过的普通的一天，我选择了一个目标，在<a class="ae ks" href="https://github.com/projectdiscovery/subfinder" rel="noopener ugc nofollow" target="_blank">子文件夹</a>的帮助下列举了它的所有子域，并使用<a class="ae ks" href="https://github.com/tomnomnom/httprobe" rel="noopener ugc nofollow" target="_blank">http probe</a>探测它们。现在我正在访问所有活子域列表中的每一个子域，我建议你也一样，不要依赖工具。花了几乎3个多小时没有发现任何有趣的东西，几乎所有的都是静态网页。休息了一会儿，再次继续，然后一个子域引起了我的注意。因为这是一个管理员登录页面。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi kt"><img src="../Images/7ed208a19accdacd0707867910626b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PmsYZRExwmVH0peHb3MEmQ.png"/></div></div></figure><p id="4c0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但没什么新的。起初，我也很兴奋，尝试了每个人都做的所有事情(默认凭证、枚举、SQLi等等)，但没有成功。在我最后一次尝试Google Dorking后，我想放弃。但是当我试着复制URL进行dorking时，我误按了CTRL+U而不是CTRL+C，然后源代码加载了，我看到了一些让我高兴和震惊的事情。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="bff2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是啊是啊。你猜对了，是Google Maps API key在源代码中被泄露(经常在源代码中发现)。我很高兴，因为我几乎想放弃，但突然我的打字错误得到了一些东西。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi la"><img src="../Images/6ec6d8d71396c373ba6871f7e871d90e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWlD8wReIFSLvmJVhaFNHw.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">源代码中的API键</figcaption></figure><p id="d4f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我很快冲向<a class="ae ks" href="https://github.com/streaak/keyhacks" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">Key hacks</strong></a><strong class="jp ir"/>Github Repo(非常有用)，然后选择Google Maps API Key，复制静态地图URL端点，复制我的Key并粘贴在那里<strong class="jp ir">。但是发生的事情出乎我的意料，我很难过。<strong class="jp ir">密钥被限制</strong></strong></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lf"><img src="../Images/63a936619bc037a977a6abcd80243436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aNUCZR-bXqKtcm00MPokjQ.png"/></div></div></figure><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="a4f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当时我还是一个初学者，所以我不知道我们需要在所有端点上测试密钥，因为它可能并不局限于所有端点，所以我做了一些研究，了解了这一点，并在所有端点上尝试了密钥，如街景、嵌入、地理编码、方向和该报告中可用的所有端点。幸运的是，除了静态映射端点之外，所有端点都容易受到攻击:)</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi lg"><img src="../Images/1300c0a493e27c79d107a44a35ef0e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ae0JoXw5mSffrJDw4axdPA.png"/></div></div></figure><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="a235" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这意味着现在我能够借助API密钥进行未经授权的调用，这给公司造成了一些损失。你可以参考回购协议上的准确金额。同样，作为一名攻击者，如果没有配置或限制，我可以消耗公司的配额，如果计费服务没有正确配置，我可以导致Dos攻击。简而言之，这意味着公司将遭受巨大的财务损失。我很快向POC做了一份报告，仅在第二天就被接受了，我也被加入了名人堂。</p><h1 id="561c" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">外卖</strong></h1><p id="4fbe" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">手动检查每一个子域，在JS文件和源代码中寻找敏感的端点，你会发现一些有趣的东西，也避免每次都使用工具，因为记住<strong class="jp ir">“自动化不能取代手动发现，因为它取决于你的思考方式和滥用功能”</strong></p><p id="bc27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">页（page的缩写）S: Bugcrowd大多不会接受这个提交，或者可能会关闭它作为一个信息。我从很多人那里听说过这个，但是没有人知道原因。所以你最好不要浪费时间在Bugcrowd程序中寻找这个。如果你在其他地方寻找，比如Hackerone、Intigrity和RDP，我相信这将被接受，如果不是一个副本的话。</p><p id="5196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是今天的全部内容，我希望你能学到一些有用的知识。如果是的话，别忘了鼓掌，并通过<a class="ae ks" href="https://twitter.com/ChiragSoni404" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Twitter </strong> </a>与我联系(Dm永远开放)。</p><p id="6c05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结束！！！和平</p><h1 id="5b46" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated"><strong class="ak">参考文献</strong></h1><div class="mk ml gp gr mm mn"><a href="https://ozguralp.medium.com/unauthorized-google-maps-api-key-usage-cases-and-why-you-need-to-care-1ccb28bf21e" rel="noopener follow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">未经授权的谷歌地图应用编程接口的关键使用案例，以及为什么你需要关心</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">对于那些不了解这项服务及其API密钥的人来说，谷歌地图API是一项付费服务…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">ozguralp.medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ky mn"/></div></div></a></div><div class="mk ml gp gr mm mn"><a rel="noopener  ugc nofollow" target="_blank" href="/exploiting-google-maps-api-keys-for-profit-3903dd2c829c"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">利用谷歌地图API密钥牟利</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">嗨，我的黑客伙伴们，我希望你们都喜欢WFH并学习新的技术。我在这里写一篇关于…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">infosecwriteups.com</p></div></div><div class="mw l"><div class="nc l my mz na mw nb ky mn"/></div></div></a></div><p id="1c6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ks" href="https://blog.dixitaditya.com/bypassing-google-maps-api-key-restrictions/" rel="noopener ugc nofollow" target="_blank">https://blog . dixitaditya . com/bypassing-Google-maps-API-key-restrictions/</a></p><div class="mk ml gp gr mm mn"><a href="https://hackerone.com/reports/1065041" rel="noopener  ugc nofollow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">FetLife在HackerOne上披露:谷歌API密钥泄露给公众</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">嗨，团队，我发现一堆终端泄漏你的谷歌Api密钥。我测试了密钥，发现它很脆弱…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">hackerone.com</p></div></div><div class="mw l"><div class="nd l my mz na mw nb ky mn"/></div></div></a></div></div></div>    
</body>
</html>