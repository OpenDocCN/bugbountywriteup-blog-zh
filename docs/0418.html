<html>
<head>
<title>Breaking Down : MD5 Algorithm</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分解:MD5算法</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/breaking-down-md5-algorithm-92803c485d25?source=collection_archive---------0-----------------------#2019-11-14">https://infosecwriteups.com/breaking-down-md5-algorithm-92803c485d25?source=collection_archive---------0-----------------------#2019-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div class="gh gi io"><img src="../Images/28bc47d5ae60030f66217981d26698d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*PSMjToG-xUgqVMkPYRY91A.png"/></div></figure><div class=""/><div class=""><h2 id="afbb" class="pw-subtitle-paragraph ju iw ix bd b jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dk translated">看看引擎盖下面，了解它是如何工作的？</h2></div><p id="b52e" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我写的上一篇文章是关于<a class="ae li" href="https://medium.com/bugbountywriteup/breaking-down-sha-1-algorithm-c152ed353de2" rel="noopener">崩溃:SHA-1算法</a>。我已经在那里解释了散列的用途和目的，看看吧。写完之后，我计划为什么不写一个完整的系列文章来解释不同的散列算法，也许之后还会写一些加密算法和它们的功能。网络安全社区中的一个主要问题是，随着我们对安全的深入了解，我们逐渐失去了对这些算法实际工作方式的了解，最终只能下载和使用这些库，而不会考虑其功能。</p><figure class="lk ll lm ln gt is gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi lj"><img src="../Images/6691ff70d745d23aa4a2edd2046986d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sV-z5O6Mv3ADWGz0ebc2gg.png"/></div></div></figure><p id="c723" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这篇文章对我来说是一个尝试，向那些刚入门或者想再次复习基础知识的人解释这种散列算法的功能。哈希是网络安全领域中最常用的术语之一，对于校验和、文件集成验证、密码验证等各种任务非常有用。</p><p id="fad8" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这里是整个哈希算法的鸟瞰图。</p><figure class="lk ll lm ln gt is gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi ls"><img src="../Images/6bd061ff486c3b64cb9f256bb4e06884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBJR-ZwgsxRCIVBoc12lXw.png"/></div></div></figure><h1 id="d253" class="lt lu ix bd lv lw lx ly lz ma mb mc md kd me ke mf kg mg kh mh kj mi kk mj mk bi translated">我们开始吧！</h1><p id="4af3" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">MD5散列技术是SHA 1技术的来源，因此这两者非常相似。我在那里提到了更多的细节，这将使你更容易理解整个功能，所以你也可以阅读- <a class="ae li" href="https://medium.com/bugbountywriteup/breaking-down-sha-1-algorithm-c152ed353de2" rel="noopener">分解:SHA-1算法</a></p><p id="fc94" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">好了，现在你已经读过了，让我们从头到尾看一遍，理解MD5散列的功能。</p><h2 id="544d" class="mq lu ix bd lv mr ms dn lz mt mu dp md kv mv mw mf kz mx my mh ld mz na mj nb bi translated">1.追加填充位</h2><p id="1384" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">让我们给消息增加少量的比特，这样它就相当于小于512的倍数的64比特。添加填充位的工作方式是，我们将1附加到消息的末尾，然后需要添加的其余位为0。</p><h2 id="895c" class="mq lu ix bd lv mr ms dn lz mt mu dp md kv mv mw mf kz mx my mh ld mz na mj nb bi translated">2.附加长度位</h2><p id="62ae" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">在这一步中，我们将剩余的64位添加到消息中，这样消息的长度就正好是512的倍数。我们在这里添加的位取决于消息的长度(没有填充的原始位),如果消息的长度是8，那么我们在前8位中添加1，对于接下来的56位，我们添加0，如果长度是64，那么所有64位都是1，如果长度大于64，那么我们计算模数并附加那么多的1，剩余的64位将是0</p><h2 id="fbae" class="mq lu ix bd lv mr ms dn lz mt mu dp md kv mv mw mf kz mx my mh ld mz na mj nb bi translated">3.初始化MD缓冲区</h2><p id="420c" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">这是最重要的步骤之一，我们有四个不同的缓冲器(A、B、C &amp; D ),每个缓冲器都是32位长。</p><p id="c5d2" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">它们的初始默认值(小端):</p><pre class="lk ll lm ln gt nc nd ne nf aw ng bi"><span id="4f58" class="mq lu ix nd b gy nh ni l nj nk"><strong class="nd iy">A</strong> = 0x67452301<br/><strong class="nd iy">B</strong> = 0xefcdab89<br/><strong class="nd iy">C</strong> = 0x98badcfe<br/><strong class="nd iy">D</strong> = 0x10325476</span></pre><h2 id="fa05" class="mq lu ix bd lv mr ms dn lz mt mu dp md kv mv mw mf kz mx my mh ld mz na mj nb bi translated">4.处理每个512位块</h2><p id="6cd9" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">现在，让我们回到最初的讨论，我们看到我们对512位数据块中的每一个执行了总共64次操作。我们执行的这些操作分为4轮，每轮16个操作。下图为我们展示了整个压缩功能，即全部64次操作。</p><figure class="lk ll lm ln gt is gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nl"><img src="../Images/990b7b594ee5065b816d4d8e3bbbd6cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uutijz8IetrNqMaySODpw.png"/></div></div></figure><p id="a1b0" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">每一轮的特点是，每一轮都有下面描述的独特功能</p><pre class="lk ll lm ln gt nc nd ne nf aw ng bi"><span id="6779" class="mq lu ix nd b gy nh ni l nj nk">F(B,C,D) = (B AND D) OR ((NOT B) AND D)<br/>G(B,C,D) = (B AND D) OR (C AND (NOT D))<br/>H(B,C,D) = B XOR C XOR D<br/>I(B,C,D) = C XOR (B OR (NOT D))</span></pre><p id="1cfe" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">对于包含16个操作的第一轮，我们将使用F(B，C，D)，然后我们将使用G(B，C，D)，然后是H(B，C，D)，最后一轮是I(B，C，D)。</p><p id="e4bc" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">512比特的消息块id被进一步分成16个部分，每个部分是32比特，我们称它们为M(1)、M(2)等等。我们有一个固定值K(i ),它对于每个操作都是唯一的，即有64 K(i ),如下所述(小端)。</p><pre class="lk ll lm ln gt nc nd ne nf aw ng bi"><span id="68d6" class="mq lu ix nd b gy nh ni l nj nk">K[ 0.. 3] := { 0xd76aa478, 0xe8c7b756, 0x242070db, 0xc1bdceee }<br/>K[ 4.. 7] := { 0xf57c0faf, 0x4787c62a, 0xa8304613, 0xfd469501 }<br/>K[ 8..11] := { 0x698098d8, 0x8b44f7af, 0xffff5bb1, 0x895cd7be }<br/>K[12..15] := { 0x6b901122, 0xfd987193, 0xa679438e, 0x49b40821 }<br/>K[16..19] := { 0xf61e2562, 0xc040b340, 0x265e5a51, 0xe9b6c7aa }<br/>K[20..23] := { 0xd62f105d, 0x02441453, 0xd8a1e681, 0xe7d3fbc8 }<br/>K[24..27] := { 0x21e1cde6, 0xc33707d6, 0xf4d50d87, 0x455a14ed }<br/>K[28..31] := { 0xa9e3e905, 0xfcefa3f8, 0x676f02d9, 0x8d2a4c8a }<br/>K[32..35] := { 0xfffa3942, 0x8771f681, 0x6d9d6122, 0xfde5380c }<br/>K[36..39] := { 0xa4beea44, 0x4bdecfa9, 0xf6bb4b60, 0xbebfbc70 }<br/>K[40..43] := { 0x289b7ec6, 0xeaa127fa, 0xd4ef3085, 0x04881d05 }<br/>K[44..47] := { 0xd9d4d039, 0xe6db99e5, 0x1fa27cf8, 0xc4ac5665 }<br/>K[48..51] := { 0xf4292244, 0x432aff97, 0xab9423a7, 0xfc93a039 }<br/>K[52..55] := { 0x655b59c3, 0x8f0ccc92, 0xffeff47d, 0x85845dd1 }<br/>K[56..59] := { 0x6fa87e4f, 0xfe2ce6e0, 0xa3014314, 0x4e0811a1 }<br/>K[60..63] := { 0xf7537e82, 0xbd3af235, 0x2ad7d2bb, 0xeb86d391 }</span></pre><p id="c490" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我们还在每个操作中执行左位旋转，并且它们是为每个函数的每个操作设置的量。我们需要向左旋转的位用“s”表示。每个操作的s值如下所述。</p><pre class="lk ll lm ln gt nc nd ne nf aw ng bi"><span id="d430" class="mq lu ix nd b gy nh ni l nj nk">s[ 0..15] := { 7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22 }<br/>s[16..31] := { 5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20 }<br/>s[32..47] := { 4,11,16,23,4,11,16,23,4,11,16,23, 4,11,16,23 }<br/>s[48..63] := { 6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21 }</span></pre><p id="aa80" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">现在，我们有了执行每个操作所需的值，我们可以专注于每一轮操作以及它们是如何运行的。</p><h2 id="d642" class="mq lu ix bd lv mr ms dn lz mt mu dp md kv mv mw mf kz mx my mh ld mz na mj nb bi translated">5.输出消息摘要</h2><p id="2c5d" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">这里的图像显示了每个操作是如何发生的。在每一个操作中，都有一组被执行的功能，这些功能为我们提供输出，而输出又作为下一个操作的输入。</p><figure class="lk ll lm ln gt is gh gi paragraph-image"><div role="button" tabindex="0" class="lo lp di lq bf lr"><div class="gh gi nm"><img src="../Images/e3975c340a815eec0e85d19cf1b964f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jBxx1g-rpYt23nMG5BChow.png"/></div></div><figcaption class="nn no gj gh gi np nq bd b be z dk translated">每个操作的描述</figcaption></figure><p id="6181" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">我们一遍又一遍地执行这些操作，直到我们到达512位消息的最后一个块，因此在处理完最后一个块之后，我们获得的输出是实际的MD5散列，其id为128位，因为每个A、B、C &amp; D都是32位，它们组合在一起形成总共128位。</p><h1 id="1179" class="lt lu ix bd lv lw lx ly lz ma mb mc md kd me ke mf kg mg kh mh kj mi kk mj mk bi translated">结论</h1><p id="f513" class="pw-post-body-paragraph km kn ix ko b kp ml jy kr ks mm kb ku kv mn kx ky kz mo lb lc ld mp lf lg lh ij bi translated">MD5哈希算法已经被破解，基本上不应该在任何地方使用，比如银行和电子商务网站。看看MD5哈希算法的整个工作过程，让我们再看一遍。</p><blockquote class="nr ns nt"><p id="47f3" class="km kn nu ko b kp kq jy kr ks kt kb ku nv kw kx ky nw la lb lc nx le lf lg lh ij bi translated">需要散列的消息首先被分解成448位的片段，对于最后一个片段，我们进行填充。额外的64位被附加到它上面，使总位数为512位，这作为一个消息块继续前进。这个512比特的消息块被分成16个部分，每个部分32比特。然后作为我们在下一步中执行的操作的输入。现在让我们进入哈希算法的主要部分，总共有64个操作在512位消息块上执行。这些操作以我上面提到的默认值(A，B，C &amp; D)开始。这些操作中的每一个都执行一组函数，这些函数和它将要使用的值都已经定义好了。我们执行的64个操作也分为4个不同的循环，每个循环都有不同的函数集，我们分解的消息的32位部分充当输入(如上图所示),还有K(i)的预定义值，如上所述，下一步是执行向左旋转函数，程序向左旋转的位数也已定义。当整个操作完成后，它会将其值传递给下一个操作。在对第一个512位消息块执行64次这样的操作之后，输出接着被传递，以便对下一个512位执行下一个操作，直到到达最后一个消息块。我们从对最后一个消息块执行的操作中得到的输出是128位原始消息的散列。</p></blockquote><p id="30d4" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">这就是MD5算法全部功能的简短版本。</p><p id="f908" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated">如果你喜欢，请鼓掌让我们合作吧。获取、设置、破解！</p><p id="c7a1" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><strong class="ko iy">网站</strong>:<a class="ae li" href="https://www.aditya12anand.com/" rel="noopener ugc nofollow" target="_blank">aditya12anand.com</a>|<strong class="ko iy">捐款</strong>:<a class="ae li" href="https://paypal.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">paypal.me/aditya12anand</a><br/><strong class="ko iy">电报</strong>:<a class="ae li" href="https://t.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">https://t.me/aditya12anand</a><br/><strong class="ko iy">推特</strong>:<a class="ae li" href="https://twitter.com/aditya12anand?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">twitter.com/aditya12anand</a><br/><strong class="ko iy">LinkedIn</strong>:<a class="ae li" href="https://www.linkedin.com/in/aditya12anand/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/aditya12anand/</a><br/><strong class="ko iy">电子邮件</strong>:aditya12anand@protonmail.com</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="8bf1" class="pw-post-body-paragraph km kn ix ko b kp kq jy kr ks kt kb ku kv kw kx ky kz la lb lc ld le lf lg lh ij bi translated"><em class="nu">关注</em> <a class="ae li" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="nu"> Infosec报道</em> </a> <em class="nu">获取更多此类精彩报道。</em></p><div class="ip iq gp gr ir of"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="og ab fo"><div class="oh ab oi cl cj oj"><h2 class="bd iy gy z fp ok fr fs ol fu fw iw bi translated">信息安全报道</h2><div class="om l"><h3 class="bd b gy z fp ok fr fs ol fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="on l"><p class="bd b dl z fp ok fr fs ol fu fw dk translated">medium.com</p></div></div><div class="oo l"><div class="op l oq or os oo ot it of"/></div></div></a></div></div></div>    
</body>
</html>