<html>
<head>
<title>RSA Attacks: Common Modulus</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">RSA攻击:公共模数</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/rsa-attacks-common-modulus-7bdb34f331a5?source=collection_archive---------0-----------------------#2018-11-13">https://infosecwriteups.com/rsa-attacks-common-modulus-7bdb34f331a5?source=collection_archive---------0-----------------------#2018-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/4972bb9d0acdcf7c4f9f6045c6cb3c26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bUUwTFWP-96XyPTT7GbPAQ.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk translated">来源:<a class="ae jd" href="https://unsplash.com/photos/sZmIT85cV84" rel="noopener ugc nofollow" target="_blank"> Unsplash </a></figcaption></figure><div class=""/><p id="f369" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">RSA以<strong class="kf jh">Rivest–sha mir–ad leman</strong>命名，是一种在现代日常应用中广泛使用的公钥密码系统。更具体地说，RSA实现可以在PGP加密、数字签名、SSL、磁盘加密等中找到。</p><p id="789b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇文章描述了一种可以在RSA上执行的最简单的攻击。虽然这种攻击在现实世界中很少发生，但是如果您对密码学感兴趣，理解它是非常有用的，另外，我已经看到了许多可以通过这种攻击解决的CTF挑战。</p><h1 id="1edf" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">方案</h1><p id="8d39" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">考虑以下场景:</p><p id="3e88" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设<em class="me">鲍勃</em>想要s与<em class="me">爱丽丝</em>通信，并使用爱丽丝的公钥(n，e₁)用RSA加密消息。和往常一样，<em class="me">伊芙</em>在偷听消息。他成功地发送了几条消息，但是过了一会儿，由于CPU过热(或其他随机原因),一个位被意外翻转，消息被错误的公钥(n，e₂).)加密</p><p id="5fa4" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，假设Eve可以访问同一消息M的两个不同的密文，这两个不同的密文已经用不同的指数但共同的模数加密:</p><blockquote class="mf"><p id="7bca" class="mg mh jg bd mi mj mk ml mm mn mo la dk translated">ct₁= ₑ₁₎(me₍ₙ)</p><p id="218e" class="mg mh jg bd mi mj mk ml mm mn mo la dk translated">ct₂= ₑ₂₎(me₍ₙ)</p><p id="5b40" class="mg mh jg bd mi mj mk ml mm mn mo la dk translated">如果e₂的gcd(e₁= 1，gcd = 1，她可以恢复明文</p></blockquote><p id="49ad" class="pw-post-body-paragraph kd ke jg kf b kg mp ki kj kk mq km kn ko mr kq kr ks ms ku kv kw mt ky kz la ij bi translated">很有趣吧？但是请继续阅读下面的内容，进一步分析攻击是如何执行的，以及为什么一开始就有可能。</p><h1 id="efe4" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数学背景</h1><p id="6853" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">让我们首先确保支持攻击的数学是清楚的。</p><p id="4b70" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回想一下，RSA加密的执行过程如下:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/996aaaec75e738167c9e384d189df61b.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*EZgYlPrf7GaF2twfu-FDdg.png"/></div></figure><p id="af06" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，<strong class="kf jh">贝佐特定理</strong>指出，如果有整数<em class="me"> a </em>和<em class="me"> b </em>，它们都不为零，那么有整数<em class="me"> x </em>和<em class="me"> y </em>使得:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/2efd70d65718725ef9c818a5b867cf53.png" data-original-src="https://miro.medium.com/v2/resize:fit:352/format:webp/1*2ZwuBoulcRBPTxptxzh4qg.png"/></div></figure><p id="e56b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，让我们简单地修改一下模运算中的除法，它比常规运算稍微复杂一点。你很可能已经知道，mod <strong class="kf jh"> n </strong>中整数<strong class="kf jh"> a </strong>的乘法逆元是<strong class="kf jh"> x </strong>，其中<strong class="kf jh"> x </strong>由以下等式给出，也可以写成<strong class="kf jh"> a⁻ </strong>:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi na"><img src="../Images/77d47f42014347772a6d34da8e6fb17d.png" data-original-src="https://miro.medium.com/v2/resize:fit:292/format:webp/1*cvnKXFxflQknD-EN5rI3dg.png"/></div></figure><p id="df27" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，假设我们在mod 7 (Z₇).分数1/2 (2⁻)实际上是2的乘法倒数，在这种情况下是<strong class="kf jh"> 4 </strong> (2x4 = 1 (mod 7))。现在问题来了！根据Bezout的说法，如果分母<strong class="kf jh"> a </strong>和模数<strong class="kf jh"> n </strong>不是互质，那么分母不可逆mod <strong class="kf jh"> <em class="me"> n </em> </strong>。换句话说，分数1/a是无效的。类似于常规算术中的除以0。</p><h1 id="84d1" class="lb lc jg bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">攻击</h1><p id="5522" class="pw-post-body-paragraph kd ke jg kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">回到我们的上下文中，如果gcd(e₁<strong class="kf jh">，e₂)=1 </strong>，那么我们有整数<em class="me"> x </em>和<em class="me"> y </em>这样:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/fe0900f360106d54c5a7454cd07e5c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*azXxHzA4EuE_5ZQVk6x-GQ.png"/></div></figure><p id="a96a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，通过使用<strong class="kf jh">扩展的欧几里德算法</strong>，我们可以找到<em class="me"> x </em>和<em class="me"> y </em>，然后很容易证明明文可以恢复如下(所有的数学运算都在公共模中执行):</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/7abac4dc133f71996dea96d5d989d8d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*AfVkYZVMT_5qzGtgr82DDA.png"/></div></figure><p id="ebe9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然这个等式看起来很简单，但是计算起来有点复杂，因为通常情况下<strong class="kf jh"> y </strong>是一个负整数。因此，必须对Cʸ进行如下评估:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/2cbe1975a9cfceb2ed85a27c3f0be4ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*BxXMCtDl0BMIIYhoiRvJ3g.png"/></div></div></figure><p id="c9d0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如我们上面讨论的那样，为了使那个分数有效，C₂必须在模n中是可逆的。为了保持这一点，<strong class="kf jh"> gcd(C₂，n)=1 </strong>也必须保持(互质)。</p><p id="8836" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，为了实际恢复明文消息，攻击者必须计算:</p><figure class="mv mw mx my gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/2d66a3fc72fc914a95118c7906a5b19e.png" data-original-src="https://miro.medium.com/v2/resize:fit:240/format:webp/1*Oa6DeWBvoyfJr1dGhf1OQg.png"/></div></figure><p id="3530" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是破解全能RSA的全部代价！但是因为我们是程序员，我们讨厌用笔和纸做数学，这里有一个python脚本可以自动完成这个过程:</p><figure class="mv mw mx my gt is"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="67bd" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是一些示例密文、指数和模数，尝试检查您是否可以提取明文:</p><blockquote class="nh ni nj"><p id="491a" class="kd ke me kf b kg kh ki kj kk kl km kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">n = 10310906590233462022610116200879396350425602793917020091876799039690194735425901832050310642083250325252525290183205325252542902525325252925252525202525325203253252525292525252</p><p id="899b" class="kd ke me kf b kg kh ki kj kk kl km kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">ct1 = 9816552858889758135776273783468945136225275426454053812132813162649382585817815698098095910988729098290909829098290909890989099098999998989989899998998999989999989899998998998</p><p id="0308" class="kd ke me kf b kg kh ki kj kk kl km kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">e1 = 15</p><p id="6acb" class="kd ke me kf b kg kh ki kj kk kl km kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">ct2 = 1024751882475638482869459153804766780260285487632701088535293182515123667291516829151682915168978059761527270270151827516367291682916829168751675167516516751651653675436753753</p><p id="4863" class="kd ke me kf b kg kh ki kj kk kl km kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">e2 = 13</p></blockquote><p id="cb79" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">享受攻击RSA的乐趣吧！</p></div></div>    
</body>
</html>