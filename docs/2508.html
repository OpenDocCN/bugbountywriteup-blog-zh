<html>
<head>
<title>Interesting Account Takeover Bugs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有趣的帐户接管错误</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/interesting-account-takeover-bugs-in-the-wild-619df8466ca0?source=collection_archive---------2-----------------------#2022-11-05">https://infosecwriteups.com/interesting-account-takeover-bugs-in-the-wild-619df8466ca0?source=collection_archive---------2-----------------------#2022-11-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="de32" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">在这篇文章中，我们将会看到一种有趣的虫子，这种虫子在野外并不常见。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/77f4aafc08cb9d491183873d04e8a75a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LhHcxo1r1D-OfG-qbPCS2Q.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有趣的帐户接管错误写错误赏金猎人</figcaption></figure><p id="b1cb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我在做一个电子商务目标，它没有任何<strong class="kx ir">漏洞奖励计划或漏洞披露政策</strong>。但幸运的是，我看到该公司最近应用了一个补丁，并显示在<em class="lr">openbugbounty.org</em>页面上。</p><p id="49a6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">所以像往常一样，我开始侦察，很快我收集了所有的子域和公司的资产，包括电子邮件和收入信息。我发现了一些反映跨站脚本的错误，很快我报告了它们，但我仍然在等待，显然没有任何希望，等待他们的回复。反正进入正题。</p><p id="e521" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">几乎所有的网站都有用户注册和登录。</p><p id="9c27" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">于是我试着注册了一个账号。我一输入我的电子邮件id，它就向应用程序发送一个POST请求，以检查是否存在任何电子邮件。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="31b3" class="lx ly iq lt b gy lz ma l mb mc">POST /apicallback/webUsers/checkRegistered/ HTTP/2<br/>Host: www.redacted.com<br/>...<br/>...</span><span id="840b" class="lx ly iq lt b gy md ma l mb mc">{<br/>    "email":"thisistest123@gmail.com",<br/>    "keepLogged":true<br/>}</span></pre><p id="011b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果没有任何用户已经注册了该电子邮件，则响应为</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="eeba" class="lx ly iq lt b gy lz ma l mb mc">HTTP/2 200 OK<br/>Date: Fri, 04 Nov 2022 11:00:04 GMT<br/>Content-Type: text/html; charset=UTF-8<br/>...<br/>...</span><span id="0a0e" class="lx ly iq lt b gy md ma l mb mc">{"error":"0","errorMsg":"email id not registered"}</span></pre><p id="9fb3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">响应到达浏览器后，用户被重定向到密码页面。</p><p id="d8e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是，如果有任何帐户已经注册，那么它会发送帐户的所有信息，如电子邮件、注册日期、购物车id、购物车中的物品以及更多信息，包括<strong class="kx ir"> md5密码哈希</strong>。</p><pre class="kg kh ki kj gt ls lt lu lv aw lw bi"><span id="a0d6" class="lx ly iq lt b gy lz ma l mb mc">HTTP/2 200 OK<br/>Date: Fri, 04 Nov 2022 11:04:31 GMT<br/>Content-Type: text/html; charset=UTF-8<br/>Content-Length: 766<br/>...<br/>...</span><span id="9f2e" class="lx ly iq lt b gy md ma l mb mc">{"entity_id":"714467","entity_type_id":"1","attribute_set_id":"0","website_id":"1","email":"thisistest123@gmail.com","group_id":"1","store_id":"1","created_at":"2022-11-04 08:27:51","updated_at":"2022-11-04 08:27:49","is_active":"1","batch_id":"3","created_in":"Default Store View","password_hash":"482c811da5d5b4bc6d497ffa98491e38","is_subscribe":1,"addresses":[],"menu_data":[{"page_id":3,"title":"ABOUT US"},{"page_id":4,"title":"CONTACT US"},{"page_id":6,"title":"SHIPPING"},{"page_id":7,"title":"RETURNS"},{"page_id":8,"title":"HELP"},{"page_id":9,"title":"TERMS"},{"page_id":10,"title":"PRIVACY"},{"page_id":11,"title":"CAREERS"}],"caching_time":900,"image_caching_time":90000,"Cards":[],"cardsCount":0,"error":"1","errorMsg":"User already exist","otp":938061}</span></pre><p id="ebd4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是实际的图像。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi me"><img src="../Images/26437fb5817b9296b60e297996cf2cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F8UzI0AiqaK2xCvTvmg60A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有趣的帐户接管错误写错误赏金猎人</figcaption></figure><p id="88d0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你仔细观察这个回答，你会发现。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mf"><img src="../Images/9fc77a7965dac319df3a5b604232c0e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5a9RI9CsRpgxLXBLtZ05ow.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有趣的帐户接管错误写错误赏金猎人</figcaption></figure><p id="d375" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">于是我瞬间复制了<strong class="kx ir"> md5密码哈希</strong>并解码。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/613aaad920661d2beedffc265501a57f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5Dejyr7UeYO32Haxx640ng.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">有趣的帐户接管错误写错误赏金猎人</figcaption></figure><p id="09aa" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并检索密码为<strong class="kx ir"> password123 </strong></p><p id="e5cd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我瞬间做了POC，报了公司。</p><p id="c753" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你喜欢读这篇文章，那就看看我们其他相关主题的文章。</p><p id="7e42" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们连接起来</p><p id="6319" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Twitter:<code class="fe mh mi mj lt b"><a class="ae mk" href="https://twitter.com/proton_sec" rel="noopener ugc nofollow" target="_blank">proton_sec</a></code><br/>GitHub:<code class="fe mh mi mj lt b"><a class="ae mk" href="https://github.com/proton-sec" rel="noopener ugc nofollow" target="_blank">proton-sec</a></code><br/>LinkedIn:<code class="fe mh mi mj lt b"><a class="ae mk" href="https://www.linkedin.com/in/protonsec/" rel="noopener ugc nofollow" target="_blank">protonsec</a></code></p><p id="b05a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你想欣赏和支持我的工作，给你…</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.buymeacoffee.com/protonsec"><div class="gh gi ml"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></a></figure><p id="92d7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读。</p></div><div class="ab cl mm mn hu mo" role="separator"><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr ms"/><span class="mp bw bk mq mr"/></div><div class="ij ik il im in"><h2 id="1892" class="lx ly iq bd mt mu mv dn mw mx my dp mz le na nb nc li nd ne nf lm ng nh ni nj bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae mk" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>