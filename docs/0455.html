<html>
<head>
<title>Would you notice if you are hacked this way?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如果你被这样黑，你会注意到吗？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/would-you-notice-if-you-are-hacked-this-way-db3ba1a512e9?source=collection_archive---------0-----------------------#2019-12-21">https://infosecwriteups.com/would-you-notice-if-you-are-hacked-this-way-db3ba1a512e9?source=collection_archive---------0-----------------------#2019-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="52a5" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Android安全性</h1><p id="598d" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">[免责声明:仅用于教育目的]</p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="09cf" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">你好，</p><p id="c0ea" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">在本帖中，我们将讨论一个有趣的漏洞，这个漏洞存在于当今的android设备上，可能会被黑客利用。</p><p id="dbb3" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">该漏洞名为Strandhogg，由<a class="ae lv" href="https://promon.co/security-news/strandhogg/" rel="noopener ugc nofollow" target="_blank"> Promon </a>于12月第一周发布。黑客利用这个漏洞能做什么？</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/b386137db940de2eb99bb538553f742c.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*4ZuHfMkHyt39BYEcb9p-Dg.png"/></div></figure><p id="019a" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">准备好大吃一惊吧，以下是清单:</p><ul class=""><li id="a457" class="lz ma iq kn b ko lq ks lr kw mb la mc le md li me mf mg mh bi translated">他们可以通过麦克风听用户说话</li><li id="03f5" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">通过相机拍照</li><li id="57b4" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">阅读和发送短信</li><li id="ccf1" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">制作和/或记录电话对话</li><li id="8b41" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">费西合唱团登录凭证/劫持社交媒体账户</li><li id="0e89" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">访问设备上的所有私人照片和文件</li><li id="3cf6" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">获取位置和GPS信息</li><li id="3d34" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">访问联系人列表</li><li id="77a2" class="lz ma iq kn b ko mi ks mj kw mk la ml le mm li me mf mg mh bi translated">访问电话记录</li></ul><p id="3e31" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">最重要的是，这个漏洞存在于<strong class="kn ir">所有</strong>安卓版本上，包括最新的安卓10。</p><p id="3670" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><strong class="kn ir">那么这个漏洞到底是什么，它是如何被利用的？</strong></p><p id="12b6" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">要回答这个问题，我们先来稍微挖掘一下Android系统细节。</p><p id="d0cc" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">任何典型的Android应用都是由多个<a class="ae lv" href="https://developer.android.com/reference/android/app/Activity" rel="noopener ugc nofollow" target="_blank">活动</a>组成的。通俗地说，每当你点击任何应用程序图标时，出现在设备上的屏幕通常是一个活动。可以有更多的活动，这取决于应用程序的功能，但为了简单起见，让我们说应用程序的每个新用户界面都是一个新的活动(但并不总是这样，Android支持其他东西，如片段等)。每个活动都有一组已定义的属性，可以在名为<a class="ae lv" href="https://developer.android.com/guide/topics/manifest/manifest-intro" rel="noopener ugc nofollow" target="_blank"> AndroidManifest </a>的XML文件中找到定义。它看起来是这样的:</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mn"><img src="../Images/ac8b5b24337053c046f40da18ec392c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-11AoWJ-jyLwhm0a36H2w.png"/></div></div></figure><p id="49c2" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">你看，每个<activity>标签都有多个属性，如名称、标签等。在这种情况下，感兴趣的是<strong class="kn ir"> taskAffinity </strong>。那么这个标签是如何被使用的呢？在理解这一点之前，让我们更深入地了解一下Android任务。</activity></p><blockquote class="ms mt mu"><p id="3736" class="kl km mv kn b ko lq kq kr ks lr ku kv mw ls ky kz mx lt lc ld my lu lg lh li ij bi translated">任务是用户在执行某项工作时与之交互的活动的集合。活动按照每个活动打开的顺序排列在一个堆栈中，即<em class="iq">后堆栈</em>)。例如，电子邮件应用程序可能有一个显示新邮件列表的活动。当用户选择一条消息时，会打开一个新的活动来查看该消息。这个新活动被添加到后台堆栈中。如果用户按下<strong class="kn ir"> Back </strong>按钮，新的活动完成并弹出堆栈。</p></blockquote><p id="d1d5" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">因此，通常一个应用程序的所有活动都与一个任务相关联。当它们被打开时，它们被推到与该任务相关的后台堆栈上。每当你通过点击图标或通知或按back来启动一个应用程序时，这个任务堆栈就会被引用，相应地，Android系统会将右侧视图显示在前台。</p><p id="f1d2" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">默认情况下，应用程序中的所有活动都具有相同的关联性，这意味着它们属于一起，因此被放在同一个堆栈中。但是，您可以设置“taskAffinity”属性来对它们进行不同的分组，甚至将不同应用程序中定义的活动放在同一个任务中。使用taskAffinity，用户可以更改活动关联的应用程序。因此，如果对于我的计算器应用程序，对于其中一个活动，我将taskAffinity设置为脸书应用程序而不是我的应用程序，这个特定的活动可能会位于脸书应用程序而不是计算器应用程序的堆栈中。你看到这里的问题了吗？</p><p id="973f" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">如果你看到了，这就是问题所在。所以黑客编写了一个具有不同活动的应用程序。假设其中一个人对脸书应用程序有taskAffinity。现在，当这个恶意应用程序启动时，脸书应用程序的taskAffinity活动已经为脸书应用程序启动了一个堆栈，现在，如果你在启动器上单击脸书应用程序图标，Android系统会检查这个堆栈，并显示恶意应用程序的活动，而不是实际的脸书应用程序。</p><p id="38bd" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">将taskAffinity与其他标志(如<strong class="kn ir"> FLAG_ACTIVITY_CLEAR_TASK、FLAG_ACTIVITY_NEW_TASK、FLAG_ACTIVITY_MULTIPLE_TASK </strong>)结合起来，最终会给流程中的黑客更多的控制权。</p><figure class="lj lk ll lm gt ln gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mz"><img src="../Images/444cca4c3ee628bce1475a8bdd805dd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X2yDoBgEcbgDVX13jNyMFw.png"/></div></div></figure><p id="0c72" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">一个人可以在这种行为的基础上设计的利用只受到想象力的限制。</p><p id="ea55" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><strong class="kn ir">那么这真的有用吗？</strong></p><p id="b9a7" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">是的，我试图通过创建一个与另一个合法应用程序相似的应用程序来测试这一点，它可以在包括Pixel在内的大多数设备上工作。然而，对于系统应用程序或特定的谷歌应用程序，我发现这种行为不太可靠。</p><p id="0856" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><strong class="kn ir">你觉得怎么样？</strong></p><figure class="lj lk ll lm gt ln"><div class="bz fp l di"><div class="na lp l"/></div></figure><p id="73be" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><strong class="kn ir">为什么我们在Android上还有它？</strong></p><p id="20fd" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">由于Android操作系统被设计为支持多任务，这个属性变得很重要。它为用户提供了无缝的应用体验和交互。这只是一个猜测，但是要摆脱它可能需要在操作系统层面上进行重大的重新设计。</p><p id="213f" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">所以，这个帖子到此为止。</p><p id="dd22" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">希望这篇文章有助于澄清Android设备上现有的漏洞。如果你喜欢它，请留下评论/掌声。更多有趣的帖子，点击下面的按钮！</p><p id="bec3" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">我很快会在下一篇文章中看到你，在那之前注意安全，留意你手机上的奇怪行为。</p><p id="5b7d" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">保持警惕！</p><p id="291a" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated">参考资料:</p><div class="nb nc gp gr nd ne"><a href="https://promon.co/security-news/strandhogg/" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">StrandHogg:严重的Android漏洞使大多数应用程序容易受到攻击。</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">约翰·赫格-奥姆达尔、卡内尔·卡亚和马库斯·奥顿斯曼·普罗蒙安全研究人员发现了一个…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">promon.co</p></div></div><div class="nn l"><div class="no l np nq nr nn ns lx ne"/></div></div></a></div><div class="nb nc gp gr nd ne"><a href="https://blog.mindorks.com/android-task-and-back-stack-review-5017f2c18196" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">Android任务和后台堆栈审查</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">Android活动是我们希望用户浏览的屏幕的逻辑结构。…的关系</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">blog.mindorks.com</p></div></div><div class="nn l"><div class="nt l np nq nr nn ns lx ne"/></div></div></a></div><p id="3e79" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><a class="ae lv" href="https://developer.android.com/guide/topics/manifest/activity-element.html#aff" rel="noopener ugc nofollow" target="_blank">https://developer . Android . com/guide/topics/manifest/activity-element . html</a></p></div><div class="ab cl nu nv hu nw" role="separator"><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz oa"/><span class="nx bw bk ny nz"/></div><div class="ij ik il im in"><p id="6caf" class="pw-post-body-paragraph kl km iq kn b ko lq kq kr ks lr ku kv kw ls ky kz la lt lc ld le lu lg lh li ij bi translated"><em class="mv">关注</em> <a class="ae lv" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mv"> Infosec报道</em> </a> <em class="mv">获取更多此类精彩报道。</em></p><div class="nb nc gp gr nd ne"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="nf ab fo"><div class="ng ab nh cl cj ni"><h2 class="bd ir gy z fp nj fr fs nk fu fw ip bi translated">信息安全报道</h2><div class="nl l"><h3 class="bd b gy z fp nj fr fs nk fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="nm l"><p class="bd b dl z fp nj fr fs nk fu fw dk translated">medium.com</p></div></div><div class="nn l"><div class="ob l np nq nr nn ns lx ne"/></div></div></a></div></div></div>    
</body>
</html>