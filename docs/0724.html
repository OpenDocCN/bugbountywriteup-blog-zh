<html>
<head>
<title>Bypassing OTP via reset password</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过重置密码绕过OTP</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bypassing-otp-via-reset-password-f004a29020c?source=collection_archive---------1-----------------------#2020-07-30">https://infosecwriteups.com/bypassing-otp-via-reset-password-f004a29020c?source=collection_archive---------1-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3353" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将解释我是如何通过电子邮件地址重置密码来绕过一次性密码的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/e6a43995a9322b05476167a4296cbf73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWq4E5QWf1BdOlZ8Z72mkg.png"/></div></div></figure><blockquote class="kx ky kz"><p id="2a8f" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated">我在一个私人程序中发现了这个漏洞，我将它命名为:<strong class="jp ir"><em class="iq">【target.com】</em></strong>，在我们继续解释之前，我们应该考虑到这个漏洞是由于错误地应用了通过API重置密码的方法，导致了响应中用户live token的泄漏。</p></blockquote><p id="6a30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi le translated"><span class="l lf lg lh bm li lj lk ll lm di"> W </span>当我在这个目标中进行侦察时，我意识到所有的函数无一例外都与一个API直接相关，这个目标是它的API的一个接口，所以从函数扫描bug开始是有意义的，当我检查帐户设置时，我发现了通过电话号码选项进行OTP，所以我打开它并注销。</p><p id="65f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我直接登录并决定检查速率限制绕过和其他与OTP相关的bug，但不幸的是，API本身有一个速率限制实现，我无法绕过它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ln"><img src="../Images/d8694bd9aa77cd2bfefa4965e62b23b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yQxhxN2ogieu9r8ZnrmZEQ.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">速率限制机制响应</figcaption></figure><p id="d30b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我还检查了是否可以通过电子邮件地址重置密码来绕过OTP，但该应用程序会要求我使用新密码再次登录，并插入通过短信发送的6位OTP代码，因此我无法通过这种方式绕过它。</p><p id="afaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以是时候检查每个请求及其响应了，我打开了我的拦截并开始检查重置密码方法响应，没有什么有趣的，我登录到我的测试帐户电子邮件并检查重置密码链接，链接中的令牌很复杂，我不能暴力破解它。</p><p id="5221" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我请求链接并插入我的新密码，我按下更改我的密码按钮并检查响应，我可以确认重置密码API方法为我的帐户设置了一个新的实时令牌，并在响应中泄露了令牌，通过这个实时令牌，我能够通过API使用帐户中的所有方法，而无需登录到应用程序界面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ls"><img src="../Images/c990e0b1e27d1b99a25526a48df5143a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gtbfcRTseLkB1WHzGKw0Zg.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">响应中的令牌泄漏</figcaption></figure><p id="f386" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但我选择了在不登录的情况下停止OTP的方法，在检查帐户设置后，我能够找到通过电话号码停止OTP的API请求，因此我在中继器中输入了该请求，我能够通过API live token停止OTP并登录到应用程序界面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lt"><img src="../Images/fe8e29acf241b3177e252b6edd63463e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4PSm52DsCck3AH17LTblA.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk translated">禁用OTP API请求</figcaption></figure><h1 id="1f1e" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><strong class="ak"> <em class="ms">汇总</em> </strong></h1><blockquote class="kx ky kz"><p id="a693" class="jn jo la jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated">我能够通过电子邮件地址重置密码来绕过OTP，我们应该考虑到我能够通过重置密码方法响应中泄漏的API live令牌来使用帐户中的每一种方法，但我更喜欢找到方法来停止OTP，并且我通过禁用OTP API请求来停止它，因此我能够在不需要插入OTP代码的情况下打开我的帐户。</p></blockquote><h1 id="b3ad" class="lu lv iq bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated"><strong class="ak"> <em class="ms">时间轴</em> </strong></h1><p id="e83f" class="pw-post-body-paragraph jn jo iq jp b jq mt js jt ju mu jw jx jy mv ka kb kc mw ke kf kg mx ki kj kk ij bi translated">报告(7月7日)。<br/>首次回应(7月7日)。</p></div><div class="ab cl my mz hu na" role="separator"><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd ne"/><span class="nb bw bk nc nd"/></div><div class="ij ik il im in"><p id="db4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">别忘了在Twitter上关注我，这样你就不会错过我的新评论和文章。感谢你阅读我的第一篇文章，非常感谢。</p></div></div>    
</body>
</html>