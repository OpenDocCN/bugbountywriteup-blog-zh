<html>
<head>
<title>How I found my first AEM related bug.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何发现我的第一个AEM相关的bug。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-found-my-first-aem-related-bug-5ea901aad3f4?source=collection_archive---------0-----------------------#2021-09-11">https://infosecwriteups.com/how-i-found-my-first-aem-related-bug-5ea901aad3f4?source=collection_archive---------0-----------------------#2021-09-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3f70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，所有了不起的黑客和网络安全爱好者。我叫韦丹特(在推特上也叫贝吉塔😁)而我是一个有抱负的bug赏金猎人，也是一个网络安全爱好者。今天我想和你分享一个关于我如何发现我的第一个AEM相关bug的故事:)首先，我想告诉你，我仍然在学习关于AEM的知识，我发现这个问题仅仅是通过应用我目前所学的知识。所以事不宜迟，让我们开始吧。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/23ce3df234a30801cd60c1d79da1d11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LzF7LBTEg1tLs0dpT0JjQ.jpeg"/></div></div></figure><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="ky kz l"/></div></figure><h1 id="c449" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated"><strong class="ak">背景:- </strong></h1><p id="1296" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">所以在理解真正的bug之前，你必须了解一些事情。一、AEM是什么？<em class="md">“Adobe Experience Manager(AEM)，是一个全面的内容管理解决方案，用于构建网站、移动应用程序和表单。它还能让您轻松管理营销内容和资产。”基本上AEM是一个CMS，就像Wordpress和Drupal一样。</em></p><p id="daba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来是Querybuilder servlet，<em class="md"> "AEM Query Builder是由adobe开发的一个框架，用于为查询引擎(OAK Query Engine)构建查询</em>  <em class="md">(下面是JCR XPath)，这些查询很容易编写。查询可以被描述为一组简单的键值形式的谓词。</em>你可以在这里了解更多<a class="ae kl" href="https://experienceleague.adobe.com/docs/experience-manager-64/developing/platform/query-builder/querybuilder-api.html?lang=en" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9418" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后但同样重要的是，调度员。<em class="md">“Dispatcher”是</em><strong class="jp ir"><em class="md">Adobe Experience Manager的缓存和/或负载平衡工具</em> </strong> <em class="md">。使用AEM的Dispatcher还有助于保护AEM服务器免受攻击"</em>你可以把AEM dispatcher想象成一个WAF。</p><h1 id="c261" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">漏洞:-</h1><p id="d561" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">所以在7月份，我在Hackerone平台上发现了很多重复的和信息性的错误，对此我有点沮丧。每当我在寻找bug时感到气馁，我就会想起这句话，<strong class="jp ir">“如果你的生活变得更艰难，你就变得更好了”</strong>我决定学习一些新的bug类型，在搜索了一段时间后，我发现了<a class="ae kl" href="https://www.youtube.com/watch?v=EQNBQCQMouk" rel="noopener ugc nofollow" target="_blank">Mikhail ego ROV的这个</a>精彩演讲，他谈到了AEM相关的bug。这对我来说是全新的，所以我决定探索更多，阅读所有我能找到的关于AEM相关漏洞的文章。我对一些事情有了一个基本的想法，并决定应用我到目前为止学到的东西。所以我选择了一个程序来破解。我已经收集了子域名，并多次试图寻找其中的漏洞，但没有找到任何漏洞，但这一次不同。</p><p id="50f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我检查了每个子域，并用wappalyzer检查了一个使用AEM的子域，过了一会儿，我发现了一个使用AEM构建的子域。然后我开始模糊查找querybuilder servlet，通过利用它，攻击者可以读取内部路径。我手动模糊是因为试图绕过调度员很有趣😁。我尝试了下面的有效负载，网站总是响应404错误，但我一直在尝试一些有效负载来绕过调度程序。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi me"><img src="../Images/ecd6944e9d6e8405ab83891f5c8df886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8pg9C2hnYbT5fCMCCXGLSQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk translated">归功于米哈伊尔·叶戈罗夫。</figcaption></figure><p id="3368" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上图所示，我们可以使用/a.css、/a.png等来迷惑dispatcher，让我们访问querybuilder servlet。所以在尝试了类似的有效载荷后，有一个成功了！最终的有效载荷看起来像这样，</p><p id="eb34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">有效载荷:- </strong></p><p id="e8bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">'/bin/query builder . JSON；%0aa.css？path =/etc&amp;p . hits = full&amp;p . limit =-1 '</strong></p><p id="b2ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以读取/etc、/home、/content等目录的内容。你也可以使用automation找到这样的bug，有很多AEM相关bug的nuclei模板，你可以在这里查看<a class="ae kl" href="https://github.com/projectdiscovery/nuclei-templates/tree/master/misconfiguration/aem" rel="noopener ugc nofollow" target="_blank">。我很快报告了这个问题，两天后问题得到了解决！一个星期后，我获得了1000美元的奖金:)</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/f862a525d2da6c10a3a7a43d3c798ae5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*DGUXxAsr8I0UNHaMtiloVA.jpeg"/></div></figure><p id="2aab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有很多有趣的AEM相关漏洞，AEM确实是一个庞大的主题，但探索起来非常有趣。我希望你在阅读这篇文章时学到了一些新东西，如果你有任何问题，你可以在这里联系我。如果你喜欢读这篇文章，请鼓掌并与你的朋友分享。谢谢大家！</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mk kz l"/></div></figure></div></div>    
</body>
</html>