<html>
<head>
<title>Safe Opener — Reverse Engineering | PicoCTF 2022 Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保险箱开启器—逆向工程| PicoCTF 2022详细报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/safe-opener-reverse-engineering-picoctf-2022-writeup-21b22937b6ae?source=collection_archive---------3-----------------------#2022-12-27">https://infosecwriteups.com/safe-opener-reverse-engineering-picoctf-2022-writeup-21b22937b6ae?source=collection_archive---------3-----------------------#2022-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3d6d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">保险箱开启者—皮可CTF 100分逆向工程挑战赛| Karthikeyan Nagaraj</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/eb006b5bdd9ec0989a47b43e71dcfbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*MemKKFCoSUlL9nmK1Qyqww.png"/></div></div></figure><p id="db65" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe ln lo lp lq b">Description:<br/>Can you open this safe?<br/>I forgot the key to my safe but this <a class="ae lr" href="https://artifacts.picoctf.net/c/463/SafeOpener.java" rel="noopener ugc nofollow" target="_blank">program</a> is supposed to help me with retrieving the lost key. Can you help me unlock my safe?</code></p><p id="abcc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">任务文件:</strong> <br/>下载任务文件<a class="ae lr" href="https://artifacts.picoctf.net/c/463/SafeOpener.java" rel="noopener ugc nofollow" target="_blank">SafeOpener.java这里</a>T10】https://artifacts.picoctf.net/c/463/SafeOpener.java</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="b496" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">分析:</h1><h2 id="8567" class="mr ma iq bd mb ms mt dn mf mu mv dp mj la mw mx ml le my mz mn li na nb mp nc bi translated">保险箱开启器的程序代码:java</h2><pre class="kg kh ki kj gt nd lq ne bn nf ng bi"><span id="b7c2" class="nh ma iq lq b be ni nj l nk nl">import java.io.*;<br/>import java.util.*;  <br/>public class SafeOpener {<br/>    public static void main(String args[]) throws IOException {<br/>        BufferedReader keyboard = new BufferedReader(new InputStreamReader(System.in));<br/>        Base64.Encoder encoder = Base64.getEncoder();<br/>        String encodedkey = "";<br/>        String key = "";<br/>        int i = 0;<br/>        boolean isOpen;<br/><br/>        while (i &lt; 3) {<br/>            System.out.print("Enter password for the safe: ");<br/>            key = keyboard.readLine();<br/><br/>            encodedkey = encoder.encodeToString(key.getBytes());<br/>            System.out.println(encodedkey);<br/>              <br/>            isOpen = openSafe(encodedkey);<br/>            if (!isOpen) {<br/>                System.out.println("You have  " + (2 - i) + " attempt(s) left");<br/>                i++;<br/>                continue;<br/>            }<br/>            break;<br/>        }<br/>    }<br/>    <br/>    public static boolean openSafe(String password) {<br/>        String encodedkey = "cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz";<br/>        <br/>        if (password.equals(encodedkey)) {<br/>            System.out.println("Sesame open");<br/>            return true;<br/>        }<br/>        else {<br/>            System.out.println("Password is incorrect\n");<br/>            return false;<br/>        }<br/>    }<br/>}</span></pre><h2 id="b6fc" class="mr ma iq bd mb ms mt dn mf mu mv dp mj la mw mx ml le my mz mn li na nb mp nc bi translated">SafeOpener.java的输出:</h2><p id="06d5" class="pw-post-body-paragraph kr ks iq kt b ku nm jr kw kx nn ju kz la no lc ld le np lg lh li nq lk ll lm ij bi translated">编译java程序，并通过以下命令执行它<br/>确保给出<code class="fe ln lo lp lq b">javac</code>文件的路径，就像我在截图中给出的那样</p><pre class="kg kh ki kj gt nd lq ne bn nf ng bi"><span id="cd70" class="nh ma iq lq b be ni nj l nk nl">javac SafeOpener.java<br/>java SafeOpenerChecks whether the </span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/dd98fac4274946aca7cec866f62a23ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*NdCoFqcdB0zhzuMA9m2BVA.png"/></div></figure><ol class=""><li id="6574" class="ns nt iq kt b ku kv kx ky la nu le nv li nw lm nx ny nz oa bi translated">该程序有一个条件语句<code class="fe ln lo lp lq b">while</code>，它将执行循环3次</li><li id="37e2" class="ns nt iq kt b ku ob kx oc la od le oe li of lm nx ny nz oa bi translated">每次我们输入的字符串都被转换成<code class="fe ln lo lp lq b">base64</code>并传递给一个名为openSafe的方法</li><li id="084a" class="ns nt iq kt b ku ob kx oc la od le oe li of lm nx ny nz oa bi translated">该方法检查给定的base64代码是否匹配一个<code class="fe ln lo lp lq b">encodedkey</code>——它是编码格式的标志</li><li id="016f" class="ns nt iq kt b ku ob kx oc la od le oe li of lm nx ny nz oa bi translated">如果给定的编码字符串等于encodedkey，那么它将打印<em class="og">“芝麻开门”</em></li></ol><h2 id="38fe" class="mr ma iq bd mb ms mt dn mf mu mv dp mj la mw mx ml le my mz mn li na nb mp nc bi translated">解决方案:</h2><p id="7486" class="pw-post-body-paragraph kr ks iq kt b ku nm jr kw kx nn ju kz la no lc ld le np lg lh li nq lk ll lm ij bi translated"><strong class="kt ir">简单地解码base64中的encoded key</strong>会给你一个标志<br/>使用命令行或任何其他在线解码器来解码</p><pre class="kg kh ki kj gt nd lq ne bn nf ng bi"><span id="a26b" class="nh ma iq lq b be ni nj l nk nl">echo "cGwzYXMzX2wzdF9tM18xbnQwX3RoM19zYWYz" | base64 -d</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/e016efaeb6d84c93e77e496dde946d6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*QgfdYXY46nPHxT2eeH4j2A.png"/></div></figure><pre class="kg kh ki kj gt nd lq ne bn nf ng bi"><span id="1ef2" class="nh ma iq lq b be ni nj l nk nl">Ans: picoCTF{pl3as3_l3t_m3_1nt0_th3_saf3}</span></pre></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="95ba" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您的阅读！！</p><p id="338b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">逆向工程快乐~</p><pre class="kg kh ki kj gt nd lq ne bn nf ng bi"><span id="46e6" class="nh ma iq lq b be ni nj l nk nl">Author: Karthikeyan Nagaraj</span></pre><p id="20ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">picoctf，ctf，逆向工程，写作，初学者挑战，karthikeyan nagaraj，cyberw1ng</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="d156" class="mr ma iq bd mb ms mt dn mf mu mv dp mj la mw mx ml le my mz mn li na nb mp nc bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lr" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>