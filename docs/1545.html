<html>
<head>
<title>How did I earned 6000$ from tokens and scopes in one day</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何在一天之内从代币和望远镜中赚到6000美元的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-did-i-earned-6000-from-tokens-and-scopes-in-one-day-12f95c6bf8aa?source=collection_archive---------1-----------------------#2021-08-26">https://infosecwriteups.com/how-did-i-earned-6000-from-tokens-and-scopes-in-one-day-12f95c6bf8aa?source=collection_archive---------1-----------------------#2021-08-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="95ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不常做昆虫赏金，因为很难找到有趣的东西，也很难成为第一个记者… <strong class="jp ir">但是前几天不一样。</strong></p><p id="7d38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我打开我的电子邮件，看到了一个私人黑客程序的邀请。我看了一下，奖金很诱人，所以我说为什么不呢？</p><p id="dab0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一阶段(侦察)</strong></p><p id="9ebd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">范围非常小，只有两台主机:</p><blockquote class="kl km kn"><p id="9b73" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">api.company.com</p><p id="06af" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">app.company.com</p></blockquote><p id="4715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我创建了一个账户，然后我开始用打嗝来嗅我的流量，首先发现<strong class="jp ir">用Auth0 </strong>处理认证，<strong class="jp ir"> Express。JS </strong>用于网络，JWT<strong class="jp ir">用于会话。</strong></p><p id="3b9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试的第一件事是<strong class="jp ir">将JWT的alg</strong>改为none，然后冒充某个员工<strong class="jp ir">，但是这太明显了</strong>。None不是一个有效的算法表示一个错误信息。</p><p id="d3db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序的一个特性是<strong class="jp ir">你可以邀请用户加入一个群组，然后改变他们帐户的权限/范围。</strong></p><p id="c680" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那时，我非常专注于获得特权，并将我帐户升级为雇员。<strong class="jp ir">在阅读了数千行javascript代码后</strong>我意识到有些作用域没有出现在编辑用户权限菜单中…</p><p id="e78d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二阶段(获得特权)</strong></p><p id="0d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我检测到2个有趣的范围:<strong class="jp ir"> <em class="ko">公司:支持</em> </strong>和<strong class="jp ir"> <em class="ko">公司:运营</em> </strong></p><p id="745d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们的名字是<strong class="jp ir">，告诉我这些范围是保留给员工的</strong>，所以我尝试的第一件事是:邀请其他用户加入群组，然后将他的范围改为员工的范围。</p><p id="9f36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Kids stuff </strong> …用打嗝拦截请求，然后欺骗scopes参数。200 OK从服务器，在这一点上，我可以收到赏金，但我想要更多…</p><p id="9b81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三阶段(确认一下)</strong></p><p id="b71c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们有了拥有员工权限的帐户，但应用程序似乎是一样的，没有更改，没有管理操作。<strong class="jp ir">所以又回去侦察了。</strong></p><p id="ac52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在javascript库里面有一个我以前没有见过的服务的api引用，在下面的一个评论里，它说了这样的话:🥳员工运营服务</p><p id="2a81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我尝试了什么？您猜对了，向那个api引用发送一个请求，然后祈祷得到一个200 OK。</p><p id="6015" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，我确认了权限提升。</p><p id="d113" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向程序报告，<strong class="jp ir"> 9.9 CVSS 3.1和3000美元赏金。</strong></p><p id="ec8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等等！你说6000美元？</p><p id="b55f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有另一个功能:你可以为你的帐户创建API键…并为其分配范围！🤭🤭🤭</p><p id="56fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">拦截api生成请求，用employees欺骗参数范围，这样就完成了！<strong class="jp ir">另外9.9 cvss 3.1和3000$ </strong></p></div></div>    
</body>
</html>