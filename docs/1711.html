<html>
<head>
<title>[Day 8] Special by John Hammond Santa’s Bag of Toys | Advent of Cyber 3 (2021)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[第8天]约翰·哈蒙德圣诞老人的玩具袋特辑|网络3的来临(2021年)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/day-8-special-by-john-hammond-santas-bag-of-toys-advent-of-cyber-3-2021-8b9a04895096?source=collection_archive---------3-----------------------#2021-12-12">https://infosecwriteups.com/day-8-special-by-john-hammond-santas-bag-of-toys-advent-of-cyber-3-2021-8b9a04895096?source=collection_archive---------3-----------------------#2021-12-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="424e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将学习Windows中一些取证分析。</p><p id="908d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">让我们开始吧……</strong></p><p id="264b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.看完上面的前提，启动附带的Windows分析机，在桌面的<code class="fe kl km kn ko b">SantasLaptopLogs</code>文件夹中找到转录日志。</p><p id="0155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想要RDP到机器中，启动AttackBox并在终端中输入以下内容:xfreerdp/u:Administrator/p:Grinch 123！/v:MACHINE_IP —该计算机的凭据是作为用户名的Administrator和grinch123！作为密码。</p><blockquote class="kq kr ks"><p id="a16a" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">只需点击<strong class="jp ir">问题完成</strong></p></blockquote><p id="f071" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个转录日志都是一个简单的纯文本文件，可以在您选择的任何编辑器中打开。虽然文件名是随机的，但是通过查看修改日期或创建日期属性，或者文件扩展名之前的时间戳，您可以知道哪个日志“最先出现”!</p><p id="4db4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我整理了日志，并在文件名的开头用一个数字给它重新命名。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi kw"><img src="../Images/30d3d3432351dee7fa8c0386edc6ac42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hwG3ruGPaK6Q8gxL_BhEg.png"/></div></div></figure><p id="3b8c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开第一个转录日志。您可以看到PowerShell中运行的所有命令和输出，比如<code class="fe kl km kn ko b">whoami</code>和<code class="fe kl km kn ko b">systeminfo</code>！</p><p id="e7de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.圣诞老人的笔记本电脑运行的是什么操作系统(“OS Name”)？</p><blockquote class="kq kr ks"><p id="02e2" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">微软视窗11专业版</p></blockquote><p id="7c8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">检查第一个日志文件，并在<strong class="jp ir"> systeminfo </strong>命令下查看。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi li"><img src="../Images/68870c7300a89662e7fd435d1a59fa68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9qYHzavdj3EF-wOwiQFhqA.png"/></div></div></figure><p id="45e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.查看每个转录日志，了解笔记本电脑丢失后在其上执行了什么活动。在“第二”转录日志中，看起来好像是犯罪者创建了一个后门用户帐户！</p><p id="86da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新“后门”账户的密码是什么？</p><blockquote class="kq kr ks"><p id="0130" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">圣诞假期</p></blockquote><p id="7016" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我转到第二个转录日志，看到命令<strong class="jp ir"> net用户&lt;用户名&gt;T20】密码&gt; /add。</strong></p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lj"><img src="../Images/3995d449aaa19033eca186c471599775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VfFFjf061aD1UMHHJkK-8w.png"/></div></div></figure><p id="e083" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.在其中一个转录日志中，坏演员在新的后门用户帐户下与目标进行交互，并将一个唯一的文件复制到桌面。在复制到桌面之前，原始文件的完整路径是什么？</p><blockquote class="kq kr ks"><p id="720e" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">c:\ Users \ Santa \ AppData \ Local \ Microsoft \ Windows \ usr class . dat</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lk"><img src="../Images/c9a1310ef2ec47950bb0b9b9c7fb7054.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Mh7MP-ycKWYuyjeHzW7HCQ.png"/></div></div></figure><p id="9e26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.演员使用一个<a class="ae ll" href="https://lolbas-project.github.io/lolbas/Binaries/Certutil/" rel="noopener ugc nofollow" target="_blank">二进制文件(LOLbin)来编码这个文件，然后通过查看输出文件来验证它是否成功。这个LOLbin叫什么？</a></p><blockquote class="kq kr ks"><p id="a956" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">certutil.exe</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lm"><img src="../Images/304f711a109f13958cf1204a758c8bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUf91NG9lPfsiFP0lXSeyg.png"/></div></div></figure><p id="cb0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">6.阅读以上内容，打开桌面文件夹中的<code class="fe kl km kn ko b">ShellBagsExplorer.exe</code>应用程序。</p><blockquote class="kq kr ks"><p id="44b2" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">点击<strong class="jp ir">问题完成</strong></p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ln"><img src="../Images/89f2022a813a14c16a028822c9fa11b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olSHcYrQ4wXdcOxLft2mQw.png"/></div></div></figure><p id="822c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7.深入到文件夹中，看看你是否能找到任何可能表明我们如何更好地追踪这个圣诞老人到底是什么的东西。有哪些具体的文件夹名称提示我们，这可能是托管在代码共享平台上的可公开访问的软件？</p><blockquote class="kq kr ks"><p id="e5ce" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">。开源代码库</p></blockquote><p id="d32f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道github是一个非常代码共享的平台。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lo"><img src="../Images/469c175ac86d4d90cdfe0e3590640f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mcmI6ND-MomdmAwSkJ5krg.png"/></div></div></figure><p id="e649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8.此外，桌面上还有一个名为“玩具袋”的独特文件夹！这一定是圣诞老人准备他的玩具收藏的地方，这肯定是演员可能已经妥协的敏感数据。在此文件夹中找到的文件的名称是什么？</p><blockquote class="kq kr ks"><p id="dece" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">玩具袋. zip</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lp"><img src="../Images/54c199ca6d9f57cb413fc29ecaf140fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ib2EmxZgR431GEdOouqNsg.png"/></div></div></figure><p id="5898" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">9.拥有SantaRat存储库的用户的名称是什么？</p><blockquote class="kq kr ks"><p id="fd9a" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">最古怪的</p></blockquote><p id="45c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从那个文件夹的名字，我试着在github中搜索SantaRat，我找到了这个:D</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lq"><img src="../Images/5dd88467c53fd13abbd7fce3318a4962.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0zgPZZczohi8Eg65XJBGA.png"/></div></div></figure><p id="c9f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">10.浏览该用户拥有的其他存储库。似乎与我们的调查特别相关的存储库的名称是什么？</p><blockquote class="kq kr ks"><p id="1ad2" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">玩具操作袋</p></blockquote><p id="4933" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">潜入格林奇斯特的仓库，我发现了一个似乎与我们的调查特别相关的仓库。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lr"><img src="../Images/f195df8657c05fded4d5c00dea631516.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9MYPDf6vVHyRd6G6TIVJQ.png"/></div></div></figure><p id="9882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">11.阅读此存储库中提供的信息。事实上，这位演员似乎已经妥协并篡改了圣诞老人的玩具包！您可以在转录日志中查看活动。看起来好像演员安装了一个特殊的工具来收集并最终取出玩具袋。安装了演员用来收集玩具袋的独特实用程序的可执行文件的名称是什么？</p><blockquote class="kq kr ks"><p id="aa60" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">uharc-cmd-install.exe</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ls"><img src="../Images/e6fc42b447bcb6f6ad0d59ab008f5b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHAZmNTJQtr_FWp0ZDyQ3A.png"/></div></div></figure><p id="9811" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">12.接下来，演员看起来已经把玩具袋里的所有东西都拿走了，并加入了新的东西，比如煤、霉菌、虫子等等！这些“恶意”文件的内容是什么(煤、霉菌和所有其他的)？</p><blockquote class="kq kr ks"><p id="593b" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">格林奇马斯</p></blockquote><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lt"><img src="../Images/81eba8f701689fdab0244069f1d1f36b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mLzwfJiBoJWBx__A-P-JRw.png"/></div></div></figure><p id="a66f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">13.我们知道这位演员收集了原来的玩具袋。出现了一个小小的OPSEC错误，我们也许能找回圣诞老人的玩具包！查看actor的存储库，了解其计划的操作…在提交消息中，我们可以找到原始归档和密码！</p><blockquote class="kq kr ks"><p id="7122" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">点击<strong class="jp ir">问题完成</strong></p></blockquote><p id="151b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是..，漏洞是在公共平台键入密码，这是非常危险的。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lu"><img src="../Images/afc5926255f3a1164a7e8ceac00d9ba8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W2j1RuulC9GhOQREG4u8fg.png"/></div></div></figure><p id="5c38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">14.原始bag_of_toys.uha档案的密码是什么？(您不需要执行任何密码破解或暴力尝试)</p><blockquote class="kq kr ks"><p id="fa63" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi translated">格林奇瀑布</p></blockquote><p id="7155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">15.圣诞老人的玩具包里有多少原始文件？</p><blockquote class="kq kr ks"><p id="c50f" class="jn jo kp jp b jq jr js jt ju jv jw jx kt jz ka kb ku kd ke kf kv kh ki kj kk ij bi">228</p></blockquote><p id="6256" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用我们找到的最后一个密码打开存档，得到bag_of_toys.uha中的文件数。</p><figure class="kx ky kz la gt lb gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/8f8b95def9f4c5dc867b8521e2e8dc87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*pBw7veNvmJyrq09KzAfBbw.png"/></div></figure><h2 id="2c5e" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated"><strong class="ak">结论</strong></h2><p id="973e" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">这部分是约翰·哈蒙德的特辑。如果您有兴趣了解更多关于Windows基础的知识，请查看TryHackMe上的<a class="ae ll" href="https://tryhackme.com/module/windows-fundamentals" rel="noopener ugc nofollow" target="_blank"> Windows基础</a>模块。点击查看约翰·哈蒙德第八天<a class="ae ll" href="https://www.youtube.com/watch?v=oGX7vLtjbic" rel="noopener ugc nofollow" target="_blank">的演练视频。</a></p><p id="ba02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢了。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="a7cc" class="nb lx iq bd ly nc nd ne mb nf ng nh me ni nj nk mh nl nm nn mk no np nq mn nr bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae ll" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="ns nt gp gr nu nv"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="nw ab fo"><div class="nx ab ny cl cj nz"><h2 class="bd ir gy z fp oa fr fs ob fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="oc l"><h3 class="bd b gy z fp oa fr fs ob fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="od l"><p class="bd b dl z fp oa fr fs ob fu fw dk translated">iwcon.live</p></div></div><div class="oe l"><div class="of l og oh oi oe oj lg nv"/></div></div></a></div></div></div>    
</body>
</html>