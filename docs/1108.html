<html>
<head>
<title>Bigbasket Bug Bounty Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">大篮子虫赏金记</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bigbasket-bug-bounty-writeup-9fedc490b814?source=collection_archive---------1-----------------------#2021-02-08">https://infosecwriteups.com/bigbasket-bug-bounty-writeup-9fedc490b814?source=collection_archive---------1-----------------------#2021-02-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cbcc267f660438c63ec50328302b4f39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rPqqzAteaCMiviKPqzEzbg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">大篮子虫赏金</strong></figcaption></figure><h1 id="76bf" class="kd ke iq bd kc kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">大家好！</h1><p id="3b68" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">这是我第一次写文章。</p><p id="5e17" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我是<strong class="lc ir">洛斯·高达M </strong>(安全工程师)。由于新冠肺炎，大多数员工得到了在家工作的选择。它帮助我学习了一些新的Bug Bounty。2020年6月开始了我的虫子赏金之旅。</p><p id="7e33" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">做安全工程师和兼职Bug Bounty是学习这个领域新东西的好方法，我们也可以在日常工作生活中实施。</p><p id="88b2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我感谢我的团队(<a class="ae md" href="https://www.linkedin.com/in/vishva-shankar/" rel="noopener ugc nofollow" target="_blank">维什瓦</a>、<a class="ae md" href="https://www.linkedin.com/in/harish-channegowda-231909106/" rel="noopener ugc nofollow" target="_blank">哈里什</a>)和<a class="ae md" href="https://hacktify.in/" rel="noopener ugc nofollow" target="_blank">哈克蒂菲网络安全</a>的支持和指导。</p><p id="8d5f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这篇关于大篮子不安全数据存储漏洞的文章</p><p id="9bc7" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">说到技术细节…</p><p id="9cea" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我发现其中一个大篮子应用程序使用“<strong class="lc ir">允许备份方法=真</strong>”</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/85cf93057050ba69610b191934e66788.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AxsSewlokUzljix0537tTw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">android:allowBackup=" true "</figcaption></figure><p id="374f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">Android中什么是允许备份标志？</strong></p><p id="6ec6" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">允许备份标志</strong></p><p id="693e" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> android:allowBackup </strong>属性定义启用USB调试的用户是否可以备份和恢复应用程序数据。如果备份标志设置为true，即使设备不是根设备，它也允许攻击者通过ADB备份应用程序数据。因此，处理和存储诸如卡细节、密码等敏感信息的应用程序。应该将此设置显式设置为false，因为默认情况下，它被设置为true以防止此类风险。</p><p id="30fa" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><em class="mj"> &lt;应用</em></p><p id="6d0f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">Android:allow backup = " false "</p><p id="a0ba" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><em class="mj">&lt;/应用&gt; </em></p><p id="dd85" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">ADB备份功能是备份所有文件的好工具。如果启用，拥有你手机的恶意用户可以复制你手机中此应用程序的所有敏感数据。结果发现，如果攻击者能够访问未锁定的手机，他们可以通过ADB的备份功能从应用程序的沙箱中获取任何数据。</p><p id="9906" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">if<strong class="lc ir">Android:allow backup = " true "</strong>如果数据没有加密，我们可以很容易地从根存储(<strong class="lc ir"> Android shared Preferences和Db </strong>)中提取任何数据。</p><blockquote class="mk ml mm"><p id="293b" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated">大多数Bug Bounty程序不会接受这个Bug，因为它需要物理接触设备。但是如果你有任何与内部基础设施相关的敏感数据，请立即报告。</p></blockquote><p id="4839" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">所以来剥削……</strong></p><p id="9483" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">对于这个开发，我使用Genymotion仿真器和Kali Linux进行ADB调试。</p><p id="9376" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">1.在我的机器上安装了Genymotion(适用于Windows、Linux和Mac OS)</p><p id="7426" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2.之后，在我的模拟器上安装了android设备(Android v 8.1)</p><p id="c5ac" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">3.设置完成后，我在我的设备上安装了一个大篮子应用程序。</p><p id="ac48" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">4.我使用以下命令在Kali Linux上调试应用程序。</p><blockquote class="mk ml mm"><p id="d34c" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"><em class="iq">【ADB连接到设备(Genymotion设备默认端口号5555)</em></strong></p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/2557409ac5cf1848102450ed8bd7d161.png" data-original-src="https://miro.medium.com/v2/resize:fit:956/format:webp/1*jCiIVkaoPv34QWX8l78trw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">装置连接</strong></figcaption></figure><blockquote class="mk ml mm"><p id="31ca" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="iq">验证设备是否连接。</em>T9】</strong></p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/25d103368be716312de948bd371c543d.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*JnQEbRp_j_KD4J6WWlKmlQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc"> <em class="ms">在设备列表中可以看到</em> </strong></figcaption></figure><blockquote class="mk ml mm"><p id="97f5" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="iq">然后我输入了备份移动的命令以及包名。</em> </strong></p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/2ef47209378842b81c0eccb8414b730a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*TyUvgD6zzj7BKG60KsHR1Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">亚行备份命令</strong></figcaption></figure><blockquote class="mk ml mm"><p id="73fc" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="iq">设备上的备份屏幕。请点击备份我的数据。</em> </strong></p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/0a4182921e7f3a49e3989d34fe8f87f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:806/format:webp/1*OGJSURmKn71WGYwhVfx1HQ.png"/></div></figure><p id="ab32" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi mv translated">一旦我们确认，它将创建一个Android备份文件，并带有一个“.ab”扩展。通常，前24个字节是报头。因此，我们将使用<strong class="lc ir"> DD </strong>工具删除前24个字节，并创建剩余部分的tar文件。这可以如下所示完成(对任何备份文件使用下面的命令)。其他一些<strong class="lc ir"> DD </strong>命令可用，但有时无法工作，所以我使用了这个)。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/79cd8e4dd3ec21bf380312833c0d11b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Lgjm7gEpEY_-eyMBP5miIQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">上面的命令跳过了输入文件的第一块，这是我们Android备份的头部分。(这是一个示例文件，不是真正的文件，通常它会给出一些只有23字节的大量记录)</strong></figcaption></figure><blockquote class="mk ml mm"><p id="014c" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="iq">现在，创造一个”。list "文件，它来自我们在上一步中生成的tar文件。这是为了确保重新打包备份时的正确顺序。</em> </strong></p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/4b765dd4dcb19f9cb27919991e945877.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*1L71oAqFtdSkLa7XkCVlSw.png"/></div></figure><p id="44ae" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我们现在应该有以下文件。(您可以为备份文件指定任何名称，但包名应该相同)</p><p id="3a41" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">慷慨的支持。ab  —实际的Android备份来自设备</p><p id="1a03" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">bountybackup.tar</strong>—使用dd生成的文件</p><p id="b51d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">慷慨备份。列表</strong> —使用tar文件生成的文件</p><blockquote class="mk ml mm"><p id="0aca" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><em class="iq">我们可以使用下面的命令</em> 简单地提取bountybackup.tar文件</p></blockquote><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/2a35dc32f1159d4cb08550045370f8aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*A4jWvmVWiAaMmcXQYL6trg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">备份文件</strong></figcaption></figure><p id="9b0d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">1.一旦完成这个备份过程，我们就有了一个名为“apps”的新文件夹。我们可以进入这个目录来查看特定于应用程序的信息。</p><p id="9608" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2.导航到程序包名称文件夹，然后转到SP文件夹。</p><p id="0d46" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">Android中的SP文件夹是什么？</strong></p><blockquote class="mk ml mm"><p id="b99e" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="iq"> Android共享首选项:</em></strong><em class="iq">Android应用程序的一个常见组件——是一组管理每种类型的开发人员数据的API，提供了一种干净的方法来永久存储和从设备中检索这些数据。几乎每个android应用程序都使用它们。</em></p><p id="90fc" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated">现在，我们有了一个“SP”文件夹，其中包含存储我们的目标应用程序数据的XML文件。 <strong class="lc ir"> <em class="iq">我发现了一些仪表板内部的IP，这里有一个秘密令牌</em> </strong> <em class="iq">。</em></p></blockquote><p id="b291" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">这是我的一些调查结果的概念验证… </strong></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/e91425a11169f3247cbfdf2dec53ad00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zqrd0Gq3pckuh35C95THWQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">客户端秘密令牌</strong></figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/92e72783431628bcaa9551840fc0c5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F-XzT0wXOyXSBoRMMyYPIw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc"> Apache主机管理器访问</strong></figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/ffe26749d8d69c92ca969b1ebe502515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rb3nUR2inRhSu2q9LLepIg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">管理面板</strong></figcaption></figure><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/686e89f0e47e5d3d75ae12b7591656ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yL8-B1tq42Y2kJ5n_W9wsg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">硬编码的用户详细信息和令牌</strong></figcaption></figure><p id="0d39" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我得到了他们安全团队的奖励，并在他们的 <a class="ae md" href="https://tech.bigbasket.com/security-at-bigbasket/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">名人堂</strong> </a> <strong class="lc ir">中得到表彰。</strong></p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/e343b7206cc7abdb4863dcde7e94029b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HjVpyMstehvlVLo-7hywiA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><strong class="bd kc">名人堂+赏金</strong></figcaption></figure><p id="2e91" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">报告详情:</strong></p><p id="10d3" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2020年10月5日，星期一，01:04-向大篮子安全团队报告了错误。</p><p id="b869" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2020年10月6日星期二10:00 —收到团队的第一个回复</p><p id="e116" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2020年10月12日，星期一，18:25-接受</p><p id="a1dc" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2020年12月8日星期二11:26 —错误被标记为已修复</p><p id="52ca" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">2020年12月8日星期二07:38 —重新测试并确认了修复</p><p id="5f56" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">Fri，2021年1月8日，10:27——获得赏金+ <a class="ae md" href="https://tech.bigbasket.com/security-at-bigbasket/" rel="noopener ugc nofollow" target="_blank">名人堂</a></p><p id="5a4e" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">感谢阅读！….黑客快乐！</strong></p><blockquote class="mk ml mm"><p id="997e" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><em class="iq">Linkedin:</em><a class="ae md" href="https://www.linkedin.com/in/lohigowda/" rel="noopener ugc nofollow" target="_blank"><em class="iq">Lohith Gowda M</em></a></p><p id="bb32" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><em class="iq">推特:</em><a class="ae md" href="https://twitter.com/lohigowda_in" rel="noopener ugc nofollow" target="_blank"><em class="iq">lohigowda _ in</em></a></p><p id="140d" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><em class="iq">insta gram:</em><a class="ae md" href="https://www.instagram.com/lohigowda.in/" rel="noopener ugc nofollow" target="_blank"><em class="iq">lohigowda . in</em></a></p><p id="2b5d" class="la lb mj lc b ld ly lf lg lh lz lj lk mn ma ln lo mo mb lr ls mp mc lv lw lx ij bi translated"><em class="iq">作品集:</em><a class="ae md" href="https://www.lohigowda.in/" rel="noopener ugc nofollow" target="_blank"><em class="iq">https://www.lohigowda.in/</em></a></p></blockquote></div></div>    
</body>
</html>