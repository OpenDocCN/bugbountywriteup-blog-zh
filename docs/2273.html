<html>
<head>
<title>Bypassing unexpected IDOR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">绕过意外的IDOR</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bypassing-unexpected-idor-e6a9da2e0498?source=collection_archive---------0-----------------------#2022-08-13">https://infosecwriteups.com/bypassing-unexpected-idor-e6a9da2e0498?source=collection_archive---------0-----------------------#2022-08-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="002a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我又回来了，带来了另一篇关于我最近在HackerOne Private VDP上发现的bug的文章。在这篇文章中，我将告诉你我是如何绕过一个IDOR漏洞的，并在最后分享一些其他方法来绕过它，敬请关注。</p><p id="1100" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">idOR并不总是改变ID参数，因为我们有各种方法可以找到漏洞，但我们大多数人只是试图改变ID参数，在获得401(未经授权的访问)和其他错误后，我们放弃并转移到其他功能。但是这是一个错误的方法，试着给同样的错误一些时间，在谷歌上做一些研究，并试图利用它。现在没有任何进一步的拖延，让我们从主要的故事开始。</p><h2 id="7342" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">回去吧</h2><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="lj lk l"/></div></figure><h1 id="dfd5" class="ll km iq bd kn lm ln lo kq lp lq lr kt ls lt lu kw lv lw lx kz ly lz ma lc mb bi translated">虫子的故事</h1><p id="adcf" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">8月4日，我在<a class="ae mh" href="https://hackerone.com/" rel="noopener ugc nofollow" target="_blank"> HackerOne </a>上收到了一个VDP的私人邀请，邀请范围有限。这是一个kindda运动平台，在这里我们可以创建一个特定运动的团队，允许我们添加成员并作为教练管理我们的团队。我开始了一些侦察和子域枚举，但没有发现任何感兴趣的子域或任何端点。然后，我在网站的主要领域进行了手动漫游，并开始测试一些错误，如CSRF和XSS，但没有运气。之后，我在团队设置选项下看到了一个有趣的选项，叫做“退出团队”。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mi"><img src="../Images/3c0375fab8209a93ad3934bd78e16990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xAUD9_Z1gMG6Dr6xkdfd7A.png"/></div></div></figure><p id="c007" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定玩这个功能，并点燃了我的打嗝。我看到的请求是这样的:</p><blockquote class="mp mq mr"><p id="f568" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">岗位/账户/团队设置/退休_团队？team_id=12345</p></blockquote><p id="985d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的心在大声呼喊“我多我多我多我多”。我立即创建了一个受害者帐户，并创建了一个受害者团队，更改了受害者的团队id，而不是攻击者的团队id，但我的burp中继器中的响应对我不利，它向我显示了未经授权的访问错误，在那里我没有放弃并继续前进，而是研究了如何绕过它，找到了一些有趣的方法并开始尝试它们，其中一个让我得到了200 OK的响应，最终导致任何用户退出团队。我所做的是将%20放在id参数的末尾，如:</p><blockquote class="mp mq mr"><p id="140f" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">岗位/账户/团队设置/退休_团队？team _ id =受害者的id%20</p></blockquote><p id="8c3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很高兴，同时也很兴奋，因为没有速率限制，攻击者可以<strong class="jp ir">暴力</strong>team _ id参数和大量退出团队的许多用户。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="mw lk l"/></div></figure><p id="ac9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">报告了错误，并等待分流小组的响应。6天后，他们打电话给我说…</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi mx"><img src="../Images/292ce93d27e9a4ea14a729ca8de423b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rz5PDIeKKsTjFT5GRlefVA.png"/></div></div></figure><p id="3b04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">标明重复😡😡</strong></p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="my lk l"/></div></figure><h1 id="4c52" class="ll km iq bd kn lm ln lo kq lp lq lr kt ls lt lu kw lv lw lx kz ly lz ma lc mb bi translated">以下是一些绕过IDORs的方法:</h1><ol class=""><li id="0713" class="mz na iq jp b jq mc ju md jy nb kc nc kg nd kk ne nf ng nh bi translated"><strong class="jp ir">参数污染</strong></li></ol><p id="f18e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过为单个参数提供多个值，可以创建一个可以利用idor的场景。更改请求自:</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="fd93" class="kl km iq nj b gy nn no l np nq">GET /api/card?custom_id=&lt;attacker_id&gt;</span></pre><p id="c63d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">收件人:</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="b761" class="kl km iq nj b gy nn no l np nq">GET /api/card?custom_id=&lt;attacker_id&gt;&amp;custom_id=&lt;victm's_is&gt;</span></pre><p id="19eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。附加特殊字符和随机字符串</strong></p><p id="1864" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单地替换id可能会导致401、拒绝访问或无效请求。因此，在这种情况下追加特殊字符<strong class="jp ir"> (/) </strong>或字符串，如<strong class="jp ir"> %20、%09、%0b、%0c、%1c、%1d、%1e、%1f </strong>等。可能会给你一个Idor。拒绝请求自</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="1b97" class="kl km iq nj b gy nn no l np nq">GET /profile/update/12345</span></pre><p id="f95f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="73ac" class="kl km iq nj b gy nn no l np nq">GET /profile/update/12345%20</span></pre><p id="a025" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能会破坏应用程序的逻辑。</p><p id="0505" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。改变请求方法</strong></p><p id="122a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一种HTTP请求方法不起作用，您可以尝试许多其他方法:GET、POST、PUT、DELETE、PATCH等等。</p><p id="33e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。为没有id的请求放置id</strong></p><p id="0813" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使请求URL没有使用输入参数，也要为每个请求设置参数，并观察它是否有所不同。例如，如果此请求显示您的所有卡详细信息:</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="d1b4" class="kl km iq nj b gy nn no l np nq">GET /api/card</span></pre><p id="e66f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果攻击者附加如下所述的用户id会发生什么？</p><pre class="le lf lg lh gt ni nj nk nl aw nm bi"><span id="0968" class="kl km iq nj b gy nn no l np nq">GET /api/card?custom_id=&lt;victim_id&gt;</span></pre><p id="c6d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使web应用程序有时隐藏了与参数相关的信息，通过观察相邻的请求，您也可以随机添加id。</p><h1 id="af0e" class="ll km iq bd kn lm ln lo kq lp lq lr kt ls lt lu kw lv lw lx kz ly lz ma lc mb bi translated">结尾:</h1><p id="2c36" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我已经决定将我到目前为止所学到的一切回馈给黑客社区，我将积极参与这些文章的撰写，所以请确保<a class="ae mh" href="https://medium.com/@bharatsingh070601" rel="noopener"> <strong class="jp ir">关注我</strong> </a>。</p><p id="f5e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">让我们成为朋友，</strong>请随时与我联系，如果你们有任何疑问或建议，我的DM是开放的。</p><p id="a158" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请关注我定期更新的Bug Bounty和网络安全。</p><figure class="le lf lg lh gt li"><div class="bz fp l di"><div class="my lk l"/></div></figure><p id="f70a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;<a class="ae mh" href="https://www.linkedin.com/in/bharat-s1ngh/" rel="noopener ugc nofollow" target="_blank">领英</a>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p><p id="d5b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;<a class="ae mh" href="https://twitter.com/zingzangoo" rel="noopener ugc nofollow" target="_blank">碎碎念</a>&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="c9e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ms">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae mh" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="ms">加入我们的每周简讯</em> </strong> </a> <em class="ms">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>