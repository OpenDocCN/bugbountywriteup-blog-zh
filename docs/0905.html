<html>
<head>
<title>Accidental Observation to Critical IDOR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">对临界IDOR的偶然观察</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/accidental-observation-to-critical-idor-d4d910a855bf?source=collection_archive---------0-----------------------#2020-10-24">https://infosecwriteups.com/accidental-observation-to-critical-idor-d4d910a855bf?source=collection_archive---------0-----------------------#2020-10-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5384311ed96f8d5b4d2109bf44afc5c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5uRhJwgbSvaHsfhVPEnC9A.png"/></div></div></figure><p id="f2ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据OWASP TOP 10 (2017版)，不安全的直接对象引用属于破坏的访问控制类别。这个问题通常是由于应用程序的访问控制逻辑实现不完善造成的，访问控制逻辑将标识符或对象链接到特定的资产，比如说<strong class="ka ir"> user_id </strong>参数定义了要更新哪个用户的数据。IDORs被比作服务器端的问题，被广泛观察，并且容易识别。然而，idor通常很棘手，看起来非常健壮的应用程序也可能有idor。</p><p id="ebcf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，黑客和赏金猎人们，我希望你们都过得很好。过了很久，我开始回去寻找漏洞，最近遇到了一个有趣的IDOR漏洞，它最终成为了一个严重的(P1)问题。在这个博客中，我将讨论同样的问题。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="6309" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">【如果你喜欢读我的文章，请在推特上关注:<a class="ae le" href="https://www.twitter.com/harshbothra_" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ld">【https://www.twitter.com/harshbothra_】</em></strong></a></p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="7a66" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我开始寻找一个老目标的子公司的问题，比如说<strong class="ka ir">targetsub.com<br/></strong>我在3-4个月后登录该帐户，成功登录后，它要求我更改密码，因为它的政策是每几个月轮换一次密码。在密码更改页面上，URL如下所示:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="1200" class="lo lp iq lk b gy lq lr l ls lt"><a class="ae le" href="https://www.targetsub.com/change-password/?id=90" rel="noopener ugc nofollow" target="_blank">https://www.targetsub.com/change-password/?id=90</a></span></pre><p id="80fe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">望着<strong class="ka ir">？id= </strong>参数，我试图更改值，但没有成功。后来，在用正常流程更改密码后，我登录到应用程序并导航回<strong class="ka ir">更改密码</strong>页面。</p><p id="ef6a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，这一次URL看起来像这样:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="e1ba" class="lo lp iq lk b gy lq lr l ls lt">https://www.targetsub.com/change-password/</span></pre><p id="4bca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这次的<strong class="ka ir">？id= </strong>参数不存在。现在，对于具有相同<strong class="ka ir">端点</strong>的应用程序来说，使用两个不同的流有点奇怪。接下来，我转到<strong class="ka ir">我的账户</strong>页面，网址如下:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="3866" class="lo lp iq lk b gy lq lr l ls lt">https://www.targetsub.com/myaccount/</span></pre><p id="1b2c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">进一步，我修改了网址，增加了<strong class="ka ir">？id= </strong>参数，值为<strong class="ka ir"> 88 </strong>，新的URL如下所示:</p><pre class="lf lg lh li gt lj lk ll lm aw ln bi"><span id="1113" class="lo lp iq lk b gy lq lr l ls lt">https://www.targetsub.com/myaccount/?id=88</span></pre><p id="03ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我可以访问id=88的<strong class="ka ir">用户的详细信息了。至此，我可以更改用户的电子邮件了。此外，我创建了另一个帐户，并将其电子邮件更改为攻击者电子邮件。现在，我可以调用攻击者控制的电子邮件上的密码重置链接，无需用户交互，我就能够执行完整的帐户接管。</strong></p><figure class="lf lg lh li gt jr"><div class="bz fp l di"><div class="lu lv l"/></div></figure></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="9641" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">外卖:</strong></p><ol class=""><li id="10e9" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv mb mc md me bi translated">始终检查每个端点的所有可能的流。有时，您可能会发现一个有趣的流程，可以在应用程序的其他地方使用。</li><li id="5221" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv mb mc md me bi translated">每当你看到<strong class="ka ir"> /myaccount </strong>或者类似的没有引用用户唯一标识符的端点时，试着用通用标识符参数比如<strong class="ka ir"> uid，id，user_id，oid，</strong>等等来混淆。</li></ol></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="8817" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢阅读文章<strong class="ka ir">，请鼓掌并在<em class="ld">媒体和推特上关注:</em> </strong></p><p id="229a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="ld">碎碎念:</em></strong><a class="ae le" href="https://www.twitter.com/harshbothra_" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ld">https://www.twitter.com/harshbothra_</em></strong></a></p><p id="10ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="ld">领英:</em></strong><a class="ae le" href="https://www.linkedin.com/in/harshbothra" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ld">https://www.linkedin.com/in/harshbothra</em></strong></a></p><p id="504c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="ld">网址:</em></strong><a class="ae le" href="https://harshbothra.tech/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ld">https://harshbothra . tech</em></strong></a></p><p id="7053" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="ld">会谈:</em></strong>【https://www.youtube.com/playlist?】<strong class="ka ir"><em class="ld">list = plyn 5 _ MxRvV-fxpl 90 I-uebxqzqbxfiay 0</em></strong></p><p id="b75c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="ld">幻灯片:</em></strong><a class="ae le" href="https://speakerdeck.com/harshbothra" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="ld">https://speakerdeck.com/harshbothra</em></strong></a></p></div></div>    
</body>
</html>