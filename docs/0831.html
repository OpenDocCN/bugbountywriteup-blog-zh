<html>
<head>
<title>Winja CTF 2020: Write-up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">温贾·CTF 2020:报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/winja-ctf-write-up-f33db5ee7afe?source=collection_archive---------2-----------------------#2020-09-19">https://infosecwriteups.com/winja-ctf-write-up-f33db5ee7afe?source=collection_archive---------2-----------------------#2020-09-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6c32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我参加了Winja CTF，这是一次非常棒的经历。</p><p id="b003" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我能够解决7个挑战，所以我在这里分享我解决它们的方法。</p><h1 id="8e9d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">1.骗子骗子</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/214589925f766fa497f44acf4b6f2d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*3ICxkKJhuxylzMZCg5OsHQ.png"/></div></figure><p id="6791" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做的第一件事是检查“文件”命令本身。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/5fdc56381da7603085c85dee1ffcfbe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*2AASQWcOJKLp62WbJBAGIQ.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">文件</figcaption></figure><p id="ca98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以它是ASCII文本文件。</p><p id="d33d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我试着用二进制</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi lw"><img src="../Images/ba94836b680689c8ce92f5cb59415f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3o0g_wjzC-yqB4-lpksfg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">卡特彼勒文件</figcaption></figure><p id="d770" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在img src中，我们可以看到有一个base64字符串。所以接下来我做的是用base64解码</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mb"><img src="../Images/7c400a7891fdaddaaaccdeef6217c613.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vYf86koDlNw58WvO0zwifA.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">base64</figcaption></figure><p id="7284" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们得到了十六进制值。</p><p id="5971" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我做的下一件事是“十六进制到ASCII”</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/87c51dfa369416eaa47c762ea4d34d11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*MvoBE29e5w_FZ21DiCxfIA.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">十六进制到ascii</figcaption></figure><blockquote class="md me mf"><p id="2e40" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">Flag:Flag { 8su 3 nsh _ honest _ is _ the _ Best _ Policy }</strong></p></blockquote><h1 id="050a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">2.拉链炸弹</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/9be2b26c7629effb7107301443df9ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*Jh_fgLFCehw3A88imp2QRQ.png"/></div></figure><p id="92bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我下载了附件，</p><p id="62fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个zip文件，所以我在提取第二个zip文件时一个接一个地提取它。我们需要给出一个密码，所以我猜测密码是“pass123 ”,我的猜测是正确的。否则，我会使用“ilostmypass.com”在线破解zip密码</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/e6ff25ada3af372e3193d859b43158d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*EUraCNnmTR039NuvZHrc9w.png"/></div></figure><p id="d395" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是打开flag.txt文件</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/e58d9fae5cdf7be670ad533d28e8f22c.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ildmfOzhCtX4lWGO4-o0MA.png"/></div></figure><blockquote class="md me mf"><p id="f446" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">Flag:Flag { n0t _ as _ g0od _ as _ middle L3 _ 0u 1 _ rig h1 }</strong></p></blockquote><h1 id="5c95" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">3.F@#$你的思想</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/da34cf59e8bbd39c00fe2e7581af4102.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*FvZwASz1y1yzViKh8XqMyw.png"/></div></figure><p id="be26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一个txt文件。它看起来像这样</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mn"><img src="../Images/4008c3af6953aefcdbbaac32d94dc7cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*punqAYTXrHbMD8-vF0CcIw.png"/></div></div></figure><p id="7887" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">乍一看，我知道这是javascript混淆代码(当你玩更多的CTF游戏时，你可以通过观察来预测事情)</p><p id="2181" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我用https://lelinhtinh.github.io/de4js/<a class="ae mo" href="https://lelinhtinh.github.io/de4js/" rel="noopener ugc nofollow" target="_blank">去泡沫。</a></p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mp"><img src="../Images/d74f017280e4aae02b15943261cdd493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wrDDPtwwehKa6sqtH3qJDA.png"/></div></div></figure><p id="eb1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在挑战中，他们告诉我们将字符串放入“flag{}”</p><blockquote class="md me mf"><p id="6b8a" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">标志:</strong></p><p id="b894" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">flag { Cr @ zy-e 50 t3r 1c-l @ ngu @ G3 _ ejs soom 7 BH _ MyNameIsDrLeamas }</strong></p></blockquote><h1 id="de77" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">4.Attack.log</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/fd552d29c6bdd6c0065285f7372f1255.png" data-original-src="https://miro.medium.com/v2/resize:fit:988/format:webp/1*4q1bNVICzbr6JnhFtd-Qhg.png"/></div></figure><p id="3e0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们收到了一份pcap文件。</p><p id="9b5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做的第一件事是导出所有文件。(导出HTTP对象列表)</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mr"><img src="../Images/e91fa7e6235ed7e75d03f7f30cfc0ce3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AMfJxlM2S19gm5im1CGQRA.png"/></div></div></figure><p id="82ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如我们所见，我们有3个文件。一个“Linux-virus”文件和两个HTML文件</p><p id="20f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在linux-virus文件上尝试了字符串。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/c9d4fb80ea3c2626d5e2848dc1f8867c.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*6CmfeqjVirtD48j6EKjCHQ.png"/></div></figure><p id="e90e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上图中，你可以看到我突出显示了一些哈希值，</p><p id="0675" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">乍一看，在字符串中看到哈希值很奇怪。所以我试着通过CRACKSTATION破解这个哈希值。我是对的，它是哈希值，得到值“999999”</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mt"><img src="../Images/d037496c53ef74bbc2002fdfc81b0e84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZmrxZeUZDpd_58dGN2U7kQ.png"/></div></div></figure><p id="77c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在我打开HTML文件，试图找到“999999”</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/bf134a60c8574a3d4ea4eccbeb4c3354.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*wswJlQt3wis6PX3GjUg7mw.png"/></div></figure><p id="644a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在HTML文件上找到了“999999 ”,并提交了一个标志值。</p><blockquote class="md me mf"><p id="8e73" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">Flag:Flag { ZDBKEPXZQUECXDVJT }</strong></p></blockquote><h1 id="f63a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">5.风险规避</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/fc6f1cc2ab48d1330746d0e9b3d4bd64.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*N_y75J_zBDswbVIClgTG8w.png"/></div></figure><p id="d835" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了一个exe文件。</p><p id="e424" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我做的第一件事是在exe上执行“文件”命令</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/803600bc8756c086a84398b5b10d72bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*nwnhai68QImItUXvjFN9AA.png"/></div></figure><p id="9954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们可以看到它不是exe文件，而是ASCII文本文件。</p><p id="37b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来我做的是“cat格式-c.exe”</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/5aa190917c188ddb5930abdea3125aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*BuQhc0eGoiguE3UAAVDR_A.png"/></div></figure><blockquote class="md me mf"><p id="e2c6" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">Flag:Flag { qkhek 1 oblm _ mrgrinnywoulketoconsgratulateyu }</strong></p></blockquote><h1 id="1492" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">6.交易员的策略1</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi my"><img src="../Images/c9adff9d226d19ae20d1d85a2f4a4315.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*d8t-Mf5hRjZgGycoKqpedA.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">交易员的策略1</figcaption></figure><p id="efdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以首先我访问了这个网站</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div role="button" tabindex="0" class="lx ly di lz bf ma"><div class="gh gi mz"><img src="../Images/cc7c29b38078d7035520a5a5ba455d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C1N5nKkpd135XFMMkUeR6g.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">银行.网站</figcaption></figure><p id="9442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以看了不同的东西“源代码”，“javascript文件”，“css”等。</p><p id="4ad8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我想让我试试不同的网址，比如“/admin，/login，/robots.txt”。</p><p id="3a3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">过了一会儿，我试了试“/flags”，得到了2个flags。</p><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f130201475d737bb0a78155dff5ba11b.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*G09lbPQHQycJkIbsJphi8g.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk translated">旗帜</figcaption></figure><p id="bfd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以第一面旗是为了这次挑战。</p><blockquote class="md me mf"><p id="2c00" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">Flag:Flag { YouFoundKorla _ SqlInjectionSuccessful }</strong></p></blockquote><h1 id="67a4" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">7.交易者的策略2</h1><figure class="lk ll lm ln gt lo gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/150ebcadb1f6c5b165cbe0adcfcc3bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*zd7dFCbmSKy-q7XtyyfyQA.png"/></div></figure><p id="8ea2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以当我看到这个网址时，它是同一个网址，所以在之前的挑战中我们发现了两个标志，所以第二个标志是这个挑战的标志。</p><blockquote class="md me mf"><p id="9627" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated"><strong class="jp ir">flag:flag { limit bypassed _ IVFfxMQQwb _ thiaccountbelongstokorla }</strong></p></blockquote><p id="e0b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读。</p><p id="f9a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在下面的链接中找到所有资源。</p><p id="3ab9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mo" href="https://github.com/raj1997/CTF-Write-up/tree/master/Winja_CTF/" rel="noopener ugc nofollow" target="_blank">https://github . com/Raj 1997/CTF-向上写/tree/master/Winja_CTF </a></p></div></div>    
</body>
</html>