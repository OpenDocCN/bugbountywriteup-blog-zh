<html>
<head>
<title>What’s on my .htaccess?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的上有什么？htaccess？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/whats-on-my-htaccess-a2a440cf4cd0?source=collection_archive---------4-----------------------#2020-07-30">https://infosecwriteups.com/whats-on-my-htaccess-a2a440cf4cd0?source=collection_archive---------4-----------------------#2020-07-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f6a279f53744bfc0a923bd98c3b5406b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ojHdy8bWou5r4kFYUVq_hA.jpeg"/></div></div></figure><p id="80b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">网站上常见的一些安全问题可以通过使用。超文本访问文件。在本文中，我将展示。我的WordPress网站上的htaccess配置，并解释使用它解决的安全问题。然而，在我们开始之前，让我们看看。htaccess文件实际上是。</p><blockquote class="kw kx ky"><p id="3b96" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">。htaccess是在运行Apache web服务器软件的Web服务器上使用的配置文件。当一个. htaccess文件放在一个目录中，这个目录又通过Apache Web服务器加载，那么。Apache Web服务器软件检测并执行htaccess文件。</em></p><p id="2646" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">这些。htaccess文件可用于改变Apache Web服务器软件的配置，以启用/禁用Apache Web服务器软件必须提供的附加功能和特性。这些工具包括基本的重定向功能，例如，如果出现“404文件未找到”错误，或者更高级的功能，如内容密码保护或图像热链接阻止。</em></p><p id="3bb5" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">— <em class="iq"> HTACCESS-Guide </em></p></blockquote></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><h2 id="3e4c" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">警告</h2><ol class=""><li id="afc2" class="md me iq ka b kb mf kf mg kj mh kn mi kr mj kv mk ml mm mn bi translated">的。htaccess文件是一个服务器配置文件。即使是一个打字错误也会导致你的服务器配置错误，导致你的网站瘫痪！请<strong class="ka ir">注意</strong>作者不会对你在服务器上造成问题的任何错误负责。</li><li id="b1ce" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">如果你不知道你在做什么，咨询一下网站开发者。如果你喜欢冒险，一定要备份你的原件。htaccess文件，请谨慎操作。</li><li id="c56e" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">如果站点关闭，请使用您的FTP/SSH/cPanel访问来恢复。备份中的htaccess文件。</li><li id="0577" class="md me iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">而。我的服务器上的htaccess配置是为保护我的WordPress安装而定制的，下面给出的许多指令可以根据你的非WordPress网站的设置进行修改(如果需要)和使用。但是，我强烈建议在进行适当的备份后，谨慎地进行任何此类修改。</li></ol></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="3db7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们开始吧。htaccess文件块块，看看它如何帮助我保护我的网站。您希望在自己的服务器上使用的以下任何代码块都需要复制到。网站根目录下的htaccess文件。如上所述，<strong class="ka ir">请备份你的</strong> <strong class="ka ir">。htaccess文件</strong>，然后再进行任何更改。</p><h1 id="15db" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">保护HTACCESS文件</h1><p id="7dc8" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">考虑到。htaccess文件，这是至关重要的，以保护文件本身免受未经授权的用户。下面的代码块就是这样做的。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="8ff4" class="lk ll iq ns b gy nw nx l ny nz"># Protect HTACCESS<br/>&lt;files ~ "^.*\.([Hh][Tt][Aa])"&gt;<br/>order allow,deny<br/>deny from all<br/>satisfy all<br/>&lt;/files&gt;</span></pre><h1 id="aa26" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">保护其他重要文件</h1><p id="6886" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">下面的代码块可以用来保护WordPress中的其他重要文件，比如错误日志、wp-config.php和php.ini</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="7a60" class="lk ll iq ns b gy nw nx l ny nz"># Protect Important Files<br/>&lt;FilesMatch "^.*(error_log|wp-config\.php|php.ini)$"&gt;<br/>Order deny,allow<br/>Deny from all<br/>&lt;/FilesMatch&gt;</span></pre><h1 id="42d1" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">禁用图像的热链接</h1><p id="0313" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">图片热链接会导致你的网站变慢。如果一个人把你网站上的图片嵌入到他们自己的网站上，那么每次图片在他们的网站上被浏览时，它就会从你的服务器上被加载。结果，你的带宽在他们没有访问你的网站的情况下就被消耗掉了。</p><p id="273e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用下面的代码块来防止这种情况发生。请确保将“jinsonvarghese.com”替换为您的域。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="a93f" class="lk ll iq ns b gy nw nx l ny nz"># Disable hotlinking of images with forbidden or custom image option<br/>RewriteEngine on<br/>RewriteCond %{HTTP_REFERER} !^$<br/>RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?jinsonvarghese.com [NC]<br/>RewriteCond %{HTTP_REFERER} !^http(s)?://(www\.)?google.com [NC]<br/>RewriteRule \.(jpg|jpeg|png|gif)$ – [NC,F,L]</span></pre><p id="4a4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">自己检查:</strong></p><p id="9e1e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过在谷歌中搜索以下内容，检查你的图片是否被热链接。下面这个谷歌呆子会做的是从你的网站上搜索每一张图片，但它会删除包含你自己的URL的每一个结果。其余的搜索结果将显示你的图片被热链接的任何网站。</p><p id="8d0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kz">inurl:your website . com-site:your website . com</em></p><h1 id="18c3" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">禁用HTTP跟踪方法</h1><blockquote class="kw kx ky"><p id="e2e9" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">HTTP TRACE方法是为诊断目的而设计的。如果启用，web服务器将通过在其响应中回显收到的确切请求来响应使用TRACE方法的请求。</em></p><p id="bd21" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">这种行为通常是无害的，但偶尔会导致敏感信息的泄露，如反向代理附加的内部认证头。这个功能在历史上可以用来绕过cookie上的HttpOnly cookie标志，但是在现代的web浏览器中已经不可能了。</em></p><p id="9cc6" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">— <em class="iq"> PortSwigger </em></p></blockquote><p id="a13c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用下面的代码块在服务器上禁用HTTP TRACE方法。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="0c26" class="lk ll iq ns b gy nw nx l ny nz"># Disable HTTP TRACE Method<br/>&lt;IfModule mod_rewrite.c&gt;<br/>RewriteEngine On<br/>RewriteCond %{REQUEST_METHOD} ^TRACE<br/>RewriteRule .* - [F]<br/>&lt;/IfModule&gt;</span></pre><h1 id="b5b7" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">禁用服务器签名</h1><p id="839e" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">服务器签名可能会向攻击者泄露敏感信息，如所用软件组件的版本，攻击者将能够根据这些信息更好地准备攻击。它们通常出现在服务器响应、404错误页面、目录列表等中。</p><p id="901a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以通过在。htaccess文件。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="9c6e" class="lk ll iq ns b gy nw nx l ny nz"># Disable server signature<br/>ServerSignature Off</span></pre><h1 id="744c" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">启用HTTP安全标头</h1><p id="f93e" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">HTTP安全头可用于提供另一层安全，以帮助减少安全漏洞。</p><h2 id="aaea" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">x-XSS-保护接头</h2><blockquote class="kw kx ky"><p id="54f8" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">X-XSS保护标头旨在启用现代web浏览器内置的跨站点脚本(XSS)过滤器。</em></p><p id="8758" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">—密钥DN</p></blockquote><p id="e536" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下代码块设置了<strong class="ka ir"> X-XSS保护</strong>报头。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="6c38" class="lk ll iq ns b gy nw nx l ny nz"># Enable X-XSS-Protection Header<br/>&lt;IfModule mod_headers.c&gt;<br/>Header set X-XSS-Protection "1; mode=block"<br/>&lt;/IfModule&gt;</span></pre><p id="b3e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考:<br/></strong><a class="ae oa" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection</a></p><h2 id="e540" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">x-内容-类型-选项标题</h2><blockquote class="kw kx ky"><p id="27e1" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">X-Content-Type-Options头可以防止Internet Explorer和Google Chrome从声明的内容类型中嗅探到响应。这有助于降低非法下载的危险，并有助于正确对待内容。</em></p><p id="3b9a" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">—密钥DN</p></blockquote><p id="5651" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面的代码块设置了<strong class="ka ir"> X-Content-Type-Options </strong>头。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="418c" class="lk ll iq ns b gy nw nx l ny nz"># Enable X-Content-Type Header<br/>&lt;IfModule mod_headers.c&gt;<br/>Header set X-Content-Type-Options nosniff<br/>&lt;/IfModule&gt;</span></pre><p id="3b9c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考:<br/></strong><a class="ae oa" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options</a></p><h2 id="ff9f" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">HTTP严格传输安全(HSTS)标头</h2><blockquote class="kw kx ky"><p id="b6fe" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq"> HTTP严格传输安全(HSTS)是一项安全增强功能，它限制web浏览器只能通过HTTPS访问web服务器。这确保了不能通过易受攻击的不安全HTTP连接建立连接。HSTS在响应报头中被定义为严格传输安全，并且一旦支持的浏览器接收到该报头，它就知道通过HTTPS传送所有信息。</em></p><p id="2895" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">—密钥DN</p></blockquote><p id="3e92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面的代码块设置了<strong class="ka ir">严格传输安全</strong>头。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="8bdd" class="lk ll iq ns b gy nw nx l ny nz"># Enable Strict Transport Security Header<br/>&lt;IfModule mod_headers.c&gt;<br/>	Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains"<br/>&lt;/IfModule&gt;</span></pre><p id="c231" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考:<br/> </strong>关于HSTS头及其指令的更多信息，可根据您的具体需求进行选择，请参考<a class="ae oa" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security</a></p><h2 id="c347" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">x-框架-选项标题</h2><blockquote class="kw kx ky"><p id="5896" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq"> Clickjacking(用户界面补救攻击、用户界面补救攻击、用户界面补救)是一种恶意技术，诱骗网络用户点击与其所点击的内容不同的内容，从而在点击看似无害的网页时可能泄露机密信息或控制其计算机。</em></p><p id="28c6" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">X-Frame-Options HTTP头仍然是最受支持的点击劫持保护选项。</em></p><p id="4c97" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">Acunetix</p></blockquote><p id="c961" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下代码块设置了<strong class="ka ir"> X-Frame-Options </strong>标题。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="2df9" class="lk ll iq ns b gy nw nx l ny nz"># Enable X-Frame-Options Header<br/>&lt;IfModule mod_headers.c&gt;<br/>Header set X-Frame-Options "SAMEORIGIN"<br/>&lt;/IfModule&gt;</span></pre><p id="6d6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考:<br/></strong><a class="ae oa" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</a></p><h2 id="b2b1" class="lk ll iq bd lm ln lo dn lp lq lr dp ls kj lt lu lv kn lw lx ly kr lz ma mb mc bi translated">推荐人-策略标题</h2><blockquote class="kw kx ky"><p id="049a" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">添加到您的站点。htaccess文件或服务器配置文件，此代码指示支持的浏览器只为来自当前域(同源)的请求设置referrer头。请记住，此标题与安全性关系不大，更多的是关于控制推荐信息，这是各种规则和法规(如GDPR)所要求的。</em></p><p id="e693" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">— htaccessbook</p></blockquote><p id="1eab" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面的代码块设置了<strong class="ka ir"> Referrer-Policy </strong>头。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="e217" class="lk ll iq ns b gy nw nx l ny nz"># Enable Referrer-Policy Header<br/>&lt;IfModule mod_headers.c&gt;<br/>Header set Referrer-Policy "same-origin"<br/>&lt;/IfModule&gt;</span></pre><p id="ab25" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">参考:<br/><a class="ae oa" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/HTTP/Headers/Referrer-Policy</a></p><h1 id="ef1a" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">禁用目录列表</h1><p id="a219" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">当目录列表被启用时，攻击者可以向<em class="kz">www.example.com/admin/</em>发出请求，来自服务器的响应将包括目录<em class="kz">管理员</em>的目录内容。</p><figure class="nn no np nq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/7505e2c477da849969463562811d745f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*E2JClMAy4wLElQsQ.png"/></div></div></figure><p id="28df" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了防止对您的网站目录进行未经授权的访问，请将下面一行代码添加到您的。htaccess文件。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="7e86" class="lk ll iq ns b gy nw nx l ny nz"># Disable Directory Listing<br/>Options All -Indexes</span></pre><h1 id="39bd" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">防止WordPress脚本注入攻击</h1><p id="15d2" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">攻击者向网站代码中注入恶意代码，以执行恶意操作，例如对敏感数据进行未经授权的访问。下面的代码块可以保护WordPress网站免受这样的攻击。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="cb4e" class="lk ll iq ns b gy nw nx l ny nz"># Protect Against Script Injection<br/>Options +FollowSymLinks<br/>RewriteEngine On<br/>RewriteCond %{QUERY_STRING} (&lt;|%3C).*script.*(&gt;|%3E) [NC,OR]<br/>RewriteCond %{QUERY_STRING} GLOBALS(=|[|%[0-9A-Z]{0,2}) [OR]<br/>RewriteCond %{QUERY_STRING} _REQUEST(=|[|%[0-9A-Z]{0,2})<br/>RewriteRule ^(.*)$ index.php [F,L]</span></pre><h1 id="8e0b" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">防范SQL注入攻击</h1><p id="5397" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">虽然这不能像WAF那样提供对SQL注入攻击的完全保护或阻止更复杂的攻击，但下面的代码块至少可以用来阻止一些最常见的SQLi攻击。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="93ed" class="lk ll iq ns b gy nw nx l ny nz"># Protect Against SQL Injection<br/>&lt;IfModule mod_rewrite.c&gt;<br/>RewriteEngine On<br/>RewriteBase /<br/>RewriteCond %{REQUEST_METHOD} ^(HEAD|TRACE|DELETE|TRACK) [NC]<br/>RewriteRule ^(.*)$ - [F,L]<br/>RewriteCond %{QUERY_STRING} \.\.\/ [NC,OR]<br/>RewriteCond %{QUERY_STRING} boot\.ini [NC,OR]<br/>RewriteCond %{QUERY_STRING} tag\= [NC,OR]<br/>RewriteCond %{QUERY_STRING} ftp\:  [NC,OR]<br/>RewriteCond %{QUERY_STRING} http\:  [NC,OR]<br/>RewriteCond %{QUERY_STRING} https\:  [NC,OR]<br/>RewriteCond %{QUERY_STRING} (\&lt;|%3C).*script.*(\&gt;|%3E) [NC,OR]<br/>RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|%3D) [NC,OR]<br/>RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [NC,OR]<br/>RewriteCond %{QUERY_STRING} ^.*(\[|\]|\(|\)|&lt;|&gt;|ê|"|;|\?|\*|=$).* [NC,OR]<br/>RewriteCond %{QUERY_STRING} ^.*(%24&amp;x).* [NC,OR]<br/>RewriteCond %{QUERY_STRING} ^.*(%0|%A|%B|%C|%D|%E|%F|127\.0).* [NC,OR]<br/>RewriteCond %{QUERY_STRING} ^.*(globals|encode|localhost|loopback).* [NC,OR]<br/>RewriteCond %{QUERY_STRING} ^.*(request|select|insert|union|declare).* [NC]<br/>RewriteCond %{HTTP_COOKIE} !^.*WordPress_logged_in_.*$<br/>RewriteRule ^(.*)$ - [F,L]<br/>&lt;/IfModule&gt;</span></pre><h1 id="0241" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">在WordPress中阻止作者扫描</h1><blockquote class="kw kx ky"><p id="a739" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">如果启用了永久链接，在许多WordPress安装中，可以枚举所有遍历作者档案的WordPress用户名。无论何时发布帖子，用户名或别名都会显示为作者。例如，URL http://site.com/?author=1将显示来自用户id 1的所有帖子。攻击者可以滥用该功能来找出站点上可用的用户名。</em></p><p id="926d" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">Acunetix</p></blockquote><p id="64f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将下面的代码添加到。你的WordPress网站根目录下的htaccess文件将阻止所有的作者扫描攻击。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="e164" class="lk ll iq ns b gy nw nx l ny nz"># BEGIN block author scans<br/>RewriteEngine On<br/>RewriteBase /<br/>RewriteCond %{QUERY_STRING} (author=\d+) [NC]<br/>RewriteRule .* - [F]<br/># END block author scans</span></pre><h1 id="5f8e" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">在WordPress阻止对load-scripts.php的DoS攻击</h1><p id="bcd0" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">WordPress中的<strong class="ka ir">load-scripts.php</strong>文件接受一个<strong class="ka ir"> load </strong>参数，该参数可以提供许多JavaScript文件名，作为回报，这个PHP文件将连接这些JavaScript文件并一次性返回。</p><p id="4894" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">攻击者有可能利用此功能发送大量请求，以关闭网站。</p><p id="c61f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面的代码块将确保所有访问<strong class="ka ir">load-scripts.php</strong>文件的尝试都将返回403禁止错误，除非来自您的域。确保替换“jinsonvarghese\”。与您的域名。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="50ea" class="lk ll iq ns b gy nw nx l ny nz"># Prevent DOS Attacks on load-scripts.php<br/>RewriteCond %{HTTP_REFERER} !jinsonvarghese\.com [NC]<br/>RewriteCond %{THE_REQUEST} \.php[\ /?].*HTTP/ [NC]<br/>RewriteRule ^wp-admin/load-scripts\.php$ – [R=403,L]</span></pre><p id="cd06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">自己测试:</strong></p><p id="736a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦添加了代码并且。htaccess文件已保存，请访问yourdomain.com/wp-admin/load-scripts.php.</p><h1 id="6a87" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">对未授权用户隐藏WordPress文件</h1><p id="88a9" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">在一个新的WordPress安装之后，有一些文件(没有太大的安全风险)仍然是用户可以访问的。因为我不喜欢未经授权的用户能够访问这些文件，所以我使用下面的代码来隐藏它们。这些文件是/wp-admin/install.php、/wp-admin/upgrade.php、readme.html和license.txt</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="f99b" class="lk ll iq ns b gy nw nx l ny nz"># Redirect install.php<br/>RedirectMatch Permanent wp-admin/install(-helper)?\.php /<br/>RedirectMatch Permanent wp-admin/upgrade\.php /</span><span id="4efe" class="lk ll iq ns b gy oc nx l ny nz"># Protect Files<br/>&lt;Files "readme.html"&gt;<br/>Require all denied<br/>&lt;/Files&gt;</span><span id="d2ff" class="lk ll iq ns b gy oc nx l ny nz">&lt;Files "license.txt"&gt;<br/>Require all denied<br/>&lt;/Files&gt;</span></pre><h1 id="21a6" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">阻止WordPress XML-RPC请求</h1><blockquote class="kw kx ky"><p id="3364" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">WordPress XML-RPC是一个旨在标准化不同系统间通信的规范。它使用HTTP作为传输机制，使用XML作为编码机制，允许传输大范围的数据。</p><p id="35dd" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated"><em class="iq">近年来，XML-RPC已经成为暴力攻击的一个越来越大的目标。当使用XML-RPC进行调用时，您需要提供用户名和密码，当您找到有效的一对时，系统会进行确认。</em></p><p id="32fb" class="jy jz kz ka b kb kc kd ke kf kg kh ki la kk kl km lb ko kp kq lc ks kt ku kv ij bi translated">——<a class="ae oa" href="https://kinsta.com/blog/xmlrpc-php/" rel="noopener ugc nofollow" target="_blank"><em class="iq">金斯塔</em> </a></p></blockquote><p id="bb12" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你没有使用像<a class="ae oa" href="https://www.getastra.com/" rel="noopener ugc nofollow" target="_blank"> Astra </a>这样的网络应用防火墙或者像<a class="ae oa" href="https://wordpress.org/plugins/wp-security-hardening/" rel="noopener ugc nofollow" target="_blank"> WP Hardening </a>这样的WordPress插件来阻止对你的WordPress站点的XML-RPC的攻击，你可以手动设置它来阻止这样的攻击。htaccess文件。</p><pre class="nn no np nq gt nr ns nt nu aw nv bi"><span id="5623" class="lk ll iq ns b gy nw nx l ny nz"># Block WordPress xmlrpc.php requests<br/>&lt;Files xmlrpc.php&gt;<br/>order deny,allow<br/>deny from all<br/>allow from xxx.xxx.xxx.xxx<br/>allow from xxx.xxx.xxx.xxx<br/>&lt;/Files&gt;</span></pre><p id="96a5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的代码中，我们指示服务器阻止对xmlrpc.php的所有访问，除了来自“allow from”后指定的IP地址的访问。</p><h1 id="048b" class="mt ll iq bd lm mu mv mw lp mx my mz ls na nb nc lv nd ne nf ly ng nh ni mb nj bi translated">最后的想法</h1><p id="eefc" class="pw-post-body-paragraph jy jz iq ka b kb mf kd ke kf mg kh ki kj nk kl km kn nl kp kq kr nm kt ku kv ij bi translated">这些是我自己使用的一些安全措施。htaccess文件。在我作为信息安全分析师的日常工作中，我遇到了多个配置不正确的站点，可以使用这些简单的修复方法。</p><p id="3101" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我决定发布这篇文章，因为我知道有更多的网站可以使用这些补丁来提高安全性。希望有帮助！:)</p><p id="7242" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kz">你可以关注我这里的</em><a class="ae oa" href="/@jinsonvarghese" rel="noopener ugc nofollow" target="_blank"><em class="kz">Medium</em></a><em class="kz">或</em> <a class="ae oa" href="https://www.jinsonvarghese.com" rel="noopener ugc nofollow" target="_blank"> <em class="kz">我的网站</em> </a> <em class="kz">了解我做的各种安全审计和我发现的疯狂漏洞的更多故事，以及在</em><a class="ae oa" href="https://twitter.com/JinsonCyberSec" rel="noopener ugc nofollow" target="_blank"><em class="kz">Twitter</em></a><em class="kz">上了解更多网络安全相关新闻。</em></p></div><div class="ab cl ld le hu lf" role="separator"><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li lj"/><span class="lg bw bk lh li"/></div><div class="ij ik il im in"><p id="33a8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kz">原载于2020年6月28日www.jinsonvarghese.com</em><a class="ae oa" href="https://www.jinsonvarghese.com/whats-on-my-htaccess/" rel="noopener ugc nofollow" target="_blank"><em class="kz"/></a><em class="kz">。</em></p></div></div>    
</body>
</html>