<html>
<head>
<title>TryHackMe- Anonymous CTF Writeup (Detailed)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe-匿名CTF报道(详细)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-anonymous-ctf-writeup-detailed-d7628a5417bb?source=collection_archive---------4-----------------------#2020-11-24">https://infosecwriteups.com/tryhackme-anonymous-ctf-writeup-detailed-d7628a5417bb?source=collection_archive---------4-----------------------#2020-11-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/cb41e095a92bd98ff75d341050ff743c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ta9vMmGaJvoKtoEsJA0Nsg.png"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated">CTF报道#22</figcaption></figure><p id="edae" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">欢迎各位！！我们将在<a class="ld le ep" href="https://medium.com/u/dc49a0a3cb16?source=post_page-----d7628a5417bb--------------------------------" rel="noopener" target="_blank"> TryHackMe </a>做匿名CTF。</p><p id="51b6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">CTF链接:</p><div class="lf lg gp gr lh li"><a href="https://tryhackme.com/room/anonymous" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">匿名</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">TryHackMe是一个学习网络安全的在线平台，使用动手练习和实验室！</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">tryhackme.com</p></div></div><div class="lr l"><div class="ls l lt lu lv lr lw jz li"/></div></div></a></div><p id="9aa3" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">CTF由以下作者创作:</p><div class="lf lg gp gr lh li"><a href="https://tryhackme.com/p/Nameless0ne" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">TryHackMe |匿名0ne</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">TryHackMe是一个学习网络安全的在线平台，使用动手练习和实验室！</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">tryhackme.com</p></div></div><div class="lr l"><div class="lx l lt lu lv lr lw jz li"/></div></div></a></div><p id="3ea6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为您的CTF计算机创建一个目录，并为Nmap创建一个目录来存储您的Nmap扫描输出。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ly"><img src="../Images/2f1fd25c44014fdb7c9b86a589dc4cc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vh12ClYSjamAUFroNmT2Tg.png"/></div></div></figure><p id="f302" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们开始吧！！享受流动吧！！</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="md me l"/></div></figure><h2 id="2ac8" class="mf mg it bd mh mi mj dn mk ml mm dp mn kq mo mp mq ku mr ms mt ky mu mv mw mx bi translated">任务1- Pwn:</h2><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/4efebec9445dffd99afa13f4a603d623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TFaMxlGCJvT_80xtGjsSWQ.png"/></div></div></figure><p id="b5f8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">部署机器。</p><h2 id="74d2" class="mf mg it bd mh mi mj dn mk ml mm dp mn kq mo mp mq ku mr ms mt ky mu mv mw mx bi translated">Nmap扫描:</h2><blockquote class="mz na nb"><p id="1131" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated"><em class="it">nmap-sC-sV-p--oN nmap/anonymous _ all ports&lt;TARGET _ IP&gt;T4】</em></p><p id="a4f3" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">-sC:默认脚本<br/> -sV:版本检测<br/> -oN:输出将存储在您之前创建的“nmap”目录中<br/> -p-:扫描所有端口</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/9c88259904935deecc3ae10c1c6d0634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UX0yseLvGnF-YeSN9pue1Q.png"/></div></div></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/88bc41984de419abe75c1cf71a0c5fb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mi1gE6DuYakRJw9b9cSP4g.png"/></div></div></figure><p id="58c5" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">有4个端口开放:<br/> 21/ftp- vsftpd 2.0.8【允许匿名登录】<br/>22/ssh-OpenSSH 7.6 P1<br/>139/NetBIOS-SSN-Samba smbd 3。X-4。x<br/>445/NetBIOS-SSN-Samba smbd 4 . 7 . 6<br/>检测到操作系统- Ubuntu Linux</p><p id="537e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">nmap扫描输出回答了任务中的几个问题。提交它们。</p><blockquote class="mz na nb"><p id="ec1a" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">列举机器。开放了多少个端口？<br/>答案:4</p><p id="386c" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">端口21上运行的是什么服务？<br/>答:ftp</p><p id="48b2" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">端口139和445上运行的是什么服务？<br/>答案:中小企业</p></blockquote><p id="c2a8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">没有网络服务器运行在端口80，因此我们不会尝试目录模糊或使用Nik查找文档等。</p><p id="1183" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">到目前为止一切顺利！！让我们开始列举服务。首先是FTP。我们将以“匿名”用户的身份执行FTP，在密码提示时，我们将插入“匿名”。它将允许我们匿名登录FTP，因为它是允许的。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/8657855b00b5f75c4682089f2ec8c515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*LOT-bGGYQJPq1m8dVFiEWg.png"/></div></figure><p id="0237" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们进去了。让我们找到一些文件，如果找到任何文件，我们将把它们转移到我们的主机上进行检查。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/ecedf641c43f581cfbac52fd0411a602.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ebnszW3EV95ENRfbX36Fcw.png"/></div></div></figure><p id="a4da" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">有一个“脚本”目录。我们将导航到它。请记住，总是使用“ls -la”检查隐藏文件是非常重要的，这样我们在退出FTP之前不会错过任何东西。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nk"><img src="../Images/b233e338e20e977e1a468a45f7513f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EdOUWN5mEHJOd_Q0P1WU3g.png"/></div></div></figure><p id="9d66" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在“脚本”目录中，总共有3个文件。一个是bash脚本，另一个是日志文件，最后一个是文本文件。我们将使用“get”命令传输它们。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/5f34577c83b56e44ef8a502f60356b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZVHPrbm6r70RffbjsIDSeQ.png"/></div></div></figure><p id="699e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">太好了，我们已经取回了文件。让我们退出FTP并逐个检查它们。</p><blockquote class="mz na nb"><p id="e304" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">clean.sh</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0fc3f005bef09eda1e4667277afaccc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6N3JUCTkZzp8HJI2DUo81g.png"/></div></div></figure><p id="7a32" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">该脚本计划自动运行，并查看代码，它只是清理日志，即“删除_文件.日志”文件。这可能对我们以后有潜在的帮助。让我们继续寻找/搜寻文件以便进一步枚举。</p><blockquote class="mz na nb"><p id="02d6" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">已删除_files.log</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nn"><img src="../Images/0c52f9feb50144037b6012464bd15aec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*P0B8SDf2gsF-1N9qS_5DXw.png"/></div></div></figure><blockquote class="mz na nb"><p id="9e14" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">todo . txt</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi no"><img src="../Images/82808bd8f77d746ef00a33d45a82708a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPZEUo3w9mnt-biC1VacQA.png"/></div></div></figure><p id="1a16" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">好的。所以。这还不够。回想一下Nmap扫描，在端口139和445上还运行着SMB服务。每当我想枚举SMB共享时，我的首选工具是“Enum4linux”。它将为我们提供SMB共享以及用户的名称。希望有匿名分享可以访问。让我们启动Enum4linux</p><h2 id="1f8a" class="mf mg it bd mh mi mj dn mk ml mm dp mn kq mo mp mq ku mr ms mt ky mu mv mw mx bi translated">Enum4linux:</h2><blockquote class="mz na nb"><p id="5120" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated"><em class="it">enum 4 Linux-a&lt;TARGET _ IP&gt;T18】</em></p><p id="5042" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">-a表示包括所有选项</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi np"><img src="../Images/23e96d2133bd220d0615e825ab8d6d54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S-i79Kg0qlNlj7vRgmPBvQ.png"/></div></div></figure><p id="1987" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们获得了一些非常有用的信息。我将从下面的输出中包括重要的位。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nq"><img src="../Images/7964f5b7e91b9aa8d58d78864b99a9b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAFMxJDQAz5ep14Nq3qy7A.png"/></div></div></figure><p id="36cb" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们获得了一个用户名“无名”。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nr"><img src="../Images/705d2e382ee233629658b10e143a5206.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tdU45vWHxJ_l7Lbl66O2tA.png"/></div></div></figure><p id="f573" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们发现了SMB共享“图片”。这将有助于我们找到更多的文件，我们可以工作。也回答了下一个问题。提交吧。</p><blockquote class="mz na nb"><p id="d333" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">用户电脑上有共享。它叫什么？<br/>答:图片</p></blockquote><p id="4ee2" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们使用“smbclient”工具来列举SMB。出现密码提示时，点击“Enter ”,我们将登录“pics”SMB共享。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/58d06b21dfc6bc684f3c8cc52aef7971.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBqUj7IDrB1RrcCxeNJArg.png"/></div></div></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nt"><img src="../Images/3d3462824f0ccd901d6c51c32f4cbc36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*btyK8wTk7Mr9X2BXhn0bcA.png"/></div></div></figure><p id="974b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">文件传输到我们的主机后，我们将退出并检查图像，如果它们打开或损坏了不正确的文件签名。</p><blockquote class="mz na nb"><p id="f26d" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">corgo2.jpg</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nu"><img src="../Images/4aa1dbb50a1dbe94ada09d27fd4a2121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nQvoWUgl83kpfe45TXZyKQ.png"/></div></div></figure><blockquote class="mz na nb"><p id="65ac" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">puppos.jpeg</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ns"><img src="../Images/9f03fc81bc4107bd8435abcb5c21bbc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7D5a3V1we6d07mAoJqumA.png"/></div></div></figure><p id="3743" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">显然是可爱的狗狗照片。我们也许可以使用隐写术工具来检查更多关于这些图像的信息。也许它们包含隐藏的文件或信息。我的首选steg工具是“steghide”。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nv"><img src="../Images/bbbacf04804d8a70df3731625c2fca19.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wVF5RHCi1ue_oUv8H6H7BA.png"/></div></div></figure><p id="c1f8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Steghide输出检测到图像受密码保护。我们没有。</p><p id="a2ed" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">也有一种方法可以使用“stegcracker”工具对带有所需单词列表的图像进行暴力破解。我们可以利用它。但我可以向你保证这需要很长时间。如果你注意到下面的截图，扫描只完成了2.21%，花费了17分钟。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/3356c747374494f19a9a1bfb92e362c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ueUAiYh7lFzarCZtvjRxqg.png"/></div></div></figure><p id="4f7f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我花点时间给你一些建议。建议是永远不要在CTF环境中暴力破解任何服务或登录页面或图像等超过5分钟。如果暴力破解花费了超过5分钟的时间，那么你就做错了，并且穿过了一条意想不到的通向兔子洞的路。CTF被设计成能够在不到或等于5分钟内暴力破解。以我的经验，我可以告诉你这一点。我们不会从这些照片中找到任何东西。因此，我们将继续做其他事情。</p><p id="7db6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">回想一下之前我提到的“clean.sh”脚本可能对我们有用。让我们玩玩这个脚本，想一个在目标机器上获得shell的方法。</p><p id="c0f9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">重新访问“clean.sh”脚本。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nm"><img src="../Images/0fc3f005bef09eda1e4667277afaccc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6N3JUCTkZzp8HJI2DUo81g.png"/></div></div></figure><p id="3bd8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以通过包含一个反向shell脚本来覆盖该脚本。我们可以从下面的链接中找到不同格式的反向shell脚本:</p><div class="lf lg gp gr lh li"><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">反向外壳备忘单</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">如果你足够幸运，在渗透测试中发现了一个命令执行漏洞，不久之后…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">pentestmonkey.net</p></div></div></div></a></div><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nx"><img src="../Images/6a54505bc052e2e062bd9711d7c756ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQ2pslbAbUAttxgwHRARJg.png"/></div></div></figure><p id="236d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们将使用上面的python反向shell脚本来尝试在目标机器上获得shell。<br/>我们如何做到这一点？<br/>在我们修改了主机的IP和Port值后，我们将使用反向shell脚本覆盖“clean.sh”文件。更改脚本中的值以使其正常工作是非常重要的。</p><p id="1d57" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们需要将反向shell脚本上传到机器上。我能想到的最简单的方法是使用“FTP”服务来上传脚本。通常我们使用“get”命令从FTP服务下载或传输文件。同样，我们可以使用“上传”命令将文件上传到FTP服务。它将允许我们上传脚本，并将自动执行脚本。</p><p id="cf82" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们现在做那件事。</p><p id="1aa9" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我的机器过期了，所以我不得不重新启动它。只是IP变了，其他什么都没变。</p><blockquote class="mz na nb"><p id="26eb" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">在“nano”编辑器中覆盖“clean.sh”脚本。</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ny"><img src="../Images/0484e89932f17d116feaaf10ccd22323.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k0CYlPfxuPdUyxKkmtT9Wg.png"/></div></div></figure><p id="344e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">保存它[Ctrl+O]并退出它[Ctrl+U]</p><blockquote class="mz na nb"><p id="b703" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">我们将在脚本中插入的端口上启动一个netcat监听器。</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/d7a9d33e4d9e6962d7b475d27ff5c7f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*RINDDkMm0sVrT92f8BI_oA.png"/></div></figure><blockquote class="mz na nb"><p id="d55e" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">匿名登录FTP</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4b24d3c52e97084f3c588d78ba8025ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*99XkSaeFeO3aZ2CGD9JwMw.png"/></div></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/de2aad9592c652c0a5ba9236aae5b84e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*toOXuTyFxoTK1hU1ppdAoA.png"/></div></div></figure><blockquote class="mz na nb"><p id="eb42" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">使用“上传”命令上传脚本</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/b4389e417eae251c85d249d8265fdb90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8jpENCFSEj6_sE9jkMXTA.png"/></div></div></figure><blockquote class="mz na nb"><p id="8399" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">过一会儿再检查收听者<br/>…</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi od"><img src="../Images/35bf60d71aff8da92ef72b4b21a2060b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WRe0kIw3XUbxfZE5NkBuGA.png"/></div></div></figure><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="oe me l"/></div></figure><p id="d465" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">太棒了！！<br/>我们成功获得了shell。<br/>但这个壳不是一个稳定的壳。<br/>我们如何获得稳定的外壳？让我给你带路。</p><blockquote class="mz na nb"><p id="c7e0" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">$ python-c ' import pty；pty . spawn("/bin/bash ")'<br/>Ctrl+Z<br/>stty raw-echo<br/>fg<br/>export TERM = xterm</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/6db43e33dd6b37237af3e3ec2150b058.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*gg_nz9REPauOPes7Bk7ptg.png"/></div></figure><p id="7d1d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们现在有一个稳定的外壳。<br/>以上命令将让您现在通过TAB键自动完成，清除屏幕，在shell中轻松导航。</p><p id="68e7" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">让我们寻找我们的用户标志！</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ffb5dd9560a95f8fc0c68a2861a520a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*NM0DZYFxab-pib7NDMi3Yg.png"/></div></figure><p id="ec86" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">太棒了。！获取了用户标志。提交吧。</p><blockquote class="mz na nb"><p id="f737" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">user . txt<br/>Ans:xxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p></blockquote><p id="98c4" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">现在怎么办？是的，我认为这确实是对的。我们需要提升我们在机器上的权限，以成为root用户并获取root标志。</p><p id="616a" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以从一些手工枚举开始。首先，我们可以搜索/找到设置了超级用户权限的二进制文件。这意味着用户可以以root身份运行二进制文件。</p><blockquote class="mz na nb"><p id="2d11" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">find / -perm -4000 2&gt;/dev/null</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/a0652637edba0ac29ca48dbf3d891cd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*uKevHf99NTPY4wrx9O_H3A.png"/></div></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/5d1904dc942d48ac831744028fc71a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*4gfpvr5-Hk_kKa7UYtLMog.png"/></div></figure><p id="bfc6" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我认为二进制的“env”有可能被用于特权提升的目的。我找到privesc命令的网站是GTFOBins。<br/>链接如下。</p><div class="lf lg gp gr lh li"><a href="https://gtfobins.github.io/#env" rel="noopener  ugc nofollow" target="_blank"><div class="lj ab fo"><div class="lk ab ll cl cj lm"><h2 class="bd iu gy z fp ln fr fs lo fu fw is bi translated">GTFOBins</h2><div class="lp l"><h3 class="bd b gy z fp ln fr fs lo fu fw dk translated">GTFOBins是Unix二进制文件的精选列表，攻击者可以利用它来绕过本地安全限制…</h3></div><div class="lq l"><p class="bd b dl z fp ln fr fs lo fu fw dk translated">gtfobins.github.io</p></div></div><div class="lr l"><div class="oj l lt lu lv lr lw jz li"/></div></div></a></div><blockquote class="mz na nb"><p id="6e74" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">搜索“环境”</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ok"><img src="../Images/06408e10180e511e645e78c15fddf119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VCmSMPmylx2nTb0m8NQSGw.png"/></div></div></figure><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ol"><img src="../Images/e0586cb2a8af952dbcac228990ff45a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*moTs5I7TG8wromENE1Hafg.png"/></div></div></figure><p id="3975" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">因为我们知道二进制文件设置了SUID位，所以我们需要执行/bin/sh -p后面的二进制文件，它将运行二进制文件的SUID副本，从而允许我们提升权限。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi om"><img src="../Images/110f67b7ee0f060d32606f21d5e241ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Xhf2l5ZrcEzDGsjOjGr0g.png"/></div></div></figure><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="on me l"/></div></figure><p id="4fac" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们现在可以确认我们是根了！！<br/>让我们抓住根旗，给这个盒子一个圆满的结局。</p><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/2b27d717b1299fd48a7a71ef636ca646.png" data-original-src="https://miro.medium.com/v2/resize:fit:846/format:webp/1*gy2HV1_HeUoi_kdursqJiA.png"/></div></figure><p id="8dab" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">提交吧。</p><blockquote class="mz na nb"><p id="f4f0" class="kf kg nc kh b ki kj kk kl km kn ko kp nd kr ks kt ne kv kw kx nf kz la lb lc im bi translated">root . txt<br/>Ans:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</p></blockquote><figure class="lz ma mb mc gt ju gh gi paragraph-image"><div class="gh gi op"><img src="../Images/21ceaeffdcfa84926d9aa2e5d5063c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:680/format:webp/1*KiVOtF8kQVyk5x0HOCo6-A.png"/></div></figure><p id="e61e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们已经完成了房间。我真的很喜欢这个房间，并从中获得了很多乐趣。我会建议每个人都尝试一下这个房间，我希望你离开时能学到一些新东西。</p><p id="340f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你喜欢这篇文章，并且这篇文章对你有所帮助，请在评论中告诉我，或者用掌声分享你的爱。</p><figure class="lz ma mb mc gt ju"><div class="bz fp l di"><div class="on me l"/></div></figure><p id="f72b" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">谢谢你抽出时间。</p><p id="ec5c" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">跟着我。</p><p id="2b85" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">更多的报道正在进行中。</p><p id="92e8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">保重，注意安全，继续黑！</p><p id="52d8" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">哈桑·谢赫</p></div></div>    
</body>
</html>