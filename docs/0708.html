<html>
<head>
<title>TryHackMe. Breaking Into the Kenobi Machine.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe。闯入克诺比机器。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-breaking-into-the-kenobi-machine-c569c4e2c625?source=collection_archive---------4-----------------------#2020-07-20">https://infosecwriteups.com/tryhackme-breaking-into-the-kenobi-machine-c569c4e2c625?source=collection_archive---------4-----------------------#2020-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f0e1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这不仅仅是一个基本的演练，而是一个可以学习的资源。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3de8ced30c31cc4cc50fb4f21c4be721.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IZDE2ySS1NaF5XiJgyrMmg.png"/></div></div></figure><ol class=""><li id="0e7e" class="kr ks iq kt b ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="kt ir"> <em class="lj">部署易受攻击机器</em> </strong></li></ol><p id="c4b0" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在渗透测试的最开始，我想从两个扫描开始，我通常称之为基本Nmap扫描和vuln扫描。</p><p id="b45d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">基本Nmap扫描:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/b32918f63135c005a0763988ee4a1676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Js1EZvS9mGy7r0gDM8V39g.png"/></div></div></figure><p id="a878" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在基本扫描中，我通常使用-sC、-sV和-O开关。</p><p id="c633" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">外阴扫描:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/0d07ff857a9dd35230e10ef65d4bc39a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T9N0tt2hCaFkrNyMC8k-eQ.png"/></div></div></figure><p id="3bb0" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">Vuln scan没有为我们提供太多有价值的信息，所以我们不会详细讨论它的结果，但从一开始就看到潜在的漏洞仍然是一个很好的做法。</p><p id="56d7" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">对第一次扫描的探索将会给我们第一部分第二个问题的提示。</p><p id="8a00" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">2<em class="lj">。</em> </strong> <strong class="kt ir"> <em class="lj">枚举桑巴股份</em> </strong></p><p id="6697" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">因为这不仅仅是一个演练，而是一个学习的机会，我将粘贴对我来说是新的附加信息以及我们可以学习的资源的链接。</p><p id="e42a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">下面是来自《桑巴简介》TryHackMe的截图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lz"><img src="../Images/90256627f0510e800b6fcdb2027d8125.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aLklpuASQHTRwcfSVciXQw.png"/></div></div></figure><p id="2159" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">正如我们从Nmap扫描中注意到的，端口139和445是开放的，有机会找到进入系统的潜在入口。那么，让我们运行由我们的老朋友Nmap提供的基本SMB枚举扫描。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/3340fb46dc4436a9cb2f361f2c44696a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-kWn00Qq-i0ZmZCzg1r6g.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk translated">从tryhackme.com取回</figcaption></figure><p id="8eb9" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">我们可以通过简单地使用以下命令来检查所有SMB枚举扫描:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mf"><img src="../Images/efbe7c7a1ea7ca0aaaf5adf598be187a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2CpiuSHfofDN4418koIY7g.png"/></div></div></figure><p id="708d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在我们的例子中，让我们按照TryHackMe的建议运行:</p><p id="37e5" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">nmap-p 445-script = SMB-enum-shares . NSE，SMB-enum-users . NSE&lt;IP-addr&gt;-oN SMB _ enum . nmap</strong></p><p id="6b75" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">或者，如果我们需要更多信息，我们可以:<strong class="kt ir">nmap-p 445-script = SMB-enum *&lt;IP-addr&gt;-oN SMB _ enum . nmap</strong></p><p id="dbb0" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">现在，我们可以浏览输出并找到系统上可用的SMB共享。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mg"><img src="../Images/520f12cbb5e1fa2d739efa3de921bf41.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lC7BQS_sPJ1aIv6UdWamUQ.png"/></div></div></figure><p id="949a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在这里，我想删除一些关于这些共享的截图，这样我们就能对我们实际列举的内容有更多的了解。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mh"><img src="../Images/6ad408913b947ccef01f31854835c787.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*__VnzOG6I4-E_8mhWFFATw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mi"><img src="../Images/e866a50f8a21fa0b03ba79e8354b02c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-eVwvhDQ0cVPXxHnrJg2Eg.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mj"><img src="../Images/a40042f323cbaa1ff09d3f0c25ce5d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oT_3py8TLVg_qJ6IbaUOCg.png"/></div></div></figure><p id="0e3e" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">接下来，我们将通过键入以下命令来访问该匿名共享:</p><p id="76b3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir"> smbclient // &lt; ip地址&gt;/匿名</strong></p><p id="fd9e" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">它将让我们访问位于<strong class="kt ir"> C:\home\kenobi\share </strong>路径中的匿名共享。在那里我们会找到问题2的文件。</p><p id="e5e7" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">为了下载该文件，我们可以发出<strong class="kt ir">smbget-R SMB://&lt;IP-add&gt;/anonymous</strong>命令。</p><p id="5c7a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">浏览该文件，记录一些可能对入侵机器有用的信息。</p><p id="fdbd" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">回到Nmap扫描，我们看到了TCP端口111 (rpcbind)。为了更好地理解什么是潜在的弱点，让我们探索一下RPC是什么以及它是如何工作的。</p><p id="4e72" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">基本上，Microsoft远程过程调用(MSRPC或RPC)是本地机器上的程序调用远程主机上的应用程序要执行的过程的过程。该过程的输出返回给请求者。</p><p id="6f7f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">下面是更深入的解释:<a class="ae mk" href="https://docs.microsoft.com/en-us/windows/win32/rpc/how-rpc-works" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/windows/win32/RPC/how-RPC-works</a></p><p id="1575" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">TryHackMe:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/ea3362e12a85fca2dd8cf7e463660401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lJ_Q8uYnKB0pLl3kymS1Zg.png"/></div></div></figure><p id="88e3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">端口映射器似乎是公开的，所以我们可以看到什么程序监听什么端口。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mm"><img src="../Images/4a35274567d8a195fb1cf9cc3c48b5ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MJ1_4azN8fKUpwggvtD3HQ.png"/></div></div></figure><p id="24dc" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">从输出中可以清楚地看到，NFS服务正在运行。</p><p id="e01f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">让我们从Nmap脚本引擎运行一些nfs脚本，看看我们是否能得到一些有趣的东西。</p><p id="f910" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">TryHackMe建议使用这些脚本:<strong class="kt ir"> nmap -p 111 -script=nfs-ls，nfs-statfs，nfs-showmount &lt; ip-addr &gt;，</strong>但是我们可以做更多的扫描以达到教育的目的(……<strong class="kt ir">-script = NFS *</strong>)。</p><p id="458a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">输出显示了我们可以访问哪些装载，我们肯定可以进一步利用这些信息。</p><p id="30b2" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir"> <em class="lj"> 3。使用ProFtpd </em> </strong>获取访问权限</p><p id="3794" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">快速浏览TryHackMe的ProFtpd:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/d74b8e13c104a0ee1cc540a59ebd490a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bm_dDrD5281Q9joEZ8Er0Q.png"/></div></div></figure><p id="76ed" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">为了检查当前版本的FTP服务器是否存在漏洞，我们可以使用<strong class="kt ir"> searchsploit </strong>命令利用本地ExploitDB数据库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/7097f4596b0d0ece9ea530e28de837b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prrZNeT8hJmzONl1NiDwNw.png"/></div></div></figure><p id="c4c0" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">如果您想更详细地探索这些漏洞，请使用带有<strong class="kt ir"> -x </strong>开关的<strong class="kt ir"> searchsploit </strong>进行深入研究。</p><p id="e5dc" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">例如:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/86f66ef5ffde2e129bec8fc2bd957091.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_l0AKhELP0Sfl_N3-4QNxw.png"/></div></div></figure><p id="ccaa" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">最后一个命令将提供以下输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/cbf7a2c19a5c1301bfdd759791ec1e4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*psCvG3nHxs1nNwr5asWFXA.png"/></div></div></figure><p id="113a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">从描述区域，我们可以了解实际的漏洞是什么，以及我们如何利用它。</p><p id="9845" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">为了连接到FTP服务器，我们将使用NetCat实用程序。下面的屏幕截图显示了将SSH密钥复制到NFS共享(/var*)的过程。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mr"><img src="../Images/afdf216e6ec090db2d8f6ba2cffc44af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HoDBicRc226x2_6immZr4w.png"/></div></div></figure><p id="414f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">现在，我们可以将/var/tmp目录挂载到我们的机器上，并检索SSH密钥。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/4624f1890e0f0f5481b911188004f578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mXR9AqWMnaHKU3MZKA7Ubg.png"/></div></div></figure><p id="ec3d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">您可以通过进入我们放置id_rsa文件的tmp目录来检索密钥。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/de58670d4cdd15acc948eccadcb6851b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAsM_6xZPhpkOy0IrvPf2A.png"/></div></div></figure><p id="11cb" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">现在，让我们将密匙从挂载复制到我们的系统，并通过SSH连接到受害者机器。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lx"><img src="../Images/2e4d0c68567d10e7ab98a204b1d91c30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8fMWekErEX_nTr4zRprHeA.png"/></div></div></figure><p id="b88c" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">您可以使用cat user.txt获取您的标志。</p><p id="cd35" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这可能会混淆我们刚刚做的事情，特别是当涉及到不同的共享和FTP服务器时。</p><p id="e2cc" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">因此，这里有一点关于目前为止所涉及的股票之间的差异的解释。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/6a89922b5012b9dfdb0dbaa591069590.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7d7A8OICm8Hi6Ef2_4tpCg.png"/></div></div></figure><p id="7563" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir"> <em class="lj"> 4。通过路径变量操作提升权限</em> </strong></p><p id="ec5c" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">为了找到启用了SUID位的二进制文件，我们可以使用以下两个命令:</p><p id="bbf1" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">find/-perm-u = s-type F2&gt;/dev/null</strong></p><p id="943f" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">或者</p><p id="47f4" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">find/-perm-4000-type F2&gt;/dev/null</strong></p><p id="f7f3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">这两个命令的第二部分将把错误消息(权限被拒绝)发送到任何地方。</p><p id="07c9" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">为了从前面的命令输出中发现一些奇怪的东西，您可以比较在易受攻击的机器和您自己的系统上执行该命令的结果。它可以作为一个基线。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/1121b15f66f30a57ec77c5dfb9fc8fb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AKdSs0-0HCy7o0wiPpvkw.png"/></div></div></figure><p id="0abf" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir"> /usr/bin/menu </strong>看起来很奇怪，我们来看看这个。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/1e2f31cba20e526a6364ef758831d503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v0AFLjfK_-Q-MvW5EUE_Mw.png"/></div></div></figure><p id="250a" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">在探索了该程序的功能之后，我们可以看到它的输出看起来像是众所周知的Linux命令的输出。</p><p id="eea8" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">我们可以使用<strong class="kt ir"> strings </strong>命令来查看这个应用程序源代码中人类可读的行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/563c0fb4ce4b28a1e5bdba4dee9a2d21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dBfqIo-3t_KWyx1zmY7ceA.png"/></div></div></figure><p id="78c1" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">正如我们已经看到的，在这些选项后面有三个Linux命令(curl、uname和ifconfig)。但是，没有指定这些二进制文件的完整路径。它告诉我们，系统会在克诺比的路径上寻找这些指令。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/65b23107ffe8e3d84ca8192721316a90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g2TfrlopJBYndfaDqrjiBw.png"/></div></div></figure><p id="0068" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">但是，如果我们创建这些命令的版本，并在现有列表的开头添加新的路径，会怎么样呢？</p><p id="02dc" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">首先，让我们创建自己的curl命令，当执行该命令时，它将给出shell:</p><p id="dac3" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">回声'/bin/sh' &gt;卷曲</strong></p><p id="b78d" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir"> chmod 766 curl </strong></p><p id="864c" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">其次，我们需要向克诺比路径添加另一个条目，指向我们刚刚创建的全新curl二进制文件:</p><p id="2002" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated"><strong class="kt ir">导出路径=/tmp:$PATH </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/c0d2a299193f87c810f598b009330d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zON48-coPV-E94eAQJFBBw.png"/></div></div></figure><p id="1814" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">所有准备工作都已完成，让我们再次运行/usr/bin/menu二进制文件。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mx"><img src="../Images/bd699ad4cd9db459657c4f0add3e5e1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H3RZfgV9qPNPYxAxMZbAYQ.png"/></div></div></figure><p id="8498" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">瞧啊。现在，我们是根！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/7a1c537c69bba23af611e20120fb1576.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fBQFrUgzvNAt4ypsC0bIcw.png"/></div></div></figure><p id="c1df" class="pw-post-body-paragraph lk ll iq kt b ku kv jr lm kw kx ju ln ky lo lp lq la lr ls lt lc lu lv lw le ij bi translated">所有剩下的——找回最后一面旗帜！</p></div></div>    
</body>
</html>