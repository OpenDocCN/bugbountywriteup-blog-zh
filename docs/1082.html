<html>
<head>
<title>OTP login rate limit bypass- The easiest bug beginners can find.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OTP登录速率限制旁路——初学者能找到的最简单的bug。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/otp-login-rate-limit-bypass-the-easiest-bug-beginners-could-find-638681bed95e?source=collection_archive---------0-----------------------#2021-01-25">https://infosecwriteups.com/otp-login-rate-limit-bypass-the-easiest-bug-beginners-could-find-638681bed95e?source=collection_archive---------0-----------------------#2021-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2b55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">朋友们好，</p><p id="8cd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我要写的是一个漏洞，它可能会激励一些正在努力寻找第一个bug的初学者。这就是“OTP登录速率限制旁路”。如果你是bug bounty的初学者，我建议你测试一下这种问题，与其他技术bug相比，这种问题更容易发现。搜索允许用户使用OTP登录的web应用程序或移动应用程序。</p><p id="ae5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我搜索了印度的创业网络应用程序，幸运的是我能够找到一些允许以这种方式登录的应用程序。这篇文章是关于这样一个发现和我遵循的方法。</p><p id="a157" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我选择了这个特定的web应用程序，在登录页面上，我输入了我的手机号码并请求了一次性密码。我在手机上收到了一个6位数的号码，但在打开Firefox浏览器的网络选项卡以监控web请求后，我试图在应用程序中输入错误的6位数。我收到一条错误消息，上面写着“无效的动态口令”。我将同一个无效的OTP重新发送了几次，以检查是否有任何速率限制。不出所料，在尝试了8次之后，我开始收到“超过尝试次数”的消息。然后，我将请求转发到打嗝中继器，并开始篡改每个参数。我注意到一个名为udid的头，它的值是随机数。我确信标题是用户的某种标识。我在该值上添加了一些随机数，并发出了请求。就是这样！！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/4b584f2930ab35252ae96134068d59dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*go3a3-JU_xJzG1wh"/></div></div></figure></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="4924" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我再次收到错误信息，显示“无效的动态口令”，而不是“超过尝试次数”的信息。在每个请求中给udid头的值赋予任意一个随机数都绕过了速率限制。因此，利用这个漏洞，我可以为受害者的帐户请求一个OTP，并不断输入完整的6位数字，直到我找到正确的一个。使用打嗝入侵工具很容易做到这一点。</p><p id="1191" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我马上上报了。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="a3c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">修复和旁路</strong></p><p id="c3c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该公司很快修复了该漏洞，因此更改udid将不再有效。他们让我再测试一次。然后我试着切换我的IP地址，检查速率限制是否基于IP地址。但是没有用。然后我又开始篡改参数。我在手机号码里编码了国家代码，没用。我在手机号码之间加了空格，但也没用。后来，我在手机号码的末尾加了空格，结果成功了。因此，在手机号码末尾为每个请求添加一个空格将绕过速率限制。我再次报告了这个问题，后来问题得到了解决。因为发现了这个安全问题，我收到了公司的奖励。</p></div></div>    
</body>
</html>