<html>
<head>
<title>What do Netcat, SMTP and self XSS have in common? Stored XSS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Netcat、SMTP和self XSS有什么共同点？存储的XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/what-do-netcat-smtp-and-self-xss-have-in-common-stored-xss-a05648b72002?source=collection_archive---------1-----------------------#2019-07-16">https://infosecwriteups.com/what-do-netcat-smtp-and-self-xss-have-in-common-stored-xss-a05648b72002?source=collection_archive---------1-----------------------#2019-07-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你正在读这封信，你可能想知道这是什么？这是在开玩笑吗？答案是否定的，这不是一个诱饵，这是一个把小问题串联起来，从自我的XSS转向完全成熟的XSS的故事。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/6be99913dc9d5aa4642915edaf63383a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qq3V2LhTqcKSSb9s"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">只是一张随意的照片</figcaption></figure><p id="cea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi lb translated">当我开始黑一个私人程序时，这段旅程就开始了，在做研究时，我遇到了一个他们知道的自我XSS问题，这显然超出了范围。所以我继续挖掘，并开始了解该应用程序是如何工作的，它有CRM和其他相关的东西，这些东西现在并不重要。该应用程序有多个部分，其中一个是客户管理，具有常规功能，如创建/删除/修改客户，创建/附加发票…自我xss存在于客户视图的信息字段中。</p><blockquote class="lk ll lm"><p id="cbd9" class="jn jo ln jp b jq jr js jt ju jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj kk ij bi translated"><a tlclick="”sendEmail(&quot;email_here&quot;)”">邮箱_此处</a></p></blockquote><p id="e8ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过在电子邮件中添加一个简单的‘我能够打破html，然后添加我自己的属性。</p><p id="4a76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过进一步挖掘，我发现如果你向发票电子邮件地址发送电子邮件，应用程序会检查发件人的电子邮件地址是否存在于客户的数据库中，如果找到，它会为该客户创建一个新的票证，但如果我们从非客户地址发送电子邮件呢？随着新票据一起创建了一个新的客户端。</p><p id="224a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，由于我可以控制部分客户信息(电子邮件地址)，我需要能够发送真正丢失格式的电子邮件，最简单的方法是使用NETCAT。所以我打开了一个新的终端，查询他们的电子邮件服务器，开始构建漏洞。</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="dd78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我必须建立一个工作的XSS，然后我必须找出哪些字符破坏了SMTP语法，并对它们进行编码，最后得到一封这样的电子邮件</p><blockquote class="lk ll lm"><p id="e952" class="jn jo ln jp b jq jr js jt ju jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj kk ij bi translated">onmouseover = ' alert &amp; # 40 local storage . oauth &amp; # 41 ' @ plenumsec . com</p></blockquote><p id="8127" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后的攻击看起来像这样</p><pre class="km kn ko kp gt ly lz ma mb aw mc bi"><span id="0693" class="md me iq lz b gy mf mg l mh mi">nc -C mxa.mailgun.org 25 <br/>&gt;HELO plenumsec.com<br/>&gt;MAIL FROM: &lt;'onmouseover='alert&amp;#40localStorage.oauth&amp;#41'@plenumsec.com&gt; <br/>&gt;RCPT TO: &lt;random@target.com&gt;<br/>&gt;DATA<br/>From: Attacker &lt;'onmouseover='alert&amp;#40localStorage.oauth&amp;#41'@plenumsec.com&gt;<br/>To: Victim  &lt;random@target.com&gt;<br/>Subject: Urgent<br/>Date: Wed, 26 Sep 2018 14:21:26 -0400<br/>Hello,<br/>This is a stored xss poc.<br/>Goodbye.</span></pre><p id="bd35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，攻击者只需等待员工访问客户端管理页面或执行包括攻击者电子邮件在内的任何操作。该公司的电子邮件是完全可以猜测的，因此可以通过暴力和自动化的过程成为目标。</p><p id="311b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有人会说，这种攻击本来可以通过实施SPF来避免，但有时安全性对企业来说并不方便，所以他们不得不做出妥协。</p><p id="de03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读，</p><p id="dc1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问候，全体会议</p></div></div>    
</body>
</html>