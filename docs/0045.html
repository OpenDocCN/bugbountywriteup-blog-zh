<html>
<head>
<title>#BugBounty — “How I was able to shop for free!”- Payment Price Manipulation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">#BugBounty —“我是如何免费购物的！”-支付价格操纵</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-how-i-was-able-to-shop-for-free-payment-price-manipulation-b29355a8e68e?source=collection_archive---------0-----------------------#2018-02-11">https://infosecwriteups.com/bugbounty-how-i-was-able-to-shop-for-free-payment-price-manipulation-b29355a8e68e?source=collection_archive---------0-----------------------#2018-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5b79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="d560" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我最近的bug赏金猎人中，我遇到了一个关键但简单的漏洞。这是支付价格操纵，通过它我可以以最低的成本购买任何产品。所以，让我们看看整个漏洞是什么-</p><p id="1a08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我必须买一套结婚礼服去参加一个婚礼，所以我上网，在那里我遇到了一个受欢迎的印度购物网站，并开始了我的搜寻。几天来，我一直在寻找支付网关中的一些bug，这来得正是时候。所以我在请求到达支付网关之前捕捉到了它—</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/c573dd7777df5b23446ee6f5b79ad480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6YqslshrbVJq1Vd05L1y6w.png"/></div></div></figure><p id="9785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意<strong class="jp ir">金额</strong>参数携带要支付的金额，此处为“Rs。1104.00”(INR)，我毫不犹豫地篡改了价格值，输入“119”，意思是1.19 (INR)，然后转发HTTP请求。接下来，我被重定向到银行支付页面，如下图所示</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/2cd3b59e5c6bb777f43d1273220fac78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8wKo0d24jfmeKqWmNbre-A.png"/></div></div></figure><p id="22ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哇哦！最后一个奖项是“1.19”，我脸上挂着灿烂的笑容，然后我进一步得到这个—</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ky"><img src="../Images/4c5e59be576b0d912f68b861b0dc0564.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_DoBITJeoTkniGC9aaZKUw.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">订单已成功下单</figcaption></figure><p id="38f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ld">订单成功下单，我只花了1.19印度卢比就买了1104.00印度卢比</em> </strong> :D .如此简单却又如此严重的漏洞，当服务器没有验证奖品时就会发生这种情况。令人惊讶的是，如此简单的漏洞仍然存在，开发者错过了奖品的验证。可以采取一些安全措施来防止此类攻击—</p><blockquote class="le lf lg"><p id="1a62" class="jn jo ld jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated">总是由服务器确认奖品。</p><p id="f0f3" class="jn jo ld jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated">从db拉奖，检查是否是同一个奖。</p><p id="355b" class="jn jo ld jp b jq jr js jt ju jv jw jx lh jz ka kb li kd ke kf lj kh ki kj kk ij bi translated">不要在http请求中发送金额，而只发送产品id。</p></blockquote><p id="81b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！这就是这个有趣的发现。☺</p><p id="8888" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(<a class="ae lk" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)(<a class="ae lk" href="https://www.reddit.com/user/logicbomb_1/" rel="noopener ugc nofollow" target="_blank">https://www.reddit.com/user/logicbomb_1/</a>)</p></div></div>    
</body>
</html>