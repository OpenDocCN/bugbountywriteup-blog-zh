<html>
<head>
<title>Tackling CVE-2021–41277 Using a Vulnerability Database</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用漏洞数据库应对CVE-2021–41277</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tackling-cve-2021-41277-using-a-vulnerability-database-5e960b8a07c5?source=collection_archive---------0-----------------------#2021-12-21">https://infosecwriteups.com/tackling-cve-2021-41277-using-a-vulnerability-database-5e960b8a07c5?source=collection_archive---------0-----------------------#2021-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/94477a73d1e6e4e008d7c9a3dfcbb843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a-P3zmoCIshJqSyuAQQGeA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">沙哈达特·拉赫曼在<a class="ae kc" href="https://unsplash.com/s/photos/cyber-security?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的照片</figcaption></figure><p id="f110" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我将谈论一个安全漏洞(CVE-2021–41277)，它最近在信息安全委员会中很流行。我还会谈到一个流行的安全漏洞数据库，WhiteSource漏洞数据库。所以让我们开始吧！</p><p id="62f2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上个月，Twitter上的一个帖子引起了我的注意。它包含了一个14K的受CVE-2021–41277影响的服务器列表，还有更多被发现。世界上可能有更多受影响的元数据库服务器。所以，我决定先用漏洞数据库研究一下<a class="ae kc" href="https://nvd.nist.gov/vuln/detail/CVE-2021-41277" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">【CVE-2021–41277</strong></a>。</p><p id="ac59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我的研究项目，我决定使用开源软件white source Vulnerability Database，这似乎是最适合帮助我解决这个问题的平台。在我讨论我的发现之前，让我给你一些关于白源漏洞数据库的基本信息。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/55eccec9acb00696f87822e0288586cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZOnsib_1tbtMIeOQ"/></div></div></figure><p id="e8b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://www.whitesourcesoftware.com/vulnerability-database/" rel="noopener ugc nofollow" target="_blank">白源漏洞数据库</a>是一个非常受欢迎的开源平台，拥有一个大型漏洞数据库，为每个CVE提供详细信息和资源接口。</p><p id="2fb8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在WhiteSource漏洞实验室，您可以找到有关开源安全漏洞的信息。这些信息是由WhiteSource的全面开源漏洞数据库从数百个受欢迎和受关注的社区资源中汇总而来的。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/2d8628182116ed354e02c92e0df0080c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JetJmAfAsN8KRs0z"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://www.whitesourcesoftware.com/" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="5345" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们还提供了定期更新的最严重的<strong class="kf ir">“10大WS-CVE”</strong>漏洞列表。</p><p id="585d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您还可以使用其<a class="ae kc" href="https://www.whitesourcesoftware.com/vulnerability-database/full-listing" rel="noopener ugc nofollow" target="_blank">完整列表</a>功能进行特定的CVE搜索。该列表按月分段。<a class="ae kc" href="https://www.whitesourcesoftware.com/vulnerability-database/full-listing" rel="noopener ugc nofollow" target="_blank"> </a>现在，让我们在平台上搜索<strong class="kf ir">CVE-2021–41277</strong>，以了解我们目标的更多信息，并从技术上解决漏洞。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/25f3cd3dc5a72d3ab3f4b1cfff5fb7df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K6D_0pgesG8uPV4l"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-41277" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="f7f9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">激动人心的部分来了。首先，让我们从该工具的<strong class="kf ir">【须知】</strong>部分获取关于漏洞和发布日期的信息。</p><p id="02aa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">WhiteSource对CVE-2021–41277的总结如下:</p><p id="1b44" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lh">“Metabase是一个开源数据分析平台。在受影响的版本中，已发现自定义GeoJSON地图(` admin- &gt;设置- &gt;地图- &gt;自定义地图- &gt;添加地图`)支持和潜在本地文件包含(包括环境变量)的安全问题。URL在加载之前没有经过验证。此问题已在新的维护版本(0.40.5和1.40.5)及其后的任何后续版本中修复。如果您无法立即升级，您可以通过在反向代理或负载平衡器或WAF中包含规则来缓解这一问题，以便在应用之前提供验证过滤器。”</em></p><p id="397a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们意识到漏洞的来源是经过特别调整的<strong class="kf ir"> GeoJSON </strong>地图。因此，我们将使用的有效载荷将利用GeoJSON地图。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/ad23412f1f0c5ffc4435ed7921b4f34c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1266/0*ZhPiB7HENZWAWlxo"/></div></figure><p id="3a39" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有关该漏洞的更多信息，您可以查看<strong class="kf ir">‘相关资源’</strong>部分。</p><p id="bb6c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">进一步查看源代码，我发现了以下基于文件名或路径外部控制的有效负载类型:</p><p id="9702" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">/api/geojson？URL = file:/filename<br/>/API/geo JSON？URL = file:/etc/passwd<br/>/API/geo JSON？url=file:/etc/hosts</p><p id="ff7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这意味着我们可以访问服务器上的敏感文件，如etc/passwd。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/048a9f28734f481e2dd74c925a1b1740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/0*KknUzx4IkYBKX1D9"/></div></figure><p id="70a1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同时，您可以在<strong class="kf ir">‘严重性分数’</strong>部分了解分配给漏洞的<a class="ae kc" href="https://www.balbix.com/insights/understanding-cvss-scores/" rel="noopener ugc nofollow" target="_blank"> CVSS分数</a>以及<strong class="kf ir">‘弱点类型’</strong>部分了解漏洞的类别。</p><blockquote class="lk ll lm"><p id="0573" class="kd ke lh kf b kg kh ki kj kk kl km kn ln kp kq kr lo kt ku kv lp kx ky kz la ij bi translated"><strong class="kf ir">发现<strong class="kf ir"> CVE的脆弱目标</strong>-2021–41277</strong></p></blockquote><p id="f28e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Shodan是理想的搜索引擎。我就不说是什么了，因为你已经知道了。但是我将讨论如何使用Shodan返回更易受攻击的结果。</p><p id="2985" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，让我们尝试找到我们的目标元数据库服务器。对此，我们基本上可以从搜索关键词“元数据库”开始。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/4bd8d9125d3077af5905929c4025b58f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*H5e1GhmG9TWX-UKX"/></div></div></figure><p id="748b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总数:326。</p><p id="3003" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是Shodan能在全世界找到的所有元数据库服务器？当然不是！没人会相信。</p><p id="82ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以让我们稍微扩展一下我们的查询。让我们使用“Set-Cookie: metabase。设备”。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/5a3ea19f8792b7bbaf8baba4c306a882.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4i57cNOPgX0amynO"/></div></div></figure><p id="5a80" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">好多了。</p><p id="b588" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们仍然可以做得更多。我们用http . title:“Metabase”。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lg"><img src="../Images/cdfa4d17e41ccbe373cd92ee001c0f16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*X9LEqk3DSPglk7qA"/></div></div></figure><p id="faad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总共有<strong class="kf ir"> 16，852 </strong>个结果涉及元数据库服务器。这样好多了。</p><blockquote class="lk ll lm"><p id="744f" class="kd ke lh kf b kg kh ki kj kk kl km kn ln kp kq kr lo kt ku kv lp kx ky kz la ij bi translated"><strong class="kf ir">开发CVE-2021–41277</strong></p></blockquote><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/e3770893e17709404e767cbf322fbd73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/0*065EODbwe1wkFPbT"/></div></figure><p id="c501" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我决定回顾一下Shodan的一些结果。我在目标上测试了有效载荷，下面是我得到的一些结果。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/35c2c384c9c7e0ffb88d27a34c12dc91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/0*Tyy66hWrZ4NRgVwP"/></div></figure><p id="b6ee" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们想让事情自动化，因为在这种情况下会产生很多结果。我想为此编写一个工具，但它已经存在了。<a class="ae kc" href="https://github.com/tahtaciburak/CVE-2021-41277" rel="noopener ugc nofollow" target="_blank">该工具</a>检查您为CVE-2021–41277漏洞创建的服务器列表。有些工具可能不总是返回准确的结果，在某些情况下，我们可能会遇到假阳性(误导的结果)。您可以搜索“root:”来找到它。</p><blockquote class="lk ll lm"><p id="8fb2" class="kd ke lh kf b kg kh ki kj kk kl km kn ln kp kq kr lo kt ku kv lp kx ky kz la ij bi translated"><strong class="kf ir">为<strong class="kf ir">CVE-2021–41277</strong>固定</strong></p></blockquote><p id="01c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过白源漏洞数据库获得如何修复漏洞的信息。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/60815f64987c1cc33f271afe95fa8ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/0*1k6eflYX6cGryclk"/></div></figure><p id="020e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该修复基于升级。<a class="ae kc" href="https://github.com/metabase/metabase/security/advisories/GHSA-w73v-6p7p-fpfr" rel="noopener ugc nofollow" target="_blank">元数据库</a>将受影响的版本标记为x.40.0-x.40.4，将修补的版本标记为x.40.5、x.41。将您的元数据库版本升级到x.40.5或更高版本将修复漏洞。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/21ba5ca3dafa6233016037f32ae129b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6KkV62r9GR9pMvJ_"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated"><a class="ae kc" href="https://github.com/metabase/metabase/security/advisories/GHSA-w73v-6p7p-fpfr" rel="noopener ugc nofollow" target="_blank">来源</a></figcaption></figure><p id="d579" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在WhiteSource漏洞数据库提供的源中，我们可以看到元数据库的CVE-2021–41277的详细报告。</p><p id="b78f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望本教程对白源漏洞数据库的漏洞检测和防范机制进行了充分的描述。它简单直观。因此，请确保您亲自尝试一下，看看如何将它整合到您的开发过程中，使它变得更简单。</p><p id="a79f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目前就这些。感谢阅读。下次再见了！</p><p id="4a35" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你可以在推特上关注我:<a class="ae kc" href="https://twitter.com/canmustdie" rel="noopener ugc nofollow" target="_blank">https://twitter.com/canmustdie</a></p></div></div>    
</body>
</html>