<html>
<head>
<title>Exposing Millions of Voter ID card users’ details.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">暴露了数百万选民身份证用户的详细信息。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/exposing-millions-of-voter-id-card-users-details-8a993c9a5d35?source=collection_archive---------0-----------------------#2022-07-06">https://infosecwriteups.com/exposing-millions-of-voter-id-card-users-details-8a993c9a5d35?source=collection_archive---------0-----------------------#2022-07-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/52e5dad7a990e533ff6f3c08552eaaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ux1ZHBkg1R1Gfhjwe1U7fw.png"/></div></div></figure><p id="3784" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大家好。希望你一切都好。我是 <a class="ae kx" href="https://twitter.com/nxtexploit" rel="noopener ugc nofollow" target="_blank"> <em class="kw">阿齐兹</em> </a> <em class="kw">。通过这篇文章，我将分享我在官方选民身份证维护平台</em><a class="ae kx" href="https://nvsp.in" rel="noopener ugc nofollow" target="_blank"><em class="kw">http://nvsp . in</em></a><em class="kw">上发现的一些安全问题。我在为我妈妈的卡填写更正表格，我对在gov网站上寻找bug不太感兴趣:`)那时</em><a class="ae kx" href="https://portswigger.net/burp/documentation/desktop/penetration-testing" rel="noopener ugc nofollow" target="_blank"><em class="kw">burp suite</em></a><em class="kw">正在后台运行，我想让我们试一试。花了半个小时后，我发现了一些关键问题，我将与大家分享。政府已经解决了所有这些问题。</em></p><p id="bdba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在印度，<a class="ae kx" href="https://www.google.com/search?q=what+is+voter+ID+%28india%29" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">选民证</strong> </a>是由印度选举委员会颁发给年满18岁的印度户籍成年人的身份证件，主要作为印度公民在该国市政、邦和国家选举中投票时的身份证明。目前有超过7 . 8亿个选民id处于活跃状态。</p><h1 id="0383" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">第一个bug:伪造有效的选民id并提取细节(IDOR / BOLA)</h1><p id="6311" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">注册新帐户时，它显示两个选项“我有EPIC号码”和“我没有EPIC号码”。EPIC代表选民照片识别卡，EPIC号只是选民ID号。如果我们选择没有选民ID号，那么他们会在您在门户网站上注册后为您提供添加选项。注册后，我试图添加任何随机史诗编号与我的帐户，但它显示这是无效的。所以我发送了HTTP请求给打嗝的入侵者进行暴力攻击。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/37aba24a1fbeef2ce6ded0af05399ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SKG6_nhMm0PkRkRXJjK2yg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">发送对无效id的HTTP请求</figcaption></figure><p id="d697" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选民编号也称为EPIC number，是一个字母数字编号，由三个字母和七个数字组成，即<strong class="ka ir"> WRI </strong> 2345678、<strong class="ka ir"> RDH </strong> 2345678、<strong class="ka ir"> DTN </strong> 2345678、<strong class="ka ir"> YCV </strong> 2345678、<strong class="ka ir"> NLN </strong> 2345678、<strong class="ka ir"> XMB </strong> 234567这三个字母不是随机的字母，你可以找到开头三个字母相似的id，但是剩下的七个数字是不同的。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/3cde6bfc335c6599038dd4f7f6f41cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oCiejaOMRmwdEpIRzi27PQ.png"/></div></div></figure><p id="4973" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在“Epic_no=”参数上添加了这些七位数的有效载荷位置，即“Epic_no=WRI$2345678$”(正如你在下面的截图中看到的。)</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/127e9f27aadb57e96af3621df6602204.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xz61EAZwEhSWlsDpMkJSSw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">添加有效负载位置</figcaption></figure><p id="d338" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">令人惊讶的是，在后端没有实现任何限制，我能够发送<strong class="ka ir">个无限制的请求</strong>而不会被防火墙阻止。结果，后端服务器对每个有效的投票人id响应302重定向。(如下图截图所示)</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/7caa0bc893f70c7f8086f87595dd86e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dLe_eyFiPf9amQz0o50meQ.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">对每个有效的投票人id进行响应302</figcaption></figure><p id="dbc4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我写了一个<a class="ae kx" href="https://github.com/nxtexploit/Voter-ID-bruteforcer/blob/main/Voter-ID-bruteforcer.py" rel="noopener ugc nofollow" target="_blank"> python脚本</a>，它将暴力破解这些值，并为我输出所有有效的voter _ IDs。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/314c2d3f522ed5fb4703974736efef6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/1*DA8ghQIWnJlNZty0OK6oEA.gif"/></div></figure><figure class="mc md me mf gt jr"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="1453" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我有了随机人的有效选民id，我把这些id和我的个人资料一起添加到“<a class="ae kx" href="https://www.nvsp.in/Account/MyProfile" rel="noopener ugc nofollow" target="_blank">/账户/我的个人资料</a>”下。然后在“/ <a class="ae kx" href="https://www.nvsp.in/Forms" rel="noopener ugc nofollow" target="_blank"> forms </a> /”部分下有一个选项是<strong class="ka ir"> form001 </strong>，这个表单已经填写了<strong class="ka ir">姓名、父亲姓名、地址、出生日期等。</strong>根据添加到我的个人资料中的有效EPIC ID。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/12f56619e33b68cd93c068d4081d9d32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6izoRB4cWjN5zjdZTDYdJg.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated"><strong class="bd la">提取随机人物的详细信息</strong></figcaption></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="de7f" class="ky kz iq bd la lb my ld le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv bi translated"><strong class="ak">第二个错误:账户接管(OTP旁路)</strong></h1><p id="0b2b" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在个人资料详细信息更新部分，我试图添加另一个用户的号码。所以我为它创建了另一个帐户。但是那里植入了一个OTP，我尝试过暴力破解但是没有成功:(我记得去年看过一篇<a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/how-i-hacked-into-indias-top-matrimonial-website-and-earned-amazon-gift-card-worth-10k-inr-2a0b376219fa">文章</a>，你可以在这里 看<a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/how-i-hacked-into-indias-top-matrimonial-website-and-earned-amazon-gift-card-worth-10k-inr-2a0b376219fa"> <strong class="ka ir">它，这里作者只是截取了请求后加了0。我在这里对OTP参数做了同样的事情，它工作了:)</strong></a></p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/71a18bc1b6d242f6dee331390516abe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q0TSMqdgsXTtzROWDo6y9g.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">在OTP验证时拦截流量</figcaption></figure><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/8e6a95fc86db7604b40a6e6e89990bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eEVjGxhUUzdbv2vkHlExnw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated"><a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/how-i-hacked-into-indias-top-matrimonial-website-and-earned-amazon-gift-card-worth-10k-inr-2a0b376219fa">将OTP值更改为零</a></figcaption></figure><p id="0b98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">绕过后，我以为它只是可以注册受害者的号码，然后我会重置密码，但令人惊讶的是，在取代受害者的号码，我的个人资料数据自动改变与受害者的细节，我可以拥有他的帐户。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/452706f6f4df5e7148826baa4e81cebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*az1-jwdyMLK1pOLWbA6ghA.png"/></div></div></figure></div><div class="ab cl mr ms hu mt" role="separator"><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw mx"/><span class="mu bw bk mv mw"/></div><div class="ij ik il im in"><h1 id="c9c8" class="ky kz iq bd la lb my ld le lf mz lh li lj na ll lm ln nb lp lq lr nc lt lu lv bi translated">第三个错误:永久删除/移除任何随机用户的选民身份证(逻辑缺陷)</h1><p id="deba" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">从第一个错误，我们可以获得并添加任何随机用户的选民ID到我们的帐户，从主页上有一个“删除注册”的选项。攻击者在他的个人资料部分添加任何随机的投票人ID后，什么都不需要。然后，他可以轻松地永久删除任何随机用户的选民ID。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/1ea56c57aeb98af5faf0d11a9ca7a0a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SvvI8ZoSelvF3-83BzQRTw.png"/></div></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk translated">攻击者可以永久删除任何随机用户的卡</figcaption></figure><p id="ea7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我向vdisclose@cert-in.org.in汇报了这三个问题，他们解决了这些问题。</p><p id="8e92" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你喜欢这篇文章，如果你有任何问题，那么你可以在推特上给我发消息:【https://twitter.com/nxtexploit<a class="ae kx" href="https://twitter.com/nxtexploit" rel="noopener ugc nofollow" target="_blank"/></p><p id="6a14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢阅读，</p></div></div>    
</body>
</html>