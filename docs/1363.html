<html>
<head>
<title>Exploiting the vulnerability in NASA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用美国宇航局的漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/about-the-existing-vulnerability-in-nasa-d4451a106fc0?source=collection_archive---------0-----------------------#2021-06-05">https://infosecwriteups.com/about-the-existing-vulnerability-in-nasa-d4451a106fc0?source=collection_archive---------0-----------------------#2021-06-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aa7b06db875c8589a860e1a961ecacac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WN6T2PokaVGayjFcZt92Kg.jpeg"/></div></div></figure><p id="7637" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个标题可能会让你有点困惑，因为我知道，你不会期待<strong class="ka ir"> NASA </strong>。但是我保证，如果你跟着我，没有跳过一行，我会让我的观点完美😉。如果你理解其中的逻辑，你就可以忘掉那些神话。这个概念很简单，没有人能够净化数百万行没有漏洞的代码，即使他们是技术大师，因为他们是人类😊。首先，<strong class="ka ir">我不是在引向一条非法的道路&amp;这篇文章背后的意图是证明一切都是脆弱的</strong>在大多数情况下，我们并没有意识到这一点。所以让我们开始吧，</p><p id="8d35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不到一个月，我只是出于好奇进入了NASA的领域&amp;结果，我发现了一个子域。jpl，希望挺有名的。走进去是我经典的一步，我成功地发现。阿维里斯在。jpl域。所以我更接近了。通过查看源代码，我找到了另一个方向。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kw"><img src="../Images/40904e1ded90ab0febbd4bc8843596ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f0JRoutM_BbFP8C_LV9l3Q.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">新目录(alt_locator)</figcaption></figure><blockquote class="lf"><p id="0596" class="lg lh iq bd li lj lk ll lm ln lo kv dk translated">locator意味着一个地方在地球上的绝对位置。这些信息足以生成自定义单词列表，对吗？？</p></blockquote><p id="bf4b" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">“<strong class="ka ir"> alt_locator </strong>在我脑海中闪现，于是我开始蛮力&amp;我的单词列表点击&amp;响应是200 for / <strong class="ka ir"> alt_gulf </strong>。(<strong class="ka ir"> OK </strong>成功状态<strong class="ka ir">响应</strong>代码表示请求已成功)</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/2194e61e9c71e50932969683d12562ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YiwRjcsLEYQT4AZqXwnChg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">空白页</figcaption></figure><p id="c3f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这一页是空白的，但我不准备退出。我以前有很多经验，我完全知道以后该做什么。通过阅读源代码我找到了一个链接，那是另一个目录:<strong class="ka ir">/gulfoilspip _ adv . html</strong></p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/8dcbc0e12cf85c61e8abaa099dee5376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*64ki_iESKrpFLTQGHNcmtw.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">/gulfoilspip _ adv . html</figcaption></figure><p id="ea3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种情况更糟，但很有趣，我访问了那个页面&amp;它似乎被分区了。左侧显示<strong class="ka ir">警告、年月、像素大小图像显示</strong>、<strong class="ka ir"> bla bla bla。</strong>另一端显示“<strong class="ka ir">未发现</strong>错误”。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/9a632ef34481844de4a2557fa46803df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PUxMLyf8snWd8HD1fFr0TA.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">!!!!!!!!</figcaption></figure><p id="d87e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在检查页面源代码时，我发现了另一个有趣的参数。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/fdcad65d219627d924598ce116ad8685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lH3jEryaUbyN7i4_EsF37Q.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">重要的</figcaption></figure><blockquote class="lx ly lz"><p id="7a60" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir"> filter_viz，fn_contains，spatial，ul_lat，ul_lon </strong>等。</p></blockquote><p id="f893" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，我点击了按钮“<strong class="ka ir">图像</strong>”(左侧)，然后，另一个错误出现在右侧。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/1e96419c7a150af7db1905f8cbbab8b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8s3xm7xVU7YZI-BoXem8wg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated"><strong class="bd me">警告</strong>:第<strong class="bd me"> 54 </strong>行<strong class="bd me">/websites/aviris/www/alt _ gulf/gulf _ fusion _ table _ image . PHP</strong>中非法字符串偏移量‘FileSize _ b’</figcaption></figure><blockquote class="lx ly lz"><p id="4ad7" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir">警告</strong>:在<strong class="ka ir">/websites/avi ris/www/alt _ gulf/gulf _ fusion _ table _ image . PHP</strong>的第<strong class="ka ir"> 49 </strong>行有非法的字符串偏移量‘Name’</p><p id="c94e" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir">警告</strong>:在<strong class="ka ir">/websites/aviris/www/alt _ gulf/gulf _ fusion _ table _ image . PHP</strong>的第<strong class="ka ir"> 53 </strong>行有非法的字符串偏移量‘FileSize _ Gb’</p><p id="feee" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir">警告</strong>:第<strong class="ka ir"> 54 </strong>行<strong class="ka ir">/websites/aviris/www/alt _ gulf/gulf _ fusion _ table _ image . PHP</strong>中非法字符串偏移量‘FileSize _ b’</p><p id="c626" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir">警告</strong>:第<strong class="ka ir"> 55 </strong>行<strong class="ka ir">/websites/avi ris/www/alt _ gulf/gulf _ fusion _ table _ image . PHP</strong>中的字符串偏移量‘Name’非法</p></blockquote><p id="2ef9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看完错误之后，我想我得换个地方了😂。</p><p id="82f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在访问了目录<strong class="ka ir">gulf _ fusion _ table _ image . PHP</strong>后，我的脑海里嘀咕着之前找到的那个参数。现在是渗透的时候了😌😌。在几分钟的响应检查之后，我组合了参数filter_viz和fn_contains。输入的内容对页面本身是可见的</p><blockquote class="lx ly lz"><p id="45a8" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated">唯一的条件是:</p><p id="9c53" class="jy jz ma ka b kb kc kd ke kf kg kh ki mb kk kl km mc ko kp kq md ks kt ku kv ij bi translated"><strong class="ka ir"> filter_viz=2 </strong>(其他数字不起作用)<strong class="ka ir">fn _ contains = " your INPUT "</strong>的值。</p></blockquote><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/7d502c36bde05709cec2f2985dd8063f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vlLGk4ogQKybuw_mepG0BQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">例子</figcaption></figure><p id="6704" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我用“呵呵”作为输入值&amp;它成功了。！！现在是招牌动作的时候了→利用脆弱点。标签定义了一个超链接，用来从一个页面链接到另一个页面。我成功地注入了&amp; link的目的地是我的介质配置文件(下面给出了POC)。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/9fc82714023bd1453bae566f7ec87914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Dya0M2r-ROAOn-JM2nB52Q.gif"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">成功注入</figcaption></figure><p id="b426" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这之后，我也尝试了XSS &amp;在同一点注射，结果如下所示:)</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/23dab0b26140a8104cf7f28d6dddd87b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*th-l8zhm448QZ1gwQqSGzw.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">反映成功</figcaption></figure><h1 id="2e21" class="mj mk iq bd me ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf bi translated">嘣…！！！预期的目标完成了。</h1><p id="da01" class="pw-post-body-paragraph jy jz iq ka b kb ng kd ke kf nh kh ki kj ni kl km kn nj kp kq kr nk kt ku kv ij bi translated">你可以看看我上传到youtube (POC)的视频</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="nl nm l"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">无线一键通</figcaption></figure></div><div class="ab cl nn no hu np" role="separator"><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns nt"/><span class="nq bw bk nr ns"/></div><div class="ij ik il im in"><blockquote class="lf"><p id="468d" class="lg lh iq bd li lj nu nv nw nx ny kv dk translated"><strong class="ak"> <em class="nz">随时在推特上连接</em> </strong> <a class="ae oa" href="https://twitter.com/7h3h4ckv157" rel="noopener ugc nofollow" target="_blank"> @7h3h4ckv157 </a></p></blockquote><figure class="oc od oe of og jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/63c07a2717a9dd23c6cb7136a028aa60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/1*NMu_z5f4s01kqRULW_izPw.gif"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">阿雅..！</figcaption></figure></div></div>    
</body>
</html>