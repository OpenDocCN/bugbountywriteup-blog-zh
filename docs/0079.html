<html>
<head>
<title>Bypassing Captcha Like a Boss</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">像老板一样绕过验证码</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bypassing-captcha-like-a-boss-d0edcc3a1c1?source=collection_archive---------0-----------------------#2018-04-16">https://infosecwriteups.com/bypassing-captcha-like-a-boss-d0edcc3a1c1?source=collection_archive---------0-----------------------#2018-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b2d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">猎人们，你们好！距离我上次写文章已经有一段时间了，所以我决定分享一下我在一个私人项目上的有趣经历。</p><p id="663f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">验证码是什么鬼东西？</strong></p><p id="59d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从我的角度来看:验证码解决方案主要用于避免机器人，并确保应用程序背后的用户是一个真正的人。</p><blockquote class="kl km kn"><p id="050f" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">分享是关怀，所以我们去向上写吧！</p></blockquote><p id="a953" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在映射应用程序时，我发现了一个带有验证码过滤器的订阅端点，如下所示:</p><p id="f7ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【http://example.com/captcha/captchaCheck? T2】号</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/124854c3b04d857ad30861265dd61ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*VMGx6FHcJbwEhTCQPjRIfA.png"/></div></figure><p id="5b7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这很快吸引了我的注意力，所以我转到了src页面:</p><blockquote class="kl km kn"><p id="3ad6" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><form action="”/captcha/captchaCheck”" method="”post”"> <br/> &lt;输入name = "<strong class="jp ir">hash</strong>"<strong class="jp ir">value = "</strong>09573 e 52 f 752 F3 F5 e 6250 b 62 aa 34 b 8 a 8 c 08 a 4d 22<strong class="jp ir">"</strong>type = " hidden "&gt;<br/>&lt;输入name = " email address " value = "<a class="ae ks" href="mailto:victim12232@test.com" rel="noopener ugc nofollow" target="_blank">t</a>est @ email . com " type = " hidden "&gt;<br/>&lt;输入name</form></p></blockquote><p id="be47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你看这个表格，你会发现有两个有趣的参数:</p><blockquote class="kl km kn"><p id="e79b" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">“<strong class="jp ir">哈希</strong>”(加密哈希)和“<strong class="jp ir">输入值</strong>”(验证码的数值)</p></blockquote><p id="4e86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我填写了验证码并发送了表单:</p><p id="1560" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，我需要实现这个验证码的行为/功能，所以:</p><p id="858c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我发现了这个:</p><blockquote class="lb"><p id="e49a" class="lc ld iq bd le lf lg lh li lj lk kk dk translated">如果“哈希”==“输入的值”，则接受请求</p><p id="e4b8" class="lc ld iq bd le lf lg lh li lj lk kk dk translated">如果“哈希”！= "输入值",则请求被阻止</p></blockquote><p id="e326" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">很好，所以..很简单:如果参数匹配:请求被接受..现在复杂的事情是:散列可以被解密？接受挑战！</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/ef38adefc61cfa4e9b54788efa3d7db1.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*xDSDlQnB7VjnnqKBNzpQgw.png"/></div></figure><p id="f4e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在我的终端中粘贴散列，并尝试用<a class="ae ks" href="https://github.com/k4m4/dcipher" rel="noopener ugc nofollow" target="_blank">“dcipher”</a>解密:</p><p id="0e3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(使用在线彩虹表[hash toolkit，GromWeb，MD5Hashing] &amp;查找表攻击服务解密哈希。)</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/30f077eafe04970bbec84c57f6930d35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rOHil-Of4Gg3VnN8_YtpHw.png"/></div></div></figure><p id="3c52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不错！解密:OK！如果您注意到6位数等于下面的验证码图片:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/d915c5256221a4403a84c15dd3dc0b3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:468/format:webp/1*-MCqZNdimE84BiWRpmUtVg.png"/></div></figure><p id="889f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，好了，现在我们已经有了所有的部分:所以..让我们创造一个机器人！</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/5b7d5952fb583226871234e93d4f1d4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1124/format:webp/1*2SzVdpdcWY8M75U2SloXYQ.png"/></div></figure><p id="8c9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用python创建了一个用于PoC目的的bot，以展示攻击者如何轻松绕过这种captcha行为并滥用其功能:</p><blockquote class="lb"><p id="a3fb" class="lc ld iq bd le lf lg lh li lj lk kk dk translated">1)首先，机器人向订阅页面发送带有验证码-&gt;<a class="ae ks" href="https://company.com/captcha/form/?" rel="noopener ugc nofollow" target="_blank">https://company.com/captcha/form/?</a><br/>的请求2)机器人抓取页面并检索“散列”值参数。<br/> 3) Bot解密哈希(dcipher) <br/> 4)利用解密值，Bot向<a class="ae ks" href="http://company.com//captcha/captchaCheck" rel="noopener ugc nofollow" target="_blank">http://company.com//captcha/captchaCheck</a>创建POST请求，并自动用随机值(电子邮件、姓名、IP地址等)填充所有用户表单所需的参数<br/> 5) Bot发送POST请求并绕过验证码</p></blockquote><figure class="ly lz ma mb mc ky"><div class="bz fp l di"><div class="md me l"/></div></figure><p id="294f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个机器人非常简单，但工作起来很有魅力..因此，我将此概念证明发送给了该计划，并附上了以下解释:</p><blockquote class="kl km kn"><p id="1856" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">安全影响</strong></p><p id="0cd5" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">攻击者可以创建一个机器人来绕过验证码，并自动执行任务，向多个URL或带有随机/虚假用户、电子邮件、IP地址的列表发送无限制的请求..出于垃圾邮件或邪恶目的(收集数据、分析流量行为等)</p></blockquote><p id="462d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(这个程序的反应真的很快！<strong class="jp ir"> &lt; 1h ) </strong></p><blockquote class="kl km kn"><p id="62bf" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">时间线</strong></p><p id="fead" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">已提交世界协调时2018–04–16 03:51:17</strong></p><p id="eafd" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">团队反应与伤检分类和奖金2018–04–16 04:48:17 UTC</strong></p><p id="360e" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated"><strong class="jp ir">(赏金$ xxx) </strong></p></blockquote><p id="26b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以ak1t4是幸福的！</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/3a13b3763dfea47afa55a9f4f220a3cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:640/1*HO1_FO3I7Np0GzIzBJIIkQ.gif"/></div></figure><blockquote class="lb"><p id="abe0" class="lc ld iq bd le lf mg mh mi mj mk kk dk translated">我希望你喜欢这篇文章，就像我喜欢写它一样！</p><p id="f569" class="lc ld iq bd le lf lg lh li lj lk kk dk translated">记住:如果你失败了？再努力点！</p><p id="7f40" class="lc ld iq bd le lf lg lh li lj lk kk dk translated">狩猎愉快！</p></blockquote><div class="ly lz ma mb mc ml"><a href="https://twitter.com/knowledge_2014" rel="noopener  ugc nofollow" target="_blank"><div class="mm ab fo"><div class="mn ab mo cl cj mp"><h2 class="bd ir gy z fp mq fr fs mr fu fw ip bi translated">ak1t4 z3n 🇦🇷 (@knowledge_2014) |推特</h2><div class="ms l"><h3 class="bd b gy z fp mq fr fs mr fu fw dk translated">ak1t4 z3n 🇦🇷的最新推文(@knowledge_2014)。Bug赏金猎人——HoF:谷歌——Mozilla——PayPal……</h3></div><div class="mt l"><p class="bd b dl z fp mq fr fs mr fu fw dk translated">twitter.com</p></div></div><div class="mu l"><div class="mv l mw mx my mu mz kz ml"/></div></div></a></div></div></div>    
</body>
</html>