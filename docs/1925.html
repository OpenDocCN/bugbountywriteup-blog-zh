<html>
<head>
<title>Some critical vulnerabilities found with passive analysis on bug bounty programs explained</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释了被动分析bug赏金程序时发现的一些关键漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/some-critical-vulnerabilities-found-with-passive-analysis-on-bug-bounty-programs-explained-1da8b01c11ad?source=collection_archive---------0-----------------------#2022-03-07">https://infosecwriteups.com/some-critical-vulnerabilities-found-with-passive-analysis-on-bug-bounty-programs-explained-1da8b01c11ad?source=collection_archive---------0-----------------------#2022-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="74f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章描述了我在bug bounty程序中发现的三个漏洞，以及如何发现漏洞和执行步骤的概述。这篇文章的主要目的是展示如何在不触及公司资产或篡改请求的情况下找到关键/高漏洞。希望你喜欢，找到有用的东西！</p><h2 id="f6fb" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">报告:</h2><ol class=""><li id="80de" class="le lf iq jp b jq lg ju lh jy li kc lj kg lk kk ll lm ln lo bi translated">包含企业帐户邀请URL的公开端点允许攻击者作为员工加入公司。</li><li id="2dfa" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">由于联系人页面上映射了一个未使用的日历，因此能够向[redacted]主张日历第三方服务的所有权，这导致与支持团队一起管理预定的客户呼叫。</li><li id="e370" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">通过Shodan分析发现，公共[编辑的]公司IP上的源代码泄漏和敏感信息泄露带有一个不常见的开放端口。</li></ol><h1 id="a9a6" class="lu km iq bd kn lv lw lx kq ly lz ma kt mb mc md kw me mf mg kz mh mi mj lc mk bi translated"><strong class="ak">描述:</strong></h1><h2 id="68b9" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">1.包含企业帐户邀请URL的公开端点允许作为员工加入公司。</h2><p id="2954" class="pw-post-body-paragraph jn jo iq jp b jq lg js jt ju lh jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">在OSINT分析期间，我首先采取的步骤之一是检索第三方抓取的目标端点和URL，这可以通过开源工具完成，如<a class="ae mo" href="https://github.com/lc/gau" rel="noopener ugc nofollow" target="_blank"> gau </a>和下面的命令:</p><p id="de78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">target.com印刷厂| gau</p><p id="ee0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我开始从输出中手动分析端点和URL，特别注意一些敏感的关键字:</p><blockquote class="mp mq mr"><p id="8600" class="jn jo ms jp b jq jr js jt ju jv jw jx mt jz ka kb mu kd ke kf mv kh ki kj kk ij bi translated">发票、折扣、促销代码、重定向、重置密码、重置密码、密码、跟踪订单、令牌、邀请</p></blockquote><p id="dcf3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这一个，<code class="fe mw mx my mz b">invite</code>关键字突然将我的注意力吸引到目标的端点上:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi na"><img src="../Images/f16b2ac9aca6c2ec4378bcfb220f432e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WKx-XOHXDuruaYiyPKIOKg.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">gau工具的输出结果</figcaption></figure><p id="1591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我只是点击了这个可疑的网址，它把我带到了一个<strong class="jp ir">注册页面</strong>，在用个人电子邮件(<strong class="jp ir"> @gmail.com </strong>)创建了一个新帐户之后，我就被重定向到了目标应用程序中的公司页面，其中包含了<strong class="jp ir">所有被邀请的员工以及敏感信息</strong>:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nq"><img src="../Images/4086840935dc856b18aaf03600733ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KXRT0XpBzqfII7p6AGLrQw.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">引导我访问公司团队的注册页面</figcaption></figure><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi nr"><img src="../Images/89ab18c48bd3a4fb59830894ba38a6e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kxiluYeA-GXr_esXC7tQQA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">来自员工的PII信息</figcaption></figure><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi ns"><img src="../Images/903403ee2b23f918563dee9ebe2e073f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hknvff8dA_jx1G8ELwnWCA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">来自公司的敏感数据</figcaption></figure><p id="7183" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">影响:</strong></p><p id="a17a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何用户都可以使用映射在不同爬虫上的URL在目标应用服务上注册为员工，这将向攻击者泄露PII和关于公司的敏感信息。</p><p id="7a18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">已采取措施发现此漏洞:</strong></p><ol class=""><li id="fd70" class="le lf iq jp b jq jr ju jv jy nt kc nu kg nv kk ll lm ln lo bi translated">使用开源工具(subfinder、amass……)搜索范围内所有可用的公司资产</li><li id="7a4e" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">使用gau工具从发现的域中检索URL和端点列表</li><li id="d7ef" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">搜索包含敏感关键词的结果，在本例中是“invite”<code class="fe mw mx my mz b">grep -r "invite"</code></li><li id="eb29" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">手动访问网址以查看其内容，并按照页面说明进行操作，这使我注册成为受影响的目标应用程序下注册的许多不同公司的员工。</li></ol></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><h2 id="80f1" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated"><strong class="ak"> 2。</strong>由于联系人页面上映射了一个未使用的日历，能够向[redacted]主张日历第三方服务的所有权，这导致管理与支持团队的预定客户通话。</h2><p id="045a" class="pw-post-body-paragraph jn jo iq jp b jq lg js jt ju lh jw jx jy ml ka kb kc mm ke kf kg mn ki kj kk ij bi translated">在第一次访问目标时，我通常喜欢在攻击它之前分析应用程序的整体结构。在与不同页面互动了大约5分钟后，我点击了一个<strong class="jp ir">联系人</strong> <strong class="jp ir">页面</strong>左下方的日历图标，它最终打开了一个空白页，上面有一个来自<a class="ae mo" href="https://calendly.com/" rel="noopener ugc nofollow" target="_blank"> Calendly的</a>服务的错误:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi od"><img src="../Images/45e64ede6870d5feb3181680503146b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMjort577onG3WTrxsLXLQ.png"/></div></div></figure><p id="ae48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过检查页面，我能够看到一个<strong class="jp ir"> GET </strong>对<code class="fe mw mx my mz b">target-v2/call</code>的请求，该请求是来自第三方服务calendarily的<strong class="jp ir">注册日历名称。我立即在那里注册了一个新帐户，创建了一个新日历，然后它要求我提供一个唯一的名称，该名称将附加到URL上，因此我自动想到了接管攻击。</strong></p><p id="8c81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我提供了<code class="fe mw mx my mz b">target-v2</code>作为日历的名称，继续创建，然后砰！</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oe"><img src="../Images/f2d8b324001c205c0a8d776a28b8846b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40t7vu4MuI4WaaELJ8jLWw.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk translated">目标联系人页面上的日历服务接管</figcaption></figure><p id="923e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我新创建的日历显示在目标域的联系人页面上，因此如果任何人安排了与支持团队的通话，他们实际上会安排与我(攻击者)的通话。</p><p id="644a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">影响:</strong></p><p id="4859" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何用户都可以接管用于为目标公司安排支持呼叫的第三方服务日历，这使得攻击者能够轻松执行网络钓鱼攻击，并管理目标客户的所有计划呼叫。</p><p id="12c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">发现此漏洞的步骤:</strong></p><ol class=""><li id="fc1e" class="le lf iq jp b jq jr ju jv jy nt kc nu kg nv kk ll lm ln lo bi translated">首先，我以普通用户的身份手动分析了应用程序的功能和页面</li><li id="c0c8" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">然后我在联系人页面上发现了一个第三方集成的应用程序作为日程安排日历(Calendly service)</li><li id="1c97" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">最后，我想到了从这个平台接管日历的可能性。为此，我注册了一个新账户，研究了日历的创建，然后我将目标应用程序使用的名称注册为我的新日历。</li><li id="d070" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">我的日历立即链接到目标应用程序的联系页面，然后与目标支持团队的预定呼叫现在完全由我(攻击者)管理。</li></ol></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="78eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。通过Shodan分析发现，公共[修订] IP上的源代码泄漏和敏感信息泄露带有一个不常见的开放端口。</strong></p><p id="42c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一个是在对目标应用程序进行手动Shodan分析时发现的。我从下面的呆子开始，只是为了获取更多关于目标的信息:</p><p id="bc99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ssl:目标网站</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi of"><img src="../Images/935b01d5d704716c79cde5bee3d8c8d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wgNKbh2qJC5DfTsTE_Q4ow.png"/></div></div></figure><p id="0311" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并通过访问“查看报告”选项来手动查找不常见的开放端口。突然，有一台主机的端口“9869”打开了，我立即试图访问它，它将我带到一个受密码保护的页面，以便访问该页面的内容:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div class="gh gi og"><img src="../Images/8b13542212268d51473685306b130947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1394/format:webp/1*eA525qABNc0OzF-yGnQY9g.png"/></div></figure><p id="50f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我使用<a class="ae mo" href="https://github.com/ffuf/ffuf" rel="noopener ugc nofollow" target="_blank"> ffuf </a>工具进行了一次暴力攻击来查找目录和端点，结果很好:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oh"><img src="../Images/29a35bc4e916a201ef288f8c9d9c1dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*klsmMR8Z9Mzx80irJY8kFw.png"/></div></div></figure><p id="4cc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在获得对<code class="fe mw mx my mz b">share</code>端点的响应后，我访问它，从那里可以访问目录列表中公司项目的源代码:</p><figure class="nb nc nd ne gt nf gh gi paragraph-image"><div role="button" tabindex="0" class="ng nh di ni bf nj"><div class="gh gi oi"><img src="../Images/a707fc028e87d79c2ad0efbac68d1992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NIt7accgjtneHpH1_vNWyQ.png"/></div></div></figure><p id="a070" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">冲击</strong>:</p><p id="cd09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络上的任何用户都可以发现这项服务暴露了敏感的公司文件，如项目数据和源代码。</p><p id="c0fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">发现此漏洞的步骤:</strong></p><ol class=""><li id="0471" class="le lf iq jp b jq jr ju jv jy nt kc nu kg nv kk ll lm ln lo bi translated">从一个简单的Shodan dork开始，过滤所有匹配公司SSL证书名称的域</li><li id="64ba" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">手动搜索不常用的开放端口</li><li id="c202" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">访问它们，有一个主机引导我到一个有密码保护的页面(非常可疑)</li><li id="207f" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">使用ffuf工具发现可能隐藏的端点/目录以绕过密码页面，并找到了一个，开始了强力攻击</li><li id="9eca" class="le lf iq jp b jq lp ju lq jy lr kc ls kg lt kk ll lm ln lo bi translated">访问端点<code class="fe mw mx my mz b">share</code>，敏感文件在那里。</li></ol><p id="bfb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">外卖:</strong></p><p id="a9f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总是使用尽可能多的工具/研究/工具对目标应用进行被动分析，实际上在github、bb tips等网站上有很多。我学到的一件事是，公司越大，你得到的结果就越多，当然，你找到关键漏洞的机会也就越多，比如本文中的那些。</p><p id="6f18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">丹尼尔_v</p><p id="9ea2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仇杀队</p><p id="ed61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mo" href="https://twitter.com/d4niel_v" rel="noopener ugc nofollow" target="_blank">推特</a> | <a class="ae mo" href="https://bugcrowd.com/daniel_v" rel="noopener ugc nofollow" target="_blank"> BugCrowd简介</a> | <a class="ae mo" href="https://hackerone.com/daniel_v" rel="noopener ugc nofollow" target="_blank"> H1简介</a> | <a class="ae mo" href="https://www.linkedin.com/in/daniel-morais-968463120/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a></p></div><div class="ab cl nw nx hu ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ij ik il im in"><p id="cb01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Infosec Writeups团队刚刚完成了我们的第一次虚拟网络安全会议和网络活动。我们有16位出色的演讲者，他们主持了非常有价值和鼓舞人心的会议。要查看发言人和主题列表，并终身获得所有16场演讲的录音版本，<a class="ae mo" href="https://iwcon.live." rel="noopener ugc nofollow" target="_blank">单击此处。</a></p><div class="oj ok gp gr ol om"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd ir gy z fp or fr fs os fu fw ip bi translated">IWCon2022 — Infosec书面报告虚拟会议</h2><div class="ot l"><h3 class="bd b gy z fp or fr fs os fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="ou l"><p class="bd b dl z fp or fr fs os fu fw dk translated">iwcon.live</p></div></div><div class="ov l"><div class="ow l ox oy oz ov pa nk om"/></div></div></a></div></div></div>    
</body>
</html>