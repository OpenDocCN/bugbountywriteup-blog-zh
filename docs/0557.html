<html>
<head>
<title>Broken Authentication in Mobile Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">移动应用中的不可靠认证</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/broken-authentication-in-mobile-application-9f470513a4ab?source=collection_archive---------0-----------------------#2020-04-16">https://infosecwriteups.com/broken-authentication-in-mobile-application-9f470513a4ab?source=collection_archive---------0-----------------------#2020-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6408" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几个月前，我有一个移动应用程序的渗透测试项目。我发现了一个有趣的漏洞，使我能够危害他们系统中的任何帐户。我在应用程序和互联网之间建立了代理，这样我就可以在Burp套件中拦截请求和响应:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d9328d7cc35c42a337ad0a37e3cc239e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HpJzuydvL9a5KjNqj77iw.png"/></div></div></figure><p id="b270" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我浏览了密码重置部分，流程图如下图所示:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kx"><img src="../Images/3532502f4f0162ec817714a350b36a6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mcu-UscDIrB_u_E12m_rrw.png"/></div></div></figure><ol class=""><li id="5069" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">用户键入电子邮件地址并按回车键</li><li id="0969" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">后端确保电子邮件地址存在</li><li id="865c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">后端生成一个唯一的令牌，并将其保存在数据库中</li><li id="062c" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">后端将令牌发送到用户输入的电子邮件地址</li><li id="7b16" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">用户点击重置密码链接，后端验证令牌，如果是真的，就会显示HTML表单</li><li id="b129" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">用户填写密码字段，新密码和令牌被发送到服务器</li><li id="d199" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">后端验证令牌，然后更改密码</li></ol><p id="85ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第四部分提出的漏洞，其中后端向用户显示了重置密码令牌:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lm"><img src="../Images/ed8b69da59fc5bde9789a87a83b6cb85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCUbgzqKVfh0eEVpgKF9IQ.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ln"><img src="../Images/80862a9c69b1147ac10b08236f4f2887.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zPi7qfrlAOuOCKlEmmdmNw.png"/></div></div></figure><p id="e702" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，通过知道令牌，任何帐户的密码更改只有通过知道帐户的电子邮件地址才是可能的。到目前为止，我在bug bounty程序中看到过这种类型的缺陷。这里有一个优步10k的例子:</p><div class="lo lp gp gr lq lr"><a href="https://hackerone.com/reports/173551" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">优步在HackerOne上披露:允许密码重置令牌泄露…</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">一个有效的优步帐户的电子邮件地址，有可能接管该帐户，因为重置令牌是…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">hackerone.com</p></div></div><div class="ma l"><div class="mb l mc md me ma mf kv lr"/></div></div></a></div><p id="432d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">详细信息:</p><div class="lo lp gp gr lq lr"><a href="https://securityaffairs.co/wordpress/59210/hacking/uber-improper-authentication.html" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">优步存在一个严重的不正确身份验证漏洞，使得任何帐户都可以重置密码</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">意大利安全专家Vincenzo C. Aka @Procode701在7个月前发现了UBER中的一个严重漏洞…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">securityaffairs.co</p></div></div><div class="ma l"><div class="mg l mc md me ma mf kv lr"/></div></div></a></div></div></div>    
</body>
</html>