<html>
<head>
<title>Academy: HackTheBox walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学院:黑客盒子演练</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/academy-hackthebox-walkthrough-9102c5d79dee?source=collection_archive---------0-----------------------#2021-01-06">https://infosecwriteups.com/academy-hackthebox-walkthrough-9102c5d79dee?source=collection_archive---------0-----------------------#2021-01-06</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="8ff4" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">描述</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/6b69bde9c682359c9df2b42c1d029fee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ORmH_596oXLK_KKCbuO-Dg.jpeg"/></div></div></figure><p id="e964" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">另一个来自<a class="ae lq" href="https://app.hackthebox.eu/machines/297" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">的易VM如他们所说的HackTheBox </strong> </a>。我在解决这个问题时吃了点苦头，并认为它有点难，但我学到了一些新东西。全拜<a class="ae lq" href="https://app.hackthebox.eu/users/1190" rel="noopener ugc nofollow" target="_blank"><em class="lr">egre 55</em></a>&amp;&amp;<a class="ae lq" href="https://app.hackthebox.eu/users/2984" rel="noopener ugc nofollow" target="_blank"><em class="lr">mrb3n</em></a>所赐。像往常一样，在/etc/hosts文件中添加academy.htb，就可以开始了。</p><blockquote class="ls lt lu"><p id="1237" class="ku kv lr kw b kx ky ju kz la lb jx lc lv le lf lg lw li lj lk lx lm ln lo lp im bi translated">获得的知识</p></blockquote><ol class=""><li id="9109" class="ly lz it kw b kx ky la lb ld ma lh mb ll mc lp md me mf mg bi translated">列举</li><li id="77ef" class="ly lz it kw b kx mh la mi ld mj lh mk ll ml lp md me mf mg bi translated">使用打嗝分析报头</li><li id="1a28" class="ly lz it kw b kx mh la mi ld mj lh mk ll ml lp md me mf mg bi translated">使用Metasploit获得立足点</li><li id="24aa" class="ly lz it kw b kx mh la mi ld mj lh mk ll ml lp md me mf mg bi translated">通过composer提升权限</li></ol><blockquote class="ls lt lu"><p id="7da9" class="ku kv lr kw b kx ky ju kz la lb jx lc lv le lf lg lw li lj lk lx lm ln lo lp im bi translated">端口扫描</p></blockquote><p id="7430" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">运行Nmap扫描以了解用于枚举的开放端口。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mm"><img src="../Images/19ad9a9553b7d9db31868b7478f1ddf5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9KBc0obTIzy_xQ296fyoTA.png"/></div></div></figure><blockquote class="ls lt lu"><p id="c345" class="ku kv lr kw b kx ky ju kz la lb jx lc lv le lf lg lw li lj lk lx lm ln lo lp im bi translated">网络侦察</p></blockquote><p id="fc4f" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">所以我们先列举一下80端口。我决定启动一个gobuster扫描，得到了一些有用的东西。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mn"><img src="../Images/9411a1b20dfc82d5fc85104e1cfcf29b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H35ySGXQGxm2P_ToEmZtjg.png"/></div></div></figure><p id="5796" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这么多。php页面。先在平台上注册吧。注册后，我们被重定向到一个login.php。输入凭据，我们成功登录。平台里没什么好玩的。</p><p id="9ae6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后我决定拦截数据，当我们在平台上注册时，遇到了新的东西"<strong class="kw iu"> roleid =0 </strong>"。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mo"><img src="../Images/45335c08a910d45044f1a4695b308fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WdwGoOwDu0X0c6Do9RfeKg.png"/></div></div></figure><p id="6d50" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">这一次，我将值更改为“1”并转发数据，但我再次被重定向到login.php。</p><p id="6daa" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在我重复了同样的过程，但是我没有去login.php，而是去了admin.php，然后我们就有了一些立足点。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mp"><img src="../Images/9269bde636f3dc12d40a68302dddfcb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DiKwRKATuVuBY4XNFWwUQQ.png"/></div></div></figure><p id="8b07" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">将这个[subdomin].academy.htb添加到/etc/hosts文件中，并在浏览器中访问它。</p><p id="f6c6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">环顾页面，我得到了一些有用的信息，如APP_NAME=Laravel和APP_KEY=………………</p><p id="a911" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在网上搜索时，我发现了易受<strong class="kw iu"> RCE攻击的<a class="ae lq" href="https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/http/laravel_token_unserialize_exec.rb" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> Laravel漏洞</strong> </a> <strong class="kw iu"> </strong>。</strong>打开坏小子Metasploit，搜索Laravel漏洞。设置选项。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mq"><img src="../Images/f7e941d7bd80aeaa9bee258b876147db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q-7Wd0VVjRes8ZKWYQ2lmQ.png"/></div></div></figure><p id="1d5e" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">然后利用漏洞，然后我们得到了低级特权。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mr"><img src="../Images/b2a968087eecaf6c2face4a3e4337b47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*olf5wmFVsLM-UTjM0n2TCA.png"/></div></div></figure><blockquote class="ls lt lu"><p id="ca1a" class="ku kv lr kw b kx ky ju kz la lb jx lc lv le lf lg lw li lj lk lx lm ln lo lp im bi translated"><strong class="kw iu">横向权限提升</strong></p></blockquote><p id="bea4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">列出主目录，我们可以看到很多用户。我浪费了很多时间，然后意识到<a class="ae lq" href="https://cdn-images-1.medium.com/max/1000/1*DiKwRKATuVuBY4XNFWwUQQ.png" rel="noopener"> <strong class="kw iu">图像</strong> </a>提到了用户cry0I1t3。因此，首先，我们必须将我们的权限横向提升到用户cry..t3。耗尽了我的大脑，然后我搜索了Laravel <a class="ae lq" href="https://www.tutorialspoint.com/laravel/laravel_configuration.htm" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu">重要文件</strong> </a> <strong class="kw iu">。</strong>打开文件给我用户<strong class="kw iu"> </strong> cry0I1t3的密码。</p><p id="2ddb" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在切换到用户cry0I1t3，检查他是否有任何sudo特权。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ms"><img src="../Images/6d86f4817701891964ef3d6119c4caf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R6-QkZl7IGj5db-orCHpAQ.png"/></div></div></figure><p id="f449" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因为这个用户不在sudoers列表中，所以我决定查找与用户mrb3n相关的文件。</p><p id="d1ca" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意:- </strong>通过SSH登录用户cry0I1t3，体验更佳。</p><p id="0052" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">在搜索文件后，我决定查看这个用户的“组”信息，我发现这个用户在“adm”组中。转到/var/log/audit并搜索mrb3n凭据。(提示-使用grep)</p><p id="f60b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在切换到用户mrb3n…</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mt"><img src="../Images/403c065c34f977bf0334009eb839f396.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ZSMo_aXTFZpPKwfyXueTA.png"/></div></div></figure><p id="f96a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">…并检查他/她拥有什么sudo权限。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mu"><img src="../Images/1ed966bfadd57f7cde364fc666ce53b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d7Njp3_EBmdEGFvzBbBkzg.png"/></div></div></figure><blockquote class="ls lt lu"><p id="6132" class="ku kv lr kw b kx ky ju kz la lb jx lc lv le lf lg lw li lj lk lx lm ln lo lp im bi translated"><strong class="kw iu">垂直权限提升</strong></p></blockquote><p id="dfc4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">因此，该用户可以运行“composer”命令。访问<a class="ae lq" href="https://gtfobins.github.io/#composer" rel="noopener ugc nofollow" target="_blank"> <strong class="kw iu"> GTFobins </strong> </a>进行权限升级。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mv"><img src="../Images/e8dd48eff150494f989697879c806b09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E4O11JPIkTELENMKHJBXbQ.png"/></div></div></figure><p id="f3e4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">嘣我们在<strong class="kw iu"> r </strong>🤠🥳 <strong class="kw iu"> t. </strong></p><p id="046b" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated"><strong class="kw iu">注意:- </strong>所以，在得到根哈希之后，我浏览了所有加密的文章，并且学到了一些新的东西。</p><p id="4ea4" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">使用ssh-keygen生成一对SSH密钥。现在复制公钥(id_rsa.pub)并像这样粘贴👇(x → SSH)</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mw"><img src="../Images/5fbfe6b96e9c5a9458e2c5d3209d462b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMlgvhCuw-vXemriTUa3hA.png"/></div></div></figure><p id="393a" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在运行composer，它会将密钥添加到/root/。ssh/authorized _ key。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi mx"><img src="../Images/5f46aed8eb9cd84501cb934486fe9aa5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1gje3HljLHulrf5Y3_EMtg.png"/></div></div></figure><p id="58f6" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">现在将公钥(id_rsa)的权限更改为600，并使用以下内容👇以获得root访问权限。<strong class="kw iu">访问所有标志</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi my"><img src="../Images/9e4ffe5cde437fd76863226e59b57f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i8rUYZ56l-hUMdf6m7pvMg.png"/></div></div></figure><p id="08f8" class="pw-post-body-paragraph ku kv it kw b kx ky ju kz la lb jx lc ld le lf lg lh li lj lk ll lm ln lo lp im bi translated">如需更多演练，请继续关注…</p><h1 id="3f19" class="mz na it bd nb nc nd ne nf ng nh ni nj jz nk ka nl kc nm kd nn kf no kg np nq bi translated">在你走之前</h1><p id="6fb1" class="pw-post-body-paragraph ku kv it kw b kx nr ju kz la ns jx lc ld nt lf lg lh nu lj lk ll nv ln lo lp im bi translated">访问我的Funbox系列漫游的:-</p><div class="nw nx gp gr ny nz"><a href="https://shubham-singh.medium.com/doctor-htb-walkthrough-70bcb9eedefd" rel="noopener follow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">医生:HTB演练</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">描述</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">shubham-singh.medium.com</p></div></div><div class="oi l"><div class="oj l ok ol om oi on ks nz"/></div></div></a></div><div class="nw nx gp gr ny nz"><a href="https://github.com/Mr-Lazzy/Vulnhub_Walkthrough" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd iu gy z fp oe fr fs of fu fw is bi translated">懒人先生/Vulnhub _演练</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">在GitHub上创建一个帐户，为Mr-lazy/Vulnhub _ walk through开发做贡献。</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">github.com</p></div></div><div class="oi l"><div class="oo l ok ol om oi on ks nz"/></div></div></a></div></div></div>    
</body>
</html>