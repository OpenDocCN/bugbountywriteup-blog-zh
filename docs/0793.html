<html>
<head>
<title>HackTheBox Writeup — Blocky</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HackTheBox书面报告—块状</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/oswe-like-boxes-series-0x01-htb-blocky-write-up-1ac98e50dee7?source=collection_archive---------2-----------------------#2020-08-28">https://infosecwriteups.com/oswe-like-boxes-series-0x01-htb-blocky-write-up-1ac98e50dee7?source=collection_archive---------2-----------------------#2020-08-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/44526e75bf0a3c9a2f35c41c45eb91c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ep52YdZnjxBubCiUiS5T5w.png"/></div></div></figure><p id="ce7b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，伙计们，今天我们将看看来自Hackthebox的块状盒子。这是一台非常简单的机器，有两种解决方案。一个是有意的，另一个是无意的。预定方式的总结部分。</p><h2 id="dc2b" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">摘要</h2><ul class=""><li id="8635" class="lp lq iq ka b kb lr kf ls kj lt kn lu kr lv kv lw lx ly lz bi translated">共有4个开放端口<strong class="ka ir"> 21 </strong>、<strong class="ka ir"> 22 </strong>、<strong class="ka ir"> 80 </strong>和<strong class="ka ir"> 25565 </strong>。</li><li id="6d47" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">迎面来到<strong class="ka ir">端口80 </strong>，那里有一个<strong class="ka ir"> wordpress </strong>页面，获取用户名<strong class="ka ir">凹口</strong>。</li><li id="32ec" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">使用<strong class="ka ir"> ffuf </strong>或任何其他web fuzzer找到名为<strong class="ka ir"> /plugins </strong>的目录。</li><li id="2323" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">下载<strong class="ka ir">block core . jar</strong>并使用<strong class="ka ir"> JD-GUI </strong>检查，获取密码。</li><li id="bb3b" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">用你找到的用户名<strong class="ka ir">缺口</strong>和密码SSH入框。</li><li id="e422" class="lp lq iq ka b kb ma kf mb kj mc kn md kr me kv lw lx ly lz bi translated">特权升级的基本<strong class="ka ir"> sudo -i </strong>。</li></ul><h2 id="5aa2" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">扫描端口</h2><p id="76ab" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">像往常一样，我们将从<strong class="ka ir"> nmap </strong>扫描开始，我使用nmap的方式是首先扫描所有端口，然后进行服务扫描，并为我找到的开放端口运行默认脚本。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="abf9" class="kw kx iq mn b gy mr ms l mt mu"><strong class="mn ir">nmap -p- -vv -T5 10.10.10.37 -oN nmapscan</strong></span></pre><p id="e7c3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用了<strong class="ka ir"> -vv </strong>，因为如果nmap发现较低编号的开放端口，它会立即向我们显示，这样在扫描时，我可以查看这些端口。我觉得这样扫描比较快。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="9a83" class="kw kx iq mn b gy mr ms l mt mu"><strong class="mn ir">nmap -p21,22,80,8192,25565 -sVC -vv -T4 -oN nmapscan2 10.10.10.37</strong></span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/f1fce3d60d9b3c4033854390fd1fabde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3rxa5XfWg7LuLB4l7nJPcQ.png"/></div></div></figure><p id="a900" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有ftp和ssh端口，因为ftp上没有匿名登录，我们还没有凭证，我们将查看一下<strong class="ka ir">端口80 </strong>。还有一个《我的世界》服务器，但不可利用。</p><h2 id="a8d4" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">获取用户名</h2><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/633e9d6c0a5a9aeab54a7ac34ce28fd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P62lm-KK9PKvoTqubUeBrg.png"/></div></div></figure><p id="63fd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们转到端口80时，我们可以看到这个wordpress页面，通过点击其中一个帖子，我们可以看到我们用户的用户名。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/ef7fb79371eaa9969c530d2e91d4f5fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*iL7jjF9anikILKnzcdvolw.png"/></div></figure><p id="d90e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还可以用<strong class="ka ir">枚举wordpress上的用户？author=1 </strong>参数。</p><h2 id="0866" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">网络起毛</h2><p id="9f4f" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在主目录上，我们有wordpress，但是让我们模糊一下，看看是否有其他目录或文件。为此，我使用<strong class="ka ir"> ffuf </strong>和<strong class="ka ir">directory-list-2.3-medium . txt</strong>作为单词表。</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="9ea8" class="kw kx iq mn b gy mr ms l mt mu"><strong class="mn ir">ffuf -u "</strong><a class="ae my" href="http://10.10.10.37/FUZZ" rel="noopener ugc nofollow" target="_blank"><strong class="mn ir">http://10.10.10.37/FUZZ</strong></a><strong class="mn ir">" -w ~/gitClones/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -e .php,.txt</strong></span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/677b50f2320e37b57e97a7b4e45c79db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7oRSXVXkbMLgGmqQc1pt1w.png"/></div></div></figure><p id="b3be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在<strong class="ka ir"> wiki </strong>页面上什么也没有，有一些wordpress相关页面和<strong class="ka ir">插件</strong>页面。请记住，phpmyadmin 和wp-login.php<strong class="ka ir">还有</strong>T42，因为我们将在稍后的非预期解决方案中处理它们。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/d120d92b75d4ba25cbcfc1dbf92181b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVuvmb52CAcyx0o1B2d7WA.png"/></div></div></figure><p id="c711" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们在<strong class="ka ir">插件</strong>目录中有两个文件，我都下载了，但是在griefprevention文件中没有什么有趣的东西，实际上它是minecraft的一个补丁或者类似的东西。</p><p id="5904" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以用<strong class="ka ir"> JD-GUI </strong>检查它，但我用<strong class="ka ir"> 7z </strong>提取它，并使用我们的万能工具<strong class="ka ir">“字符串”</strong> :p</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/cec1e6bcfa96de04e6acdd535a240c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*oXDj8tuZfKjWHahrRfU2Xw.png"/></div></figure><p id="e4f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实现密码"<strong class="ka ir">8 ysqfctntnvxaueduzjnsxe 22 "。经过一些尝试和错误之后，我能够用这个密码和notch用户连接SSH。</strong></p><h2 id="55ff" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">权限提升</h2><p id="fb75" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">在获得带有用户缺口的shell后，我检查了它是否像往常一样是sudoers之一。的确是这样；</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/037d429d46df08928b347c486d1886d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T0110RBe4xVEsZmBr1dAOg.png"/></div></div></figure><p id="64b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这部分没有什么特别的，非常简单。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/da410c642d2c1b1c023ef54d3ba85734.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*Wx5XxoeS3XZMcSQObzC9dg.png"/></div></figure><h2 id="8f95" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">意外的方式</h2><p id="76f3" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">记住<strong class="ka ir"> phpmyadmin </strong>，<strong class="ka ir">wp-login.php</strong>页面和BlockyCore凭证。当我第一次看到凭证时，我想我应该输入phpmyadmin，因为有sqlUser，sqlPass值。</p><p id="b6cc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我拿着凭证进入时，我看到了wordpress数据库。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nd"><img src="../Images/2bc782a9a1f0f65fe689cb9c268be59f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jQd5DRh-qmQ58R_UJ5xtFw.png"/></div></div></figure><p id="caae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我试图破解它，但不能改变它的自定义密码。要改变它，我们必须得到我们的密码的散列版本。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/301819a5896a3b665e5a42476fb0e7d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kJNKoqKiVzT-rxVRYU5T3w.png"/></div></div></figure><p id="0cc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我了解到哈希类型是<strong class="ka ir"> phpass </strong>，所以用这个在线生成器生成了它。</p><div class="nf ng gp gr nh ni"><a href="https://ehikioya.com/wordpress-password-hash-generator/" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">密码散列生成器</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">最后更新于2019年8月19日上午07:51由这个WordPress密码哈希生成器使用官方WordPress…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">ehikioya.com</p></div></div><div class="nr l"><div class="ns l nt nu nv nr nw jw ni"/></div></div></a></div><h2 id="451b" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">带有Web Shell的访问机器</h2><p id="9ac7" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们已经在wordpress上更改了notch的密码，所以我们可以在登录后访问<strong class="ka ir"> wp-admin </strong>。之后的过程很简单，也很有名。使用主题，你可以编辑主题php页面并轻松获得外壳。您也可以使用插件来实现这一点。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/cc61e90156f03873fc835cbb58e460fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vAsx_L8OE5Ekm-WZi76biA.png"/></div></div></figure><p id="4de6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从<strong class="ka ir">外观- &gt;编辑器</strong>，我换了<strong class="ka ir">404.php</strong>页面，用<strong class="ka ir"> p0wny </strong>外壳编辑。这是我喜欢的，你当然可以选择其他页面或其他web外壳。</p><div class="nf ng gp gr nh ni"><a href="https://github.com/flozz/p0wny-shell" rel="noopener  ugc nofollow" target="_blank"><div class="nj ab fo"><div class="nk ab nl cl cj nm"><h2 class="bd ir gy z fp nn fr fs no fu fw ip bi translated">flozz/powny-shell</h2><div class="np l"><h3 class="bd b gy z fp nn fr fs no fu fw dk translated">p0wny@shell:~#是一个非常基本的单文件PHP shell。它可用于在服务器上快速执行命令，当…</h3></div><div class="nq l"><p class="bd b dl z fp nn fr fs no fu fw dk translated">github.com</p></div></div><div class="nr l"><div class="ny l nt nu nv nr nw jw ni"/></div></div></a></div><p id="42c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以在上访问404.php</p><pre class="mi mj mk ml gt mm mn mo mp aw mq bi"><span id="8ac3" class="kw kx iq mn b gy mr ms l mt mu"><strong class="mn ir">http://10.10.10.37/wp-content/themes/twentyseventeen/404.php</strong></span></pre><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/945cd091bfef08d1f3e9c92564d3d38e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JS5k8TWWtUkCxPo_BuzBIQ.png"/></div></div></figure><p id="6b29" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将shell作为www-data用户。由于这个盒子很旧了，我试图避免使用内核漏洞，所以我试图找到另一种方法。</p><p id="50a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到notch用户的主目录，有一个minecraft文件夹，里面有一些。jar文件。</p><p id="002a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在TJnull的列表中，有一个关于“JD-GUI的良好实践”的注释，因为BlockyCore.jar太简单了，我想我必须处理它们。挣扎了一段时间后，我一无所获。</p><h2 id="4249" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">内核开发</h2><p id="0e1f" class="pw-post-body-paragraph jy jz iq ka b kb lr kd ke kf ls kh ki kj mf kl km kn mg kp kq kr mh kt ku kv ij bi translated">我们最后的手段是搜索内核漏洞，因为内核版本是4.4.0-62-generic可能有一个。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/ca72a73086ff242f950afb5a16560291.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W840xG82kP2NzK8hmBslJQ.png"/></div></div></figure><p id="6ffc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你在searchsploit结果上看到的，有一些漏洞，但是当你检查DCCP Double-Free是在我们的内核版本上测试的。</p><figure class="mi mj mk ml gt jr gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/57409cdc0bb0f5ff3011b17cc3d01c86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*Le5ABBi4c0KUDpuXZizhNA.png"/></div></figure><p id="d4b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">它工作，但非常不稳定，我不得不尝试了几次，它崩溃了，所以我不建议使用它。</p><blockquote class="oc"><p id="0067" class="od oe iq bd of og oh oi oj ok ol kv dk translated">那都是乡亲们！祝您愉快:)</p></blockquote></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><h2 id="c989" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated"><strong class="ak"> <em class="ot">联系我</em> </strong></h2><blockquote class="ou ov ow"><p id="fa84" class="jy jz ox ka b kb kc kd ke kf kg kh ki oy kk kl km oz ko kp kq pa ks kt ku kv ij bi translated"><a class="ae my" href="http://twitter.com/mutluexe" rel="noopener ugc nofollow" target="_blank">推特</a></p><p id="4401" class="jy jz ox ka b kb kc kd ke kf kg kh ki oy kk kl km oz ko kp kq pa ks kt ku kv ij bi translated"><a class="ae my" href="http://linkedin.com/in/mutluexe" rel="noopener ugc nofollow" target="_blank">领英</a></p><p id="742a" class="jy jz ox ka b kb kc kd ke kf kg kh ki oy kk kl km oz ko kp kq pa ks kt ku kv ij bi translated"><a class="ae my" href="https://www.hackthebox.eu/profile/112790" rel="noopener ugc nofollow" target="_blank">黑客盒子</a></p></blockquote></div></div>    
</body>
</html>