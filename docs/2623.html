<html>
<head>
<title>Supply Chain Attacks on the risk - Open Source Security</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">供应链攻击的风险——开源安全</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/supply-chain-attacks-on-the-risk-open-source-security-ee7a8cf1ec58?source=collection_archive---------4-----------------------#2022-12-09">https://infosecwriteups.com/supply-chain-attacks-on-the-risk-open-source-security-ee7a8cf1ec58?source=collection_archive---------4-----------------------#2022-12-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b7de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">供应链攻击背景——WASP对Python的攻击——多态恶意软件运送WASP Stealer感染了数百名受害者</h2></div><h2 id="4e73" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">TL；速度三角形定位法(dead reckoning)</h2><p id="b335" class="pw-post-body-paragraph lb lc iq ld b le lf jr lg lh li ju lj ko lk ll lm ks ln lo lp kw lq lr ls lt ij bi translated">与恶意活动(WASP group)有关联的<a class="ae lu" href="https://pypi.org/project/pywale/" rel="noopener ugc nofollow" target="_blank"> pywale </a>包的研究分析。黄蜂地面方法模仿著名的包<a class="ae lu" href="https://github.com/psf/requests/stargazers" rel="noopener ugc nofollow" target="_blank">请求来自python的</a>又名劫星技术。一个可疑文件<a class="ae lu" href="http://models.py/" rel="noopener ugc nofollow" target="_blank"><em class="lv">models . py</em></a><em class="lv"/>，其中包含base64编码的stage1有效负载，该有效负载获取高度混淆的stage2有效负载并执行恶意操作。</p><p id="f8ff" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">开源生态系统中的供应链安全已经成为更广泛的开源社区关注的焦点，包括许多依赖开源软件的公司和政府。</p><p id="661a" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">作为一个行业和社区，不良行为者接管用户帐户，破坏流行的开源依赖项，并利用一些最大的开源项目中的漏洞。</p><p id="4e34" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">众所周知，我们的许多现代数字基础设施都是在开源上运行的。开源软件(OSS)的成功，在某种程度上，归结于全球开发者社区开发它的速度。但是，如果开发者继承了供应链中的漏洞，这种速度是有代价的。</p><p id="768d" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><strong class="ld ir">观察:</strong></p><p id="f0a2" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">包裹正在执行劫星。它模仿著名的请求库。该包指向著名的python库，即<strong class="ld ir">请求</strong>看起来合法。</p><p id="dfa3" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><a class="ae lu" href="https://github.com/psf/requests/stargazers" rel="noopener ugc nofollow" target="_blank">https://github.com/psf/requests/stargazers</a></p><p id="fdd2" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><a class="ae lu" href="https://requests.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://requests.readthedocs.io/en/latest/</a></p><p id="2b83" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><strong class="ld ir">分析概要:</strong></p><p id="2f85" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">这个包提到了一个需求列表，可以从https://github.com/psf/requests'下载。</p><p id="5795" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">开源生态系统中的供应链安全已经成为更广泛的开源社区关注的焦点，包括许多依赖开源软件的公司和政府。</p><p id="626e" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">作为一个行业和社区，不良行为者接管用户帐户，破坏流行的开源依赖项，并利用一些最大的开源项目中的漏洞。</p><p id="779b" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">众所周知，我们的许多现代数字基础设施都是在开源上运行的。开源软件(OSS)的成功，在某种程度上，归结于全球开发者社区开发它的速度。但是，如果开发者继承了供应链中的漏洞，这种速度是有代价的。</p><p id="7927" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><strong class="ld ir">观察:</strong></p><p id="6bdf" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">包裹正在执行劫星。它模仿著名的请求库。这个包指向著名的python库，即<strong class="ld ir">请求</strong>看起来合法。</p><p id="fabd" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">【https://github.com/psf/requests/stargazers T4】</p><p id="b290" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><a class="ae lu" href="https://requests.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">https://requests.readthedocs.io/en/latest/</a></p><p id="c048" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated"><strong class="ld ir">分析:</strong></p><p id="6056" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">这个包提到了一个可以从https://github.com/psf/requests'下载的需求列表。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/f8808a018bcb7ac25d9cdc59936bbffc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*ooew7PCuR3156wz3RRzEsQ.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.1</figcaption></figure><p id="8a26" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">在检查代码时，可以观察到一个可疑文件'<a class="ae lu" href="http://models.py" rel="noopener ugc nofollow" target="_blank"><strong class="ld ir">models . py</strong></a><strong class="ld ir">'</strong>在第8行发现了一个base64编码的代码串，同样可以在附件1.2中引用。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/77a54706e75cf41b13bfc6132b17a14c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*vexXFjRjFl4wNcYmTVJK4Q.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.2</figcaption></figure><p id="3fe7" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">解码编码代码后，我们观察到代码从<a class="ae lu" href="http://51.103.210.236/inject/8HA7LjxopFuz52AI" rel="noopener ugc nofollow" target="_blank">http://51.103.210.236/inject/8HA7LjxopFuz52AI</a>获取一些有效载荷</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/e1a6fb0025a99355f7cd461df3a4fb50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*XOdS8rnIdaeC0FqR300AHA.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.3</figcaption></figure><p id="9be7" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">在寻找知识产权声誉后，注意到没有人报告它是恶意的。同样的情况可以在图表1.4和1.5中看到。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/9270d6f27b6441191c3992b1d68187c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*mviQJJUvlZRMxDSQQKRdlQ.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.4</figcaption></figure><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/96e6bb6e8739496e9c9d4777406ac6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*R4INPCPGfXbXTSXyI73Q9g.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.5</figcaption></figure><p id="1f34" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">在IP上导航后，观察到以下消息。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/be2988db1338ff52f4486343a60a3002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*3vZV1b-S7nhneFdv72sIUQ.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.6</figcaption></figure><p id="2523" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">继续base64解码的代码，我们进一步导航到提到的URL，从那里获取有效负载。似乎混淆代码已被托管。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/5559a150ee27c2d9b60a50729e59c490.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*z34jYgsypdSxf_NdQKt1pw.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.7</figcaption></figure><p id="714d" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">美化python代码。它看起来像进一步十六进制混淆是在有效载荷的多个部分使用。为了总结这段代码到底想做什么，我们需要解码十六进制编码的代码。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/1779b7d5d7d7892d52c388eeb15735a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/format:webp/1*xZWOeRHgPx1VpM0gLcQK_Q.png"/></div><figcaption class="mj mk gj gh gi ml mm bd b be z dk translated">附件1.8</figcaption></figure><p id="cc76" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">在这一点上，我们能够注意到一个<strong class="ld ir"> test.js </strong>文件被创建，同样的文件被执行，但是请注意它到底想做什么。</p><p id="8a86" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">后来人们注意到，该包裹与<a class="ae lu" href="https://checkmarx.com/supply-chain-security/" rel="noopener ugc nofollow" target="_blank"> Checkmarkx </a> &amp;检查站研究小组披露的威胁行动者<strong class="ld ir">WASP’</strong>又名<strong class="ld ir">WASP steer</strong>有关。大声疾呼<a class="ae lu" href="https://checkmarx.com/supply-chain-security/\" rel="noopener ugc nofollow" target="_blank"> Checkmarx </a>开创了如此伟大的研究领域。一定要看看Checkmarx安全研究团队发表的博客<a class="ae lu" href="https://medium.com/checkmarx-security/wasp-attack-on-python-polymorphic-malware-shipping-wasp-stealer-infecting-hundreds-of-victims-10e92439d192" rel="noopener"> WASP对Python的攻击——多态恶意软件运输WASP Stealer感染数百名受害者</a></p><p id="cbd2" class="pw-post-body-paragraph lb lc iq ld b le lw jr lg lh lx ju lj ko ly ll lm ks lz lo lp kw ma lr ls lt ij bi translated">另一名研究人员也分享了一份类似的分析，请观看这段YouTube视频。</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><h2 id="8470" class="kf kg iq bd kh ki kj dn kk kl km dp kn ko kp kq kr ks kt ku kv kw kx ky kz la bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae lu" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>