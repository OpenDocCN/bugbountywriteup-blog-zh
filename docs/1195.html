<html>
<head>
<title>Complex OPEN REDIRECT Exploitation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">复杂的开放重定向利用</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/complex-open-redirect-exploitation-c5cfd463a6a2?source=collection_archive---------0-----------------------#2021-03-29">https://infosecwriteups.com/complex-open-redirect-exploitation-c5cfd463a6a2?source=collection_archive---------0-----------------------#2021-03-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/329cf7501b48939e688a4e9a559ea257.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A9EH03_i0FfXpWsuF5ANjA.jpeg"/></div></div></figure><p id="5975" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">嗨，读者们，</p><p id="d870" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在以前的文章中写了我的第一个独特的开放重定向漏洞。<a class="ae kw" href="https://inakcf.medium.com/open-redirect-in-email-c658c248eec1" rel="noopener">你可以在这里找到</a>。</p><p id="072a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">今天，我想分享我最近的发现“另一个独特的开放重定向漏洞，这是有点棘手的利用”。</p><p id="786a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们开始吧:</p><p id="5545" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">目标是一个私有程序。所以，姑且称之为redacted.com的<strong class="ka ir"/></p><p id="f956" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">目标简介:</strong></p><p id="e93b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Target是一家电子商务网站构建商，提供网页设计和其他商业工具。只有两个子域名在范围内<strong class="ka ir">admin.redacted.com</strong>和<strong class="ka ir">api.redacted.com</strong></p><p id="4733" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建新帐户后，将根据我们的用户名创建店铺，如<a class="ae kw" href="https://something.redacted.com" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://something.redacted.com</strong></a></p><p id="6197" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果需要，我们可以将店铺名称更改为另一个可用名称。不管名字是什么，我们的店铺网址将会像<a class="ae kw" href="https://NAME.redacted.com" rel="noopener ugc nofollow" target="_blank">https://<strong class="ka ir">NAME</strong>. redated . com</a></p><p id="4465" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">剥削:【这里有两个阶段】</strong></p><p id="ffd1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一阶段</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/12adeaca1c09856a84df4f230df43f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YbjhtMFqAln1z6bS3XIuXA.jpeg"/></div></div></figure><p id="4c01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">登录admin账户后，在<strong class="ka ir">设置&gt;中</strong>有一个更改邮件地址的选项。</p><p id="98b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们更改电子邮件地址，就会向服务器发送一个PUT请求，其中包含一些json数据，类似于-</p><p id="beb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">{ "email": "email@mail.com "，" shop name ":" https://shop . redacted . com "，xxxxxxxxx，xxxxxxxxxxxxxx，xxxxxxxxxxxxxx，xxxxxxxxxxx，xxxxxxxx等。,}</p><p id="20f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里没有进行适当的服务器端验证。因此，我们甚至可以将完整的店铺名称URL更改为任何其他域名，如from</p><p id="0b5d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">https://shop.redacted.com———&gt;</strong><a class="ae kw" href="https://evil.com" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">https://evil.com</strong></a></p><p id="f178" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">商店名称将在仪表板中更新为<a class="ae kw" href="https://evil.com" rel="noopener ugc nofollow" target="_blank">https://evil.com</a></p><p id="aca0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">(改店名前保存老店网址以备后用)</strong></p><p id="ed31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">点记:</strong></p><p id="2957" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">即使我们将店铺名称更改为任何其他名称，旧的店铺URL仍然可以正常工作。</p><p id="140f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们回去吧，</p><p id="1fbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将商店的网址改为其他域名后<strong class="ka ir">我们的第一阶段开发就完成了</strong></p><p id="d08b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们进入第二阶段</p><p id="0267" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第二阶段:</strong></p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/bc1c06c9aca75c02ed780af7249e63bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*cxZfSYCxxbkFe9ieEoe9mA.jpeg"/></div></figure><p id="6db3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我前面所说，老店网址仍然工作良好。</p><p id="8854" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">导航到老店网址后，有一个选项<strong class="ka ir"> <em class="ld">创建新的客户账户。</em> </strong></p><p id="893f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在创建一个新帐户后，提供所有的详细信息，如用户名和电子邮件地址，用户将获得一个验证链接到该电子邮件地址。</p><p id="16dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">链接看起来有点像<a class="ae kw" href="https://api.redacted.com/emailverify/669321236/3936293/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"/></a></p><p id="6976" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦用户点击该链接，他/她将被重定向到我们在第一阶段进入的【evil.com】等<strong class="ka ir">域。,</strong></p><p id="3cbd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">错误配置:</strong></p><ol class=""><li id="d5e5" class="le lf iq ka b kb kc kf kg kj lg kn lh kr li kv lj lk ll lm bi translated">更改商店名称时，没有进行适当的服务器端验证。</li><li id="f7ca" class="le lf iq ka b kb ln kf lo kj lp kn lq kr lr kv lj lk ll lm bi translated">将店铺名称更改为其他名称后，旧的店铺URL仍然有效。</li></ol><p id="1022" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过结合1+2，我能够利用开放重定向漏洞，直到现在。</p><p id="0a0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我认为有可能升级到开放重定向之外。</p><p id="2f3b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢查看我的帖子，如果你有任何超越开放重定向的想法，请随时在下面发表评论:)</p><p id="326d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">问候，</p><p id="97cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">阿克希尔</p></div></div>    
</body>
</html>