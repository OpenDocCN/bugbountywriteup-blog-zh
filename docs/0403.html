<html>
<head>
<title>My First CTF Writeup : KPMG Cyber Security Challenge 2019</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的第一篇CTF报道:毕马威2019年网络安全挑战</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/my-first-ctf-writeup-kpmg-cyber-security-challenge-2019-a42a64db04d8?source=collection_archive---------1-----------------------#2019-10-25">https://infosecwriteups.com/my-first-ctf-writeup-kpmg-cyber-security-challenge-2019-a42a64db04d8?source=collection_archive---------1-----------------------#2019-10-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/b43e4f875c7b81f120a9a1e19ea23423.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tOmJ2e6uCxcUMtWs6gyFiw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">毕马威2019年网络安全挑战</figcaption></figure><h1 id="6f67" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">CTF:学习黑客的有趣方式</h1><p id="1774" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">几个月前，我发现了有关CTFs或Capture Flags的信息。CTF是一种计算机安全竞赛。有不同类型的CTF，但jeopardy风格是CTF最常用的，玩家面临许多安全挑战，涉及各个领域，如法医或逆向工程，并需要尽可能快地解决问题。每解决一个挑战都会根据难度得到一定的分数奖励，分数最高的玩家获胜。</p><p id="8144" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我发现CTF是学习网络安全的一种非常有趣的方式。当你使用了你学到的真正的利用或策略，并且看到它真的起作用(你已经黑了一些东西)或“啊哈！”当你最终找到解决办法的时候，这才是CTF真正有趣的地方。</p><h1 id="5763" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">我的第一个CTF</h1><p id="dfb2" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">当我第一次发现这项活动时，我立即加入了马来西亚的毕马威网络安全挑战2019。与黑客马拉松相比，CTF在马来西亚仍然是一个罕见的事件(这里的黑客马拉松几乎每周举行一次)。因此，我抓住了这个难得的机会。不幸的是，这是一场4人的团队比赛，在我的3名队友中，只有1人可以参加比赛。</p><p id="a2ad" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">遗憾的是，我的团队在60多个团队中排名第32位，未能通过资格赛。但尽管如此，我玩得很开心，学到了很多东西，总体来说这是一次很棒的经历。我个人认为这个结果并不太糟糕，因为我几周前才知道CTF，我失去了两个成员。</p><h1 id="7c40" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">挑战</h1><p id="48a8" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">资格赛没有很多问题，大约有7个问题，只包括隐写术、法医和逆向工程挑战。我设法解决了3个挑战，每个领域1个。我很难解决其他的RE挑战，因为他们给了Windows可执行文件，而我期待的是ELF文件。所以，事不宜迟，我们开始吧。</p><h1 id="b5d2" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">密写</h1><p id="7c4f" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">隐写术是隐藏数据的艺术，例如在图像中嵌入秘密消息。这在安全方面的一个应用例子是恶意软件隐藏。</p><h2 id="c650" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">安哥拉——最小重大失败</h2><p id="47b9" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">首先，我们得到一个zip文件的链接。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0456" class="md kd iq mu b gy my mz l na nb">Least_Significant_Failures_95988b81547c2be1431cfd83199c573c.zip</span></pre><p id="f496" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">所以我们只是解压它，使用解压命令。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="994c" class="md kd iq mu b gy my mz l na nb">$ unzip Least_Significant_Failures_95988b81547c2be1431cfd83199c573c.zip</span></pre><p id="276b" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">我们将得到一个图像文件<code class="fe nc nd ne mu b">kanye.png</code>。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/fa302db104c720aba713269aba7245f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DniL65X7aB_wLNrY.png"/></div></div></figure><p id="5ac0" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">在我们做任何事情之前，我们应该使用<code class="fe nc nd ne mu b">file</code>命令检查扩展名是否正确，因为文件有时会具有欺骗性，而且它确实是一个png文件。由于这是一个隐写术挑战，从zip文件的名称来看，这似乎是使用LSB技术来隐藏图像内某处的旗帜。所以首先，我们使用了<code class="fe nc nd ne mu b">zsteg</code>，这是一个通常会使用LSB技术显示隐藏在图像中的文本的程序。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/a6c70c6dc95df4e0aab898350aa77879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/0*7ghfOFnz1GIibSh7.png"/></div></figure><p id="e5f0" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">然而，这只会产生如上图所示的乱码文本。</p><p id="e1d8" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">接下来，我们尝试使用java工具<code class="fe nc nd ne mu b">Stegsolve.jar</code>，通过使用各种技术(反转颜色、异或等)处理图像来进行隐写。)或者滤镜。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/9a5241386adb5e5ea0bf0a82939afeef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pJ4jvSgwne5Zagps.png"/></div></div></figure><p id="be45" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">是的，我们在绿色飞机上发现了某种文字，但它看起来不像旗帜，所以它可能是加密的或密码。</p><p id="bb53" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">然后我们开始尝试使用一些通用的在线解码器，但是它不给出标志。然后我们假设这可能是凯撒密码，并试图强行破解。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/a0f106a887dfeddeeae01471bf190912.png" data-original-src="https://miro.medium.com/v2/resize:fit:1302/format:webp/0*DUmo8JqpaXwZoARS.png"/></div></figure><p id="5d94" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">但都是徒劳无功，不给旗。最后，我们尝试将其解码为base64。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/641413a3507adbb55845f3667f45ea14.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/format:webp/0*3D03gJTKyDPA5uma.png"/></div></figure><p id="d7ca" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">是的。令人惊讶的是，我们拿到了旗子。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="b0e3" class="md kd iq mu b gy my mz l na nb">KPMG{3V3RY0N3_L0V3S_ST3GGY&lt;/3}</span></pre><p id="be66" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这很棘手，因为我们一开始没有想到它是base64，因为它没有以通常的<code class="fe nc nd ne mu b">==</code>填充结束。</p><h1 id="f732" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">法院的</h1><p id="3ef2" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">取证是恢复留在计算机上的数字痕迹的艺术。在这种情况下，它与网络取证相关，我们试图在<code class="fe nc nd ne mu b">.pcap</code>文件中找到标志。</p><h2 id="bc08" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">加拿大MH370搜寻项目</h2><p id="85f9" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">首先，我们下载zip文件。解压后，我们将得到一个pcapng文件<code class="fe nc nd ne mu b">Essence.pcapng</code>。然后我们用wireshark打开文件。在wireshark上，我们搜索任何可能给我们标记的字符串，如“KPMG”、“flag”、“ctf”、“pass”等。幸运的是，我们很快找到了一个压缩文件<code class="fe nc nd ne mu b">CTF_Flag.zip</code>，其中可能包含国旗。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/b37c31b7f5aaaccf92408719b8f6f6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Os2d4jRGD-AxlNj1.png"/></div></div></figure><p id="9aad" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">然后，我们继续尝试解压缩文件。然而，它是用密码锁定的。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/170bb216e8d693b4635c303fa6b5536f.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/0*Y4DAaBvdKYQMGkJy.png"/></div></figure><p id="67e3" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">起初我们想用类似<code class="fe nc nd ne mu b">fcrackzip</code>的破解工具强行破解密码，但幸运的是我们记得之前浏览<code class="fe nc nd ne mu b">.pcapng</code>文件时看到了一个可能包含密码的<code class="fe nc nd ne mu b">pass.txt</code>文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/9ca1760ffdec302d95ee202e6b695b1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eZd_NHXOVfMHwME3.png"/></div></div></figure><p id="122f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">接下来，我们继续提取密码文本文件，并使用它来解压缩zip文件。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/ef208f5fb8dffed510f3e6f7e190eddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/0*KPgR0N9I9JK0f1w0.png"/></div></figure><p id="7d66" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">耶！通过使用密码<code class="fe nc nd ne mu b">W@k@nd@_s0m3tim3s</code>来解压文件。我们拿到旗子了！</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="c10a" class="md kd iq mu b gy my mz l na nb">KPMG{I_CAN_SAVE_IRONMAN}</span></pre><h1 id="3ab8" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">逆向工程</h1><p id="88be" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">CTF中的逆向工程通常是将编译好的(机器码、字节码)程序转换回更易于人类阅读的格式的过程。</p><p id="7e70" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">通常这将涉及到反汇编一个程序，并试图理解产生的汇编文件。事实上，给出的一些RE挑战要求您反汇编Windows PE文件或可执行文件。但是，我并没有设法解决这些，而是解决了只需要一些python知识的简单问题。</p><h2 id="d8dc" class="md kd iq bd ke me mf dn ki mg mh dp km ll mi mj kq lp mk ml ku lt mm mn ky mo bi translated">俄罗斯—城市</h2><p id="dd8d" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">首先，我们下载zip文件并将其解压缩，这将给我们一个python代码<code class="fe nc nd ne mu b">GateToRiches.py</code>。通过查看代码。它会问一个用户名，并以某种方式计算标志。我们可以通过修改代码打印产生的标志<code class="fe nc nd ne mu b">res</code>来轻松解决这个问题。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/de6c4f06a572b04e9f1e46bab99b1b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*HQIcmNx82TpLUAcj.png"/></div></figure><p id="9eb2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">现在，当我们运行python脚本时，它会给我们一个标志。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="0e55" class="md kd iq mu b gy my mz l na nb">KPMG{f00d}</span></pre><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/013279b77184b79483aee47939f4c371.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/0*YA8v8mSPKhAstIAi.png"/></div></figure><h1 id="6067" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">结论</h1><p id="01ff" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">我对结果有点失望，但我从比赛中学到了很多，将来肯定会加入更多的CTFs。事实上，几周前我刚刚参加了另一个CTF，不久我会写一篇关于它的文章。</p><p id="31b9" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">对于那些对网络安全感兴趣的读者，我真的鼓励他们不管你的技术水平如何，都来玩玩CTF吧！你可以从<a class="ae np" href="https://picoctf.com/" rel="noopener ugc nofollow" target="_blank"> picoCTF </a>开始，一个初学者友好的CTF。</p><p id="6f3b" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">这是我的第一篇文章，请随意留下关于我写作的反馈。</p></div></div>    
</body>
</html>