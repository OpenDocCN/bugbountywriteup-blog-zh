<html>
<head>
<title>What is BOLA? 3-digit bounty from Topcoder ($$$)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">博拉是什么？来自Topcoder的3位数奖金($$$)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/what-is-bola-3-digit-bounty-from-topcoder-a25e7fae0d64?source=collection_archive---------1-----------------------#2021-08-09">https://infosecwriteups.com/what-is-bola-3-digit-bounty-from-topcoder-a25e7fae0d64?source=collection_archive---------1-----------------------#2021-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0c28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好。</p><p id="e9e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇写的将是关于<strong class="jp ir">破碎对象级授权(BOLA) </strong>，也就是API安全<a class="ae kl" href="https://owasp.org/www-project-api-security/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> (OWASP) </strong> </a>的<strong class="jp ir"> #1 </strong>话题。我还将考虑一个我发现此漏洞的案例。好了，事不宜迟，让我们开始吧。</p><blockquote class="km kn ko"><p id="7338" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">什么是<strong class="jp ir">碎物级授权(BOLA)？</strong></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/ddd929cf848ed213e488e52357eab285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1G9Gg1xi2gqdWxmQUOFRoQ.jpeg"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">(防博拉)</figcaption></figure><p id="445f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">中断对象级授权(BOLA) </strong>依赖于用户在应用程序上发送的敏感请求被其他资源访问的能力。这通常是由于开发人员缺少/不正确的访问控制造成的。技术上基本可以比作IDOR。当这种安全配置没有正确完成时，它具有广泛的攻击面(从信息泄露到帐户接管)。</p><p id="8b03" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从图像中可以看出，如果我们尝试制作一个典型的攻击场景，它将是这样的:</p><ul class=""><li id="da44" class="lj lk iq jp b jq jr ju jv jy ll kc lm kg ln kk lo lp lq lr bi translated">API将为受害者和攻击者提供特定的身份，并允许他们访问敏感数据。(https://redacted.com/exposed/v1/profiles/self-id)</li><li id="98d5" class="lj lk iq jp b jq ls ju lt jy lu kc lv kg lw kk lo lp lq lr bi translated">攻击者将注意到API中的弱点，并能够使用受害者的用户id访问受害者的PII数据。(https://redacted.com/exposed/v1/profiles/target-id)</li></ul><p id="0c5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，这些特定于用户的变量并不总是需要保存在GET请求中。一些API也可能在POST请求中携带特定于用户的变量。在某些情况下，漏洞API可基于多个控制点来配置。</p><blockquote class="km kn ko"><p id="f18b" class="jn jo kp jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><strong class="jp ir">top coder中的BOLA案例</strong></p></blockquote><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lx"><img src="../Images/15598d7cf4604a917a39bf2fe441ed2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qfTW7Sy1yWczDf8pvO1snw.png"/></div></div></figure><p id="78ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据这种情况，我给大家讲一下我在Topcoder中发现的漏洞。该漏洞与一个API上的多个检查点有关。(这份报告在hackerone上公开:<a class="ae kl" href="https://hackerone.com/reports/1073420" rel="noopener ugc nofollow" target="_blank">https://hackerone.com/reports/1073420</a>)</p><p id="8345" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我开始在Topcoder上寻找漏洞时，我首先在topcoder.com上创建了一个帐户，当我通过Burp检查所有HTTP请求时，我注意到我的论坛用户id信息在会员开放期间，我也可以在会员页面的源代码中访问该值。此外，当我输入任何其他用户的个人资料时，我可以看到论坛用户id。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ly"><img src="../Images/de25f3c0f21e9612098d8d2cc5db7826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Q_Jyrs0APMI5Ga3cdR_4NQ.png"/></div></div></figure><p id="1753" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在主网站上找不到太多，开始寻找子域名(我发送了一些报告，但重复:/)我得到了子域名列表，并决定分析Topcoder论坛。(apps.topcoder.com/forums)。它直接在主网站上使用我的账户。所以，我在主网站上的PII信息对我的论坛账户也是有效的。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/8b76fce761495acedf404552ddc0a2ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*KAU4vmGIiJkAWx_S1pHhDw.png"/></div></figure><p id="008f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">浏览了一会论坛，进了一个帖子，注意到了<strong class="jp ir">“看帖子”</strong>部分。我打开拦截器，开始查看请求。<br/>来自不同主机的API正在发送没有授权头的POST请求。在这种情况下，我决定仔细查看API，POST数据中的一些信息引起了我的注意。它在请求的头部接收API定义的id信息(我猜是),在数据部分接收我的论坛用户ID。在回复部分，我可以看到我的电子邮件，姓名和帐户id，这些都没有反映在我的Topcoder个人资料中。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/dd87094e0302d6ecbc6857f0373652c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1378/format:webp/1*K1cXJ3mJpuZH0ue0eggoOQ.png"/></div></figure><p id="74d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即创建了另一个用户，并在数据部分更改了我的Topcoder ID。然而，什么都没有改变。API接受多个值，并可能使用所有这些值来控制用户。<br/>请求标题中反映的ID引起了我的注意，我用另一个字母替换了最后一位数字，同时用受害者的Topcoder id替换了我的Topcoder id，并发送了请求。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mb"><img src="../Images/e033776b8224b6eccb45c05e3993cc96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c5xRZMHE15PjqKNlVvM36Q.png"/></div></div></figure><p id="c55a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">答对了！</strong>我能够访问目标的PII信息。API试图使用多个检查点对目标用户进行身份验证。但是，这些信息在Topcoder.com上公开显示，API给出的ID在更改为随机值时反映了敏感数据。</p><p id="18cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Topcoder确认了这个漏洞，奖励了我$$$。</p><p id="49d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">资源:<br/><a class="ae kl" href="https://blog.shiftleft.io/api-security-101-broken-object-level-authorization-fe8720c779ec" rel="noopener ugc nofollow" target="_blank">https://blog . shift left . io/API-security-101-broken-object-level-authorization-Fe 8720 c 779 EC</a></p><div class="mc md gp gr me mf"><a href="https://heimdalsecurity.com/blog/what-is-broken-object-level-authorization-bola/" rel="noopener  ugc nofollow" target="_blank"><div class="mg ab fo"><div class="mh ab mi cl cj mj"><h2 class="bd ir gy z fp mk fr fs ml fu fw ip bi translated">什么是中断的对象级授权(BOLA ),它会如何影响您？</h2><div class="mm l"><h3 class="bd b gy z fp mk fr fs ml fu fw dk translated">根据OWASP(开放Web应用安全项目)2019 API安全项目，破碎对象级别…</h3></div><div class="mn l"><p class="bd b dl z fp mk fr fs ml fu fw dk translated">heimdalsecurity.com</p></div></div><div class="mo l"><div class="mp l mq mr ms mo mt ld mf"/></div></div></a></div><p id="d740" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://github.com/OWASP/API-Security/blob/master/2019/en/src/0xa1-broken-object-level-authorization.md" rel="noopener ugc nofollow" target="_blank">https://github . com/OWASP/API-Security/blob/master/2019/en/src/0xa 1-broken-object-level-authorization . MD</a></p><p id="82e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢！！</p><p id="d6e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">推特:<a class="ae kl" href="https://twitter.com/canmustdie" rel="noopener ugc nofollow" target="_blank">https://twitter.com/canmustdie</a></p></div></div>    
</body>
</html>