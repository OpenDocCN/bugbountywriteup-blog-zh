<html>
<head>
<title>How to Hack Applications’ Logic</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何破解应用程序的逻辑</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-to-hack-applications-logic-6b0219f0dd04?source=collection_archive---------0-----------------------#2022-12-05">https://infosecwriteups.com/how-to-hack-applications-logic-6b0219f0dd04?source=collection_archive---------0-----------------------#2022-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4c46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我决定写一篇关于在web、移动和桌面应用程序中寻找逻辑错误的指南。实际上，这篇文章不仅仅是关于打破逻辑，如果你理解得好，它将引导你像黑客一样思考，这样，你可能还会发现许多不同类型的漏洞。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/b53b094d1e539b202e1ce8d9327f9e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/0*Tv3aZtNUyDhNvazK"/></div></figure><p id="1734" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我是谁？</p><p id="2b3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我是谁？我不会谈论我的过去，但是，现在，我在一家与金融有关的公司工作，我正在做内部和外部渗透测试，主要是针对应用程序。我可以说，在3个月的时间里，我在不同的公司发现了近30个关键的逻辑漏洞。所以，我会试着向你展示我是如何找到它们的。我是如何发现漏洞给公司带来了数百万美元的损失。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/c8d89cc696291edd79a0ddcb9ef154ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*ndXgAocPUV_q-hok.jpg"/></div></figure><p id="6bdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">为什么逻辑漏洞很重要？</strong></p><p id="3f9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我看来，寻找弱点与风格有关，我认为只关注自己公司的pentester应该在2-3年后离开。为什么？因为几乎每个黑客都有自己检查漏洞的风格。两年后，那双眼睛发现了他风格的所有弱点，你应该用另一双眼睛看得更远。第二个原因是我们在2022年，我认为在同一家公司工作10年已经过时了。最重要的原因是，总是不同的应用程序，系统和人会教你不同的东西，你必须退出你的舒适区。当然，你可以和自己一起努力提高自己，但真实的区域总是会推动你进一步学习。</p><p id="2410" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有一种风格是寻找应用程序的逻辑以及如何打破它们。</p><p id="cafb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑漏洞之所以有价值，你应该去寻找，是因为没有自动化的工具来检查逻辑bug，因为机器学习还没有学会学习。所以这就是为什么你必须学习应用程序做什么，为什么你不应该是一个自动化的机器人。；)</p><p id="afb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我从哪个窗口看？</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ku"><img src="../Images/bcd674e6b633fc2e791577848d57908f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OBbx8ZuW7STHxmeH.jpg"/></div></div></figure><p id="3a74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以正如我所说的，我讨厌随意入侵。我的意思是，我讨厌在不了解应用程序的情况下尝试XSS、SQL有效负载或类似的东西。我知道你听说枚举是关键。但不仅仅是认证考试或者盒子。在现实生活中，如果你想知道你在黑什么，你应该了解应用程序是做什么的。</p><p id="e02c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我没有使用任何路线图来列举应用程序或网络系统。然而，我可以建议在这个领域的新的人下面的链接。在你有自己的风格之前，你需要跟随人们的方式去学习。</p><div class="kz la gp gr lb lc"><a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web#step-by-step-web-application-discovery" rel="noopener  ugc nofollow" target="_blank"><div class="ld ab fo"><div class="le ab lf cl cj lg"><h2 class="bd ir gy z fp lh fr fs li fu fw ip bi translated">80，443-pentest Web方法</h2><div class="lj l"><h3 class="bd b gy z fp lh fr fs li fu fw dk translated">服务器的已知漏洞:运行的版本。响应的HTTP头和cookies可能是…</h3></div><div class="lk l"><p class="bd b dl z fp lh fr fs li fu fw dk translated">book.hacktricks.xyz</p></div></div><div class="ll l"><div class="lm l ln lo lp ll lq kr lc"/></div></div></a></div><p id="721d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将来，我会在gitbook上发布我的笔记，所以不要忘记在这里查看我是否编辑过。</p><p id="ee97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">开发者在构建应用时是如何思考的？</strong></p><p id="4e1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我经历过一个有趣的商店，我想告诉你。有了这些，我想你会明白黑客和开发者的主要区别。</p><p id="a172" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">去年，我在一个在线购物应用程序中发现了一个关键的IDOR，我联系了构建它的开发人员之一，以便一起修复它。会上有趣的事情是。</p><blockquote class="ls"><p id="f818" class="lt lu iq bd lv lw lx ly lz ma mb kk dk translated">~开发者通过伪代码思考~</p><p id="8d47" class="lt lu iq bd lv lw lx ly lz ma mb kk dk translated">如果客户id是1234，</p><p id="c8f5" class="lt lu iq bd lv lw lx ly lz ma mb kk dk translated">获取1234的信息，</p><p id="a761" class="lt lu iq bd lv lw lx ly lz ma mb kk dk translated">如果客户id是5678，</p><p id="929a" class="lt lu iq bd lv lw lx ly lz ma mb kk dk translated">获取5678的信息。</p></blockquote><p id="e275" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">它看起来不像马车，对吧？至少对开发商来说不是。因为他觉得我们通过1234 id获取，应用发送5678信息的时候有问题。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mh"><img src="../Images/593896aa10e21dde33bf6417cacf15e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_DuOLsA3tsjRdDMn.jpg"/></div></div></figure><p id="e70a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是开发商没有考虑到一件事。我们正在使用1234的会话获取5678的信息。问题从那里开始...</p><p id="d2ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">逻辑错误从哪里开始，如何发现？</strong></p><p id="5ea7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就我讲的，都是关于为什么要学应用逻辑。现在我们来打破它们。如果你理解了应用程序的逻辑，你应该思考我们如何打破它的逻辑来使用它。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/19315b59be3421031ea17d903f219d1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*3flUTmyF_REdO1lH.jpg"/></div></figure><p id="b9ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设有一个登录面板，该面板有一些忘记密码的链接。</p><p id="eb36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该创建帐户来测试它。别忘了，首先我们要理解他们，然后我们要打破他们！</p><p id="7352" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们看起来登录是清楚的，但是当我们检查忘记密码部分时，我们看到当我们单击忘记密码时，它说请输入您的狗的名字或他们想要的任何独特的东西。</p><p id="faae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您应该检查响应和请求，以便理解它们如何控制变量，以及我们是否可以操纵它们。</p><p id="ce9a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你知道它是JSON或者SQLite，你不应该找到任何东西，你应该在google和payload上研究黑客和绕过技术。(【https://github.com/swisskyrepo/PayloadsAllTheThings】T4)</p><p id="9bfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，大多数研究应该是关于理解应用。黑客90%理解它，10%利用它。谷歌是我们最好的朋友，永远不要忘记用它来研究。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/2b9f768ff5be2138d5a54e8217debcea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/0*b5AYj-priyfmXV3l.jpg"/></div></figure><p id="534e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们回到我们的例子，我们检查请求和响应，有一个控制参数检查狗的名字。我们应该明白什么反应是可以的，什么是不可以的。如果应用程序发送了不唯一的内容，或者黑客可以找到它，则存在逻辑帐户接管漏洞。因为即使开发人员检查请求输入，开发人员通常也会忘记黑客可以操纵响应。如果黑客可以在响应中找到密钥，他就可以操纵响应。不要对开发者感到震惊，这些耳朵听得太多了。:D他们的思维方式确实和我们不同。也许来自每个人:D</p><p id="d177" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二个例子:</strong></p><p id="59f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这并不是一个真正的逻辑错误，然而，我把它放在这里是为了向你展示你在黑客攻击时应该如何思考。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/28478b0876064d74f12236830c7e89cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/0*W5qlzY_hJfOOMQ-L"/></div></figure><p id="01d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我正在测试一个网站，我看到有上传文件的功能。首先，我试着和大家一样上传了一个shell。但是后来我发现有一个关于解析的错误。错误是我们仅次于谷歌的第二好朋友。他们是开发商的敌人，敌人的敌人是我们的朋友。:)他们给我们关于应用程序的信息，这是黑客攻击的黄金。在此之前，我做了枚举，我知道这是一个ASP.net应用程序，我们正在上传xslx文件，然后它解析它，在应用程序的另一部分显示给我们。</p><p id="c5ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我看到这里时，解析错误说我们找不到需要解析的部分。我开始通过谷歌研究ASP.NET是如何解析xslx文件的。</p><p id="838c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我看到，当我们解压缩xlsx文件时，有一个XML格式的文件，它包括xslx的标题。(excel应用程序的xslx部分)和ASP.NET代码，在里面找。</p><p id="bc49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其次，我想我怎么能伤害它，我能在里面放什么？</p><p id="b188" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为它是一个XML文件，我想我可以尝试XXE注射，但是如果你是新的，你应该寻找谷歌，我如何通过XML攻击。当你学会了它，在下一次你找到它的时候，你会像我一样思考。然后，我在其中创建了我的有效载荷，并重新构建了xlsx，我就可以在应用程序中运行我的代码了。</p><p id="9039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个攻击的例子:</p><p id="e44c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://www.4armed.com/blog/exploiting-xxe-with-excel/" rel="noopener ugc nofollow" target="_blank">https://www.4armed.com/blog/exploiting-xxe-with-excel/</a></p><p id="e22f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://github.com/swisskyrepo/PayloadsAllTheThings" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">让我们创建一个路线图吧！</strong> </a></p><p id="a54e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1-了解应用程序的目标，以及它想为人类做什么。</p><p id="481f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2-列举应用程序的所有部分，并了解有多大。</p><p id="2154" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3-了解应用程序的特性，它有什么样的特性，会出现什么样的漏洞。你迟早会在这方面做得更好。</p><p id="fec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4-开发人员在构建我们正在研究的功能时是如何思考的，我们如何将它用于其他事情？检查请求和响应参数。</p><p id="ac26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5-不要觉得学习过程是浪费时间，试着去学习app是做什么的，有哪些功能可以错过开发者。</p><p id="73a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要害怕思考，不要将一切自动化。</p><p id="8b5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">7-从邪恶的角度思考。是的，有时候你应该从窗户进入家里。也许你必须成为圣诞老人。:)</p><p id="5ad0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">8-不要失去希望，每个由人类构建的应用程序甚至openai都收集人类的程序，以便创建程序。别忘了，如果有人类，就一定会有错误。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/7a36477dd005d6547f323b84ec08b5e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*2a0ybq7HA7kMSmYS.jpg"/></div></figure><p id="3a13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道这就像搏击俱乐部的规则。我们不谈论搏击俱乐部的规则是。</p><p id="ec32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">！！了解应用程序做什么，并尝试做其他事情！！</p><p id="4710" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最终:</strong></p><p id="dd3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读，我独自一人在咖啡馆，我决定解释黑客逻辑和寻找逻辑漏洞的一些部分。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi mm"><img src="../Images/91f69a0ae5e39f402b758d9996be6837.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*2iS8fO8hGO37iiCR.jpg"/></div></div></figure><h1 id="506a" class="mn mo iq bd mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk bi translated">希望你喜欢它！</h1></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><h2 id="39ae" class="ns mo iq bd mp nt nu dn mt nv nw dp mx jy nx ny nb kc nz oa nf kg ob oc nj od bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae mj" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>