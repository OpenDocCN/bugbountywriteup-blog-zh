<html>
<head>
<title>Module-1 | Introduction -Pentesting &amp; Bypassing AWS/Azure/GCP Cloud WAF Fun &amp; Profit</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模块1 |简介-测试和绕过AWS/Azure/GCP云WAF的乐趣和收益</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/module-1-introduction-pentesting-bypassing-cloud-waf-fun-profit-75f315951aa8?source=collection_archive---------1-----------------------#2022-05-16">https://infosecwriteups.com/module-1-introduction-pentesting-bypassing-cloud-waf-fun-profit-75f315951aa8?source=collection_archive---------1-----------------------#2022-05-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="a831" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">为什么你不应该相信云WAF？</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/086e6b956c42762ff161e76d98eda1c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-rZYQ4hufBSXDednAQ3XqQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">感谢<a class="lf lg ep" href="https://medium.com/u/ff26ea5d4b2c?source=post_page-----75f315951aa8--------------------------------" rel="noopener" target="_blank">地米斯托克利</a></figcaption></figure><h2 id="9f7b" class="lh li iq bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">简介和目标</h2><p id="8225" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lq mf ke kf lu mg ki kj ly mh km kn ko ij bi translated">web应用程序防火墙(WAF)或WAF设备通过运行应用程序或服务来提供安全性，从而阻止不符合防火墙策略的恶意调用、输入和输出。今天，由于云架构的增加，多个云提供商正在提供他们自己的托管WAF，该WAF与他们的技术(如负载平衡等)深度集成。</p><p id="2eb2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">WAF可以分为三大类:</p><ol class=""><li id="01e5" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mn mo mp mq bi translated">基于主机的Web应用程序防火墙</li><li id="547e" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mn mo mp mq bi translated">基于网络的Web应用防火墙</li><li id="13cc" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mn mo mp mq bi translated">云和混合Web应用防火墙</li></ol><p id="ad80" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">第一类，基于主机的web应用程序防火墙(HWAF)是作为web服务器的模块安装的。与基于硬件的WAFs相比，这是一个非常便宜的解决方案，WAFs是为小型web应用程序设计的。然而，存在大量的资源利用，因此会导致性能问题。</p><p id="4940" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">第二类是基于网络的web应用程序防火墙(NWAF ),传统上是基于硬件的，并且由于本地安装而具有减少延迟的优点。这意味着NWAF安装在靠近应用服务器的地方，很容易访问。</p><p id="77f6" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">下一个类别与第一个和第二个有很多不同，是基于云的WAFs，顾名思义，这些防火墙是基于云的。云WAF与常规WAF非常相似，但它用于防止对云环境的攻击。</p><blockquote class="jn jo jp"><p id="4019" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated"><strong class="jt ir">这里我们将讨论基于云的WAF。</strong></p></blockquote><p id="1687" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">另外，<a class="ae mw" href="https://www.globaldots.com/resources/blog/what-is-cloud-based-web-application-firewall-waf/" rel="noopener ugc nofollow" target="_blank">基于云的晶圆技术是</a>:</p><ul class=""><li id="5194" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated">快速部署</li><li id="1612" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">易于设置</li><li id="41b8" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">随增长付费的服务</li><li id="03e6" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">管理起来不太复杂</li><li id="8b0c" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">易于集成</li><li id="aba2" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">可扩展且有弹性</li><li id="0183" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">更好的监控</li><li id="532e" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">访问审计日志</li><li id="9ad4" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">分析学</li></ul><p id="39ad" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">通过使用云WAFs，客户端不需要对其系统进行任何软件或硬件更改和调整，并且可以通过应用自定义规则和决定保护的积极程度来成功保护其网站免受威胁。</p><p id="50bf" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">目前，有一种称为托管规则集的东西，由云提供商提供和管理，称为托管规则集。每个云提供商使用其自定义配置来运行云WAF规则引擎。因此，结果取决于不同的云提供商。</p><p id="5740" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">云WAF的安全特性:</p><ul class=""><li id="f3a3" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated">针对可映射到OWASP Top 10的攻击的防护。</li><li id="7ba7" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">防范基于多层应用程序的攻击。</li><li id="51b2" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">针对第7层DDOS、SQL注入、跨站点脚本和零日web应用攻击的地理位置攻击保护。</li><li id="fa50" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">防范HTTP(s)攻击。</li><li id="3651" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">基于Bot的攻击</li></ul><h2 id="ad78" class="lh li iq bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">网络服务器和晶圆放置</h2><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi my"><img src="../Images/25b0410fa17544028f69771c57143277.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*9NE45w4sPybimi7GdtlHPA.png"/></div></figure><p id="d4e7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">云WAF可以部署在CDN解决方案、应用负载平衡器、API网关之上。例如，AWS WAF与Amazon CloudFront、4我们的全球内容交付网络(CDN)服务以及用于弹性负载平衡的应用负载平衡器选项一起工作。</p><p id="a208" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">WAFs可以在不同的模式下运行，包括黑名单方法(消极安全)、白名单方法(积极安全)和混合方法。</p><ul class=""><li id="6644" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated">黑名单:这种方法保护web应用程序免受已知的攻击和特定的规则。通过使用基于规则的方法，这可以用来防止来自已知有效负载的攻击。例如:要构建黑名单规则，使用字符串匹配条件，然后在匹配时阻止请求。</li></ul><pre class="kq kr ks kt gt mz na nb nc aw nd bi"><span id="25e6" class="lh li iq na b gy ne nf l ng nh">If HEADER, User-Agent CONTAINS Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:92.0) Gecko/20100101 Firefox/92.0</span></pre><p id="20bb" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">这种方法很容易被绕过，因为攻击者总是可以修改/欺骗有效载荷，而且它也不能防止任何类型的零日攻击。</p><ul class=""><li id="3adb" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated">白名单:这种方法也使用签名，但也应用逻辑决策，并允许符合特定规则/标准的流量。这意味着只有符合规则的指定流量才被允许，其他类型的流量(合法或无效)将被丢弃。这种方法需要不断修改，并且由于云提供的恒定规则/值，这被认为不是健康的方法。例如-允许重定向的域的白名单(如果没有列出匹配的值，则阻止请求)。</li></ul><pre class="kq kr ks kt gt mz na nb nc aw nd bi"><span id="9d76" class="lh li iq na b gy ne nf l ng nh">QUERY_STRING URL_DECODE CONTAINS target=https://example.com.</span></pre><ul class=""><li id="25a9" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated">混合:据我所知，这被认为是最好的方法，因为它同时使用了黑名单和白名单方法，允许合法流量并以最小的误报阻止恶意流量。</li></ul><h2 id="fcbe" class="lh li iq bd lj lk ll dn lm ln lo dp lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h2><p id="77fc" class="pw-post-body-paragraph jq jr iq jt b ju md jw jx jy me ka kb lq mf ke kf lu mg ki kj ly mh km kn ko ij bi translated">有多种测试方法可以对任何云提供商的WAF执行黑盒测试或灰盒测试。Web应用程序防火墙根据规则对所有可能影响网络的潜在威胁做出智能响应。</p><blockquote class="jn jo jp"><p id="bed5" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">云上的web服务正在增加，因此需要对云提供商提供和实现的WAF进行测试。同样，作为客户，每个客户都应该清楚他们所支付的保护级别。盲目地，我们不能在没有测试情况下支持任何晶片。因此，在渗透测试中理解WAF旁路变得非常重要。该解决方案必须在HTTP/HTTPS层保护web应用程序。我们将学习cloud WAF来检测/预防OWASP十大威胁。</p></blockquote><p id="244e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated">在本系列的后面，我们将研究一种绕过WAFs的实用方法，作为我们渗透测试的一部分，当然，还有云WAFs中工作和缓解背后的理论。</p><p id="0487" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lq kd ke kf lu kh ki kj ly kl km kn ko ij bi translated"><strong class="jt ir">参考:</strong></p><ul class=""><li id="241c" class="mi mj iq jt b ju jv jy jz lq mk lu ml ly mm ko mx mo mp mq bi translated"><a class="ae mw" href="https://www.cloudflare.com/en-in/learning/ddos/glossary/web-application-firewall-waf/" rel="noopener ugc nofollow" target="_blank">https://www . cloud flare . com/en-in/learning/DDOS/glossary/we B- application-firewall-waf/</a></li><li id="10cb" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated"><a class="ae mw" href="https://avinetworks.com/what-is-a-web-application-firewall/" rel="noopener ugc nofollow" target="_blank">https://avinetworks.com/what-is-a-web-application-firewall/</a></li><li id="dcf9" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated"><a class="ae mw" href="https://www.radware.com/products/cloud-waf-service/#:~:text=Radware's%20Cloud%20WAF%20provides%20enterprise,evolving%20threats%20and%20protected%20assets" rel="noopener ugc nofollow" target="_blank">https://www . Radware . com/products/cloud-waf-service/#:~:text = Radware的% 20Cloud % 20WAF %提供%20enterprise、evolving % 20 threats % 20和%20protected%20assets </a>。</li><li id="5731" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated"><a class="ae mw" href="https://www.radware.com/getattachment/a7598bdf-f1d2-4e09-acbe-53fd60e315eb/26d695b1-b4a3-41d8-ab4e-01e705ea9638.pdf.aspx" rel="noopener ugc nofollow" target="_blank">https://www . radware . com/get attachment/a 7598 BDF-f1 D2-4 e09-acbe-53fd 60 e 315 EB/26d 695 B1-b4a 3-41d 8-ab4e-01e 705 ea 9638 . pdf . aspx</a></li><li id="9e7d" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">其他参考资料将在后面分享。</li><li id="c3c2" class="mi mj iq jt b ju mr jy ms lq mt lu mu ly mv ko mx mo mp mq bi translated">感谢<a class="lf lg ep" href="https://medium.com/u/ff26ea5d4b2c?source=post_page-----75f315951aa8--------------------------------" rel="noopener" target="_blank">地米斯托克利</a>，我将会继续维护这个以及未来的博客。</li></ul></div></div>    
</body>
</html>