<html>
<head>
<title>TryHackMe Basic Pentesting Walkthrough.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe基本测试演练。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-basic-pentesting-walkthrough-7817c719fd04?source=collection_archive---------1-----------------------#2020-08-06">https://infosecwriteups.com/tryhackme-basic-pentesting-walkthrough-7817c719fd04?source=collection_archive---------1-----------------------#2020-08-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9a5a8aaec1cc8787ea2b0892da767fac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9fJZlTYSE-QBB6eizANGrQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk translated">从tryhackme.com取回</figcaption></figure><ol class=""><li id="faa2" class="kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt bi translated"><strong class="ke ir"> <em class="ku">侦察</em> </strong></li></ol><p id="6108" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">我们首先要做的是扫描。让我们运行两次Nmap扫描:</p><ul class=""><li id="fffc" class="kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp lk kr ks kt bi translated"><strong class="ke ir">Nmap-sV-sC-O&lt;IP-addr&gt;-oN basic _ scan . Nmap</strong></li><li id="5a68" class="kc kd iq ke b kf ll kh lm kj ln kl lo kn lp kp lk kr ks kt bi translated"><strong class="ke ir">Nmap-script = vuln&lt;IP-addr&gt;-oN vuln _ scan . Nmap</strong></li></ul><p id="220d" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">第一次Nmap扫描非常类似于-A(主动)扫描，但它不执行traceroute。第二个是为受害者寻找潜在的攻击媒介。</p><p id="8414" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">结果如下图所示:</p><p id="038c" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">基本Nmap扫描</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/627e4887a77528900585fa29994f82ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vt9xagAN-x2iZiEA53q0Lw.png"/></div></div></figure><p id="2054" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">页（page的缩写）在美国，vuln扫描没有揭示任何有价值的信息</p><p id="d03e" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">下一步是检查托管在端口80上的网站内容。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/6f9a3ae0a1e0d35c111fe539d9c98b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_9ZQB4uRgnqk-pHs9pYEWQ.png"/></div></div></figure><p id="3e27" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">这个网站似乎还处于维护或创建阶段。在这两种情况下，我们都有希望找到一些开发人员笔记。为了继续我们的侦察，让我们运行GoBuster来查找服务器上的任何目录。</p><p id="8b6f" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">语法如下:</p><p id="ca0c" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir">gobuster dir-u&lt;URL&gt;-w/usr/share/word lists/dirb/common . txt-o directory . txt</strong></p><p id="d80c" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir">目录</strong>指定目录搜索过程</p><p id="f9e3" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> -u </strong>指向网站网址</p><p id="7a63" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> -w </strong>是常用目录的单词表</p><p id="c1de" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">GoBuster结果:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/3e18a86be5ea170595720f83c6cd8f30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WVdPDon96mwGZPxqWMonRw.png"/></div></div></figure><p id="47f6" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">/发展看起来很有前景。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/a8849782ee425baafad5c10e893c810d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*omzPAdtn76DP-CQGMePxOA.png"/></div></div></figure><p id="050c" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">让我们检查两个txt文件的内容:</p><p id="d2bd" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> dev.txt </strong></p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/b974ddaa54bdfc23be192790ba723485.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S3TM8B7QbrnIAx8O04aZJQ.png"/></div></div></figure><p id="fbb4" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> j.txt </strong></p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/1c511cb0c7d912e530c1cbe0d3b2d3bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gavyZYiMVxiEYqbtI_iO3A.png"/></div></div></figure><p id="36a0" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">正如我们之前猜测的那样，这里是开发人员笔记。显然，网络服务器用户的用户名以“j”和“k”开头。我们将来肯定会用到这些信息。此外，K先生说“SMB已经配置好了”Nmap扫描证实了这一点。进一步试验的方向将是那个方向。</p><p id="9791" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> <em class="ku"> 2。SMB枚举</em> </strong></p><p id="e973" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">对于SMB枚举，将使用Nmap脚本引擎(NSE)。让我们来看看可用的脚本:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/283f2bd4aa4c1f62236ac6899c5de7bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r8JZ9Dc7RCLhsOA3pXjuBA.png"/></div></div></figure><p id="832f" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">为了获得尽可能多的信息，我们可以使用以下命令运行所有这些脚本:</p><p id="ff3c" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir">nmap-script = SMB-enum *&lt;IP-addr&gt;-oN SMB _ enum . nmap</strong></p><p id="9d54" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">该命令的结果显示在下面的屏幕截图中:</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/0ddf00b664c66ce9cb492e277880ae64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8jPVIlICxI6g9SecOsozDw.png"/></div></div></figure><p id="97eb" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">我们可以清楚地看到，有匿名和$IPC隐藏的股份。$IPC共享支持进程间通信以及不需要用户名或密码的匿名用户登录。通过使用<strong class="ke ir"> smbclient </strong>命令并访问匿名共享，我们可以利用这一点。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/8c00a90ed4d1807479abcb5b3797d95a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yXDBzdjHy_RgbqXW-0CVbg.png"/></div></div></figure><p id="e5cc" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">staff.txt可能包含一些有用的信息，所以让我们用get staff.txt命令将它输入到我们的计算机中。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/883ded45717909d2f80a83e974b56cf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xPEyyW40ZZWbLBoJ9AUmbw.png"/></div></div></figure><p id="5a57" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">staff.txt文件已经复制到本地主机上的当前目录中。</p><p id="9e09" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">让我们来看看staff.txt文件的内容。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/43fdd83ff9ee550a0a6e16a6a7ca2781.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGyzfpMA4YaqxbM38Pv4vg.png"/></div></div></figure><p id="3659" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">似乎我们已经发现“k”和“j”用户首先出现在开发笔记中。由于SSH端口是打开的，我们从Kay note (j.txt)中知道Jan有一个弱密码，让我们运行hydra来破解Jan的密码并进入服务器。</p><p id="86d8" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> <em class="ku"> 3。进入目标</em> </strong></p><p id="5795" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">让我们构建九头蛇指挥部:</p><p id="58b0" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir">九头蛇Jan-P/usr/share/wordlits/rock you . txt ssh://&lt;IP-addr&gt;T5】</strong></p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/1eea5e1c19172aef42ea2e7b875bb9a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oW1eLUEzRQ6CkI63OghwXA.png"/></div></div></figure><p id="f48f" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">现在，我们可以使用SSH使用jan凭证登录系统。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/38e499282b04aac3628cc3906aa25e35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SakSVlRp7MAkZeq8fWRCJw.png"/></div></div></figure><p id="e428" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated"><strong class="ke ir"> <em class="ku"> 4。权限提升</em> </strong></p><p id="4e98" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">在不同的文件夹中移动并寻找线索，我们可以在kay目录中找到自己。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/5f1db33f7ae350bfc9d3ed3348d46f2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mdWSUT0gBNMytVwOFeQo_A.png"/></div></div></figure><p id="1fc0" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">有一个pass.bak文件jan无法访问。然而，隐藏的。ssh目录对Everyone组具有“读取”权限。</p><p id="99fd" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">去那里揭示kay的RSA密钥，我们可以使用rsync或scp命令传输它。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mi"><img src="../Images/6d4a713f29deb7a46e87d343bdf147bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bVDrKstsgQj7Qid3bQ62kQ.png"/></div></div></figure><p id="f559" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">可以清楚地看到，id_rsa文件已经被传输到本地机器上，现在我们可以使用这个密钥来访问kay的用户帐户。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/2c4f960169d14beaefb8482f63ddc6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MSHI9-Qf5ZgjhUE7OKAzAw.png"/></div></div></figure><p id="2915" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">似乎kay的RSA密钥受密码保护。可以用开膛手约翰密码破解工具解决。</p><p id="2954" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">有一个名为ssh2john.py的专门的John The Ripper工具，它可以从ssh私钥中提取可破解的哈希。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/d4d9b42fa1892617c91efe1c62e6259f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hBIC_jbEKYpjro9e3dBS9Q.png"/></div></div></figure><p id="08b9" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">从上面的输出中，我们可以看到SSH私有密钥散列以$1$开始，这表明散列是由MD5散列算法生成的。</p><p id="c8e1" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">现在，我们可以使用标准的John The Ripper来破解这个散列并提取SSH私有密钥密码短语。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ml"><img src="../Images/f3dd2bdfcffd0d3494e2303ddd66a6c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vHHSpc78_D8q-oT2bpkS6g.png"/></div></div></figure><p id="a1b3" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">凯的SSH私钥密码是<strong class="ke ir">蜜蜡</strong>。</p><p id="657a" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">让我们再试一次宋承宪凯的用户帐号。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/1f5cd38bcf675afd55b744e12a07755b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Fp8Hi-cXGrCMYCFG5NDJg.png"/></div></div></figure><p id="6265" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">瞧啊。</p><p id="8141" class="pw-post-body-paragraph kv kw iq ke b kf kg kx ky kh ki kz la kj lb lc ld kl le lf lg kn lh li lj kp ij bi translated">剩下的最后一件事是创建pass.bak文件。</p><figure class="lr ls lt lu gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/ed0e0ecc91340f31ca2721251a3276f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3mzlWLWaiOsLfWHkpM2CA.png"/></div></div></figure></div></div>    
</body>
</html>