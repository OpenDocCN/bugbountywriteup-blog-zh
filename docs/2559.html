<html>
<head>
<title>Write-up: Authentication bypass via information disclosure @ PortSwigger Academy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐:通过信息披露绕过认证@ PortSwigger Academy</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/write-up-authentication-bypass-via-information-disclosure-portswigger-academy-f3998ded54e?source=collection_archive---------1-----------------------#2022-11-24">https://infosecwriteups.com/write-up-authentication-bypass-via-information-disclosure-portswigger-academy-f3998ded54e?source=collection_archive---------1-----------------------#2022-11-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f8d482022e0da534898ac18d82dc1538.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vQ88BxaWtneaeag3.png"/></div></div></figure><p id="58ba" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇关于通过信息披露绕过实验室<em class="kw">认证</em>的文章是我为<a class="ae kx" href="https://portswigger.net/web-security" rel="noopener ugc nofollow" target="_blank"> PortSwigger的Web安全学院</a>所做的系列演练的一部分。</p><p id="accd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">学习路径</strong>:服务器端主题→信息披露</p><div class="ky kz gp gr la lb"><a href="https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-authentication-bypass" rel="noopener  ugc nofollow" target="_blank"><div class="lc ab fo"><div class="ld ab le cl cj lf"><h2 class="bd ir gy z fp lg fr fs lh fu fw ip bi translated">实验室:通过信息披露绕过身份认证|网络安全学院</h2><div class="li l"><h3 class="bd b gy z fp lg fr fs lh fu fw dk translated">练习利用现实目标的弱点。记录你从学徒到专家的进步。看哪里…</h3></div><div class="lj l"><p class="bd b dl z fp lg fr fs lh fu fw dk translated">portswigger.net</p></div></div><div class="lk l"><div class="ll l lm ln lo lk lp jw lb"/></div></div></a></div><p id="312c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Python脚本:<a class="ae kx" href="https://github.com/frank-leitner/portswigger-websecurity-academy/blob/main/06_information_disclosure/Authentication_bypass_via_information_disclosure/script.py" rel="noopener ugc nofollow" target="_blank"> script.py </a></p><h1 id="ab20" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">实验室描述</h1><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/4ef6d8473013e0b404a5dbd678332697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qNxHwWn1YieJBqhy.png"/></div></div></figure><h1 id="4269" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">步伐</h1><h1 id="013b" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">分析</h1><p id="28f1" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">lab应用程序是一个商店网站，里面有非常有趣的产品。像往常一样，第一步是检查网站。</p><p id="0051" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">浏览了一下并用已知的凭证登录后，没有什么有趣的东西出现。该检查打嗝时的请求了。那里也没什么有趣的东西。</p><p id="86c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在之前的一些实验中，管理端点位于<code class="fe my mz na nb b">/admin</code>下。但是为了避免使用这些知识，我可以使用多种内容发现方法。Burp Professional附带了这样的功能，并且一些好的免费工具也允许内容发现。</p><p id="3372" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在这里使用的是<a class="ae kx" href="https://github.com/ffuf/ffuf" rel="noopener ugc nofollow" target="_blank"> ffuf </a>和<a class="ae kx" href="https://github.com/danielmiessler/SecLists" rel="noopener ugc nofollow" target="_blank"> SecLists </a>提供的大词表:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/edbc295f7933ae2c89e50a7231911199.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xgspX7wYzLEmbff0.png"/></div></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="d85b" class="lq lr iq bd ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj no ml mm mn bi translated">访问端点</h1><p id="8bdc" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">我访问这个页面是为了收到这条消息:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/9b398a70e1fa01617f38588b2eb520f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:698/format:webp/0*SvSpzYBu6IGOSp-J.png"/></div></figure><p id="2a48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">没有给出更多信息。</p><p id="3f8d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将原始IP传播到web服务器的一种常见方式(在代理或负载平衡场景中使用)是<code class="fe my mz na nb b">X-Forwarded-For</code>报头。然而，这在这里是行不通的(而且实验室的描述表明它是一个定制的头)。</p><p id="44d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">两个HTTP动词可以用来获得附加信息，<code class="fe my mz na nb b">OPTIONS</code>和<code class="fe my mz na nb b">TRACE</code>。后者产生了一个有趣的结果:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nq"><img src="../Images/3b83d5a71f716a98848c4c2dc4440eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3CkaXWhpOp0eMCml.png"/></div></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="1e0a" class="lq lr iq bd ls lt nk lv lw lx nl lz ma mb nm md me mf nn mh mi mj no ml mm mn bi translated">提供自定义标题</h1><p id="9651" class="pw-post-body-paragraph jy jz iq ka b kb mt kd ke kf mu kh ki kj mv kl km kn mw kp kq kr mx kt ku kv ij bi translated">现在我知道了标题，访问管理界面就变得容易了。我需要确保每个请求都发送了自定义标题，所以我添加了一个<code class="fe my mz na nb b">Match and Replace</code>规则，总是将这个新标题添加到请求中。</p><p id="03e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我使用<code class="fe my mz na nb b">127.0.0.1</code>作为内容来欺骗应用程序，让它相信请求来自<code class="fe my mz na nb b">localhost</code>。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/64e09c7d941a0a892bd4b2951b9d4f6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8X66A2djiQd0-nsK.png"/></div></div></figure><p id="d68e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在只需在浏览器中重新加载页面，访问管理面板并删除用户<code class="fe my mz na nb b">carlos</code>即可解决实验问题:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ns"><img src="../Images/3d3e3be4ec44de29bdc7385872a96893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NihlO1YNGkLLJ_an.png"/></div></div></figure></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><p id="f8ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">原载于【https://github.com】<a class="ae kx" href="https://github.com/frank-leitner/portswigger-websecurity-academy/tree/main/06_information_disclosure/Authentication_bypass_via_information_disclosure" rel="noopener ugc nofollow" target="_blank"><em class="kw"/></a><em class="kw">。</em></em></p><p id="b56c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe my mz na nb b"><a class="ae kx" href="https://medium.com/@frank.leitner/membership" rel="noopener">New to Medium? Become a Medium member to access all stories on the platform and support me at no extra cost for you!</a></code></p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h2 id="d844" class="nt lr iq bd ls nu nv dn lw nw nx dp ma kj ny nz me kn oa ob mi kr oc od mm oe bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kx" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>