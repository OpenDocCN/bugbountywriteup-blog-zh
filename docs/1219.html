<html>
<head>
<title>Unauthenticated Account Takeover Through Forget Password</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过忘记密码未经验证的帐户接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/unauthenticated-account-takeover-through-forget-password-c120b4c1141d?source=collection_archive---------1-----------------------#2021-04-12">https://infosecwriteups.com/unauthenticated-account-takeover-through-forget-password-c120b4c1141d?source=collection_archive---------1-----------------------#2021-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3a99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我花了整整一个月的时间在一个联邦私人项目上，发现了大量的账户接管。我将分享一个发现。</p><p id="7c61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目标的范围是通配符和未经验证的测试。所以我做的第一件事-&gt;侦察。</p><p id="89d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我启动了结合httpx(<a class="ae kl" href="https://github.com/projectdiscovery" rel="noopener ugc nofollow" target="_blank">https://github.com/projectdiscovery</a>)的子查找器，我发现了大量的子域名，其中一个域名出现了403禁止错误。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/f74d0665d93cc7afaef83d6f4e9b2649.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vh-M9BM2kjzkHdZHpkQBSQ.png"/></div></div></figure><p id="93c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我首先运行的不是ffuf，而是一个简单的谷歌搜索，比如:</p><p id="fa57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">站点:子域此处</p><p id="6289" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它得出了大量的结果</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ky"><img src="../Images/f20cbf23f9e820dd4c6e51a8fd48cff3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5xv_lME186gJuX_Bs8rNg.png"/></div></div></figure><p id="cbb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然有很多登录页面，但我决定寻找第一个结果，那是一个在线发票系统。这个应用程序需要一些id和密码来登录。</p><p id="6fa5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在帮助文章中搜索了关于D * * Ids的内容，我了解到，这是在许可时分配给所有供应商的一个9位数字。</p><p id="d44f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做了谷歌搜索，但没有找到这个特别的id。我最终查看了谷歌图片结果，希望许可可以在一张纸上完成，并可以包含这个id。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi kz"><img src="../Images/abd34881388235ca65d484aa61aa85e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJVsREty1EWhFixwCPvTqA.png"/></div></div></figure><p id="6630" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">酷，我是正确的，许可是通过一份文件完成的，我在信件的主题部分获得了几个有效的D** ID，例如</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi la"><img src="../Images/b3191d89f89017ca24d3e29cd09a7611.png" data-original-src="https://miro.medium.com/v2/resize:fit:368/format:webp/1*KyF6xh5lgUQU7aTAYM97dg.png"/></div></figure><p id="55f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然我现在有了这个ID，我做的第一件事就是强行输入密码，但最终什么也没有得到。</p><p id="a28e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我开始测试忘记密码流，它首先要求D** ID来重置密码。我发现该应用程序使用了两个重置密码的请求，一个用于查询D** ID的密码，另一个在请求本身中向他们的电子邮件ID发送新生成的密码</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lb"><img src="../Images/375b0ddb0b7383974147e510ed7d7822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ijEz-PlHP_bZ0hqmMR6yA.png"/></div></div></figure><p id="4c46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，这不仅暴露了他们的密码，也暴露了他们的电子邮件。使用新生成的密码，我能够登录到他们的帐户。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/1a9dc4710bfa7f481760a6a09a5c7af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybFYgprC4Q1-FRKExQamKw.png"/></div></div></figure><p id="2c50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保持好奇。</p></div></div>    
</body>
</html>