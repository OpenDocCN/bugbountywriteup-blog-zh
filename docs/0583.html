<html>
<head>
<title>Weird Story of Captcha to Rate Limit Bypass</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奇怪的故事验证码的速率限制旁路</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/weird-story-of-captcha-to-rate-limit-bypass-c62690db39a?source=collection_archive---------1-----------------------#2020-05-09">https://infosecwriteups.com/weird-story-of-captcha-to-rate-limit-bypass-c62690db39a?source=collection_archive---------1-----------------------#2020-05-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/d9994eae90fc424d572d788d59268f28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*Rud2cQ1jIWTE3NS4kdmcjg.jpeg"/></div></figure><p id="5202" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">当应用程序没有实现一种机制来限制在X时间量内触发的<strong class="jw ir">封电子邮件和消息的数量时，这个问题通常被认为是速率限制。然而，速率限制不仅仅如此，根据业务逻辑，可能会有多种情况，如<strong class="jw ir"> X评论/消息/邀请的数量或Y时间内的创建/删除操作。</strong></strong></p><p id="7ed8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">另一方面，验证码被认为是一种保护机制，可以<strong class="jw ir">减缓攻击者&amp;在自动触发执行速率限制攻击的请求的过程中创建一个拦截器。</strong></p><p id="cdc3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">嘿，黑客们，在这篇博客中，我将写一个最近发生的奇怪的场景，我不小心绕过了验证码来执行限速。</p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><h1 id="08ef" class="kz la iq bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated"><strong class="ak">简单地说，故事是:</strong></h1><ol class=""><li id="c771" class="lx ly iq jw b jx lz kb ma kf mb kj mc kn md kr me mf mg mh bi translated">忘记了密码，填写了验证码和详细信息</li><li id="2b32" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr me mf mg mh bi translated">使用Burp代理捕获的请求。</li><li id="e779" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr me mf mg mh bi translated"><strong class="jw ir">既没有关闭拦截，也没有转发请求。</strong></li><li id="880e" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr me mf mg mh bi translated">向<strong class="jw ir">入侵者</strong>发送请求，并使用空有效载荷播放了300次。</li><li id="fb41" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr me mf mg mh bi translated">成功！！</li><li id="213a" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr me mf mg mh bi translated">验证码机制正在验证初始请求，该请求在验证码过期之前由代理保留。</li></ol></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="dd2f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我正在开发的应用程序来自一个私人项目，为了保持不泄露策略，让我们将目标命名为<strong class="jw ir">target.com</strong></p><p id="5d34" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">几乎所有的漏洞都在范围之内，所以我开始寻找XSS、伊多斯等，并在第一天就与他们交了好运。第二天当我再次启动时，我忘记了我设置的密码:p所以我去“忘记密码”功能重置我的密码。注意到应用程序正在实现一个验证码来限制自动化。太酷了，让我们尽情享受吧。</p><p id="da68" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我开始通过提供有效的<strong class="jw ir">验证码答案来捕获请求，并试图重复请求<em class="mn">，但失败了。</em> </strong>此外，我继续尝试删除验证码参数，仍然没有成功。</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="ccfd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">接下来我做的事其实是无意的。我捕获了一个新的请求，并将其发送到Repeater并重复它。成功了！怎么会？以前它对我不起作用:/ 我注意到我忘记关闭拦截器并转发请求。我直接关掉了拦截器。令我惊讶的是，一个电子邮件通知弹出，收到两个密码重置电子邮件！事情有些可疑。</p><p id="7445" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我捕获了另一个新的请求，并用代理将它保留下来并发送给入侵者。我用空有效载荷播放了大约200次请求。</p><p id="90db" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我收到了200封邮件。:D验证码和速率限制被绕过；)</p><figure class="mo mp mq mr gt jr"><div class="bz fp l di"><div class="mu mt l"/></div></figure><p id="be11" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> #为什么会这样？</strong></p><p id="19c3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">根据我对该应用程序的理解，该应用程序正在实施一些“未知/本地验证码”，这实际上是在使“验证码”过期之前验证<strong class="jw ir">原始请求(被代理搁置)是否正确。</strong>这会导致攻击者保留原始请求并绕过“忘记密码”的速率限制，从而<strong class="jw ir">在几分钟内触发N封邮件</strong></p></div><div class="ab cl ks kt hu ku" role="separator"><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx ky"/><span class="kv bw bk kw kx"/></div><div class="ij ik il im in"><p id="f26c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">外卖</strong></p><ul class=""><li id="20ba" class="lx ly iq jw b jx jy kb kc kf mv kj mw kn mx kr my mf mg mh bi translated">将新旁路添加到限速旁路列表中</li><li id="a39f" class="lx ly iq jw b jx mi kb mj kf mk kj ml kn mm kr my mf mg mh bi translated">总是试图篡改本地实现的保护机制。他们更容易受到伤害。</li></ul></div></div>    
</body>
</html>