<html>
<head>
<title>CORS one liner command exploiter</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CORS一号班轮司令部剥削者号</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cors-one-liner-command-exploiter-88c06903cca0?source=collection_archive---------1-----------------------#2020-06-08">https://infosecwriteups.com/cors-one-liner-command-exploiter-88c06903cca0?source=collection_archive---------1-----------------------#2020-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="774b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于Bug猎人来说，这是一个非常有用和实用的备忘单，它可以帮助你用各种可能的方法找到CORS的错误配置。只需用你想要的网址替换掉https://example.com的网址。这将帮助您扫描CORS漏洞，而不需要外部工具。你要做的就是把命令复制粘贴到你的终端上，然后手指交叉寻找任何可能的CORS。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/59eb783ede86c9664f2ec0b1d21a6959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2PFPKGOd8mZMYbADbwA4CA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">CORS开发PoC</figcaption></figure><h1 id="3345" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">1个基本原点反射有效负载—(自动)向网站的每个已爬网端点发送请求</h1><p id="bb4f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com"; gau "$site" | while read url;do target=$(curl -s -I -H "Origin: https://evil.com" -X GET $url) | if grep 'https://evil.com'; then [Potentional CORS Found]echo $url;else echo Nothing on "$url";fi;done</code></p><h1 id="8d2a" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">1.2基本原点反射有效负载—(手动)仅在一个端点发送请求</h1><p id="c168" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com";curl -s -I -H "Origin: https://evil.com" -X GET "$site" | if grep 'https://evil.com'; then echo [Potentional CORS Found]; else echo Nothing found;fi</code></p><h1 id="6324" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">2受信任的空来源有效负载—(自动)向网站的每个已爬网端点发送请求</h1><p id="2cf2" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com"; gau "$site" | while read url;do target=$(curl -s -I -H "Origin: null" -X GET $url) | if grep 'Access-Control-Allow-Origin: null'; then echo [Potentional CORS Found] "$url"; else echo Nothing on: "$url";fi;done</code></p><h1 id="c75e" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">2.2受信任的空原始有效负载—(手动)仅在一个端点中发送请求</h1><p id="e148" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com";curl -s -I -H "Origin: null" -X GET "$site" | if grep 'Access-Control-Allow-Origin: null'; then echo [Potentional CORS Found]; else echo Nothing found;fi</code></p><h1 id="b643" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">3白名单中的空原始值有效负载—(自动)向网站的每个已爬网端点发送请求</h1><p id="6efc" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com" ; gau "$site" | while read url;do target=$(curl -s -I -X GET "$url") | if grep 'Access-Control-Allow-Origin: null'; then echo [Potentional CORS Found] "$url"; else echo Nothing on: "$url";fi;done</code></p><h1 id="b6f1" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">3.2列入白名单的空原始值有效负载—(手动)仅在一个端点中发送请求</h1><p id="21d7" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com";curl -I -X GET "$site" | if grep 'Access-Control-Allow-Origin: null';then echo [Potential CORS Found];else echo Nothing found;fi</code></p><h1 id="7f7d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">4原始负载中的受信任子域[ *.example.com ] —(手动)仅在一个端点中发送请求</h1><p id="0a6a" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">url="https://example.com" ; curl -s -I -H "Origin: evil.$url" -X GET "$url" | if grep "Access-Control-Allow-Origin: evil.$url"; then echo [Potential CORS Found]; else echo [No CORS found]; fi</code></p><h1 id="39af" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">4.2原始有效负载[ *.example.com ]中的受信任子域—(自动)向网站的每个已爬网端点发送请求</h1><p id="46f8" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com" ; gau "$site" | while read url;do target=$(curl -s -I -H "Origin: evil.$url" -X GET "$url") | if grep 'Access-Control-Allow-Origin: null'; then echo [Potentional CORS Found] "$url"; else echo Nothing on: "$url";fi;done</code></p><h1 id="e21c" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">5滥用不正确的域验证—(注意:仅用域替换URL没有http(s)协议)—(手动)</h1><p id="b0db" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="example.com";curl -s -I -H "Origin: https://not$site" -X GET "$site"| if grep "Access-Control-Allow-Origin: https://not$site"; then echo [Potentional CORS Found]; else echo Nothing found;fi</code></p><h1 id="ac0f" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">5.2滥用不正确的域验证—(注意:仅用域替换URL没有http(s)协议)—(自动)向网站的每个已爬网端点发送请求</h1><p id="66cb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com" ; gau "$site" | while read url;do target=$(curl -s -I -H "Origin: https://not$site" -X GET "$url") | if grep 'Access-Control-Allow-Origin: https://not$site'; then echo [Potentional CORS Found] "$url"; else echo Nothing on: "$url";fi;done</code></p><h1 id="697d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">6源域扩展未验证漏洞—(手动)仅在一个端点中发送请求</h1><p id="b7f7" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com";curl -s -I -H "Origin: $site.evil.com" -X GET "$site" | if grep "Origin: Access-Control-Allow-Origin: $site.evil.com"; then echo [Potentional CORS Found]; else echo Nothing found;fi</code></p><h1 id="4887" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">6.2源域扩展未验证漏洞—(自动)向网站的每个已爬网端点发送请求</h1><p id="21f6" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com" ; gau "$site" | while read url;do target=$(curl -s -I -H "Origin: $site.evil.com" -X GET "$url") | if grep "Origin: Access-Control-Allow-Origin: $site.evil.com"; then echo [Potentional CORS Found] "$url"; else echo Nothing on: "$url";fi;done</code></p><h1 id="8b81" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">7高级绕过使用特殊字符+编码—(手动)仅在一个端点发送请求</h1><p id="9a7f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated"><code class="fe mf mg mh mi b">site="https://example.com";payloads=("!" "(" ")" "'" ";" "=" "^" "{" "}" "|" "~" '"' '`' "," "%60" "%0b") ; for payload in ${payloads[*]}; do target=$(curl -s -I -H "Origin: $site$payload.evil.com" -X GET "$site") | if grep '$site$payload.evil.com'; then echo [+] Payload Reflected: $site$payload.evil.com; else echo Nothing found with: $site$payload.evil.com;fi;done</code></p><h2 id="1aa0" class="mj ld iq bd le mk ml dn li mm mn dp lm jy mo mp lq kc mq mr lu kg ms mt ly mu bi translated">工作流程</h2><p id="0d96" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">如果一行bash命令显示输出，这意味着网站容易受到相应的CORS错误配置的攻击。如果执行时没有显示输出，则没有检测到漏洞。</p><blockquote class="mv mw mx"><p id="550e" class="jn jo my jp b jq jr js jt ju jv jw jx mz jz ka kb na kd ke kf nb kh ki kj kk ij bi translated">更多信息可以在我的Github库<br/><a class="ae kl" href="https://github.com/kleiton0x00/CORS-one-liner" rel="noopener ugc nofollow" target="_blank">https://github.com/kleiton0x00/CORS-one-liner</a>上找到</p></blockquote><p id="861a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">狩猎愉快！</p></div></div>    
</body>
</html>