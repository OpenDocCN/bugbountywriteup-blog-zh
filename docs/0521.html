<html>
<head>
<title>Reflected XSS on microsoft.com subdomains</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反映了microsoft.com子域上的XSS</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/reflected-xss-on-microsoft-com-subdomains-4bdfc2c716df?source=collection_archive---------1-----------------------#2020-03-19">https://infosecwriteups.com/reflected-xss-on-microsoft-com-subdomains-4bdfc2c716df?source=collection_archive---------1-----------------------#2020-03-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/ea9bdd84b1c5771b3c18fd2377275c3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*UtVc8GL47ZNxHKF3AhdzBA.jpeg"/></div></figure><figure class="ju jv jw jx gt jr"><div class="bz fp l di"><div class="jy jz l"/></div></figure><p id="0b11" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">微软回答说，这超出了他们的安全计划的范围，也不认为这是一个安全漏洞，所以我要写一篇关于这一点的文章。</p><p id="19f5" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><em class="ky">“这不符合安全服务的要求，因为它需要用户将恶意代码复制并粘贴到文本字段中，或者修改用户端代码/流量。像这样的自我定位攻击不被视为安全漏洞，因为它需要社会工程来定位另一个用户。”</em></p><p id="9555" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><strong class="kc ir">2020年3月24日更新:</strong></p><p id="7dab" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">微软实际上在3月23日重新评估了被拒绝的漏洞，这些问题实际上符合他们的服务要求。因为我是一个负责任的揭露者，所以这些细节被删除了，直到它们被修补。</p><p id="be99" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><em class="ky">“这份意见书被错误地评估为自我XSS，而不是反映XSS。后来有人告诉我们，这些酒吧确实满足了服务要求。</em></p><p id="9e84" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">带着这个漏洞，我实际上进入了微软的2020年3月新人名人堂部分。从这次经历中得到的教训是，在没有适当上报的情况下，你应该<strong class="kc ir">永远不要</strong>向微软提交反映的XSS，你可以相信我，这有很大的可能性，如下文所述。</p><figure class="ju jv jw jx gt jr gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/0de45ae8be8f5a63c88999117cbd57ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*t_bJvo-uqdueHj5RcHgRiQ.png"/></div></figure><p id="14cc" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><strong class="kc ir">受影响的域:</strong></p><ul class=""><li id="89fe" class="la lb iq kc b kd ke kh ki kl lc kp ld kt le kx lf lg lh li bi translated">activateuat.microsoft.com</li><li id="e644" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">gallery.technet.microsoft.com</li><li id="1ea7" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">ppe.gallery.technet.microsoft.com</li><li id="00b4" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">ppe.code.msdn.microsoft.com</li></ul><p id="4bed" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><strong class="kc ir">你可以用XSS的倒影做什么？</strong> <br/>如果攻击者可以控制在受害者浏览器中执行的脚本，那么他们通常可以完全危及该用户的安全。其中，攻击者可以:<br/> -在应用程序中执行用户可以执行的任何操作。<br/> -查看用户能够查看的任何信息。<br/> -修改用户能够修改的任何信息。<br/> -发起与其他应用程序用户的交互，包括恶意攻击，这些攻击似乎来自最初的受害用户。</p><div class="lo lp gp gr lq lr"><a href="https://portswigger.net/web-security/cross-site-scripting" rel="noopener  ugc nofollow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">什么是跨站脚本(XSS)以及如何防止它？网络安全学院</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">在这一部分，我们将解释什么是跨站点脚本，描述不同种类的跨站点脚本…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">portswigger.net</p></div></div><div class="ma l"><div class="mb l mc md me ma mf js lr"/></div></div></a></div><p id="30e6" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><strong class="kc ir">寻找漏洞:</strong> <br/>找到这样的漏洞并不难。我运行了以下命令:</p><pre class="ju jv jw jx gt mg mh mi mj aw mk bi"><span id="eb02" class="ml mm iq mh b gy mn mo l mp mq"><br/><em class="ky">assetfinder -subs-only microsoft.com | httprobe | cookieless</em></span></pre><p id="5db0" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">资产发现者<a class="ae mr" href="https://github.com/tomnomnom/assetfinder" rel="noopener ugc nofollow" target="_blank">https://github.com/tomnomnom/assetfinder</a>T22】http probe<a class="ae mr" href="https://github.com/tomnomnom/httprobe" rel="noopener ugc nofollow" target="_blank">https://github.com/tomnomnom/httprobe</a>T25】无厨师<a class="ae mr" href="https://github.com/RealLinkers/cookieless" rel="noopener ugc nofollow" target="_blank">https://github.com/RealLinkers/cookieless</a></p><p id="62a6" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">最后一个github库是我创建的一个工具，用于自动化手动测试过程。希望对其他研究也有帮助。</p><p id="85e9" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">什么是无烹饪风格，你如何把它变成XSS的映像？ <br/>本质上这只适用于。NET网站，如果开发人员使用波浪符号来解析资源</p><pre class="ju jv jw jx gt mg mh mi mj aw mk bi"><span id="2891" class="ml mm iq mh b gy mn mo l mp mq"><br/>&lt;script src=”&lt;%= ResolveUrl(“~/Script.js”) %&gt;”&gt;&lt;/script&gt;</span></pre><p id="9268" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">url的无cookieless部分(在下面的示例中为(A(ABCD))在设计上并没有进行HTML编码，这使得攻击者能够逃脱以下URL中HTML标记的上下文</p><p id="1f33" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><a class="ae mr" href="https://gallery.technet.microsoft.com/(A(ABCD))/" rel="noopener ugc nofollow" target="_blank">https://gallery . TechNet . Microsoft . com/(A(ABCD))/</a>这将翻译成&lt;script src = "/(A(ABCD))/script . js "&gt;<br/>并不是所有的字符都被支持，但通过足够的修改，你可以找到一种方法来弹出警告。显然，如果你是一个攻击者，你能做的不仅仅是如前所述的提醒。</p><pre class="ju jv jw jx gt mg mh mi mj aw mk bi"><span id="3434" class="ml mm iq mh b gy mn mo l mp mq"><br/><a class="ae mr" href="https://gallery.technet.microsoft.com/(A(%22onerror='alert%601%60'testabcd))/" rel="noopener ugc nofollow" target="_blank">https://gallery.technet.microsoft.com/(A(%22onerror='alert%601%60'testabcd))/</a></span></pre><p id="2b77" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated">由于其中一些域甚至没有内容安全策略，您实际上可以包含来自第三方位置的脚本，绕过您在无cookie标识符允许的URL长度和字符范围内定义的限制。</p><p id="0ab6" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><strong class="kc ir">要更深入地探究这个问题，请参考这篇令人惊叹的文章</strong><a class="ae mr" href="https://blog.isec.pl/all-is-xss-that-comes-to-the-net/" rel="noopener ugc nofollow" target="_blank">https://blog.isec.pl/all-is-xss-that-comes-to-the-net/</a>和微软的文档:<br/><a class="ae mr" href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.sessionstatesection.cookieless?view=netframework-4.8" rel="noopener ugc nofollow" target="_blank">https://docs . Microsoft . com/en-us/dot net/API/system . web . configuration . session test section . cookieless？view=netframework-4.8 </a></p><h2 id="8814" class="ml mm iq bd ms mt mu dn mv mw mx dp my kl mz na nb kp nc nd ne kt nf ng nh ni bi translated">披露时间表:</h2><ul class=""><li id="5fc9" class="la lb iq kc b kd nj kh nk kl nl kp nm kt nn kx lf lg lh li bi translated">2020年3月17日向微软MSRC提交漏洞</li><li id="8cfd" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">2020年3月19日微软MSRC公司认为公开披露不属于漏洞</li><li id="6dcd" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">2020年3月23日自微软MSRC公司重新评估漏洞以来，隐藏的公开披露事实上满足了他们的服务要求</li><li id="893e" class="la lb iq kc b kd lj kh lk kl ll kp lm kt ln kx lf lg lh li bi translated">问题已经解决</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="ffd2" class="pw-post-body-paragraph ka kb iq kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ij bi translated"><em class="ky">关注</em> <a class="ae mr" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ky"> Infosec报道</em> </a> <em class="ky">获取更多此类精彩报道。</em></p><div class="lo lp gp gr lq lr"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ls ab fo"><div class="lt ab lu cl cj lv"><h2 class="bd ir gy z fp lw fr fs lx fu fw ip bi translated">信息安全报道</h2><div class="ly l"><h3 class="bd b gy z fp lw fr fs lx fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="lz l"><p class="bd b dl z fp lw fr fs lx fu fw dk translated">medium.com</p></div></div><div class="ma l"><div class="nv l mc md me ma mf js lr"/></div></div></a></div></div></div>    
</body>
</html>