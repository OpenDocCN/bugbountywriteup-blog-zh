<html>
<head>
<title>Recipe for a successful phishing campaign (1/2)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">成功网络钓鱼活动的秘诀(1/2)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/recipe-for-a-successful-phishing-campaign-part-1-2-dc23d927ec55?source=collection_archive---------0-----------------------#2020-10-13">https://infosecwriteups.com/recipe-for-a-successful-phishing-campaign-part-1-2-dc23d927ec55?source=collection_archive---------0-----------------------#2020-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4ab5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">链接到第2部分:<a class="ae kl" href="https://medium.com/bugbountywriteup/recipe-for-a-successful-phishing-campaign-part-2-2-68552806dcba" rel="noopener">https://medium . com/bugbountywriteup/recipe-for-a-successful-phishing-campaign-part-2–2–68552806 dcba</a></p><h1 id="49df" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">介绍</h1><p id="14a5" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">网络钓鱼攻击是最先进入的媒介，其技术细节经常被白人和黑帽黑客忽略。</p><p id="f78c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些年来，我在进攻和防守团队中都参与了多次网络钓鱼活动，我从反复试验中学到了很多需要注意的事情。本文将尝试对它们进行总结。</p><h1 id="1453" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">技术科目</h1><p id="6b9c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">即使网络钓鱼活动通常与社会工程有关，但为了取得成功，您需要了解其中的技术成分。我们将涉及的一些主题(表面上)有:</p><ul class=""><li id="d7e3" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk lu lv lw lx bi translated">普通网络钓鱼和鱼叉式网络钓鱼的区别</li><li id="0741" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">SPF、DKIM和DMARC</li><li id="a968" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">OSINT</li><li id="2b47" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">SSL/TLS</li><li id="2bac" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">垃圾邮件过滤器</li><li id="a7f1" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">DNS和MX/SPF/DKIM (txt)记录</li><li id="9791" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk lu lv lw lx bi translated">同形异义攻击</li></ul><h1 id="7017" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">考虑</h1><p id="f7f2" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我知道很大一部分读者只是浏览一篇文章的前几行，所以现在让我给你我能给你的最好的建议。<strong class="jp ir">你需要了解的第一件事是，网络钓鱼攻击不一定要从电子邮件开始</strong>。是的，在这个故事中，我们将主要讨论通过电子邮件进行的网络钓鱼攻击，但是您可以通过多种方式到达网络钓鱼站点。</p><blockquote class="md me mf"><p id="15ca" class="jn jo mg jp b jq jr js jt ju jv jw jx mh jz ka kb mi kd ke kf mj kh ki kj kk ij bi translated">此外，并非每个钓鱼网站都在寻找您的凭据或信用卡，或者让您下载恶意文件。我听到很多人说，只要你不下载任何文件，不在任何地方输入你的凭证/信用卡信息，你就可以到处点击你收到的所有信息。这不是真的。</p></blockquote><p id="9460" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我参加过多次评估，我们的切入点是有人点击他们不应该有的URL，并通过XSS运行脚本。</p><p id="ea01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，他们可能希望您发送请求并代表您执行操作，利用CSRF攻击。</p><p id="d882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">又或许他们只是想用metasploit的浏览器autopwn(<a class="ae kl" href="https://blog.rapid7.com/2015/07/15/the-new-metasploit-browser-autopwn-strikes-faster-and-smarter-part-1/" rel="noopener ugc nofollow" target="_blank">https://blog . rapid 7 . com/2015/07/15/the-new-metasploit-browser-autopwn-strikes-faster-and-smarter-part-1/)</a>之类的东西来利用你过时的浏览器。</p><p id="3bc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也许他们想用牛肉勾你(<a class="ae kl" href="https://beefproject.com/" rel="noopener ugc nofollow" target="_blank">https://beefproject.com/</a>)。</p><p id="f265" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也许这个链接甚至没有网址，而是一个UNC，你的网络内部有人试图传递你的凭证(<a class="ae kl" href="https://github.com/lgandx/Responder-Windows" rel="noopener ugc nofollow" target="_blank">https://github.com/lgandx/Responder-Windows</a>)。</p><p id="417f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也许这是最近由于隔离而在远程会议软件上出现的多次中继攻击之一，在zoom(<a class="ae kl" href="https://thehackernews.com/2020/04/zoom-windows-password.html" rel="noopener ugc nofollow" target="_blank">https://the hacker news . com/2020/04/zoom-windows-password . html</a>)和team viewer(<a class="ae kl" href="https://thehackernews.com/2020/08/teamviewer-password-hacking.html" rel="noopener ugc nofollow" target="_blank">https://the hacker news . com/2020/08/team viewer-password-hacking . html</a>)中</p><p id="853c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以继续，但我会停下来，希望我已经给了你足够的例子来证明这一点。</p><h1 id="b0e6" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">定义类型和范围</h1><p id="e404" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">你需要和你的客户一起定义的第一件事是活动的范围。这是针对公司的所有员工，还是只针对关键的高特权员工？在后一种情况下，你需要为每个用户定制电子邮件，使用有趣的话题，确保吸引他们。<strong class="jp ir">这叫鱼叉式钓鱼</strong>。</p><p id="3679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，您是否希望能够使用从您的活动中收集的凭据来开始一次pentest？这是一个明智的方法，每个公司都有不同的隐私政策。如果您只想评估您的员工的安全级别，您实际上不需要记录每个凭证。您可以在保存凭证和提取统计信息之前，对一部分凭证进行模糊处理。</p><p id="4b77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还需要预先定义您的指标。你当然想知道有多少百分比的用户点击了这个链接。但是你也可以记录它点击链接的次数。他们试了多少证件。他们在收到你的邮件后有没有尝试重置密码？收到邮件后多久？这些都是你应该为雇主收集的有趣数据。</p><h1 id="b3b3" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">建立基础设施</h1><p id="134a" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">为了开始我们的评估，我们需要关于我们目标的信息。我不打算在这里讨论OSINT过程，因为这是一个非常广泛的话题，我打算写另一篇关于这个的文章。但是让我们假设您已经收集了以下信息:</p><ol class=""><li id="42a3" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk mk lv lw lx bi translated">你的目标的电子邮件地址</li><li id="8d42" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">收件人的一般有用信息，如时区和语言(如果你是鱼叉式网络钓鱼，还有具体的兴趣)</li></ol><p id="24c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在您已经有了这些信息，您将需要自己的smtp服务器来发送电子邮件。</p><figure class="ml mm mn mo gt mp"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="bdf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不在乎雷神看起来有多简单。在建立所需的基础设施时，有实际的时间要求，<strong class="jp ir">你不能只是从任何地方发送电子邮件</strong>。</p><p id="b111" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你需要</p><ol class=""><li id="d1c3" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk mk lv lw lx bi translated">可公开访问的服务器。你可以使用任何便宜的提供商，比如Linode、Digital Ocean、AWS、GCM等等……(我没有提到Azure，因为本教程是针对Linux用户的)。他们提供低至每月5美元的vps。你不需要很多资源，最便宜的1gb内存就足够了。在我们的案例中，我们使用了数字海洋。</li><li id="f4f2" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">您的服务器的域名。<br/>这里不说<a class="ae kl" href="https://en.wikipedia.org/wiki/IDN_homograph_attack" rel="noopener ugc nofollow" target="_blank">同形异义词攻击</a>，我就说不透彻了。它们基本上是普通字母的变体，看起来与原始字母相似。想想西里尔字母<a class="ae kl" href="https://en.wikipedia.org/wiki/%D2%92" rel="noopener ugc nofollow" target="_blank">ғ</a>而不是普通的f。这允许你保留一个与你想要恶搞的域名相似的域名。实际上，我并不喜欢这种方法。以我的经验来看，用户更信任其他变量，比如URL中的绿色挂锁，而不是真实的名称。此外，使用这些类型的字符集实际上可以提醒自动过滤器有关您的恶意活动。你真的认为脸书没有想过让机器人扫描互联网寻找新的Faceboӧk.com域名吗？我更想从notifications@facenotifier.com寄封邮件。我们将在本教程中使用godaddy。</li><li id="6d85" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">一个当用户点击链接时接收用户的网站(我们将在后面详细讨论如何设置)。</li></ol><p id="d044" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您需要考虑的一个问题是，由于频繁的垃圾邮件，大多数云提供商会阻止到端口25/tcp (smtp)的出站连接。这意味着在发送任何电子邮件之前，您必须联系他们取消此限制(我们必须在数字海洋的支持下创建一个票证)。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/1b2ee79483171052b006bee1deae99a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i3vcvQJs4VnxGJb2tFhJqg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">系统日志显示无法访问gmail的smtp服务器</figcaption></figure><p id="bdba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">购买域名后，你必须将其域名系统转移到你的云提供商。假设你购买了域名totallyrealdomain.com。你可以进入godaddy的DNS设置，将域名解析为数字海洋域名服务器(ns2.digitalocean.com和ns2.digitalocean.com)。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nd"><img src="../Images/0e0390bb3e127292e3c4c0034c30ba4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7yDCMRlz28n4ssdcYimt1Q.png"/></div></div></figure><p id="f62e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，你必须配置digitaloceans DNS服务器，将你的域名指向新创建的vps的IP。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ne"><img src="../Images/fed4f2382a71851ea5ec15891c3f4e7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rPRS3AnS9Ssl49hj9VfwaQ.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">在DO中关联您的域</figcaption></figure><p id="60cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以goddady会把你的dns记录指向digitalocean的dns记录，那些会指向你的vps。很简单。</p><h1 id="c1f6" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">防晒系数</h1><p id="3058" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">简单来说，<a class="ae kl" href="https://en.wikipedia.org/wiki/Sender_Policy_Framework" rel="noopener ugc nofollow" target="_blank"> SPF </a> <a class="ae kl" href="https://en.wikipedia.org/wiki/Sender_Policy_Framework" rel="noopener ugc nofollow" target="_blank">或发件人政策框架</a>定义了哪些主机被允许为您的域发送电子邮件。请记住，SMTP是一个非常古老的协议，是在安全性不像今天这样重要的时代开发的。任何人都可以连接到Gmail的SMTP服务器，发送一封自称是任何人的电子邮件，因此采取了安全措施来防止这种情况。其中一个措施是SPF，它允许你在域名的DNS记录上定义一组被授权发送邮件的IP地址。因此，当Gmail收到一封声称来自totallyrealdomain.com的电子邮件时，它会进入totallyrealdomain的DNS记录，并查找定义SPF策略的TXT记录。如果电子邮件来自的IP列在那里，则该电子邮件将通过SPF策略。</p><p id="9d76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以像这样查询特定的TXT记录:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nf"><img src="../Images/45c756f5ec82880b149b46fe9b44e067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n5VBGn52uO-zSLEfzX5pNA.png"/></div></div></figure><p id="31a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会深入SPF记录的语法，但这个记录基本上意味着只有在定义mail.totallyrealdomain.com的A记录下列出的域名应该通过SPF检查。</p><h1 id="3f12" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">DKIM</h1><p id="6c19" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated"><a class="ae kl" href="https://en.wikipedia.org/wiki/DomainKeys_Identified_Mail" rel="noopener ugc nofollow" target="_blank">域名密钥识别邮件</a>(简称DKIM)简单来说就是对你的电子邮件进行数字签名。再次，我简化了概念，所以这不会成为一个5000字的书面报告，但与DKIM你基本上</p><ol class=""><li id="f24e" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk mk lv lw lx bi translated">根据您的电子邮件内容(邮件头和正文)生成哈希</li><li id="cb84" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">你用私钥签名</li><li id="6854" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">您将签名的哈希与电子邮件一起发送</li></ol><p id="4ba5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">收到电子邮件时，收件人应该</p><ol class=""><li id="b728" class="lp lq iq jp b jq jr ju jv jy lr kc ls kg lt kk mk lv lw lx bi translated">使用您的公钥(列在DNS TXT记录下)来验证收到的哈希。</li><li id="7dbc" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">根据收到的电子邮件内容计算自己的哈希。</li><li id="df5f" class="lp lq iq jp b jq ly ju lz jy ma kc mb kg mc kk mk lv lw lx bi translated">比较收到的哈希和计算的哈希，以验证电子邮件在传输过程中没有被更改，并且由发件人进行了数字签名。</li></ol><p id="f400" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这可能看起来令人困惑，但这一切都归结为有一个带有你的DKIM公钥的DNS TXT记录。要查询你的DKIM记录，你需要一个选择器。这用于指示公钥在DNS中的位置。DNS条目将位于选择器中。在我们的例子中，我们将使用选择器“mail”，这意味着我们需要查询邮件的txt记录。_ domain key . totallyrealdomain . com</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ng"><img src="../Images/6e0fce2d340643c0f6a355d44dbf4775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Roe2HF0NgKXZhWKn4SRI2g.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">查询我们的DKIM记录</figcaption></figure><p id="dc95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对记录格式感到好奇，你可以在这里看到解释的语法<a class="ae kl" href="https://help.returnpath.com/hc/en-us/articles/222481088-DKIM-DNS-record-overview" rel="noopener ugc nofollow" target="_blank">，</a>，但是重要的部分是公钥是p=参数下的base64编码的字符串。在这种情况下，由于超过了DNS记录的最大大小限制，它被拆分。</p><h1 id="52f7" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">试用SPF和DKIM:</h1><p id="c3e3" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">让我们实现这两个寄存器，看看我们如何对付mail-tester.com！我们可以用下面的脚本来配置它们。你只需要用</p><pre class="ml mm mn mo gt nh ni nj nk aw nl bi"><span id="9352" class="nm kn iq ni b gy nn no l np nq">./autoPhisher.sh $hostname</span></pre><p id="65b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它会安装所有的东西并打印你需要添加的DNS记录。运行之后，我们可以用下面的命令测试它(确保用你在mail-tester.com上得到的邮箱替换目标电子邮件地址)</p><pre class="ml mm mn mo gt nh ni nj nk aw nl bi"><span id="584b" class="nm kn iq ni b gy nn no l np nq">echo "Testing mail" | mail -s "$(echo -e "Test Email\nFrom: John Doe &lt;<a class="ae kl" href="mailto:no-reply1@fbnotificationmail.com" rel="noopener ugc nofollow" target="_blank">no-reply@totallyrealdomain.com</a>&gt;\nReply-to: <a class="ae kl" href="mailto:no-reply2@fbnotificationmail.com" rel="noopener ugc nofollow" target="_blank">no-reply@</a><a class="ae kl" href="mailto:no-reply1@fbnotificationmail.com" rel="noopener ugc nofollow" target="_blank">totallyrealdomain</a> \nContent-Type:text/html\n")" -r <a class="ae kl" href="mailto:no-reply3@fbnotificationmail.com" rel="noopener ugc nofollow" target="_blank">no-reply@</a><a class="ae kl" href="mailto:no-reply1@fbnotificationmail.com" rel="noopener ugc nofollow" target="_blank">totallyrealdomain</a> <a class="ae kl" href="mailto:test-s821hrdl9@srv1.mail-tester.com" rel="noopener ugc nofollow" target="_blank">test-s211hrdl7@srv1.mail-tester.com</a></span></pre><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nr"><img src="../Images/f3f6d239e417189baf9f1514ddb47ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Th7yHK_CMfDGXH0tibdCiA.png"/></div></div></figure><p id="088e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这看起来不像是很好的成绩，不是吗？但是不要担心，我们只是想验证我们在基础设施方面需要的所有措施都正常工作。查看详细信息，我们看到它们是:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ns"><img src="../Images/73692e924ed6d86f4f679177c5a2da91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1yzdgCLol3fIRlSyNfZ4w.png"/></div></div></figure><p id="1304" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们几乎完成了基础设施方面的工作！我们还需要做两个改变。</p><h1 id="d8b6" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">MX记录</h1><p id="0041" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们得分低的原因之一是我们的DNS上缺少MX记录。这个记录应该指向您邮件服务器。因为我们在同一个服务器上托管所有东西，所以让我们创建它，指向我们的主域。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nt"><img src="../Images/8a52bef880ccd27dd355e769e25d1279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ihPcn-zMWbj3f-iuKK1odQ.png"/></div></div></figure><p id="ba7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当不同邮件服务器之间的流量负载平衡时，使用<a class="ae kl" href="https://en.wikipedia.org/wiki/MX_record#MX_preference,_distance,_and_priority" rel="noopener ugc nofollow" target="_blank">优先级</a>。我们不需要这个，因为我们只有一个，所以我们就把它留在10点。</p><h1 id="cb49" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">反向NS查找(PTR记录)</h1><p id="dc92" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们得到的一个观察结果是，我们的服务器没有有效的PTR DNS记录。这也称为反向查找，允许您查询DNS服务器上的IP并获取相关的主机名。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nu"><img src="../Images/97902e5bf494bc7f72761e6355028249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vybD9BnGPURijJ4TAYZHxg.png"/></div></div><figcaption class="mz na gj gh gi nb nc bd b be z dk translated">缺少反向查找</figcaption></figure><p id="60f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该PTR记录允许接收邮件服务器查询发送电子邮件的IP地址，并查看它是否具有带有匹配域名的相关记录。</p><p id="aa15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在数字海洋的情况下，只要你用FQDN格式改变你的水滴的名字，PTR记录就会自动生成<a class="ae kl" href="https://serverpilot.io/docs/how-to-set-ptr-records-and-reverse-dns/" rel="noopener ugc nofollow" target="_blank">。所以我们只需要将我们的droplet从ubuntu-s-1vcpu-1gb-nyc1-01重命名为totallyrealdomain.com</a></p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nv"><img src="../Images/112d043bc36b055c2f4dff440af260ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wex6UEwrqG2BK11UJnAL6Q.png"/></div></div></figure><p id="c16f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据您配置的TTL，我们需要等待DNS更改传播，但同时您可以使用以下命令查询digitaloceans名称服务器上的更改:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nw"><img src="../Images/286b0757c8b1eccc0fdb07370d167015.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*A55jkW0x4x0vA85zVLIYAQ.png"/></div></div></figure><p id="b2db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">等待之后，我们再试一次，发现分数有了很大的变化。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi nx"><img src="../Images/89d4e52d8946ba94e9b24021db902501.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chcewDNjYar9tIRRabchcg.png"/></div></div></figure><p id="7f4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它并不完美，但我们会实现的。至少我们已经在基础设施方面做好了准备。这是我们用一封简单的短信能得到的最高分。</p><p id="8484" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将在这里结束第一部分。在第二部分，我们将看到如何润色我们的电子邮件，使它们接近完美的10分，以及一些小技巧，你可以做些什么来提高你的接收百分比。</p></div></div>    
</body>
</html>