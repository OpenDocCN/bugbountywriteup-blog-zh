<html>
<head>
<title>#BugBounty @ Linkedln-How I was able to bypass Open Redirection Protection</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated"># bug bounty @ linked ln-我是如何绕过开放重定向保护的</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-linkedln-how-i-was-able-to-bypass-open-redirection-protection-2e143eb36941?source=collection_archive---------1-----------------------#2018-01-24">https://infosecwriteups.com/bugbounty-linkedln-how-i-was-able-to-bypass-open-redirection-protection-2e143eb36941?source=collection_archive---------1-----------------------#2018-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="48db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="18bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我将讨论几个月前我在Linkedln中发现的一个很好的漏洞。在讨论这个漏洞之前，让我简单介绍一下开放重定向-</p><blockquote class="kl km kn"><p id="bede" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">当应用程序以不安全的方式将用户可控制的数据合并到重定向的目标中时，就会出现开放重定向漏洞。攻击者可以在应用程序中构建一个URL，导致重定向到任意外部域。一个易受攻击的网站链接的例子可能是这样的:<a class="ae ks" href="https://www.example.com/login.html?RelayState=http%3A%2F%2Fexample.com%2Fnext" rel="noopener ugc nofollow" target="_blank">http://xyz.com/login.html?vulparam = https://XYZ . com/next</a></p><p id="ff8b" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">在此示例中，“vulparam”参数指示成功登录后将用户发送到哪里。如果网站不验证“vulparam”参数值以确保目标网页是合法的和预期的，攻击者可以操纵该参数将受害者发送到攻击者精心制作的虚假页面:<a class="ae ks" href="https://www.example.com/login.html?RelayState=http%3A%2F%2FEvilWebsite.com" rel="noopener ugc nofollow" target="_blank"> https://xyzcom/login.html？vulparam=http </a> ://evil.com</p></blockquote><p id="6a2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是绕过Linkedln开放重定向并不容易。易受攻击的URL是—</p><p id="ee0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://www.linkedin.com/lite/external-redirect? T4】URL = http://evil zone . org&amp;URL hash = yk i5</p><p id="5842" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Linkedln确实对开放重定向有一些很好的保护，因为我无法使用一些常见的技术来绕过它，比如</p><p id="cb98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">url=../evilzone.org，url= ///evilzone.org，URL = ///www.linkedln.com@www.evilzone.org/%2f%2e%2e</p><p id="abad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，简单地将“url”值更改为任何恶意站点在这里都不起作用。正如您所看到的，有一个额外的参数“urlHash ”,它看起来像是用户被重定向到的url的某个哈希值，因此如果“urlHash”值是“URL”的实际有效哈希值，那么只有成功的重定向才会发生。有一件事是清楚的，直到现在基本的技术不会做任何好的事情，然后我回到原始请求来寻求一些帮助—</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/ce68f346895855e703d457acca5b2db0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1392/format:webp/1*seOpQSGhF9AWWDMK5vnVCw.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk translated">打开重定向原始请求</figcaption></figure><p id="74e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该请求包括“referer”字段，该字段指示用户所在的最后一个页面(即他们单击链接的页面)，我突然想到——“改变referer标头值并查看验证是否有效怎么样？”。所以我很快跳进它，并改变了一些其他领域的头值和[脸掌]仍然没有运气。:/ .</p><p id="1109" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们再试一次，我搜索了LinkedIn android app referer，找到了下面的链接-<a class="ae ks" href="https://github.com/snowplow/referer-parser/issues/131" rel="noopener ugc nofollow" target="_blank">https://github.com/snowplow/referer-parser/issues/131</a>，看到LinkedIn android referer值为“<em class="ko">Android-app://com . LinkedIn . Android</em>”。我在“referer”标题字段中使用了referer值，其余部分如下图:D所示</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/a027e07b4aab9147bd866bb413f997f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hHd1tmWGk-XkIP_3ltHkGg.png"/></div></div></figure><p id="b1f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功的重定向和耶最后我设法绕过LinkedIn的开放重定向保护:)</p><p id="2bb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">报告详情- </em></p><p id="c980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2017年11月11日—向相关公司报告了错误。</p><p id="ffae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2017年12月7日—错误被标记为已修复。</p><p id="4571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2017年12月21日—重新测试并确认了修复。</p><p id="9677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(<a class="ae ks" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)</p></div></div>    
</body>
</html>