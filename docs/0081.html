<html>
<head>
<title>#BugBounty — “Journey from LFI to RCE!!!”-How I was able to get the same in one of the India’s popular property buy/sell company.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">#BugBounty —“从LFI到RCE的旅程！！!"-我是如何在印度最受欢迎的房地产买卖公司之一买到同样的东西的。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-journey-from-lfi-to-rce-how-a69afe5a0899?source=collection_archive---------0-----------------------#2018-04-19">https://infosecwriteups.com/bugbounty-journey-from-lfi-to-rce-how-a69afe5a0899?source=collection_archive---------0-----------------------#2018-04-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d4a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="82d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇博客是关于我如何在印度的一家房地产买卖公司从本地文件包含(LFI)获得远程代码执行(RCE)的。让我们看看完整的场景是什么-</p><blockquote class="kl km kn"><p id="e294" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">作为一名bugbounty hunter，我认为最重要的事情是我们尝试或遵循的利用漏洞的方法，这最终会导致漏洞产生更大的影响，我在这里也提到了这一点。</p></blockquote><p id="63e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在搜索漏洞的时候，我在目标站点-【https://www.victimsite.com/forum/attachment-serve? T2】找到了LFI名称=../../../../../../../../../../etc/shadow &amp;路径 =。如您所见，参数“name”易受LFI攻击。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi kt"><img src="../Images/a486ec46eb91c096138f6a4532ef0ad9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*747MKVFjYgyU95RCoBNoSQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">LFI/etc/shadow</figcaption></figure><p id="bd75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我被证实LFI在那里，所以现在我的目标是升级到RCE。在此之前，我看过很多关于如何从LFI得到RCE的文章，这篇文章在这里帮了我一点忙——<a class="ae ks" href="https://medium.com/@p4c3n0g3/lfi-to-rce-via-access-log-injection-88684351e7c0" rel="noopener">https://medium . com/@ p 4c 3 n0g 3/lfi-to-rce-via-access-log-injection-88684351 e7c 0</a>。现在的想法是访问一些文件可能是日志文件，可以提供一些用户控制器输入(为了运行一些命令)。</p><p id="5066" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我试着读取访问日志，错误日志，不同的位置来访问它们。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lj"><img src="../Images/24110203b5c59939946153b4150c6bcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IDjzE0I3GH7tAUZu9n3EiQ.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">访问日志响应</figcaption></figure><p id="4d1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但似乎我得到LFI的用户没有访问日志文件的权限。我做了一些阅读和研究，发现“/proc/self/fd”提供了访问日志和各种其他系统相关文件的符号快捷方式。所以我试着阅读那些搜索访问日志-</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lk"><img src="../Images/8168400b19b663d65481269529bff4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cmp41tnHIKH6F5wKAvGj5Q.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">/proc/self文件</figcaption></figure><p id="6cf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在/proc/self/fd/{number}上运行入侵者，其中一个fd文件让我可以访问访问日志——</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ll"><img src="../Images/99fca9367c482158b98eb7fd71f33826.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xCO-AbSe_AVdUXq3uMhv-g.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">访问日志文件</figcaption></figure><p id="6dca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里引起我注意的是“referer”标题，因为我知道它是在用户控制输入下的。是时候执行一些命令了。我在HTTP请求中添加了“referer”头，将其值设置为system(id)并转发它-</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lm"><img src="../Images/0a9639e82f1ba866c328aadfc499335f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9MDCpq26Lb-NtW7Wjvt-Iw.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">LFI到RCE</figcaption></figure><p id="57c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有欢快的回应:)</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ln"><img src="../Images/cad6d42678d399254caa9667b4f3b5af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FglIBIcK4jrRe4KC9Anu-g.png"/></div></div><figcaption class="lf lg gj gh gi lh li bd b be z dk translated">RCE的回应</figcaption></figure><p id="2a10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我如何从本地文件包含(LFI)获得远程代码执行(RCE)！:)</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="9185" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ko">报告详情- </em></p><p id="c980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年4月13日—向相关公司报告了错误。</p><p id="f8bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年4月16日—错误被标记为已修复。</p><p id="db2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年4月16日—重新测试并确认了修复</p><p id="bc9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">奖励进行中。</p><p id="9677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(<a class="ae ks" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)</p></div></div>    
</body>
</html>