<html>
<head>
<title>TryHackMe: LazyAdmin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe: LazyAdmin</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-lazyadmin-9441e1240cb7?source=collection_archive---------4-----------------------#2022-06-12">https://infosecwriteups.com/tryhackme-lazyadmin-9441e1240cb7?source=collection_archive---------4-----------------------#2022-06-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="e1b7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">走查</h2></div><h1 id="f3da" class="kf kg iq bd kh ki kj kk kl km kn ko kp jw kq jx kr jz ks ka kt kc ku kd kv kw bi translated">介绍</h1><p id="397a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你好，绅士！！这次我从Tryhackme告诉你如何解决<strong class="kz ir">懒Admin </strong>。所以，事不宜迟，让我们利用。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi lt"><img src="../Images/41c6e4489904ef0c7c2cb35f10b4224d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vsxj_eL6_OjXbWNlgAcxOw.png"/></div></div></figure></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="9115" class="kf kg iq bd kh ki mm kk kl km mn ko kp jw mo jx kr jz mp ka kt kc mq kd kv kw bi translated">首字母</h1><pre class="lu lv lw lx gt mr ms mt mu aw mv bi"><span id="9f71" class="mw kg iq ms b gy mx my l mz na">nmap -sC -sV $IP </span></pre><p id="cc84" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">nmap扫描后，发现端口80是打开的。访问网站后:</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ng"><img src="../Images/93f839fd380d12a8a52a8825d9c02347.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fs5fmOO4IedoMleWqbY1_Q.png"/></div></div></figure><p id="08f1" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">用<strong class="kz ir"> gobuster </strong>运行目录搜索，我们找到了<strong class="kz ir"> /content/inc </strong></p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/abb20f72bc2b471688607c1f1734bb4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*xE0npiiNkO0VeAPizY9yKQ.png"/></div></figure><p id="825b" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">下载文件并获得密码<strong class="kz ir">哈希:</strong></p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ni"><img src="../Images/fd91afb884bf80287e3b02b120474414.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8I0YAthm3obpXj3NnLD96Q.png"/></div></div></figure><p id="8935" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">以<strong class="kz ir"> hashcat </strong>和<strong class="kz ir"> rockyou.txt </strong>为字表破解密码，得到密码</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/db0e218994a0fcc82d0f6fc54e5e9a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*Mmh-oJNRiFu_Y-5HLDjmJA.png"/></div></figure><p id="b0d4" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">我们在<strong class="kz ir"> /content/as </strong>找到了登录面板，以管理员身份登录并获得了CMS管理仪表板</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="51c4" class="kf kg iq bd kh ki mm kk kl km mn ko kp jw mo jx kr jz mp ka kt kc mq kd kv kw bi translated">利用:</h1><p id="c7bc" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">登录后，我们发现有一个可以添加代码的部分</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nk"><img src="../Images/e571b509bfed2fd5943e9a605fc8cb03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Csnu1B6MjyctkF_R9odvQg.png"/></div></div></figure><p id="d696" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">添加了php反向外壳代码并添加了文件名为<strong class="kz ir">reverse.php</strong></p><p id="ea59" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">我们可以在<strong class="kz ir"> /content/inc/ads </strong>获取代码</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nl"><img src="../Images/c1f3837d1175329126aa972e6e717235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1ke4eKC0g5oya1B_TD5dw.png"/></div></div></figure><p id="870e" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">启动<strong class="kz ir">监听器</strong>并运行<strong class="kz ir">反向shell </strong>获取shell。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nm"><img src="../Images/9868808dee6fdf561b953942f8cbc4e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3FoPuDOlkQCax4JAnUaMMQ.png"/></div></div></figure><p id="8ac2" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">现在轮到鲁特·:D了</p><p id="f14c" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">有一个兔子洞，里面有包含mysql凭证的文件。但是除了兔子洞之外，我们发现用户可以使用root权限运行一个命令。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nn"><img src="../Images/5fa59fdb2d6a70866ac255d50ca575a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pz-dYKue8sJSRQIspwX3_Q.png"/></div></div></figure><p id="bdfe" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">检查backup.pl文件</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi no"><img src="../Images/1c34f3debc1a9475bec60c674e6fe676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*TBvFSsodKbexoKz0yRqPyg.png"/></div></figure><p id="798d" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">它运行一个bash脚本。检查了shell脚本</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi np"><img src="../Images/f0d85793ab2e39604dea62828e875b7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YQwYC__BVBYPhDYErjavZA.png"/></div></div></figure><p id="214d" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">这是一个反向shell代码，该用户拥有对该文件的写权限。</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/8395f3ea720e02c977a978d274b1171c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*-kr-SZamPp7ovXRxXoeYPQ.png"/></div></figure><p id="45c8" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">更改了文件的内容</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/37c5a1be8ed8e66e48e0719deaf11132.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*9duKBJGnadPO_ptLhpv3cQ.png"/></div></figure><blockquote class="ns nt nu"><p id="11bc" class="kx ky nv kz b la nb jr lc ld nc ju lf nw nd li lj nx ne lm ln ny nf lq lr ls ij bi translated">这条线会做什么？<br/>这会将本地的<strong class="kz ir"> /bin/bash </strong>文件复制到<strong class="kz ir"> /tmp </strong>中，并给予<strong class="kz ir"> SUID权限</strong>，这样我们就可以以<strong class="kz ir">根</strong>的身份运行<strong class="kz ir"> /tmp/bash </strong>文件</p></blockquote><p id="d240" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">运行命令以获得SUID权限，然后执行bash文件以获得根目录</p><figure class="lu lv lw lx gt ly gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi nz"><img src="../Images/a4bd0733aa3405849bfa03daa82e47d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pavNoxbqvxU8_leaiAPSlA.png"/></div></div></figure></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><h1 id="9102" class="kf kg iq bd kh ki mm kk kl km mn ko kp jw mo jx kr jz mp ka kt kc mq kd kv kw bi translated">结尾部分</h1><p id="320e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">我们完成了这个房间，我们将在下一个房间见面。到那时，<strong class="kz ir">快乐黑客</strong> o7</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="a37d" class="pw-post-body-paragraph kx ky iq kz b la nb jr lc ld nc ju lf lg nd li lj lk ne lm ln lo nf lq lr ls ij bi translated">|| <a class="ae oa" href="https://tryhackme.com/room/lazyadmin" rel="noopener ugc nofollow" target="_blank">房间</a> || <a class="ae oa" href="https://twitter.com/namx05" rel="noopener ugc nofollow" target="_blank">推特</a> ||</p></div></div>    
</body>
</html>