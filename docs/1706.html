<html>
<head>
<title>Disrupting an Application’s User Registration Process in 10 mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在10分钟内中断应用程序的用户注册过程</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/disrupting-an-applications-registration-process-in-10-mins-eab63cffd5eb?source=collection_archive---------0-----------------------#2021-12-11">https://infosecwriteups.com/disrupting-an-applications-registration-process-in-10-mins-eab63cffd5eb?source=collection_archive---------0-----------------------#2021-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6d86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以像往常一样，这篇文章将分为三个部分</p><ol class=""><li id="3c9d" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">引言。</li><li id="820f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">漏洞描述。</li><li id="0749" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">繁殖的步骤。</li></ol><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/49e450dc5eeec7ea02c5cd8a4f54ff97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t66jKohNSPuOEod0smeFgA.jpeg"/></div></div></figure><h1 id="c77f" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">介绍</h1><blockquote class="mj mk ml"><p id="12a7" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated"><strong class="jp ir">什么是业务逻辑漏洞？</strong></p><p id="11da" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated">业务逻辑漏洞是应用程序设计和实现中的缺陷，它允许攻击者引发意外行为。这可能使攻击者能够操纵合法功能来实现恶意目标。这些缺陷通常是由于未能预见到可能出现的异常应用程序状态，因此未能安全地处理它们。</p></blockquote><p id="238d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://portswigger.net/web-security/logic-flaws】点击 <a class="ae mq" href="https://portswigger.net/web-security/logic-flaws" rel="noopener ugc nofollow" target="_blank"> <em class="mm">了解详情</em></a></p><p id="b116" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么就从我们的目标介绍开始吧。我寻找的目标是一个电子商务网站。它具有电子商务商店应该具有的所有基本功能。</p><p id="09ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">目标功能:2FA、登录和注册、个人资料编辑、购物车、结账等。</strong></p><p id="5957" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我们将重点放在概要文件编辑功能上，因为我发现了这个特定功能中的业务逻辑缺陷。</p><blockquote class="mj mk ml"><p id="0d83" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated"><strong class="jp ir">我来问你，一个开发者在个人资料编辑页面上包含的基本功能有哪些？</strong></p><p id="3b4b" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated"><strong class="jp ir">答:</strong>用户能够改变他的电子邮件地址，编辑他的名字和改变其他基本信息。</p></blockquote><p id="82e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然我们已经知道了基本的东西，并且有了要测试的功能范围，那么让我们从我们的攻击方法开始。</p><h1 id="11d9" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">漏洞描述</h1><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/e752af05657bc10dcf9a90b7e02a3765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*VBremF-D0ZCeyP_Na2ZOCQ.jpeg"/></div></figure><p id="35ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个应用程序让我更改个人资料中的基本信息，但不知何故没有给我任何权限来更改我的电子邮件地址。我当时就觉得这有点。</p><p id="2764" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我只是想看看当我想更新名字等基本信息时它发出的请求。(将在稍后的文章中详细解释)</p><p id="7139" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我截取了那个特定的请求，我看到的有点令人惊讶。</p><p id="c239" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管我只是想更改我的名字，但该请求发送了所有其他个人资料数据，包括我现在的电子邮件(在emailAddress &amp; username参数中)。因此，由于我通常不允许更改我的电子邮件地址，我想为什么不通过更新电子邮件地址和用户名参数来更改这个特定请求中的电子邮件地址。</p><p id="8b63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用受害者的电子邮件地址更新了参数，令我惊讶的是，它成功了。记住我没有就此打住，呵呵。</p><p id="9566" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">电子邮件地址更新成功。现在，我只需扩大这一漏洞的影响，我已经在重现步骤中展示了这一点。</strong></p><h1 id="43a0" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated">复制步骤:</h1><p id="b12e" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">1)在<a class="ae mq" href="https://www.glowandlovelycareers.in/en/" rel="noopener ugc nofollow" target="_blank"> https://www。****.in/en/ </a>并验证它。<br/> 2)访问<a class="ae mq" href="https://www.glowandlovelycareers.in/en/" rel="noopener ugc nofollow" target="_blank"> https://www。****.在/en/ </a>并且为了这次攻击在编辑个人资料页面上编辑任何东西。<br/> 3)现在点击save changes按钮，在burp suite中拦截该请求。</p><p id="7b80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">拦截的请求看起来像这样:</strong></p><pre class="la lb lc ld gt mx my mz na aw nb bi"><span id="e74d" class="nc lm iq my b gy nd ne l nf ng">PUT /useraccounts/users/5f53963ea829f23e7dfa2fc3 HTTP/1.1<br/>Host: dl****.execute-api.ap-south-1.amazonaws.com<br/>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:80.0) Gecko/20100101 Firefox/80.0<br/>Accept: application/json, text/plain, <em class="mm">/</em><br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Referer: https://www.*****.in/<br/>Authorization: Bearer eyJhbG****dhMjEyNTM1M2QxIiwiY2xpZW50X2lkIjoidGVzdCJ9.2xHW9goHxG08dw28q-1xHyyXWvevelTJ6E-IU0_yh50<br/>Content-Type: application/json<br/>Content-Length: 939<br/>Origin: https://www.****.in<br/>Connection: close</span><span id="bfef" class="nc lm iq my b gy nh ne l nf ng">{"id":"5f53963ea829f23e7***","creationDate":***,"modifyDate":1599316219***,"firstName":"Karan","lastName":"Arora","mobileNo":"***943914",<strong class="my ir">"emailAddress":"adversaryc***@gmail.com”</strong>,dateOfBirth":1016562600000,"gender":"male","shorterTestTaken":false,"longerTestTaken":false,"alternateEmailAddress":"","careerIntentId":"5ea9e91bdd50a63d28c5ca9b","lang":"en","userEnrollments":{"id":null,"userId":"5f53963ea829f23e7dfa2fc3","onlineTestEnrollments":{"categories":[],"tests":[]}},"appliedforWonk":false,"isDOBUpdated":true,<strong class="my ir">"username":"adversaryc***@gmail.com"</strong>}</span></pre><p id="8039" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">现在更改高亮显示的参数，将电子邮件地址更改为受害者的电子邮件地址。</strong></p><blockquote class="mj mk ml"><p id="a459" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated"><em class="iq">受害者电子邮件地址:karn***@gmail.com</em></p></blockquote><p id="9184" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">变更请求</strong></p><pre class="la lb lc ld gt mx my mz na aw nb bi"><span id="d459" class="nc lm iq my b gy nd ne l nf ng">PUT /useraccounts/users/5f53963ea829f23e7dfa2fc3 HTTP/1.1<br/>Host: dl****.execute-api.ap-south-1.amazonaws.com<br/>User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.16; rv:80.0) Gecko/20100101 Firefox/80.0<br/>Accept: application/json, text/plain, <em class="mm">/</em><br/>Accept-Language: en-US,en;q=0.5<br/>Accept-Encoding: gzip, deflate<br/>Referer: https://www.*****.in/<br/>Authorization: Bearer eyJhbG****dhMjEyNTM1M2QxIiwiY2xpZW50X2lkIjoidGVzdCJ9.2xHW9goHxG08dw28q-1xHyyXWvevelTJ6E-IU0_yh50<br/>Content-Type: application/json<br/>Content-Length: 939<br/>Origin: https://www.****.in<br/>Connection: close</span><span id="b50c" class="nc lm iq my b gy nh ne l nf ng">{"id":"5f53963ea829f23e7***","creationDate":***,"modifyDate":1599316219***,"firstName":"Karan","lastName":"Arora","mobileNo":"***943914",<strong class="my ir">"emailAddress":"</strong><a class="ae mq" href="mailto:karnxa007@gmail.com" rel="noopener ugc nofollow" target="_blank"><strong class="my ir">karn***@gmail.com</strong></a><strong class="my ir">"</strong>,dateOfBirth":1016562600000,"gender":"male","shorterTestTaken":false,"longerTestTaken":false,"alternateEmailAddress":"","careerIntentId":"5ea9e91bdd50a63d28c5ca9b","lang":"en","userEnrollments":{"id":null,"userId":"5f53963ea829f23e7dfa2fc3","onlineTestEnrollments":{"categories":[],"tests":[]}},"appliedforWonk":false,"isDOBUpdated":true,<strong class="my ir">"username":"</strong><a class="ae mq" href="mailto:karnxa007@gmail.com" rel="noopener ugc nofollow" target="_blank"><strong class="my ir">karn***@gmail.com</strong></a><strong class="my ir">"</strong>}</span></pre><p id="773b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并转发此请求。现在帐户将被更新，您可以在个人资料页面上看到发生的变化。</p><blockquote class="mj mk ml"><p id="0001" class="jn jo mm jp b jq jr js jt ju jv jw jx mn jz ka kb mo kd ke kf mp kh ki kj kk ij bi translated"><strong class="jp ir">请注意，不会有通知发送到受害者的电子邮件地址，这将成为攻击者的额外奖励，这帮助我增加了漏洞的影响。</strong></p></blockquote><h1 id="44d9" class="ll lm iq bd ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi bi translated"><strong class="ak">附加漏洞</strong></h1><p id="1f46" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">为了仔细检查是否发生了变化，我注销并尝试用攻击者的原始电子邮件adver***@gmail.com(<strong class="jp ir">这是后来添加到我的总体奖励中的另一个漏洞，因为攻击者能够用他的旧电子邮件地址登录，即使在用新地址更新后也是如此。</strong>)</p><p id="9032" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">转到个人资料部分，你会看到受害者karn***@gmail.com的默认电子邮件地址，而不是攻击者的电子邮件，现在攻击者对该帐户进行的任何更改都将被记录为由karn***@gmail.com执行。</p><h2 id="9fc2" class="nc lm iq bd ln ni nj dn lr nk nl dp lv jy nm nn lz kc no np md kg nq nr mh ns bi translated">这就是我如何破坏他们的应用程序的整个帐户注册功能。</h2><p id="cb04" class="pw-post-body-paragraph jn jo iq jp b jq ms js jt ju mt jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><strong class="jp ir"> <em class="mm">推特⬇ </em> </strong></p><p id="be15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mq" href="https://twitter.com/Itskaranxa" rel="noopener ugc nofollow" target="_blank">https://twitter.com/Itskaranxa</a></p><p id="493f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你觉得这值得你花时间，那么</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/61a36e9ca717a45f98e545e62ccb2e69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*PFjpBKZn0W-w-KWJiI_pJQ.jpeg"/></div></figure><p id="362e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">订阅更多。保持好奇！！</strong></p></div></div>    
</body>
</html>