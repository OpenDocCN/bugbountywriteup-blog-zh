<html>
<head>
<title>#BugBounty — How I could book cab using your wallet money in India’s largest auto transportation company!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated"># bug bounty——我如何用你钱包里的钱在印度最大的汽车运输公司预订出租车！</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/bugbounty-how-i-could-book-cab-using-your-wallet-money-in-indias-largest-auto-transportation-e0c4252ca1a3?source=collection_archive---------1-----------------------#2018-03-05">https://infosecwriteups.com/bugbounty-how-i-could-book-cab-using-your-wallet-money-in-indias-largest-auto-transportation-e0c4252ca1a3?source=collection_archive---------1-----------------------#2018-03-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5493" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嗨伙计们，</p><p id="f298" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，我在寻找bug赏金的过程中发现了一个更好的方法，这就是<strong class="jp ir"> <em class="kl">印度最大的在线汽车运输公司</em> </strong>。如题，我可以用受害者钱包里的钱为自己预定出租车。:D。让我们来看看整个场景—</p><blockquote class="km kn ko"><p id="9c0b" class="jn jo kl jp b jq jr js jt ju jv jw jx kp jz ka kb kq kd ke kf kr kh ki kj kk ij bi translated">我的目标是他们的网络应用程序，而不是android应用程序，这是我故意的。原因很明显，因为公司更关心他们的android应用程序而不是网站，只是因为客户流量总是更多地用于移动应用程序，所以他们总是有更多的机会出现漏洞，而安全关注较少。</p></blockquote><p id="9319" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我访问了他们的网站，输入了提货地点和目的地，然后看到了输入手机号码进行动态口令确认的页面</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi ks"><img src="../Images/1663e34e82c2f22cec0b5ece650f4a91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G9PBeysUy4NCGLajq8Ipyw.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">认证所需的手机号码</figcaption></figure><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi li"><img src="../Images/74154a251bdbca92a09b94052388093c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6AgQJ2bqsT-o6u8MXkfPPA.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">OTP验证</figcaption></figure><p id="4e2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看到OTP验证时，猎人首先想到的是“如何绕过它”。我试图强行使用它，但在连续错误的尝试后，应用程序被设置了一些阻塞。捕获原始HTTP请求进行分析，但没有任何帮助。根据我之前的调查，我意识到了一件事，应用程序开发人员有时会忽略服务器端的验证，而完全依赖于客户端。</p><p id="9fc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们在这里尝试同样的事情。我输入了我的测试手机号码，将正确的动态口令放入框中，并保存了它的成功响应—</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lj"><img src="../Images/86b06ec27de0eaf59acf6a89984afc2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*86EN6dCWRMkz0GDIXsu9uQ.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">HTTP成功响应</figcaption></figure><p id="b3f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，这里没有会话管理，因此我唯一要做的就是跳过OTP验证。现在我输入了受害者的手机号码，输入了错误的动态口令，下面是HTTP响应</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lk"><img src="../Images/ca1e64fdedaf54b61d82122d7e8c6179.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*07ArjxY0nwqC-WFeykiQ6A.png"/></div></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">错误的OTP HTTP响应</figcaption></figure><p id="9cba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图通过捕获错误的OTP HTTP响应并将其替换为正确OTP的HTTP响应来绕过它，并转发它，当我这样做时，我得到了下面的页面—</p><figure class="kt ku kv kw gt kx gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/d58319e9b0a38a21fcb25b5f6b94f5ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*dlWPMBdR8T4YRjlZlxyOzw.png"/></div><figcaption class="le lf gj gh gi lg lh bd b be z dk translated">乘坐成功预订</figcaption></figure><p id="7bb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">受害者的手机号码成功预订了我的车！！！</strong>但是事情并没有到此为止。由于几乎所有的出租车/汽车在线平台都有自己的钱包，如果你没有选择其他支付方式，钱会自动从钱包中扣除，这里也发生了同样的情况，钱会从受害者的钱包中扣除，因此<strong class="jp ir">我可以用他钱包里的钱用他的手机号码预订出租车。</strong>:)</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="ac6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">报告详情- </em></p><p id="c980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月3日—向相关公司报告了错误。</p><p id="ffae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月3日—错误被标记为已修复。</p><p id="4571" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月3日—重新测试并确认修复。</p><p id="851e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2018年2月9日—公司奖励。</p><p id="9677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！</p><p id="85ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">~逻辑炸弹(<a class="ae lt" href="https://twitter.com/logicbomb_1" rel="noopener ugc nofollow" target="_blank">https://twitter.com/logicbomb_1</a>)</p></div></div>    
</body>
</html>