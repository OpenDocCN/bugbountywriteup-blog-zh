<html>
<head>
<title>The subdomain monitoring bot — Setting up your bug bounty scripts with Python and Bash</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">子域监控机器人——用Python和Bash设置bug bounty脚本</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/setting-up-your-bug-bounty-scripts-with-python-and-bash-327baa414c99?source=collection_archive---------1-----------------------#2022-12-30">https://infosecwriteups.com/setting-up-your-bug-bounty-scripts-with-python-and-bash-327baa414c99?source=collection_archive---------1-----------------------#2022-12-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="22c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，</p><p id="befd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自动化是非常有趣的事情，如果以正确的方式完成，它会更加有趣。但是编写自动化脚本是最重要的事情。因此，在本文中，我们将讨论用Python和Bash为您的VPS服务器(或者可能是raspberry pi)编写自动化脚本。如果你还没有读过我的前一篇文章<a class="ae kl" rel="noopener ugc nofollow" target="_blank" href="/monitoring-your-targets-for-bug-bounties-36f6be3e69c9">监控你的bug奖励目标</a>，这是我们系列的主要文章，我强烈建议你先读一下。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/5923a5c8e1aa4d0a34690254f39482f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*x-q3B_sICa6Ra2Sw"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated"><a class="ae kl" href="https://unsplash.com/@anagani_saikiran?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Sai Kiran Anagani </a>在<a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上的照片；自动化脚本</figcaption></figure><p id="694d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们决定什么将是我们的自动化系统可以用于。以下是可能性:-</p><ul class=""><li id="dbe2" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated">新子域名监控</li><li id="8242" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">原木中毒</li><li id="16bc" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">核心</li><li id="06dd" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">带有gf的Waybackurls</li><li id="6bc9" class="lc ld iq jp b jq ll ju lm jy ln kc lo kg lp kk lh li lj lk bi translated">等等。</li></ul><p id="fe19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在本文中，我们将从非常基本的机器人开始，为新的子域监控</p><h1 id="112a" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">该算法</h1><p id="de13" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">该算法可以用各种方法设计。在bash中，在python中，混合使用，所以我们将借助bash脚本运行python和shell命令</p><blockquote class="mt mu mv"><p id="b1dd" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">打开包含用户提供的目标的现有文件“domains.txt”</p><p id="337f" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">对一些目标进行排序，因为文件可能包含数千个域，我们不希望我们的网络/机器上有那么多负载</p><p id="c86f" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">在它们上面运行一个工具，可能是amass，然后输出到一个文件“new-subdomains.txt”</p><p id="21a6" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">与旧文件“subdomains.txt”进行比较，过滤掉新文件。</p><p id="1cf6" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">将它们发送到用户定义的渠道，可能是slack或电子邮件(强烈推荐slack，因为您将拥有一个有组织的数据)。此外，将新的子域写入“subdomains.txt”文件，这样当您想要搜索该目标时，就可以很容易地获得一个列表</p></blockquote><h1 id="68d8" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">设置事物</h1><p id="6048" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">创建目录来组织所有数据是很重要的。所以我们需要建立目录，这样事情就不会变得一团糟。目录的结构可以是:-</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="c59d" class="nf lr iq nb b be ng nh l ni nj">.<br/>├── domains.txt<br/>├── init.py<br/>├── last.txt<br/>├── main.sh<br/>├── max.txt<br/>├── runner.py<br/>├── sorter.py<br/>└── targets<br/>    ├── abc.com<br/>    │   ├── new-subdomains.txt<br/>    │   └── subdomains.txt<br/>    └── xyz.com<br/>        ├── new-subdomains.txt<br/>        └── subdomains.txt</span></pre><p id="6848" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以在这里，<code class="fe nk nl nm nb b">domains.txt</code>是众所周知的，<code class="fe nk nl nm nb b">init.py</code>是将初始化新目标的脚本，<code class="fe nk nl nm nb b">runner.py</code>是主脚本，<code class="fe nk nl nm nb b">sorter.py</code>将从<code class="fe nk nl nm nb b">domains.txt</code>中取出所需数量的域，并将其输出到<code class="fe nk nl nm nb b">max.txt.</code>，最后，<code class="fe nk nl nm nb b">last.txt</code>是包含最后扫描的域的文件，以便脚本可以从那里继续。</p><h1 id="0042" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">sorter.py</h1><p id="08a5" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">首先，让我们看看<code class="fe nk nl nm nb b">sorter.py</code>的代码</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="3d86" class="nf lr iq nb b be ng nh l ni nj">import os<br/><br/># Edit the line below to specify the number of domains to be scanned in a run<br/>max_scans = 11<br/><br/>last_scanned_url = open("last.txt", 'r').read().replace("\n", '')<br/><br/>length = 0<br/><br/>with open("domains.txt", "r") as urls_file:<br/>    for url in urls_file:<br/>        url = url.replace('\n', '')<br/>        if url == last_scanned_url:<br/>            for i in range(max_scans):<br/>                next_url = urls_file.readline().replace('\n', '')<br/>                print(next_url)<br/>                length += 1<br/>                open('last.txt', 'w').write(next_url)<br/><br/>if length &lt; max_scans:<br/>    with open("domains.txt", 'r') as urls_file:<br/>        for url in urls_file:<br/>            url = url.replace('\n', '')<br/>            if length &lt; max_scans:<br/>                print(url)<br/>                length += 1<br/>                open('last.txt', 'w').write(url)</span></pre><p id="62a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们看看这是怎么回事</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nn no l"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">视频到sorter.py</figcaption></figure><p id="6954" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你已经明白了，如果没有，让我们明白。</p><p id="59e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这段代码首先打开一个名为<code class="fe nk nl nm nb b">last.txt</code>的文件，并获取最后扫描的域。之后，它打开文件<code class="fe nk nl nm nb b">domains.txt</code>并检查最后扫描的域在哪里。一旦找到它，它打印域并写入<code class="fe nk nl nm nb b">last.txt</code>,以便下次运行时可以从那里继续。此外，如果它到达文件的最后一行，它会跳到第一行，然后再次开始读取。它使用命令<code class="fe nk nl nm nb b">python3 sorter.py &gt; max.txt</code>运行，以便将输出写入文件。现在，一个简单的问题</p><blockquote class="mt mu mv"><p id="4d23" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">这可以直接从主脚本中完成，为什么要放在这里呢？</p><p id="8a9a" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">Ans。是的，你能做那件事。但是当你有多个机器人时，事情就变得混乱了。为了避免把事情弄糟，要以整洁的方式去做</p></blockquote><h1 id="5b9d" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">创建主脚本— runner.py</h1><p id="be58" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated"><code class="fe nk nl nm nb b">runner.py</code> —这是对我们来说最重要的脚本，因为它将负责完成所有的任务。但是在设置它之前，我们需要设置我们的slack通道，所以让我们先这样做。</p><h2 id="983d" class="np lr iq bd ls nq nr dn lw ns nt dp ma jy nu nv me kc nw nx mi kg ny nz mm oa bi translated">设置松弛通道</h2><p id="5640" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">假设您已经有了一个slack帐户和一个工作空间，请按照以下步骤操作</p><ul class=""><li id="e2af" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">打开松弛工作区(https://app.slack.com/client/&lt;某物&gt; / &lt;其他物&gt;)点击添加通道</em> </strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ob"><img src="../Images/5e31af0b9262851cae8a33eaff1ee804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UTchkAo_PuTXjs6j1sgNsw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">点击添加频道按钮</figcaption></figure><ul class=""><li id="5117" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">给它起一个好名字，点击创建，跳过添加一些人(如果你想添加一些人，请随意)</em> </strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a8d24e7689f14be2dbb49e216b0c1716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*M7cdpV2F-SzfI9Bt6lUJPg.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">为通道命名</figcaption></figure><ul class=""><li id="4b26" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">现在，头转向</em></strong><a class="ae kl" href="https://api.slack.com/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">【https://api.slack.com/】</strong></a><strong class="jp ir"><em class="mw">，点击【创建app】</em></strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi od"><img src="../Images/9d34e4fe3c47aabfca7752f7700d982a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FOZq4d7i5iEnD9pI5t87TA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">创建新应用程序</figcaption></figure><ul class=""><li id="b978" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">之后会弹出一个新框，点击</em> </strong> <code class="fe nk nl nm nb b"><strong class="jp ir"><em class="mw">From Scratch</em></strong></code> <strong class="jp ir"> <em class="mw"> &gt;给它命名&gt;给它分配一个通道，点击</em> </strong>创建app</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/a961403554c087064c5f13e2a55a2fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*zI7JRV_t9A7s2WnPir6I5Q.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">选择此处暂存</figcaption></figure><ul class=""><li id="a124" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">一旦创建，进入</em> </strong> <code class="fe nk nl nm nb b"><strong class="jp ir"><em class="mw">Incoming Webhooks</em></strong></code> <strong class="jp ir"> <em class="mw">并打开</em> </strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi of"><img src="../Images/e3954ca88b4895ccb0745b8deb9eb2e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4TjhtY5hTYBL83FfAUt_7A.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">传入webhook</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi og"><img src="../Images/c23055c5b65f00bb791f3da53f64715a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*aKWXLuX7EUgjRFuJQX_j1A.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">打开传入网络挂钩</figcaption></figure><ul class=""><li id="88db" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">打开后，你会在同一页面的</em> </strong>下方看到类似这样的内容</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3729e0989fd27974ef798edcf85174eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*l1PtIgrwWeGpz8o32gRPEg.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Slack webhook API</figcaption></figure><ul class=""><li id="e2f3" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">点击</em> </strong> <code class="fe nk nl nm nb b"><strong class="jp ir"><em class="mw">Add New Webhook to Workspace</em></strong></code> <strong class="jp ir"> <em class="mw">会将您重定向到一个页面，您可以在该页面选择它可以发送消息的空闲通道。现在，只需选择一个频道，并点击</em>允许</strong></li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/1d8feca0c314f6eec4b96ea43d378124.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*NgfkHdV9jWYnN81T2uFaHA.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">允许bot在传入的webhook的帮助下向slack通道发送消息</figcaption></figure><ul class=""><li id="249b" class="lc ld iq jp b jq jr ju jv jy le kc lf kg lg kk lh li lj lk bi translated"><strong class="jp ir"> <em class="mw">一旦完成，你会在</em> </strong> <code class="fe nk nl nm nb b"><strong class="jp ir"><em class="mw">Sample curl request to post to a channel</em></strong></code> <strong class="jp ir"> <em class="mw">处看到一个</em> </strong> <code class="fe nk nl nm nb b"><strong class="jp ir"><em class="mw">curl</em></strong></code> <strong class="jp ir"> <em class="mw">命令。只要复制它，粘贴到一个终端，你会在你的slack频道</em> </strong>看到一条消息</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/65aac9bcd353e472c3b498f3198f2383.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*b0dFe6hbwmUXpafqR6Wq8Q.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">获取cURL命令来发送一个松弛消息</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ok"><img src="../Images/48266ae536356ce9c6668127d5226c1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ewe708j-Q-mCLozuW3gT_w.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">执行命令</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/b5283626f656e5fdc22d98265620aaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*91MTeUb0D2W_xyEfa7efBg.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">并检查你的松弛信道的消息</figcaption></figure><p id="d5e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们已经完成了slack通道的设置。可以通过改变JSON post数据中<code class="fe nk nl nm nb b">"text"</code>的值来改变消息。</p><h2 id="b832" class="np lr iq bd ls nq nr dn lw ns nt dp ma jy nu nv me kc nw nx mi kg ny nz mm oa bi translated">runner.py —主脚本</h2><p id="e94e" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">这个脚本将负责运行不同的工具，比较输出，然后向slack发送消息。</p><p id="6353" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，首先，我们将创建一个函数，将消息发送给slack</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="19ea" class="nf lr iq nb b be ng nh l ni nj">import requests<br/><br/>def send_msg_to_slack(message):<br/>    # Get your webhook URL `Incoming Webhooks` page. It will be like <br/>    # https://hooks.slack.com/services/T04RRRRRRRR/B04RRRRRRRR/B55JREDACTEDREDACTEDAAAA<br/>    # The link above is just a random link<br/>    webhook_url = "&lt;paste_your_webhook_URL_here&gt;"<br/>    payload = {"text": message}<br/>    requests.post(webhook_url, json=payload)</span></pre><p id="355c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们需要在python的帮助下运行一个子域枚举工具(这里我将用amass演示)，然后比较旧文件和新文件。(<strong class="jp ir">重要提示</strong>:命令只能在目标的目录下运行，脚本在<code class="fe nk nl nm nb b">. </code>(按照上面的目录结构))</p><p id="6cbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而在此之前，我们会使用<code class="fe nk nl nm nb b">os</code>模块的<code class="fe nk nl nm nb b">system()</code>函数来执行命令。这也可以通过<code class="fe nk nl nm nb b">subprocess</code>模块完成。</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="ddea" class="nf lr iq nb b be ng nh l ni nj">from os import system<br/><br/>def run_amass():<br/>    with open("max.txt", 'r') as file:<br/>        for target in file:<br/>            target = target.replace("\n", '')<br/>            system(f"cd targets/{target}/ &amp;&amp; amass enum -d {target} -o new-subdomains.txt")<br/>            <br/>            # read the old subdomain list and save it in old_subdomains<br/>            old_subdomains = []<br/>            with open(f"targets/{target}/subdomains.txt", 'r') as old_subdomain_list:<br/>                for subdomain in old_subdomain_list:<br/>                    subdomain = subdomain.replace('\n', '')<br/>                    old_subdomains.append(subdomain)<br/>                    <br/>            # read the new subdomain list and save it in new_subdomains<br/>            new_subdomains = []<br/>            with open("targets/{target}/new-subdomains.txt", 'r') as new_subdomain_list:<br/>                for subdomain in new_subdomain_list:<br/>                    subdomain = subdomain.replace("\n", '')<br/>                    new_subdomains.append(subdomain)<br/>                    <br/>            # compare them and send new ones to slack and<br/>            # also write them to old subdomain list<br/>            found_subdomains = [] # will store the unique subdomains/newly found<br/>            for subdomain in new_subdomains:<br/>                if subdomain in old_subdomains:<br/>                    pass<br/>                else:<br/>                    found_subdomains.append(subdomain)<br/>            if len(found_subdomains &gt; 0):<br/>                msg = "The following new subdomains were found:-"<br/>                for subdomain in found_subdomains:<br/>                    msg = msg + "\n" + subdomain<br/>                send_msg_to_slack(msg)<br/>            # now, write them to old subdomains file<br/>            to_write = open(f"targets/{target}/subdomains.txt", 'r').read()<br/>            for subdomain in found_subdomains:<br/>                if to_write == "":<br/>                    to_write = subdomain<br/>                else:<br/>                    to_write = to_write + "\n" + ""<br/>            open(f"targets/{target}/subdomains.txt", 'w').write(to_write)</span></pre><h1 id="22aa" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">初始化. py</h1><p id="caa4" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">由于可能有1000个可用的域，所以我们需要自动创建文件夹，并最初运行amass的任务。(我们需要创建一个名为<code class="fe nk nl nm nb b">init.txt</code>的文件，它将包含我们想要应用的所有域。同样，我们只需要执行<code class="fe nk nl nm nb b">mkdir targets</code>来创建一个目录。之后，脚本就可以开始了)</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="89d8" class="nf lr iq nb b be ng nh l ni nj">import os<br/><br/>with open("init.txt", 'r') as file:<br/>    for line in file:<br/>        line = line.replace('\n', '')<br/>        os.mkdir(f"targets/{line}")<br/>        os.system(f'cd targets/{line}/ &amp;&amp; amass enum -d {line} -o subdomains.txt')<br/>        open('domains.txt', 'a').write(("\n" + line))</span></pre><p id="19b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据本文上面给出的文件结构，这个脚本也应该在<code class="fe nk nl nm nb b">.</code>目录中运行</p><h1 id="d174" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">总结一下— main.sh</h1><p id="94e8" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">我们现在需要运行<code class="fe nk nl nm nb b">sorter.py</code>然后再运行<code class="fe nk nl nm nb b">runner.py</code>来做我们想做的事情。所以我们可以简单地用一个shell脚本来完成它</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="5420" class="nf lr iq nb b be ng nh l ni nj">python3 sorter.py &gt; max.txt<br/>python3 runner.py</span></pre><p id="7337" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">保存后，执行<code class="fe nk nl nm nb b">chmod +x main.sh</code>使文件可执行</p><h1 id="1837" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用crontab计划它</h1><p id="e385" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">正如我们在上一篇文章中所讨论的，我们可以使用crontab来调度脚本，所以您可以通过向crontab添加以下几行来实现这一点</p><pre class="kn ko kp kq gt na nb nc bn nd ne bi"><span id="d4a9" class="nf lr iq nb b be ng nh l ni nj">00 01 * * * cd /path/to/your/bot/folder/ &amp;&amp; ./main.sh</span></pre><p id="bad8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将根据您的系统时间在每天凌晨01:00执行脚本</p></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><p id="58b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你对这篇文章有任何疑问，欢迎访问<a class="ae kl" href="https://www.houseofhackers.xyz/t/setting-up-your-bug-bounty-scripts-with-python-and-bash/161?u=shriyanss" rel="noopener ugc nofollow" target="_blank">黑客之家</a>的这个帖子，并在那里给我贴上标签</p></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><h2 id="ec63" class="np lr iq bd ls nq nr dn lw ns nt dp ma jy nu nv me kc nw nx mi kg ny nz mm oa bi translated"><a class="ae kl" href="https://www.buymeacoffee.com/shriyanss" rel="noopener ugc nofollow" target="_blank">给我买杯咖啡</a></h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ot"><img src="../Images/2093d0f16d94a8942508624035f676b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCQqlZr6doDP-cszzpaSpw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">给我买杯咖啡</figcaption></figure></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><p id="d933" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢这篇文章。请随时关注我并订阅我的邮件列表，这样每当我写下一部分时，您都可以获得这篇文章:)</p><p id="8e15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://shriyanssudhi.medium.com/subscribe" rel="noopener">订阅这里</a></p><blockquote class="mt mu mv"><p id="7c18" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated">我希望你喜欢这篇文章。欢迎<strong class="jp ir">关注</strong>我了解更多信息。</p><p id="712a" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">推特:</strong><a class="ae kl" href="https://twitter.com/ss0x00" rel="noopener ugc nofollow" target="_blank">https://twitter.com/ss0x00</a>(我这里比较活跃<em class="iq">😄</em>)</p><p id="d1e2" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">领英:</strong><a class="ae kl" href="https://www.linkedin.com/in/shriyans-s-a62826216/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/shriyans-s-a62826216/</a></p><p id="3fbd" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi translated"><strong class="jp ir">提示:</strong>你可以为一篇文章<strong class="jp ir">鼓掌多达50次</strong>，你可以将这篇文章添加到你的列表(阅读列表)中，以便在你需要的时候方便地找到它</p><p id="0bcd" class="jn jo mw jp b jq jr js jt ju jv jw jx mx jz ka kb my kd ke kf mz kh ki kj kk ij bi">;)</p></blockquote></div><div class="ab cl om on hu oo" role="separator"><span class="op bw bk oq or os"/><span class="op bw bk oq or os"/><span class="op bw bk oq or"/></div><div class="ij ik il im in"><h2 id="cdd1" class="np lr iq bd ls nq nr dn lw ns nt dp ma jy nu nv me kc nw nx mi kg ny nz mm oa bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae kl" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>