<html>
<head>
<title>Understanding and Bypassing Rate Limiting's</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解和绕过速率限制</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/understanding-and-bypassing-rate-limitings-7c99a1252635?source=collection_archive---------2-----------------------#2022-07-14">https://infosecwriteups.com/understanding-and-bypassing-rate-limitings-7c99a1252635?source=collection_archive---------2-----------------------#2022-07-14</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/a38c6456044a4994d663bfb92028cd09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g42Mdx-kCUyeC1lc"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><strong class="bd kf">照片由</strong> <a class="ae kg" href="https://unsplash.com/@arget?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kf">目标</strong> </a> <strong class="bd kf">上</strong> <a class="ae kg" href="https://unsplash.com/s/photos/hacking?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kf">下</strong> </a></figcaption></figure><h1 id="fa83" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">介绍</h1><p id="e099" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">当您查看网站并在短时间内提交多次重复请求时，网站可能会要求您填写验证码或要求额外验证。如果发生这种情况，您需要遵从请求。这种做法被称为“速率限制”这意味着一旦网站检测到请求可能来自计算机机器人或任何其他自动化工具，网站将开始限制您或您的浏览器发出请求的速度。出于各种原因，可以这样做，包括保护应用程序资源，为用户提供良好的网站响应时间，以及偶尔保护用户帐户或用户免受暴力攻击。因为这些查询可能会被用来浏览或抓取整个网站，或者滥用用户登录，所以应该避免使用它们。</p><h1 id="7226" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">什么是速率限制？</h1><figure class="md me mf mg gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mc"><img src="../Images/98634bcacc6a25e49133e20a8d7dc4ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V3nBjp3HDYbmeRh0"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk translated"><a class="ae kg" href="https://snapsec.co/blog/Attacking-Rate-limit/" rel="noopener ugc nofollow" target="_blank"> <strong class="bd kf">来源</strong> </a></figcaption></figure><p id="c30e" class="pw-post-body-paragraph le lf it lg b lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb im bi translated">如果来自工具或用户的重复请求被发送到特定的端点，“速率限制”是一种有助于限制服务器发出的连续请求数量的方法。这种方法被称为“速率限制”这通常是为了保护网站或应用程序免受DOS攻击；然而，它也可能有许多其他问题，包括用户名和密码的暴力破解，以及有时防止一次性密码或其他参数的暴力破解。</p><p id="25dd" class="pw-post-body-paragraph le lf it lg b lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb im bi translated">有许多不同的终端或功能需要实施速率限制功能，例如登录、注册、忘记密码、双因素身份验证以及任何其他可能需要的情况，包括应用优惠券代码等。</p><p id="7b81" class="pw-post-body-paragraph le lf it lg b lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb im bi translated">以下面的场景为例:应用程序根据发送给用户的OTP执行身份验证。如果在特定的端点上没有速率限制，攻击者可以很容易地破坏OTP并登录受害者的帐户。OTP由四个数字组成。</p><h2 id="4681" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated"><strong class="ak">限速的用途:</strong></h2><ol class=""><li id="1084" class="my mz it lg b lh li ll lm lp na lt nb lx nc mb nd ne nf ng bi translated">减少服务器上的负载，从而提高性能和资源利用率。</li><li id="ab45" class="my mz it lg b lh nh ll ni lp nj lt nk lx nl mb nd ne nf ng bi translated">消除暴力攻击不同端点的可能性，例如登录、OTP验证以及忘记密码。</li><li id="c650" class="my mz it lg b lh nh ll ni lp nj lt nk lx nl mb nd ne nf ng bi translated">降低DOS攻击的概率。</li></ol><h1 id="57b8" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">它们为什么会发生？</h1><p id="0bb6" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">登录功能是每个应用程序的标准功能。登录帐户时，用户有多种选择，例如输入密码或一次性密码(OTP)。由于最近发生的大量违规事件，大量用户名和密码已经公开。如果特定端点上没有速率限制，攻击者可能会使用通过漏洞获取的用户名和密码来测试和查找网站上的帐户。因此，可以利用它来控制用户帐户。因此，即使用户使用OTP登录到他们的帐户，攻击者也有可能强行使用OTP登录到用户帐户。即使用户正在使用OTP，这种情况也是可能的。</p><h1 id="be00" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">绕过限速保护？</h1><p id="714f" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果在网站上应用了速率限制，那么如果没有正确实施速率限制，可以通过使用特定的标题或IP轮换来轻松绕过该限制。可以通过各种不同的方法绕过网站上的限速保护。让我们谈谈那些</p><h2 id="c44e" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated">通过在请求中使用标头</h2><p id="260b" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果使用的话，有几个报头可以绕过速率限制。由于有可能在后端欺骗IP，用户也可能绕过一些内部验证，所以这些头主要是那些头。如果使用这些报头，可以绕过速率限制。</p><h2 id="a18f" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated">x转发主机</h2><p id="5b3a" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">以便确定哪个主机名被用来连接或发送请求到API或web服务器。在反向代理或云架构的情况下，许多网站托管在一台物理服务器上，主机名会有所不同。在这两种情况下，主机名都不会相同。该报头有助于保护用户的隐私，这是它提供的另一个重要功能。因此，如果提供了大量虚构的主机名，您就有可能绕过服务器上设置的速率限制。</p><blockquote class="nm nn no"><p id="55d0" class="le lf np lg b lh mh lj lk ll mi ln lo nq mj lr ls nr mk lv lw ns ml lz ma mb im bi translated"><em class="it">X-Forwarded-For:</em><a class="ae kg" href="http://www.test.com" rel="noopener ugc nofollow" target="_blank">T3【www.test.com】T5】</a></p></blockquote><h2 id="f258" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated">x-转发-用于</h2><p id="0d74" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">这个头是用来计算最初发出请求的计算机的IP地址的。这通常包含在服务器端，以便在发送请求时捕获用户的IP地址。这可用于确定通过HTTP代理或负载平衡器连接到web服务器的用户的互联网协议地址(IP地址)。如果你发送这个头，然后操纵这个头的值中的IP地址，网站就会认为有大量不同的IP地址在尝试连接服务器。如果他们阻止了其中一个IP地址，那么您可以添加另一个IP地址，这意味着您可以强制IP地址的八位字节来欺骗请求。正因为如此，它会绕过速率限制。该标题可以以这种格式使用。</p><blockquote class="nm nn no"><p id="1752" class="le lf np lg b lh mh lj lk ll mi ln lo nq mj lr ls nr mk lv lw ns ml lz ma mb im bi translated"><em class="it">X-forward-For:127 . 0 . 0 . 1</em></p></blockquote><p id="56f6" class="pw-post-body-paragraph le lf it lg b lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb im bi translated">您可以使用入侵者来改变IP地址的最后一个八位字节，或者您可以收集一个IP地址列表，并在这个报头中作为有效载荷发送它们。</p><h1 id="280f" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated"><strong class="ak">其他绕行方式</strong></h1><p id="1b2c" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果攻击者希望避开登录面板提供的限速保护。他可以通过在用户名的末尾添加字符“空格”来做到这一点。这将导致空间在后端被截断，之后用户名将被处理；因此，绕过速率限制是可能的。</p><p id="ceec" class="pw-post-body-paragraph le lf it lg b lh mh lj lk ll mi ln lo lp mj lr ls lt mk lv lw lx ml lz ma mb im bi translated">以防攻击者希望规避登录提供的限速保护。他可以在两个用户名的末尾添加“空字节”。</p><h1 id="e5aa" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">使用打嗝分机的IP旋转</h1><p id="126c" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">我们可以在扩展中添加一项功能，该功能仅在Burp的企业版中提供。因此，为了轮换IP地址，我们提供了称为IP轮换的功能。这个插件利用AWS API网关，每个请求都通过适当区域中的API网关端点进行路由，每个目标请求的源IP都被更改。如果速率限制功能是基于攻击者的IP地址实现的，攻击者将利用此功能来绕过这些功能。</p><h1 id="3904" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">补救</h1><h2 id="3e32" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated"><strong class="ak">密码长度</strong></h2><p id="68aa" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">更长、更难的密码应该是防止暴力攻击的第一步。目前使用的大多数网站和在线平台都要求其用户生成长度在8到16个字符之间的密码，并且包含字母字符、数字字符和特殊字符的组合。</p><h2 id="a084" class="mm ki it bd kf mn mo dn km mp mq dp kq lp mr ms ku lt mt mu ky lx mv mw lc mx bi translated"><strong class="ak">限制登录尝试</strong></h2><p id="1f17" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">限制任何身份验证端点上的登录尝试次数的操作很简单，但会产生重大影响。一旦达到限制，总是建议冻结用户帐户并阻止违规用户的IP地址。</p><h1 id="70b2" class="kh ki it bd kf kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld bi translated">结论</h1><p id="f71a" class="pw-post-body-paragraph le lf it lg b lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb im bi translated">如果我们实现了速率限制，它不仅可以保护应用程序免受DOS和其他形式的攻击，还可以保护它免受暴力攻击。因为它可能会给应用程序的工作方式带来问题。因此，必须确保速率限制始终适用于应用程序。如果没有正确应用速率限制，则有可能危及用户帐户的安全，并可能导致用户帐户上的大量垃圾邮件。</p></div></div>    
</body>
</html>