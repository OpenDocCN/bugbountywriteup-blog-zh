<html>
<head>
<title>Phonebook, the way to DoS a company</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">电话簿，做公司的方法</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/phonebook-the-way-to-dos-a-company-87d342c613b5?source=collection_archive---------1-----------------------#2022-03-08">https://infosecwriteups.com/phonebook-the-way-to-dos-a-company-87d342c613b5?source=collection_archive---------1-----------------------#2022-03-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="85e8" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我不得不把我的个人信息添加到电话簿中，这是我不喜欢的，所以我关掉了服务器；)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/cdb9e862719cfba2181d13458c1c317b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*Hn9eMWXyW6pBbQtVRAQp7g.png"/></div></figure><p id="f55f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">分配给我一个任务:黑掉<code class="fe lj lk ll lm b">phonebook.company.net</code> <br/>于是，我启动了我的思想黑客引擎…</p><p id="51ce" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在做pentest的时候，我总是追求最高的冲击力。<br/>但最高影响力的定义会因目标的业务模式而异。</p><p id="8939" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">让我解释一下。<br/>假设目标是一个新闻网站。数据的有效性和完整性是目标的核心业务模型。<br/>因此，一个让攻击者能够修改网站内容的漏洞会产生重大影响，并破坏公司的声誉。<br/>例如，考虑存储的XSS，这个bug通常被列为高影响，但在这种情况下，它是一个关键的bug。</p><p id="5db9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我的目标是为其他公司提供技术支持，他们的团队需要在最短的时间内联系客户。<br/>客户的联系信息存储在内部服务器:<code class="fe lj lk ll lm b">phonebook.company.net</code></p><p id="ca8f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">那么，这里的<em class="ln">最高冲击</em>是什么呢？如果你让电话簿服务器停止服务，公司的业务会突然停止… <br/>被摧毁，生意是无情的。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="fcb3" class="lv lw iq bd lx ly lz dn ma mb mc dp md kw me mf mg la mh mi mj le mk ml mm mn bi translated">第一部分:做吧</h2><p id="f44d" class="pw-post-body-paragraph kn ko iq kp b kq mo jr ks kt mp ju kv kw mq ky kz la mr lc ld le ms lg lh li ij bi translated">我开始使用web应用程序来理解它的工作流程。<br/>让我来描述一下应用程序。<br/>有三种不同的访问级别:<br/> <strong class="kp ir">用户</strong>:修改自己的联系信息<br/> <strong class="kp ir">员工</strong>:修改自己的联系信息，搜索联系信息<br/> <strong class="kp ir">管理员</strong>:修改所有用户的联系信息，搜索联系信息</p><p id="c94f" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这个应用程序有三个部分。搜索页面<br/> 2。用户资料<br/> 3。管理部</p><p id="a8f5" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我的测试账户有用户特权，我可以添加我自己的联系信息。修改用户数据的<code class="fe lj lk ll lm b">PUT</code>请求的主体是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/3ca46078a6361ff6987566684ffb7c45.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*D5cWjj7QT4VL9KlhHAzXkQ.png"/></div></figure><p id="d19a" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">使用GUI时，添加联系信息有一个限制。我最多只能在我的联系信息部分添加五条记录。所以，我修改了我的详细信息，截取了请求，手动地在<code class="fe lj lk ll lm b">contactInfo</code>数组中添加了三条记录，并发送了请求。服务器只是简单地接受了它，现在我的个人资料页面上有8条记录。</p><p id="383d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">好吧，但是这个简单的行为能有用吗？<br/>当然，因为当我可以绕过客户端限制，再添加三条记录时，这意味着我可以……<br/>向后端数据库添加无限制的记录，<br/>用完服务器的存储，<br/>增加搜索结果中包含我的个人资料的搜索过程的时间，<br/>增加处理我的个人资料所需的RAM存储量。</p><p id="98c3" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">听起来像是DoS，不是吗？🙂</p><p id="aee9" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">运行phonebook应用程序的服务器并没有那么强大，只是一台处理内部团队请求的普通机器。因此，我可以更快地确认漏洞，而无需在我的个人资料中添加大量记录。</p><p id="37af" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我添加了几千条记录，当我搜索我的名字时，服务器的响应时间急剧增加。再加几千个，一分钟后也没有反应。</p><p id="5d29" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">DoS确认。📛</p><h2 id="be23" class="lv lw iq bd lx ly lz dn ma mb mc dp md kw me mf mg la mh mi mj le mk ml mm mn bi translated">第二部分:多做…</h2><p id="8730" class="pw-post-body-paragraph kn ko iq kp b kq mo jr ks kt mp ju kv kw mq ky kz la mr lc ld le ms lg lh li ij bi translated">正如我提到的，当我搜索我的名字时，DoS发生了，但是当我搜索别人的名字时，服务器反应很快。<br/>我的意思是:<br/>al…Alex…alexan…Alexander…Alexander…<br/>—服务器对任何一步都没有反应<br/>但是当我搜索我同事的名字:<br/> Mi… Mich… Michael… <br/> —服务器对每一步都反应很快</p><p id="1920" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">也就是说，只有当我的帐户出现在搜索结果中时，DoS才会发生。<br/>换句话说，员工无法使用服务器查找姓名与我的姓名首字母相同的客户。那影响有限，我不想要。所以…让我们做得更多😏</p><p id="a165" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我需要变点魔法，让我的账户出现在任何搜索的结果中。<br/>一如既往，问题是“如何做？”</p><p id="1415" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">搜索页面中实现了一个功能，使员工的搜索变得更容易，所以我用它来增加他们的搜索难度🙃</p><p id="3734" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">当您在搜索框中键入内容时，应用程序会搜索客户姓名<strong class="kp ir">以及他们联系信息记录的</strong>值——某种反向搜索:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/bb8611328fc7243bd2155eee7fe2db27.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*hqmHzL8CjH5PNgxa9DiCew.png"/></div></figure><p id="beb7" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">多么好的<em class="ln">功能</em>，感谢开发团队:)</p><p id="64bc" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">所以我写了一个小脚本来生成字母和数字的随机组合，并将它们添加为我的联系信息的<em class="ln">值</em>。这样，无论员工搜索什么，我的帐户都会出现在搜索结果中…</p><p id="f149" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">服务器关闭💀</p><h2 id="45fb" class="lv lw iq bd lx ly lz dn ma mb mc dp md kw me mf mg la mh mi mj le mk ml mm mn bi translated">第三部分:不够，继续努力！！</h2><p id="ea7a" class="pw-post-body-paragraph kn ko iq kp b kq mo jr ks kt mp ju kv kw mq ky kz la mr lc ld le ms lg lh li ij bi translated">如果不能用直接添加更多记录的方法来DoS服务器，那该怎么办？</p><p id="7fcf" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">亲提示:<br/> </strong>学好JSON结构。<br/>当你遇到JSON数据时，试着改变“值”的类型。<br/>如果是整数，把它转换成字符串，可能会有一个SQLi。如果它是一个包含安全令牌的字符串，用<code class="fe lj lk ll lm b">null</code>替换它，你可能会发现一个认证旁路。如果它是一个包含OTP的字符串，把它变成一个数组，你就可以一次破解所有可能的代码。</p><p id="884c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我使用了最后一个技巧，但不是强行添加任何东西，来添加比正常情况更多的数据:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/ed684a21ed3d3ba0227e880b73338bbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1042/format:webp/1*lRG-bCjwXjIrkQ9tcoixxA.png"/></div></figure><p id="d87c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我发送了请求，服务器接受了它。这意味着我可以向数组中添加无限的元素，并尽可能多地使用存储和RAM。<br/>老一套，另一个DoS:)</p><p id="98f8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这样，即使我不能添加超过五条记录，也有可能DoS服务器。</p><h2 id="df47" class="lv lw iq bd lx ly lz dn ma mb mc dp md kw me mf mg la mh mi mj le mk ml mm mn bi translated">第四部分:消灭你的对手，只需49.99美元</h2><p id="f9e1" class="pw-post-body-paragraph kn ko iq kp b kq mo jr ks kt mp ju kv kw mq ky kz la mr lc ld le ms lg lh li ij bi translated">这是一台内部服务器，只有员工可以访问，攻击者如何利用它呢？</p><p id="5a7c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">正如我之前提到的，有三个访问级别:<br/>用户<br/>员工<br/>管理员</p><p id="4e25" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">员工和管理员可以直接登录到服务器，但是在具有<code class="fe lj lk ll lm b">user</code>访问级别的帐户和服务器之间存在反向代理。因为<code class="fe lj lk ll lm b">user</code>账户属于客户，他们添加和修改联系信息的请求由API提供服务。</p><p id="c14d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这里是攻击场景:<br/>假设你是一家公司，与我的目标公司竞争市场。你去他们的网站，表现得像一个想要支持他们业务的人，花49.99美元买他们最便宜的服务。然后你进入你的个人资料，添加数以千计的联系信息记录… <br/>因为你想确保他们能在必要时与你取得联系😏</p><p id="0fa2" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">…他们失去了市场，RIP。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="184c" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">有帮助吗？ <br/>我不要求你给我买杯咖啡，<br/>教我点什么… <br/>不和:<code class="fe lj lk ll lm b"><strong class="kp ir">REDN#9702</strong></code></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="0edb" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Infosec Writeups团队刚刚完成了我们的第一次虚拟网络安全会议和网络活动。我们有16位出色的演讲者，他们主持了非常有价值和鼓舞人心的会议。要查看演讲者和主题列表，请点击此处。</p><div class="mx my gp gr mz na"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fo"><div class="nc ab nd cl cj ne"><h2 class="bd ir gy z fp nf fr fs ng fu fw ip bi translated">IWCon2022 — Infosec书面报告虚拟会议</h2><div class="nh l"><h3 class="bd b gy z fp nf fr fs ng fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="ni l"><p class="bd b dl z fp nf fr fs ng fu fw dk translated">iwcon.live</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no kl na"/></div></div></a></div></div></div>    
</body>
</html>