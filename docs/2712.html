<html>
<head>
<title>Unauthorized Sign-up on Subdomain of Subdomain leading to Organization takeover worth $2000</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在子域上的未授权注册导致价值2000美元的组织接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/unauthorized-sign-up-on-subdomain-of-subdomain-leading-to-organization-takeover-worth-2000-a7199952d80b?source=collection_archive---------1-----------------------#2022-12-28">https://infosecwriteups.com/unauthorized-sign-up-on-subdomain-of-subdomain-leading-to-organization-takeover-worth-2000-a7199952d80b?source=collection_archive---------1-----------------------#2022-12-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2d3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，我在这里分享另一篇四位数的文章，这是我非常老的发现之一。如果你还没有读过我之前写的关于我如何能够绕过所有端点上的强速率限制机制的文章，那么下面是它的链接:</p><div class="kl km gp gr kn ko"><a href="https://medium.com/@manavbankatwala29/unique-rate-limit-bypass-worth-1800-6e2947c7d972" rel="noopener follow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">价值1800美元的独特限速旁路</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">用OOS速率限制旁路证明组织声明是错误的。</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">medium.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><h1 id="bfc0" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">从初始阶段开始。</strong></h1><p id="35cd" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">当我最初发布这个bug的时候，很多人对标题感到困惑。这是我使用的完整的文章和方法。在我发现这个bug的时候，我刚刚开始了我的bug赏金之旅，之前我阅读了很多电子书和文章。</p><p id="03d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定随机选择一个目标，我知道只有提到的域和子域在范围内。所有其他子域被认为超出了范围。他们还在政策中提到<strong class="jp ir"> *.target.com </strong>不在范围内，但target.com在范围内。这是因为该公司实际上为他们的客户提供了某种服务，允许他们定制子域，如<strong class="jp ir"> client1.target.com，client2.target.com. </strong>由于这一点，他们限制在任何子域上进行测试。那么，当这种类型的目标穿过我们的大脑时，该怎么办呢？我想到的第一个想法是，也许我应该试着找到他们子域上的任何关键漏洞，因为由于他们的政策，没有多少研究人员检查过。</p><p id="c358" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我做的第一件事是找到子域，但不是用我们通常的方法。相反，我使用子域枚举词表，其中包含像应用程序，开发，开发，服务，应用程序开发等词。</p><p id="db4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用这种方法提取了非常有限的子域，其中有一个子域像<strong class="jp ir">services.target.com。在访问这个子域时，它显示了一个DNS错误，但我仍然不知道这是如何在子域枚举阶段被检测到的。接下来，我试着使用google dork，即<strong class="jp ir">网站:*.services.target.com </strong>，在那里我找到了一些来自<strong class="jp ir">public.services.target.com</strong>等域名的搜索结果。</strong></p><p id="3272" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您一定已经注意到该子域包含单词“services ”,这可能表明在该子域上还有更多的服务在运行。接下来，我提取了域“services.target.com”的子域。有趣的是，我发现了一个子域“<strong class="jp ir">sserver.services.target.com</strong>”。</p><h1 id="28ae" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated"><strong class="ak">该子域上有哪些内容？</strong></h1><p id="a546" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">这个页面包含一个普通的登录页面，通过观察UI，我猜测它是用来管理源代码和其他东西的，方法是直接访问github帐户。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mh"><img src="../Images/43b4a46b20ca05bda7d186b1c86a109b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xHKKvG8bFMwG54SM8_PtvQ.png"/></div></div></figure><p id="3425" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，这个登录门户可能是为员工准备的，只有员工才有权进一步访问。现在，我只是想知道下一步该做什么，搜索JS文件，使用github呆子为凭证泄漏等。但是没有什么有趣的事情发生，因为这个领域在任何地方都没有被提及。</p><h1 id="5f32" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">有趣的部分来了！</h1><p id="6a60" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated">我观察到的网址是“/登录？returnTo=%2F。并试图将“登录”更改为其他网址，如“注册”、“开始”和简单的<strong class="jp ir">“注册”</strong>向我显示了一个注册页面，要求输入电子邮件、用户名和密码。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi ms"><img src="../Images/d793c02c0713532a913b7a707f17668a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WMIYD_2UKHCb6mQLDckU7A.png"/></div></div></figure><p id="7da3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我仍然怀疑，在点击注册后，它可能会显示错误，注册是不可能的，就像JIRA。但是你猜怎么着？它允许我注册使用我的电子邮件，我成功地登录到帐户。</p><p id="5bf4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一个任务是看看我们有什么权限，我们能看到什么敏感信息。我简直不敢相信自己的眼睛，他们使用这个服务器门户来管理他们所有的github代码。甚至是私人仓库。任何新用户都可以直接访问该门户上共享的所有代码。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mt"><img src="../Images/2317a02023e2c2a6882580ef064be215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NNuPVrFqkRgLjGgB9ymK3Q.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">如果直接通过github访问，通常它是一个私有的存储库</figcaption></figure><p id="254b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，当我试图从门户访问同一个回购时，它很容易被访问，我能够看到所有的凭据以及任何秘密文件。</p><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div class="gh gi my"><img src="../Images/0052ed6e6759719ba84196b833b18f87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*-r2ANYWy0ivMYlHJ5YVzTg.png"/></div></figure><figure class="mi mj mk ml gt mm gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mz"><img src="../Images/ad5eb80b9a425b7b563615d2dfe35e01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pj8Z22r92TUe0SMYdBq_Dw.png"/></div></div><figcaption class="mu mv gj gh gi mw mx bd b be z dk translated">包含一些秘密令牌的秘密文件</figcaption></figure><p id="42a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们所有私有存储库都是可访问的，他们所有的秘密API密钥和管理员帐户凭证都是可见的。这是一次彻底的组织接管。当他们向许多客户提供服务时，他们所有的客户数据也可以通过这些公开的凭证进行访问。</p><p id="a963" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我立即创建了一个报告，团队在40分钟内对该报告进行了分类和修复，使得公众无法访问该门户。他们还轮换任何暴露的凭证。他们给了我最高的奖金，即2000美元</p><p id="4e64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">提示:即使有些事情不在范围之内，也要试一试。不要尝试激进的测试，但仍然要寻找任何关键的漏洞。</strong></p><p id="76ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">甚至寻找子域的子域，如果你觉得任何可疑的子域运行。</strong></p><p id="9f18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">查找任何可能包含“服务”、“内部”等词语的端点。并寻找任何可用的开放服务。</strong></p><p id="31c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样，伙计们，我希望你喜欢它，如果你觉得它有帮助，请分享。</p><h1 id="80c6" class="le lf iq bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">关注我以获取最新更新:</h1><p id="14bf" class="pw-post-body-paragraph jn jo iq jp b jq mc js jt ju md jw jx jy me ka kb kc mf ke kf kg mg ki kj kk ij bi translated"><a class="ae na" href="https://www.linkedin.com/in/manavbankatwala/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/manavbankatwala/</a></p><p id="54ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae na" href="https://www.instagram.com/manav.bug/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/manav.bug/</a></p><p id="91c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae na" href="https://twitter.com/manavbankatwala" rel="noopener ugc nofollow" target="_blank">https://twitter.com/manavbankatwala</a></p></div><div class="ab cl nb nc hu nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ij ik il im in"><h2 id="3181" class="ni lf iq bd lg nj nk dn lk nl nm dp lo jy nn no ls kc np nq lw kg nr ns ma nt bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae na" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4条线索、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>