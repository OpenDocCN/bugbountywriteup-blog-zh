<html>
<head>
<title>TryHackMe: Reversing ELF Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TryHackMe:反转ELF记录</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/tryhackme-reversing-elf-writeup-6fd006704148?source=collection_archive---------0-----------------------#2020-09-01">https://infosecwriteups.com/tryhackme-reversing-elf-writeup-6fd006704148?source=collection_archive---------0-----------------------#2020-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3d5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章展示了我解决由<strong class="jp ir"> mrpvr </strong>创建的<strong class="jp ir">倒车精灵</strong>房间的方法，可在TryHackMe平台上免费获得。这个房间包含8个初学者难题，难度随着你的进步而增加。我在下面提供了一个TryHackMe平台的链接，供有兴趣尝试这些挑战的人使用。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/5ef5ce06abc030bf148433947ad23c2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*Iqj5RXZ2dN7iPVGRuxj7EA.png"/></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="df67" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme1</h1><blockquote class="ly lz ma"><p id="9399" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">让我们从一个基本的预热开始，你能运行二进制吗？</p></blockquote><p id="d91a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战提供了一个要求我运行的二进制文件。使用<strong class="jp ir">文件</strong>命令，我可以看到根据房间的标题，它是一个精灵二进制文件。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="d41b" class="mk lb iq mg b gy ml mm l mn mo">file crackme1</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mp"><img src="../Images/5f3b4d61d60a8c046202327391094763.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f3MoOV13jczOMpVNUXVgZg.png"/></div></div></figure><p id="5f0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用chmod命令，我可以使文件可执行，然后运行ELF二进制文件来获取标志。很好很容易！</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="b60c" class="mk lb iq mg b gy ml mm l mn mo">chmod +x crackme1</span><span id="3a07" class="mk lb iq mg b gy mu mm l mn mo">./crackme1</span></pre></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="5c50" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme2</h1><blockquote class="ly lz ma"><p id="e4c5" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">找到超级秘密密码！并使用它来获取标志</p></blockquote><p id="d251" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该挑战提供了一个ELF二进制文件，需要密码才能获得标志。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="6850" class="mk lb iq mg b gy ml mm l mn mo">./crackme2 <strong class="mg ir">password</strong></span></pre><p id="b4fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只需使用<strong class="jp ir"> strings </strong>命令就可以获取二进制文件的密码。密码可以在输出中看到。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="be85" class="mk lb iq mg b gy ml mm l mn mo">strings crackme2</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/800378e6137375f4e85373ab0961f49d.png" data-original-src="https://miro.medium.com/v2/resize:fit:488/format:webp/1*bf4iaKXi43p1UkcnEz_MpQ.png"/></div></figure><p id="ed78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将此密码作为二进制文件的输入提供给标志。</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="89eb" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme3</h1><blockquote class="ly lz ma"><p id="ed34" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">使用基本的逆向工程技能获得旗帜</p></blockquote><p id="ecc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提供了一个ELF二进制文件，它需要密码才能检索标志。可以使用与crackme2相同的方法来检索密码，但是多了一个步骤。使用<strong class="jp ir"> strings </strong>命令，我找到了一个<strong class="jp ir"> base64编码的字符串</strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mw"><img src="../Images/339bea6be26d9c86e8f439e261ada978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hU0jCWQc2lJFMPl0DQh8iQ.png"/></div></div></figure><p id="d58f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<strong class="jp ir"> CyberChef </strong>，我可以解码字符串并检索密码，结果是旗帜。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mx"><img src="../Images/e6ce42096acc9b98788bcfd2751255f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUYT1K0EiFmRnaiQfLMFiw.png"/></div></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="37d9" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme4</h1><blockquote class="ly lz ma"><p id="9da1" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">分析并找到二进制文件的密码？</p></blockquote><p id="caf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在没有密码的情况下运行ELF二进制文件，我得到了以下消息。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi my"><img src="../Images/a336bfd39dfed9ec4e3a955da1177ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*FAwrmUihMuPKIL9Zpf9FEg.png"/></div></figure><p id="57c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个提示告诉我，ELF二进制文件使用了<strong class="jp ir"> strcmp </strong>函数。我决定用<strong class="jp ir"> gdb调试器</strong>调试二进制。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="355c" class="mk lb iq mg b gy ml mm l mn mo">gdb crackme4</span></pre><p id="358d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我使用gdb列出了二进制文件中的不同函数。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="f556" class="mk lb iq mg b gy ml mm l mn mo">(gdb) info functions</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/68c77b857121b31fec7450312e449eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*H89DAjRopx61gkQsG2M6Ng.png"/></div></figure><p id="3052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有几个有趣的函数名很突出，包括<strong class="jp ir"> main </strong>、<strong class="jp ir"> get_pwd </strong>、<strong class="jp ir"> </strong>和<strong class="jp ir"> compare_pwd </strong>。但是，根据提供的消息，我对<strong class="jp ir"> strcmp@plt </strong>函数感兴趣。我们可以假设通过<strong class="jp ir"> strcmp() </strong>将输入的密码与正确的密码进行了比较。使用gdb，我决定在这个函数的内存地址设置一个<strong class="jp ir">断点</strong>。</p><blockquote class="ly lz ma"><p id="15f3" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">注意:在软件开发中，<strong class="jp ir">断点</strong>是<strong class="jp ir">程序</strong>中有意停止或暂停的地方，放置在适当的位置用于调试目的，并帮助获取关于<strong class="jp ir">程序</strong>在其执行期间的知识。</p></blockquote><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="e830" class="mk lb iq mg b gy ml mm l mn mo">(gdb) b *0x0000000000400520</span></pre><p id="cea0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设置好断点后，我现在可以用一些测试输入在gdb中运行二进制文件了。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="e4c6" class="mk lb iq mg b gy ml mm l mn mo">(gdb) run test</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi na"><img src="../Images/9ec3ecac026ea315f1fa9866a54c0a9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*emri9gNdsU_gYzDtT1nh5Q.png"/></div></figure><p id="d00f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上图所示，二进制文件一直执行到遇到断点。接下来，我可以用gdb查看寄存器的当前状态。</p><blockquote class="ly lz ma"><p id="8685" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">注意:寄存器本质上是处理器中的小存储区域，可以用来存储任何用8个字节或更少字节表示的内容。</p></blockquote><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="fb45" class="mk lb iq mg b gy ml mm l mn mo">(gdb) info registers</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/cc6f2c2d6f219fdb332273bc1cbb7cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1258/format:webp/1*7nS3rYRB8FV5I-YOHKjc-g.png"/></div></figure><p id="4a69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看上面的输出，我可以看到寄存器的名称，十六进制格式的寄存器值和gdb认为最合适的格式的寄存器值(十六进制表示指针，十进制表示其他)。我可以看到通用寄存器<strong class="jp ir"> rax </strong>和<strong class="jp ir"> rdx </strong>有内存地址值。我可以使用gdb在这些地址打印字符串。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="1607" class="mk lb iq mg b gy ml mm l mn mo">(gdb) x/s 0x7fffffffe030</span></pre><p id="b83b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这向我显示了我在执行二进制文件时作为输入提供的字符串，以及用于与我的输入进行比较的密码/标志。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/b3d810e7505b3bdc4138093fc5c0c23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*zZPDn3RW2zVjECWF3sFXnw.png"/></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="ab1c" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme5</h1><blockquote class="ly lz ma"><p id="2c72" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">得到输出<code class="fe nd ne nf mg b">Good game</code>的文件的输入是什么？</p></blockquote><p id="4023" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这个ELF二进制文件，我的任务是提供一些输入，输出消息“<strong class="jp ir">好游戏</strong>”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/6d94c3248023cb4b09dc0765e5db7508.png" data-original-src="https://miro.medium.com/v2/resize:fit:392/format:webp/1*5buIcfvO4i8QT6L8Ag-73g.png"/></div></figure><p id="5be3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用gdb，我在二进制文件中列出了不同的函数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nh"><img src="../Images/7559ca566cff20c1916eb1439dfbabda.png" data-original-src="https://miro.medium.com/v2/resize:fit:930/format:webp/1*ZGxAdiBKAxgTtRsRGHXNbA.png"/></div></div></figure><p id="4f46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与Crackme4中不同，二进制文件现在使用的是<strong class="jp ir">strcmp @ PLT</strong>而不是<strong class="jp ir"> strcmp@plt </strong>。查看rax和rcx寄存器的内存地址字符串值给了我必要的输入，以获得输出消息“Good game”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/f055d0dbb99360309157bef1cb03fb7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*L023Li66ZG3DU5xEXpYE6w.png"/></div></figure><p id="a96f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样的方法也可以与<strong class="jp ir"> strcmp_ </strong>函数一起使用来检索标志。</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="1bcc" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme6</h1><blockquote class="ly lz ma"><p id="bf52" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">分析易密码的二进制文件</p></blockquote><p id="2d78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在没有密码的情况下运行ELF二进制文件会显示一条消息，告诉我查看<strong class="jp ir">源代码</strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/3cc1b6730e39878226b7f914ed44f215.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*i2H_kvPhPJUHRnmcjBHC_g.png"/></div></figure><p id="01ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于这个挑战，我将使用<strong class="jp ir"> Ghidra </strong>，一个软件逆向工程(SRE)工具套件。我将crackme6二进制文件加载到Ghidra中，GHI DRA对二进制文件进行反编译，并为我提供源代码。我从查看<strong class="jp ir">主</strong>函数开始。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/93058f1eed1ee08d9bf938ba8e826924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*V2OaGCt0sVZjPp-9TxEJ3g.png"/></div></figure><p id="012c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我可以看到密码的输入被传递给了一个名为<strong class="jp ir"> compare_pwd </strong>的函数，其源代码可以在下面看到。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/56a7df918b169877bdb2f387ba9963f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*FvHhzwgoKDIC8dJ4E2fcrg.png"/></div></figure><p id="70d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该函数获取密码并将其传递给另一个名为<strong class="jp ir"> my_secure_test </strong>的函数。查看这个函数的源代码可以发现一个<strong class="jp ir"> if else </strong>语句块，它检查输入中的每个字母是否对应于一个<strong class="jp ir">指定的字符串值</strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/fec2dea67fd7fb68f7de97d513bde4d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*tZ1cmoygf3aP0pHUHtL4TA.png"/></div></figure><p id="e1d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将这些指定的字符串值重新组合成一个字符串提供了标志(即“1”、“3”、“3”、“7”等)..).</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="f1b2" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme7</h1><blockquote class="ly lz ma"><p id="9953" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">分析二进制文件以获取标志</p></blockquote><p id="d7f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行ELF二进制文件为我提供了三个不同的任务，我可以通过输入相应的数字来执行它们。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/37b9f0983bd1c45b22a5b2e28d00b534.png" data-original-src="https://miro.medium.com/v2/resize:fit:364/format:webp/1*XPiB_mj_AsCvI-g3G7IDZw.png"/></div></figure><p id="eb15" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我决定用Ghidra来反编译二进制的源代码。查看<strong class="jp ir"> main </strong>函数的源代码，我可以看到用户输入的数字被<strong class="jp ir"> if else </strong>语句检查，然后根据输入的值执行一个动作。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi no"><img src="../Images/8758b6dd47295ded9edfc1c1284d58b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*TtUOvfD7v6z_Sxp6Wq_jPQ.png"/></div></figure><p id="b221" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我注意到似乎有一个隐藏的选项运行一个叫做<strong class="jp ir"> giveFlag() </strong>的方法。要触发此选项，我需要输入十进制格式的十六进制值<strong class="jp ir"> 0x7a69 </strong>，即<strong class="jp ir"> 31337 </strong>。这给了我旗子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi np"><img src="../Images/94860dfb9698647e3b4260670f84ff82.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*P7cgoxTA1DRTMy3qoCaK8Q.png"/></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="104f" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">Crackme8</h1><blockquote class="ly lz ma"><p id="616a" class="jn jo mb jp b jq jr js jt ju jv jw jx mc jz ka kb md kd ke kf me kh ki kj kk ij bi translated">分析二进制文件并获取标志</p></blockquote><p id="1df8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是另一个ELF二进制文件，它请求密码以获得标志。如前所述，我使用Ghidra反编译二进制文件，并开始查看主函数的反编译源代码。我可以看到，在检查输入是否等于<strong class="jp ir"> -0x35010ff3之前，输入被传递给一个名为<strong class="jp ir"> atoi() </strong>的函数。</strong></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/f947b483287bb5a8a2cfcc14697f8ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*9L4_M4XKeA6DpPt6ZkanvQ.png"/></div></figure><p id="1eac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> atoi() </strong>函数是C编程语言中的一个函数，<strong class="jp ir">将字符串转换成整数</strong>数值表示。我可以把<strong class="jp ir"> -0x35010ff3 </strong>的值转换成十进制，也就是<strong class="jp ir"> -889262067 </strong>，然后作为密码传递给二进制，得到标志。</p><pre class="km kn ko kp gt mf mg mh mi aw mj bi"><span id="5034" class="mk lb iq mg b gy ml mm l mn mo">./crackme <strong class="mg ir">-889262067</strong></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi nr"><img src="../Images/ef45acd3214f0403e0759ec06a689e39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*68bhSUCrFP__f0S1xFPzrA.png"/></div></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="e7da" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结束语</h1><p id="e42c" class="pw-post-body-paragraph jn jo iq jp b jq ns js jt ju nt jw jx jy nu ka kb kc nv ke kf kg nw ki kj kk ij bi translated">我发现这些挑战真的很有趣，对于学习更多关于反转ELF二进制文件的人来说也很容易。这些挑战涵盖了如何对ELF二进制文件进行逆向工程的基础知识，可以帮助初学者了解更多关于逆向工程领域的知识。感谢阅读到最后，继续黑客😄！</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="b205" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">参考</h1><div class="nx ny gp gr nz oa"><a href="https://tryhackme.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd ir gy z fp of fr fs og fu fw ip bi translated">黑客培训</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">TryHackMe是一个学习和教授网络安全的在线平台，全部通过您的浏览器完成。</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">tryhackme.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo kr oa"/></div></div></a></div></div></div>    
</body>
</html>