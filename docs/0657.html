<html>
<head>
<title>How I was able to take over any account via the Password Reset Functionality.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我如何能够通过密码重置功能接管任何帐户。</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-was-able-to-take-over-any-account-via-the-password-reset-functionality-ef1659f8b481?source=collection_archive---------1-----------------------#2020-06-28">https://infosecwriteups.com/how-i-was-able-to-take-over-any-account-via-the-password-reset-functionality-ef1659f8b481?source=collection_archive---------1-----------------------#2020-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c8bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，这是我的第一篇文章，我将谈谈我在5月份的一个漏洞披露项目中发现的一个帐户接管事件。让我们假设<a class="ae km" href="https://target.com" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="kl"/></strong></a><strong class="jp ir"><em class="kl">是目标既然程序不允许公开披露。</em>T13】</strong></p><p id="9829" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我开始寻找一个新目标时，我做的第一件事就是浏览整个应用程序以了解它(它做什么，主要功能，使用的技术..)，之后，我测试了密码重置功能。</p><h2 id="11ce" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">我如何测试密码重置功能中的错误:</h2><ul class=""><li id="4d21" class="lg lh iq jp b jq li ju lj jy lk kc ll kg lm kk ln lo lp lq bi translated">我在发送请求时更换了主机。</li><li id="8326" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">我寻找令牌作为回应。</li><li id="64da" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">篡改id/电子邮件参数(如果有)(如果没有，添加它们)。</li><li id="9fb6" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">我收集了大量的代币，并通过问这样的问题来分析它们:</li><li id="6e8c" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">能解码吗？</li><li id="a113" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">这很残忍吗？</li><li id="d178" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">这是可以预测的吗？</li><li id="9812" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">令牌的哪一部分保持不变？</li></ul><p id="c094" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，当在target.com上测试密码重置功能时，前3个测试失败没有主机头注入，没有令牌泄漏，也没有ID/电子邮件参数。然而，在收集了大约8个令牌后，我发现令牌中有2个部分保持不变，另外2个部分每次都会改变。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/7f7279dd159fd5dca680ca7651c272f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*BuAE3xFjLyD6pMMkVC9clA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">绿色:保持不变/橙色:每次都变</figcaption></figure><p id="1e7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然每次变化的部分比静态部分小，但我仍然不能暴力破解令牌，因为橙色部分包含字母/数字，它们是随机的。所以我保存了令牌，做了一些笔记，然后开始测试其他功能。</p><p id="62fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3-5天后，当我阅读笔记时，我想再试一次。于是，我打开了<a class="ae km" href="https://target.com" rel="noopener ugc nofollow" target="_blank">https://target.com</a>，创建了另一个账户，手动发送了两个重置密码的请求(一个给我的第一个账户，一个给我的第二个账户)。拿到代币，把它们复制/粘贴到我的大写字母上，令我惊讶的是，代币只有最后3个字符不同。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/e726f14e90a99f14d53d999e7183a65a.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*H9vdeaqFS4gPPWCMGbfFnQ.png"/></div></figure><p id="1ed3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">似乎请求之间的持续时间越短，令牌越相似。</p><p id="b2d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">你可能会问，为什么我第一次收集代币时，得到了5个不同的字符。这是因为我一次发送一个请求，保存令牌并再次重复。</em>T19】</strong></p><p id="1d4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有2个令牌，它们的区别仅在于最后3个字符，但它们仍然是随机的。这使得暴力破解变得非常困难。所以，我想如果我用burp入侵者发送它们，我可能会得到更好的结果，因为入侵者发送请求比我的手更快:d .我启动BurpSuite，捕获请求，发送给入侵者:</p><ul class=""><li id="e3a7" class="lg lh iq jp b jq jr ju jv jy mj kc mk kg ml kk ln lo lp lq bi translated">有效载荷:我的两个帐户的电子邮件。</li><li id="8ddf" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">线程:20</li><li id="b41c" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">URL编码:关闭</li></ul><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/e30278423a02fb62f0e9d04a4860387a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*9qisBsvOQTbXnVD2SbAAlA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">入侵者的攻击载荷。</figcaption></figure><p id="dc30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，在配置了打嗝入侵者后，我发起了攻击，然后我得到了两个令牌，它们的区别仅在于最后一个字符。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/0c78a8f202204e7aa1fbe90ce38948ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*r9why59oOzrUzoK7ORLSoQ.png"/></div></figure><p id="0a38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">攻击场景:</p><ul class=""><li id="7df0" class="lg lh iq jp b jq jr ju jv jy mj kc mk kg ml kk ln lo lp lq bi translated">对于打嗝入侵者，我发送2个密码重置链接，一个给我，一个给受害者。</li><li id="214b" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">密码重置链接是这样的:<a class="ae km" href="https://exmaple.com/reset/5ec6ea8d546ca610758297e|2" rel="noopener ugc nofollow" target="_blank">https://exmaple.com/reset/5ec6ea8d546ca610758297e*2</a>*</li><li id="e82f" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">根据设计，如果我使用无效的令牌访问密码重置链接，应用程序不会显示更改密码的表单。因此，我只需更改最后一个数字，并检查表单是否在那里。</li></ul><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mo"><img src="../Images/dd0bedca9da9d707d4378d9bf981e0dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vJi8UcH4e6ZDK_CXkgq8GA.png"/></div></div></figure><p id="bf6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，我发现了一个API端点，我可以从这里枚举电子邮件地址，这将使攻击者更容易。</p><p id="bc29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后我报了bug。尽管它是VDP，他们还是给了我一笔奖金！</p><h1 id="d55f" class="mt ko iq bd kp mu mv mw ks mx my mz kv na nb nc ky nd ne nf lb ng nh ni le nj bi translated">外卖:</h1><ul class=""><li id="dbeb" class="lg lh iq jp b jq li ju lj jy lk kc ll kg lm kk ln lo lp lq bi translated">记笔记，这样当你学到新的东西或者有新的想法时，你就可以测试它们。</li><li id="362e" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">总是跳出框框思考，问好问题。</li></ul><p id="e666" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的推特:【https://twitter.com/Fatnass1F1ras T2】</p><p id="e166" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常感谢<a class="ae km" href="https://twitter.com/eh_rajesh" rel="noopener ugc nofollow" target="_blank"> Rajesh Ranjan </a>和<a class="ae km" href="https://twitter.com/dhakal_ananda" rel="noopener ugc nofollow" target="_blank"> Ananda Dhakal </a>检查这篇文章的草稿。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><h1 id="abb4" class="mt ko iq bd kp mu nr mw ks mx ns mz kv na nt nc ky nd nu nf lb ng nv ni le nj bi translated">🔈 🔈Infosec Writeups正在组织其首次虚拟会议和网络活动。如果你对信息安全感兴趣，这是最酷的地方，有16个令人难以置信的演讲者和10多个小时充满力量的讨论会议。<a class="ae km" href="https://iwcon.live/" rel="noopener ugc nofollow" target="_blank">查看更多详情并在此注册。</a></h1><div class="nw nx gp gr ny nz"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="oa ab fo"><div class="ob ab oc cl cj od"><h2 class="bd ir gy z fp oe fr fs of fu fw ip bi translated">IWCon2022 - Infosec书面报告虚拟会议</h2><div class="og l"><h3 class="bd b gy z fp oe fr fs of fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="oh l"><p class="bd b dl z fp oe fr fs of fu fw dk translated">iwcon.live</p></div></div><div class="oi l"><div class="oj l ok ol om oi on mc nz"/></div></div></a></div></div></div>    
</body>
</html>