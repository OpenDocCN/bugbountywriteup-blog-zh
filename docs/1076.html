<html>
<head>
<title>Hacking BugPoc’s 18 Game (XSS challenge) hosted by The XXS Rat</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客BugPoc的18游戏(XSS挑战赛)主办的XXS鼠</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hacking-bugpocs-18-game-xss-challenge-hosted-by-the-xxs-rat-f3f1adc04c8?source=collection_archive---------1-----------------------#2021-01-21">https://infosecwriteups.com/hacking-bugpocs-18-game-xss-challenge-hosted-by-the-xxs-rat-f3f1adc04c8?source=collection_archive---------1-----------------------#2021-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="084c" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">为什么我的标题是“黑客”，而这只是一个XSS挑战赛？因为没有解决挑战，所以黑了游戏。</p><p id="44e1" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">当你打开<a class="ae km" href="https://cards.buggywebsite.com/" rel="noopener ugc nofollow" target="_blank">挑战页面</a>，首先看到的是这个:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/3ec96c9e56e37e5ab8fbc56ba6b837ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wy4pCAlfqUeG05Gb3wKbiA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">挑战页面</figcaption></figure><p id="d7c7" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">这是一个名为“18游戏”的游戏，它的目标是拥有三张总和为18的牌。这是通过从每堆牌中选择一张来完成的，在你的三张牌被选中后，你将知道你是否赢了。</p><p id="ee44" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">那么是否有某种策略可以赢得这场游戏呢？不。您选择的卡片是在一个<a class="ae km" href="https://cards.buggywebsite.com/popup.html#indexes=1|1|0&amp;name=Player%201" rel="noopener ugc nofollow" target="_blank">弹出窗口</a>中随机选择的，当您点击一张卡片时，弹出窗口就会打开。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/c40b138533d0203919afc7bfe7af50ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*1K0HgDEZuN5BFM_UStxIhQ.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">弹出随机选择一张牌</figcaption></figure><p id="1a37" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">弹出窗口用随机选择的卡片向它的开启者发送post消息。当检查这个post消息时，我们看到de数据包含值<code class="fe le lf lg lh b">guess</code>、<code class="fe le lf lg lh b">indexes</code>和<code class="fe le lf lg lh b">str</code>。</p><ul class=""><li id="da3f" class="li lj iq jq b jr js jv jw jz lk kd ll kh lm kl ln lo lp lq bi translated"><code class="fe le lf lg lh b">guess</code>包含实际卡号</li><li id="a034" class="li lj iq jq b jr lr jv ls jz lt kd lu kh lv kl ln lo lp lq bi translated"><code class="fe le lf lg lh b">indexes</code>包含卡片的位置</li><li id="71ab" class="li lj iq jq b jr lr jv ls jz lt kd lu kh lv kl ln lo lp lq bi translated"><code class="fe le lf lg lh b">str</code>包含要在游戏主页显示的字符串。</li></ul><blockquote class="lw lx ly"><p id="f7ce" class="jo jp lz jq b jr js jt ju jv jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk kl ij bi translated">在这一点上，我感到非常愚蠢，因为如果我实际查看整个消息，而不仅仅是数据，我会看到nonce也被发送，这是解决挑战所需要的。如果你想知道挑战本身的解决方案，看看霍尔姆<a class="ae km" href="https://twitter.com/holme_sec" rel="noopener ugc nofollow" target="_blank">的</a><a class="ae km" href="https://holme-sec.medium.com/xss-challenge-the-xss-rat-bugpoc-fd551eb7c0eb" rel="noopener">这篇精彩的文章</a>！</p></blockquote><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi md"><img src="../Images/8550fee0b237ea559ea85cee6ccf158f.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*6eqMaXoVg0zOxUtcM0k8YQ.png"/></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">发布消息中的数据</figcaption></figure><p id="6b34" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">所以这个<code class="fe le lf lg lh b">guess</code>看起来真的很有意思，卡的号码正在被发送到揭幕战。这是否意味着我们可以向开放者发送我们自己的post消息？是的，我们可以！在这种情况下，主页没有验证post消息来自的域，所以我们可以从我们自己的站点打开这个页面，用我们自己选择的卡向它发送消息。此外，<code class="fe le lf lg lh b">str</code>变量容易受到html注入的攻击，但事实证明这并不是挑战所需要的。</p><p id="6327" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">三条消息后，我终于赢得了比赛！</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi me"><img src="../Images/f216bc587e9781e2b62da0de3dee65f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrVN7dE0Cs5x2IM0NoVGcQ.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">获奖画面</figcaption></figure><p id="329d" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我决定创建一个工具，让你每次都赢得游戏，而不需要花时间查看帖子请求，因为还有什么比弹出警报更美好的呢？当然是弹出一个胜利的画面！</p><p id="d391" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">我做的第一件事是复制粘贴了许多BugPoc的代码，并用卡片的正面替换卡片的背面。然后我添加了一个主屏幕来解释这个工具是如何工作的，并在点击开始按钮时打开游戏。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mf"><img src="../Images/217016d51c0e4c956acaa19e9f77ac83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6KigYSsJXgTpPct7xP7N2w.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">我的工具的开始屏幕</figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mf"><img src="../Images/efcff5c30cdcaa4b42520defd8641143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PRrzp2Iesj0gSbtt4SfXow.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">我的工具</figcaption></figure><p id="29f1" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">因此，当你点击开始按钮，一个新的标签将与18游戏打开。然后你必须回到我的页面，你会看到每堆所有可能的卡。在这里，您可以选择每堆1张牌。(理论上每堆多张卡是可能的，但我不允许，因为BugPoc也阻止了这一点。)</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mg"><img src="../Images/c687d9378e8e28fd6db39fa3958a99d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wIeXqasnM7mxHYGsMIiliw.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">选择的卡片</figcaption></figure><p id="2790" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">当您选择一张卡片时，您会看到一个红色的边框，表示您选择了哪张卡片。如果你现在看看18游戏的标签，你会看到你选择的卡也在这里可见。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mf"><img src="../Images/0811964b20ac4bafdf212b21f118053e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F1UhFHMgJskmgT6FzuqVsw.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">18游戏中的纸牌</figcaption></figure><p id="0299" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">如果您在“我的工具”中选择了最后一张牌，并且总和为18，您将会得到以下消息。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/305719475b2d2d71da458b493915ed09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGVc_LpZ30SGGubVFu37qA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">我的工具中的成功信息</figcaption></figure><p id="08fb" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">如果你现在去游戏的标签，你会看到胜利的画面！</p><p id="895e" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">如果您的卡的总和没有达到18，您将看到以下消息。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi mf"><img src="../Images/c87c894028748c80512d7f4f221e1731.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wbNn9t6Mf4fCH6eTdzIdtw.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk translated">在我的工具中丢失消息</figcaption></figure><p id="85b9" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">如果你想亲自测试这个工具，你可以在https://grumpinout.be/RAT的<a class="ae km" href="https://grumpinout.be/RAT" rel="noopener ugc nofollow" target="_blank">找到它</a></p><p id="d23f" class="pw-post-body-paragraph jo jp iq jq b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl ij bi translated">感谢<a class="ae km" href="https://twitter.com/theXSSrat" rel="noopener ugc nofollow" target="_blank">xssrat</a>和<a class="ae km" href="https://twitter.com/bugpoc_official" rel="noopener ugc nofollow" target="_blank"> BugPoc </a>带来的有趣挑战和漂亮的CSP旁路！</p></div></div>    
</body>
</html>