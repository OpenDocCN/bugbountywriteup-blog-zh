<html>
<head>
<title>Transforming a Domain into the Matrix (an open redirect story)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将领域转化为矩阵(一个开放的重定向故事)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/transforming-a-domain-into-the-matrix-an-open-redirect-story-4bd87c3a8caa?source=collection_archive---------5-----------------------#2017-11-17">https://infosecwriteups.com/transforming-a-domain-into-the-matrix-an-open-redirect-story-4bd87c3a8caa?source=collection_archive---------5-----------------------#2017-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，大家好吗？希望你是好的，今天我分享一个非常奇怪和不常见的行为，这是我一年前从奖金开始时发现的。我们将该程序保密，因此从现在起我们可以将其命名为[redated . com]。</p><p id="58aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我找到了这个正常的终点:</p><ul class=""><li id="a1a3" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">https://[redated . com]/登录？return_to=[url]</li></ul><p id="9f35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有趣吧？所以我决定尝试一些开放重定向负载:</p><blockquote class="ku kv kw"><p id="800a" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">return_to=http://evil.com -&gt;拒绝</p><p id="b189" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">return _ to = http://[redated . com]. evil . com-&gt;拒绝</p><p id="aea1" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">return_to=//google.com -&gt;拒绝</p><p id="78b8" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">return_to=//redacted.com@evil.com-&gt;拒绝</p><p id="e7fd" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">return _ to =//Google . com/redated . com-&gt;拒绝</p></blockquote><p id="fdc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">…有效载荷的列表相当大..但是所有的尝试都失败了</p><p id="babe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的感觉是:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/520bdbf93e8acea6109f1ea6f0c3def0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1250/format:webp/1*D1BaPUnlag1dM73a5EAScA.jpeg"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">真相有时很伤人:(</figcaption></figure><p id="da57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是..在这个过程中，我注意到一个奇怪的行为..(这里是暮光之城的音乐来源..)</p><p id="5a24" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">于是灵感从天堂直接带着这条信息降临到我身上:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/2f04e3778af2604d55bc257a47586447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*yJMz0yZOx3skHDsv1vng-w.jpeg"/></div></figure><p id="a771" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试下一件奇怪的事:</p><p id="08d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我输入任何字符串/login？return_to= <strong class="jp ir"> anythinghere </strong>(当用户登录时)域成为https://redated . comany thinghere</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lo"><img src="../Images/ef3dde56032ee3f07ac833f102ba0aea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X25lL0cexOSGAatsS1Dksg.jpeg"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">(倒霉事发生)</figcaption></figure><p id="fb1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好吧，好吧，这是怎么回事？所以我想到了一个小技巧，我问自己:如果我做下一个请求会发生什么？</p><blockquote class="ku kv kw"><p id="a685" class="jn jo kx jp b jq jr js jt ju jv jw jx ky jz ka kb kz kd ke kf la kh ki kj kk ij bi translated">https://[redated . com]/登录？return _ to =公司</p></blockquote><p id="34d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当用户登录后，直接重定向到<a class="ae lt" href="https://[redacted.company]" rel="noopener ugc nofollow" target="_blank"> https://【编校公司】</a></p><p id="7dc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我看看这个域名是否可用..让我惊讶的是:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi lu"><img src="../Images/cad8fe1a0755886b46a531460bcbd929.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*otrk4yFI7d2WB-O4EFDTIQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk translated">是啊！可用！</figcaption></figure><p id="6cc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这时我觉得:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/e919a739a6e06ada8762f2abc3f4a129.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/format:webp/1*wGJkiCxiv25wmaDvju19gw.jpeg"/></div></figure><ul class=""><li id="56eb" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">当我们通过CORS、OAuth等处理白名单URL或域时，同样的技巧可以用在很多场景中</li><li id="8877" class="kl km iq jp b jq lw ju lx jy ly kc lz kg ma kk kq kr ks kt bi translated">我希望你像我写这篇文章一样喜欢阅读:)</li></ul><p id="d9b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">关于开放重定向的好资源有:</strong></p><div class="mb mc gp gr md me"><a href="https://zseano.com/tutorials/1.html" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">英国安全研究员</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">开放网址重定向是简单的网址像https://www.example.com/?go=https://www.google.com/,，当访问将去…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">zseano.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms lh me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="http://homakov.blogspot.com.ar/2014/01/evolution-of-open-redirect-vulnerability.html" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">开放重定向漏洞的演变。</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">TL；DR ///host.com被服务器端库解析为相对路径URL，但是Chrome和Firefox违反RFC并加载…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">homakov.blogspot.com.ar</p></div></div></div></a></div><p id="2daa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">并记住</strong>:放松，有些事情会来到你身边:<strong class="jp ir">这是不可避免的</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="lp lq di lr bf ls"><div class="gh gi mt"><img src="../Images/624ce125b858d6943f698308407df937.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x3eu2k4WtW0sxnfiv-qx5A.png"/></div></div></figure><p id="3b12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">黑客快乐！</strong></p><div class="mb mc gp gr md me"><a href="https://hackerone.com/ak1t4" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">HackerOne简介- ak1t4</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">怀特4t Hack3r &amp;禅宗和尚&amp;赏金猎人-https://twitter.com/knowledge_2014</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">hackerone.com</p></div></div><div class="mn l"><div class="mu l mp mq mr mn ms lh me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="https://twitter.com/knowledge_2014" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">ak1t4 z3n (@knowledge_2014) |推特</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">ak1t4 z3n的最新推文(@knowledge_2014)。Bug赏金猎人- HoF:谷歌- Mozilla - PayPal -微软…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">twitter.com</p></div></div><div class="mn l"><div class="mv l mp mq mr mn ms lh me"/></div></div></a></div></div></div>    
</body>
</html>