# 网络安全软件开发原则

> 原文：<https://infosecwriteups.com/secure-development-principles-488cbfcf4fe8?source=collection_archive---------2----------------------->

## OWASP 还没有列出安全特性

![](img/abbbde1df665dc7cb855dc3b0f0dcd64.png)

照片由 [Lucas Santos](https://unsplash.com/@_staticvoid?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 在 [Unsplash](https://unsplash.com/s/photos/clockwork?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) 上拍摄

当开发新的应用程序，特别是基于 web 的或移动的应用程序时，软件开发团队经常发现他们自己在修复漏洞，这些漏洞要么是在测试中发现的，要么是在攻击中被利用的。

除了 bug，我们的用户还可以从良好的安全特性中受益。不幸的是，尽管有一个非常好的 web 应用程序弱点分类法(OWASP)，但没有**安全特性**分类法可供检查，如果有人对提高安全性感兴趣，最好的方法是复制其他应用程序正在做的事情。Revolut 和 Kraken.com 就是很好的例子

**基于 OWASP 和我的经验，以下是我推荐的安全开发原则和特性**:

1.  保护存储在客户端的敏感信息(如机密、个人信息、资金、知识产权、密码、会话令牌)。在没有用户凭证的情况下，存储在客户端的敏感信息应该不可能通过应用程序或直接读取文件系统来读取。这通常使用操作系统工具或库来加密个人可识别信息、密码和令牌。在文件和文件夹中设置适当的权限是一种补充技术。
2.  会话注销或卸载时，不应在缓存或客户机文件系统中留下任何不必要的文件。
3.  保护存储在服务器端的敏感信息。这通常使用操作系统工具或库来加密个人可识别信息、密码和令牌。理想情况下，服务器端不应该存储密码，而是存储一个加盐散列(密码知识的数学证明)
4.  执行逆向工程或创建应用程序的复制品需要特殊的技能，并且非常耗时。有几种技术可以防止或阻碍逆向工程，其中包括:

*   混淆代码。
*   阻止应用程序在虚拟机环境中运行。
*   阻止应用程序在根设备上运行。
*   定期检查应用程序数字签名。
*   用户可以在安装时选择应用程序图标的外观。

5.用户应该只能按照设计的流程在页面之间移动。

6.应该验证数据输入，防止它被解释为代码。这包括输入实际代码、不支持的 unicode 代码或恶意制作的编码，这些代码可以被前端或后端解释或用作代码。一个可能的不良副作用是潜在地将文件上传到服务器端。

7.应用程序给出的错误代码不应该暴露服务器或客户端的内部逻辑。在 QA 期间，错误代码将有助于查明错误和缺陷，但是生产应用程序错误代码应该被“清除”或变得通用，以便不为潜在的攻击者提供有关应用程序内部逻辑的线索。

8.应用程序不能让用户在非法活动风险高的地方或组织不运作的地方操作。可以使用几种技术来检测设备的位置:

*   通过 GPS 进行地理定位
*   通过 IP 进行地理定位
*   识别可能用于隐藏位置的 VPN 或代理

9.用户应该能够只与当前信息进行交互。用户不应该能够与不再有效的过时信息进行交互。理想情况下，用户不应该能够查看不再有效的信息。无效(因为不是当前的)信息的状态对于用户来说应该是视觉上明显的。

10.必须记录所有重大事件和敏感信息事件。

11.必须记录所有用户注册事件，包括:

*   用户帐户创建(成功或失败)
*   用户账户暂停(成功与否)
*   用户帐户重新激活(成功或失败)
*   凭据重置(成功或失败)
*   凭据过期
*   凭据更改(成功或失败)
*   登录(成功或失败)
*   会话已关闭或过期

12.日志格式和语法应该便于检测异常。

13.敏感信息和事件的用户注册日志应受到保护，以防被篡改，即使管理员帐户受到威胁也是如此。

14.为了保护用户的隐私，应用程序和服务器之间的通信必须进行端到端的高度加密。加密是达到目的的一种手段:客户端应该能够检查它正在与组织通信，而不是一个冒名顶替者，组织应该能够检查客户端是一个合法用户，而不是一个恶意的机器人，并且应该保护通信免受第三方的窥探。这可以通过结合使用以下技术来实现:

*   客户端的证书或密钥锁定。
*   在服务器端使用 SSL 证书。
*   使用 HTTPS
*   在服务器端实施 HSTS(如果有 web 应用程序的话)
*   检查证书透明度有效性。

15.保护登录后的用户会话不被窃取和重放。有几种技术可以提供保护:

*   使会话 id 随机
*   将会话 ID 链接到设备的指纹，并周期性地验证设备的指纹。
*   会话令牌的保护
*   允许用户终止会话
*   允许用户配置最大会话持续时间
*   设置硬性最大会话持续时间

16.登录时保护用户会话。有几种技术可以防止恶意用户使用合法用户的凭据登录:

*   在登录尝试之间施加延迟
*   一段时间内记录的登录尝试次数越多，延迟时间就会越长
*   应该通过电子邮件通知用户所有登录，无论成功与否。
*   根据已知设备指纹是否与用户相关联，对上述所有内容进行微调

17.凭证生命周期的保护(通常是密码)。应该使用如下技术保护密码生命周期:

*   向用户提供关于其密码选择强度的反馈
*   设置最小密码长度
*   使用户能够根据需要更改其密码。当在应用程序本身中更改密码时，必须键入密码才能访问该功能。用户将收到变更事件的通知。
*   用于促进实际凭据更改的通道必须不同于用于请求凭据更改的通道。
*   允许用户在忘记密码时重置其密码，但有以下警告:重置令牌应该仅在有限的时间内有效，用户将被通知密码请求更改和密码更改事件

18.生产应用程序不应包含任何开发人员的注释。

19.用户应该只能访问他自己的信息，而不能访问其他用户的信息或与他的用户帐户无关的信息。

20.不应该以用户获得不公平、非故意或欺诈性收益的方式使用应用程序。

21.应用程序运行的方式应该使屏幕覆盖不可能或明显的存在。

22.客户端应用程序应该能够响应服务器的质询。这将使有效流量优先于恶意僵尸程序。挑战范围从验证码到“秘密敲门”或工作算法的证明。

23.用户应该能够确定安装的应用程序是否是原始的和未经篡改的。如果代码被篡改，应用程序应该以一种对用户来说显而易见的方式使用代码签名。

24.用户应该能够配置最大会话持续时间。我们希望保证只有用户帐户的所有者才能使用它。用户可能更喜欢比最大超时周期更频繁地被提示其凭证

25.从不受信任的位置登录时，系统应该:

*   拒绝高风险位置的访问
*   或者请求通过电子邮件或文本消息发送的令牌来完成登录。
*   或者请求要解决的验证码

26.从不可信网络登录时，系统应该:

*   拒绝高风险 IP 的访问
*   或者请求通过电子邮件或文本消息发送的令牌来完成登录。
*   或者请求要解决的验证码

27.从不可信设备登录时，系统应该:

*   拒绝高风险设备的访问
*   或者请求通过电子邮件或文本消息发送的令牌来完成登录。
*   或者请求要解决的验证码

28.用户帐户 id 不能重复使用，即使该帐户之前已被取消。

29.以下事件应通过短信或电子邮件向相关系统的用户发送通知

*   用户帐户被锁定
*   用户帐户已解锁
*   拒绝多个登录请求
*   授予凭据更改
*   请求凭据更改
*   从新设备登录
*   从新位置登录
*   语言的变化

只有当用户意识到有人试图接管帐户时，他或她才能采取行动。

30.即使有特权访问，日志也不应该被修改，任何修改都应该是可检测和可逆的。这是一个后端功能，即使全面入侵危及我们的系统，它也会保护我们。

31.凭据不得过期。根据 NIST 的最新指导，强制更改凭证不会增加安全性。此外，它在可用性方面没有帮助。

32.会话应该有一个最大超时期限，无论是否在使用中

33.密码质量应该仅基于熵来衡量，而不是强加复杂性。实际上，随着长度的增加，证件的质量提高得最快，而不是复杂程度。

34.用户在选择凭证时必须获得关于凭证质量的反馈。用户不具备确定其密码质量的技能，向他们提供反馈可以帮助他们选择他们喜欢的安全级别和/或不方便性。

35:用户应该能够选择他的凭证。用户经常想要选择他们的凭证，因为这通常是他们记住它们的最容易的方式。

36.用户应该能够让系统为他建议一个高质量的凭证(仅客户端代码)。用户没有技能来选择高质量的密码，足够长，容易键入和容易记住。系统建议可以帮助他们，增加只有用户帐户的所有者会使用它的机会。

37.用户应该能够恢复他的凭据后，证明他的电子邮件地址或电话号码的所有权。

38.用户应该能够在系统本身中改变他的凭证，在证明知道当前凭证之后

39.应该限制具有相同用户帐户 ID 的同时会话的数量。由于每个会话都使用系统资源，无限制的会话会导致拒绝服务。

40.用户应该可以使用 2FA/MFA。我们希望保证只有用户帐户的所有者才能使用它。

41.只有在完成所有输入数据后，登录信息才会生效。如果出现错误情况，系统不会指出哪部分数据是正确的或不正确的，而是要求用户重试。

42.成功登录完成后，会提供有关过去成功登录(日期和时间)和不成功登录(次数)的信息。只有当用户意识到有人试图接管帐户时，他或她才能采取行动。

43.用户应该可以选择在键入时隐藏带有符号的凭据字符。如果用户附近的攻击者可以在输入时查看密码和帐户 ID，攻击者就可以劫持用户的帐户。

44.用户应该能够使用密码管理器来输入他的凭证。如果凭证很复杂，用户需要一个密码管理器来可靠地输入凭证。

45.关于安全事件、状态或行动的电子邮件通知不应包含链接。电子邮件中的链接训练用户点击他们收到的任何东西，因此他们更容易受到网络钓鱼的攻击

**非常值得一查的** [**最低可行安全产品**](https://mvsp.dev/)