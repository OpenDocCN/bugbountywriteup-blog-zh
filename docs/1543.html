<html>
<head>
<title>‘Websocket Hijacking’ to steal Session_ID of victim users</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“Websocket劫持”来窃取受害用户的Session_ID</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/websocket-hijacking-to-steal-session-id-of-victim-users-bca84243830?source=collection_archive---------0-----------------------#2021-08-25">https://infosecwriteups.com/websocket-hijacking-to-steal-session-id-of-victim-users-bca84243830?source=collection_archive---------0-----------------------#2021-08-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f780" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，希望你们都健康平安。今天的文章是关于我在一个游戏网站上的发现。有趣的是，我一直认为这种攻击只是一种理论。和往常一样，我会尽量让我的文章不那么专业，这样对任何初学者来说都容易理解。开始吧！</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="5cd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在进入细节之前，让我们讨论一下websocket请求:</p><p id="e2b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">什么是Websocket？</p><p id="9a84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用websocket请求，可以在用户的浏览器和服务器之间打开一个双向的交互式通信会话。有了这个API，您可以向服务器发送消息并接收事件驱动的响应，而不必轮询服务器的回复。如果您想了解更多信息，请点击此处—<a class="ae ks" href="https://sookocheff.com/post/networking/how-do-websockets-work/" rel="noopener ugc nofollow" target="_blank">https://sookocheff . com/post/networking/how-do-web sockets-work/</a></p><p id="dbb5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">剥削:</strong></p><p id="ec89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我在这个私人黑客程序<redacted>com上搜索。在开始攻击之前，我习惯于通过拦截Burpsuite中的请求来快速检查网站。在这个过程中，我发现很少有websocket请求携带消息。所以我开始检查它是否容易受到websocket劫持。为此，我使用了这个网站:<a class="ae ks" href="http://websocket.org/echo.html" rel="noopener ugc nofollow" target="_blank">http://websocket.org/echo.html</a>【这是一个为连接websockets而创建的易受攻击的网站】。您所要做的就是在位置输入中输入websocket url，并检查您是否能够发送和接收消息。我输入了这样的目标web socket URL:<em class="kt">WSS://www。&lt;已修订&gt;。com/xns-service/secure/client/desktop/000/xxxxxxxx/web socket</em>，我立即在第三方网站上得到这样的回复</redacted></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ku"><img src="../Images/7106d64c84c7e92ce505dfdc01397097.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XgY3e-pJ7lBRpIw-HoZqrg.png"/></div></div></figure><ul class=""><li id="96c1" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lg lh li lj bi translated"><strong class="jp ir">注意:</strong> 000 —在实际的url中，这是字母数字值，但我发现它接受任何值，同样适用于XXXXXX</li></ul><p id="d4f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止还不错，但是有什么影响呢？所以我开始进一步探索这个网站，发现当一个用户更新他们的个人资料时，他们会收到这样的消息，泄露了这个用户的用户名</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/b1222e5575455d58736e69a9cb6a8d76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*jZJ5QX5Tc4QLEvW8yG-DYA.png"/></div></figure><p id="e72d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我知道，如果受害者正在执行任何操作，websocket连接建立的第三方正在接收包含敏感内容的websocket响应。所以我继续做敏感的动作，所有的动作都有相同的反应。但就在那时，我执行了密码更改操作，然后嘣！！本次披露的Session_Id:)</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ll"><img src="../Images/2989244a59f947e00c4b6a03d2d52c59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d9oKlj5SY54O-yCmPndAxw.jpeg"/></div></div></figure><p id="d56b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">又有什么影响？</strong></p><p id="4a27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，攻击者将创建一个网站并托管易受攻击的代码。现在，当受害者打开攻击者的网站时，连接将立即建立，每当受害者执行一个操作时，他们就可以开始看到websocket消息。影响最大的行为是当受害者试图更新他们的密码时，攻击者可以看到受害者帐户的Session_Id。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="lm kr l"/></div></figure><p id="7bfe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要创建一个真实的攻击场景，请使用通过<a class="ae ks" href="http://websocket.org/echo.html" rel="noopener ugc nofollow" target="_blank">http://websocket.org/echo.html</a>获得的代码，利用这些代码，攻击者可以充当第三方并拦截websocket响应。所以我很快在Hackerone中报告了这个漏洞，由于一些原因，报告被接受了，严重性和奖金都有所降低，但识别部分让我很高兴，因为我一直认为这种类型的漏洞只是一个理论！</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ln"><img src="../Images/533e9f822ec091b65a249f03d1dfa9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVNFHxPL1HxAloXjgmmmmw.png"/></div></div></figure><p id="b339" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">快速总结:</strong></p><ol class=""><li id="d05d" class="lb lc iq jp b jq jr ju jv jy ld kc le kg lf kk lo lh li lj bi translated">在Burpsuite中播放请求时发现websocket请求。</li><li id="b62b" class="lb lc iq jp b jq lp ju lq jy lr kc ls kg lt kk lo lh li lj bi translated">打开:【http://websocket.org/echo.html】的<a class="ae ks" href="http://websocket.org/echo.html" rel="noopener ugc nofollow" target="_blank">并检查我是否能发送和接收websocket响应</a></li><li id="13e5" class="lb lc iq jp b jq lp ju lq jy lr kc ls kg lt kk lo lh li lj bi translated">收到来自目标的响应。</li><li id="430f" class="lb lc iq jp b jq lp ju lq jy lr kc ls kg lt kk lo lh li lj bi translated">尝试升级严重性，发现当受害用户更新密码时，session_Id被泄露给第三方。</li><li id="1f31" class="lb lc iq jp b jq lp ju lq jy lr kc ls kg lt kk lo lh li lj bi translated">为了展示一个真实的攻击场景，我们使用了下面的代码:<a class="ae ks" href="http://websocket.org/echo.html" rel="noopener ugc nofollow" target="_blank">http://websocket.org/echo.html</a></li></ol><p id="0168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢我的解释。如果你有任何疑问，请随时通过twitter联系我:<a class="ae ks" href="https://twitter.com/sunilyedla2" rel="noopener ugc nofollow" target="_blank">https://twitter.com/sunilyedla2</a>。保持积极，传播积极:)</p></div></div>    
</body>
</html>