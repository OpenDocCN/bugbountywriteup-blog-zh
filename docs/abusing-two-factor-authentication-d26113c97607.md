# 滥用双因素认证

> 原文：<https://infosecwriteups.com/abusing-two-factor-authentication-d26113c97607?source=collection_archive---------6----------------------->

![](img/6005c5a10e8a593647059c7d6f917ccc.png)

双因素身份认证(2FA)有时也称为多因素身份认证。…增加一个身份认证步骤会使攻击者更难访问您的数据。这大大降低了欺诈、数据丢失或身份盗窃的几率。

你可以在这里阅读更多关于 2Fa 的内容

你好黑客&爱好者 X0rby7e 在这里，在这篇文章中，我将写如何滥用 2FA 的关键漏洞。让我们更多地了解一下 2Fa 以及如何绕过它。

当我得到一个 2FA 的端点时，我所涉及的和我用来测试的方法

1.  缺乏费率限制
2.  逻辑流程
3.  会话管理

> **缺乏费率限制-**

1.1 缺乏验证 OTP 的速率限制-

在 web 应用程序请求 OTP 的 burp 套件中捕获请求。现在对 OTP 使用入侵者暴力。有效的 OTP 响应返回 200 OK，或者它取决于场景。只需观察长度即可检查有效长度。

1.2 发送动态口令没有速率限制-

在 web 应用程序向用户发送 OTP 的 burp 套件中捕获请求。现在只需通过入侵者重复相同的请求 100 到 200 次，结果应用程序发送 OTP 来响应请求。影响—如果目标组织使用付费短信系统，如每条短信的一些金额，这将是组织的损失。

3.3 基于 cookie、IP、会话的旁路速率限制-

观察请求并尝试绕过他们用于速率限制的限制。IPRotate 是 burp suite 的最佳扩展之一，它对做同样的事情很有用

> **逻辑缺陷-**

2.1 旧的 OTP 仍然有效

在刷新与新令牌关联的新动态口令后，动态口令与令牌关联，但旧的 1 仍然有效

2.2 另一个用户可以使用动态口令

检查是否有其他用户通过同一个 OTP 登录。

2.3 OTP 泄漏响应

在 Burp suite 中捕获请求并检查每个请求的响应，有时 OTP 会在头中泄漏，尝试更改请求会导致 OTP 在错误地探索。补充。json 在请求结束时导致 OTP 在响应中公开[并非在所有情况下]

2.4 账户锁定

应用程序在多次尝试后锁定帐户。

2.5 玩 OTP

有一个应用程序允许我使用 OTP 0000 登录，在这种情况下，0000 充当主密钥。

> **会话管理-**

3.1 缺少会话失效

创建一个用户 id 并在两个不同的浏览器中登录到同一个用户，现在在第一个浏览器中激活 2FA 并检查第二个浏览器会话是否仍然有效。如果这是有效的或者没有注销用户，那么在激活 2FA 之后就没有会话失效。

3.2 缺少关于密码更改的 2FA

如果激活了 2FA，则更改密码功能受 2FA 保护。

这完全是在滥用双因素身份认证

如果你喜欢阅读文章**，请鼓掌并关注*媒体和***[***insta gram***](https://www.instagram.com/x0rby7e_bug/?igshid=1q9jzd7k589n6)***。***