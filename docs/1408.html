<html>
<head>
<title>PicoCTF 2021: Transformation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PicoCTF 2021:转型</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/picoctf-2021-transformation-6242546fba02?source=collection_archive---------0-----------------------#2021-06-18">https://infosecwriteups.com/picoctf-2021-transformation-6242546fba02?source=collection_archive---------0-----------------------#2021-06-18</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="247f" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">文件隐藏消息的基本逆向工程概念。</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/eb5be6778c2175acb31e1bd52df998d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Jw0gfATpUZvQyecP"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">在<a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> Unsplash </a>上拍摄的<a class="ae ky" href="https://unsplash.com/@thisisengineering?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank"> ThisisEngineering RAEng </a></figcaption></figure><h2 id="d5df" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">背景故事</h2><p id="27fd" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">我做Bug Bounty已经有几年了，你可能知道，在这个领域工作的大多数人都有很多相似之处。他们观看的电影类型，工作的程序，甚至是同一群YouTubers用户来获取信息和学习更多的技能。</p><p id="67c9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">但是大多数或者说所有的臭虫猎人都有一个共同点，那就是<strong class="lx iu">CTF</strong>。我知道这是什么，但直到今天我才真正对它感兴趣。是的，今天是我第一次玩CTF。不知怎么的，Youtube给我发来了一个视频，是一个关于<strong class="lx iu"/><a class="ae ky" href="https://picoctf.org/" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu">picoctf.org</strong></a><strong class="lx iu">的DEFCON </strong> 会议。起初，找到大多数旗帜并不难，直到我手忙脚乱地进入<strong class="lx iu"> <em class="mt">转换</em> </strong></p><blockquote class="mu"><p id="1a53" class="mv mw it bd mx my mz na nb nc nd mn dk translated">什么是夺旗？</p><p id="cf79" class="mv mw it bd mx my mz na nb nc nd mn dk translated">捕捉旗帜，或者说CTFs是一种计算机<strong class="ak">安全</strong>竞赛。在计算机安全技能测试中，几组竞争者(或者只是个人)相互竞争。由于其团队建设性质和竞争性，CTF通常是一个人网络安全职业生涯的开始。</p></blockquote><figure class="nf ng nh ni nj kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ne"><img src="../Images/f3fb51a2a87cae95f879b8aab5a9b123.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9rGObOhZd7A8M6SaH6xLbw.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">transformationpicoctf2021.jpg</figcaption></figure><p id="cec3" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">正如我们从照片中看到的，给了我一个要下载的文件，一些python代码片段，以及一个尝试解决标志的<strong class="lx iu">提示</strong>。如果你了解Python<strong class="lx iu">和</strong>的话，这是一个起点。做我自己并不是我开始的地方，尽管我应该这样做。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h1 id="6e11" class="nr la it bd lb ns nt nu le nv nw nx lh jz ny ka ll kc nz kd lp kf oa kg lt ob bi translated">让我们开始行动</h1><h2 id="d805" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第一枪</h2><p id="89a0" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">将文件下载到本地目录进行数据分析后，我将它放入一个十六进制编辑器中检查是否有隐藏的秘密。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/a8e49a90a70b6329a11bf10366b32b45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*uHaC039oTMhY2H7IcwXj0A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">十六进制恶魔编辑器(macOS)</figcaption></figure><p id="bbaa" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">乍看之下，你可以看到没有什么重要的发现。在这一点上，我非常失望地认为我进入了死胡同，直到我选择了结果，并将十六进制编辑器从<strong class="lx iu"> <em class="mt">符号整数</em> </strong>切换到<strong class="lx iu"> UTF-8 </strong>格式，如下所示；</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi od"><img src="../Images/1d15c6bdb91bf098be0d42656dc6a531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*oV-lhZ8w3Yw8kcJaX44dxA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">from有符号整数</figcaption></figure><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/bda090d7f307795618348b171263d2fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*GyH-BSF8d848VT0Olf8s5g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">到UTF-8</figcaption></figure><p id="5ff4" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">哈！我找到了一些东西，这些是新年夜交响乐的中文单词。现在怎么办？当天解决了一些涉及<strong class="lx iu"> ASCII </strong>的标志后。我想，如果这只是我需要解码的ASCII编码，而不是一个有意义的真实句子呢？原来也不过如此。利用网站上的提示，我试着解码了<strong class="lx iu"> ASCII </strong>，尽管我当时并不知道那是<strong class="lx iu"> ASCII </strong>。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="7f81" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi">Using <a class="ae ky" href="https://www.branah.com/ascii-converter" rel="noopener ugc nofollow" target="_blank"><strong class="lx iu"><em class="mt">branah.com</em></strong></a> to decode <strong class="lx iu">灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸強㕤㐸㤸扽</strong>, I had the following results below, from all these results the only one that really got my attention was the Base64.</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi of"><img src="../Images/92e5e01dacc7251bb511b0acbfdd4e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*f9v6zdGoMwU4hymOeHiGsw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://www.branah.com/ascii-converter" rel="noopener ugc nofollow" target="_blank">https://www.branah.com/ascii-converter</a></figcaption></figure><p id="97e2" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">其中解码成<strong class="lx iu">文本</strong>产生了“<strong class="lx iu"> ioT{6bt_nt4_f87d88} </strong>”。这真是件好事。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi og"><img src="../Images/fb979fe32f023d10daf737ef21a6cf33.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*C74eeP6ARdqUr0lTaffN2A.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated"><a class="ae ky" href="https://base64.guru/converter/decode/text" rel="noopener ugc nofollow" target="_blank">https://base64.guru/converter/decode/text</a></figcaption></figure><p id="e3fb" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">虽然我知道这是国旗短语的一部分，但它不是国旗的答案，有些东西不见了，但我不知道是什么。标志应该是类似于<strong class="lx iu"> picoCTF{XXXX} </strong>的东西，而不是<strong class="lx iu"> IoT </strong>。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h2 id="f498" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">第二枪</h2><p id="1690" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">仔细查看python代码片段中的随机字符串值，我意识到该脚本使用了<strong class="lx iu"> <em class="mt"> chr() </em> </strong>和<strong class="lx iu">o<em class="mt">rd()</em></strong><em class="mt"/>python函数，<em class="mt">用于</em>循环，<em class="mt"> len </em>。为了重温我在python时代的辉煌，我开始寻找<em class="mt"> chr() </em>和<em class="mt"> ord() </em>的主要用途。就在这个时候，我发现了一个<em class="mt">StackOverflow.com</em>的帖子，一个家伙在寻求帮助，因为他编写了一个使用<strong class="lx iu"> <em class="mt"> ASCII表</em> </strong>对消息进行编码的脚本，但却无法解码。基本上，在我浏览了他的代码后，我明白了我的标志的答案是使用具有这两个功能的python脚本编码的。</p><p id="36db" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi">Somehow I needed to create a python <strong class="lx iu">ASCII decoder </strong>script and feed <strong class="lx iu">灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸強㕤㐸㤸扽</strong> to it as an input which then will decode it into plain text.</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">解密asci代码的脚本</figcaption></figure><p id="c118" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">想出这个脚本并在<strong class="lx iu"> Visual Studio代码</strong>控制台中运行后，我得到了以下结果；</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="oh oi l"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk translated">解码结果</figcaption></figure><p id="af9c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">这是我一直在寻找的结果。知道每一面旗帜都以“<strong class="lx iu"> picoctf{xxxx} </strong>”开头，注意到“<em class="mt">pi”</em>作为解码信息中的前两个字母，我终于从中文隐藏信息中检索到了旗帜，或者至少我是这么认为的。通过仔细观察，我们可以看到解码后的消息有一些额外的字符串</p><pre class="kj kk kl km gt oj ok ol om aw on bi"><span id="9e43" class="kz la it ok b gy oo op l oq or"><em class="mt">pi0co1CT2F{3164_b5it6s_7in8st93410d_11of12_813_7145d1548169817b}18</em></span></pre></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h2 id="e9ec" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated"><strong class="ak">最后一枪</strong></h2><p id="3dba" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">在所有这些工作之后，我所拥有的是:</p><ul class=""><li id="eb1b" class="os ot it lx b ly mo mb mp li ou lm ov lq ow mn ox oy oz pa bi translated">物联网{6bt_nt4_f87d88}</li><li id="0f41" class="os ot it lx b ly pb mb pc li pd lm pe lq pf mn ox oy oz pa bi translated"><em class="mt">pi 0 co 1c T2 f { 3164 _ b5 it 6s _ 7 in 8st 93410d _ 11of 12 _ 813 _ 7145d 1548169817 b } 18</em></li><li id="5416" class="os ot it lx b ly pb mb pc li pd lm pe lq pf mn ox oy oz pa bi"><strong class="lx iu">灩捯䍔䙻ㄶ形楴獟楮獴㌴摟潦弸強㕤㐸㤸扽</strong></li></ul><p id="cd5c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">接下来我该做什么？！这看起来像是结束了。好吧，我决定再试最后一次，以防失败，我会换另一面旗子。</p><p id="4097" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">最明显的步骤是尝试<strong class="lx iu"> picoctf{6bt_nt4_f87d88} </strong>而不是<strong class="lx iu"> ioT{6bt_nt4_f87d88} </strong>显然这不起作用。</p><p id="8399" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">我继续删除了<strong class="lx iu"> 0 </strong>、<strong class="lx iu"> 1 </strong>、<strong class="lx iu"> 2 </strong>和<strong class="lx iu"> 18 </strong>以得到一个更像<strong class="lx iu"> <em class="mt">的标志picoCTF { 3164 _ b5 it6 s _ 7 in 8 ST 93410d _ 11 of 12 _ 813 _ 7145d 1548169817 b }</em></strong><em class="mt">、</em>这也不起作用我所需要做的就是将前两个结果中的内容混合成一个，但是怎么做呢？</p><p id="fc69" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">在沉思我是如何从我的python脚本<strong class="lx iu"><em class="mt">pi 0 co 1c T2 f { 3164 _ b5 it 6s _ 7 in 8 ST 93410d _ 11 of 12 _ 813 _ 7145d 1548169817 b } 18</em></strong><em class="mt">，</em>中得到这个答案的同时，我意识到我的代码写得并不高效，这也是它无法最大限度解码ASCII消息的原因。我需要自己用逻辑或猜测找到答案，在凌晨3点，调试或重新写我的脚本对我来说不是一个选项。</p><h2 id="6d8d" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">突破👊</h2><p id="9e7a" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">仍然盯着半解码的标志，想着python或者仅仅是我的python知识是如何让我失望的，就在这个时候，我的内部编码器开始工作了。人们从1开始计数，程序员知道1实际上意味着0。这让我注意到在“<em class="mt">pi”</em>后面有一个<strong class="lx iu"> 0 </strong>，后面多了两个字母还有<strong class="lx iu"> 1 </strong>，多了两串还有一个<strong class="lx iu"> 2 </strong>，以此类推。直到达到数字<strong class="lx iu"> 18 </strong>为止。这再加上我脑袋后面有<strong class="lx iu"> ROT13 </strong>，每两个字符串/字母<strong class="lx iu"> </strong>后删除任何数字，最终给了我解码后的标志<strong class="lx iu">！</strong></p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h2 id="d96f" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">最后的结果</h2><ul class=""><li id="7bfe" class="os ot it lx b ly lz mb mc li pg lm ph lq pi mn ox oy oz pa bi translated">pi<strong class="lx iu">0</strong>co<strong class="lx iu">1</strong>CT<strong class="lx iu">2</strong>F {3<strong class="lx iu">4</strong>b<strong class="lx iu">5</strong>it<strong class="lx iu">6</strong>s _<strong class="lx iu">7</strong>in<strong class="lx iu">8</strong>ST<strong class="lx iu">9</strong>34<strong class="lx iu">10【T69</strong></li></ul><p id="d7fa" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">—致</p><ul class=""><li id="c3c2" class="os ot it lx b ly mo mb mp li ou lm ov lq ow mn ox oy oz pa bi translated">picoCTF { 16 _ bits _ inst 34d _ of _ 8 _ 75d 4898 b }</li></ul><p id="3824" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">瞧，这是这个练习的解码标志。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><h2 id="8253" class="kz la it bd lb lc ld dn le lf lg dp lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">个人想法，简单解释，建议</h2><p id="a5f6" class="pw-post-body-paragraph lv lw it lx b ly lz ju ma mb mc jx md li me mf mg lm mh mi mj lq mk ml mm mn im bi translated">第一次尝试CTF背后的原因是为了测试“最好的黑客如何学习他们的技术”视频理论中的家伙。他表示，通过像拼图一样一次学习一些小东西，最终将所有这些放在一起，可以使你成为一名优秀的黑客。</p><p id="6452" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">利用这个概念，我才得以解码这面旗帜。同一天，我解决了一些涉及ASCII、Base64和rot13的标志。我们都可以看到在这个任务中使用，这里是如何；</p><p id="6681" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 1) </strong>文件字符串使用<strong class="lx iu"> ASCII </strong>编码</p><p id="5751" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated"><strong class="lx iu"> 2) </strong>解码后的消息是一条<strong class="lx iu"> Base64 </strong>格式的消息</p><p id="d1d9" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">不知何故，我的脚本的结果给了我一个看起来像是隐藏消息的破碎的结果，类似于写为<strong class="lx iu"> ROT13 </strong></p><p id="a57c" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">综合这三个因素，在python知识的帮助下，我完成了我的使命。是的，黑客需要一些编码知识，无论谁告诉你不是这样，都是在骗你。他是对的，小步快跑会让你跑得更快。当你在外面黑东西的时候，总是尝试不同的方法。</p></div><div class="ab cl nk nl hx nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="im in io ip iq"><p id="2eb1" class="pw-post-body-paragraph lv lw it lx b ly mo ju ma mb mp jx md li mq mf mg lm mr mi mj lq ms ml mm mn im bi translated">PicoCTF是对初学者来说最有趣的CTF之一，因为它对每个人来说都足够简单。想看看这个CTF旧版本的演练吗？看看这个<a class="ae ky" href="https://guidedhacking.com/threads/picoctf-walkthrough-writeup-2019.14275/" rel="noopener ugc nofollow" target="_blank"> 2019 PicoCTF演练</a>。</p></div></div>    
</body>
</html>