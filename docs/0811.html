<html>
<head>
<title>Account Takeover via CSRF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过CSRF接管账户</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/account-takeover-via-csrf-78add8c99526?source=collection_archive---------1-----------------------#2020-09-05">https://infosecwriteups.com/account-takeover-via-csrf-78add8c99526?source=collection_archive---------1-----------------------#2020-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b461" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我的第一篇博客，所以如果我有任何错误，请忽略。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/bb52149b77bbb23c600e5a338d60c385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rylSr2OnQLZnSg9Z0W0zlg.png"/></div></figure><p id="808a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好</p><p id="c79a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过google dork找到了一个负责任的披露程序，它在CSRF攻击中是不安全的，在更新记录时没有CSRF令牌存在。</p><p id="f1af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于不了解CSRF的人来说，这是一种web应用程序攻击，攻击者阻止或授权客户端提出他的恶意请求，而客户端并没有提出这些请求。</p><p id="9d29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单来说，如果服务器不批准客户端发送的请求，攻击者可以创建一个恶意请求，并阻止客户端点击它，这将导致用户帐户(如密码或电子邮件)的修改。</p><p id="db31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从概念验证开始</p><ul class=""><li id="22be" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">首先，创建一个帐户作为攻击者，并填写所有的表格，检查您的帐户详细信息。</li><li id="60b4" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">更改电子邮件并捕获请求，然后创建一个CSRF漏洞。</li><li id="d5b2" class="ku kv iq jp b jq ld ju le jy lf kc lg kg lh kk kz la lb lc bi translated">CSRF漏洞如下所示。我已经将电子邮件值替换为anyemail@*******。并在受害者的账户里提交了一个请求。</li></ul><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi li"><img src="../Images/94ac418f81197b33523c50c13a098d5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9K29BWAkVis2xwoTe_b97Q.png"/></div></div></figure><ul class=""><li id="7e9c" class="ku kv iq jp b jq jr ju jv jy kw kc kx kg ky kk kz la lb lc bi translated">在接下来的阶段，我只是转发上面的请求和vola！我的漏洞发挥了作用，因此通过这个漏洞，我将我的电子邮件更改为受害者的电子邮件，并通过使用忘记密码的方法来检索我的电子邮件的密码重置链接，我可以完全控制受害者的帐户。</li></ul><p id="57be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">报告提交日期:2020年6月1日，星期一</p><p id="d36c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">修复确认:2020年9月4日</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ln"><img src="../Images/698d86dd6ac97f73ae63151bdbe29aae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jq_UCzF1n80nto0TvzVSiw.png"/></div></div></figure><p id="a681" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，赠送礼品卡</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lo"><img src="../Images/494557cc64e58dd054e8373779bab94e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jwlYaXGr1Uq9cwU3dxrtGQ.png"/></div></div></figure><p id="60cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我仍然需要学习很多东西，这激励我继续前进。</p><p id="2846" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你觉得这有用，我尽力解释。请大家分享，让别人借鉴。</p><p id="73a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你。</p></div></div>    
</body>
</html>