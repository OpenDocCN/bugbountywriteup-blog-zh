# 复杂的开放重定向利用

> 原文：<https://infosecwriteups.com/complex-open-redirect-exploitation-c5cfd463a6a2?source=collection_archive---------0----------------------->

![](img/329cf7501b48939e688a4e9a559ea257.png)

嗨，读者们，

我在以前的文章中写了我的第一个独特的开放重定向漏洞。[你可以在这里找到](https://inakcf.medium.com/open-redirect-in-email-c658c248eec1)。

今天，我想分享我最近的发现“另一个独特的开放重定向漏洞，这是有点棘手的利用”。

让我们开始吧:

目标是一个私有程序。所以，姑且称之为 redacted.com 的

****目标简介:****

**Target 是一家电子商务网站构建商，提供网页设计和其他商业工具。只有两个子域名在范围内**admin.redacted.com**和**api.redacted.com****

**创建新帐户后，将根据我们的用户名创建店铺，如[**https://something.redacted.com**](https://something.redacted.com)**

**如果需要，我们可以将店铺名称更改为另一个可用名称。不管名字是什么，我们的店铺网址将会像[https://**NAME**. redated . com](https://NAME.redacted.com)**

****剥削:【这里有两个阶段】****

**第一阶段**

**![](img/12adeaca1c09856a84df4f230df43f77.png)**

**登录 admin 账户后，在**设置>中**有一个更改邮件地址的选项。**

**如果我们更改电子邮件地址，就会向服务器发送一个 PUT 请求，其中包含一些 json 数据，类似于-**

**{ "email": "email@mail.com "，" shop name ":" https://shop . redacted . com "，xxxxxxxxx，xxxxxxxxxxxxxx，xxxxxxxxxxxxxx，xxxxxxxxxxx，xxxxxxxx 等。,}**

**这里没有进行适当的服务器端验证。因此，我们甚至可以将完整的店铺名称 URL 更改为任何其他域名，如 from**

****https://shop.redacted.com———>**[**https://evil.com**](https://evil.com)**

**商店名称将在仪表板中更新为[https://evil.com](https://evil.com)**

****(改店名前保存老店网址以备后用)****

****点记:****

**即使我们将店铺名称更改为任何其他名称，旧的店铺 URL 仍然可以正常工作。**

**我们回去吧，**

**将商店的网址改为其他域名后**我们的第一阶段开发就完成了****

**让我们进入第二阶段**

****第二阶段:****

**![](img/bc1c06c9aca75c02ed780af7249e63bd.png)**

**正如我前面所说，老店网址仍然工作良好。**

**导航到老店网址后，有一个选项 ***创建新的客户账户。*****

**在创建一个新帐户后，提供所有的详细信息，如用户名和电子邮件地址，用户将获得一个验证链接到该电子邮件地址。**

**链接看起来有点像[](https://api.redacted.com/emailverify/669321236/3936293/)**

****一旦用户点击该链接，他/她将被重定向到我们在第一阶段进入的【evil.com】等**域。,******

******错误配置:******

1.  ****更改商店名称时，没有进行适当的服务器端验证。****
2.  ****将店铺名称更改为其他名称后，旧的店铺 URL 仍然有效。****

****通过结合 1+2，我能够利用开放重定向漏洞，直到现在。****

****我认为有可能升级到开放重定向之外。****

****感谢查看我的帖子，如果你有任何超越开放重定向的想法，请随时在下面发表评论:)****

****问候，****

****阿克希尔****