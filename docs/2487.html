<html>
<head>
<title>Android Pentesting 101 — Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安卓测试101 —第三部分</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/android-pentesting-101-part-3-2bf846b05594?source=collection_archive---------0-----------------------#2022-10-30">https://infosecwriteups.com/android-pentesting-101-part-3-2bf846b05594?source=collection_archive---------0-----------------------#2022-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fefc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">欢迎来到Android Pentesting的第3部分。这个系列是关于你如何使用各种方法入侵Android并找到其中的漏洞。如果您还没有阅读第1部分和第2部分，我强烈建议您在跳到这一部分之前阅读它们。你可以在<a class="ae ku" href="https://medium.com/@302found" rel="noopener">这里</a>找到它。</p><p id="0f3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第三部分，也是最后一部分，我们的目标是涵盖Android Pentesting的动态分析，以及各种工具。你准备好了吗？？</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/201b0ad3372ea0496b4d113896f67cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*ceacFcCmu_iDQWxt"/></div></figure><p id="3a4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，Android Pentesting中的动态分析就是处理应用程序发送给web服务器的请求和响应。但是问题就在这里！在捕获请求之前要做两件事:</p><ol class=""><li id="ee31" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">根检测旁路</li><li id="884b" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">SSL锁定旁路</li></ol><p id="7246" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们单独谈谈他们。</p><p id="9a11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Root检测旁路:</strong>Root是允许Android移动操作系统的用户获得对各种Android子系统的特权控制(称为Root访问)的过程。不应该允许应用程序在根设备上运行。因此，我们使用<a class="ae ku" href="https://github.com/frida" rel="noopener ugc nofollow" target="_blank"> Frida </a>和<a class="ae ku" href="https://github.com/sensepost/objection" rel="noopener ugc nofollow" target="_blank"> Objection </a>尝试各种根检测旁路。</p><p id="94b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">SSL Pinning Bypass:</strong>SSL Pinning是大多数应用程序所有者实施的一种技术，这样移动应用程序发送的任何请求都不会被拦截。SSL固定被认为是应用程序安全机制中的第一步，也是最重要的一步。但由于手段不当，SSL pin通常可以被绕过。同样<a class="ae ku" href="https://github.com/frida" rel="noopener ugc nofollow" target="_blank"> Frida </a>和<a class="ae ku" href="https://github.com/sensepost/objection" rel="noopener ugc nofollow" target="_blank">异议</a>是在这方面帮助我们的最佳工具。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lr"><img src="../Images/1d79d8836ed8624322c76c716fd43fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*3sv7Eb55CJRxLfDp"/></div></div></figure><p id="ef17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么如何从动态分析开始呢？好吧，第一步是需要一个根深蒂固的安卓手机。你可以使用<a class="ae ku" href="https://www.xda-developers.com/how-to-install-magisk/" rel="noopener ugc nofollow" target="_blank"> Magisk </a>(最好也是最准确的方法)或其他方法在找到<a class="ae ku" href="https://www.rootingsteps.com/root-moto-g9-power/" rel="noopener ugc nofollow" target="_blank">任何Android手机。或者，您可以使用Genymotion，它有时不能提供准确的结果</a></p><p id="aa70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好的，让我们从一个活动目标开始，我们称这个应用程序为<redacted>。好的，那么<redacted>已经实现了根检测，可以在下面的截图中看到。</redacted></redacted></p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lw"><img src="../Images/fac252b6b00fedaf997db890807bd6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*zAMTPmNceVQ_xL969v7G_Q.png"/></div></div></figure><p id="d554" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在要绕过，这很简单:</p><ol class=""><li id="1e2f" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">下载并安装弗里达&amp;反对使用<a class="ae ku" rel="noopener ugc nofollow" target="_blank" href="/hail-frida-the-universal-ssl-pinning-bypass-for-android-e9e1d733d29">冰雹弗里达</a>。</li><li id="ba05" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">试着按照这篇<a class="ae ku" href="https://support.portswigger.net/customer/portal/articles/1841101-configuring-an-android-device-to-work-with-burp" rel="noopener ugc nofollow" target="_blank">文章</a>连接打嗝套件和你的手机</li><li id="ccd6" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用ADB shell/data/local/tmp/Frida-Server &amp;启动Frida服务器</li><li id="76fa" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">打开应用程序，并让应用程序在后台运行。</li><li id="f9d1" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">使用:frida-ps -Ua查找应用程序包名称</li><li id="c9a6" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">现在你需要找到合适的剧本。这次我们将运行Root Bypass脚本，可以在<a class="ae ku" href="https://codeshare.frida.re/@dzonerzy/fridantiroot/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。如果这个弗里达脚本不起作用，你可以在网上找到更多。其他Frida脚本可以在这里找到<a class="ae ku" href="https://codeshare.frida.re/" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="4a21" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">最后一步是使用Frida通过以下命令挂钩脚本:</li></ol><pre class="kw kx ky kz gt lx ly lz ma aw mb bi"><span id="62b4" class="mc md iq ly b gy me mf l mg mh">frida -U -f com.package.android -l D:\frida\fridascript-root.js --no-paus</span></pre><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mi"><img src="../Images/02d009907012d867aaaa0fda0c0173fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GO-Xm8BZ7LXFN53YRaKtlg.png"/></div></div></figure><p id="8fdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，您可以使用异议来绕过根检测。这可以使用以下命令快速完成:</p><ol class=""><li id="e1d5" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">反对-g "com.package.android "探索</li><li id="ed63" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">android root禁用</li><li id="86e1" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">android root模拟</li></ol><p id="da92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完美！现在我们已经绕过了根检测，我们可以继续前进了。在我们能够捕获绕过SSL固定的请求之前，还有一个步骤。</p><p id="4024" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，为了绕过SSL锁定，我们将再次使用Frida和SSL锁定绕过脚本，可以在这里找到<a class="ae ku" href="https://codeshare.frida.re/@pcipolloni/universal-android-ssl-pinning-bypass-with-frida/" rel="noopener ugc nofollow" target="_blank"/>。啊哦！但是这里有一个问题，你不能同时运行两个Frida脚本。但是没问题！只需在Root Detection Bypass脚本下添加SSL Pinning Bypass脚本，然后重新运行Frida，看看有什么神奇之处。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mj"><img src="../Images/5706c8ba5618d3dc8843192af9b30f21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*phanI0RHEE2MXzPlzcPfJQ.png"/></div></div></figure><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mk"><img src="../Images/f1b41671e66a88b35d71c00a9ddb4891.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RjMi5qC_E_X4EfBbs0T2-Q.png"/></div></div></figure><p id="570a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该死。下面是我们如何捕获所有请求的方法！或者，您可以使用异议来绕过SSL固定。这可以使用以下命令快速完成:</p><ol class=""><li id="678c" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">反对-g "com.package.android "探索</li><li id="b148" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">android sslpinning禁用</li><li id="017e" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">android sslpinning模拟</li></ol><p id="a1f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哦，等等！应用程序也使用指纹来验证用户。让我们试着绕过它。指纹旁路的脚本可以在<a class="ae ku" href="https://github.com/WithSecureLabs/android-keystore-audit/blob/master/frida-scripts/fingerprint-bypass.js" rel="noopener ugc nofollow" target="_blank">这里</a>找到。所以只需在根检测和SSL锁定脚本下面添加指纹旁路脚本。</p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi ml"><img src="../Images/fefc26ca9b6921be73edd50a39b698e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gEw7HLSFq4kJ1Yptaih2fg.png"/></div></div></figure><p id="7a30" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了！所以我们也能绕过指纹！那么接下来呢，nothing捕获所有的请求，并像测试Web应用程序一样尝试处理它们。</p><p id="89c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们已经收集并添加了所有我们认为对<a class="ae ku" href="https://github.com/302Found1/Awesmoe-Frida-Scripts" rel="noopener ugc nofollow" target="_blank">有用的Frida脚本。请随意使用它们。此外，我们还创建了一个思维导图，您可以在下面找到它。</a></p><figure class="kw kx ky kz gt la gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mm"><img src="../Images/eeab838f4d2665da413b603a9fa9f10f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ni4ZwqBSbqRTqu4JuJs_Hw.png"/></div></div></figure><p id="9bb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是这篇文章的全部内容！我们希望你喜欢整个系列！我们将再次推出这样的系列，这一次将是iOS Pentesting，我们将向您展示执行iOS Pentesting时的动态分析方法。</p><p id="e76d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">狩猎愉快！</p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><p id="7033" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">作者:</strong></p><p id="27b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">瓦伊巴夫·拉哈尼:<a class="ae ku" href="https://www.linkedin.com/in/vaibhav-lakhani" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/vaibhav-lakhani</a></p><p id="58c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ku" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">迪尔·帕尔马</a>:<a class="ae ku" href="https://www.linkedin.com/in/dhir-parmar-925b171a4" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/dhir-parmar-925b171a4</a></p></div><div class="ab cl mn mo hu mp" role="separator"><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms mt"/><span class="mq bw bk mr ms"/></div><div class="ij ik il im in"><h2 id="448a" class="mc md iq bd mu mv mw dn mx my mz dp na jy nb nc nd kc ne nf ng kg nh ni nj nk bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ku" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>