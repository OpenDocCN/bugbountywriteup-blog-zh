# 我是如何在一天之内从代币和望远镜中赚到 6000 美元的

> 原文：<https://infosecwriteups.com/how-did-i-earned-6000-from-tokens-and-scopes-in-one-day-12f95c6bf8aa?source=collection_archive---------1----------------------->

我不常做昆虫赏金，因为很难找到有趣的东西，也很难成为第一个记者… **但是前几天不一样。**

我打开我的电子邮件，看到了一个私人黑客程序的邀请。我看了一下，奖金很诱人，所以我说为什么不呢？

**第一阶段(侦察)**

范围非常小，只有两台主机:

> api.company.com
> 
> app.company.com

我创建了一个账户，然后我开始用打嗝来嗅我的流量，首先发现**用 Auth0** 处理认证， **Express。JS** 用于网络，JWT**用于会话。**

我尝试的第一件事是**将 JWT 的 alg**改为 none，然后冒充某个员工**，但是这太明显了**。None 不是一个有效的算法表示一个错误信息。

该应用程序的一个特性是**你可以邀请用户加入一个群组，然后改变他们帐户的权限/范围。**

那时，我非常专注于获得特权，并将我帐户升级为雇员。**在阅读了数千行 javascript 代码后**我意识到有些作用域没有出现在编辑用户权限菜单中…

**第二阶段(获得特权)**

我检测到 2 个有趣的范围: ***公司:支持*** 和 ***公司:运营***

他们的名字是**，告诉我这些范围是保留给员工的**，所以我尝试的第一件事是:邀请其他用户加入群组，然后将他的范围改为员工的范围。

**Kids stuff** …用打嗝拦截请求，然后欺骗 scopes 参数。200 OK 从服务器，在这一点上，我可以收到赏金，但我想要更多…

**第三阶段(确认一下)**

现在，我们有了拥有员工权限的帐户，但应用程序似乎是一样的，没有更改，没有管理操作。**所以又回去侦察了。**

在 javascript 库里面有一个我以前没有见过的服务的 api 引用，在下面的一个评论里，它说了这样的话:🥳员工运营服务

所以我尝试了什么？您猜对了，向那个 api 引用发送一个请求，然后祈祷得到一个 200 OK。

此时，我确认了权限提升。

向程序报告， **9.9 CVSS 3.1 和 3000 美元赏金。**

等等！你说 6000 美元？

还有另一个功能:你可以为你的帐户创建 API 键…并为其分配范围！🤭🤭🤭

拦截 api 生成请求，用 employees 欺骗参数范围，这样就完成了！**另外 9.9 cvss 3.1 和 3000$**