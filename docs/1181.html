<html>
<head>
<title>How I made it to Google HOF?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我是如何到达Google HOF的？</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/how-i-made-it-to-google-hof-f1cec85fdb1b?source=collection_archive---------0-----------------------#2021-03-21">https://infosecwriteups.com/how-i-made-it-to-google-hof-f1cec85fdb1b?source=collection_archive---------0-----------------------#2021-03-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1fce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿，大家好，</p><p id="9999" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我知道我已经很久没有分享我的发现了，很抱歉，我现在回来了，不要担心:)</p><p id="a4f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我将谈论我提交给谷歌VRP的一些有效的错误，因为它们已经被修复，现在我可以分享细节了。</p><p id="72e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个bug是withgoogle.com子域中的一个简单的反射xss，我可以使用简单的自动化找到它，另外两个是我在appsheet.com找到的IDORs，这是谷歌的收购。</p><p id="ac36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不浪费任何时间，让我们开始吧！</p><h1 id="d515" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">artsexperiments.withgoogle.com的XSS</h1><p id="ddd8" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">过去我一直使用这个简单的脚本来寻找一些简单的xss，我在这里使用了两个工具，一个是Paramspider，另一个是kxss。</p><p id="c9c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为输入，我为脚本提供一个包含子域列表的文件名，然后使用for循环逐个遍历子域列表，并查找其中包含参数的任何URL。然后，它将输出通过管道传输到kxss工具，该工具会查找某些字符的反射，如“，&gt;，</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="lt lu l"/></div></figure><div class="lv lw gp gr lx ly"><a href="https://github.com/devanshbatham/ParamSpider" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">devanshbatham/ParamSpider</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">Finds parameters from web archives of the entered domain. Finds parameters from subdomains as well. Gives support to…</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="mi l mj mk ml mh mm mn ly"/></div></div></a></div><div class="lv lw gp gr lx ly"><a href="https://github.com/tomnomnom/hacks/tree/master/kxss" rel="noopener  ugc nofollow" target="_blank"><div class="lz ab fo"><div class="ma ab mb cl cj mc"><h2 class="bd ir gy z fp md fr fs me fu fw ip bi translated">tomnomnom/hacks</h2><div class="mf l"><h3 class="bd b gy z fp md fr fs me fu fw dk translated">A collection of hacks and one-off scripts. Contribute to tomnomnom/hacks development by creating an account on GitHub.</h3></div><div class="mg l"><p class="bd b dl z fp md fr fs me fu fw dk translated">github.com</p></div></div><div class="mh l"><div class="mo l mj mk ml mh mm mn ly"/></div></div></a></div><p id="c082" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">I just collected the list of subdomains of withgoogle.com and then passed it to this script and found that “,&gt;，</p><p id="6400" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Here is the url: <a class="ae mp" href="https://www.google.com/url?q=https://artsexperiments.withgoogle.com/living-archive/?token%3D158753034&amp;sa=D&amp;usg=AFQjCNEQz64Oasdzq64DAeTLO3G42aLyMw" rel="noopener ugc nofollow" target="_blank">https://artsexperiments.withgoogle.com/living-archive/?token=158753034 </a></p><p id="463b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在这里使用任何常见的有效负载，例如:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="6fd0" class="mv km iq mr b gy mw mx l my mz">“&gt;&lt;img src=x onerror=alert(document.domain)&gt;</span></pre><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi na"><img src="../Images/83dd16ed499151c2b6db4bee29e0ebcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EHrD0UmS1Ftlj4ehmsGMkg.png"/></div></div></figure><p id="155e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在转到伊多尔</p><h1 id="64d1" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">appsheet.com的伊多</h1><p id="cd64" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我正在读这篇文章:<a class="ae mp" href="https://medium.com/bugbountywriteup/the-short-tale-of-two-bugs-on-google-cloud-product-google-vrp-resolved-47c913dca8fc" rel="noopener">https://medium . com/bugbountywriteup/the-short-tale-of-two-bugs-on-Google-cloud-product-Google-VRP-resolved-47c 913 DCA 8 fc</a>(遗憾的是作者已经删除了他的文章)</p><p id="646c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这篇文章中，我了解了谷歌VRP范围内的Appsheet，作者在那里分享了IDOR的细节。</p><p id="57f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我决定找同样的，你可能听过<a class="ae mp" href="https://twitter.com/zseano" rel="noopener ugc nofollow" target="_blank"> Zseano </a>说:“<strong class="jp ir"> <em class="ng">如果有一个IDOR…就会有更多的</em> </strong>”</p><p id="499d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我没想到我会这么容易就找到一个和其他黑客在他的文章中提到的相似或相同的id，这没花我一个多小时。</p><p id="cd8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">端点相同，参数也相同，唯一不同的是请求方法。</p><p id="26b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是https://www.appsheet.com/api/template/{appId}/的端点<a class="ae mp" href="https://www.appsheet.com/api/template/{appId}/" rel="noopener ugc nofollow" target="_blank"/>，我发现IDOR在GET方法中是固定的，但是相同的IDOR仍然存在于POST方法中，在请求的主体中也有一些数据。</p><p id="b7ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我找到IDOR的完整请求:</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nh"><img src="../Images/3245acc51afab801d9defeb570bb1883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IEgxRSQEQk1YifD6NU2mHg.png"/></div></div></figure><p id="ee64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在回应中，你将获得该应用程序的所有细节，包括所有者的电子邮件，firebase令牌等。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ni"><img src="../Images/f074320d6724df34b828ca456ab14398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OiH9DciunBelfGKmfOwirw.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk translated">截断响应</figcaption></figure><p id="3842" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我很快提交了报告，我收到了团队的回复，他们不能为他们复制IDOR，因为当他们在此请求中使用其他用户的appId时，会出现禁止的错误。</p><p id="c961" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后，我提供了额外的信息，并且为了帮助他们容易地重现bug，我给了他们一个appId列表以及一个curl请求，其中包含我的cookies。</p><figure class="lo lp lq lr gt ls gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nn"><img src="../Images/564d47a0994d5dcc674616ecec131d2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XRn1UxLorwcBU_ERug5VuA.png"/></div></div></figure><p id="0c87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我的报告被接受了，第二天他们就支付了500美元的奖金，这真是太快了。</p><p id="9f8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">故事还没有结束，等待高潮。</p><figure class="lo lp lq lr gt ls"><div class="bz fp l di"><div class="no lu l"/></div></figure><p id="c66a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4个月后，我收到了谷歌团队的回复，称:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="e954" class="mv km iq mr b gy mw mx l my mz">This might not be actually a bug , they told me to look at my app settings to verify few things like which users are allowed to view my app(whether it's set to public or not),etc</span></pre><p id="6979" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我回答说我使用默认设置，没有做任何改变。</p><p id="b78e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们又回答说:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="ce0f" class="mv km iq mr b gy mw mx l my mz">It seems that what you reported might be working as intended and that there is <strong class="mr ir">no security vulnerability</strong> and we were just confused.</span></pre><p id="73a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为我也很困惑，不知道事情会怎样发展，所以我回答他们:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="efe2" class="mv km iq mr b gy mw mx l my mz">Hey XXXX,</span><span id="59f1" class="mv km iq mr b gy np mx l my mz">Can you provide me with an appId which I shouldn't have access to?</span><span id="37f7" class="mv km iq mr b gy np mx l my mz">If I am able to get the information related to that appId than this is indeed a bug which should be fixed or else if that's not the case you can close this report as intended behaviour.</span><span id="2896" class="mv km iq mr b gy np mx l my mz">Regards</span><span id="b80f" class="mv km iq mr b gy np mx l my mz">Sudhanshu</span></pre><p id="e6a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我把它作为一个挑战，谷歌团队提供了一个appId，启动了我的burpsuite，我得出结论，我也得到同样的错误</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="c137" class="mv km iq mr b gy mw mx l my mz">Your account sudi***@gmail.com id 2342347 does not have access to XXXX-1422495.</span></pre><p id="01be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我告诉他们，是的，他们是对的，这不是一个错误，因为我无法查看任何与他们的应用程序相关的信息。在知道这实际上不是一个bug之后，我感觉不太好，他们仍然错误地给了我奖金。</p><p id="48e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二天，我决定再次查看appsheet.com，这次是为了找到一个有效的bug。我创建了一个新的应用程序，在体验了它的功能之后，不知道为什么我决定再次检查这个IDOR。</p><p id="dc48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我拿了谷歌团队成员给我的appId并发送了请求，这次成功了！我可以看到他们申请的细节。</p><p id="3bf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呜！！但是我不知道它是如何工作的</p><p id="1420" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我再次回答他们:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="3987" class="mv km iq mr b gy mw mx l my mz">Kindly ignore the previous message where I told that I wasn't able to get the information for your app.</span><span id="1d36" class="mv km iq mr b gy np mx l my mz">Today I tried again and I was able to get information for your app.<br/>Well well I am pretty sure this is your email only lastName<a class="ae mp" href="mailto:straka.martin@gmail.com" rel="noopener ugc nofollow" target="_blank">.firstName@gmail.com</a> :)</span></pre><p id="5193" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">仔细查看请求体参数值后，与之前相比，唯一不同的是版本。</p><p id="29de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我在帖子正文中第一次确认这个IDOR时，<em class="ng">版本</em>参数值被设置为<code class="fe nq nr ns mr b">1.00003</code></p><p id="0595" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而第二天我用新的app尝试的时候，<em class="ng">版本</em>参数值是<code class="fe nq nr ns mr b">1.000010</code></p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="c19e" class="mv km iq mr b gy mw mx l my mz">{<br/>  "settings": null,<br/>  "getAllTables": true,<br/>  "syncsOnConsent": true,<br/>  "isPreview": true,<br/>  "apiLevel": 2,<br/>  "tzOffset": -330,<br/>  "locale": "en-US",<br/>  "tableTimestamps": {},<br/>  "lastSyncTime": "",<br/>  "appStartTime": "",<br/>  "dataStamp": "2021-01-17T11:32:42.705Z",<br/>  "clientId": "4d9ef5e1-5cb0-400f-b432-660adcd24739",<br/>  "build": "edf35e60c1c1fcaaa72a-1610841603810-bd06078",<br/>  "version": "1.000010"<br/>}</span></pre><p id="a87f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在注意到这个小小的差异后，我得出结论，为了让这个IDOR工作，我们需要提供与应用程序相关的特定版本。</p><p id="cca3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也就是说，我的应用程序的版本是<code class="fe nq nr ns mr b">1.00003</code>，而谷歌员工的应用程序的版本是<code class="fe nq nr ns mr b">1.000010</code></p><p id="b141" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于版本的差异，我们都不能正确地重现错误，因为现在一切都很清楚了，我再次向他们解释了一切。</p><p id="2608" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我给他们解释后收到的回复:</p><pre class="lo lp lq lr gt mq mr ms mt aw mu bi"><span id="ace7" class="mv km iq mr b gy mw mx l my mz">Hi Sudhanshu,<br/><br/>Nice, that's my testing application! Definitely a bug - thanks!<br/><br/>Regards,<br/>XXXX, Google Security Team</span><span id="b3d4" class="mv km iq mr b gy np mx l my mz">-------------------------------------------------------------------</span><span id="12ce" class="mv km iq mr b gy np mx l my mz"><br/>Hi Sudhanshu,<br/><br/>Thanks again for your report. I can confirm that this is indeed a valid bug. I've also sent this report again to the VRP panel so they can have a look again.<br/><br/>Regards,<br/>XXXXX, Google Security Team</span></pre><p id="5224" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这之后我真的很高兴，因为我证明了我的bug是有效的。</p><p id="1bb4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几个星期后，错误被修复，令人惊讶的是，他们还奖励了500美元(这是我完全没有想到的)。</p><p id="9170" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我谈到的另一个例子是在这个终点:<a class="ae mp" href="https://www.google.com/url?q=https://www.appsheet.com/api/loadApp/%7BappId%7D/?checkConsistency%3Dtrue&amp;sa=D&amp;usg=AFQjCNGKcIjIPJyAKHvEtyQDLmaVloiocQ" rel="noopener ugc nofollow" target="_blank">https://www.appsheet.com/api/loadApp/{appId}/?检查一致性=真</a></p><p id="55d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的回复中披露的信息没有任何敏感信息，如所有者的电子邮件等，所以尽管他们解决了这个问题，但没有奖励第二个IDOR。</p><p id="be68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">故事到此结束。</p><p id="f45e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常感谢，如果你一直读到最后，真的很感谢你的时间。</p><p id="98dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Syaa每个人</p></div></div>    
</body>
</html>