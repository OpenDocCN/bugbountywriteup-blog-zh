<html>
<head>
<title>Not Applicable: Homograph Attack via Whatsapp Status</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不适用:通过Whatsapp状态的同形异义攻击</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/not-applicable-homograph-attack-via-whatsapp-status-75441970c453?source=collection_archive---------0-----------------------#2019-06-23">https://infosecwriteups.com/not-applicable-homograph-attack-via-whatsapp-status-75441970c453?source=collection_archive---------0-----------------------#2019-06-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="738f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://fаcebook.com/(国际化域名):<a class="ae kl" href="https://fаcebook.com/" rel="noopener ugc nofollow" target="_blank"/>是拉丁语<a class="ae kl" href="https://xn--fcebook-2fg.com/" rel="noopener ugc nofollow" target="_blank">的同形异义词https://xn-fcebook-2fg.com/</a>。【аcebook.com/which】在WhatsApp上放一个状态，当放URL的时候显示<a class="ae kl" href="https://f" rel="noopener ugc nofollow" target="_blank"> https://f </a>是一个Punycode域名，而不是真正的facebook域名。<br/>在点击状态时，任何受信任的用户都可能认为他/她被重定向到了<a class="ae kl" href="https://f" rel="noopener ugc nofollow" target="_blank">https://f</a>аcebook.com/，但实际上，它被重定向到了一个同形异义URL<a class="ae kl" href="https://xn--fcebook-2fg.com/" rel="noopener ugc nofollow" target="_blank">https://xn-fcebook-2fg.com/</a><br/>显示同形异义URL<a class="ae kl" href="https://xn--fcebook-2fg.com/" rel="noopener ugc nofollow" target="_blank">https://xn-fcebook-2fg.com/</a>比显示<a class="ae kl" href="https://f" rel="noopener ugc nofollow" target="_blank">https://f</a>аcebook.com/(Unicode URL)更安全。<br/>因此，如果我们使用burp collaborator，我们可以看到来自我的ISPs IP地址和谷歌DNS的DNS和HTTP查询。这意味着该域是本地解析的。因此，如果域被解析，攻击者可以确保人们很好地尝试放置状态，这有助于创建更复杂的网络钓鱼攻击。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/1cc414db09874e9d645b99203c41e6ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mM2Fo2jXCIDZL2To_7tHdg.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Burp协作者url处于状态</figcaption></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/154f3cde0b819de2c7efb099e54aa5a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZwXA_fCRuQXF3K0ALXCxg.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">在Burp Collaborator中查询whatsapp状态</figcaption></figure><h2 id="915f" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated"><strong class="ak">影响:</strong></h2><p id="f279" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">这种攻击侵犯了用户的隐私，因为once可以创建一个Punycode URL，并将其放在状态中，然后发送给特定用户的列表。该用户可能点击链接，认为它是真正的fаcebook，并被重定向到同形异义词URL，该URL确认具有特定行为的用户更频繁地使用fаcebook。</p><blockquote class="mb mc md"><p id="d95e" class="jn jo me jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">例如，<br/>在一些水洞的情况下，网络钓鱼攻击者可以把不同的经常访问的网站的多个链接的状态。<br/>那么在多个网站中，用户/群组可能会访问特定的网站。即使在这些IDN链接中的一个，如果用户由于疏忽而输入凭证，也可能使攻击成功。</p><p id="010b" class="jn jo me jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">其他情况包括，如果浏览器由于url欺骗而无法解析URL，或者需要时间来加载punycode url，则用户可能会输入域的凭据。</p><p id="d6a8" class="jn jo me jp b jq jr js jt ju jv jw jx mf jz ka kb mg kd ke kf mh kh ki kj kk ij bi translated">先放<a class="ae kl" href="https://www" rel="noopener ugc nofollow" target="_blank"> https://www </a>吧。аррӏе.com/ in状态的whatsapp(这是来自<a class="ae kl" href="https://www.xudongz.com/blog/2017/idn-phishing/" rel="noopener ugc nofollow" target="_blank">郑旭东</a>的POC)。现在，当我们在firefox上打开这个域名时，它在punycode上显示为apple.com，这个问题已经在<a class="ae kl" href="https://bugzilla.mozilla.org/show_bug.cgi?id=279099" rel="noopener ugc nofollow" target="_blank"> bugzilla </a>上讨论了15年。<br/>如果受信任的用户将这种类型的域和联系人放在一起试图打开suc恶意域，则可能有人最终会下载恶意文件。</p></blockquote><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/b2bf4d4c1adff215e64844883700a1a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qHVm-fbYyjYIT6XXp_o-_w.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">Whatsapp状态显示假冒apple.com</figcaption></figure><p id="c2ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">像firefox这样的浏览器仍然显示域名，而不把它们转换成域名。(链接:<a class="ae kl" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1332714" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="me">Bugzilla</em></strong></a><strong class="jp ir"><em class="me">)。</em> </strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/0563ea51d5a5a58ab9bf0cad27db32ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*ueWZCstR8rcOLKMJy7avMQ.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">火狐显示同形异义网址。# <a class="ae kl" href="https://bugzilla.mozilla.org/show_bug.cgi?id=279099" rel="noopener ugc nofollow" target="_blank">错误279099 </a></figcaption></figure><h2 id="fb15" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated"><strong class="ak">预期行为:</strong></h2><p id="ba4a" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">该页面应该显示像facebook个人资料状态的同形异义URL。</p><h2 id="d4dc" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated"><strong class="ak">解决方案:</strong></h2><p id="acf0" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">它包括显示punycode来代替实际的UTF-8文本。Punycode是Unicode域名的ASCII表示，最初是因为域名服务基础设施不支持Unicode而实现的(Costello 2003)。对于特定的链接，悬停在地址栏和状态栏中通常会显示Punycode替代项。IDNA问题可以在客户端处理，不需要任何域名服务器(DNS)的改变。</p><p id="f6b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">脸书已经为概况上的状态实现了这一点。它显示了IDN URL的punycode版本的状态。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mj"><img src="../Images/b4db07f3b165f6435f3e3e5474cf61ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_otr9WlaW7IipiDfX2g_w.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk translated">punycode url的脸书状态</figcaption></figure><h2 id="712d" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated"><strong class="ak">参考:</strong></h2><p id="9914" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated"><a class="ae kl" href="https://www.xudongz.com/blog/2017/idn-phishing/" rel="noopener ugc nofollow" target="_blank">https://www.xudongz.com/blog/2017/idn-phishing/</a><br/><a class="ae kl" href="https://bugzilla.mozilla.org/show_bug.cgi?id=279099" rel="noopener ugc nofollow" target="_blank">https://bugzilla.mozilla.org/show_bug.cgi?id=279099</a><br/><a class="ae kl" href="https://www.charset.org/punycode?encoded=http%3A%2F%2Fxn--eby-7cd.com%2F&amp;decode=Punycode+to+normal+text" rel="noopener ugc nofollow" target="_blank">https://www.charset.org/punycode?encoded=http%3A%2F%2Fxn-eby-7cd . com % 2F&amp;decode = puny code+to+normal+text</a><br/><a class="ae kl" href="https://en.wikipedia.org/wiki/Internationalized_domain_name" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Internationalized_domain_name</a><br/><a class="ae kl" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1332714" rel="noopener ugc nofollow" target="_blank">https://bugzilla.mozilla.org/show_bug.cgi?id=1332714</a><br/><a class="ae kl" href="https://www.wordfence.com/blog/2017/04/chrome-firefox-unicode-phishing" rel="noopener ugc nofollow" target="_blank">https://www . word fence . com/blog/2017/04/chrome-Firefox-unicode-phishing</a><br/>注:<a class="ae kl" href="http://ro.ecu.edu.au/cgi/viewcontent.cgi?article=1174&amp;context=ecuworks2012" rel="noopener ugc nofollow" target="_blank">http://ro.ecu.edu.au/cgi/viewcontent.cgi?article=1174&amp;context = .</a></p><h2 id="bc0c" class="ld le iq bd lf lg lh dn li lj lk dp ll jy lm ln lo kc lp lq lr kg ls lt lu lv bi translated">时间线:</h2><p id="ed05" class="pw-post-body-paragraph jn jo iq jp b jq lw js jt ju lx jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">5月25日报告的错误在6月19日不适用(因为它超出了社会工程攻击的范围)。<br/>6月22日接受披露。</p><p id="cde8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="me">注意:</em> <br/> <em class="me">即使这个bug不适用，我还是发布了这个报告，因为这种类型的攻击有可能被用于通过whatsapp状态进行网络钓鱼。<br/>我想请求研究人员，如果有人有兴趣进一步了解此事，并上报此事，以展示此类攻击的实际影响或任何进一步的反馈或评论。我仍在计算这种攻击在野外的影响。SOC中的安全分析师非常清楚公司中发生的此类攻击。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/justmorpheus"><div class="gh gi mk"><img src="../Images/4bc5de35955c00939383a18fb66b41d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:340/format:webp/1*9vg3-OY14aZN1UpKwIxxZg.png"/></div></a></figure></div></div>    
</body>
</html>