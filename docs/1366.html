<html>
<head>
<title>‘modprobe’ for digital peace of mind 🍃</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“modprobe ”,数字安心🍃</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/modprobe-for-digital-peace-of-mind-86638e3a77be?source=collection_archive---------1-----------------------#2021-06-06">https://infosecwriteups.com/modprobe-for-digital-peace-of-mind-86638e3a77be?source=collection_archive---------1-----------------------#2021-06-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="47e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Linux内核中添加和删除模块以保护数字隐私。</p><h2 id="2941" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">你问什么是modprobe？</h2><blockquote class="le lf lg"><p id="6d32" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated"><strong class="jp ir"> modprobe </strong>智能地在Linux内核中添加或删除模块。modprobe在模块目录<strong class="jp ir"> /lib/modules/`uname -r` </strong>中查找所有模块和其他文件，除了<strong class="jp ir"> /etc/modprobe.d </strong>目录中的可选配置文件。</p><p id="6b9e" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated">~(手册)页</p></blockquote><h2 id="f926" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">Linux中的内核和内核模块</h2><p id="cbef" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">在Linux中，你可以通过“内核模块”为基本内核添加功能。这些程序可以在内核级加载，然后使用公开的API与您的资产进行通信。这就是大多数驱动程序在Linux中的工作方式，它们加载自己的内核模块并扩展内核的功能，以实现它们想要实现的功能，然后使用新公开的内核功能在用户级运行其余的代码。</p><h2 id="11de" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">内核模块和隐私</h2><p id="cdc8" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">所以，我们知道内核模块被用来驱动设备，我们删除这些驱动程序并在内核级别禁用设备怎么样？</p><p id="bf88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这正是我们要做的，关闭摄像头是一回事，但删除凸轮驱动程序本身有时是矫枉过正，但却是必要的邪恶。下图很好地形象化了这个想法。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/46bb0f7f9d2d1a402581d7c8f1c15873.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/0*jy6POViAcL4Xhho-.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">kernels.png(opensource.com)</figcaption></figure><p id="6457" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">比方说，我们想阻止我们的摄像头，然后我们将删除(卸载)摄像头内核模块(驱动程序)这样做将禁用硬件和您的程序之间的唯一链接，因此禁止在未来使用摄像头饲料，除非您重新加载驱动程序，或者如果您根本不使用您的摄像头或相关设备是连接摄像头的生产机器，您可以直接将驱动器和模块列入黑名单，这将拒绝在引导过程中包含该模块。</p><h2 id="52b4" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">基本卸载语法</h2><p id="7b1e" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">使用<code class="fe md me mf mg b"><strong class="jp ir">modprobe -r &lt;<em class="lh">module_name</em>&gt;</strong></code>卸载任何模块，这将从当前运行的内核中移除该模块(该模块将在重启时再次加载)。</p><h2 id="50b0" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">黑名单程序</h2><p id="e73c" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">要将模块列入黑名单-</p><ol class=""><li id="6498" class="mh mi iq jp b jq jr ju jv jy mj kc mk kg ml kk mm mn mo mp bi translated"><code class="fe md me mf mg b"><strong class="jp ir">nano /etc/modprobe.d/blacklist.config</strong></code>(或者用你的fav。文本编辑器)。</li><li id="3b6c" class="mh mi iq jp b jq mq ju mr jy ms kc mt kg mu kk mm mn mo mp bi translated">在文件中添加<code class="fe md me mf mg b"><strong class="jp ir">blacklist &lt;<em class="lh">module_name</em>&gt;</strong></code>作为换行符并保存。</li></ol><p id="6bb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下次启动时不会加载该模块。</p><blockquote class="le lf lg"><p id="cf83" class="jn jo lh jp b jq jr js jt ju jv jw jx li jz ka kb lj kd ke kf lk kh ki kj kk ij bi translated">注意:黑名单模块可以通过<code class="fe md me mf mg b"><strong class="jp ir">modprobe &lt;module_name&gt;</strong></code>或<code class="fe md me mf mg b"><strong class="jp ir">insmod</strong></code> <strong class="jp ir"> </strong>工具手动加载。</p></blockquote><h1 id="5570" class="mv km iq bd kn mw mx my kq mz na nb kt nc nd ne kw nf ng nh kz ni nj nk lc nl bi translated">如何禁用您的网络摄像头？</h1><p id="3661" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">要禁用您的网络摄像头，您需要卸载<code class="fe md me mf mg b"><strong class="jp ir">uvcvideo</strong></code>模块，您可以在此阅读更多关于此模块的信息——</p><div class="nm nn gp gr no np"><a href="https://www.kernel.org/doc/html/v4.13/media/v4l-drivers/uvcvideo.html" rel="noopener  ugc nofollow" target="_blank"><div class="nq ab fo"><div class="nr ab ns cl cj nt"><h2 class="bd ir gy z fp nu fr fs nv fu fw ip bi translated">32.Linux USB视频类(UVC)驱动程序——Linux内核文档</h2><div class="nw l"><h3 class="bd b gy z fp nu fr fs nv fu fw dk translated">UVC规范允许通过扩展单元(Xu)进行特定于供应商的扩展。Linux UVC驱动程序…</h3></div><div class="nx l"><p class="bd b dl z fp nu fr fs nv fu fw dk translated">www.kernel.org</p></div></div></div></a></div><p id="677d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要用modprobe做到这一点，<code class="fe md me mf mg b"><strong class="jp ir">sudo modprobe -r uvcvideo</strong></code>应该做到。现在尝试打开任何使用相机的应用程序。为了形象化这一点，你做了类似于-</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/76a28284205889d6e0aef98fd0a4a002.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*FxuP17ddOQuCW0GYc-Y6xg.png"/></div><figcaption class="ly lz gj gh gi ma mb bd b be z dk translated">移除内核模块的可视化想法。</figcaption></figure><p id="e28d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，你可以选择特定的驱动程序和模块，卸载它们或将其列入黑名单(对于相机模块，在<code class="fe md me mf mg b"><strong class="jp ir">/etc/modprobe.d/blacklist.config</strong></code> <strong class="jp ir"> </strong>中添加一行→ <code class="fe md me mf mg b"><strong class="jp ir">blacklist uvcvideo</strong></code> <strong class="jp ir"> </strong>并重启)。</p><h2 id="a491" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">lsmod</h2><p id="cacb" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">要列出所有加载的内核模块，你可以使用<code class="fe md me mf mg b"><strong class="jp ir">lsmod</strong></code></p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/f7af5014aa8953168a6d4683759e6f3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BqDVwVd5A-DWJTMwX0x5w.png"/></div></div></figure><h2 id="c071" class="kl km iq bd kn ko kp dn kq kr ks dp kt jy ku kv kw kc kx ky kz kg la lb lc ld bi translated">摩登信息</h2><p id="c156" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">您也可以使用<code class="fe md me mf mg b">modinfo</code>来获取关于模块的信息。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi ny"><img src="../Images/fdbc0df1acc876402efe281781dc6211.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iriz1CFjkEQzG0Y7qPkBDA.png"/></div></div></figure><h1 id="3a4d" class="mv km iq bd kn mw mx my kq mz na nb kt nc nd ne kw nf ng nh kz ni nj nk lc nl bi translated">当心</h1><p id="88f8" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">卸载内核模块时要非常小心，一个错误的举动就会让你的整个系统陷入一场漂亮的崩溃！</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="nz oa di ob bf oc"><div class="gh gi od"><img src="../Images/59a7b86fd612a4519cf95505be867a39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*32yRtz0GZluB2sFKTlw9CA.png"/></div></div></figure><h1 id="b03a" class="mv km iq bd kn mw mx my kq mz na nb kt nc nd ne kw nf ng nh kz ni nj nk lc nl bi translated">结束语</h1><p id="9cbe" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">这将保护你免受90%的恶意软件的攻击和100%的用户错误。</p><p id="95db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这不会保护你远离那些知道他们在做什么的人，但会增加他们的努力，并可能起到威慑作用。</p></div></div>    
</body>
</html>