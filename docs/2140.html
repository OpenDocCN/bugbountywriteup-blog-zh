<html>
<head>
<title>OAuth Misconfiguration Leads To Pre-Account Takeover</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">OAuth错误配置导致预帐户接管</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/oauth-misconfiguration-leads-to-pre-account-takeover-8f94c1ef50be?source=collection_archive---------2-----------------------#2022-06-18">https://infosecwriteups.com/oauth-misconfiguration-leads-to-pre-account-takeover-8f94c1ef50be?source=collection_archive---------2-----------------------#2022-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0564" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你好，</p><p id="40c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天我要分享我在Bugcrowd私人程序上的一个有趣发现。因为这是一个私人项目，所以我将使用target.com作为网站名称。</p><p id="b195" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在测试target.com时，我注意到用户可以使用谷歌创建并登录target.com账户。现在有两种方式注册到target.com.By电子邮件注册谷歌oauth登录现在在这里target.com有一个薄弱的认证验证，它不检查以前的帐户是否创建了相同的电子邮件时，我们使用谷歌登录到我们的帐户。所以基本上，这意味着有人可以使用未注册的受害者帐户进行注册。之后，受害者将使用OAuth登录。在这种情况下，验证过程被绕过，攻击者可以在此之后使用密码登录。</p><h1 id="ff91" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">复制步骤</strong>:</h1><ol class=""><li id="fbf5" class="lj lk iq jp b jq ll ju lm jy ln kc lo kg lp kk lq lr ls lt bi translated">去https://target.com/signup/<a class="ae lu" href="https://badoo.com/en/signup/" rel="noopener ugc nofollow" target="_blank">用未注册的受害者账号注册。</a></li><li id="3ee3" class="lj lk iq jp b jq lv ju lw jy lx kc ly kg lz kk lq lr ls lt bi translated">之后，受害者将使用OAuth方法注册。</li><li id="35e4" class="lj lk iq jp b jq lv ju lw jy lx kc ly kg lz kk lq lr ls lt bi translated">这里发生的是，现在受害者可以轻松地使用受害者的帐户登录，绕过验证方法。</li></ol><h1 id="cb7a" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">运筹学</h1><p id="34ab" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">1:使用电子邮件注册为victim@gmail.com的<a class="ae lu" href="mailto:victim@gmail.com" rel="noopener ugc nofollow" target="_blank">注册</a></p><p id="569f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2:使用相同的电子邮件通过谷歌登录注册</p><p id="7619" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3:用户将登录</p><p id="f14f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4:此漏洞非常严重，因为如果受害者创建一个帐户，就会被利用并获得完全的帐户访问权限。</p><h1 id="7804" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">固定</h1><p id="5c6d" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">当已经有另一个帐户使用相同的电子邮件创建时，不要让用户使用oauth进入，或者让用户进入，但让他知道其他人已经创建了一个帐户，如果不是他，请他更改密码。</p><h1 id="d180" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">影响</h1><p id="039f" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">这里我们只需要一件东西，那就是电子邮件地址。只要知道我们可以接管受害者的帐户，那么这里的影响是相当高的。想象一下，如果你问的话，你甚至可以得到电子邮件地址，所以这不是一个困难的任务。但是由于oauth不验证真实用户，攻击者可以很容易地接管帐户。</p><p id="6f3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在Bugcrowd中报告了这个漏洞。很遗憾重复了。</p><figure class="me mf mg mh gt mi gh gi paragraph-image"><div role="button" tabindex="0" class="mj mk di ml bf mm"><div class="gh gi md"><img src="../Images/dfdb30a24b3671b89ce34849de7407d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FLdlbZ-WDCFfppOBVXFpKw.png"/></div></div></figure><h1 id="938c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">参照</h1><div class="mp mq gp gr mr ms"><a href="https://0xgaurang.medium.com/case-study-oauth-misconfiguration-leads-to-account-takeover-d3621fe8308b" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">[案例分析] OAuth配置错误导致帐户被接管</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">大多数安全漏洞都是在集成部分出现的，原因是第三方软件的不正确实现</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">0xgaurang.medium.com</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng mn ms"/></div></div></a></div><div class="mp mq gp gr mr ms"><a href="https://hackerone.com/reports/541701" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">Vercel在HackerOne上披露:Gitlab Oauth错误配置导致...</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">总结:# # # #你好我发现你没有用令牌Gitlab # # # #指定重定向哪个链接，让攻击者…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">hackerone.com</p></div></div><div class="nb l"><div class="nh l nd ne nf nb ng mn ms"/></div></div></a></div><p id="3a34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lu" href="https://portswigger.net/daily-swig/oauth-standard-exploited-for-account-takeover" rel="noopener ugc nofollow" target="_blank">https://portswigger . net/daily-swig/oauth-standard-exploited-for-account-take over</a></p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="7d66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="np">来自Infosec的报道:</em></strong><em class="np">Infosec上每天都会出现很多让人难以跟上的事情。加入我们的</em> <strong class="jp ir"> <em class="np">每周简讯</em> </strong> <em class="np">以5篇文章、4个线程、3个视频、2个Github Repos和工具以及1个</em> <strong class="jp ir"> <em class="np">工作提醒的形式免费获取所有最新的信息安全趋势！</em></strong><em class="np"/><a class="ae lu" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank"><em class="np">https://weekly.infosecwriteups.com/</em></a></p></div></div>    
</body>
</html>