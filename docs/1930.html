<html>
<head>
<title>[THM] Bounty Hacker Writeup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">[THM]赏金黑客报道</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/thm-bounty-hacker-writeup-3e680beea044?source=collection_archive---------5-----------------------#2022-03-07">https://infosecwriteups.com/thm-bounty-hacker-writeup-3e680beea044?source=collection_archive---------5-----------------------#2022-03-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ea2c663fdbf19776da49514758981e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TR8TGrXnzJi2djuu8vEswA.png"/></div></div></figure><p id="ac6f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://tryhackme.com/room/cowboyhacker" rel="noopener ugc nofollow" target="_blank"> Bounty Hacker </a>是TryHackMe中一个简单的机器，我们将使用基本的枚举和蛮力进入。</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="9a48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们用<a class="ae kw" href="https://github.com/robertdavidgraham/masscan" rel="noopener ugc nofollow" target="_blank"> MASSCAN </a>看看哪些端口是打开的:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="2efe" class="ln lo iq lj b gy lp lq l lr ls">masscan -p- --rate 1000 10.10.144.135</span></pre><ul class=""><li id="28b1" class="lt lu iq ka b kb kc kf kg kj lv kn lw kr lx kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-p-</code>:枚举所有TCP端口，从1到65535</li><li id="a0b7" class="lt lu iq ka b kb mf kf mg kj mh kn mi kr mj kv ly lz ma mb bi translated"><code class="fe mc md me lj b">--rate</code>:每秒向主机发送多少数据包</li></ul><blockquote class="mk ml mm"><p id="1f10" class="jy jz mn ka b kb kc kd ke kf kg kh ki mo kk kl km mp ko kp kq mq ks kt ku kv ij bi translated">我更喜欢使用MASSCAN来枚举端口，因为它比nmap快得多，所以在发现端口后，我们可以使用nmap来单独检查这些端口中运行的服务。</p></blockquote><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/9f8ae66e103283f9df50f443b6b81377.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TaHQnSlyoEqufUM1PhYgrw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">质量扫描输出</figcaption></figure><p id="fe08" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">发现开放端口后，我们可以使用<a class="ae kw" href="https://nmap.org/" rel="noopener ugc nofollow" target="_blank"> nmap </a>来检查服务器中正在运行哪些服务:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="a0ff" class="ln lo iq lj b gy lp lq l lr ls">nmap -p21,22,80 -Pn -sV 10.10.144.135</span></pre><ul class=""><li id="3b38" class="lt lu iq ka b kb kc kf kg kj lv kn lw kr lx kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-p</code>:我们要扫描的港口</li><li id="5ca9" class="lt lu iq ka b kb mf kf mg kj mh kn mi kr mj kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-Pn</code>:跳过主机发现，将所有主机视为在线</li><li id="8abf" class="lt lu iq ka b kb mf kf mg kj mh kn mi kr mj kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-sV</code>:检查服务/版本信息</li></ul><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/8f87a1adae26e74ba5b3cbb81d658d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fKrGxL6aCsAS0b8olAMN-Q.png"/></div></div></figure><p id="a9f7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从输出中，我们看到<strong class="ka ir">端口80 </strong>是打开的，并且它正在运行一个http服务，但是我找不到任何能带我们到那里的东西，所以我们现在就把它留下。</p><p id="2ce7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个值得检查的开放端口是<strong class="ka ir">端口21 </strong>，它正在运行<a class="ae kw" href="https://en.wikipedia.org/wiki/File_Transfer_Protocol" rel="noopener ugc nofollow" target="_blank"> FTP </a>服务，所以让我们检查一下<a class="ae kw" href="https://book.hacktricks.xyz/pentesting/pentesting-ftp#anonymous-login" rel="noopener ugc nofollow" target="_blank">匿名登录</a>是否被启用:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="54e6" class="ln lo iq lj b gy lp lq l lr ls">ftp 10.10.144.135</span></pre><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/e53ca5e6c3cdb3c654c6a8d8a28ae782.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yCQac7T1CV5dWc3uwqt3yQ.png"/></div></div></figure><p id="0552" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用命令<code class="fe mc md me lj b">ls -la</code>来列出内容:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/ccbc7573b6ac0bbd0ccc996d319bedd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZy2lso2l7-L1SiGC0Tqmg.png"/></div></div></figure><p id="3361" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可用目录中有两个文件，所以我们可以使用<code class="fe mc md me lj b">mget</code>来下载它们:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/3641264e6a06c6072efbb5ecd2383190.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Wj6eeiv_CGlOrX9CODQ6Q.png"/></div></div></figure><p id="0caf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们阅读文件，我们可以看到<code class="fe mc md me lj b">locks.txt</code>看起来像一个密码列表，而<code class="fe mc md me lj b">task.txt</code>似乎是来自一个名叫<code class="fe mc md me lj b">lin</code>的人的消息。</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/04a2af5b29680f360e307ed6dedc483e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WGrzIpjCvyHgnx_h"/></div></div></figure><h1 id="cb78" class="nb lo iq bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">接近机器</h1><p id="0fbd" class="pw-post-body-paragraph jy jz iq ka b kb ny kd ke kf nz kh ki kj oa kl km kn ob kp kq kr oc kt ku kv ij bi translated">我们可以从机器中的一个问题来假设下一步是什么:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/4072ef63255298291712659ec1f1eabb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e6Q6IdaWBq8hdBTpXx9vvg.png"/></div></div></figure><p id="3014" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">好吧，唯一有意义的其他可用服务是<a class="ae kw" href="https://en.wikipedia.org/wiki/Secure_Shell" rel="noopener ugc nofollow" target="_blank"> SSH </a>，运行在<strong class="ka ir">端口22 </strong>上。在这种情况下，我们可以使用名为<a class="ae kw" href="https://github.com/vanhauser-thc/thc-hydra" rel="noopener ugc nofollow" target="_blank"> Hydra </a>的工具:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="2fe9" class="ln lo iq lj b gy lp lq l lr ls">hydra -l lin -P locks.txt 10.10.144.135 ssh</span></pre><ul class=""><li id="a0b8" class="lt lu iq ka b kb kc kf kg kj lv kn lw kr lx kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-l</code>:用于登录的用户名(在这种情况下，我们可以假设<code class="fe mc md me lj b">lin</code>是来自<code class="fe mc md me lj b">task.txt</code>笔记的名字)</li><li id="97c3" class="lt lu iq ka b kb mf kf mg kj mh kn mi kr mj kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-P</code>:包含要测试的密码列表和用户名的文件</li></ul><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/d6e8c495de2a008c93f0e692a6b9f0ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DYGlS7yfvLIqzgstzpDH2g.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">九头蛇产量</figcaption></figure><p id="5bfc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有了用户名和密码，让我们使用SSH连接到服务器:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="24bd" class="ln lo iq lj b gy lp lq l lr ls">ssh lin@10.10.144.135</span></pre><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/965b2a90cf282c55990fe6b7137e3c11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2wAzdiFpr83ejnMFcNDLhw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">机器访问✅</figcaption></figure><p id="f0e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们可以在目录和文件中查找用户标志:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="111a" class="ln lo iq lj b gy lp lq l lr ls">cat /home/lin/Desktop/user.txt</span></pre><h1 id="e7e1" class="nb lo iq bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">权限提升</h1><p id="631b" class="pw-post-body-paragraph jy jz iq ka b kb ny kd ke kf nz kh ki kj oa kl km kn ob kp kq kr oc kt ku kv ij bi translated">在寻找权限提升向量时，我总是测试的第一件事是列出用户的权限，并检查当前用户是否可以作为root用户执行任何操作:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="5d8a" class="ln lo iq lj b gy lp lq l lr ls">sudo -l</span></pre><ul class=""><li id="ce6c" class="lt lu iq ka b kb kc kf kg kj lv kn lw kr lx kv ly lz ma mb bi translated"><code class="fe mc md me lj b">-l</code>:列出用户的权限</li></ul><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/20a25d028665097a7de657fec58f96b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uzCy9BkmA7I-i3RnBLhJOw.png"/></div></div></figure><p id="0e73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">似乎用户<code class="fe mc md me lj b">lin</code>被允许在这台机器上以root用户身份运行<code class="fe mc md me lj b">tar</code>命令。我们可以使用<a class="ae kw" href="https://gtfobins.github.io/gtfobins/tar/#sudo" rel="noopener ugc nofollow" target="_blank"> GTFOBins </a>来检查我们如何利用它:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oh"><img src="../Images/9ccbae357223b79aac01e60b2458d66c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nO5SNJPhVrp9y6gvOSbysg.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk translated">特权升级✅</figcaption></figure><blockquote class="mk ml mm"><p id="4ac4" class="jy jz mn ka b kb kc kd ke kf kg kh ki mo kk kl km mp ko kp kq mq ks kt ku kv ij bi translated">来自GTFOBins:如果二进制文件在<code class="fe mc md me lj b">sudo</code>之前被允许作为超级用户运行，它不会放弃提升的特权，并且可以用于访问文件系统、升级或维护特权访问。</p></blockquote><p id="2a44" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们可以读取根标志:</p><pre class="le lf lg lh gt li lj lk ll aw lm bi"><span id="66d2" class="ln lo iq lj b gy lp lq l lr ls">cat /root/root.txt</span></pre><h1 id="e61e" class="nb lo iq bd nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx bi translated">结论</h1><p id="f60d" class="pw-post-body-paragraph jy jz iq ka b kb ny kd ke kf nz kh ki kj oa kl km kn ob kp kq kr oc kt ku kv ij bi translated">这是一个有趣的机器，我认为它有一个很好的和聪明的方法来教我们如何使用Hydra，而不是让我们尝试用成千上万的密码长预制单词表。干得好(谢谢)！</p></div><div class="ab cl kx ky hu kz" role="separator"><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc ld"/><span class="la bw bk lb lc"/></div><div class="ij ik il im in"><p id="89aa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Infosec Writeups团队刚刚完成了我们的第一次虚拟网络安全会议和网络活动。我们有16位出色的演讲者，他们主持了非常有价值和鼓舞人心的会议。要查看演讲者和主题列表，请点击此处。</p><div class="oi oj gp gr ok ol"><a href="https://iwcon.live/" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">IWCon2022 — Infosec书面报告虚拟会议</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">与世界上最优秀的信息安全专家建立联系。了解网络安全专家如何取得成功。将新技能添加到您的…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">iwcon.live</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz jw ol"/></div></div></a></div></div></div>    
</body>
</html>