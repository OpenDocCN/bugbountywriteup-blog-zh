<html>
<head>
<title>No Rate Limit — use like a pro!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">没有速率限制—像专业人士一样使用！</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/no-rate-limit-use-like-a-pro-33fc76744a17?source=collection_archive---------0-----------------------#2021-03-17">https://infosecwriteups.com/no-rate-limit-use-like-a-pro-33fc76744a17?source=collection_archive---------0-----------------------#2021-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="40f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，感谢你对我之前(第一个)博客的精彩回复。</p><p id="f74a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇博客中，我将谈论我的有效错误，没有速度限制:</p><ol class=""><li id="9b27" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">对OTP旁路没有速率限制会导致验证旁路。</li><li id="d5ab" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">无速率限制保护旁路使用空字节。</li><li id="e8a8" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">通过发送消息来淹没用户邮箱的逻辑无速率限制。</li></ol><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/5f57127a3931e1b80368aad36247b4fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zeWV_DN7MYSTj_qQu3zZWA.png"/></div></div></figure><p id="67f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们开始:</p><p id="3c08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="lm">OTP旁路无速率限制导致验证旁路:</em> </strong></p><p id="64ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在RDP打猎。没有范围内/范围外的详细信息，也没有HOF。但是他们只对SQL注入、RCE等关键错误有固定的奖励范围。</p><p id="df2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我开始寻找低垂的虫子。在创建一个新账户时，他们要求提供一个电话号码和一封电子邮件，因为这是发送系统。对于电话号码验证，我们需要提交动态口令。因为没有超出“速率限制或暴力”范围的部分，所以我决定尝试绕过OTP验证。</p><p id="f352" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我请求了OTP，收到的OTP是1732。出于概念验证和测试目的，我将有效负载计数设置为50，即1700–1750，并将限制设置为3000毫秒。开始攻击，得到回应。同一个OTP使用两次没有限制。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi ln"><img src="../Images/252a5ed763cb3a95520c03ba5907edd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kRNlSa4lfd7hnSylkrHoNQ.png"/></div></div></figure><p id="e040" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">做了一个很酷的POC，报给了公司:)</p><p id="ad56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看完这篇文章后，你们中的许多人会想尝试将OTP密码重置为ATO。等等，我的朋友，密码重置机制非常强大。密码重置时，(1)加大油门绕过WAF。(2)您可以强制OTP，但不能两次使用同一个OTP，请通过粘贴正确的OTP响应来尝试响应操作。</p><p id="126c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lm">无速率限制保护旁路使用空字节:</em> </strong></p><p id="f864" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个场景中，我测试了密码重置链接的无速率限制。当我试图使用IP轮换绕过无速率限制保护时，我得到了一个奇怪的响应:200+429+200+429……。</p><figure class="lb lc ld le gt lf"><div class="bz fp l di"><div class="lo lp l"/></div></figure><p id="1700" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我仍然能够用大量的有效载荷计数来淹没受害者的邮箱，所以我向bugcrowd报告了此事，并得到了回应:</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lq"><img src="../Images/2222bef24a80788cfb0f417af7fb729d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Q9oypcksCSMJ_f_j1SQiA.png"/></div></div></figure><p id="1382" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试图向他们解释，虽然有保护措施，但我能够淹没受害者的邮箱，但仍然不适用。第二天，我使用空字节，在我的邮件前面添加了%00，即“mymail@gmail.com%00 ”,然后砰！全部200。进行了新的提交和报告。</p><p id="2bdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="lm">逻辑无速率限制，通过发送消息来淹没用户邮箱:</em> </strong></p><p id="ffd1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有时候你不得不在没有速率限制的情况下使用逻辑，请看这个伟大的例子<a class="ae kl" href="https://youtu.be/9KKA3qQy0V4" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">这里</strong> </a>。</p><p id="5ea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在测试RDP bug crowd。我尝试了无速率限制重置密码链接使用空字节，IP旋转，但没有运气。在网站上呆了几个小时后，我注意到在向另一个用户发送消息后，该用户会在邮件上收到类似“嗨，用户B，用户A向您发送了一条新消息”的通知警报。然后我发送了一条新消息，在Burp中捕获了请求，并将有效负载设置为400+并成功收到了400多封电子邮件。</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lr"><img src="../Images/828cd610ad91bd5fab5d11fdbcf56e9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7JDHRAj7IdNuYuXs3Gw3Q.png"/></div></div></figure><p id="2354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有费率限制是唾手可得的，但如果你能合理运用逻辑，这是值得的。</p><p id="9147" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢大家！</p><p id="9a7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您有任何疑问，请随时给我发邮件:)</p><p id="3fe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://www.linkedin.com/in/jaydev-ahire/" rel="noopener ugc nofollow" target="_blank"> Linkedin。</a></p></div></div>    
</body>
</html>