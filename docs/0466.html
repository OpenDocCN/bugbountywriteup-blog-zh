<html>
<head>
<title>CyberTruck Challenge 2019 — Android CTF</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2019年网络卡车挑战赛-安卓CTF</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/cybertruck-challenge-2019-android-ctf-e39c7f796530?source=collection_archive---------0-----------------------#2020-01-02">https://infosecwriteups.com/cybertruck-challenge-2019-android-ctf-e39c7f796530?source=collection_archive---------0-----------------------#2020-01-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8110" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CyberTruck Challenge 2019是一项重要活动，旨在汇集与重型车辆网络安全相关的利益群体，培养应对这些挑战的人才。这是为他们的CTF写的。他们的网站可以在<a class="ae kl" href="https://www.cybertruckchallenge.org/" rel="noopener ugc nofollow" target="_blank">这里</a>找到，挑战的Github简介可以在<a class="ae kl" href="https://github.com/nowsecure/cybertruckchallenge19" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="d925" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注:活动期间我没有在场。我想做的就是练习Android CTFs，这时候我看到了他们的 <a class="ae kl" href="https://github.com/nowsecure/cybertruckchallenge19" rel="noopener ugc nofollow" target="_blank"> <em class="km"> Github页面</em> </a> <em class="km">。</em></p><h2 id="a12c" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">使用的工具</h2><ul class=""><li id="78ba" class="lg lh iq jp b jq li ju lj jy lk kc ll kg lm kk ln lo lp lq bi translated"><a class="ae kl" href="https://ibotpeaches.github.io/Apktool/" rel="noopener ugc nofollow" target="_blank"> ApkTool </a></li><li id="2c25" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated"><a class="ae kl" href="https://github.com/pxb1988/dex2jar/" rel="noopener ugc nofollow" target="_blank"> dex2jar </a></li><li id="6af8" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated"><a class="ae kl" href="https://github.com/java-decompiler/jd-gui/releases/" rel="noopener ugc nofollow" target="_blank">京东-桂</a></li><li id="ac1a" class="lg lh iq jp b jq lr ju ls jy lt kc lu kg lv kk ln lo lp lq bi translated">弗里达</li></ul></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="92cc" class="md ko iq bd kp me mf mg ks mh mi mj kv mk ml mm ky mn mo mp lb mq mr ms le mt bi translated">挑战描述</h1><p id="d056" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">最著名的汽车安全公司之一“NowSecure Mobile Vehicles”实施了一种新的移动遥控无钥匙系统“CyberTruck”。汽车安全公司已经确保该系统是完全不可破解的，因此攻击者将无法恢复移动应用程序中的秘密。</p><p id="436a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你是一个经验丰富的Android反向器，那么在解锁你的汽车之前，启用<code class="fe mx my mz na b">tamperproof</code>按钮来加固应用程序。你的目标是在应用程序中恢复6个秘密。</p><h1 id="e384" class="md ko iq bd kp me nb mg ks mh nc mj kv mk nd mm ky mn ne mp lb mq nf ms le mt bi translated">为CTF做准备</h1><h2 id="4ffd" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">安装应用程序</h2><p id="77fd" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">使用adb在手机上安装应用程序。</p><p id="158c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mx my mz na b">adb install cybertruck19.apk</code></p><h2 id="6424" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">使用ApkTool解码应用程序</h2><p id="7b59" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">使用Apktool解码APK，并将其输出到<code class="fe mx my mz na b">cybertruck-smali</code>文件夹。</p><p id="c99f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mx my mz na b">apktool d cybertruck19.apk -o cybertruck-smali</code></p><h2 id="5a92" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">正在转换apk。使用dex2jar的jar格式</h2><p id="5dc1" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">我把。apk到jar，因为这样我就可以使用JD-GUI来查看Java源代码。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/3a501c340a4d4a2547ed137da943c99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*2_E6zZYGLoHbzXVHoknouQ.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated"><em class="ns">注意:我下载了dex2jar并创建了一个工具目录，这样我所有的工具都很容易访问</em></figcaption></figure><p id="27e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<strong class="jp ir"> JD-GUI </strong>，我们打开由dex2jar创建的<code class="fe mx my mz na b">cybertruck.jar</code>(之前的命令)。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/c1eb2a0666c577d2475fad79e02aa825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*ZO9UeWlGMJ6iUF_jLKIDmg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated"><em class="ns">注意:我下载了jd-gui并创建了一个工具目录，这样我所有的工具都很容易访问</em></figcaption></figure><h2 id="bdfa" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">启动应用程序</h2><p id="9f4f" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated">我们一启动应用程序，就能看到这张图片。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/fcf593052d405ed0432621585dcc0ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:360/format:webp/1*HC27j26RSGCGyorq1rpzzg.png"/></div></figure><p id="9b22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们试图理解解锁按钮和切换按钮的作用。</p><h1 id="ce16" class="md ko iq bd kp me nb mg ks mh nc mj kv mk nd mm ky mn ne mp lb mq nf ms le mt bi translated">挑战1</h1><p id="836b" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><em class="km">解锁汽车1的挑战1。“DES key:完全无钥匙。</em>完全安全</p><p id="0cd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了弄清楚正在发起什么活动，让我们看一看<code class="fe mx my mz na b">AndroidManifest.xml</code></p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/f6ca16842dbc70d965de473101811ac9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*lgNrddThBMQIefRoQZ-QjQ.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated"><code class="fe mx my mz na b">AndroidManifest.xml</code>文件位于cybertruck-smali目录下(由apktool创建)</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/5c3747238cb6513e17f9dd1cee18e0d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*XB65TsjaoFMw4ozIGs9VUA.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">MainActivity是首先启动的活动</figcaption></figure><p id="783e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，用<code class="fe mx my mz na b">JD-GUI</code>来看看<code class="fe mx my mz na b">MainActivity.class</code>的源代码</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/3869220d8d91c5b3e68d4a5bbefdb69e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*w0aOQOh_VRsAfUUg29_Bzw.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">注意:我在工具目录下下载了jd-gui jar文件，并使用java启动</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi nx"><img src="../Images/71af18ac4067794664ea5024a41f28e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*06ES7P75_kbMrd5tWZhF3w.png"/></div></div></figure><p id="603d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">查看<code class="fe mx my mz na b">onCreate</code>功能，我们发现解锁按钮。点击解锁按钮，调用<code class="fe mx my mz na b">this.b.k()</code>。所以我们进一步调查。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/9dc50525a3ba672c735996ae3ac73628.png" data-original-src="https://miro.medium.com/v2/resize:fit:304/format:webp/1*9gPSJx9oCmbFKXs7oRueyQ.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">函数k的快照</figcaption></figure><p id="60da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该函数创建了一个类<code class="fe mx my mz na b">Challenge1</code>的实例。所以我们来看看<code class="fe mx my mz na b">Challenge1.class</code></p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi od"><img src="../Images/d8048c3e387e63bef63f792df71241e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O6G7O4nAz12bdpAiUXVgcg.png"/></div></div></figure><p id="737b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战1的静态标志为<code class="fe mx my mz na b">s3cr3t$_n3veR_mUst_bE_h4rdc0d3d_m4t3!</code></p><p id="30f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于动态标志，我们必须想办法在运行时获取<code class="fe mx my mz na b">generateDynamicKey</code>函数返回的值。这些正是弗里达派上用场的场景。你可以从弗里达的官方文件中了解更多。</p><figure class="nh ni nj nk gt nl"><div class="bz fp l di"><div class="oe of l"/></div></figure><p id="7908" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mx my mz na b">generateDynamicKey</code>返回一个字节数组。字节数组存储在变量<code class="fe mx my mz na b">result</code>中，我们将其转发给python函数<code class="fe mx my mz na b">on_message</code>。这里我们将字节数组转换成字符串。</p><h2 id="ced0" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">捕获动态标志</h2><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi og"><img src="../Images/ecbb79de68f1eceacaf01df5b2279571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/1*7PVEQ4QoPLJvUlwXyzNKjg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">首先，我们在android设备上运行frida-server。然后，我们使用flag-capture.py来捕获动态标志</figcaption></figure><p id="3219" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">动态标志为<code class="fe mx my mz na b">046e04ff67535d25dfea022033fcaaf23606b95a5c07a8c6</code></p><h1 id="6335" class="md ko iq bd kp me nb mg ks mh nc mj kv mk nd mm ky mn ne mp lb mq nf ms le mt bi translated">挑战#2</h1><p id="8ee6" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><em class="km">解锁汽车2的挑战2:“AES密钥:您的手机是您的钥匙”</em></p><p id="6c5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过<code class="fe mx my mz na b">MainActivity.class</code>中的<code class="fe mx my mz na b">this.b.k()</code>功能</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/629f41774c7a9e1fc9abec0a15e8cb2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:328/format:webp/1*Dzo-ZgUqs-V9ezyxpWR2xg.png"/></div></figure><p id="a7ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">调用类<code class="fe mx my mz na b">a</code>的实例。让我们进一步调查。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/848dccad477c09cfc4f424ef32aaf438.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*hTcEQlKpyt1ClEkFJ2tChg.png"/></div></figure><p id="c6ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们有了带有构造函数<code class="fe mx my mz na b">a</code>的类<code class="fe mx my mz na b">a</code>和两个名为<code class="fe mx my mz na b">a</code>的函数。</p><p id="ff33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">声明构造函数时，不需要指定返回值。所以public a(Context paramContext)是构造函数，其余都是函数。</p><p id="d8e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以这个文件包含:</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/0f605e524ae4eed2fc4ded595f9cae7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:434/format:webp/1*QY11GmOV97eaXFte38qnWw.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">构造器</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi ok"><img src="../Images/2176372e96ae1a4ef788b48cfd31728c.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*cqV8aDib4K0fg7q_SK8pwg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">接受一个参数并返回字节数组的函数</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi ol"><img src="../Images/b0bb7c968015ffae449cc6f46c61d8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*T0UMh2i--l9yuOezRyZzRQ.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">接受两个参数并返回字节数组的函数</figcaption></figure><p id="ef7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不管怎样，回到构造函数a，它调用<code class="fe mx my mz na b">a(Context paramContext)</code>，然后它的返回值被作为<code class="fe mx my mz na b">a(byte[] paramArrayOfbyte1, byte[] paramArrayOfbyte2)</code>中的一个参数传递</p><p id="7fca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我们来看看函数<code class="fe mx my mz na b">a(Context paramContext)</code></p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi om"><img src="../Images/0d44c8adfc9874942c5586241e9f89a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1374/format:webp/1*Q6rw5ylIwa-bqlig4YqT5Q.png"/></div></figure><p id="8c16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">文件ch2.key已打开。所以我们来看看它的内容。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/8594ca232358c968fa60f59a17f8d7d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*nB1XWbSakEY5RrjKS_b0-w.png"/></div></figure><p id="aaa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战2的静态标志的值是<code class="fe mx my mz na b">d474_47_r357_mu57_pR073C73D700!!</code></p><p id="c53c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们看看功能<code class="fe mx my mz na b">a(byte[] paramArrayOfbyte1, byte[] paramArrayOfbyte2)</code></p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi on"><img src="../Images/ac8a33744734b9409ba970e22d86e139.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*ls3a6PTjEcRVWpUf8Mc39Q.png"/></div></figure><p id="a5c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于动态标志，我们需要再次使用Frida来捕获这个函数的返回值</p><figure class="nh ni nj nk gt nl"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">我们将这个javascript片段附加到flag-capture.py文件中的js_code变量</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/a5553c11131b5c42789afc0199205a86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*H5E7QZBuctqOm4x4ijhJRg.png"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">在将上面的代码片段附加到js_code之后，我们重新运行flag-capture.py</figcaption></figure><p id="d150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">挑战2的动态标志是<code class="fe mx my mz na b">512100f7cc50c76906d23181aff63f0d642b3d947f75d360b6b15447540e4f16</code></p><h1 id="44d4" class="md ko iq bd kp me nb mg ks mh nc mj kv mk nd mm ky mn ne mp lb mq nf ms le mt bi translated">挑战3</h1><p id="5a83" class="pw-post-body-paragraph jn jo iq jp b jq li js jt ju lj jw jx jy mu ka kb kc mv ke kf kg mw ki kj kk ij bi translated"><em class="km">解锁汽车3的挑战3。"卡车先生:给我开锁，宝贝！"</em></p><p id="34d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Challenge3描述:</strong>原生代码中有一个有趣的字符串。你能抓住它吗？</p><p id="04ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<code class="fe mx my mz na b">MainActivity.class</code>内部，这个<code class="fe mx my mz na b">native-lib.so</code>是加载的。</p><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div class="gh gi op"><img src="../Images/d016cf66a8e2c34fdd1393d068ad057e.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*XSxqkWea5tnGJ05hugxxHw.png"/></div></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi oq"><img src="../Images/046912a964236d5aa5641b323ba9e06f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dIC-ILhAHsH0F9uAe32Jag.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">我们首先定位这个文件，然后使用<strong class="bd kp">字符串</strong>打印文件中的所有字符串</figcaption></figure><p id="429a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本次挑战的静态标志为<code class="fe mx my mz na b">Native_c0d3_1s_h4rd3r_To_r3vers3</code></p><p id="2755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于动态标志，这取决于您的设备的指令集。在我的例子中，是<code class="fe mx my mz na b">arm64-v8a</code>要求你能够理解同样的汇编语言指令。这似乎超出了我的能力范围(..还没！).</p><h2 id="29a7" class="kn ko iq bd kp kq kr dn ks kt ku dp kv jy kw kx ky kc kz la lb kg lc ld le lf bi translated">如何绕过防篡改检查？</h2><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi or"><img src="../Images/c3b0981f6d60795d9e1dd81b1414875e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cj-7s8Woz1RAnjnykNbzAw.png"/></div></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">该函数检查该设备中是否有frida服务器</figcaption></figure><figure class="nh ni nj nk gt nl gh gi paragraph-image"><div role="button" tabindex="0" class="ny nz di oa bf ob"><div class="gh gi os"><img src="../Images/2bde1bf3a09f748e6af585048f319758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXfcr5TDB_GnjecEs8_Veg.png"/></div></div></figure><p id="cfe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果frida服务器存在，该函数返回true，否则返回false。所以我们使用Frida来覆盖这个函数的返回值</p><figure class="nh ni nj nk gt nl"><div class="bz fp l di"><div class="oe of l"/></div><figcaption class="no np gj gh gi nq nr bd b be z dk translated">将这段代码附加到flag-collector.py中的js_code</figcaption></figure><p id="9a16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我对这个CTF的解决方案。我仍然是CTFs的新手，还有很多需要学习的地方。然而，这次CTF是一个很好的学习机会。希望你也学到了一些东西。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="f549" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读我的文章！干杯！🍺</p><p id="688c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae kl" href="https://twitter.com/fake_batman_" rel="noopener ugc nofollow" target="_blank"> Twitter </a>、<a class="ae kl" href="https://github.com/harshitm98" rel="noopener ugc nofollow" target="_blank"> Github </a>上关注我，或者在<a class="ae kl" href="https://linkedin.com/in/harshitm98" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>上联系我。</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><p id="671f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">关注</em> <a class="ae kl" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="km"> Infosec报道</em> </a> <em class="km">获取更多此类精彩报道。</em></p><div class="ot ou gp gr ov ow"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="ox ab fo"><div class="oy ab oz cl cj pa"><h2 class="bd ir gy z fp pb fr fs pc fu fw ip bi translated">信息安全报道</h2><div class="pd l"><h3 class="bd b gy z fp pb fr fs pc fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="pe l"><p class="bd b dl z fp pb fr fs pc fu fw dk translated">medium.com</p></div></div><div class="pf l"><div class="pg l ph pi pj pf pk nm ow"/></div></div></a></div></div></div>    
</body>
</html>