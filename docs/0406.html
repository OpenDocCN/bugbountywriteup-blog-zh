<html>
<head>
<title>Windows LNK File Analysis in Forensic System Reviews</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">取证系统评论中的Windows LNK文件分析</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/windows-lnk-file-analysis-in-forensic-it-reviews-75b3dfd49f36?source=collection_archive---------1-----------------------#2019-10-29">https://infosecwriteups.com/windows-lnk-file-analysis-in-forensic-it-reviews-75b3dfd49f36?source=collection_archive---------1-----------------------#2019-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5415" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近文件的概念用于描述用户最近访问的文件，在取证审查中，确定用户最近查看了哪些应用程序以及查看了哪些文档对于事件解决可能至关重要。在Windows操作系统中，在与用户帐户相关联的配置文件目录中的最近目录下，创建用户打开的文件的快捷方式文件。可以分析这些文件来确定用户最后访问了哪些文件。特别地，即使被用户删除或擦除的文件不能被访问，与它们相关联的快捷方式文件也可以被访问并检索关于它们的信息。</p><p id="f82c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">LNK扩展链接文件的存储位置因操作系统而异。这些文件:</p><p id="5b87" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows XP:</p><ul class=""><li id="2e93" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">\文档和设置\用户名\最近</li><li id="dc35" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">\文档和设置\用户名\应用程序数据\Microsoft\Office\Recent</li></ul><p id="33b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows Vista和Windows 7:</p><ul class=""><li id="b6c6" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">\用户\用户名\ AppData \漫游\Microsoft\Windows\Recent</li><li id="2d48" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">\用户\用户名\ AppData \漫游\Microsoft\Office\Recent</li></ul><p id="d628" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目录。UserName表示的变量是表示相关用户的用户名的变量。例如，对于名为IsmailTasdelen的用户，这些目录的确切表达式应该是\ Users \ Ismail tasdelen \ AppData \ Roaming \ Microsof \ Windows \ Recent。这些文件的创建时间表示用户曾经访问过文档的时间，最后更新时间表示最后一次访问文档的时间。例如，下面的屏幕截图显示了Windows 7系统中最近目录的一些内容。在这里，您可以通过查看“创建日期”和“修改日期”字段中的时间信息，找出第一个和最后一个文件被访问的时间。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/96236f16f9cece24724f6045c772d9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*YL_ZclCRYsJy1V-xQBzlGQ.png"/></div></div></figure><p id="a48f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">哪些数据存储在LNK文件中？</p><p id="985a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分析LNK文件时会获得以下信息:</p><ul class=""><li id="8dab" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">LNK文件指向的目标文件或目录的完整路径<br/>创建、修改和访问目标文件或目录的时间信息<br/>目标文件或目录的大小</li><li id="66fb" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">目标系统的NETBIOS名称和MAC地址</li><li id="c217" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">存储目标文件或目录的卷的序列号</li><li id="8a66" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">如果通过网络访问目标文件和目录，则为网络共享名称</li><li id="f111" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">目标文件或目录的属性(例如，“只读”、“隐藏”、“系统”)</li></ul><p id="9f84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows LNK分析实用程序(lp)</p><p id="e1a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在Windows系统中可以用来分析LNK文件的应用之一是http://tzworks.net/prototype_page.php?proto_id=11的<a class="ae ll" href="http://tzworks.net/prototype_page.php?proto_id=11" rel="noopener ugc nofollow" target="_blank">下载的LNK解析工具，可以免费下载使用。下面你可以找到这个应用的例子。</a></p><blockquote class="lm ln lo"><p id="c567" class="jn jo lp jp b jq jr js jt ju jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj kk ij bi translated">lp <filename> [-csv] <br/> dir C: \ Users \ *。lnk / b / s | lp [-csv] - &gt;如果要解析一个目录下的所有lnk文件时使用。<br/> dir "C: \文档和设置\ *。lnk" / b / s | lp [-csv] <br/> -csv =允许输出逗号分隔的值。</filename></p></blockquote><p id="72ed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">链接文件检查器</p><p id="04a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Lifer是开源软件，可以在Linux环境下使用，可以解析Windows LNK文件，并从http://code.google.com/p/lifer/downloads/list.<a class="ae ll" href="http://code.google.com/p/lifer/downloads/list." rel="noopener ugc nofollow" target="_blank">下载</a>下载源代码后，按照以下步骤编译安装。</p><ul class=""><li id="3213" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">制造</li><li id="cc22" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">sudo make安装</li><li id="09c9" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">使干净</li></ul><p id="4d26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该应用的示例性使用形式如下:</p><ul class=""><li id="1f0b" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">lifer -h -&gt;提取帮助选项。</li><li id="322b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">lifer linkfile.lnk -&gt;解析linkfile.lnk链接文件并打印结果</li><li id="3cde" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">lifer-s link file . lnk--&gt;类似于上面的命令，只提供短格式的信息。</li><li id="1a21" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">lifer -o tsv。/Links/&gt; links.tsv处理目录中的所有lnk文件，并生成tsv格式的输出。</li></ul><p id="6de9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows文件分析器</p><p id="aa96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Windows文件分析器是另一个应用程序，可以在图形界面的帮助下分析LNK扩展快捷方式文件，可以从<a class="ae ll" href="http://www.mitec.cz/wfa.html." rel="noopener ugc nofollow" target="_blank">http://www.mitec.cz/wfa.html.</a>下载</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="ff75" class="ma mb iq bd mc md me dn mf mg mh dp mi jy mj mk ml kc mm mn mo kg mp mq mr ms bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae ll" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>