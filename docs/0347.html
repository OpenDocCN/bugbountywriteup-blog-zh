<html>
<head>
<title>HackTheBox — FortuneWriteup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">黑客盒子——财富杂志</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/fortune-hackthebox-writeup-ded91435f91c?source=collection_archive---------0-----------------------#2019-08-03">https://infosecwriteups.com/fortune-hackthebox-writeup-ded91435f91c?source=collection_archive---------0-----------------------#2019-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8625" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">财富是一个很酷的盒子，在通往根的道路上的每一个阶段都包含着挑战。我将从下载一些证书文件开始，这些文件是我通过命令注入检索的。然后，我使用这些证书生成一个客户端证书，并从那里获取一个SSH密钥来登录到机器并安装一个nfsshare。对于权限提升，我将使用一种易受攻击的加密方法来滥用密码重用功能。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0015ab631b77e0f7ea9f851181e20c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J72saRwqPTu5emRT-CS-cA.png"/></div></div></figure><h1 id="3601" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">计数和侦察</h1><p id="f6a5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们从Nmap扫描开始。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mf"><img src="../Images/a6f58bdbf253dabb3ade1816d0df6428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LHwK6ed9bYxAE27kHBlbnw.png"/></div></div></figure><p id="3a5b" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">常用端口，<strong class="ll ir"> 22- SSH，80 — HTTP，443 — HTTPS </strong>是开放的。<br/>让我们先检查一下HTTP和HTTPS。</p><h1 id="7bde" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">80 — HTTP</h1><p id="59e4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以选择数据库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/cf21342184e321bd095950c0ba27ea40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hykz-b-sTAQ4ZTLMp5qV2Q.png"/></div></div></figure><p id="3334" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在选择第一个选项时，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/ae8c7fe307b5b41d1947d5e87c0886ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H7kHb5pGTbwUBBsK_0vgsQ.png"/></div></div></figure><p id="7418" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">选择其他选项会返回一些随机文本。现在让我们检查443 HTTPS港，之后再回来看这个。</p><h1 id="be62" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">443 — HTTPS</h1><p id="191a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">看来我们现在无法进入HTTPS港。找到相关信息后，我们会再讨论这个问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/aeab290bdd6479b88b67e4d1e6578c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NQQs9iOnQnkBS5D0DKSuiw.png"/></div></div></figure><h1 id="5a9d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">80 — HTTP</h1><p id="ccde" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们捕获主页上显示的选择数据库的请求。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/d71b7fa10a68fe8f224b937ea1740e5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHm-676FBxBvmP6g09fASQ.png"/></div></div></figure><p id="7120" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们有一个参数<code class="fe mm mn mo mp b">db</code>，它接收数据库名称并返回一些随机文本。<br/>如果我们在末尾添加一个<code class="fe mm mn mo mp b">;</code>并添加任何命令，瞧，我们就可以执行命令了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mq"><img src="../Images/ab07b8ed7f2d9655dbc66927055e3fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OWLR1Ei4g2Hu0NzheF7ycA.png"/></div></div></figure><p id="79d8" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我试着ping自己，我做到了。</p><blockquote class="mr ms mt"><p id="9678" class="lj lk mu ll b lm mg jr lo lp mh ju lr mv mi lu lv mw mj ly lz mx mk mc md me ij bi translated"><strong class="ll ir"><em class="iq">db =时运；平-C3 10 . 10 . 14 . 8</em>T10】</strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/e80acfa2b49181c84ff4e5fc468a54e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tejbFuoTSj5iC6d5jOVCwA.png"/></div></div></figure><p id="841f" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我试图得到一个反向外壳，但没有成功。我继续列举文件系统中有趣的文件。我们可以从<strong class="ll ir"> /home/bob </strong>泄露一堆证书。我们需要将证书转换为PKCS12，并且我们需要一个密钥来完成此操作。我们只有一个证书与一个密钥相关联(我们可以假设它，因为两者的名称(“中间”)是相同的)。</p><p id="3017" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">转换证书。使用OpenSSL的pem(不使用密码):</p><blockquote class="mr ms mt"><p id="1a3d" class="lj lk mu ll b lm mg jr lo lp mh ju lr mv mi lu lv mw mj ly lz mx mk mc md me ij bi translated"><strong class="ll ir">OpenSSL pkcs12-export-out fortune . p12-in intermediate . cert . PEM-in key intermediate . key . PEM</strong></p></blockquote><p id="ea04" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">然后在浏览器中导入证书并访问443 HTTPS端口</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ml"><img src="../Images/3c87c0abd910376cb42c17d86f02e3bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QCR_GHPujDJhM4joY4orZw.png"/></div></div></figure><h1 id="c885" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">443 — HTTPS</h1><div class="kg kh ki kj gt ab cb"><figure class="mz kk na nb nc nd ne paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/83b6791e003bae3d7524e81f51bd95f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*2fysTNdNZq1HyW_sK_B7jw.png"/></div></figure><figure class="mz kk na nb nc nd ne paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d0654fa7ee38d4a26fc318667588a273.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*8LgZOuwztBVMXUIaaTfD7Q.png"/></div></figure><figure class="mz kk na nb nc nd ne paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/fddbb324073e4710261cb472e204fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*t3Uqrcbx5jmvYX7Irx9BvA.png"/></div></figure></div><p id="c58d" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">使用SSH密钥登录到该机器。我尝试在所有三个用户上使用SSH密钥，并成功地使用了<code class="fe mm mn mo mp b">nfsuser</code>。也是authpf SSH访问。</p><blockquote class="nf"><p id="07f5" class="ng nh iq bd ni nj nk nl nm nn no me dk translated">authpf 实用程序是一个用于认证网关的用户shell。身份验证网关就像常规的网络网关(也称为路由器)，只是用户必须首先向它验证自己的身份，才能允许其流量通过。当用户的shell设置为<code class="fe mm mn mo mp b">/usr/sbin/authpf</code>并使用SSH登录时，authpf将对活动的<a class="ae np" href="https://man.openbsd.org/pf" rel="noopener ugc nofollow" target="_blank"> pf(4) </a>规则集进行必要的更改，以便用户的流量通过过滤器和/或使用NAT/重定向进行转换。一旦用户注销或他们的会话断开，authpf将删除为用户加载的任何规则，并终止用户打开的任何有状态连接。因此，只有当用户保持SSH会话打开时，用户才能通过网关传递流量</p></blockquote><h1 id="f74d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw nq jx ld jz nr ka lf kc ns kd lh li bi translated">SSH作为NFSUSER</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/c8afed3ab3e6d1116d515f4f6a76bda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qH-wS_ejxsqFdxEEsvEVPQ.png"/></div></div></figure><p id="7cd9" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们只得到这条消息，仅此而已。<br/>我被困在这里很长一段时间，但是用户名<code class="fe mm mn mo mp b">nfsuser </code>可以表明可能有一个用户在使用nfsshare。我很快尝试使用showmount检查挂载共享。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/57bbbda101c813d64ac0e682347f3d8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CHB2_Zd7PdTdkCEkprBqcw.png"/></div></div></figure><p id="d077" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">嗯，猜测是对的，我们确实有一些mount share。是时候安装一些nfsshares了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nv"><img src="../Images/338b786c74075ec972a8a98a0ac84893.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GIvkLKnXwuqdcSixKrsIMg.png"/></div></div></figure><p id="ea55" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">因为文件系统是本地挂载的，所以我们可以将我们的UUID ( <strong class="ll ir"> <em class="mu">伪装成uid </em> </strong>)更改为特定的用户，就像我们是那个用户一样访问文件。这里，只需添加一个用户，该用户与我们想要访问其文件的用户具有相同的<strong class="ll ir"> UID。</strong></p><h2 id="98ef" class="nw ks iq bd kt nx ny dn kx nz oa dp lb ls ob oc ld lw od oe lf ma of og lh oh bi translated">useradd-u<uid>T15】</uid></h2><h2 id="7aa1" class="nw ks iq bd kt nx ny dn kx nz oa dp lb ls ob oc ld lw od oe lf ma of og lh oh bi translated">useradd -u 1001查理</h2><h2 id="9979" class="nw ks iq bd kt nx ny dn kx nz oa dp lb ls ob oc ld lw od oe lf ma of og lh oh bi translated">然后做一个<code class="fe mm mn mo mp b">su charlie.</code></h2><p id="c977" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们将我们的公钥添加到authorized_keys文件中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/add73ca069301303d76201bb2036b804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*vT9k96ZXxA9OZ9KKkIh21Q.png"/></div></figure><h1 id="68f2" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">扮演查理</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/bdf18992b68c4cf4fee9aeacfce39cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XHsP7zIWHNmvYFaYzC2bqw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ok"><img src="../Images/c099cce16aa444d512732ae63e138fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2-C98E6zdblGXI47jjIyjA.png"/></div></div><figcaption class="ol om gj gh gi on oo bd b be z dk translated">来自鲍勃的有趣的邮件</figcaption></figure><h1 id="045d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">将Esc权限授予Root</h1><p id="813d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">因此，有密码重用的地方。<br/>四处寻找pgadmin的配置文件，最终找到了这个文件。</p><p id="fbd6" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><strong class="ll ir">(/var/app SRV/pgadmin 4/pgadmin4.db)</strong><br/>由于pgadmin 4 . db是一个数据库文件，所以我用一些在线工具打开了它。虽然，我们可以通过一个简单的字符串命令得到我们想要的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/ed3e14519c009ece296454c4fee8d29b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TbJGEGday0ixhGrS2k6hGA.png"/></div></div></figure><p id="2fad" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">在网上搜索破解这些哈希值无果而终，我发现PGADMIN是开源的(是啊)，并在他们自己的回购中发现了这个有趣的加密文件。</p><pre class="kg kh ki kj gt oq mp or os aw ot bi"><span id="304d" class="nw ks iq mp b gy ou ov l ow ox"><strong class="mp ir"><em class="mu">##########################################################################</em></strong><br/><strong class="mp ir"><em class="mu">#</em></strong><br/><strong class="mp ir"><em class="mu"># pgAdmin 4 - PostgreSQL Tools</em></strong><br/><strong class="mp ir"><em class="mu">#</em></strong><br/><strong class="mp ir"><em class="mu"># Copyright (C) 2013 - 2019, The pgAdmin Development Team</em></strong><br/><strong class="mp ir"><em class="mu"># This software is released under the PostgreSQL Licence</em></strong><br/><strong class="mp ir"><em class="mu">#</em></strong><br/><strong class="mp ir"><em class="mu">#########################################################################</em></strong><br/><br/><strong class="mp ir">"""This File Provides Cryptography."""</strong><br/><br/><strong class="mp ir">from</strong> <strong class="mp ir"><em class="mu">__future__</em></strong> <strong class="mp ir">import</strong> division<br/><br/><strong class="mp ir">import</strong> <strong class="mp ir"><em class="mu">base64</em></strong><br/><strong class="mp ir">import</strong> <strong class="mp ir"><em class="mu">hashlib</em></strong><br/><strong class="mp ir">import</strong> <strong class="mp ir"><em class="mu">os</em></strong><br/><br/><strong class="mp ir">import</strong> <strong class="mp ir"><em class="mu">six</em></strong><br/><br/><strong class="mp ir">from</strong> <strong class="mp ir"><em class="mu">cryptography.hazmat.backends</em></strong> <strong class="mp ir">import</strong> default_backend<br/><strong class="mp ir">from</strong> <strong class="mp ir"><em class="mu">cryptography.hazmat.primitives.ciphers</em></strong> <strong class="mp ir">import</strong> Cipher<br/><strong class="mp ir">from</strong> <strong class="mp ir"><em class="mu">cryptography.hazmat.primitives.ciphers.algorithms</em></strong> <strong class="mp ir">import</strong> AES<br/><strong class="mp ir">from</strong> <strong class="mp ir"><em class="mu">cryptography.hazmat.primitives.ciphers.modes</em></strong> <strong class="mp ir">import</strong> CFB8<br/><br/>padding_string <strong class="mp ir">=</strong> b'}'<br/>iv_size <strong class="mp ir">=</strong> AES<strong class="mp ir">.</strong>block_size <strong class="mp ir">//</strong> 8<br/><br/><br/><strong class="mp ir">def</strong> <strong class="mp ir">decrypt</strong>(ciphertext, key):<br/>    <strong class="mp ir">"""<br/>    Decrypt the AES encrypted string.<br/><br/>    Parameters:<br/>        ciphertext -- Encrypted string with AES method.<br/>        key        -- key to decrypt the encrypted string.<br/>    """</strong><br/><br/>    ciphertext <strong class="mp ir">=</strong> base64<strong class="mp ir">.</strong>b64decode(ciphertext)<br/>    iv <strong class="mp ir">=</strong> ciphertext[:iv_size]<br/><br/>    cipher <strong class="mp ir">=</strong> Cipher(AES(pad(key)), CFB8(iv), default_backend())<br/>    decryptor <strong class="mp ir">=</strong> cipher<strong class="mp ir">.</strong>decryptor()<br/>    <strong class="mp ir">return</strong> decryptor<strong class="mp ir">.</strong>update(ciphertext[iv_size:]) <strong class="mp ir">+</strong> decryptor<strong class="mp ir">.</strong>finalize()<br/><br/><br/><strong class="mp ir">def</strong> <strong class="mp ir">pad</strong>(key):<br/>    <strong class="mp ir">"""Add padding to the key."""</strong><br/><br/>    <strong class="mp ir">if</strong> <strong class="mp ir">isinstance</strong>(key, six<strong class="mp ir">.</strong>text_type):<br/>        key <strong class="mp ir">=</strong> key<strong class="mp ir">.</strong>encode()<br/><br/>    <strong class="mp ir"><em class="mu"># Key must be maximum 32 bytes long, so take first 32 bytes</em></strong><br/>    key <strong class="mp ir">=</strong> key[:32]<br/><br/>    <strong class="mp ir"><em class="mu"># If key size is 16, 24 or 32 bytes then padding is not required</em></strong><br/>    <strong class="mp ir">if</strong> <strong class="mp ir">len</strong>(key) <strong class="mp ir">in</strong> (16, 24, 32):<br/>        <strong class="mp ir">return</strong> key<br/><br/>    <strong class="mp ir"><em class="mu"># Add padding to make key 32 bytes long</em></strong><br/>    <strong class="mp ir">return</strong> key<strong class="mp ir">.</strong>ljust(32, padding_string)</span></pre><p id="1792" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">我们可以使用“decrypt”方法来解密dba的密码，该密码是使用Bob的AES加密密钥加密的。我花了很长时间才发现。</p><blockquote class="mr ms mt"><p id="8ba7" class="lj lk mu ll b lm mg jr lo lp mh ju lr mv mi lu lv mw mj ly lz mx mk mc md me ij bi translated">将此行添加到文件<br/><strong class="ll ir"><em class="iq">print(decrypt(" utu 0 jkamczdmqfloraupjfxl 0 ZP 8 zwzise 5mf 0 gy/l 8 silrmu 3 caqrtjavjlvffegesgz "，" $ pbk df 2-sha 512 $ 25000 $ z 9 nbm 1 OQ 9 z 5 tytkbq 8 H5 dw $ vtx 9 ywqsgwdxpbnsa 8 bto 5 klodqgflizoqysay 7 jdtvcrbv/6 cs</em></strong></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oy"><img src="../Images/ce627026a77689cc0ecee5da70ae2606.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cO4LbBdBAPP4EhoOoqR-OQ.png"/></div></div></figure><p id="2778" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated">搞定，扎根！下次见。</p><h1 id="d9af" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">额外的</h1><p id="a5a3" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">这是易受命令注入攻击的源代码。<br/> <code class="fe mm mn mo mp b"><strong class="ll ir">@app.route('/select', methods=['POST'])<br/>def fortuned():</strong></code></p><p id="98d9" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><code class="fe mm mn mo mp b"><strong class="ll ir">cmd = '/usr/games/fortune '<br/> dbs = ['fortunes', 'fortunes2', 'recipes', 'startrek', 'zippy']<br/> selection = request.form['db']<br/> shell_cmd = cmd + selection<br/> result = os.popen<em class="mu">(shell_cmd).read()<br/> return render_template('display.html', output=result</em>)</strong></code></p></div><div class="ab cl oz pa hu pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="ij ik il im in"><p id="1777" class="pw-post-body-paragraph lj lk iq ll b lm mg jr lo lp mh ju lr ls mi lu lv lw mj ly lz ma mk mc md me ij bi translated"><em class="mu">关注</em> <a class="ae np" href="https://medium.com/bugbountywriteup" rel="noopener"> <em class="mu"> Infosec报道</em> </a> <em class="mu">获取更多此类精彩报道。</em></p><div class="pg ph gp gr pi pj"><a href="https://medium.com/bugbountywriteup" rel="noopener follow" target="_blank"><div class="pk ab fo"><div class="pl ab pm cl cj pn"><h2 class="bd ir gy z fp po fr fs pp fu fw ip bi translated">信息安全报道</h2><div class="pq l"><h3 class="bd b gy z fp po fr fs pp fu fw dk translated">收集了世界上最好的黑客的文章，主题从bug奖金和CTF到vulnhub…</h3></div><div class="pr l"><p class="bd b dl z fp po fr fs pp fu fw dk translated">medium.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px kp pj"/></div></div></a></div></div></div>    
</body>
</html>