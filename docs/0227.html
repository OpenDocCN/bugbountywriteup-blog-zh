<html>
<head>
<title>From Responder to NT Authority\SYSTEM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从响应者到NT授权\系统</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/from-responder-to-nt-authority-system-39abd3593319?source=collection_archive---------1-----------------------#2019-01-03">https://infosecwriteups.com/from-responder-to-nt-authority-system-39abd3593319?source=collection_archive---------1-----------------------#2019-01-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="2984" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">你好，我叫梅里迪安·米夫塔里。我今年21岁(安全研究员)，来自科索沃。在这篇文章中，我将谈论或描述一种在网络中使用响应者&amp; SMB攻击工具的攻击方法</p><p id="ca7d" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我将描述的这种攻击实际上被称为中间人攻击(MITM)，这种攻击面对的是为什么将无线设备的密码告诉他人是危险的想法。</p><p id="75e3" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这个网络笔测试是在一家私人电信公司的授权环境下进行的，为了保密，我不允许提及客户的名字！</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/6380daa6060ab30cf20cc151e4429af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hhf7d3EgPezLMgG0_71jXg.png"/></div></div></figure><blockquote class="jn jo jp"><p id="365f" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在这里，我将简要介绍这个工具的特性，以及我们将会用到的特性。</p><p id="7f56" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">Responder是红队使用的一种攻击性安全工具，正如我们提到的，它更多的是一种中间人攻击，它与拦截网络中2个或更多系统之间的通信有关。<br/> <br/> <strong class="jt ir">工具的一些特性</strong></p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/3e14c88edc5569a3e145c0c588124f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ti7sm1ChSNXAUUJv-5ZyQ.png"/></div></div></figure><blockquote class="jn jo jp"><p id="3fa2" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在启动过程中，这是该工具的外观，我已经在wlan0界面中执行了，下面我们可以看到该工具的内置服务器</p><p id="a1eb" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">-中小企业</p><p id="3144" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">- HTTP</p><p id="d405" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">- MySQL</p><p id="7644" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">- Kerberos等。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/b8eef0c11e2a74dcd5ef765cb3ac47ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-QS4s1aLiTXA-4_e6KAqA.png"/></div></div></figure><blockquote class="jn jo jp"><p id="71df" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">因此，在执行该工具后，我们看到它在该网络内的每台计算机上发送请求，最后我们看到目标用他的用户名和NTLMv2哈希来响应我们</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/0f5f7a6efbe3643cd31d996aff835ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zQhUkdECcOVtH21omv8a7w.png"/></div></div></figure><blockquote class="jn jo jp"><p id="3566" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在我们捕获NTLMv2哈希并在John the Ripper的帮助下解密后，John the Ripper是一个非常著名的密码破解程序，解密过程取决于系统所拥有的密码的复杂性。<br/>破解过程结束后，我们可以在图片中看到解密后的密码！</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lb"><img src="../Images/01d51ddb27e6a0a5eea5c6d62c310df7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mhfjcuFn10Yc8uXxIuJDw.png"/></div></div></figure><blockquote class="jn jo jp"><p id="5169" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">在破解过程之后，我们将使用Impacket包。Impacket是专门用于网络协议的Python类的集合，其中之一是smbclient.py</p><p id="f93f" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我们将使用从开膛手约翰那里得到的用户名和密码登录系统的磁盘共享，如图所示。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lc"><img src="../Images/6a5c6c3a279d6b78f9d5b1508d4ccc1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NGWmkCdUXekcCkpp41VRdw.png"/></div></div></figure><blockquote class="jn jo jp"><p id="16bf" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">我们尝试访问系统的管理员共享，但是出现错误:访问被拒绝。这意味着我们限制了对它们的访问。！</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ld"><img src="../Images/b36456f8b766818aab5e9221743ac94d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2la1udXtAuO-N4jBYXSmMw.png"/></div></div></figure><blockquote class="jn jo jp"><p id="79b8" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">此外，我们将2个其他脚本，这是我们前面提到的Impacket包的一部分。<br/>RPC client . py&amp;getuserspns . py</p><p id="6e36" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">Rpcclient.py:这个脚本默认安装在Kali Linux中，我们将使用系统的用户名和密码来枚举域。</p><p id="b5d7" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">GetUserSPNs.py:这个脚本将尝试查找和获取与普通用户帐户相关联的服务主体名称。</p><p id="9fff" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">(SPN)是中服务实例的唯一标识符，由Kerberos身份验证用来将<strong class="jt ir">服务</strong>实例与<strong class="jt ir">服务</strong>登录帐户相关联，并且它们持有一个TGT(票证授予票证),这是一个具有有限有效期的小型加密标识文件。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi le"><img src="../Images/954cd10f8f421693d9d56967f9a0297c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fZPX4TCKCiw-koOJAg5Zig.png"/></div></div></figure><blockquote class="jn jo jp"><p id="3a3c" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">得到有效的TGT后，我们使用Hashcat进行解密，Hashcat也是一个非常著名的密码破解工具。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lf"><img src="../Images/4bf64012f1a5ddc9fac1192640298e44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucv3l8y3SHPBCJy6XFUAPg.png"/></div></div></figure><blockquote class="jn jo jp"><p id="ec8a" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">最后，当我们得到管理员的密码后，我们就可以登录了，我们的权限从简单用户升级到NT权限\系统</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lc"><img src="../Images/ebfe69d3639954c729b3d21dc94c57d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*696ASVA1MhIXHt2b_m4xzw.png"/></div></div></figure><blockquote class="jn jo jp"><p id="e00e" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">图片中描述了防范这种攻击的方法。</p></blockquote><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lc"><img src="../Images/3d61505874ad53e4a898ba6521fba4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*id90VZA8D3kdXFELeEZlRQ.png"/></div></div></figure><p id="0f89" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">//希望你在阅读这篇文章的过程中过得愉快，并学到新的东西<br/>//非常感谢。</p><p id="7cd7" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb lg kd ke kf lh kh ki kj li kl km kn ko ij bi translated">工具:</p><div class="lj lk gp gr ll lm"><a href="https://github.com/SpiderLabs/Responder" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">蜘蛛实验室/响应者</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">Responder是LLMNR，NBT-NS和MDNS投毒者，内置HTTP/SMB/MSSQL/FTP/LDAP流氓认证服务器…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">github.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma kz lm"/></div></div></a></div><div class="lj lk gp gr ll lm"><a href="https://github.com/SecureAuthCorp/impacket" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">SecureAuthCorp/impacket</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">Impacket是用于处理网络协议的Python类的集合。- SecureAuthCorp/impacket</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">github.com</p></div></div><div class="lv l"><div class="mb l lx ly lz lv ma kz lm"/></div></div></a></div><div class="lj lk gp gr ll lm"><a href="https://github.com/hashcat" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">哈希卡特</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">hashcat有7个可用的存储库。在GitHub上关注他们的代码。</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">github.com</p></div></div><div class="lv l"><div class="mc l lx ly lz lv ma kz lm"/></div></div></a></div></div></div>    
</body>
</html>