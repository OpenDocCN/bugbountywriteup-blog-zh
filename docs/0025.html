<html>
<head>
<title>IP Address Disclosure Vulnerability in linkedin.com</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">linkedin.com的IP地址泄露漏洞</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/ip-address-disclosure-vulnerability-in-linkedin-com-5830fb7476b9?source=collection_archive---------2-----------------------#2017-11-07">https://infosecwriteups.com/ip-address-disclosure-vulnerability-in-linkedin-com-5830fb7476b9?source=collection_archive---------2-----------------------#2017-11-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/2fce19dd8f44b6138a7033afd2582a5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/0*T5S_MmkhVQ6ikSEd.jpg"/></div></figure><h1 id="73fd" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">摘要</h1><p id="e25e" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">该漏洞会导致IP泄漏，从而执行有害操作，例如通过使用Metasploit框架接管用户的机器。</p><h1 id="107d" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">复制步骤</h1><p id="b072" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><strong class="ku ir">第一步:</strong></p><ul class=""><li id="aee1" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">用你的用户名替换<code class="fe mb mc md me b">{user-name}</code>，然后点击<code class="fe mb mc md me b"><a class="ae mf" href="https://www.linkedin.com/in/{user-name}/edit/topcard/." rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/{user-name}/edit/topcard</a>.</code></li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mg"><img src="../Images/bacf92eed4347fc115afab67a3cac765.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*dTXqagEcIQVTG9bp.png"/></div></div></figure><p id="721e" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ij bi translated"><strong class="ku ir">第二步:</strong></p><ul class=""><li id="a82d" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">转到媒体部分，然后添加链接。<br/>当<code class="fe mb mc md me b">com.linkedin.voyager.feed.urlpreview.PreviewImage</code>无法获得预览图片时，将使用我们的链接作为<code class="fe mb mc md me b">preview-image</code>在这种情况下，你应该避免元标签中的任何图片链接。</li><li id="0799" class="lq lr iq ku b kv ms kz mt ld mu lh mv ll mw lp lx ly lz ma bi translated">Linkedin网址预览端点<br/> <code class="fe mb mc md me b">https://www.linkedin.com/voyager/api/feed/urlpreview/{URL}</code></li></ul></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="8b5e" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ij bi translated"><strong class="ku ir">例如:</strong></p><p id="f947" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ij bi translated"><strong class="ku ir">添加</strong> <code class="fe mb mc md me b"><strong class="ku ir">https://a738b3cb.ngrok.io/user</strong></code> <strong class="ku ir">时，我们得到:</strong></p><ul class=""><li id="d53a" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">反应</li></ul><pre class="mh mi mj mk gt ne me nf ng aw nh bi"><span id="be2c" class="ni jv iq me b gy nj nk l nl nm">{  <br/>   <strong class="me ir">"data"</strong>:{  <br/>      <strong class="me ir">"$deletedFields"</strong>:[  </span><span id="f3f5" class="ni jv iq me b gy nn nk l nl nm">      ],<br/>      <strong class="me ir">"value"</strong>:{  <br/>         <strong class="me ir">"com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful"</strong>:"0ZVEtnT7kRtbMZxlzyoLnQ==,root,value,com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful"<br/>      },<br/>      <strong class="me ir">"$type"</strong>:"com.linkedin.voyager.feed.urlpreview.UrlPreviewResponse",<br/>      <strong class="me ir">"$id"</strong>:"0ZVEtnT7kRtbMZxlzyoLnQ==,root"<br/>   },<br/>   <strong class="me ir">"included"</strong>:[  <br/>      {  <br/>         <strong class="me ir">"$deletedFields"</strong>:[  </span><span id="eea4" class="ni jv iq me b gy nn nk l nl nm">         ],<br/>         <strong class="me ir">"data"</strong>:"0ZVEtnT7kRtbMZxlzyoLnQ==,root,value,com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful,data",<br/>         <strong class="me ir">"$type"</strong>:"com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful",<br/>         <strong class="me ir">"$id"</strong>:"0ZVEtnT7kRtbMZxlzyoLnQ==,root,value,com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful"<br/>      },<br/>      {  <br/>         <strong class="me ir">"urn"</strong>:"urn:li:article:7726755832606755082",<br/>         <strong class="me ir">"previewImages"</strong>:[  </span><span id="e148" class="ni jv iq me b gy nn nk l nl nm">         ],<br/>         <strong class="me ir">"$deletedFields"</strong>:[  <br/>            "description",<br/>            "update"<br/>         ],<br/>         <strong class="me ir">"resolvedUrl"</strong>:"https://a738b3cb.ngrok.io/user",<br/>         <strong class="me ir">"source"</strong>:"a738b3cb.ngrok.io",<br/>         <strong class="me ir">"id"</strong>:"urn:li:article:7726755832606755082",<br/>         <strong class="me ir">"type"</strong>:"com.linkedin.voyager.feed.urlpreview.UrlPreviewResponse",<br/>         <strong class="me ir">"title"</strong>:"The Rock",<br/>         <strong class="me ir">"url"</strong>:"https://a738b3cb.ngrok.io/user",<br/>         <strong class="me ir">"$type"</strong>:"com.linkedin.voyager.feed.urlpreview.UrlPreviewData",<br/>         <strong class="me ir">"$id"</strong>:"0ZVEtnT7kRtbMZxlzyoLnQ==,root,value,com.linkedin.voyager.feed.urlpreview.PreviewCreationSuccessful,data"<br/>      }<br/>   ]<br/>}</span></pre><ul class=""><li id="3605" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">如果响应上的<code class="fe mb mc md me b">previewImages</code>键是空数组，<code class="fe mb mc md me b">com.linkedin.voyager.feed.urlpreview.PreviewImage</code>将使用<code class="fe mb mc md me b">resolvedUrl</code>作为预览图像。</li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi no"><img src="../Images/5ec1400e80cf194f3bf64fbae60c9f84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4ktbfBeb0DhuORo-.png"/></div></div></figure><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi no"><img src="../Images/0bfbd026557bbbbd8436566f37a445a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ia-2BVTL_2Ihzt3d.png"/></div></div></figure><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi np"><img src="../Images/936ddca36f94f961f51e1bb48c209892.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CoqDG4MX6uA4NbV3.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">当用户访问个人资料并点击<strong class="bd jw">查看更多</strong>时，预览图像将直接在后台加载。</figcaption></figure><ul class=""><li id="f008" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">我为request header添加了一个名为<code class="fe mb mc md me b">User-Message</code>(错误地输入了<code class="fe mb mc md me b"><em class="nu">yser-Message</em></code>)的新header标签。</li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi np"><img src="../Images/8fb53c25631e24bc9b9e1d1f5998ccd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*htBpMxyFBiuh2JLq.png"/></div></div></figure><ul class=""><li id="b4b9" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">我可能会在日志中获得包含其内容的header标记。</li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi no"><img src="../Images/2ff1e178b8328cec4a6cf4bea4d0b6e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EcZgImiVA9GyxAm6.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk translated">我们得到了旗帜:P</figcaption></figure><h1 id="69c0" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">攻击脚本/工具</h1><p id="57c0" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">是用Node.js写的<a class="ae mf" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> express.js </a>应用。</p><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/4ccf58f7fb4b50d7f5a99a4b25d79383.png" data-original-src="https://miro.medium.com/v2/resize:fit:710/0*fjeAL5wFyTWRSgDv."/></div></figure><ul class=""><li id="8b4d" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">我们需要检查<code class="fe mb mc md me b">accept</code>和<code class="fe mb mc md me b">referer</code>标题标签，以检测请求是否来自<code class="fe mb mc md me b">linkedin.com</code></li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nw"><img src="../Images/fa20385895d226592c23253408683228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rTtsAKGuAVf88X9Z."/></div></div></figure><ul class=""><li id="6f42" class="lq lr iq ku b kv ls kz lt ld lu lh lv ll lw lp lx ly lz ma bi translated">如果<code class="fe mb mc md me b">accept</code> &amp; <code class="fe mb mc md me b">referer</code>匹配，则流式传输图像并将该请求有效载荷存储在<code class="fe mb mc md me b">log.json</code>中</li><li id="95b6" class="lq lr iq ku b kv ms kz mt ld mu lh mv ll mw lp lx ly lz ma bi translated">除非发送一个没有任何用于图像的元标签的html页面</li></ul><figure class="mh mi mj mk gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nx"><img src="../Images/f6240e54a2547512f330ad9bff91f4c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oOMqvkjr6ahmRVGH."/></div></div></figure><p id="76eb" class="pw-post-body-paragraph ks kt iq ku b kv ls kx ky kz lt lb lc ld mp lf lg lh mq lj lk ll mr ln lo lp ij bi translated">在我的github <a class="ae mf" href="https://github.com/xc0d3rz/IP-Address-Disclosure-Vulnerability-in-linkedin.com" rel="noopener ugc nofollow" target="_blank"> repo </a>上查看完整代码</p><h1 id="b306" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">可开发性</h1><p id="3bb1" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">由于攻击者的配置文件是公开可访问的，因此该漏洞可能会影响给定域中的所有用户，因为如果攻击者的配置文件被平台上的任何其他用户查看，该漏洞也是公开可见的。此外，这可用于对受害者(或访问该页面的任何用户)执行操作，并可能导致远程控制用户的机器。这可能是因为用户自己导航到攻击者的配置文件，或者攻击者以某种方式诱使受害者导航到该配置文件。</p><h1 id="83b0" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">影响</h1><p id="71cf" class="pw-post-body-paragraph ks kt iq ku b kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">接管用户的机器将允许攻击者执行有害的操作。<br/> <a class="ae mf" href="https://null-byte.wonderhowto.com/how-to/hack-like-pro-exploit-and-gain-remote-access-pcs-running-windows-xp-0134709/" rel="noopener ugc nofollow" target="_blank">一个关于如何用metasploit </a>瞄准公共IP的大话题。</p><h1 id="fb2b" class="ju jv iq bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr bi translated">概念证明</h1><figure class="mh mi mj mk gt jr"><div class="bz fp l di"><div class="ny nz l"/></div></figure></div></div>    
</body>
</html>