<html>
<head>
<title>Advent of Cyber 2022 [Day 20] Firmware | Binwalkin’ around the Christmas tree-Simple Write up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Cyber 2022[第20天]固件的出现| binwalking ' around the tree-Simple Write up</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/advent-of-cyber-2022-day-20-firmware-binwalkin-around-the-christmas-tree-simple-write-up-345f9525d20c?source=collection_archive---------1-----------------------#2022-12-20">https://infosecwriteups.com/advent-of-cyber-2022-day-20-firmware-binwalkin-around-the-christmas-tree-simple-write-up-345f9525d20c?source=collection_archive---------1-----------------------#2022-12-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1226" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">任务25-固件|在圣诞树周围漫步-赛博2022的来临[第20天]-答案撰写和演练</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/40f616007205d4c869c532795d7df479.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IDWxu5mshcJi8Mj8snTZ3Q.png"/></div></div></figure><blockquote class="kr ks kt"><p id="bef3" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="iq">什么是固件逆向工程？</em> </strong></p><p id="bd49" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq">各种嵌入式系统，如摄像头、路由器、智能手表等。预装了固件，该固件在硬件处理器上运行自己的指令集。</em></p><p id="83f7" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq">它使</em> <strong class="kx ir"> <em class="iq">硬件能够与设备</em> </strong> <em class="iq">上运行的其他软件进行通信。固件为设计者/开发者提供了在根级别进行改变的低级控制。</em></p></blockquote><p id="add4" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated"><strong class="kx ir">固件反转步骤</strong></p><ul class=""><li id="76e0" class="lu lv iq kx b ky kz lb lc lr lw ls lx lt ly lq lz ma mb mc bi translated">固件首先从供应商的网站获得，或者从设备中提取以执行分析。</li><li id="e3a4" class="lu lv iq kx b ky md lb me lr mf ls mg lt mh lq lz ma mb mc bi translated">首先分析获得/提取的固件(通常是二进制文件)以确定其类型(裸机或基于操作系统)。</li><li id="2492" class="lu lv iq kx b ky md lb me lr mf ls mg lt mh lq lz ma mb mc bi translated">验证固件是加密的还是打包的。加密固件的分析更具挑战性，因为它通常需要一个棘手的解决方案，例如逆转以前的非加密固件版本或执行硬件攻击，如<a class="ae mi" href="https://en.wikipedia.org/wiki/Side-channel_attack" rel="noopener ugc nofollow" target="_blank">侧信道攻击(SCA) </a>来获取加密密钥。</li><li id="be00" class="lu lv iq kx b ky md lb me lr mf ls mg lt mh lq lz ma mb mc bi translated">一旦加密的固件被解密，不同的技术和工具被用于执行基于类型的逆向工程。</li></ul><blockquote class="kr ks kt"><p id="f0e9" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae mi" href="https://github.com/ReFirmLabs/binwalk" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="iq">BinWalk</em></strong></a><strong class="kx ir"><em class="iq">:</em></strong><em class="iq">一款固件提取工具，通过针对</em> <code class="fe mj mk ml mm b"><em class="iq">zip, tar, exe, ELF,</em></code> <em class="iq">等多种标准二进制文件格式搜索签名，提取任意二进制文件中的代码片段。</em></p><p id="acc9" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq"> Binwalk有一个二进制标头签名数据库，根据该数据库执行签名匹配。</em></p><p id="cb80" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq">使用该工具的共同目的是提取一个文件系统，如</em> <code class="fe mj mk ml mm b"><em class="iq">Squashfs, yaffs2, Cramfs, ext*fs, jffs2,</em></code> <em class="iq">等。，它嵌入在固件二进制文件中。文件系统拥有将在设备上运行的所有应用程序代码。</em></p></blockquote><p id="c872" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated"><strong class="kx ir">打开机器的分割视图</strong></p><h1 id="52e1" class="mn mo iq bd mp mq mr ms mt mu mv mw mx jw my jx mz jz na ka nb kc nc kd nd ne bi translated">任务25【第20天】<strong class="ak">固件</strong>宾绕着圣诞树走</h1><h2 id="34ca" class="nf mo iq bd mp ng nh dn mt ni nj dp mx lr nk nl mz ls nm nn nb lt no np nd nq bi translated">1.文件firmware 2.2-encrypted . gpg反转后的标志值是多少？</h2><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="a1b4" class="nv mo iq mm b be nw nx l ny nz">cd bin<br/>binwalk -E -N firmwarev2.2-encrypted.gpg </span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/4b93e0b5dac3403fcfcf01a50149bfca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*413Yflq40DBYmWbeHH8Rlg.png"/></div></figure><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="e2a6" class="nv mo iq mm b be nw nx l ny nz">cd ..<br/>cd bin-unsigned/<br/>extract-firmware.sh firmwarev1.0-unsigned</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/dd09aaa985215ffd2df8414851dfb943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*veYwRHLY2eJOCwfK9J1WJg.png"/></div></div></figure><blockquote class="kr ks kt"><p id="847a" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq">密码:Santa1010 </em></p></blockquote><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/34f8db7a8d1a036f9a96e1063be45bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*lI_D1FaSLCBtb8UwyxebfQ.png"/></div></figure><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="2164" class="nv mo iq mm b be nw nx l ny nz">grep -ir paraphrase<br/>cat fmk/rootfs/gpg/secret.txt</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/b79654efb3d7d33b74685a907d28062b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*9RuJpoKlkdUsnwGkWIrQkQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/a7c6c3d4a62b1259d1baa9bf755e313f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CUQZQ7_Mxcu89ypk5FQq9Q.png"/></div></div></figure><blockquote class="kr ks kt"><p id="b67f" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="iq">释义:圣诞老人@2022 </em></p></blockquote><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="ce09" class="nv mo iq mm b be nw nx l ny nz">gpg — import fmk/rootfs/gpg/private.key</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/5babb77042c2cf19d08cdcbcb5c33f99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fFrkqdd6wSTj-TxmfufVGQ.png"/></div></div></figure><p id="375b" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated">键入我们找到的<strong class="kx ir">释义</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi of"><img src="../Images/50119439ddca3db20dcfe9c83bc92373.png" data-original-src="https://miro.medium.com/v2/resize:fit:1310/format:webp/1*mYU9jyZwMfd4VRakSAE4ZA.png"/></div></figure><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="a0c3" class="nv mo iq mm b be nw nx l ny nz">gpg --import fmk/rootfs/gpg/public.key <br/>gpg --list-secret-keys</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/df2144a6fc04bd04b4af2c81d66194e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIHdK73hjep3S5SOGo6cIw.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi og"><img src="../Images/016b22cbb3b90415a6ff5da06d1a84b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*tN6vqKo-AOPZc1ykXuApyQ.png"/></div></figure><p id="3eba" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated">一旦密钥被导入，McSkidy使用gpg命令解密固件。再次通过输入命令<strong class="kx ir"> cd更改目录..</strong>然后是<strong class="kx ir"> cd仓</strong></p><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="bb7f" class="nv mo iq mm b be nw nx l ny nz">cd ..<br/>cd bin<br/>gpg firmwarev2.2-encrypted.gpg<br/>cat ~/bin/fmk/rootfs/flag.txt </span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/afae1b5dbff2154fc39a6c7441292ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ybvz6dvnCk84iJZEgqURKQ.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/ea6c4244c713a4bd1c0fa8c5227289f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czAjuzCi5ySTMREVmmFC0A.png"/></div></div></figure><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="8277" class="nv mo iq mm b be nw nx l ny nz">Ans: THM{WE_GOT_THE_FIRMWARE_CODE}</span></pre><h2 id="ace7" class="nf mo iq bd mp ng nh dn mt ni nj dp mx lr nk nl mz ls nm nn nb lt no np nd nq bi translated">2.二进制固件1.0版_unsigned的释义值是多少？</h2><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="ecdd" class="nv mo iq mm b be nw nx l ny nz">Ans: Santa@2022</span></pre><h2 id="f70f" class="nf mo iq bd mp ng nh dn mt ni nj dp mx lr nk nl mz ls nm nn nb lt no np nd nq bi translated">3.逆向加密固件后，能找到<strong class="ak"> rootfs </strong>的内部版本号吗？</h2><p id="5de1" class="pw-post-body-paragraph ku kv iq kx b ky oj jr la lb ok ju ld lr ol lg lh ls om lk ll lt on lo lp lq ij bi translated">使用下面的命令查找rootfs的固件</p><blockquote class="kr ks kt"><p id="ad76" class="ku kv kw kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="iq">确认一下，你在rootfs目录下</em> </strong></p></blockquote><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="f569" class="nv mo iq mm b be nw nx l ny nz">ls -lah * | grep rootfs</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/4df2a54a29009eb98c4809f25bd4ee89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fNGQfOBBUIcoaj6FP3uIEA.png"/></div></div></figure><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="3f5a" class="nv mo iq mm b be nw nx l ny nz">Ans: 2.6.31</span></pre></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><p id="2757" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated">感谢您的阅读！！</p><p id="55be" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated">黑客快乐~</p><pre class="kg kh ki kj gt nr mm ns bn nt nu bi"><span id="f5f8" class="nv mo iq mm b be nw nx l ny nz">Author : Karthikeyan Nagaraj ~ Cyberw1ng</span></pre><p id="e958" class="pw-post-body-paragraph ku kv iq kx b ky kz jr la lb lc ju ld lr lf lg lh ls lj lk ll lt ln lo lp lq ij bi translated">THM，TryHackMe，TryHackMe 2022年网络时代的到来，TryHackMe 2022年网络时代的到来第20天，道德黑客，写，走过，TryHackMe 2022年网络时代的到来第20天答案</p></div><div class="ab cl op oq hu or" role="separator"><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou ov"/><span class="os bw bk ot ou"/></div><div class="ij ik il im in"><h2 id="36b9" class="nf mo iq bd mp ng nh dn mt ni nj dp mx lr nk nl mz ls nm nn nb lt no np nd nq bi translated">来自Infosec的报道:Infosec每天都有很多内容，很难跟上。<a class="ae mi" href="https://weekly.infosecwriteups.com/" rel="noopener ugc nofollow" target="_blank">加入我们的每周简讯</a>以5篇文章、4个线程、3个视频、2个GitHub Repos和工具以及1个工作提醒的形式免费获取所有最新的Infosec趋势！</h2></div></div>    
</body>
</html>