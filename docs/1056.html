<html>
<head>
<title>Writeup to the Brixel winter capture the flag</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">写给Brixel winter capture the flag</h1>
<blockquote>原文：<a href="https://infosecwriteups.com/writeup-to-the-brixel-winter-capture-the-flag-a1c5062ddfb6?source=collection_archive---------1-----------------------#2021-01-07">https://infosecwriteups.com/writeup-to-the-brixel-winter-capture-the-flag-a1c5062ddfb6?source=collection_archive---------1-----------------------#2021-01-07</a></blockquote><div><div class="fc ii ij ik il im"/><div class="in io ip iq ir"><div class=""/><figure class="gm go js jt ju jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj jr"><img src="../Images/a626108b6598d3603d4993dea745567b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*B4tjp2NtpmK_Xp_uhkqBNA.png"/></div></div></figure><h1 id="2911" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">目录一览</h1><ol class=""><li id="5807" class="la lb iu lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</li><li id="f2ec" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">dem挑战</li><li id="4878" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">光荣的提及</li><li id="83e1" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">最后的想法</li><li id="4b2d" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">承认</li><li id="4ac9" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">尾注</li></ol><h1 id="bb32" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">介绍</h1><p id="ad51" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">圣诞节后，Brixel冬季捕捉国旗(2020年版。)开始了。在这个CTF中，参赛者面临59个不同的挑战，分为9个类别:密码学、互联网、速记、OSINT、辩论学、编程、逆向工程或破解以及旧技术。</p><p id="d846" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我注册成为用户<em class="mr"> EntropyThot </em>，并组建了一个由我自己组成的“团队”，名为<em class="mr">摇摆哲学家</em>。我排在第39百分位，原始分数为75分(见下表)。我只解决了总共59个挑战中的9个，但尽管如此，我还是想讨论其中的一些，并荣幸地提到一个有趣的小挑战，我无法解决，但值得一提，因为它可以用来引用两个了不起的Twitter用户。</p><figure class="mt mu mv mw gu jv gi gj paragraph-image"><div class="gi gj ms"><img src="../Images/7f5a224588ffe81d7502e299be2056d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*LjgMApk2Q_fiIv_CDGiDBA.png"/></div><figcaption class="mx my gk gi gj mz na bd b be z dk translated">Brixel winter CTF的原始分数分布(2020版。).垂直线是我在比赛中的位置(查看记分牌<a class="ae nb" href="https://archive.is/hXOk1" rel="noopener ugc nofollow" target="_blank">这里</a>，我的结果<a class="ae nb" href="https://archive.is/nS1xl" rel="noopener ugc nofollow" target="_blank">这里</a>以及用于生成此图的代码<a class="ae nb" href="https://github.com/Alekseyyy/ctfs/tree/main/infosec/2020/brixelctf/statistics" rel="noopener ugc nofollow" target="_blank">这里</a>)。</figcaption></figure><h1 id="f73f" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">dem挑战</h1><p id="2963" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">我不会讨论所有我能设计出旗子的挑战，只讨论我觉得最有趣的挑战。如果你感兴趣，我会提供一个GitHub repo的链接，在那里我会发布更多的代码和文章。</p><h2 id="fe0e" class="nc kd iu bd ke nd ne dn ki nf ng dp km lh nh ni kq lj nj nk ku ll nl nm ky nn bi translated">互联网</h2><p id="b6df" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">我从讨论<code class="fe no np nq nr b">Browsercheck</code>挑战开始。挑战指出:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="1c63" class="nc kd iu nr b gz nw nx l ny nz">I found this weird website, but it will only allow 'ask jeeves crawler' to enter?<br/><br/>Can you get me in?<br/><br/>http://timesink.be/browsercheck/</span></pre><p id="5545" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我可以安装一个浏览器插件来改变用户代理，但是老实说，我不想给我的浏览器添加更多的垃圾😋</p><p id="ab2e" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我解决了以前的CTF的一个类似的挑战，我只是改变了我从以前的CTF写的脚本来应对这个挑战:</p><figure class="mt mu mv mw gu jv"><div class="bz fq l di"><div class="oa ob l"/></div></figure><p id="32e9" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">第17-32行使用Python的<code class="fe no np nq nr b">wx</code>库来呈现HTML页面，第34-40行使用Python的<code class="fe no np nq nr b">requests</code>库在<code class="fe no np nq nr b"><a class="ae nb" href="http://timesink.be/browsercheck/" rel="noopener ugc nofollow" target="_blank">http://timesink.be/browsercheck/.</a></code>获取页面。第37行是最重要的部分，因为在这里我将<code class="fe no np nq nr b">User-Agent</code>配置为最常见的Ask Jeeves代理。</p><p id="2593" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">运行程序显示标志:<code class="fe no np nq nr b">brixelCTF{askwho?}</code></p><h2 id="dc04" class="nc kd iu bd ke nd ne dn ki nf ng dp km lh nh ni kq lj nj nk ku ll nl nm ky nn bi translated">OSINT</h2><p id="6218" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">我将要讨论的新挑战叫做<code class="fe no np nq nr b">Manhunt.</code>,它分为七个部分，但我没有全部解决😢我只讨论第一个。</p><p id="68d7" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">这些挑战表明:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="1f81" class="nc kd iu nr b gz nw nx l ny nz">My dad is pissed off! He was told by my mother NOT to buy ice cream but he did anyway when she wasn't looking.<br/><br/>Someone posted this picture on the internet and my mother saw it, man, he is in so much trouble!<br/><br/>I want to know WHO posted this picture, let's hunt this guy down!<br/><br/>This flag is not in the usual format, you can enter it with or without the brixelCTF{flag} format, replace spaces with underscores ('_')<br/><br/>This is part of a series, more challenges will be unlocked once you solve this one. While most challenges will be OSINT, some of them may not be.</span></pre><p id="31f3" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">所以我下载了图片(<a class="ae nb" href="https://raw.githubusercontent.com/Alekseyyy/ctfs/main/2020/brixelctf/challenges/osint/Manhunt1/icecream.jpg" rel="noopener ugc nofollow" target="_blank">这里</a>)，并且能够用exiftool算出名字:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="0acc" class="nc kd iu nr b gz nw nx l ny nz"><strong class="nr iv">$ exiftool icecream.jpg</strong><br/>ExifTool Version Number : 10.80<br/>File Name : icecream.jpg<br/>Directory : .<br/>File Size : 322 kB<br/>File Modification Date/Time : 2020:12:27 15:51:56–05:00<br/>File Access Date/Time : 2021:01:06 23:34:14–05:00<br/>File Inode Change Date/Time : 2021:01:06 15:44:32–05:00<br/>File Permissions : rw-rw-r — <br/>File Type : JPEG<br/>File Type Extension : jpg<br/>MIME Type : image/jpeg<br/>Exif Byte Order : Big-endian (Motorola, MM)<br/>Resolution Unit : inches<br/>Y Cb Cr Positioning : Centered<br/>Exif Version : 0231<br/>Components Configuration : Y, Cb, Cr, -<br/>Flashpix Version : 0100<br/>Owner Name : <strong class="nr iv">Johnny Dorfmeister</strong><br/>Image Width : 1536<br/>Image Height : 2048<br/>Encoding Process : Baseline DCT, Huffman coding<br/>Bits Per Sample : 8<br/>Color Components : 3<br/>Y Cb Cr Sub Sampling : YCbCr4:4:4 (1 1)<br/>Image Size : 1536x2048<br/>Megapixels : 3.1</span></pre><p id="3d49" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">你可以清楚地看到，这个家伙的名字是<em class="mr">约翰尼·多夫迈斯特</em>。所以，标志必须是:<code class="fe no np nq nr b">brixelCTF{Johnny_Dorfmeister}.</code></p><h2 id="7112" class="nc kd iu bd ke nd ne dn ki nf ng dp km lh nh ni kq lj nj nk ku ll nl nm ky nn bi translated">编程；编排</h2><p id="0149" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">我将讨论我遇到的两个编程挑战。第一个叫做<code class="fe no np nq nr b">Are you fast enough?</code>,上面写着:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="7df2" class="nc kd iu nr b gz nw nx l ny nz">Can you program something that is fast enough to submit the solution before the time runs out? http://timesink.be/speedy</span></pre><p id="7527" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">该挑战在页面加载时提供一个随机字符串，最多给你一(1)秒时间将该随机字符串输入文本框并提交。当然，大多数人(包括我自己)无法手动完成，所以我决定让它自动化。</p><p id="3d33" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我最初试图使用Python的<code class="fe no np nq nr b">requests</code>模块来自动化提交随机字符串的过程，但这并不奏效，因为我必须发出一个请求来获取随机字符串，并发出另一个请求来提交第一个请求获得的字符串。问题是第二个请求将生成一个全新的字符串。</p><p id="f94e" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我想我会使用Python的<code class="fe no np nq nr b">selenium</code>模块来自动化网络浏览器任务。下面是我想出的派生旗帜的代码:</p><figure class="mt mu mv mw gu jv"><div class="bz fq l di"><div class="oa ob l"/></div></figure><p id="6580" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">第14–18行配置web浏览器(在本例中是Firefox)。第21行和第22行获取随机字符串并将其存储在一个名为<code class="fe no np nq nr b">the_key</code>的变量中，第25行到第28行提交标志，最后，第31行到第33行打印出标志。</p><p id="d6e1" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">产生的标志是:<code class="fe no np nq nr b">brixelCTF{sp33d_d3m0n}</code></p></div><div class="ab cl oc od hy oe" role="separator"><span class="of bw bk og oh oi"/><span class="of bw bk og oh oi"/><span class="of bw bk og oh"/></div><div class="in io ip iq ir"><p id="c439" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我做的第二个挑战叫做<code class="fe no np nq nr b">Keep walking</code>，它说:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="dbbd" class="nc kd iu nr b gz nw nx l ny nz">This is a challenge to test your basic programming skills.<br/><br/>Pseudo code:<br/>Set X = 1<br/>Set Y = 1<br/>Set previous answer = 1<br/>answer = X * Y + previous answer + 3<br/><br/>After that =&gt; X + 1 and Y + 1 ('answer' becomes 'previous answer') and repeat this till you have X = 525.<br/><br/>The final answer is the value of 'answer' when X = 525. Fill it in below.<br/><br/>Example:<br/><br/>5 = 1 * 1 + 1 + 3<br/>12 = 2 * 2 + 5 + 3<br/>24 = 3 * 3 + 12 + 3<br/><br/>........................<br/>........................<br/><br/>This flag is not in the usual format, you can enter it with or without the brixelCTF{flag} format</span></pre><p id="64ba" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">这只是一个你能不能把伪代码翻译成真代码的问题。我导出标志的方法是:</p><figure class="mt mu mv mw gu jv"><div class="bz fq l di"><div class="oa ob l"/></div></figure><p id="ff86" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">说实话，没什么好说的。本次挑战的旗帜是:<code class="fe no np nq nr b">brixelCTF{48373851}</code></p><h1 id="5a3f" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">光荣的提及</h1><p id="263c" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">好吧，这是一个很大的失败(对我来说),只是需要提到。<code class="fe no np nq nr b">Dadjokes</code>挑战。我发誓，我马上想到了推特用户<a class="ae nb" href="http://twitter.com/rasmansa" rel="noopener ugc nofollow" target="_blank"> @rasmansa </a>和<a class="ae nb" href="https://twitter.com/c0nc0rdance" rel="noopener ugc nofollow" target="_blank"> @c0nc0rdance </a>在尝试为这次挑战设计旗帜时，上面写着:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="d899" class="nc kd iu nr b gz nw nx l ny nz">Darn! Some idiot scriptkiddy broke my favorite website full of dad jokes! I can't seem to contact the owner to fix the site Can you bring it back and remove the defaced page?<br/><br/>http://timesink.be/dadjokes/</span></pre><p id="9764" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">好的，所以我试着通过查看损坏页面的源代码来做这件事，这给了我:</p><pre class="mt mu mv mw gu ns nr nt nu aw nv bi"><span id="6a4c" class="nc kd iu nr b gz nw nx l ny nz">&lt;!-- Hey bozo! I left your original index file under  index_backup.html so you can see how your site looked before I used my  l33t skillz to deface it. --&gt;</span></pre><p id="3953" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">然后我找到了<code class="fe no np nq nr b">submit.php</code>,试图通过提交一堆我从@rasmansa和@c0nc0rdance上剽窃来的父亲笑话来探究这个问题(你知道，就像布雷特·基恩在他与迈克尔·卡罗尔的“辩论”中剽窃了维基百科的文章一样)，但是毫无进展😭</p><figure class="mt mu mv mw gu jv gi gj paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="gi gj oj"><img src="../Images/7d9d94f25f5ddef2ecfe1645027b0cf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SkewA2dWtDNfAQJK.png"/></div></div><figcaption class="mx my gk gi gj mz na bd b be z dk translated">似乎是合法的</figcaption></figure><p id="2932" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">别担心，我没有提交他们的高音手柄或任何识别信息，只是他们的爸爸笑话；-)</p><h1 id="74b4" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">最后的想法</h1><figure class="mt mu mv mw gu jv gi gj paragraph-image"><div class="gi gj ok"><img src="../Images/52f5fdd4f40f09f56d2fa5ff53295a1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*Ueat69sBP2cKdNOlmRMw8A.png"/></div><figcaption class="mx my gk gi gj mz na bd b be z dk translated">我的统计:【https://archive.is/nS1xl T2】</figcaption></figure><p id="253d" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">这很有趣。生活阻碍了我们，这太糟糕了😢</p><p id="baac" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">解决爸爸笑话挑战和其他问题会很有趣。啊，好吧，总有下一年😉</p><p id="bf3c" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">对于那些想查看GitHub repo以获得更多文章、源代码和我用来做这个CTF的工具的人来说:</p><div class="ol om gq gs on oo"><a href="https://github.com/Alekseyyy/ctfs/tree/main/infosec/2020/brixelctf" rel="noopener  ugc nofollow" target="_blank"><div class="op ab fp"><div class="oq ab or cl cj os"><h2 class="bd iv gz z fq ot fs ft ou fv fx it bi translated">Alekseyyy/ctfs</h2><div class="ov l"><h3 class="bd b gz z fq ot fs ft ou fv fx dk translated">这是一次圣诞节夺旗活动，我们有59项任务，可以分成8个不同的类别。我…</h3></div><div class="ow l"><p class="bd b dl z fq ot fs ft ou fv fx dk translated">github.com</p></div></div><div class="ox l"><div class="oy l oz pa pb ox pc ka oo"/></div></div></a></div><h1 id="7dfe" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">感谢</h1><p id="7578" class="pw-post-body-paragraph lx ly iu lc b ld le lz ma lf lg mb mc lh md me mf lj mg mh mi ll mj mk ml ln in bi translated">我要感谢推特用户<a class="ae nb" href="https://twitter.com/rasmansa" rel="noopener ugc nofollow" target="_blank"> @rasmansa </a>和<a class="ae nb" href="https://twitter.com/c0nc0rdance" rel="noopener ugc nofollow" target="_blank"> @c0nc0rdance </a>成为火爸爸，并证明了最高质量的爸爸笑话激励我尝试(不幸失败)做<code class="fe no np nq nr b">Dadjokes</code>挑战。</p><p id="3749" class="pw-post-body-paragraph lx ly iu lc b ld mm lz ma lf mn mb mc lh mo me mf lj mp mh mi ll mq mk ml ln in bi translated">我还要为身为alpha的<a class="ae nb" href="https://twitter.com/krichard1212" rel="noopener ugc nofollow" target="_blank"> @krichard1212 </a>、<a class="ae nb" href="https://twitter.com/aslikr42069" rel="noopener ugc nofollow" target="_blank"> @aslikr42069 </a>、<a class="ae nb" href="https://twitter.com/SYSTEMCAWL" rel="noopener ugc nofollow" target="_blank"> @SYSTEMCAWL </a>、<a class="ae nb" href="https://twitter.com/chrisiousity" rel="noopener ugc nofollow" target="_blank">@ chrisiousty、</a> <a class="ae nb" href="https://twitter.com/roderickgraham" rel="noopener ugc nofollow" target="_blank"> @roderickgraham </a>和<a class="ae nb" href="https://twitter.com/hackerfantastic" rel="noopener ugc nofollow" target="_blank"> @hackerfantastic </a>大声疾呼😃</p><h1 id="7d1b" class="kc kd iu bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">尾注</h1><ol class=""><li id="82d0" class="la lb iu lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">他们所说的“互联网”指的是对基本网站导航的理解，以及揭示一面旗帜的巧妙网络黑客技术。</li><li id="36af" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">开源智能。</li><li id="46be" class="la lb iu lc b ld ls lf lt lh lu lj lv ll lw ln lo lp lq lr bi translated">这条水平线显示了我在原始分数分布中的位置。</li></ol></div></div>    
</body>
</html>